(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const y of u.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&o(y)}).observe(document,{childList:!0,subtree:!0});function t(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(c){if(c.ep)return;c.ep=!0;const u=t(c);fetch(c.href,u)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsxRuntime$1={exports:{}},reactJsxRuntime_production_min$1={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),y=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),_=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),S=Symbol.iterator;function A(G){return G===null||typeof G!="object"?null:(G=S&&G[S]||G["@@iterator"],typeof G=="function"?G:null)}var R={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z=Object.assign,l={};function s(G,$,Z){this.props=G,this.context=$,this.refs=l,this.updater=Z||R}s.prototype.isReactComponent={},s.prototype.setState=function(G,$){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,$,"setState")},s.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function v(){}v.prototype=s.prototype;function w(G,$,Z){this.props=G,this.context=$,this.refs=l,this.updater=Z||R}var E=w.prototype=new v;E.constructor=w,z(E,s.prototype),E.isPureReactComponent=!0;var C=Array.isArray,h=Object.prototype.hasOwnProperty,x={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function M(G,$,Z){var xe,ce={},Ne=null,Pe=null;if($!=null)for(xe in $.ref!==void 0&&(Pe=$.ref),$.key!==void 0&&(Ne=""+$.key),$)h.call($,xe)&&!k.hasOwnProperty(xe)&&(ce[xe]=$[xe]);var De=arguments.length-2;if(De===1)ce.children=Z;else if(1<De){for(var Me=Array(De),Be=0;Be<De;Be++)Me[Be]=arguments[Be+2];ce.children=Me}if(G&&G.defaultProps)for(xe in De=G.defaultProps,De)ce[xe]===void 0&&(ce[xe]=De[xe]);return{$$typeof:e,type:G,key:Ne,ref:Pe,props:ce,_owner:x.current}}function D(G,$){return{$$typeof:e,type:G.type,key:$,ref:G.ref,props:G.props,_owner:G._owner}}function P(G){return typeof G=="object"&&G!==null&&G.$$typeof===e}function F(G){var $={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(Z){return $[Z]})}var X=/\/+/g;function B(G,$){return typeof G=="object"&&G!==null&&G.key!=null?F(""+G.key):$.toString(36)}function L(G,$,Z,xe,ce){var Ne=typeof G;(Ne==="undefined"||Ne==="boolean")&&(G=null);var Pe=!1;if(G===null)Pe=!0;else switch(Ne){case"string":case"number":Pe=!0;break;case"object":switch(G.$$typeof){case e:case r:Pe=!0}}if(Pe)return Pe=G,ce=ce(Pe),G=xe===""?"."+B(Pe,0):xe,C(ce)?(Z="",G!=null&&(Z=G.replace(X,"$&/")+"/"),L(ce,$,Z,"",function(Be){return Be})):ce!=null&&(P(ce)&&(ce=D(ce,Z+(!ce.key||Pe&&Pe.key===ce.key?"":(""+ce.key).replace(X,"$&/")+"/")+G)),$.push(ce)),1;if(Pe=0,xe=xe===""?".":xe+":",C(G))for(var De=0;De<G.length;De++){Ne=G[De];var Me=xe+B(Ne,De);Pe+=L(Ne,$,Z,Me,ce)}else if(Me=A(G),typeof Me=="function")for(G=Me.call(G),De=0;!(Ne=G.next()).done;)Ne=Ne.value,Me=xe+B(Ne,De++),Pe+=L(Ne,$,Z,Me,ce);else if(Ne==="object")throw $=String(G),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Pe}function H(G,$,Z){if(G==null)return G;var xe=[],ce=0;return L(G,xe,"","",function(Ne){return $.call(Z,Ne,ce++)}),xe}function U(G){if(G._status===-1){var $=G._result;$=$(),$.then(function(Z){(G._status===0||G._status===-1)&&(G._status=1,G._result=Z)},function(Z){(G._status===0||G._status===-1)&&(G._status=2,G._result=Z)}),G._status===-1&&(G._status=0,G._result=$)}if(G._status===1)return G._result.default;throw G._result}var Y={current:null},W={transition:null},q={ReactCurrentDispatcher:Y,ReactCurrentBatchConfig:W,ReactCurrentOwner:x};return react_production_min.Children={map:H,forEach:function(G,$,Z){H(G,function(){$.apply(this,arguments)},Z)},count:function(G){var $=0;return H(G,function(){$++}),$},toArray:function(G){return H(G,function($){return $})||[]},only:function(G){if(!P(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},react_production_min.Component=s,react_production_min.Fragment=t,react_production_min.Profiler=c,react_production_min.PureComponent=w,react_production_min.StrictMode=o,react_production_min.Suspense=g,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=q,react_production_min.cloneElement=function(G,$,Z){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var xe=z({},G.props),ce=G.key,Ne=G.ref,Pe=G._owner;if($!=null){if($.ref!==void 0&&(Ne=$.ref,Pe=x.current),$.key!==void 0&&(ce=""+$.key),G.type&&G.type.defaultProps)var De=G.type.defaultProps;for(Me in $)h.call($,Me)&&!k.hasOwnProperty(Me)&&(xe[Me]=$[Me]===void 0&&De!==void 0?De[Me]:$[Me])}var Me=arguments.length-2;if(Me===1)xe.children=Z;else if(1<Me){De=Array(Me);for(var Be=0;Be<Me;Be++)De[Be]=arguments[Be+2];xe.children=De}return{$$typeof:e,type:G.type,key:ce,ref:Ne,props:xe,_owner:Pe}},react_production_min.createContext=function(G){return G={$$typeof:y,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:u,_context:G},G.Consumer=G},react_production_min.createElement=M,react_production_min.createFactory=function(G){var $=M.bind(null,G);return $.type=G,$},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(G){return{$$typeof:f,render:G}},react_production_min.isValidElement=P,react_production_min.lazy=function(G){return{$$typeof:p,_payload:{_status:-1,_result:G},_init:U}},react_production_min.memo=function(G,$){return{$$typeof:_,type:G,compare:$===void 0?null:$}},react_production_min.startTransition=function(G){var $=W.transition;W.transition={};try{G()}finally{W.transition=$}},react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},react_production_min.useCallback=function(G,$){return Y.current.useCallback(G,$)},react_production_min.useContext=function(G){return Y.current.useContext(G)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(G){return Y.current.useDeferredValue(G)},react_production_min.useEffect=function(G,$){return Y.current.useEffect(G,$)},react_production_min.useId=function(){return Y.current.useId()},react_production_min.useImperativeHandle=function(G,$,Z){return Y.current.useImperativeHandle(G,$,Z)},react_production_min.useInsertionEffect=function(G,$){return Y.current.useInsertionEffect(G,$)},react_production_min.useLayoutEffect=function(G,$){return Y.current.useLayoutEffect(G,$)},react_production_min.useMemo=function(G,$){return Y.current.useMemo(G,$)},react_production_min.useReducer=function(G,$,Z){return Y.current.useReducer(G,$,Z)},react_production_min.useRef=function(G){return Y.current.useRef(G)},react_production_min.useState=function(G){return Y.current.useState(G)},react_production_min.useSyncExternalStore=function(G,$,Z){return Y.current.useSyncExternalStore(G,$,Z)},react_production_min.useTransition=function(){return Y.current.useTransition()},react_production_min.version="18.2.0",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min$1;function requireReactJsxRuntime_production_min$1(){if(hasRequiredReactJsxRuntime_production_min$1)return reactJsxRuntime_production_min$1;hasRequiredReactJsxRuntime_production_min$1=1;var e=requireReact(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function y(f,g,_){var p,S={},A=null,R=null;_!==void 0&&(A=""+_),g.key!==void 0&&(A=""+g.key),g.ref!==void 0&&(R=g.ref);for(p in g)o.call(g,p)&&!u.hasOwnProperty(p)&&(S[p]=g[p]);if(f&&f.defaultProps)for(p in g=f.defaultProps,g)S[p]===void 0&&(S[p]=g[p]);return{$$typeof:r,type:f,key:A,ref:R,props:S,_owner:c.current}}return reactJsxRuntime_production_min$1.Fragment=t,reactJsxRuntime_production_min$1.jsx=y,reactJsxRuntime_production_min$1.jsxs=y,reactJsxRuntime_production_min$1}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime$1.exports=requireReactJsxRuntime_production_min$1()),jsxRuntime$1.exports}var jsxRuntimeExports$1=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(e){function r(W,q){var G=W.length;W.push(q);e:for(;0<G;){var $=G-1>>>1,Z=W[$];if(0<c(Z,q))W[$]=q,W[G]=Z,G=$;else break e}}function t(W){return W.length===0?null:W[0]}function o(W){if(W.length===0)return null;var q=W[0],G=W.pop();if(G!==q){W[0]=G;e:for(var $=0,Z=W.length,xe=Z>>>1;$<xe;){var ce=2*($+1)-1,Ne=W[ce],Pe=ce+1,De=W[Pe];if(0>c(Ne,G))Pe<Z&&0>c(De,Ne)?(W[$]=De,W[Pe]=G,$=Pe):(W[$]=Ne,W[ce]=G,$=ce);else if(Pe<Z&&0>c(De,G))W[$]=De,W[Pe]=G,$=Pe;else break e}}return q}function c(W,q){var G=W.sortIndex-q.sortIndex;return G!==0?G:W.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;e.unstable_now=function(){return u.now()}}else{var y=Date,f=y.now();e.unstable_now=function(){return y.now()-f}}var g=[],_=[],p=1,S=null,A=3,R=!1,z=!1,l=!1,s=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(W){for(var q=t(_);q!==null;){if(q.callback===null)o(_);else if(q.startTime<=W)o(_),q.sortIndex=q.expirationTime,r(g,q);else break;q=t(_)}}function C(W){if(l=!1,E(W),!z)if(t(g)!==null)z=!0,U(h);else{var q=t(_);q!==null&&Y(C,q.startTime-W)}}function h(W,q){z=!1,l&&(l=!1,v(M),M=-1),R=!0;var G=A;try{for(E(q),S=t(g);S!==null&&(!(S.expirationTime>q)||W&&!F());){var $=S.callback;if(typeof $=="function"){S.callback=null,A=S.priorityLevel;var Z=$(S.expirationTime<=q);q=e.unstable_now(),typeof Z=="function"?S.callback=Z:S===t(g)&&o(g),E(q)}else o(g);S=t(g)}if(S!==null)var xe=!0;else{var ce=t(_);ce!==null&&Y(C,ce.startTime-q),xe=!1}return xe}finally{S=null,A=G,R=!1}}var x=!1,k=null,M=-1,D=5,P=-1;function F(){return!(e.unstable_now()-P<D)}function X(){if(k!==null){var W=e.unstable_now();P=W;var q=!0;try{q=k(!0,W)}finally{q?B():(x=!1,k=null)}}else x=!1}var B;if(typeof w=="function")B=function(){w(X)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,H=L.port2;L.port1.onmessage=X,B=function(){H.postMessage(null)}}else B=function(){s(X,0)};function U(W){k=W,x||(x=!0,B())}function Y(W,q){M=s(function(){W(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){z||R||(z=!0,U(h))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return A},e.unstable_getFirstCallbackNode=function(){return t(g)},e.unstable_next=function(W){switch(A){case 1:case 2:case 3:var q=3;break;default:q=A}var G=A;A=q;try{return W()}finally{A=G}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,q){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var G=A;A=W;try{return q()}finally{A=G}},e.unstable_scheduleCallback=function(W,q,G){var $=e.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?$+G:$):G=$,W){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=G+Z,W={id:p++,callback:q,priorityLevel:W,startTime:G,expirationTime:Z,sortIndex:-1},G>$?(W.sortIndex=G,r(_,W),t(g)===null&&W===t(_)&&(l?(v(M),M=-1):l=!0,Y(C,G-$))):(W.sortIndex=Z,r(g,W),z||R||(z=!0,U(h))),W},e.unstable_shouldYield=F,e.unstable_wrapCallback=function(W){var q=A;return function(){var G=A;A=q;try{return W.apply(this,arguments)}finally{A=G}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var e=requireReact(),r=requireScheduler();function t(n){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+n,b=1;b<arguments.length;b++)a+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,c={};function u(n,a){y(n,a),y(n+"Capture",a)}function y(n,a){for(c[n]=a,n=0;n<a.length;n++)o.add(a[n])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),g=Object.prototype.hasOwnProperty,_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},S={};function A(n){return g.call(S,n)?!0:g.call(p,n)?!1:_.test(n)?S[n]=!0:(p[n]=!0,!1)}function R(n,a,b,j){if(b!==null&&b.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return j?!1:b!==null?!b.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function z(n,a,b,j){if(a===null||typeof a>"u"||R(n,a,b,j))return!0;if(j)return!1;if(b!==null)switch(b.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function l(n,a,b,j,V,Q,oe){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=j,this.attributeNamespace=V,this.mustUseProperty=b,this.propertyName=n,this.type=a,this.sanitizeURL=Q,this.removeEmptyString=oe}var s={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){s[n]=new l(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var a=n[0];s[a]=new l(a,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){s[n]=new l(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){s[n]=new l(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){s[n]=new l(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){s[n]=new l(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){s[n]=new l(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){s[n]=new l(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){s[n]=new l(n,5,!1,n.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function w(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var a=n.replace(v,w);s[a]=new l(a,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var a=n.replace(v,w);s[a]=new l(a,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var a=n.replace(v,w);s[a]=new l(a,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){s[n]=new l(n,1,!1,n.toLowerCase(),null,!1,!1)}),s.xlinkHref=new l("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){s[n]=new l(n,1,!1,n.toLowerCase(),null,!0,!0)});function E(n,a,b,j){var V=s.hasOwnProperty(a)?s[a]:null;(V!==null?V.type!==0:j||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(z(a,b,V,j)&&(b=null),j||V===null?A(a)&&(b===null?n.removeAttribute(a):n.setAttribute(a,""+b)):V.mustUseProperty?n[V.propertyName]=b===null?V.type===3?!1:"":b:(a=V.attributeName,j=V.attributeNamespace,b===null?n.removeAttribute(a):(V=V.type,b=V===3||V===4&&b===!0?"":""+b,j?n.setAttributeNS(j,a,b):n.setAttribute(a,b))))}var C=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,h=Symbol.for("react.element"),x=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),F=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),Y=Symbol.for("react.offscreen"),W=Symbol.iterator;function q(n){return n===null||typeof n!="object"?null:(n=W&&n[W]||n["@@iterator"],typeof n=="function"?n:null)}var G=Object.assign,$;function Z(n){if($===void 0)try{throw Error()}catch(b){var a=b.stack.trim().match(/\n( *(at )?)/);$=a&&a[1]||""}return`
`+$+n}var xe=!1;function ce(n,a){if(!n||xe)return"";xe=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(Vt){var j=Vt}Reflect.construct(n,[],a)}else{try{a.call()}catch(Vt){j=Vt}n.call(a.prototype)}else{try{throw Error()}catch(Vt){j=Vt}n()}}catch(Vt){if(Vt&&j&&typeof Vt.stack=="string"){for(var V=Vt.stack.split(`
`),Q=j.stack.split(`
`),oe=V.length-1,Le=Q.length-1;1<=oe&&0<=Le&&V[oe]!==Q[Le];)Le--;for(;1<=oe&&0<=Le;oe--,Le--)if(V[oe]!==Q[Le]){if(oe!==1||Le!==1)do if(oe--,Le--,0>Le||V[oe]!==Q[Le]){var st=`
`+V[oe].replace(" at new "," at ");return n.displayName&&st.includes("<anonymous>")&&(st=st.replace("<anonymous>",n.displayName)),st}while(1<=oe&&0<=Le);break}}}finally{xe=!1,Error.prepareStackTrace=b}return(n=n?n.displayName||n.name:"")?Z(n):""}function Ne(n){switch(n.tag){case 5:return Z(n.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 2:case 15:return n=ce(n.type,!1),n;case 11:return n=ce(n.type.render,!1),n;case 1:return n=ce(n.type,!0),n;default:return""}}function Pe(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case k:return"Fragment";case x:return"Portal";case D:return"Profiler";case M:return"StrictMode";case B:return"Suspense";case L:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case F:return(n.displayName||"Context")+".Consumer";case P:return(n._context.displayName||"Context")+".Provider";case X:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case H:return a=n.displayName||null,a!==null?a:Pe(n.type)||"Memo";case U:a=n._payload,n=n._init;try{return Pe(n(a))}catch{}}return null}function De(n){var a=n.type;switch(n.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=a.render,n=n.displayName||n.name||"",a.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pe(a);case 8:return a===M?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Me(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Be(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function ft(n){var a=Be(n)?"checked":"value",b=Object.getOwnPropertyDescriptor(n.constructor.prototype,a),j=""+n[a];if(!n.hasOwnProperty(a)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var V=b.get,Q=b.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return V.call(this)},set:function(oe){j=""+oe,Q.call(this,oe)}}),Object.defineProperty(n,a,{enumerable:b.enumerable}),{getValue:function(){return j},setValue:function(oe){j=""+oe},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function Ot(n){n._valueTracker||(n._valueTracker=ft(n))}function Gt(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var b=a.getValue(),j="";return n&&(j=Be(n)?n.checked?"true":"false":n.value),n=j,n!==b?(a.setValue(n),!0):!1}function mt(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function je(n,a){var b=a.checked;return G({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:b??n._wrapperState.initialChecked})}function ht(n,a){var b=a.defaultValue==null?"":a.defaultValue,j=a.checked!=null?a.checked:a.defaultChecked;b=Me(a.value!=null?a.value:b),n._wrapperState={initialChecked:j,initialValue:b,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function Kt(n,a){a=a.checked,a!=null&&E(n,"checked",a,!1)}function Jt(n,a){Kt(n,a);var b=Me(a.value),j=a.type;if(b!=null)j==="number"?(b===0&&n.value===""||n.value!=b)&&(n.value=""+b):n.value!==""+b&&(n.value=""+b);else if(j==="submit"||j==="reset"){n.removeAttribute("value");return}a.hasOwnProperty("value")?Br(n,a.type,b):a.hasOwnProperty("defaultValue")&&Br(n,a.type,Me(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(n.defaultChecked=!!a.defaultChecked)}function Wt(n,a,b){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var j=a.type;if(!(j!=="submit"&&j!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+n._wrapperState.initialValue,b||a===n.value||(n.value=a),n.defaultValue=a}b=n.name,b!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,b!==""&&(n.name=b)}function Br(n,a,b){(a!=="number"||mt(n.ownerDocument)!==n)&&(b==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+b&&(n.defaultValue=""+b))}var zr=Array.isArray;function cr(n,a,b,j){if(n=n.options,a){a={};for(var V=0;V<b.length;V++)a["$"+b[V]]=!0;for(b=0;b<n.length;b++)V=a.hasOwnProperty("$"+n[b].value),n[b].selected!==V&&(n[b].selected=V),V&&j&&(n[b].defaultSelected=!0)}else{for(b=""+Me(b),a=null,V=0;V<n.length;V++){if(n[V].value===b){n[V].selected=!0,j&&(n[V].defaultSelected=!0);return}a!==null||n[V].disabled||(a=n[V])}a!==null&&(a.selected=!0)}}function Nr(n,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return G({},a,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function At(n,a){var b=a.value;if(b==null){if(b=a.children,a=a.defaultValue,b!=null){if(a!=null)throw Error(t(92));if(zr(b)){if(1<b.length)throw Error(t(93));b=b[0]}a=b}a==null&&(a=""),b=a}n._wrapperState={initialValue:Me(b)}}function Mt(n,a){var b=Me(a.value),j=Me(a.defaultValue);b!=null&&(b=""+b,b!==n.value&&(n.value=b),a.defaultValue==null&&n.defaultValue!==b&&(n.defaultValue=b)),j!=null&&(n.defaultValue=""+j)}function Jr(n){var a=n.textContent;a===n._wrapperState.initialValue&&a!==""&&a!==null&&(n.value=a)}function Yr(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ie(n,a){return n==null||n==="http://www.w3.org/1999/xhtml"?Yr(a):n==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var ve,we=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,b,j,V){MSApp.execUnsafeLocalFunction(function(){return n(a,b,j,V)})}:n})(function(n,a){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=a;else{for(ve=ve||document.createElement("div"),ve.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=ve.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;a.firstChild;)n.appendChild(a.firstChild)}});function it(n,a){if(a){var b=n.firstChild;if(b&&b===n.lastChild&&b.nodeType===3){b.nodeValue=a;return}}n.textContent=a}var rt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Yt=["Webkit","ms","Moz","O"];Object.keys(rt).forEach(function(n){Yt.forEach(function(a){a=a+n.charAt(0).toUpperCase()+n.substring(1),rt[a]=rt[n]})});function jt(n,a,b){return a==null||typeof a=="boolean"||a===""?"":b||typeof a!="number"||a===0||rt.hasOwnProperty(n)&&rt[n]?(""+a).trim():a+"px"}function re(n,a){n=n.style;for(var b in a)if(a.hasOwnProperty(b)){var j=b.indexOf("--")===0,V=jt(b,a[b],j);b==="float"&&(b="cssFloat"),j?n.setProperty(b,V):n[b]=V}}var tt=G({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lt(n,a){if(a){if(tt[n]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,n));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function ar(n,a){if(n.indexOf("-")===-1)return typeof a.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var et=null;function Ft(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var se=null,xt=null,Vr=null;function J(n){if(n=yc(n)){if(typeof se!="function")throw Error(t(280));var a=n.stateNode;a&&(a=tu(a),se(n.stateNode,n.type,a))}}function ut(n){xt?Vr?Vr.push(n):Vr=[n]:xt=n}function at(){if(xt){var n=xt,a=Vr;if(Vr=xt=null,J(n),a)for(n=0;n<a.length;n++)J(a[n])}}function me(n,a){return n(a)}function Ze(){}var vt=!1;function Qr(n,a,b){if(vt)return n(a,b);vt=!0;try{return me(n,a,b)}finally{vt=!1,(xt!==null||Vr!==null)&&(Ze(),at())}}function Xr(n,a){var b=n.stateNode;if(b===null)return null;var j=tu(b);if(j===null)return null;b=j[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(j=!j.disabled)||(n=n.type,j=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!j;break e;default:n=!1}if(n)return null;if(b&&typeof b!="function")throw Error(t(231,a,typeof b));return b}var Zr=!1;if(f)try{var xn={};Object.defineProperty(xn,"passive",{get:function(){Zr=!0}}),window.addEventListener("test",xn,xn),window.removeEventListener("test",xn,xn)}catch{Zr=!1}function Ei(n,a,b,j,V,Q,oe,Le,st){var Vt=Array.prototype.slice.call(arguments,3);try{a.apply(b,Vt)}catch(Ur){this.onError(Ur)}}var zn=!1,Pn=null,Fn=!1,mi=null,xi={onError:function(n){zn=!0,Pn=n}};function Ca(n,a,b,j,V,Q,oe,Le,st){zn=!1,Pn=null,Ei.apply(xi,arguments)}function Ra(n,a,b,j,V,Q,oe,Le,st){if(Ca.apply(this,arguments),zn){if(zn){var Vt=Pn;zn=!1,Pn=null}else throw Error(t(198));Fn||(Fn=!0,mi=Vt)}}function ei(n){var a=n,b=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(b=a.return),n=a.return;while(n)}return a.tag===3?b:null}function ai(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function ci(n){if(ei(n)!==n)throw Error(t(188))}function Xs(n){var a=n.alternate;if(!a){if(a=ei(n),a===null)throw Error(t(188));return a!==n?null:n}for(var b=n,j=a;;){var V=b.return;if(V===null)break;var Q=V.alternate;if(Q===null){if(j=V.return,j!==null){b=j;continue}break}if(V.child===Q.child){for(Q=V.child;Q;){if(Q===b)return ci(V),n;if(Q===j)return ci(V),a;Q=Q.sibling}throw Error(t(188))}if(b.return!==j.return)b=V,j=Q;else{for(var oe=!1,Le=V.child;Le;){if(Le===b){oe=!0,b=V,j=Q;break}if(Le===j){oe=!0,j=V,b=Q;break}Le=Le.sibling}if(!oe){for(Le=Q.child;Le;){if(Le===b){oe=!0,b=Q,j=V;break}if(Le===j){oe=!0,j=Q,b=V;break}Le=Le.sibling}if(!oe)throw Error(t(189))}}if(b.alternate!==j)throw Error(t(190))}if(b.tag!==3)throw Error(t(188));return b.stateNode.current===b?n:a}function Us(n){return n=Xs(n),n!==null?fa(n):null}function fa(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var a=fa(n);if(a!==null)return a;n=n.sibling}return null}var ll=r.unstable_scheduleCallback,cl=r.unstable_cancelCallback,ul=r.unstable_shouldYield,Ya=r.unstable_requestPaint,hi=r.unstable_now,dl=r.unstable_getCurrentPriorityLevel,La=r.unstable_ImmediatePriority,kc=r.unstable_UserBlockingPriority,On=r.unstable_NormalPriority,Aa=r.unstable_LowPriority,pa=r.unstable_IdlePriority,Tl=null,$s=null;function hl(n){if($s&&typeof $s.onCommitFiberRoot=="function")try{$s.onCommitFiberRoot(Tl,n,void 0,(n.current.flags&128)===128)}catch{}}var ma=Math.clz32?Math.clz32:gu,pu=Math.log,mu=Math.LN2;function gu(n){return n>>>=0,n===0?32:31-(pu(n)/mu|0)|0}var Na=64,qa=4194304;function Ns(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ba(n,a){var b=n.pendingLanes;if(b===0)return 0;var j=0,V=n.suspendedLanes,Q=n.pingedLanes,oe=b&268435455;if(oe!==0){var Le=oe&~V;Le!==0?j=Ns(Le):(Q&=oe,Q!==0&&(j=Ns(Q)))}else oe=b&~V,oe!==0?j=Ns(oe):Q!==0&&(j=Ns(Q));if(j===0)return 0;if(a!==0&&a!==j&&(a&V)===0&&(V=j&-j,Q=a&-a,V>=Q||V===16&&(Q&4194240)!==0))return a;if((j&4)!==0&&(j|=b&16),a=n.entangledLanes,a!==0)for(n=n.entanglements,a&=j;0<a;)b=31-ma(a),V=1<<b,j|=n[b],a&=~V;return j}function fl(n,a){switch(n){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ml(n,a){for(var b=n.suspendedLanes,j=n.pingedLanes,V=n.expirationTimes,Q=n.pendingLanes;0<Q;){var oe=31-ma(Q),Le=1<<oe,st=V[oe];st===-1?((Le&b)===0||(Le&j)!==0)&&(V[oe]=fl(Le,a)):st<=a&&(n.expiredLanes|=Le),Q&=~Le}}function yu(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Xa(){var n=Na;return Na<<=1,(Na&4194240)===0&&(Na=64),n}function Tc(n){for(var a=[],b=0;31>b;b++)a.push(n);return a}function _a(n,a,b){n.pendingLanes|=a,a!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,a=31-ma(a),n[a]=b}function bh(n,a){var b=n.pendingLanes&~a;n.pendingLanes=a,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=a,n.mutableReadLanes&=a,n.entangledLanes&=a,a=n.entanglements;var j=n.eventTimes;for(n=n.expirationTimes;0<b;){var V=31-ma(b),Q=1<<V;a[V]=0,j[V]=-1,n[V]=-1,b&=~Q}}function za(n,a){var b=n.entangledLanes|=a;for(n=n.entanglements;b;){var j=31-ma(b),V=1<<j;V&a|n[j]&a&&(n[j]|=a),b&=~V}}var Dn=0;function oa(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var ii,pl,Mc,vu,ml,Nc=!1,Nl=[],ga=null,Ja=null,Qa=null,aa=new Map,Ga=new Map,Za=[],wh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zl(n,a){switch(n){case"focusin":case"focusout":ga=null;break;case"dragenter":case"dragleave":Ja=null;break;case"mouseover":case"mouseout":Qa=null;break;case"pointerover":case"pointerout":aa.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ga.delete(a.pointerId)}}function Il(n,a,b,j,V,Q){return n===null||n.nativeEvent!==Q?(n={blockedOn:a,domEventName:b,eventSystemFlags:j,nativeEvent:Q,targetContainers:[V]},a!==null&&(a=yc(a),a!==null&&pl(a)),n):(n.eventSystemFlags|=j,a=n.targetContainers,V!==null&&a.indexOf(V)===-1&&a.push(V),n)}function fd(n,a,b,j,V){switch(a){case"focusin":return ga=Il(ga,n,a,b,j,V),!0;case"dragenter":return Ja=Il(Ja,n,a,b,j,V),!0;case"mouseover":return Qa=Il(Qa,n,a,b,j,V),!0;case"pointerover":var Q=V.pointerId;return aa.set(Q,Il(aa.get(Q)||null,n,a,b,j,V)),!0;case"gotpointercapture":return Q=V.pointerId,Ga.set(Q,Il(Ga.get(Q)||null,n,a,b,j,V)),!0}return!1}function pd(n){var a=El(n.target);if(a!==null){var b=ei(a);if(b!==null){if(a=b.tag,a===13){if(a=ai(b),a!==null){n.blockedOn=a,ml(n.priority,function(){Mc(b)});return}}else if(a===3&&b.stateNode.current.memoizedState.isDehydrated){n.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}n.blockedOn=null}function rc(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var b=_u(n.domEventName,n.eventSystemFlags,a[0],n.nativeEvent);if(b===null){b=n.nativeEvent;var j=new b.constructor(b.type,b);et=j,b.target.dispatchEvent(j),et=null}else return a=yc(b),a!==null&&pl(a),n.blockedOn=b,!1;a.shift()}return!0}function md(n,a,b){rc(n)&&b.delete(a)}function Eh(){Nc=!1,ga!==null&&rc(ga)&&(ga=null),Ja!==null&&rc(Ja)&&(Ja=null),Qa!==null&&rc(Qa)&&(Qa=null),aa.forEach(md),Ga.forEach(md)}function nc(n,a){n.blockedOn===a&&(n.blockedOn=null,Nc||(Nc=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Eh)))}function ic(n){function a(V){return nc(V,n)}if(0<Nl.length){nc(Nl[0],n);for(var b=1;b<Nl.length;b++){var j=Nl[b];j.blockedOn===n&&(j.blockedOn=null)}}for(ga!==null&&nc(ga,n),Ja!==null&&nc(Ja,n),Qa!==null&&nc(Qa,n),aa.forEach(a),Ga.forEach(a),b=0;b<Za.length;b++)j=Za[b],j.blockedOn===n&&(j.blockedOn=null);for(;0<Za.length&&(b=Za[0],b.blockedOn===null);)pd(b),b.blockedOn===null&&Za.shift()}var Pl=C.ReactCurrentBatchConfig,zc=!0;function Sh(n,a,b,j){var V=Dn,Q=Pl.transition;Pl.transition=null;try{Dn=1,xu(n,a,b,j)}finally{Dn=V,Pl.transition=Q}}function Ch(n,a,b,j){var V=Dn,Q=Pl.transition;Pl.transition=null;try{Dn=4,xu(n,a,b,j)}finally{Dn=V,Pl.transition=Q}}function xu(n,a,b,j){if(zc){var V=_u(n,a,b,j);if(V===null)Vu(n,a,j,Ic,b),zl(n,j);else if(fd(V,n,a,b,j))j.stopPropagation();else if(zl(n,j),a&4&&-1<wh.indexOf(n)){for(;V!==null;){var Q=yc(V);if(Q!==null&&ii(Q),Q=_u(n,a,b,j),Q===null&&Vu(n,a,j,Ic,b),Q===V)break;V=Q}V!==null&&j.stopPropagation()}else Vu(n,a,j,null,b)}}var Ic=null;function _u(n,a,b,j){if(Ic=null,n=Ft(j),n=El(n),n!==null)if(a=ei(n),a===null)n=null;else if(b=a.tag,b===13){if(n=ai(a),n!==null)return n;n=null}else if(b===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null);return Ic=n,null}function gd(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dl()){case La:return 1;case kc:return 4;case On:case Aa:return 16;case pa:return 536870912;default:return 16}default:return 16}}var Ka=null,gl=null,Pc=null;function yd(){if(Pc)return Pc;var n,a=gl,b=a.length,j,V="value"in Ka?Ka.value:Ka.textContent,Q=V.length;for(n=0;n<b&&a[n]===V[n];n++);var oe=b-n;for(j=1;j<=oe&&a[b-j]===V[Q-j];j++);return Pc=V.slice(n,1<j?1-j:void 0)}function Dc(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function yl(){return!0}function bu(){return!1}function Ws(n){function a(b,j,V,Q,oe){this._reactName=b,this._targetInst=V,this.type=j,this.nativeEvent=Q,this.target=oe,this.currentTarget=null;for(var Le in n)n.hasOwnProperty(Le)&&(b=n[Le],this[Le]=b?b(Q):Q[Le]);return this.isDefaultPrevented=(Q.defaultPrevented!=null?Q.defaultPrevented:Q.returnValue===!1)?yl:bu,this.isPropagationStopped=bu,this}return G(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=yl)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=yl)},persist:function(){},isPersistent:yl}),a}var Dl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wu=Ws(Dl),sc=G({},Dl,{view:0,detail:0}),Rh=Ws(sc),vl,Eu,jl,oc=G({},sc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Su,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==jl&&(jl&&n.type==="mousemove"?(vl=n.screenX-jl.screenX,Eu=n.screenY-jl.screenY):Eu=vl=0,jl=n),vl)},movementY:function(n){return"movementY"in n?n.movementY:Eu}}),vd=Ws(oc),Ah=G({},oc,{dataTransfer:0}),kh=Ws(Ah),Th=G({},sc,{relatedTarget:0}),Fl=Ws(Th),Mh=G({},Dl,{animationName:0,elapsedTime:0,pseudoElement:0}),Nh=Ws(Mh),zh=G({},Dl,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ih=Ws(zh),ac=G({},Dl,{data:0}),jc=Ws(ac),Ph={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fh(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=jh[n])?!!a[n]:!1}function Su(){return Fh}var Oh=G({},sc,{key:function(n){if(n.key){var a=Ph[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=Dc(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Dh[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Su,charCode:function(n){return n.type==="keypress"?Dc(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Dc(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Lh=Ws(Oh),Fc=G({},oc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xd=Ws(Fc),Bh=G({},sc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Su}),Ol=Ws(Bh),_d=G({},Dl,{propertyName:0,elapsedTime:0,pseudoElement:0}),bd=Ws(_d),wd=G({},oc,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Cu=Ws(wd),Ed=[9,13,27,32],Ru=f&&"CompositionEvent"in window,lc=null;f&&"documentMode"in document&&(lc=document.documentMode);var Gh=f&&"TextEvent"in window&&!lc,Sd=f&&(!Ru||lc&&8<lc&&11>=lc),Ll=" ",Cd=!1;function ku(n,a){switch(n){case"keyup":return Ed.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tu(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var xl=!1;function Uh(n,a){switch(n){case"compositionend":return Tu(a);case"keypress":return a.which!==32?null:(Cd=!0,Ll);case"textInput":return n=a.data,n===Ll&&Cd?null:n;default:return null}}function Oc(n,a){if(xl)return n==="compositionend"||!Ru&&ku(n,a)?(n=yd(),Pc=gl=Ka=null,xl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Sd&&a.locale!=="ko"?null:a.data;default:return null}}var _l={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rd(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!_l[n.type]:a==="textarea"}function Ad(n,a,b,j){ut(j),a=Qc(a,"onChange"),0<a.length&&(b=new wu("onChange","change",null,b,j),n.push({event:b,listeners:a}))}var ra=null,Bl=null;function kd(n){Jc(n,0)}function Lc(n){var a=Wl(n);if(Gt(a))return n}function Td(n,a){if(n==="change")return a}var uc=!1;if(f){var Bc;if(f){var Gc="oninput"in document;if(!Gc){var Mu=document.createElement("div");Mu.setAttribute("oninput","return;"),Gc=typeof Mu.oninput=="function"}Bc=Gc}else Bc=!1;uc=Bc&&(!document.documentMode||9<document.documentMode)}function Nu(){ra&&(ra.detachEvent("onpropertychange",zu),Bl=ra=null)}function zu(n){if(n.propertyName==="value"&&Lc(Bl)){var a=[];Ad(a,Bl,n,Ft(n)),Qr(kd,a)}}function Md(n,a,b){n==="focusin"?(Nu(),ra=a,Bl=b,ra.attachEvent("onpropertychange",zu)):n==="focusout"&&Nu()}function Nd(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Lc(Bl)}function zd(n,a){if(n==="click")return Lc(a)}function Id(n,a){if(n==="input"||n==="change")return Lc(a)}function Uc(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var Ls=typeof Object.is=="function"?Object.is:Uc;function bl(n,a){if(Ls(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var b=Object.keys(n),j=Object.keys(a);if(b.length!==j.length)return!1;for(j=0;j<b.length;j++){var V=b[j];if(!g.call(a,V)||!Ls(n[V],a[V]))return!1}return!0}function Iu(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Vc(n,a){var b=Iu(n);n=0;for(var j;b;){if(b.nodeType===3){if(j=n+b.textContent.length,n<=a&&j>=a)return{node:b,offset:a-n};n=j}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=Iu(b)}}function Pu(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?Pu(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function Du(){for(var n=window,a=mt();a instanceof n.HTMLIFrameElement;){try{var b=typeof a.contentWindow.location.href=="string"}catch{b=!1}if(b)n=a.contentWindow;else break;a=mt(n.document)}return a}function $c(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}function Pd(n){var a=Du(),b=n.focusedElem,j=n.selectionRange;if(a!==b&&b&&b.ownerDocument&&Pu(b.ownerDocument.documentElement,b)){if(j!==null&&$c(b)){if(a=j.start,n=j.end,n===void 0&&(n=a),"selectionStart"in b)b.selectionStart=a,b.selectionEnd=Math.min(n,b.value.length);else if(n=(a=b.ownerDocument||document)&&a.defaultView||window,n.getSelection){n=n.getSelection();var V=b.textContent.length,Q=Math.min(j.start,V);j=j.end===void 0?Q:Math.min(j.end,V),!n.extend&&Q>j&&(V=j,j=Q,Q=V),V=Vc(b,Q);var oe=Vc(b,j);V&&oe&&(n.rangeCount!==1||n.anchorNode!==V.node||n.anchorOffset!==V.offset||n.focusNode!==oe.node||n.focusOffset!==oe.offset)&&(a=a.createRange(),a.setStart(V.node,V.offset),n.removeAllRanges(),Q>j?(n.addRange(a),n.extend(oe.node,oe.offset)):(a.setEnd(oe.node,oe.offset),n.addRange(a)))}}for(a=[],n=b;n=n.parentNode;)n.nodeType===1&&a.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<a.length;b++)n=a[b],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Wc=f&&"documentMode"in document&&11>=document.documentMode,Ua=null,Hc=null,Gl=null,Yc=!1;function ju(n,a,b){var j=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;Yc||Ua==null||Ua!==mt(j)||(j=Ua,"selectionStart"in j&&$c(j)?j={start:j.selectionStart,end:j.selectionEnd}:(j=(j.ownerDocument&&j.ownerDocument.defaultView||window).getSelection(),j={anchorNode:j.anchorNode,anchorOffset:j.anchorOffset,focusNode:j.focusNode,focusOffset:j.focusOffset}),Gl&&bl(Gl,j)||(Gl=j,j=Qc(Hc,"onSelect"),0<j.length&&(a=new wu("onSelect","select",null,a,b),n.push({event:a,listeners:j}),a.target=Ua)))}function dc(n,a){var b={};return b[n.toLowerCase()]=a.toLowerCase(),b["Webkit"+n]="webkit"+a,b["Moz"+n]="moz"+a,b}var el={animationend:dc("Animation","AnimationEnd"),animationiteration:dc("Animation","AnimationIteration"),animationstart:dc("Animation","AnimationStart"),transitionend:dc("Transition","TransitionEnd")},qc={},Fu={};f&&(Fu=document.createElement("div").style,"AnimationEvent"in window||(delete el.animationend.animation,delete el.animationiteration.animation,delete el.animationstart.animation),"TransitionEvent"in window||delete el.transitionend.transition);function ui(n){if(qc[n])return qc[n];if(!el[n])return n;var a=el[n],b;for(b in a)if(a.hasOwnProperty(b)&&b in Fu)return qc[n]=a[b];return n}var Ou=ui("animationend"),Lu=ui("animationiteration"),Dd=ui("animationstart"),jd=ui("transitionend"),Fd=new Map,Bu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function tl(n,a){Fd.set(n,a),u(a,[n])}for(var Va=0;Va<Bu.length;Va++){var Xc=Bu[Va],Od=Xc.toLowerCase(),Ld=Xc[0].toUpperCase()+Xc.slice(1);tl(Od,"on"+Ld)}tl(Ou,"onAnimationEnd"),tl(Lu,"onAnimationIteration"),tl(Dd,"onAnimationStart"),tl("dblclick","onDoubleClick"),tl("focusin","onFocus"),tl("focusout","onBlur"),tl(jd,"onTransitionEnd"),y("onMouseEnter",["mouseout","mouseover"]),y("onMouseLeave",["mouseout","mouseover"]),y("onPointerEnter",["pointerout","pointerover"]),y("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ul="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vh=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ul));function Gu(n,a,b){var j=n.type||"unknown-event";n.currentTarget=b,Ra(j,a,void 0,n),n.currentTarget=null}function Jc(n,a){a=(a&4)!==0;for(var b=0;b<n.length;b++){var j=n[b],V=j.event;j=j.listeners;e:{var Q=void 0;if(a)for(var oe=j.length-1;0<=oe;oe--){var Le=j[oe],st=Le.instance,Vt=Le.currentTarget;if(Le=Le.listener,st!==Q&&V.isPropagationStopped())break e;Gu(V,Le,Vt),Q=st}else for(oe=0;oe<j.length;oe++){if(Le=j[oe],st=Le.instance,Vt=Le.currentTarget,Le=Le.listener,st!==Q&&V.isPropagationStopped())break e;Gu(V,Le,Vt),Q=st}}}if(Fn)throw n=mi,Fn=!1,mi=null,n}function di(n,a){var b=a[gc];b===void 0&&(b=a[gc]=new Set);var j=n+"__bubble";b.has(j)||(Bd(a,n,2,!1),b.add(j))}function Uu(n,a,b){var j=0;a&&(j|=4),Bd(b,n,j,a)}var hc="_reactListening"+Math.random().toString(36).slice(2);function fc(n){if(!n[hc]){n[hc]=!0,o.forEach(function(b){b!=="selectionchange"&&(Vh.has(b)||Uu(b,!1,n),Uu(b,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[hc]||(a[hc]=!0,Uu("selectionchange",!1,a))}}function Bd(n,a,b,j){switch(gd(a)){case 1:var V=Sh;break;case 4:V=Ch;break;default:V=xu}b=V.bind(null,a,b,n),V=void 0,!Zr||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(V=!0),j?V!==void 0?n.addEventListener(a,b,{capture:!0,passive:V}):n.addEventListener(a,b,!0):V!==void 0?n.addEventListener(a,b,{passive:V}):n.addEventListener(a,b,!1)}function Vu(n,a,b,j,V){var Q=j;if((a&1)===0&&(a&2)===0&&j!==null)e:for(;;){if(j===null)return;var oe=j.tag;if(oe===3||oe===4){var Le=j.stateNode.containerInfo;if(Le===V||Le.nodeType===8&&Le.parentNode===V)break;if(oe===4)for(oe=j.return;oe!==null;){var st=oe.tag;if((st===3||st===4)&&(st=oe.stateNode.containerInfo,st===V||st.nodeType===8&&st.parentNode===V))return;oe=oe.return}for(;Le!==null;){if(oe=El(Le),oe===null)return;if(st=oe.tag,st===5||st===6){j=Q=oe;continue e}Le=Le.parentNode}}j=j.return}Qr(function(){var Vt=Q,Ur=Ft(b),Wr=[];e:{var Gr=Fd.get(n);if(Gr!==void 0){var sn=wu,an=n;switch(n){case"keypress":if(Dc(b)===0)break e;case"keydown":case"keyup":sn=Lh;break;case"focusin":an="focus",sn=Fl;break;case"focusout":an="blur",sn=Fl;break;case"beforeblur":case"afterblur":sn=Fl;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":sn=vd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":sn=kh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":sn=Ol;break;case Ou:case Lu:case Dd:sn=Nh;break;case jd:sn=bd;break;case"scroll":sn=Rh;break;case"wheel":sn=Cu;break;case"copy":case"cut":case"paste":sn=Ih;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":sn=xd}var bn=(a&4)!==0,Gs=!bn&&n==="scroll",Et=bn?Gr!==null?Gr+"Capture":null:Gr;bn=[];for(var ot=Vt,Tt;ot!==null;){Tt=ot;var qr=Tt.stateNode;if(Tt.tag===5&&qr!==null&&(Tt=qr,Et!==null&&(qr=Xr(ot,Et),qr!=null&&bn.push(pc(ot,qr,Tt)))),Gs)break;ot=ot.return}0<bn.length&&(Gr=new sn(Gr,an,null,b,Ur),Wr.push({event:Gr,listeners:bn}))}}if((a&7)===0){e:{if(Gr=n==="mouseover"||n==="pointerover",sn=n==="mouseout"||n==="pointerout",Gr&&b!==et&&(an=b.relatedTarget||b.fromElement)&&(El(an)||an[ya]))break e;if((sn||Gr)&&(Gr=Ur.window===Ur?Ur:(Gr=Ur.ownerDocument)?Gr.defaultView||Gr.parentWindow:window,sn?(an=b.relatedTarget||b.toElement,sn=Vt,an=an?El(an):null,an!==null&&(Gs=ei(an),an!==Gs||an.tag!==5&&an.tag!==6)&&(an=null)):(sn=null,an=Vt),sn!==an)){if(bn=vd,qr="onMouseLeave",Et="onMouseEnter",ot="mouse",(n==="pointerout"||n==="pointerover")&&(bn=xd,qr="onPointerLeave",Et="onPointerEnter",ot="pointer"),Gs=sn==null?Gr:Wl(sn),Tt=an==null?Gr:Wl(an),Gr=new bn(qr,ot+"leave",sn,b,Ur),Gr.target=Gs,Gr.relatedTarget=Tt,qr=null,El(Ur)===Vt&&(bn=new bn(Et,ot+"enter",an,b,Ur),bn.target=Tt,bn.relatedTarget=Gs,qr=bn),Gs=qr,sn&&an)t:{for(bn=sn,Et=an,ot=0,Tt=bn;Tt;Tt=Vl(Tt))ot++;for(Tt=0,qr=Et;qr;qr=Vl(qr))Tt++;for(;0<ot-Tt;)bn=Vl(bn),ot--;for(;0<Tt-ot;)Et=Vl(Et),Tt--;for(;ot--;){if(bn===Et||Et!==null&&bn===Et.alternate)break t;bn=Vl(bn),Et=Vl(Et)}bn=null}else bn=null;sn!==null&&Gd(Wr,Gr,sn,bn,!1),an!==null&&Gs!==null&&Gd(Wr,Gs,an,bn,!0)}}e:{if(Gr=Vt?Wl(Vt):window,sn=Gr.nodeName&&Gr.nodeName.toLowerCase(),sn==="select"||sn==="input"&&Gr.type==="file")var wn=Td;else if(Rd(Gr))if(uc)wn=Id;else{wn=Nd;var kn=Md}else(sn=Gr.nodeName)&&sn.toLowerCase()==="input"&&(Gr.type==="checkbox"||Gr.type==="radio")&&(wn=zd);if(wn&&(wn=wn(n,Vt))){Ad(Wr,wn,b,Ur);break e}kn&&kn(n,Gr,Vt),n==="focusout"&&(kn=Gr._wrapperState)&&kn.controlled&&Gr.type==="number"&&Br(Gr,"number",Gr.value)}switch(kn=Vt?Wl(Vt):window,n){case"focusin":(Rd(kn)||kn.contentEditable==="true")&&(Ua=kn,Hc=Vt,Gl=null);break;case"focusout":Gl=Hc=Ua=null;break;case"mousedown":Yc=!0;break;case"contextmenu":case"mouseup":case"dragend":Yc=!1,ju(Wr,b,Ur);break;case"selectionchange":if(Wc)break;case"keydown":case"keyup":ju(Wr,b,Ur)}var Tn;if(Ru)e:{switch(n){case"compositionstart":var In="onCompositionStart";break e;case"compositionend":In="onCompositionEnd";break e;case"compositionupdate":In="onCompositionUpdate";break e}In=void 0}else xl?ku(n,b)&&(In="onCompositionEnd"):n==="keydown"&&b.keyCode===229&&(In="onCompositionStart");In&&(Sd&&b.locale!=="ko"&&(xl||In!=="onCompositionStart"?In==="onCompositionEnd"&&xl&&(Tn=yd()):(Ka=Ur,gl="value"in Ka?Ka.value:Ka.textContent,xl=!0)),kn=Qc(Vt,In),0<kn.length&&(In=new jc(In,n,null,b,Ur),Wr.push({event:In,listeners:kn}),Tn?In.data=Tn:(Tn=Tu(b),Tn!==null&&(In.data=Tn)))),(Tn=Gh?Uh(n,b):Oc(n,b))&&(Vt=Qc(Vt,"onBeforeInput"),0<Vt.length&&(Ur=new jc("onBeforeInput","beforeinput",null,b,Ur),Wr.push({event:Ur,listeners:Vt}),Ur.data=Tn))}Jc(Wr,a)})}function pc(n,a,b){return{instance:n,listener:a,currentTarget:b}}function Qc(n,a){for(var b=a+"Capture",j=[];n!==null;){var V=n,Q=V.stateNode;V.tag===5&&Q!==null&&(V=Q,Q=Xr(n,b),Q!=null&&j.unshift(pc(n,Q,V)),Q=Xr(n,a),Q!=null&&j.push(pc(n,Q,V))),n=n.return}return j}function Vl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Gd(n,a,b,j,V){for(var Q=a._reactName,oe=[];b!==null&&b!==j;){var Le=b,st=Le.alternate,Vt=Le.stateNode;if(st!==null&&st===j)break;Le.tag===5&&Vt!==null&&(Le=Vt,V?(st=Xr(b,Q),st!=null&&oe.unshift(pc(b,st,Le))):V||(st=Xr(b,Q),st!=null&&oe.push(pc(b,st,Le)))),b=b.return}oe.length!==0&&n.push({event:a,listeners:oe})}var $h=/\r\n?/g,Wh=/\u0000|\uFFFD/g;function Ud(n){return(typeof n=="string"?n:""+n).replace($h,`
`).replace(Wh,"")}function Zc(n,a,b){if(a=Ud(a),Ud(n)!==a&&b)throw Error(t(425))}function Kc(){}var $u=null,Wu=null;function ka(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Hu=typeof setTimeout=="function"?setTimeout:void 0,Hh=typeof clearTimeout=="function"?clearTimeout:void 0,Yu=typeof Promise=="function"?Promise:void 0,Yh=typeof queueMicrotask=="function"?queueMicrotask:typeof Yu<"u"?function(n){return Yu.resolve(null).then(n).catch(qh)}:Hu;function qh(n){setTimeout(function(){throw n})}function wl(n,a){var b=a,j=0;do{var V=b.nextSibling;if(n.removeChild(b),V&&V.nodeType===8)if(b=V.data,b==="/$"){if(j===0){n.removeChild(V),ic(a);return}j--}else b!=="$"&&b!=="$?"&&b!=="$!"||j++;b=V}while(b);ic(a)}function Ia(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return n}function eu(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var b=n.data;if(b==="$"||b==="$!"||b==="$?"){if(a===0)return n;a--}else b==="/$"&&a++}n=n.previousSibling}return null}var $l=Math.random().toString(36).slice(2),Ta="__reactFiber$"+$l,mc="__reactProps$"+$l,ya="__reactContainer$"+$l,gc="__reactEvents$"+$l,Xh="__reactListeners$"+$l,Jh="__reactHandles$"+$l;function El(n){var a=n[Ta];if(a)return a;for(var b=n.parentNode;b;){if(a=b[ya]||b[Ta]){if(b=a.alternate,a.child!==null||b!==null&&b.child!==null)for(n=eu(n);n!==null;){if(b=n[Ta])return b;n=eu(n)}return a}n=b,b=n.parentNode}return null}function yc(n){return n=n[Ta]||n[ya],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Wl(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(t(33))}function tu(n){return n[mc]||null}var qu=[],Hl=-1;function rl(n){return{current:n}}function gi(n){0>Hl||(n.current=qu[Hl],qu[Hl]=null,Hl--)}function fi(n,a){Hl++,qu[Hl]=n.current,n.current=a}var nl={},Js=rl(nl),la=rl(!1),il=nl;function Sl(n,a){var b=n.type.contextTypes;if(!b)return nl;var j=n.stateNode;if(j&&j.__reactInternalMemoizedUnmaskedChildContext===a)return j.__reactInternalMemoizedMaskedChildContext;var V={},Q;for(Q in b)V[Q]=a[Q];return j&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=a,n.__reactInternalMemoizedMaskedChildContext=V),V}function na(n){return n=n.childContextTypes,n!=null}function vc(){gi(la),gi(Js)}function Xu(n,a,b){if(Js.current!==nl)throw Error(t(168));fi(Js,a),fi(la,b)}function Ju(n,a,b){var j=n.stateNode;if(a=a.childContextTypes,typeof j.getChildContext!="function")return b;j=j.getChildContext();for(var V in j)if(!(V in a))throw Error(t(108,De(n)||"Unknown",V));return G({},b,j)}function xc(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||nl,il=Js.current,fi(Js,n),fi(la,la.current),!0}function Qu(n,a,b){var j=n.stateNode;if(!j)throw Error(t(169));b?(n=Ju(n,a,il),j.__reactInternalMemoizedMergedChildContext=n,gi(la),gi(Js),fi(Js,n)):gi(la),fi(la,b)}var Pa=null,ru=!1,I=!1;function K(n){Pa===null?Pa=[n]:Pa.push(n)}function O(n){ru=!0,K(n)}function be(){if(!I&&Pa!==null){I=!0;var n=0,a=Dn;try{var b=Pa;for(Dn=1;n<b.length;n++){var j=b[n];do j=j(!0);while(j!==null)}Pa=null,ru=!1}catch(V){throw Pa!==null&&(Pa=Pa.slice(n+1)),ll(La,be),V}finally{Dn=a,I=!1}}return null}var Ee=[],Fe=0,St=null,ct=0,Kr=[],nt=0,_t=null,Ln=1,Hr="";function Lr(n,a){Ee[Fe++]=ct,Ee[Fe++]=St,St=n,ct=a}function pi(n,a,b){Kr[nt++]=Ln,Kr[nt++]=Hr,Kr[nt++]=_t,_t=n;var j=Ln;n=Hr;var V=32-ma(j)-1;j&=~(1<<V),b+=1;var Q=32-ma(a)+V;if(30<Q){var oe=V-V%5;Q=(j&(1<<oe)-1).toString(32),j>>=oe,V-=oe,Ln=1<<32-ma(a)+V|b<<V|j,Hr=Q+n}else Ln=1<<Q|b<<V|j,Hr=n}function vi(n){n.return!==null&&(Lr(n,1),pi(n,1,0))}function ti(n){for(;n===St;)St=Ee[--Fe],Ee[Fe]=null,ct=Ee[--Fe],Ee[Fe]=null;for(;n===_t;)_t=Kr[--nt],Kr[nt]=null,Hr=Kr[--nt],Kr[nt]=null,Ln=Kr[--nt],Kr[nt]=null}var Cn=null,En=null,$r=!1,Rn=null;function ks(n,a){var b=Oa(5,null,null,0);b.elementType="DELETED",b.stateNode=a,b.return=n,a=n.deletions,a===null?(n.deletions=[b],n.flags|=16):a.push(b)}function ni(n,a){switch(n.tag){case 5:var b=n.type;return a=a.nodeType!==1||b.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(n.stateNode=a,Cn=n,En=Ia(a.firstChild),!0):!1;case 6:return a=n.pendingProps===""||a.nodeType!==3?null:a,a!==null?(n.stateNode=a,Cn=n,En=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(b=_t!==null?{id:Ln,overflow:Hr}:null,n.memoizedState={dehydrated:a,treeContext:b,retryLane:1073741824},b=Oa(18,null,null,0),b.stateNode=a,b.return=n,n.child=b,Cn=n,En=null,!0):!1;default:return!1}}function Bn(n){return(n.mode&1)!==0&&(n.flags&128)===0}function li(n){if($r){var a=En;if(a){var b=a;if(!ni(n,a)){if(Bn(n))throw Error(t(418));a=Ia(b.nextSibling);var j=Cn;a&&ni(n,a)?ks(j,b):(n.flags=n.flags&-4097|2,$r=!1,Cn=n)}}else{if(Bn(n))throw Error(t(418));n.flags=n.flags&-4097|2,$r=!1,Cn=n}}}function An(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Cn=n}function jn(n){if(n!==Cn)return!1;if(!$r)return An(n),$r=!0,!1;var a;if((a=n.tag!==3)&&!(a=n.tag!==5)&&(a=n.type,a=a!=="head"&&a!=="body"&&!ka(n.type,n.memoizedProps)),a&&(a=En)){if(Bn(n))throw Qs(),Error(t(418));for(;a;)ks(n,a),a=Ia(a.nextSibling)}if(An(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(t(317));e:{for(n=n.nextSibling,a=0;n;){if(n.nodeType===8){var b=n.data;if(b==="/$"){if(a===0){En=Ia(n.nextSibling);break e}a--}else b!=="$"&&b!=="$!"&&b!=="$?"||a++}n=n.nextSibling}En=null}}else En=Cn?Ia(n.stateNode.nextSibling):null;return!0}function Qs(){for(var n=En;n;)n=Ia(n.nextSibling)}function ba(){En=Cn=null,$r=!1}function nu(n){Rn===null?Rn=[n]:Rn.push(n)}var iu=C.ReactCurrentBatchConfig;function ca(n,a){if(n&&n.defaultProps){a=G({},a),n=n.defaultProps;for(var b in n)a[b]===void 0&&(a[b]=n[b]);return a}return a}var Vd=rl(null),$d=null,su=null,Qh=null;function Zh(){Qh=su=$d=null}function Kh(n){var a=Vd.current;gi(Vd),n._currentValue=a}function ef(n,a,b){for(;n!==null;){var j=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,j!==null&&(j.childLanes|=a)):j!==null&&(j.childLanes&a)!==a&&(j.childLanes|=a),n===b)break;n=n.return}}function ou(n,a){$d=n,Qh=su=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&a)!==0&&(wa=!0),n.firstContext=null)}function Da(n){var a=n._currentValue;if(Qh!==n)if(n={context:n,memoizedValue:a,next:null},su===null){if($d===null)throw Error(t(308));su=n,$d.dependencies={lanes:0,firstContext:n}}else su=su.next=n;return a}var _c=null;function tf(n){_c===null?_c=[n]:_c.push(n)}function qf(n,a,b,j){var V=a.interleaved;return V===null?(b.next=b,tf(a)):(b.next=V.next,V.next=b),a.interleaved=b,Cl(n,j)}function Cl(n,a){n.lanes|=a;var b=n.alternate;for(b!==null&&(b.lanes|=a),b=n,n=n.return;n!==null;)n.childLanes|=a,b=n.alternate,b!==null&&(b.childLanes|=a),b=n,n=n.return;return b.tag===3?b.stateNode:null}var Yl=!1;function rf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Xf(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Rl(n,a){return{eventTime:n,lane:a,tag:0,payload:null,callback:null,next:null}}function ql(n,a,b){var j=n.updateQueue;if(j===null)return null;if(j=j.shared,(si&2)!==0){var V=j.pending;return V===null?a.next=a:(a.next=V.next,V.next=a),j.pending=a,Cl(n,b)}return V=j.interleaved,V===null?(a.next=a,tf(j)):(a.next=V.next,V.next=a),j.interleaved=a,Cl(n,b)}function Wd(n,a,b){if(a=a.updateQueue,a!==null&&(a=a.shared,(b&4194240)!==0)){var j=a.lanes;j&=n.pendingLanes,b|=j,a.lanes=b,za(n,b)}}function Jf(n,a){var b=n.updateQueue,j=n.alternate;if(j!==null&&(j=j.updateQueue,b===j)){var V=null,Q=null;if(b=b.firstBaseUpdate,b!==null){do{var oe={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};Q===null?V=Q=oe:Q=Q.next=oe,b=b.next}while(b!==null);Q===null?V=Q=a:Q=Q.next=a}else V=Q=a;b={baseState:j.baseState,firstBaseUpdate:V,lastBaseUpdate:Q,shared:j.shared,effects:j.effects},n.updateQueue=b;return}n=b.lastBaseUpdate,n===null?b.firstBaseUpdate=a:n.next=a,b.lastBaseUpdate=a}function Hd(n,a,b,j){var V=n.updateQueue;Yl=!1;var Q=V.firstBaseUpdate,oe=V.lastBaseUpdate,Le=V.shared.pending;if(Le!==null){V.shared.pending=null;var st=Le,Vt=st.next;st.next=null,oe===null?Q=Vt:oe.next=Vt,oe=st;var Ur=n.alternate;Ur!==null&&(Ur=Ur.updateQueue,Le=Ur.lastBaseUpdate,Le!==oe&&(Le===null?Ur.firstBaseUpdate=Vt:Le.next=Vt,Ur.lastBaseUpdate=st))}if(Q!==null){var Wr=V.baseState;oe=0,Ur=Vt=st=null,Le=Q;do{var Gr=Le.lane,sn=Le.eventTime;if((j&Gr)===Gr){Ur!==null&&(Ur=Ur.next={eventTime:sn,lane:0,tag:Le.tag,payload:Le.payload,callback:Le.callback,next:null});e:{var an=n,bn=Le;switch(Gr=a,sn=b,bn.tag){case 1:if(an=bn.payload,typeof an=="function"){Wr=an.call(sn,Wr,Gr);break e}Wr=an;break e;case 3:an.flags=an.flags&-65537|128;case 0:if(an=bn.payload,Gr=typeof an=="function"?an.call(sn,Wr,Gr):an,Gr==null)break e;Wr=G({},Wr,Gr);break e;case 2:Yl=!0}}Le.callback!==null&&Le.lane!==0&&(n.flags|=64,Gr=V.effects,Gr===null?V.effects=[Le]:Gr.push(Le))}else sn={eventTime:sn,lane:Gr,tag:Le.tag,payload:Le.payload,callback:Le.callback,next:null},Ur===null?(Vt=Ur=sn,st=Wr):Ur=Ur.next=sn,oe|=Gr;if(Le=Le.next,Le===null){if(Le=V.shared.pending,Le===null)break;Gr=Le,Le=Gr.next,Gr.next=null,V.lastBaseUpdate=Gr,V.shared.pending=null}}while(!0);if(Ur===null&&(st=Wr),V.baseState=st,V.firstBaseUpdate=Vt,V.lastBaseUpdate=Ur,a=V.shared.interleaved,a!==null){V=a;do oe|=V.lane,V=V.next;while(V!==a)}else Q===null&&(V.shared.lanes=0);Ec|=oe,n.lanes=oe,n.memoizedState=Wr}}function Qf(n,a,b){if(n=a.effects,a.effects=null,n!==null)for(a=0;a<n.length;a++){var j=n[a],V=j.callback;if(V!==null){if(j.callback=null,j=b,typeof V!="function")throw Error(t(191,V));V.call(j)}}}var Zf=new e.Component().refs;function nf(n,a,b,j){a=n.memoizedState,b=b(j,a),b=b==null?a:G({},a,b),n.memoizedState=b,n.lanes===0&&(n.updateQueue.baseState=b)}var Yd={isMounted:function(n){return(n=n._reactInternals)?ei(n)===n:!1},enqueueSetState:function(n,a,b){n=n._reactInternals;var j=xa(),V=Zl(n),Q=Rl(j,V);Q.payload=a,b!=null&&(Q.callback=b),a=ql(n,Q,V),a!==null&&(Ha(a,n,V,j),Wd(a,n,V))},enqueueReplaceState:function(n,a,b){n=n._reactInternals;var j=xa(),V=Zl(n),Q=Rl(j,V);Q.tag=1,Q.payload=a,b!=null&&(Q.callback=b),a=ql(n,Q,V),a!==null&&(Ha(a,n,V,j),Wd(a,n,V))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var b=xa(),j=Zl(n),V=Rl(b,j);V.tag=2,a!=null&&(V.callback=a),a=ql(n,V,j),a!==null&&(Ha(a,n,j,b),Wd(a,n,j))}};function Kf(n,a,b,j,V,Q,oe){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(j,Q,oe):a.prototype&&a.prototype.isPureReactComponent?!bl(b,j)||!bl(V,Q):!0}function ep(n,a,b){var j=!1,V=nl,Q=a.contextType;return typeof Q=="object"&&Q!==null?Q=Da(Q):(V=na(a)?il:Js.current,j=a.contextTypes,Q=(j=j!=null)?Sl(n,V):nl),a=new a(b,Q),n.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Yd,n.stateNode=a,a._reactInternals=n,j&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=V,n.__reactInternalMemoizedMaskedChildContext=Q),a}function tp(n,a,b,j){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(b,j),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(b,j),a.state!==n&&Yd.enqueueReplaceState(a,a.state,null)}function sf(n,a,b,j){var V=n.stateNode;V.props=b,V.state=n.memoizedState,V.refs=Zf,rf(n);var Q=a.contextType;typeof Q=="object"&&Q!==null?V.context=Da(Q):(Q=na(a)?il:Js.current,V.context=Sl(n,Q)),V.state=n.memoizedState,Q=a.getDerivedStateFromProps,typeof Q=="function"&&(nf(n,a,Q,b),V.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof V.getSnapshotBeforeUpdate=="function"||typeof V.UNSAFE_componentWillMount!="function"&&typeof V.componentWillMount!="function"||(a=V.state,typeof V.componentWillMount=="function"&&V.componentWillMount(),typeof V.UNSAFE_componentWillMount=="function"&&V.UNSAFE_componentWillMount(),a!==V.state&&Yd.enqueueReplaceState(V,V.state,null),Hd(n,b,V,j),V.state=n.memoizedState),typeof V.componentDidMount=="function"&&(n.flags|=4194308)}function Zu(n,a,b){if(n=b.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(t(309));var j=b.stateNode}if(!j)throw Error(t(147,n));var V=j,Q=""+n;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===Q?a.ref:(a=function(oe){var Le=V.refs;Le===Zf&&(Le=V.refs={}),oe===null?delete Le[Q]:Le[Q]=oe},a._stringRef=Q,a)}if(typeof n!="string")throw Error(t(284));if(!b._owner)throw Error(t(290,n))}return n}function qd(n,a){throw n=Object.prototype.toString.call(a),Error(t(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n))}function rp(n){var a=n._init;return a(n._payload)}function np(n){function a(Et,ot){if(n){var Tt=Et.deletions;Tt===null?(Et.deletions=[ot],Et.flags|=16):Tt.push(ot)}}function b(Et,ot){if(!n)return null;for(;ot!==null;)a(Et,ot),ot=ot.sibling;return null}function j(Et,ot){for(Et=new Map;ot!==null;)ot.key!==null?Et.set(ot.key,ot):Et.set(ot.index,ot),ot=ot.sibling;return Et}function V(Et,ot){return Et=ec(Et,ot),Et.index=0,Et.sibling=null,Et}function Q(Et,ot,Tt){return Et.index=Tt,n?(Tt=Et.alternate,Tt!==null?(Tt=Tt.index,Tt<ot?(Et.flags|=2,ot):Tt):(Et.flags|=2,ot)):(Et.flags|=1048576,ot)}function oe(Et){return n&&Et.alternate===null&&(Et.flags|=2),Et}function Le(Et,ot,Tt,qr){return ot===null||ot.tag!==6?(ot=Uf(Tt,Et.mode,qr),ot.return=Et,ot):(ot=V(ot,Tt),ot.return=Et,ot)}function st(Et,ot,Tt,qr){var wn=Tt.type;return wn===k?Ur(Et,ot,Tt.props.children,qr,Tt.key):ot!==null&&(ot.elementType===wn||typeof wn=="object"&&wn!==null&&wn.$$typeof===U&&rp(wn)===ot.type)?(qr=V(ot,Tt.props),qr.ref=Zu(Et,ot,Tt),qr.return=Et,qr):(qr=fh(Tt.type,Tt.key,Tt.props,null,Et.mode,qr),qr.ref=Zu(Et,ot,Tt),qr.return=Et,qr)}function Vt(Et,ot,Tt,qr){return ot===null||ot.tag!==4||ot.stateNode.containerInfo!==Tt.containerInfo||ot.stateNode.implementation!==Tt.implementation?(ot=Vf(Tt,Et.mode,qr),ot.return=Et,ot):(ot=V(ot,Tt.children||[]),ot.return=Et,ot)}function Ur(Et,ot,Tt,qr,wn){return ot===null||ot.tag!==7?(ot=Ac(Tt,Et.mode,qr,wn),ot.return=Et,ot):(ot=V(ot,Tt),ot.return=Et,ot)}function Wr(Et,ot,Tt){if(typeof ot=="string"&&ot!==""||typeof ot=="number")return ot=Uf(""+ot,Et.mode,Tt),ot.return=Et,ot;if(typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case h:return Tt=fh(ot.type,ot.key,ot.props,null,Et.mode,Tt),Tt.ref=Zu(Et,null,ot),Tt.return=Et,Tt;case x:return ot=Vf(ot,Et.mode,Tt),ot.return=Et,ot;case U:var qr=ot._init;return Wr(Et,qr(ot._payload),Tt)}if(zr(ot)||q(ot))return ot=Ac(ot,Et.mode,Tt,null),ot.return=Et,ot;qd(Et,ot)}return null}function Gr(Et,ot,Tt,qr){var wn=ot!==null?ot.key:null;if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number")return wn!==null?null:Le(Et,ot,""+Tt,qr);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case h:return Tt.key===wn?st(Et,ot,Tt,qr):null;case x:return Tt.key===wn?Vt(Et,ot,Tt,qr):null;case U:return wn=Tt._init,Gr(Et,ot,wn(Tt._payload),qr)}if(zr(Tt)||q(Tt))return wn!==null?null:Ur(Et,ot,Tt,qr,null);qd(Et,Tt)}return null}function sn(Et,ot,Tt,qr,wn){if(typeof qr=="string"&&qr!==""||typeof qr=="number")return Et=Et.get(Tt)||null,Le(ot,Et,""+qr,wn);if(typeof qr=="object"&&qr!==null){switch(qr.$$typeof){case h:return Et=Et.get(qr.key===null?Tt:qr.key)||null,st(ot,Et,qr,wn);case x:return Et=Et.get(qr.key===null?Tt:qr.key)||null,Vt(ot,Et,qr,wn);case U:var kn=qr._init;return sn(Et,ot,Tt,kn(qr._payload),wn)}if(zr(qr)||q(qr))return Et=Et.get(Tt)||null,Ur(ot,Et,qr,wn,null);qd(ot,qr)}return null}function an(Et,ot,Tt,qr){for(var wn=null,kn=null,Tn=ot,In=ot=0,ta=null;Tn!==null&&In<Tt.length;In++){Tn.index>In?(ta=Tn,Tn=null):ta=Tn.sibling;var oi=Gr(Et,Tn,Tt[In],qr);if(oi===null){Tn===null&&(Tn=ta);break}n&&Tn&&oi.alternate===null&&a(Et,Tn),ot=Q(oi,ot,In),kn===null?wn=oi:kn.sibling=oi,kn=oi,Tn=ta}if(In===Tt.length)return b(Et,Tn),$r&&Lr(Et,In),wn;if(Tn===null){for(;In<Tt.length;In++)Tn=Wr(Et,Tt[In],qr),Tn!==null&&(ot=Q(Tn,ot,In),kn===null?wn=Tn:kn.sibling=Tn,kn=Tn);return $r&&Lr(Et,In),wn}for(Tn=j(Et,Tn);In<Tt.length;In++)ta=sn(Tn,Et,In,Tt[In],qr),ta!==null&&(n&&ta.alternate!==null&&Tn.delete(ta.key===null?In:ta.key),ot=Q(ta,ot,In),kn===null?wn=ta:kn.sibling=ta,kn=ta);return n&&Tn.forEach(function(tc){return a(Et,tc)}),$r&&Lr(Et,In),wn}function bn(Et,ot,Tt,qr){var wn=q(Tt);if(typeof wn!="function")throw Error(t(150));if(Tt=wn.call(Tt),Tt==null)throw Error(t(151));for(var kn=wn=null,Tn=ot,In=ot=0,ta=null,oi=Tt.next();Tn!==null&&!oi.done;In++,oi=Tt.next()){Tn.index>In?(ta=Tn,Tn=null):ta=Tn.sibling;var tc=Gr(Et,Tn,oi.value,qr);if(tc===null){Tn===null&&(Tn=ta);break}n&&Tn&&tc.alternate===null&&a(Et,Tn),ot=Q(tc,ot,In),kn===null?wn=tc:kn.sibling=tc,kn=tc,Tn=ta}if(oi.done)return b(Et,Tn),$r&&Lr(Et,In),wn;if(Tn===null){for(;!oi.done;In++,oi=Tt.next())oi=Wr(Et,oi.value,qr),oi!==null&&(ot=Q(oi,ot,In),kn===null?wn=oi:kn.sibling=oi,kn=oi);return $r&&Lr(Et,In),wn}for(Tn=j(Et,Tn);!oi.done;In++,oi=Tt.next())oi=sn(Tn,Et,In,oi.value,qr),oi!==null&&(n&&oi.alternate!==null&&Tn.delete(oi.key===null?In:oi.key),ot=Q(oi,ot,In),kn===null?wn=oi:kn.sibling=oi,kn=oi);return n&&Tn.forEach(function(Jm){return a(Et,Jm)}),$r&&Lr(Et,In),wn}function Gs(Et,ot,Tt,qr){if(typeof Tt=="object"&&Tt!==null&&Tt.type===k&&Tt.key===null&&(Tt=Tt.props.children),typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case h:e:{for(var wn=Tt.key,kn=ot;kn!==null;){if(kn.key===wn){if(wn=Tt.type,wn===k){if(kn.tag===7){b(Et,kn.sibling),ot=V(kn,Tt.props.children),ot.return=Et,Et=ot;break e}}else if(kn.elementType===wn||typeof wn=="object"&&wn!==null&&wn.$$typeof===U&&rp(wn)===kn.type){b(Et,kn.sibling),ot=V(kn,Tt.props),ot.ref=Zu(Et,kn,Tt),ot.return=Et,Et=ot;break e}b(Et,kn);break}else a(Et,kn);kn=kn.sibling}Tt.type===k?(ot=Ac(Tt.props.children,Et.mode,qr,Tt.key),ot.return=Et,Et=ot):(qr=fh(Tt.type,Tt.key,Tt.props,null,Et.mode,qr),qr.ref=Zu(Et,ot,Tt),qr.return=Et,Et=qr)}return oe(Et);case x:e:{for(kn=Tt.key;ot!==null;){if(ot.key===kn)if(ot.tag===4&&ot.stateNode.containerInfo===Tt.containerInfo&&ot.stateNode.implementation===Tt.implementation){b(Et,ot.sibling),ot=V(ot,Tt.children||[]),ot.return=Et,Et=ot;break e}else{b(Et,ot);break}else a(Et,ot);ot=ot.sibling}ot=Vf(Tt,Et.mode,qr),ot.return=Et,Et=ot}return oe(Et);case U:return kn=Tt._init,Gs(Et,ot,kn(Tt._payload),qr)}if(zr(Tt))return an(Et,ot,Tt,qr);if(q(Tt))return bn(Et,ot,Tt,qr);qd(Et,Tt)}return typeof Tt=="string"&&Tt!==""||typeof Tt=="number"?(Tt=""+Tt,ot!==null&&ot.tag===6?(b(Et,ot.sibling),ot=V(ot,Tt),ot.return=Et,Et=ot):(b(Et,ot),ot=Uf(Tt,Et.mode,qr),ot.return=Et,Et=ot),oe(Et)):b(Et,ot)}return Gs}var au=np(!0),ip=np(!1),Ku={},sl=rl(Ku),ed=rl(Ku),td=rl(Ku);function bc(n){if(n===Ku)throw Error(t(174));return n}function of(n,a){switch(fi(td,a),fi(ed,n),fi(sl,Ku),n=a.nodeType,n){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:ie(null,"");break;default:n=n===8?a.parentNode:a,a=n.namespaceURI||null,n=n.tagName,a=ie(a,n)}gi(sl),fi(sl,a)}function lu(){gi(sl),gi(ed),gi(td)}function sp(n){bc(td.current);var a=bc(sl.current),b=ie(a,n.type);a!==b&&(fi(ed,n),fi(sl,b))}function af(n){ed.current===n&&(gi(sl),gi(ed))}var ls=rl(0);function Xd(n){for(var a=n;a!==null;){if(a.tag===13){var b=a.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||b.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var lf=[];function cf(){for(var n=0;n<lf.length;n++)lf[n]._workInProgressVersionPrimary=null;lf.length=0}var Jd=C.ReactCurrentDispatcher,uf=C.ReactCurrentBatchConfig,wc=0,Ss=null,Hs=null,Ks=null,Qd=!1,rd=!1,nd=0,vm=0;function ua(){throw Error(t(321))}function df(n,a){if(a===null)return!1;for(var b=0;b<a.length&&b<n.length;b++)if(!Ls(n[b],a[b]))return!1;return!0}function hf(n,a,b,j,V,Q){if(wc=Q,Ss=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Jd.current=n===null||n.memoizedState===null?wm:Em,n=b(j,V),rd){Q=0;do{if(rd=!1,nd=0,25<=Q)throw Error(t(301));Q+=1,Ks=Hs=null,a.updateQueue=null,Jd.current=Sm,n=b(j,V)}while(rd)}if(Jd.current=eh,a=Hs!==null&&Hs.next!==null,wc=0,Ks=Hs=Ss=null,Qd=!1,a)throw Error(t(300));return n}function ff(){var n=nd!==0;return nd=0,n}function ol(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ks===null?Ss.memoizedState=Ks=n:Ks=Ks.next=n,Ks}function ja(){if(Hs===null){var n=Ss.alternate;n=n!==null?n.memoizedState:null}else n=Hs.next;var a=Ks===null?Ss.memoizedState:Ks.next;if(a!==null)Ks=a,Hs=n;else{if(n===null)throw Error(t(310));Hs=n,n={memoizedState:Hs.memoizedState,baseState:Hs.baseState,baseQueue:Hs.baseQueue,queue:Hs.queue,next:null},Ks===null?Ss.memoizedState=Ks=n:Ks=Ks.next=n}return Ks}function sd(n,a){return typeof a=="function"?a(n):a}function pf(n){var a=ja(),b=a.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=n;var j=Hs,V=j.baseQueue,Q=b.pending;if(Q!==null){if(V!==null){var oe=V.next;V.next=Q.next,Q.next=oe}j.baseQueue=V=Q,b.pending=null}if(V!==null){Q=V.next,j=j.baseState;var Le=oe=null,st=null,Vt=Q;do{var Ur=Vt.lane;if((wc&Ur)===Ur)st!==null&&(st=st.next={lane:0,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null}),j=Vt.hasEagerState?Vt.eagerState:n(j,Vt.action);else{var Wr={lane:Ur,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null};st===null?(Le=st=Wr,oe=j):st=st.next=Wr,Ss.lanes|=Ur,Ec|=Ur}Vt=Vt.next}while(Vt!==null&&Vt!==Q);st===null?oe=j:st.next=Le,Ls(j,a.memoizedState)||(wa=!0),a.memoizedState=j,a.baseState=oe,a.baseQueue=st,b.lastRenderedState=j}if(n=b.interleaved,n!==null){V=n;do Q=V.lane,Ss.lanes|=Q,Ec|=Q,V=V.next;while(V!==n)}else V===null&&(b.lanes=0);return[a.memoizedState,b.dispatch]}function mf(n){var a=ja(),b=a.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=n;var j=b.dispatch,V=b.pending,Q=a.memoizedState;if(V!==null){b.pending=null;var oe=V=V.next;do Q=n(Q,oe.action),oe=oe.next;while(oe!==V);Ls(Q,a.memoizedState)||(wa=!0),a.memoizedState=Q,a.baseQueue===null&&(a.baseState=Q),b.lastRenderedState=Q}return[Q,j]}function op(){}function ap(n,a){var b=Ss,j=ja(),V=a(),Q=!Ls(j.memoizedState,V);if(Q&&(j.memoizedState=V,wa=!0),j=j.queue,gf(up.bind(null,b,j,n),[n]),j.getSnapshot!==a||Q||Ks!==null&&Ks.memoizedState.tag&1){if(b.flags|=2048,od(9,cp.bind(null,b,j,V,a),void 0,null),ea===null)throw Error(t(349));(wc&30)!==0||lp(b,a,V)}return V}function lp(n,a,b){n.flags|=16384,n={getSnapshot:a,value:b},a=Ss.updateQueue,a===null?(a={lastEffect:null,stores:null},Ss.updateQueue=a,a.stores=[n]):(b=a.stores,b===null?a.stores=[n]:b.push(n))}function cp(n,a,b,j){a.value=b,a.getSnapshot=j,dp(a)&&hp(n)}function up(n,a,b){return b(function(){dp(a)&&hp(n)})}function dp(n){var a=n.getSnapshot;n=n.value;try{var b=a();return!Ls(n,b)}catch{return!0}}function hp(n){var a=Cl(n,1);a!==null&&Ha(a,n,1,-1)}function fp(n){var a=ol();return typeof n=="function"&&(n=n()),a.memoizedState=a.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sd,lastRenderedState:n},a.queue=n,n=n.dispatch=bm.bind(null,Ss,n),[a.memoizedState,n]}function od(n,a,b,j){return n={tag:n,create:a,destroy:b,deps:j,next:null},a=Ss.updateQueue,a===null?(a={lastEffect:null,stores:null},Ss.updateQueue=a,a.lastEffect=n.next=n):(b=a.lastEffect,b===null?a.lastEffect=n.next=n:(j=b.next,b.next=n,n.next=j,a.lastEffect=n)),n}function pp(){return ja().memoizedState}function Zd(n,a,b,j){var V=ol();Ss.flags|=n,V.memoizedState=od(1|a,b,void 0,j===void 0?null:j)}function Kd(n,a,b,j){var V=ja();j=j===void 0?null:j;var Q=void 0;if(Hs!==null){var oe=Hs.memoizedState;if(Q=oe.destroy,j!==null&&df(j,oe.deps)){V.memoizedState=od(a,b,Q,j);return}}Ss.flags|=n,V.memoizedState=od(1|a,b,Q,j)}function mp(n,a){return Zd(8390656,8,n,a)}function gf(n,a){return Kd(2048,8,n,a)}function gp(n,a){return Kd(4,2,n,a)}function yp(n,a){return Kd(4,4,n,a)}function vp(n,a){if(typeof a=="function")return n=n(),a(n),function(){a(null)};if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function xp(n,a,b){return b=b!=null?b.concat([n]):null,Kd(4,4,vp.bind(null,a,n),b)}function yf(){}function _p(n,a){var b=ja();a=a===void 0?null:a;var j=b.memoizedState;return j!==null&&a!==null&&df(a,j[1])?j[0]:(b.memoizedState=[n,a],n)}function bp(n,a){var b=ja();a=a===void 0?null:a;var j=b.memoizedState;return j!==null&&a!==null&&df(a,j[1])?j[0]:(n=n(),b.memoizedState=[n,a],n)}function wp(n,a,b){return(wc&21)===0?(n.baseState&&(n.baseState=!1,wa=!0),n.memoizedState=b):(Ls(b,a)||(b=Xa(),Ss.lanes|=b,Ec|=b,n.baseState=!0),a)}function xm(n,a){var b=Dn;Dn=b!==0&&4>b?b:4,n(!0);var j=uf.transition;uf.transition={};try{n(!1),a()}finally{Dn=b,uf.transition=j}}function Ep(){return ja().memoizedState}function _m(n,a,b){var j=Zl(n);if(b={lane:j,action:b,hasEagerState:!1,eagerState:null,next:null},Sp(n))Cp(a,b);else if(b=qf(n,a,b,j),b!==null){var V=xa();Ha(b,n,j,V),Rp(b,a,j)}}function bm(n,a,b){var j=Zl(n),V={lane:j,action:b,hasEagerState:!1,eagerState:null,next:null};if(Sp(n))Cp(a,V);else{var Q=n.alternate;if(n.lanes===0&&(Q===null||Q.lanes===0)&&(Q=a.lastRenderedReducer,Q!==null))try{var oe=a.lastRenderedState,Le=Q(oe,b);if(V.hasEagerState=!0,V.eagerState=Le,Ls(Le,oe)){var st=a.interleaved;st===null?(V.next=V,tf(a)):(V.next=st.next,st.next=V),a.interleaved=V;return}}catch{}finally{}b=qf(n,a,V,j),b!==null&&(V=xa(),Ha(b,n,j,V),Rp(b,a,j))}}function Sp(n){var a=n.alternate;return n===Ss||a!==null&&a===Ss}function Cp(n,a){rd=Qd=!0;var b=n.pending;b===null?a.next=a:(a.next=b.next,b.next=a),n.pending=a}function Rp(n,a,b){if((b&4194240)!==0){var j=a.lanes;j&=n.pendingLanes,b|=j,a.lanes=b,za(n,b)}}var eh={readContext:Da,useCallback:ua,useContext:ua,useEffect:ua,useImperativeHandle:ua,useInsertionEffect:ua,useLayoutEffect:ua,useMemo:ua,useReducer:ua,useRef:ua,useState:ua,useDebugValue:ua,useDeferredValue:ua,useTransition:ua,useMutableSource:ua,useSyncExternalStore:ua,useId:ua,unstable_isNewReconciler:!1},wm={readContext:Da,useCallback:function(n,a){return ol().memoizedState=[n,a===void 0?null:a],n},useContext:Da,useEffect:mp,useImperativeHandle:function(n,a,b){return b=b!=null?b.concat([n]):null,Zd(4194308,4,vp.bind(null,a,n),b)},useLayoutEffect:function(n,a){return Zd(4194308,4,n,a)},useInsertionEffect:function(n,a){return Zd(4,2,n,a)},useMemo:function(n,a){var b=ol();return a=a===void 0?null:a,n=n(),b.memoizedState=[n,a],n},useReducer:function(n,a,b){var j=ol();return a=b!==void 0?b(a):a,j.memoizedState=j.baseState=a,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:a},j.queue=n,n=n.dispatch=_m.bind(null,Ss,n),[j.memoizedState,n]},useRef:function(n){var a=ol();return n={current:n},a.memoizedState=n},useState:fp,useDebugValue:yf,useDeferredValue:function(n){return ol().memoizedState=n},useTransition:function(){var n=fp(!1),a=n[0];return n=xm.bind(null,n[1]),ol().memoizedState=n,[a,n]},useMutableSource:function(){},useSyncExternalStore:function(n,a,b){var j=Ss,V=ol();if($r){if(b===void 0)throw Error(t(407));b=b()}else{if(b=a(),ea===null)throw Error(t(349));(wc&30)!==0||lp(j,a,b)}V.memoizedState=b;var Q={value:b,getSnapshot:a};return V.queue=Q,mp(up.bind(null,j,Q,n),[n]),j.flags|=2048,od(9,cp.bind(null,j,Q,b,a),void 0,null),b},useId:function(){var n=ol(),a=ea.identifierPrefix;if($r){var b=Hr,j=Ln;b=(j&~(1<<32-ma(j)-1)).toString(32)+b,a=":"+a+"R"+b,b=nd++,0<b&&(a+="H"+b.toString(32)),a+=":"}else b=vm++,a=":"+a+"r"+b.toString(32)+":";return n.memoizedState=a},unstable_isNewReconciler:!1},Em={readContext:Da,useCallback:_p,useContext:Da,useEffect:gf,useImperativeHandle:xp,useInsertionEffect:gp,useLayoutEffect:yp,useMemo:bp,useReducer:pf,useRef:pp,useState:function(){return pf(sd)},useDebugValue:yf,useDeferredValue:function(n){var a=ja();return wp(a,Hs.memoizedState,n)},useTransition:function(){var n=pf(sd)[0],a=ja().memoizedState;return[n,a]},useMutableSource:op,useSyncExternalStore:ap,useId:Ep,unstable_isNewReconciler:!1},Sm={readContext:Da,useCallback:_p,useContext:Da,useEffect:gf,useImperativeHandle:xp,useInsertionEffect:gp,useLayoutEffect:yp,useMemo:bp,useReducer:mf,useRef:pp,useState:function(){return mf(sd)},useDebugValue:yf,useDeferredValue:function(n){var a=ja();return Hs===null?a.memoizedState=n:wp(a,Hs.memoizedState,n)},useTransition:function(){var n=mf(sd)[0],a=ja().memoizedState;return[n,a]},useMutableSource:op,useSyncExternalStore:ap,useId:Ep,unstable_isNewReconciler:!1};function cu(n,a){try{var b="",j=a;do b+=Ne(j),j=j.return;while(j);var V=b}catch(Q){V=`
Error generating stack: `+Q.message+`
`+Q.stack}return{value:n,source:a,stack:V,digest:null}}function vf(n,a,b){return{value:n,source:null,stack:b??null,digest:a??null}}function xf(n,a){try{console.error(a.value)}catch(b){setTimeout(function(){throw b})}}var Cm=typeof WeakMap=="function"?WeakMap:Map;function Ap(n,a,b){b=Rl(-1,b),b.tag=3,b.payload={element:null};var j=a.value;return b.callback=function(){ah||(ah=!0,Pf=j),xf(n,a)},b}function kp(n,a,b){b=Rl(-1,b),b.tag=3;var j=n.type.getDerivedStateFromError;if(typeof j=="function"){var V=a.value;b.payload=function(){return j(V)},b.callback=function(){xf(n,a)}}var Q=n.stateNode;return Q!==null&&typeof Q.componentDidCatch=="function"&&(b.callback=function(){xf(n,a),typeof j!="function"&&(Jl===null?Jl=new Set([this]):Jl.add(this));var oe=a.stack;this.componentDidCatch(a.value,{componentStack:oe!==null?oe:""})}),b}function Tp(n,a,b){var j=n.pingCache;if(j===null){j=n.pingCache=new Cm;var V=new Set;j.set(a,V)}else V=j.get(a),V===void 0&&(V=new Set,j.set(a,V));V.has(b)||(V.add(b),n=Lm.bind(null,n,a,b),a.then(n,n))}function Mp(n){do{var a;if((a=n.tag===13)&&(a=n.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return n;n=n.return}while(n!==null);return null}function Np(n,a,b,j,V){return(n.mode&1)===0?(n===a?n.flags|=65536:(n.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(a=Rl(-1,1),a.tag=2,ql(b,a,1))),b.lanes|=1),n):(n.flags|=65536,n.lanes=V,n)}var Rm=C.ReactCurrentOwner,wa=!1;function va(n,a,b,j){a.child=n===null?ip(a,null,b,j):au(a,n.child,b,j)}function zp(n,a,b,j,V){b=b.render;var Q=a.ref;return ou(a,V),j=hf(n,a,b,j,Q,V),b=ff(),n!==null&&!wa?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~V,Al(n,a,V)):($r&&b&&vi(a),a.flags|=1,va(n,a,j,V),a.child)}function Ip(n,a,b,j,V){if(n===null){var Q=b.type;return typeof Q=="function"&&!Gf(Q)&&Q.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(a.tag=15,a.type=Q,Pp(n,a,Q,j,V)):(n=fh(b.type,null,j,a,a.mode,V),n.ref=a.ref,n.return=a,a.child=n)}if(Q=n.child,(n.lanes&V)===0){var oe=Q.memoizedProps;if(b=b.compare,b=b!==null?b:bl,b(oe,j)&&n.ref===a.ref)return Al(n,a,V)}return a.flags|=1,n=ec(Q,j),n.ref=a.ref,n.return=a,a.child=n}function Pp(n,a,b,j,V){if(n!==null){var Q=n.memoizedProps;if(bl(Q,j)&&n.ref===a.ref)if(wa=!1,a.pendingProps=j=Q,(n.lanes&V)!==0)(n.flags&131072)!==0&&(wa=!0);else return a.lanes=n.lanes,Al(n,a,V)}return _f(n,a,b,j,V)}function Dp(n,a,b){var j=a.pendingProps,V=j.children,Q=n!==null?n.memoizedState:null;if(j.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},fi(du,Ma),Ma|=b;else{if((b&1073741824)===0)return n=Q!==null?Q.baseLanes|b:b,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:n,cachePool:null,transitions:null},a.updateQueue=null,fi(du,Ma),Ma|=n,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},j=Q!==null?Q.baseLanes:b,fi(du,Ma),Ma|=j}else Q!==null?(j=Q.baseLanes|b,a.memoizedState=null):j=b,fi(du,Ma),Ma|=j;return va(n,a,V,b),a.child}function jp(n,a){var b=a.ref;(n===null&&b!==null||n!==null&&n.ref!==b)&&(a.flags|=512,a.flags|=2097152)}function _f(n,a,b,j,V){var Q=na(b)?il:Js.current;return Q=Sl(a,Q),ou(a,V),b=hf(n,a,b,j,Q,V),j=ff(),n!==null&&!wa?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~V,Al(n,a,V)):($r&&j&&vi(a),a.flags|=1,va(n,a,b,V),a.child)}function Fp(n,a,b,j,V){if(na(b)){var Q=!0;xc(a)}else Q=!1;if(ou(a,V),a.stateNode===null)rh(n,a),ep(a,b,j),sf(a,b,j,V),j=!0;else if(n===null){var oe=a.stateNode,Le=a.memoizedProps;oe.props=Le;var st=oe.context,Vt=b.contextType;typeof Vt=="object"&&Vt!==null?Vt=Da(Vt):(Vt=na(b)?il:Js.current,Vt=Sl(a,Vt));var Ur=b.getDerivedStateFromProps,Wr=typeof Ur=="function"||typeof oe.getSnapshotBeforeUpdate=="function";Wr||typeof oe.UNSAFE_componentWillReceiveProps!="function"&&typeof oe.componentWillReceiveProps!="function"||(Le!==j||st!==Vt)&&tp(a,oe,j,Vt),Yl=!1;var Gr=a.memoizedState;oe.state=Gr,Hd(a,j,oe,V),st=a.memoizedState,Le!==j||Gr!==st||la.current||Yl?(typeof Ur=="function"&&(nf(a,b,Ur,j),st=a.memoizedState),(Le=Yl||Kf(a,b,Le,j,Gr,st,Vt))?(Wr||typeof oe.UNSAFE_componentWillMount!="function"&&typeof oe.componentWillMount!="function"||(typeof oe.componentWillMount=="function"&&oe.componentWillMount(),typeof oe.UNSAFE_componentWillMount=="function"&&oe.UNSAFE_componentWillMount()),typeof oe.componentDidMount=="function"&&(a.flags|=4194308)):(typeof oe.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=j,a.memoizedState=st),oe.props=j,oe.state=st,oe.context=Vt,j=Le):(typeof oe.componentDidMount=="function"&&(a.flags|=4194308),j=!1)}else{oe=a.stateNode,Xf(n,a),Le=a.memoizedProps,Vt=a.type===a.elementType?Le:ca(a.type,Le),oe.props=Vt,Wr=a.pendingProps,Gr=oe.context,st=b.contextType,typeof st=="object"&&st!==null?st=Da(st):(st=na(b)?il:Js.current,st=Sl(a,st));var sn=b.getDerivedStateFromProps;(Ur=typeof sn=="function"||typeof oe.getSnapshotBeforeUpdate=="function")||typeof oe.UNSAFE_componentWillReceiveProps!="function"&&typeof oe.componentWillReceiveProps!="function"||(Le!==Wr||Gr!==st)&&tp(a,oe,j,st),Yl=!1,Gr=a.memoizedState,oe.state=Gr,Hd(a,j,oe,V);var an=a.memoizedState;Le!==Wr||Gr!==an||la.current||Yl?(typeof sn=="function"&&(nf(a,b,sn,j),an=a.memoizedState),(Vt=Yl||Kf(a,b,Vt,j,Gr,an,st)||!1)?(Ur||typeof oe.UNSAFE_componentWillUpdate!="function"&&typeof oe.componentWillUpdate!="function"||(typeof oe.componentWillUpdate=="function"&&oe.componentWillUpdate(j,an,st),typeof oe.UNSAFE_componentWillUpdate=="function"&&oe.UNSAFE_componentWillUpdate(j,an,st)),typeof oe.componentDidUpdate=="function"&&(a.flags|=4),typeof oe.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof oe.componentDidUpdate!="function"||Le===n.memoizedProps&&Gr===n.memoizedState||(a.flags|=4),typeof oe.getSnapshotBeforeUpdate!="function"||Le===n.memoizedProps&&Gr===n.memoizedState||(a.flags|=1024),a.memoizedProps=j,a.memoizedState=an),oe.props=j,oe.state=an,oe.context=st,j=Vt):(typeof oe.componentDidUpdate!="function"||Le===n.memoizedProps&&Gr===n.memoizedState||(a.flags|=4),typeof oe.getSnapshotBeforeUpdate!="function"||Le===n.memoizedProps&&Gr===n.memoizedState||(a.flags|=1024),j=!1)}return bf(n,a,b,j,Q,V)}function bf(n,a,b,j,V,Q){jp(n,a);var oe=(a.flags&128)!==0;if(!j&&!oe)return V&&Qu(a,b,!1),Al(n,a,Q);j=a.stateNode,Rm.current=a;var Le=oe&&typeof b.getDerivedStateFromError!="function"?null:j.render();return a.flags|=1,n!==null&&oe?(a.child=au(a,n.child,null,Q),a.child=au(a,null,Le,Q)):va(n,a,Le,Q),a.memoizedState=j.state,V&&Qu(a,b,!0),a.child}function Op(n){var a=n.stateNode;a.pendingContext?Xu(n,a.pendingContext,a.pendingContext!==a.context):a.context&&Xu(n,a.context,!1),of(n,a.containerInfo)}function Lp(n,a,b,j,V){return ba(),nu(V),a.flags|=256,va(n,a,b,j),a.child}var wf={dehydrated:null,treeContext:null,retryLane:0};function Ef(n){return{baseLanes:n,cachePool:null,transitions:null}}function Bp(n,a,b){var j=a.pendingProps,V=ls.current,Q=!1,oe=(a.flags&128)!==0,Le;if((Le=oe)||(Le=n!==null&&n.memoizedState===null?!1:(V&2)!==0),Le?(Q=!0,a.flags&=-129):(n===null||n.memoizedState!==null)&&(V|=1),fi(ls,V&1),n===null)return li(a),n=a.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((a.mode&1)===0?a.lanes=1:n.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(oe=j.children,n=j.fallback,Q?(j=a.mode,Q=a.child,oe={mode:"hidden",children:oe},(j&1)===0&&Q!==null?(Q.childLanes=0,Q.pendingProps=oe):Q=ph(oe,j,0,null),n=Ac(n,j,b,null),Q.return=a,n.return=a,Q.sibling=n,a.child=Q,a.child.memoizedState=Ef(b),a.memoizedState=wf,n):Sf(a,oe));if(V=n.memoizedState,V!==null&&(Le=V.dehydrated,Le!==null))return Am(n,a,oe,j,Le,V,b);if(Q){Q=j.fallback,oe=a.mode,V=n.child,Le=V.sibling;var st={mode:"hidden",children:j.children};return(oe&1)===0&&a.child!==V?(j=a.child,j.childLanes=0,j.pendingProps=st,a.deletions=null):(j=ec(V,st),j.subtreeFlags=V.subtreeFlags&14680064),Le!==null?Q=ec(Le,Q):(Q=Ac(Q,oe,b,null),Q.flags|=2),Q.return=a,j.return=a,j.sibling=Q,a.child=j,j=Q,Q=a.child,oe=n.child.memoizedState,oe=oe===null?Ef(b):{baseLanes:oe.baseLanes|b,cachePool:null,transitions:oe.transitions},Q.memoizedState=oe,Q.childLanes=n.childLanes&~b,a.memoizedState=wf,j}return Q=n.child,n=Q.sibling,j=ec(Q,{mode:"visible",children:j.children}),(a.mode&1)===0&&(j.lanes=b),j.return=a,j.sibling=null,n!==null&&(b=a.deletions,b===null?(a.deletions=[n],a.flags|=16):b.push(n)),a.child=j,a.memoizedState=null,j}function Sf(n,a){return a=ph({mode:"visible",children:a},n.mode,0,null),a.return=n,n.child=a}function th(n,a,b,j){return j!==null&&nu(j),au(a,n.child,null,b),n=Sf(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function Am(n,a,b,j,V,Q,oe){if(b)return a.flags&256?(a.flags&=-257,j=vf(Error(t(422))),th(n,a,oe,j)):a.memoizedState!==null?(a.child=n.child,a.flags|=128,null):(Q=j.fallback,V=a.mode,j=ph({mode:"visible",children:j.children},V,0,null),Q=Ac(Q,V,oe,null),Q.flags|=2,j.return=a,Q.return=a,j.sibling=Q,a.child=j,(a.mode&1)!==0&&au(a,n.child,null,oe),a.child.memoizedState=Ef(oe),a.memoizedState=wf,Q);if((a.mode&1)===0)return th(n,a,oe,null);if(V.data==="$!"){if(j=V.nextSibling&&V.nextSibling.dataset,j)var Le=j.dgst;return j=Le,Q=Error(t(419)),j=vf(Q,j,void 0),th(n,a,oe,j)}if(Le=(oe&n.childLanes)!==0,wa||Le){if(j=ea,j!==null){switch(oe&-oe){case 4:V=2;break;case 16:V=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:V=32;break;case 536870912:V=268435456;break;default:V=0}V=(V&(j.suspendedLanes|oe))!==0?0:V,V!==0&&V!==Q.retryLane&&(Q.retryLane=V,Cl(n,V),Ha(j,n,V,-1))}return Bf(),j=vf(Error(t(421))),th(n,a,oe,j)}return V.data==="$?"?(a.flags|=128,a.child=n.child,a=Bm.bind(null,n),V._reactRetry=a,null):(n=Q.treeContext,En=Ia(V.nextSibling),Cn=a,$r=!0,Rn=null,n!==null&&(Kr[nt++]=Ln,Kr[nt++]=Hr,Kr[nt++]=_t,Ln=n.id,Hr=n.overflow,_t=a),a=Sf(a,j.children),a.flags|=4096,a)}function Gp(n,a,b){n.lanes|=a;var j=n.alternate;j!==null&&(j.lanes|=a),ef(n.return,a,b)}function Cf(n,a,b,j,V){var Q=n.memoizedState;Q===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:j,tail:b,tailMode:V}:(Q.isBackwards=a,Q.rendering=null,Q.renderingStartTime=0,Q.last=j,Q.tail=b,Q.tailMode=V)}function Up(n,a,b){var j=a.pendingProps,V=j.revealOrder,Q=j.tail;if(va(n,a,j.children,b),j=ls.current,(j&2)!==0)j=j&1|2,a.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Gp(n,b,a);else if(n.tag===19)Gp(n,b,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}j&=1}if(fi(ls,j),(a.mode&1)===0)a.memoizedState=null;else switch(V){case"forwards":for(b=a.child,V=null;b!==null;)n=b.alternate,n!==null&&Xd(n)===null&&(V=b),b=b.sibling;b=V,b===null?(V=a.child,a.child=null):(V=b.sibling,b.sibling=null),Cf(a,!1,V,b,Q);break;case"backwards":for(b=null,V=a.child,a.child=null;V!==null;){if(n=V.alternate,n!==null&&Xd(n)===null){a.child=V;break}n=V.sibling,V.sibling=b,b=V,V=n}Cf(a,!0,b,null,Q);break;case"together":Cf(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function rh(n,a){(a.mode&1)===0&&n!==null&&(n.alternate=null,a.alternate=null,a.flags|=2)}function Al(n,a,b){if(n!==null&&(a.dependencies=n.dependencies),Ec|=a.lanes,(b&a.childLanes)===0)return null;if(n!==null&&a.child!==n.child)throw Error(t(153));if(a.child!==null){for(n=a.child,b=ec(n,n.pendingProps),a.child=b,b.return=a;n.sibling!==null;)n=n.sibling,b=b.sibling=ec(n,n.pendingProps),b.return=a;b.sibling=null}return a.child}function km(n,a,b){switch(a.tag){case 3:Op(a),ba();break;case 5:sp(a);break;case 1:na(a.type)&&xc(a);break;case 4:of(a,a.stateNode.containerInfo);break;case 10:var j=a.type._context,V=a.memoizedProps.value;fi(Vd,j._currentValue),j._currentValue=V;break;case 13:if(j=a.memoizedState,j!==null)return j.dehydrated!==null?(fi(ls,ls.current&1),a.flags|=128,null):(b&a.child.childLanes)!==0?Bp(n,a,b):(fi(ls,ls.current&1),n=Al(n,a,b),n!==null?n.sibling:null);fi(ls,ls.current&1);break;case 19:if(j=(b&a.childLanes)!==0,(n.flags&128)!==0){if(j)return Up(n,a,b);a.flags|=128}if(V=a.memoizedState,V!==null&&(V.rendering=null,V.tail=null,V.lastEffect=null),fi(ls,ls.current),j)break;return null;case 22:case 23:return a.lanes=0,Dp(n,a,b)}return Al(n,a,b)}var Vp,Rf,$p,Wp;Vp=function(n,a){for(var b=a.child;b!==null;){if(b.tag===5||b.tag===6)n.appendChild(b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===a)break;for(;b.sibling===null;){if(b.return===null||b.return===a)return;b=b.return}b.sibling.return=b.return,b=b.sibling}},Rf=function(){},$p=function(n,a,b,j){var V=n.memoizedProps;if(V!==j){n=a.stateNode,bc(sl.current);var Q=null;switch(b){case"input":V=je(n,V),j=je(n,j),Q=[];break;case"select":V=G({},V,{value:void 0}),j=G({},j,{value:void 0}),Q=[];break;case"textarea":V=Nr(n,V),j=Nr(n,j),Q=[];break;default:typeof V.onClick!="function"&&typeof j.onClick=="function"&&(n.onclick=Kc)}lt(b,j);var oe;b=null;for(Vt in V)if(!j.hasOwnProperty(Vt)&&V.hasOwnProperty(Vt)&&V[Vt]!=null)if(Vt==="style"){var Le=V[Vt];for(oe in Le)Le.hasOwnProperty(oe)&&(b||(b={}),b[oe]="")}else Vt!=="dangerouslySetInnerHTML"&&Vt!=="children"&&Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&Vt!=="autoFocus"&&(c.hasOwnProperty(Vt)?Q||(Q=[]):(Q=Q||[]).push(Vt,null));for(Vt in j){var st=j[Vt];if(Le=V?.[Vt],j.hasOwnProperty(Vt)&&st!==Le&&(st!=null||Le!=null))if(Vt==="style")if(Le){for(oe in Le)!Le.hasOwnProperty(oe)||st&&st.hasOwnProperty(oe)||(b||(b={}),b[oe]="");for(oe in st)st.hasOwnProperty(oe)&&Le[oe]!==st[oe]&&(b||(b={}),b[oe]=st[oe])}else b||(Q||(Q=[]),Q.push(Vt,b)),b=st;else Vt==="dangerouslySetInnerHTML"?(st=st?st.__html:void 0,Le=Le?Le.__html:void 0,st!=null&&Le!==st&&(Q=Q||[]).push(Vt,st)):Vt==="children"?typeof st!="string"&&typeof st!="number"||(Q=Q||[]).push(Vt,""+st):Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&(c.hasOwnProperty(Vt)?(st!=null&&Vt==="onScroll"&&di("scroll",n),Q||Le===st||(Q=[])):(Q=Q||[]).push(Vt,st))}b&&(Q=Q||[]).push("style",b);var Vt=Q;(a.updateQueue=Vt)&&(a.flags|=4)}},Wp=function(n,a,b,j){b!==j&&(a.flags|=4)};function ad(n,a){if(!$r)switch(n.tailMode){case"hidden":a=n.tail;for(var b=null;a!==null;)a.alternate!==null&&(b=a),a=a.sibling;b===null?n.tail=null:b.sibling=null;break;case"collapsed":b=n.tail;for(var j=null;b!==null;)b.alternate!==null&&(j=b),b=b.sibling;j===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:j.sibling=null}}function da(n){var a=n.alternate!==null&&n.alternate.child===n.child,b=0,j=0;if(a)for(var V=n.child;V!==null;)b|=V.lanes|V.childLanes,j|=V.subtreeFlags&14680064,j|=V.flags&14680064,V.return=n,V=V.sibling;else for(V=n.child;V!==null;)b|=V.lanes|V.childLanes,j|=V.subtreeFlags,j|=V.flags,V.return=n,V=V.sibling;return n.subtreeFlags|=j,n.childLanes=b,a}function Tm(n,a,b){var j=a.pendingProps;switch(ti(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return da(a),null;case 1:return na(a.type)&&vc(),da(a),null;case 3:return j=a.stateNode,lu(),gi(la),gi(Js),cf(),j.pendingContext&&(j.context=j.pendingContext,j.pendingContext=null),(n===null||n.child===null)&&(jn(a)?a.flags|=4:n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Rn!==null&&(Ff(Rn),Rn=null))),Rf(n,a),da(a),null;case 5:af(a);var V=bc(td.current);if(b=a.type,n!==null&&a.stateNode!=null)$p(n,a,b,j,V),n.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!j){if(a.stateNode===null)throw Error(t(166));return da(a),null}if(n=bc(sl.current),jn(a)){j=a.stateNode,b=a.type;var Q=a.memoizedProps;switch(j[Ta]=a,j[mc]=Q,n=(a.mode&1)!==0,b){case"dialog":di("cancel",j),di("close",j);break;case"iframe":case"object":case"embed":di("load",j);break;case"video":case"audio":for(V=0;V<Ul.length;V++)di(Ul[V],j);break;case"source":di("error",j);break;case"img":case"image":case"link":di("error",j),di("load",j);break;case"details":di("toggle",j);break;case"input":ht(j,Q),di("invalid",j);break;case"select":j._wrapperState={wasMultiple:!!Q.multiple},di("invalid",j);break;case"textarea":At(j,Q),di("invalid",j)}lt(b,Q),V=null;for(var oe in Q)if(Q.hasOwnProperty(oe)){var Le=Q[oe];oe==="children"?typeof Le=="string"?j.textContent!==Le&&(Q.suppressHydrationWarning!==!0&&Zc(j.textContent,Le,n),V=["children",Le]):typeof Le=="number"&&j.textContent!==""+Le&&(Q.suppressHydrationWarning!==!0&&Zc(j.textContent,Le,n),V=["children",""+Le]):c.hasOwnProperty(oe)&&Le!=null&&oe==="onScroll"&&di("scroll",j)}switch(b){case"input":Ot(j),Wt(j,Q,!0);break;case"textarea":Ot(j),Jr(j);break;case"select":case"option":break;default:typeof Q.onClick=="function"&&(j.onclick=Kc)}j=V,a.updateQueue=j,j!==null&&(a.flags|=4)}else{oe=V.nodeType===9?V:V.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Yr(b)),n==="http://www.w3.org/1999/xhtml"?b==="script"?(n=oe.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof j.is=="string"?n=oe.createElement(b,{is:j.is}):(n=oe.createElement(b),b==="select"&&(oe=n,j.multiple?oe.multiple=!0:j.size&&(oe.size=j.size))):n=oe.createElementNS(n,b),n[Ta]=a,n[mc]=j,Vp(n,a,!1,!1),a.stateNode=n;e:{switch(oe=ar(b,j),b){case"dialog":di("cancel",n),di("close",n),V=j;break;case"iframe":case"object":case"embed":di("load",n),V=j;break;case"video":case"audio":for(V=0;V<Ul.length;V++)di(Ul[V],n);V=j;break;case"source":di("error",n),V=j;break;case"img":case"image":case"link":di("error",n),di("load",n),V=j;break;case"details":di("toggle",n),V=j;break;case"input":ht(n,j),V=je(n,j),di("invalid",n);break;case"option":V=j;break;case"select":n._wrapperState={wasMultiple:!!j.multiple},V=G({},j,{value:void 0}),di("invalid",n);break;case"textarea":At(n,j),V=Nr(n,j),di("invalid",n);break;default:V=j}lt(b,V),Le=V;for(Q in Le)if(Le.hasOwnProperty(Q)){var st=Le[Q];Q==="style"?re(n,st):Q==="dangerouslySetInnerHTML"?(st=st?st.__html:void 0,st!=null&&we(n,st)):Q==="children"?typeof st=="string"?(b!=="textarea"||st!=="")&&it(n,st):typeof st=="number"&&it(n,""+st):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(c.hasOwnProperty(Q)?st!=null&&Q==="onScroll"&&di("scroll",n):st!=null&&E(n,Q,st,oe))}switch(b){case"input":Ot(n),Wt(n,j,!1);break;case"textarea":Ot(n),Jr(n);break;case"option":j.value!=null&&n.setAttribute("value",""+Me(j.value));break;case"select":n.multiple=!!j.multiple,Q=j.value,Q!=null?cr(n,!!j.multiple,Q,!1):j.defaultValue!=null&&cr(n,!!j.multiple,j.defaultValue,!0);break;default:typeof V.onClick=="function"&&(n.onclick=Kc)}switch(b){case"button":case"input":case"select":case"textarea":j=!!j.autoFocus;break e;case"img":j=!0;break e;default:j=!1}}j&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return da(a),null;case 6:if(n&&a.stateNode!=null)Wp(n,a,n.memoizedProps,j);else{if(typeof j!="string"&&a.stateNode===null)throw Error(t(166));if(b=bc(td.current),bc(sl.current),jn(a)){if(j=a.stateNode,b=a.memoizedProps,j[Ta]=a,(Q=j.nodeValue!==b)&&(n=Cn,n!==null))switch(n.tag){case 3:Zc(j.nodeValue,b,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Zc(j.nodeValue,b,(n.mode&1)!==0)}Q&&(a.flags|=4)}else j=(b.nodeType===9?b:b.ownerDocument).createTextNode(j),j[Ta]=a,a.stateNode=j}return da(a),null;case 13:if(gi(ls),j=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if($r&&En!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Qs(),ba(),a.flags|=98560,Q=!1;else if(Q=jn(a),j!==null&&j.dehydrated!==null){if(n===null){if(!Q)throw Error(t(318));if(Q=a.memoizedState,Q=Q!==null?Q.dehydrated:null,!Q)throw Error(t(317));Q[Ta]=a}else ba(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;da(a),Q=!1}else Rn!==null&&(Ff(Rn),Rn=null),Q=!0;if(!Q)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=b,a):(j=j!==null,j!==(n!==null&&n.memoizedState!==null)&&j&&(a.child.flags|=8192,(a.mode&1)!==0&&(n===null||(ls.current&1)!==0?qs===0&&(qs=3):Bf())),a.updateQueue!==null&&(a.flags|=4),da(a),null);case 4:return lu(),Rf(n,a),n===null&&fc(a.stateNode.containerInfo),da(a),null;case 10:return Kh(a.type._context),da(a),null;case 17:return na(a.type)&&vc(),da(a),null;case 19:if(gi(ls),Q=a.memoizedState,Q===null)return da(a),null;if(j=(a.flags&128)!==0,oe=Q.rendering,oe===null)if(j)ad(Q,!1);else{if(qs!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(oe=Xd(n),oe!==null){for(a.flags|=128,ad(Q,!1),j=oe.updateQueue,j!==null&&(a.updateQueue=j,a.flags|=4),a.subtreeFlags=0,j=b,b=a.child;b!==null;)Q=b,n=j,Q.flags&=14680066,oe=Q.alternate,oe===null?(Q.childLanes=0,Q.lanes=n,Q.child=null,Q.subtreeFlags=0,Q.memoizedProps=null,Q.memoizedState=null,Q.updateQueue=null,Q.dependencies=null,Q.stateNode=null):(Q.childLanes=oe.childLanes,Q.lanes=oe.lanes,Q.child=oe.child,Q.subtreeFlags=0,Q.deletions=null,Q.memoizedProps=oe.memoizedProps,Q.memoizedState=oe.memoizedState,Q.updateQueue=oe.updateQueue,Q.type=oe.type,n=oe.dependencies,Q.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),b=b.sibling;return fi(ls,ls.current&1|2),a.child}n=n.sibling}Q.tail!==null&&hi()>hu&&(a.flags|=128,j=!0,ad(Q,!1),a.lanes=4194304)}else{if(!j)if(n=Xd(oe),n!==null){if(a.flags|=128,j=!0,b=n.updateQueue,b!==null&&(a.updateQueue=b,a.flags|=4),ad(Q,!0),Q.tail===null&&Q.tailMode==="hidden"&&!oe.alternate&&!$r)return da(a),null}else 2*hi()-Q.renderingStartTime>hu&&b!==1073741824&&(a.flags|=128,j=!0,ad(Q,!1),a.lanes=4194304);Q.isBackwards?(oe.sibling=a.child,a.child=oe):(b=Q.last,b!==null?b.sibling=oe:a.child=oe,Q.last=oe)}return Q.tail!==null?(a=Q.tail,Q.rendering=a,Q.tail=a.sibling,Q.renderingStartTime=hi(),a.sibling=null,b=ls.current,fi(ls,j?b&1|2:b&1),a):(da(a),null);case 22:case 23:return Lf(),j=a.memoizedState!==null,n!==null&&n.memoizedState!==null!==j&&(a.flags|=8192),j&&(a.mode&1)!==0?(Ma&1073741824)!==0&&(da(a),a.subtreeFlags&6&&(a.flags|=8192)):da(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function Mm(n,a){switch(ti(a),a.tag){case 1:return na(a.type)&&vc(),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return lu(),gi(la),gi(Js),cf(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 5:return af(a),null;case 13:if(gi(ls),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(t(340));ba()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return gi(ls),null;case 4:return lu(),null;case 10:return Kh(a.type._context),null;case 22:case 23:return Lf(),null;case 24:return null;default:return null}}var nh=!1,ha=!1,Nm=typeof WeakSet=="function"?WeakSet:Set,on=null;function uu(n,a){var b=n.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(j){Ts(n,a,j)}else b.current=null}function Af(n,a,b){try{b()}catch(j){Ts(n,a,j)}}var Hp=!1;function zm(n,a){if($u=zc,n=Du(),$c(n)){if("selectionStart"in n)var b={start:n.selectionStart,end:n.selectionEnd};else e:{b=(b=n.ownerDocument)&&b.defaultView||window;var j=b.getSelection&&b.getSelection();if(j&&j.rangeCount!==0){b=j.anchorNode;var V=j.anchorOffset,Q=j.focusNode;j=j.focusOffset;try{b.nodeType,Q.nodeType}catch{b=null;break e}var oe=0,Le=-1,st=-1,Vt=0,Ur=0,Wr=n,Gr=null;t:for(;;){for(var sn;Wr!==b||V!==0&&Wr.nodeType!==3||(Le=oe+V),Wr!==Q||j!==0&&Wr.nodeType!==3||(st=oe+j),Wr.nodeType===3&&(oe+=Wr.nodeValue.length),(sn=Wr.firstChild)!==null;)Gr=Wr,Wr=sn;for(;;){if(Wr===n)break t;if(Gr===b&&++Vt===V&&(Le=oe),Gr===Q&&++Ur===j&&(st=oe),(sn=Wr.nextSibling)!==null)break;Wr=Gr,Gr=Wr.parentNode}Wr=sn}b=Le===-1||st===-1?null:{start:Le,end:st}}else b=null}b=b||{start:0,end:0}}else b=null;for(Wu={focusedElem:n,selectionRange:b},zc=!1,on=a;on!==null;)if(a=on,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,on=n;else for(;on!==null;){a=on;try{var an=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(an!==null){var bn=an.memoizedProps,Gs=an.memoizedState,Et=a.stateNode,ot=Et.getSnapshotBeforeUpdate(a.elementType===a.type?bn:ca(a.type,bn),Gs);Et.__reactInternalSnapshotBeforeUpdate=ot}break;case 3:var Tt=a.stateNode.containerInfo;Tt.nodeType===1?Tt.textContent="":Tt.nodeType===9&&Tt.documentElement&&Tt.removeChild(Tt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(qr){Ts(a,a.return,qr)}if(n=a.sibling,n!==null){n.return=a.return,on=n;break}on=a.return}return an=Hp,Hp=!1,an}function ld(n,a,b){var j=a.updateQueue;if(j=j!==null?j.lastEffect:null,j!==null){var V=j=j.next;do{if((V.tag&n)===n){var Q=V.destroy;V.destroy=void 0,Q!==void 0&&Af(a,b,Q)}V=V.next}while(V!==j)}}function ih(n,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var b=a=a.next;do{if((b.tag&n)===n){var j=b.create;b.destroy=j()}b=b.next}while(b!==a)}}function kf(n){var a=n.ref;if(a!==null){var b=n.stateNode;switch(n.tag){case 5:n=b;break;default:n=b}typeof a=="function"?a(n):a.current=n}}function Yp(n){var a=n.alternate;a!==null&&(n.alternate=null,Yp(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&(delete a[Ta],delete a[mc],delete a[gc],delete a[Xh],delete a[Jh])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function qp(n){return n.tag===5||n.tag===3||n.tag===4}function Xp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||qp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Tf(n,a,b){var j=n.tag;if(j===5||j===6)n=n.stateNode,a?b.nodeType===8?b.parentNode.insertBefore(n,a):b.insertBefore(n,a):(b.nodeType===8?(a=b.parentNode,a.insertBefore(n,b)):(a=b,a.appendChild(n)),b=b._reactRootContainer,b!=null||a.onclick!==null||(a.onclick=Kc));else if(j!==4&&(n=n.child,n!==null))for(Tf(n,a,b),n=n.sibling;n!==null;)Tf(n,a,b),n=n.sibling}function Mf(n,a,b){var j=n.tag;if(j===5||j===6)n=n.stateNode,a?b.insertBefore(n,a):b.appendChild(n);else if(j!==4&&(n=n.child,n!==null))for(Mf(n,a,b),n=n.sibling;n!==null;)Mf(n,a,b),n=n.sibling}var ia=null,$a=!1;function Xl(n,a,b){for(b=b.child;b!==null;)Jp(n,a,b),b=b.sibling}function Jp(n,a,b){if($s&&typeof $s.onCommitFiberUnmount=="function")try{$s.onCommitFiberUnmount(Tl,b)}catch{}switch(b.tag){case 5:ha||uu(b,a);case 6:var j=ia,V=$a;ia=null,Xl(n,a,b),ia=j,$a=V,ia!==null&&($a?(n=ia,b=b.stateNode,n.nodeType===8?n.parentNode.removeChild(b):n.removeChild(b)):ia.removeChild(b.stateNode));break;case 18:ia!==null&&($a?(n=ia,b=b.stateNode,n.nodeType===8?wl(n.parentNode,b):n.nodeType===1&&wl(n,b),ic(n)):wl(ia,b.stateNode));break;case 4:j=ia,V=$a,ia=b.stateNode.containerInfo,$a=!0,Xl(n,a,b),ia=j,$a=V;break;case 0:case 11:case 14:case 15:if(!ha&&(j=b.updateQueue,j!==null&&(j=j.lastEffect,j!==null))){V=j=j.next;do{var Q=V,oe=Q.destroy;Q=Q.tag,oe!==void 0&&((Q&2)!==0||(Q&4)!==0)&&Af(b,a,oe),V=V.next}while(V!==j)}Xl(n,a,b);break;case 1:if(!ha&&(uu(b,a),j=b.stateNode,typeof j.componentWillUnmount=="function"))try{j.props=b.memoizedProps,j.state=b.memoizedState,j.componentWillUnmount()}catch(Le){Ts(b,a,Le)}Xl(n,a,b);break;case 21:Xl(n,a,b);break;case 22:b.mode&1?(ha=(j=ha)||b.memoizedState!==null,Xl(n,a,b),ha=j):Xl(n,a,b);break;default:Xl(n,a,b)}}function Qp(n){var a=n.updateQueue;if(a!==null){n.updateQueue=null;var b=n.stateNode;b===null&&(b=n.stateNode=new Nm),a.forEach(function(j){var V=Gm.bind(null,n,j);b.has(j)||(b.add(j),j.then(V,V))})}}function Wa(n,a){var b=a.deletions;if(b!==null)for(var j=0;j<b.length;j++){var V=b[j];try{var Q=n,oe=a,Le=oe;e:for(;Le!==null;){switch(Le.tag){case 5:ia=Le.stateNode,$a=!1;break e;case 3:ia=Le.stateNode.containerInfo,$a=!0;break e;case 4:ia=Le.stateNode.containerInfo,$a=!0;break e}Le=Le.return}if(ia===null)throw Error(t(160));Jp(Q,oe,V),ia=null,$a=!1;var st=V.alternate;st!==null&&(st.return=null),V.return=null}catch(Vt){Ts(V,a,Vt)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)Zp(a,n),a=a.sibling}function Zp(n,a){var b=n.alternate,j=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Wa(a,n),al(n),j&4){try{ld(3,n,n.return),ih(3,n)}catch(bn){Ts(n,n.return,bn)}try{ld(5,n,n.return)}catch(bn){Ts(n,n.return,bn)}}break;case 1:Wa(a,n),al(n),j&512&&b!==null&&uu(b,b.return);break;case 5:if(Wa(a,n),al(n),j&512&&b!==null&&uu(b,b.return),n.flags&32){var V=n.stateNode;try{it(V,"")}catch(bn){Ts(n,n.return,bn)}}if(j&4&&(V=n.stateNode,V!=null)){var Q=n.memoizedProps,oe=b!==null?b.memoizedProps:Q,Le=n.type,st=n.updateQueue;if(n.updateQueue=null,st!==null)try{Le==="input"&&Q.type==="radio"&&Q.name!=null&&Kt(V,Q),ar(Le,oe);var Vt=ar(Le,Q);for(oe=0;oe<st.length;oe+=2){var Ur=st[oe],Wr=st[oe+1];Ur==="style"?re(V,Wr):Ur==="dangerouslySetInnerHTML"?we(V,Wr):Ur==="children"?it(V,Wr):E(V,Ur,Wr,Vt)}switch(Le){case"input":Jt(V,Q);break;case"textarea":Mt(V,Q);break;case"select":var Gr=V._wrapperState.wasMultiple;V._wrapperState.wasMultiple=!!Q.multiple;var sn=Q.value;sn!=null?cr(V,!!Q.multiple,sn,!1):Gr!==!!Q.multiple&&(Q.defaultValue!=null?cr(V,!!Q.multiple,Q.defaultValue,!0):cr(V,!!Q.multiple,Q.multiple?[]:"",!1))}V[mc]=Q}catch(bn){Ts(n,n.return,bn)}}break;case 6:if(Wa(a,n),al(n),j&4){if(n.stateNode===null)throw Error(t(162));V=n.stateNode,Q=n.memoizedProps;try{V.nodeValue=Q}catch(bn){Ts(n,n.return,bn)}}break;case 3:if(Wa(a,n),al(n),j&4&&b!==null&&b.memoizedState.isDehydrated)try{ic(a.containerInfo)}catch(bn){Ts(n,n.return,bn)}break;case 4:Wa(a,n),al(n);break;case 13:Wa(a,n),al(n),V=n.child,V.flags&8192&&(Q=V.memoizedState!==null,V.stateNode.isHidden=Q,!Q||V.alternate!==null&&V.alternate.memoizedState!==null||(If=hi())),j&4&&Qp(n);break;case 22:if(Ur=b!==null&&b.memoizedState!==null,n.mode&1?(ha=(Vt=ha)||Ur,Wa(a,n),ha=Vt):Wa(a,n),al(n),j&8192){if(Vt=n.memoizedState!==null,(n.stateNode.isHidden=Vt)&&!Ur&&(n.mode&1)!==0)for(on=n,Ur=n.child;Ur!==null;){for(Wr=on=Ur;on!==null;){switch(Gr=on,sn=Gr.child,Gr.tag){case 0:case 11:case 14:case 15:ld(4,Gr,Gr.return);break;case 1:uu(Gr,Gr.return);var an=Gr.stateNode;if(typeof an.componentWillUnmount=="function"){j=Gr,b=Gr.return;try{a=j,an.props=a.memoizedProps,an.state=a.memoizedState,an.componentWillUnmount()}catch(bn){Ts(j,b,bn)}}break;case 5:uu(Gr,Gr.return);break;case 22:if(Gr.memoizedState!==null){tm(Wr);continue}}sn!==null?(sn.return=Gr,on=sn):tm(Wr)}Ur=Ur.sibling}e:for(Ur=null,Wr=n;;){if(Wr.tag===5){if(Ur===null){Ur=Wr;try{V=Wr.stateNode,Vt?(Q=V.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none"):(Le=Wr.stateNode,st=Wr.memoizedProps.style,oe=st!=null&&st.hasOwnProperty("display")?st.display:null,Le.style.display=jt("display",oe))}catch(bn){Ts(n,n.return,bn)}}}else if(Wr.tag===6){if(Ur===null)try{Wr.stateNode.nodeValue=Vt?"":Wr.memoizedProps}catch(bn){Ts(n,n.return,bn)}}else if((Wr.tag!==22&&Wr.tag!==23||Wr.memoizedState===null||Wr===n)&&Wr.child!==null){Wr.child.return=Wr,Wr=Wr.child;continue}if(Wr===n)break e;for(;Wr.sibling===null;){if(Wr.return===null||Wr.return===n)break e;Ur===Wr&&(Ur=null),Wr=Wr.return}Ur===Wr&&(Ur=null),Wr.sibling.return=Wr.return,Wr=Wr.sibling}}break;case 19:Wa(a,n),al(n),j&4&&Qp(n);break;case 21:break;default:Wa(a,n),al(n)}}function al(n){var a=n.flags;if(a&2){try{e:{for(var b=n.return;b!==null;){if(qp(b)){var j=b;break e}b=b.return}throw Error(t(160))}switch(j.tag){case 5:var V=j.stateNode;j.flags&32&&(it(V,""),j.flags&=-33);var Q=Xp(n);Mf(n,Q,V);break;case 3:case 4:var oe=j.stateNode.containerInfo,Le=Xp(n);Tf(n,Le,oe);break;default:throw Error(t(161))}}catch(st){Ts(n,n.return,st)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function Im(n,a,b){on=n,Kp(n)}function Kp(n,a,b){for(var j=(n.mode&1)!==0;on!==null;){var V=on,Q=V.child;if(V.tag===22&&j){var oe=V.memoizedState!==null||nh;if(!oe){var Le=V.alternate,st=Le!==null&&Le.memoizedState!==null||ha;Le=nh;var Vt=ha;if(nh=oe,(ha=st)&&!Vt)for(on=V;on!==null;)oe=on,st=oe.child,oe.tag===22&&oe.memoizedState!==null?rm(V):st!==null?(st.return=oe,on=st):rm(V);for(;Q!==null;)on=Q,Kp(Q),Q=Q.sibling;on=V,nh=Le,ha=Vt}em(n)}else(V.subtreeFlags&8772)!==0&&Q!==null?(Q.return=V,on=Q):em(n)}}function em(n){for(;on!==null;){var a=on;if((a.flags&8772)!==0){var b=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:ha||ih(5,a);break;case 1:var j=a.stateNode;if(a.flags&4&&!ha)if(b===null)j.componentDidMount();else{var V=a.elementType===a.type?b.memoizedProps:ca(a.type,b.memoizedProps);j.componentDidUpdate(V,b.memoizedState,j.__reactInternalSnapshotBeforeUpdate)}var Q=a.updateQueue;Q!==null&&Qf(a,Q,j);break;case 3:var oe=a.updateQueue;if(oe!==null){if(b=null,a.child!==null)switch(a.child.tag){case 5:b=a.child.stateNode;break;case 1:b=a.child.stateNode}Qf(a,oe,b)}break;case 5:var Le=a.stateNode;if(b===null&&a.flags&4){b=Le;var st=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":st.autoFocus&&b.focus();break;case"img":st.src&&(b.src=st.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var Vt=a.alternate;if(Vt!==null){var Ur=Vt.memoizedState;if(Ur!==null){var Wr=Ur.dehydrated;Wr!==null&&ic(Wr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ha||a.flags&512&&kf(a)}catch(Gr){Ts(a,a.return,Gr)}}if(a===n){on=null;break}if(b=a.sibling,b!==null){b.return=a.return,on=b;break}on=a.return}}function tm(n){for(;on!==null;){var a=on;if(a===n){on=null;break}var b=a.sibling;if(b!==null){b.return=a.return,on=b;break}on=a.return}}function rm(n){for(;on!==null;){var a=on;try{switch(a.tag){case 0:case 11:case 15:var b=a.return;try{ih(4,a)}catch(st){Ts(a,b,st)}break;case 1:var j=a.stateNode;if(typeof j.componentDidMount=="function"){var V=a.return;try{j.componentDidMount()}catch(st){Ts(a,V,st)}}var Q=a.return;try{kf(a)}catch(st){Ts(a,Q,st)}break;case 5:var oe=a.return;try{kf(a)}catch(st){Ts(a,oe,st)}}}catch(st){Ts(a,a.return,st)}if(a===n){on=null;break}var Le=a.sibling;if(Le!==null){Le.return=a.return,on=Le;break}on=a.return}}var Pm=Math.ceil,sh=C.ReactCurrentDispatcher,Nf=C.ReactCurrentOwner,Fa=C.ReactCurrentBatchConfig,si=0,ea=null,Vs=null,sa=0,Ma=0,du=rl(0),qs=0,cd=null,Ec=0,oh=0,zf=0,ud=null,Ea=null,If=0,hu=1/0,kl=null,ah=!1,Pf=null,Jl=null,lh=!1,Ql=null,ch=0,dd=0,Df=null,uh=-1,dh=0;function xa(){return(si&6)!==0?hi():uh!==-1?uh:uh=hi()}function Zl(n){return(n.mode&1)===0?1:(si&2)!==0&&sa!==0?sa&-sa:iu.transition!==null?(dh===0&&(dh=Xa()),dh):(n=Dn,n!==0||(n=window.event,n=n===void 0?16:gd(n.type)),n)}function Ha(n,a,b,j){if(50<dd)throw dd=0,Df=null,Error(t(185));_a(n,b,j),((si&2)===0||n!==ea)&&(n===ea&&((si&2)===0&&(oh|=b),qs===4&&Kl(n,sa)),Sa(n,j),b===1&&si===0&&(a.mode&1)===0&&(hu=hi()+500,ru&&be()))}function Sa(n,a){var b=n.callbackNode;Ml(n,a);var j=Ba(n,n===ea?sa:0);if(j===0)b!==null&&cl(b),n.callbackNode=null,n.callbackPriority=0;else if(a=j&-j,n.callbackPriority!==a){if(b!=null&&cl(b),a===1)n.tag===0?O(im.bind(null,n)):K(im.bind(null,n)),Yh(function(){(si&6)===0&&be()}),b=null;else{switch(oa(j)){case 1:b=La;break;case 4:b=kc;break;case 16:b=On;break;case 536870912:b=pa;break;default:b=On}b=hm(b,nm.bind(null,n))}n.callbackPriority=a,n.callbackNode=b}}function nm(n,a){if(uh=-1,dh=0,(si&6)!==0)throw Error(t(327));var b=n.callbackNode;if(fu()&&n.callbackNode!==b)return null;var j=Ba(n,n===ea?sa:0);if(j===0)return null;if((j&30)!==0||(j&n.expiredLanes)!==0||a)a=hh(n,j);else{a=j;var V=si;si|=2;var Q=om();(ea!==n||sa!==a)&&(kl=null,hu=hi()+500,Cc(n,a));do try{Fm();break}catch(Le){sm(n,Le)}while(!0);Zh(),sh.current=Q,si=V,Vs!==null?a=0:(ea=null,sa=0,a=qs)}if(a!==0){if(a===2&&(V=yu(n),V!==0&&(j=V,a=jf(n,V))),a===1)throw b=cd,Cc(n,0),Kl(n,j),Sa(n,hi()),b;if(a===6)Kl(n,j);else{if(V=n.current.alternate,(j&30)===0&&!Dm(V)&&(a=hh(n,j),a===2&&(Q=yu(n),Q!==0&&(j=Q,a=jf(n,Q))),a===1))throw b=cd,Cc(n,0),Kl(n,j),Sa(n,hi()),b;switch(n.finishedWork=V,n.finishedLanes=j,a){case 0:case 1:throw Error(t(345));case 2:Rc(n,Ea,kl);break;case 3:if(Kl(n,j),(j&130023424)===j&&(a=If+500-hi(),10<a)){if(Ba(n,0)!==0)break;if(V=n.suspendedLanes,(V&j)!==j){xa(),n.pingedLanes|=n.suspendedLanes&V;break}n.timeoutHandle=Hu(Rc.bind(null,n,Ea,kl),a);break}Rc(n,Ea,kl);break;case 4:if(Kl(n,j),(j&4194240)===j)break;for(a=n.eventTimes,V=-1;0<j;){var oe=31-ma(j);Q=1<<oe,oe=a[oe],oe>V&&(V=oe),j&=~Q}if(j=V,j=hi()-j,j=(120>j?120:480>j?480:1080>j?1080:1920>j?1920:3e3>j?3e3:4320>j?4320:1960*Pm(j/1960))-j,10<j){n.timeoutHandle=Hu(Rc.bind(null,n,Ea,kl),j);break}Rc(n,Ea,kl);break;case 5:Rc(n,Ea,kl);break;default:throw Error(t(329))}}}return Sa(n,hi()),n.callbackNode===b?nm.bind(null,n):null}function jf(n,a){var b=ud;return n.current.memoizedState.isDehydrated&&(Cc(n,a).flags|=256),n=hh(n,a),n!==2&&(a=Ea,Ea=b,a!==null&&Ff(a)),n}function Ff(n){Ea===null?Ea=n:Ea.push.apply(Ea,n)}function Dm(n){for(var a=n;;){if(a.flags&16384){var b=a.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var j=0;j<b.length;j++){var V=b[j],Q=V.getSnapshot;V=V.value;try{if(!Ls(Q(),V))return!1}catch{return!1}}}if(b=a.child,a.subtreeFlags&16384&&b!==null)b.return=a,a=b;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Kl(n,a){for(a&=~zf,a&=~oh,n.suspendedLanes|=a,n.pingedLanes&=~a,n=n.expirationTimes;0<a;){var b=31-ma(a),j=1<<b;n[b]=-1,a&=~j}}function im(n){if((si&6)!==0)throw Error(t(327));fu();var a=Ba(n,0);if((a&1)===0)return Sa(n,hi()),null;var b=hh(n,a);if(n.tag!==0&&b===2){var j=yu(n);j!==0&&(a=j,b=jf(n,j))}if(b===1)throw b=cd,Cc(n,0),Kl(n,a),Sa(n,hi()),b;if(b===6)throw Error(t(345));return n.finishedWork=n.current.alternate,n.finishedLanes=a,Rc(n,Ea,kl),Sa(n,hi()),null}function Of(n,a){var b=si;si|=1;try{return n(a)}finally{si=b,si===0&&(hu=hi()+500,ru&&be())}}function Sc(n){Ql!==null&&Ql.tag===0&&(si&6)===0&&fu();var a=si;si|=1;var b=Fa.transition,j=Dn;try{if(Fa.transition=null,Dn=1,n)return n()}finally{Dn=j,Fa.transition=b,si=a,(si&6)===0&&be()}}function Lf(){Ma=du.current,gi(du)}function Cc(n,a){n.finishedWork=null,n.finishedLanes=0;var b=n.timeoutHandle;if(b!==-1&&(n.timeoutHandle=-1,Hh(b)),Vs!==null)for(b=Vs.return;b!==null;){var j=b;switch(ti(j),j.tag){case 1:j=j.type.childContextTypes,j!=null&&vc();break;case 3:lu(),gi(la),gi(Js),cf();break;case 5:af(j);break;case 4:lu();break;case 13:gi(ls);break;case 19:gi(ls);break;case 10:Kh(j.type._context);break;case 22:case 23:Lf()}b=b.return}if(ea=n,Vs=n=ec(n.current,null),sa=Ma=a,qs=0,cd=null,zf=oh=Ec=0,Ea=ud=null,_c!==null){for(a=0;a<_c.length;a++)if(b=_c[a],j=b.interleaved,j!==null){b.interleaved=null;var V=j.next,Q=b.pending;if(Q!==null){var oe=Q.next;Q.next=V,j.next=oe}b.pending=j}_c=null}return n}function sm(n,a){do{var b=Vs;try{if(Zh(),Jd.current=eh,Qd){for(var j=Ss.memoizedState;j!==null;){var V=j.queue;V!==null&&(V.pending=null),j=j.next}Qd=!1}if(wc=0,Ks=Hs=Ss=null,rd=!1,nd=0,Nf.current=null,b===null||b.return===null){qs=1,cd=a,Vs=null;break}e:{var Q=n,oe=b.return,Le=b,st=a;if(a=sa,Le.flags|=32768,st!==null&&typeof st=="object"&&typeof st.then=="function"){var Vt=st,Ur=Le,Wr=Ur.tag;if((Ur.mode&1)===0&&(Wr===0||Wr===11||Wr===15)){var Gr=Ur.alternate;Gr?(Ur.updateQueue=Gr.updateQueue,Ur.memoizedState=Gr.memoizedState,Ur.lanes=Gr.lanes):(Ur.updateQueue=null,Ur.memoizedState=null)}var sn=Mp(oe);if(sn!==null){sn.flags&=-257,Np(sn,oe,Le,Q,a),sn.mode&1&&Tp(Q,Vt,a),a=sn,st=Vt;var an=a.updateQueue;if(an===null){var bn=new Set;bn.add(st),a.updateQueue=bn}else an.add(st);break e}else{if((a&1)===0){Tp(Q,Vt,a),Bf();break e}st=Error(t(426))}}else if($r&&Le.mode&1){var Gs=Mp(oe);if(Gs!==null){(Gs.flags&65536)===0&&(Gs.flags|=256),Np(Gs,oe,Le,Q,a),nu(cu(st,Le));break e}}Q=st=cu(st,Le),qs!==4&&(qs=2),ud===null?ud=[Q]:ud.push(Q),Q=oe;do{switch(Q.tag){case 3:Q.flags|=65536,a&=-a,Q.lanes|=a;var Et=Ap(Q,st,a);Jf(Q,Et);break e;case 1:Le=st;var ot=Q.type,Tt=Q.stateNode;if((Q.flags&128)===0&&(typeof ot.getDerivedStateFromError=="function"||Tt!==null&&typeof Tt.componentDidCatch=="function"&&(Jl===null||!Jl.has(Tt)))){Q.flags|=65536,a&=-a,Q.lanes|=a;var qr=kp(Q,Le,a);Jf(Q,qr);break e}}Q=Q.return}while(Q!==null)}lm(b)}catch(wn){a=wn,Vs===b&&b!==null&&(Vs=b=b.return);continue}break}while(!0)}function om(){var n=sh.current;return sh.current=eh,n===null?eh:n}function Bf(){(qs===0||qs===3||qs===2)&&(qs=4),ea===null||(Ec&268435455)===0&&(oh&268435455)===0||Kl(ea,sa)}function hh(n,a){var b=si;si|=2;var j=om();(ea!==n||sa!==a)&&(kl=null,Cc(n,a));do try{jm();break}catch(V){sm(n,V)}while(!0);if(Zh(),si=b,sh.current=j,Vs!==null)throw Error(t(261));return ea=null,sa=0,qs}function jm(){for(;Vs!==null;)am(Vs)}function Fm(){for(;Vs!==null&&!ul();)am(Vs)}function am(n){var a=dm(n.alternate,n,Ma);n.memoizedProps=n.pendingProps,a===null?lm(n):Vs=a,Nf.current=null}function lm(n){var a=n;do{var b=a.alternate;if(n=a.return,(a.flags&32768)===0){if(b=Tm(b,a,Ma),b!==null){Vs=b;return}}else{if(b=Mm(b,a),b!==null){b.flags&=32767,Vs=b;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{qs=6,Vs=null;return}}if(a=a.sibling,a!==null){Vs=a;return}Vs=a=n}while(a!==null);qs===0&&(qs=5)}function Rc(n,a,b){var j=Dn,V=Fa.transition;try{Fa.transition=null,Dn=1,Om(n,a,b,j)}finally{Fa.transition=V,Dn=j}return null}function Om(n,a,b,j){do fu();while(Ql!==null);if((si&6)!==0)throw Error(t(327));b=n.finishedWork;var V=n.finishedLanes;if(b===null)return null;if(n.finishedWork=null,n.finishedLanes=0,b===n.current)throw Error(t(177));n.callbackNode=null,n.callbackPriority=0;var Q=b.lanes|b.childLanes;if(bh(n,Q),n===ea&&(Vs=ea=null,sa=0),(b.subtreeFlags&2064)===0&&(b.flags&2064)===0||lh||(lh=!0,hm(On,function(){return fu(),null})),Q=(b.flags&15990)!==0,(b.subtreeFlags&15990)!==0||Q){Q=Fa.transition,Fa.transition=null;var oe=Dn;Dn=1;var Le=si;si|=4,Nf.current=null,zm(n,b),Zp(b,n),Pd(Wu),zc=!!$u,Wu=$u=null,n.current=b,Im(b),Ya(),si=Le,Dn=oe,Fa.transition=Q}else n.current=b;if(lh&&(lh=!1,Ql=n,ch=V),Q=n.pendingLanes,Q===0&&(Jl=null),hl(b.stateNode),Sa(n,hi()),a!==null)for(j=n.onRecoverableError,b=0;b<a.length;b++)V=a[b],j(V.value,{componentStack:V.stack,digest:V.digest});if(ah)throw ah=!1,n=Pf,Pf=null,n;return(ch&1)!==0&&n.tag!==0&&fu(),Q=n.pendingLanes,(Q&1)!==0?n===Df?dd++:(dd=0,Df=n):dd=0,be(),null}function fu(){if(Ql!==null){var n=oa(ch),a=Fa.transition,b=Dn;try{if(Fa.transition=null,Dn=16>n?16:n,Ql===null)var j=!1;else{if(n=Ql,Ql=null,ch=0,(si&6)!==0)throw Error(t(331));var V=si;for(si|=4,on=n.current;on!==null;){var Q=on,oe=Q.child;if((on.flags&16)!==0){var Le=Q.deletions;if(Le!==null){for(var st=0;st<Le.length;st++){var Vt=Le[st];for(on=Vt;on!==null;){var Ur=on;switch(Ur.tag){case 0:case 11:case 15:ld(8,Ur,Q)}var Wr=Ur.child;if(Wr!==null)Wr.return=Ur,on=Wr;else for(;on!==null;){Ur=on;var Gr=Ur.sibling,sn=Ur.return;if(Yp(Ur),Ur===Vt){on=null;break}if(Gr!==null){Gr.return=sn,on=Gr;break}on=sn}}}var an=Q.alternate;if(an!==null){var bn=an.child;if(bn!==null){an.child=null;do{var Gs=bn.sibling;bn.sibling=null,bn=Gs}while(bn!==null)}}on=Q}}if((Q.subtreeFlags&2064)!==0&&oe!==null)oe.return=Q,on=oe;else e:for(;on!==null;){if(Q=on,(Q.flags&2048)!==0)switch(Q.tag){case 0:case 11:case 15:ld(9,Q,Q.return)}var Et=Q.sibling;if(Et!==null){Et.return=Q.return,on=Et;break e}on=Q.return}}var ot=n.current;for(on=ot;on!==null;){oe=on;var Tt=oe.child;if((oe.subtreeFlags&2064)!==0&&Tt!==null)Tt.return=oe,on=Tt;else e:for(oe=ot;on!==null;){if(Le=on,(Le.flags&2048)!==0)try{switch(Le.tag){case 0:case 11:case 15:ih(9,Le)}}catch(wn){Ts(Le,Le.return,wn)}if(Le===oe){on=null;break e}var qr=Le.sibling;if(qr!==null){qr.return=Le.return,on=qr;break e}on=Le.return}}if(si=V,be(),$s&&typeof $s.onPostCommitFiberRoot=="function")try{$s.onPostCommitFiberRoot(Tl,n)}catch{}j=!0}return j}finally{Dn=b,Fa.transition=a}}return!1}function cm(n,a,b){a=cu(b,a),a=Ap(n,a,1),n=ql(n,a,1),a=xa(),n!==null&&(_a(n,1,a),Sa(n,a))}function Ts(n,a,b){if(n.tag===3)cm(n,n,b);else for(;a!==null;){if(a.tag===3){cm(a,n,b);break}else if(a.tag===1){var j=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof j.componentDidCatch=="function"&&(Jl===null||!Jl.has(j))){n=cu(b,n),n=kp(a,n,1),a=ql(a,n,1),n=xa(),a!==null&&(_a(a,1,n),Sa(a,n));break}}a=a.return}}function Lm(n,a,b){var j=n.pingCache;j!==null&&j.delete(a),a=xa(),n.pingedLanes|=n.suspendedLanes&b,ea===n&&(sa&b)===b&&(qs===4||qs===3&&(sa&130023424)===sa&&500>hi()-If?Cc(n,0):zf|=b),Sa(n,a)}function um(n,a){a===0&&((n.mode&1)===0?a=1:(a=qa,qa<<=1,(qa&130023424)===0&&(qa=4194304)));var b=xa();n=Cl(n,a),n!==null&&(_a(n,a,b),Sa(n,b))}function Bm(n){var a=n.memoizedState,b=0;a!==null&&(b=a.retryLane),um(n,b)}function Gm(n,a){var b=0;switch(n.tag){case 13:var j=n.stateNode,V=n.memoizedState;V!==null&&(b=V.retryLane);break;case 19:j=n.stateNode;break;default:throw Error(t(314))}j!==null&&j.delete(a),um(n,b)}var dm;dm=function(n,a,b){if(n!==null)if(n.memoizedProps!==a.pendingProps||la.current)wa=!0;else{if((n.lanes&b)===0&&(a.flags&128)===0)return wa=!1,km(n,a,b);wa=(n.flags&131072)!==0}else wa=!1,$r&&(a.flags&1048576)!==0&&pi(a,ct,a.index);switch(a.lanes=0,a.tag){case 2:var j=a.type;rh(n,a),n=a.pendingProps;var V=Sl(a,Js.current);ou(a,b),V=hf(null,a,j,n,V,b);var Q=ff();return a.flags|=1,typeof V=="object"&&V!==null&&typeof V.render=="function"&&V.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,na(j)?(Q=!0,xc(a)):Q=!1,a.memoizedState=V.state!==null&&V.state!==void 0?V.state:null,rf(a),V.updater=Yd,a.stateNode=V,V._reactInternals=a,sf(a,j,n,b),a=bf(null,a,j,!0,Q,b)):(a.tag=0,$r&&Q&&vi(a),va(null,a,V,b),a=a.child),a;case 16:j=a.elementType;e:{switch(rh(n,a),n=a.pendingProps,V=j._init,j=V(j._payload),a.type=j,V=a.tag=Vm(j),n=ca(j,n),V){case 0:a=_f(null,a,j,n,b);break e;case 1:a=Fp(null,a,j,n,b);break e;case 11:a=zp(null,a,j,n,b);break e;case 14:a=Ip(null,a,j,ca(j.type,n),b);break e}throw Error(t(306,j,""))}return a;case 0:return j=a.type,V=a.pendingProps,V=a.elementType===j?V:ca(j,V),_f(n,a,j,V,b);case 1:return j=a.type,V=a.pendingProps,V=a.elementType===j?V:ca(j,V),Fp(n,a,j,V,b);case 3:e:{if(Op(a),n===null)throw Error(t(387));j=a.pendingProps,Q=a.memoizedState,V=Q.element,Xf(n,a),Hd(a,j,null,b);var oe=a.memoizedState;if(j=oe.element,Q.isDehydrated)if(Q={element:j,isDehydrated:!1,cache:oe.cache,pendingSuspenseBoundaries:oe.pendingSuspenseBoundaries,transitions:oe.transitions},a.updateQueue.baseState=Q,a.memoizedState=Q,a.flags&256){V=cu(Error(t(423)),a),a=Lp(n,a,j,b,V);break e}else if(j!==V){V=cu(Error(t(424)),a),a=Lp(n,a,j,b,V);break e}else for(En=Ia(a.stateNode.containerInfo.firstChild),Cn=a,$r=!0,Rn=null,b=ip(a,null,j,b),a.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(ba(),j===V){a=Al(n,a,b);break e}va(n,a,j,b)}a=a.child}return a;case 5:return sp(a),n===null&&li(a),j=a.type,V=a.pendingProps,Q=n!==null?n.memoizedProps:null,oe=V.children,ka(j,V)?oe=null:Q!==null&&ka(j,Q)&&(a.flags|=32),jp(n,a),va(n,a,oe,b),a.child;case 6:return n===null&&li(a),null;case 13:return Bp(n,a,b);case 4:return of(a,a.stateNode.containerInfo),j=a.pendingProps,n===null?a.child=au(a,null,j,b):va(n,a,j,b),a.child;case 11:return j=a.type,V=a.pendingProps,V=a.elementType===j?V:ca(j,V),zp(n,a,j,V,b);case 7:return va(n,a,a.pendingProps,b),a.child;case 8:return va(n,a,a.pendingProps.children,b),a.child;case 12:return va(n,a,a.pendingProps.children,b),a.child;case 10:e:{if(j=a.type._context,V=a.pendingProps,Q=a.memoizedProps,oe=V.value,fi(Vd,j._currentValue),j._currentValue=oe,Q!==null)if(Ls(Q.value,oe)){if(Q.children===V.children&&!la.current){a=Al(n,a,b);break e}}else for(Q=a.child,Q!==null&&(Q.return=a);Q!==null;){var Le=Q.dependencies;if(Le!==null){oe=Q.child;for(var st=Le.firstContext;st!==null;){if(st.context===j){if(Q.tag===1){st=Rl(-1,b&-b),st.tag=2;var Vt=Q.updateQueue;if(Vt!==null){Vt=Vt.shared;var Ur=Vt.pending;Ur===null?st.next=st:(st.next=Ur.next,Ur.next=st),Vt.pending=st}}Q.lanes|=b,st=Q.alternate,st!==null&&(st.lanes|=b),ef(Q.return,b,a),Le.lanes|=b;break}st=st.next}}else if(Q.tag===10)oe=Q.type===a.type?null:Q.child;else if(Q.tag===18){if(oe=Q.return,oe===null)throw Error(t(341));oe.lanes|=b,Le=oe.alternate,Le!==null&&(Le.lanes|=b),ef(oe,b,a),oe=Q.sibling}else oe=Q.child;if(oe!==null)oe.return=Q;else for(oe=Q;oe!==null;){if(oe===a){oe=null;break}if(Q=oe.sibling,Q!==null){Q.return=oe.return,oe=Q;break}oe=oe.return}Q=oe}va(n,a,V.children,b),a=a.child}return a;case 9:return V=a.type,j=a.pendingProps.children,ou(a,b),V=Da(V),j=j(V),a.flags|=1,va(n,a,j,b),a.child;case 14:return j=a.type,V=ca(j,a.pendingProps),V=ca(j.type,V),Ip(n,a,j,V,b);case 15:return Pp(n,a,a.type,a.pendingProps,b);case 17:return j=a.type,V=a.pendingProps,V=a.elementType===j?V:ca(j,V),rh(n,a),a.tag=1,na(j)?(n=!0,xc(a)):n=!1,ou(a,b),ep(a,j,V),sf(a,j,V,b),bf(null,a,j,!0,n,b);case 19:return Up(n,a,b);case 22:return Dp(n,a,b)}throw Error(t(156,a.tag))};function hm(n,a){return ll(n,a)}function Um(n,a,b,j){this.tag=n,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=j,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oa(n,a,b,j){return new Um(n,a,b,j)}function Gf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Vm(n){if(typeof n=="function")return Gf(n)?1:0;if(n!=null){if(n=n.$$typeof,n===X)return 11;if(n===H)return 14}return 2}function ec(n,a){var b=n.alternate;return b===null?(b=Oa(n.tag,a,n.key,n.mode),b.elementType=n.elementType,b.type=n.type,b.stateNode=n.stateNode,b.alternate=n,n.alternate=b):(b.pendingProps=a,b.type=n.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=n.flags&14680064,b.childLanes=n.childLanes,b.lanes=n.lanes,b.child=n.child,b.memoizedProps=n.memoizedProps,b.memoizedState=n.memoizedState,b.updateQueue=n.updateQueue,a=n.dependencies,b.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},b.sibling=n.sibling,b.index=n.index,b.ref=n.ref,b}function fh(n,a,b,j,V,Q){var oe=2;if(j=n,typeof n=="function")Gf(n)&&(oe=1);else if(typeof n=="string")oe=5;else e:switch(n){case k:return Ac(b.children,V,Q,a);case M:oe=8,V|=8;break;case D:return n=Oa(12,b,a,V|2),n.elementType=D,n.lanes=Q,n;case B:return n=Oa(13,b,a,V),n.elementType=B,n.lanes=Q,n;case L:return n=Oa(19,b,a,V),n.elementType=L,n.lanes=Q,n;case Y:return ph(b,V,Q,a);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case P:oe=10;break e;case F:oe=9;break e;case X:oe=11;break e;case H:oe=14;break e;case U:oe=16,j=null;break e}throw Error(t(130,n==null?n:typeof n,""))}return a=Oa(oe,b,a,V),a.elementType=n,a.type=j,a.lanes=Q,a}function Ac(n,a,b,j){return n=Oa(7,n,j,a),n.lanes=b,n}function ph(n,a,b,j){return n=Oa(22,n,j,a),n.elementType=Y,n.lanes=b,n.stateNode={isHidden:!1},n}function Uf(n,a,b){return n=Oa(6,n,null,a),n.lanes=b,n}function Vf(n,a,b){return a=Oa(4,n.children!==null?n.children:[],n.key,a),a.lanes=b,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}function $m(n,a,b,j,V){this.tag=a,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tc(0),this.expirationTimes=Tc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tc(0),this.identifierPrefix=j,this.onRecoverableError=V,this.mutableSourceEagerHydrationData=null}function $f(n,a,b,j,V,Q,oe,Le,st){return n=new $m(n,a,b,Le,st),a===1?(a=1,Q===!0&&(a|=8)):a=0,Q=Oa(3,null,null,a),n.current=Q,Q.stateNode=n,Q.memoizedState={element:j,isDehydrated:b,cache:null,transitions:null,pendingSuspenseBoundaries:null},rf(Q),n}function Wm(n,a,b){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:x,key:j==null?null:""+j,children:n,containerInfo:a,implementation:b}}function fm(n){if(!n)return nl;n=n._reactInternals;e:{if(ei(n)!==n||n.tag!==1)throw Error(t(170));var a=n;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(na(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(n.tag===1){var b=n.type;if(na(b))return Ju(n,b,a)}return a}function pm(n,a,b,j,V,Q,oe,Le,st){return n=$f(b,j,!0,n,V,Q,oe,Le,st),n.context=fm(null),b=n.current,j=xa(),V=Zl(b),Q=Rl(j,V),Q.callback=a??null,ql(b,Q,V),n.current.lanes=V,_a(n,V,j),Sa(n,j),n}function mh(n,a,b,j){var V=a.current,Q=xa(),oe=Zl(V);return b=fm(b),a.context===null?a.context=b:a.pendingContext=b,a=Rl(Q,oe),a.payload={element:n},j=j===void 0?null:j,j!==null&&(a.callback=j),n=ql(V,a,oe),n!==null&&(Ha(n,V,oe,Q),Wd(n,V,oe)),oe}function gh(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function mm(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var b=n.retryLane;n.retryLane=b!==0&&b<a?b:a}}function Wf(n,a){mm(n,a),(n=n.alternate)&&mm(n,a)}function Hm(){return null}var gm=typeof reportError=="function"?reportError:function(n){console.error(n)};function Hf(n){this._internalRoot=n}yh.prototype.render=Hf.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(t(409));mh(n,a,null,null)},yh.prototype.unmount=Hf.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;Sc(function(){mh(null,n,null,null)}),a[ya]=null}};function yh(n){this._internalRoot=n}yh.prototype.unstable_scheduleHydration=function(n){if(n){var a=vu();n={blockedOn:null,target:n,priority:a};for(var b=0;b<Za.length&&a!==0&&a<Za[b].priority;b++);Za.splice(b,0,n),b===0&&pd(n)}};function Yf(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function vh(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function ym(){}function Ym(n,a,b,j,V){if(V){if(typeof j=="function"){var Q=j;j=function(){var Vt=gh(oe);Q.call(Vt)}}var oe=pm(a,j,n,0,null,!1,!1,"",ym);return n._reactRootContainer=oe,n[ya]=oe.current,fc(n.nodeType===8?n.parentNode:n),Sc(),oe}for(;V=n.lastChild;)n.removeChild(V);if(typeof j=="function"){var Le=j;j=function(){var Vt=gh(st);Le.call(Vt)}}var st=$f(n,0,!1,null,null,!1,!1,"",ym);return n._reactRootContainer=st,n[ya]=st.current,fc(n.nodeType===8?n.parentNode:n),Sc(function(){mh(a,st,b,j)}),st}function xh(n,a,b,j,V){var Q=b._reactRootContainer;if(Q){var oe=Q;if(typeof V=="function"){var Le=V;V=function(){var st=gh(oe);Le.call(st)}}mh(a,oe,n,V)}else oe=Ym(b,a,n,V,j);return gh(oe)}ii=function(n){switch(n.tag){case 3:var a=n.stateNode;if(a.current.memoizedState.isDehydrated){var b=Ns(a.pendingLanes);b!==0&&(za(a,b|1),Sa(a,hi()),(si&6)===0&&(hu=hi()+500,be()))}break;case 13:Sc(function(){var j=Cl(n,1);if(j!==null){var V=xa();Ha(j,n,1,V)}}),Wf(n,1)}},pl=function(n){if(n.tag===13){var a=Cl(n,134217728);if(a!==null){var b=xa();Ha(a,n,134217728,b)}Wf(n,134217728)}},Mc=function(n){if(n.tag===13){var a=Zl(n),b=Cl(n,a);if(b!==null){var j=xa();Ha(b,n,a,j)}Wf(n,a)}},vu=function(){return Dn},ml=function(n,a){var b=Dn;try{return Dn=n,a()}finally{Dn=b}},se=function(n,a,b){switch(a){case"input":if(Jt(n,b),a=b.name,b.type==="radio"&&a!=null){for(b=n;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<b.length;a++){var j=b[a];if(j!==n&&j.form===n.form){var V=tu(j);if(!V)throw Error(t(90));Gt(j),Jt(j,V)}}}break;case"textarea":Mt(n,b);break;case"select":a=b.value,a!=null&&cr(n,!!b.multiple,a,!1)}},me=Of,Ze=Sc;var qm={usingClientEntryPoint:!1,Events:[yc,Wl,tu,ut,at,Of]},hd={findFiberByHostInstance:El,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Xm={bundleType:hd.bundleType,version:hd.version,rendererPackageName:hd.rendererPackageName,rendererConfig:hd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Us(n),n===null?null:n.stateNode},findFiberByHostInstance:hd.findFiberByHostInstance||Hm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_h.isDisabled&&_h.supportsFiber)try{Tl=_h.inject(Xm),$s=_h}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qm,reactDom_production_min.createPortal=function(n,a){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yf(a))throw Error(t(200));return Wm(n,a,null,b)},reactDom_production_min.createRoot=function(n,a){if(!Yf(n))throw Error(t(299));var b=!1,j="",V=gm;return a!=null&&(a.unstable_strictMode===!0&&(b=!0),a.identifierPrefix!==void 0&&(j=a.identifierPrefix),a.onRecoverableError!==void 0&&(V=a.onRecoverableError)),a=$f(n,1,!1,null,null,b,!1,j,V),n[ya]=a.current,fc(n.nodeType===8?n.parentNode:n),new Hf(a)},reactDom_production_min.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(t(188)):(n=Object.keys(n).join(","),Error(t(268,n)));return n=Us(a),n=n===null?null:n.stateNode,n},reactDom_production_min.flushSync=function(n){return Sc(n)},reactDom_production_min.hydrate=function(n,a,b){if(!vh(a))throw Error(t(200));return xh(null,n,a,!0,b)},reactDom_production_min.hydrateRoot=function(n,a,b){if(!Yf(n))throw Error(t(405));var j=b!=null&&b.hydratedSources||null,V=!1,Q="",oe=gm;if(b!=null&&(b.unstable_strictMode===!0&&(V=!0),b.identifierPrefix!==void 0&&(Q=b.identifierPrefix),b.onRecoverableError!==void 0&&(oe=b.onRecoverableError)),a=pm(a,null,n,1,b??null,V,!1,Q,oe),n[ya]=a.current,fc(n),j)for(n=0;n<j.length;n++)b=j[n],V=b._getVersion,V=V(b._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[b,V]:a.mutableSourceEagerHydrationData.push(b,V);return new yh(a)},reactDom_production_min.render=function(n,a,b){if(!vh(a))throw Error(t(200));return xh(null,n,a,!1,b)},reactDom_production_min.unmountComponentAtNode=function(n){if(!vh(n))throw Error(t(40));return n._reactRootContainer?(Sc(function(){xh(null,null,n,!1,function(){n._reactRootContainer=null,n[ya]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=Of,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(n,a,b,j){if(!vh(b))throw Error(t(200));if(n==null||n._reactInternals===void 0)throw Error(t(38));return xh(n,a,b,!1,j)},reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var e=requireReactDom();return client.createRoot=e.createRoot,client.hydrateRoot=e.hydrateRoot,client}var clientExports=requireClient();const ReactDOM$1=getDefaultExportFromCjs(clientExports);/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createBrowserHistory(e={}){function r(o,c){let{pathname:u,search:y,hash:f}=o.location;return createLocation("",{pathname:u,search:y,hash:f},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function t(o,c){return typeof c=="string"?c:createPath(c)}return getUrlBasedHistory(r,t,null,e)}function invariant(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function warning(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(e,r){return{usr:e.state,key:e.key,idx:r}}function createLocation(e,r,t=null,o){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof r=="string"?parsePath(r):r,state:t,key:r&&r.key||o||createKey()}}function createPath({pathname:e="/",search:r="",hash:t=""}){return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function parsePath(e){let r={};if(e){let t=e.indexOf("#");t>=0&&(r.hash=e.substring(t),e=e.substring(0,t));let o=e.indexOf("?");o>=0&&(r.search=e.substring(o),e=e.substring(0,o)),e&&(r.pathname=e)}return r}function getUrlBasedHistory(e,r,t,o={}){let{window:c=document.defaultView,v5Compat:u=!1}=o,y=c.history,f="POP",g=null,_=p();_==null&&(_=0,y.replaceState({...y.state,idx:_},""));function p(){return(y.state||{idx:null}).idx}function S(){f="POP";let s=p(),v=s==null?null:s-_;_=s,g&&g({action:f,location:l.location,delta:v})}function A(s,v){f="PUSH";let w=createLocation(l.location,s,v);_=p()+1;let E=getHistoryState(w,_),C=l.createHref(w);try{y.pushState(E,"",C)}catch(h){if(h instanceof DOMException&&h.name==="DataCloneError")throw h;c.location.assign(C)}u&&g&&g({action:f,location:l.location,delta:1})}function R(s,v){f="REPLACE";let w=createLocation(l.location,s,v);_=p();let E=getHistoryState(w,_),C=l.createHref(w);y.replaceState(E,"",C),u&&g&&g({action:f,location:l.location,delta:0})}function z(s){return createBrowserURLImpl(s)}let l={get action(){return f},get location(){return e(c,y)},listen(s){if(g)throw new Error("A history only accepts one active listener");return c.addEventListener(PopStateEventType,S),g=s,()=>{c.removeEventListener(PopStateEventType,S),g=null}},createHref(s){return r(c,s)},createURL:z,encodeLocation(s){let v=z(s);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:A,replace:R,go(s){return y.go(s)}};return l}function createBrowserURLImpl(e,r=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),invariant(t,"No window.location.(origin|href) available to create URL");let o=typeof e=="string"?e:createPath(e);return o=o.replace(/ $/,"%20"),!r&&o.startsWith("//")&&(o=t+o),new URL(o,t)}function matchRoutes(e,r,t="/"){return matchRoutesImpl(e,r,t,!1)}function matchRoutesImpl(e,r,t,o){let c=typeof r=="string"?parsePath(r):r,u=stripBasename(c.pathname||"/",t);if(u==null)return null;let y=flattenRoutes(e);rankRouteBranches(y);let f=null;for(let g=0;f==null&&g<y.length;++g){let _=decodePath(u);f=matchRouteBranch(y[g],_,o)}return f}function flattenRoutes(e,r=[],t=[],o="",c=!1){let u=(y,f,g=c,_)=>{let p={relativePath:_===void 0?y.path||"":_,caseSensitive:y.caseSensitive===!0,childrenIndex:f,route:y};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(o)&&g)return;invariant(p.relativePath.startsWith(o),`Absolute route path "${p.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(o.length)}let S=joinPaths([o,p.relativePath]),A=t.concat(p);y.children&&y.children.length>0&&(invariant(y.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${S}".`),flattenRoutes(y.children,r,A,S,g)),!(y.path==null&&!y.index)&&r.push({path:S,score:computeScore(S,y.index),routesMeta:A})};return e.forEach((y,f)=>{if(y.path===""||!y.path?.includes("?"))u(y,f);else for(let g of explodeOptionalSegments(y.path))u(y,f,!0,g)}),r}function explodeOptionalSegments(e){let r=e.split("/");if(r.length===0)return[];let[t,...o]=r,c=t.endsWith("?"),u=t.replace(/\?$/,"");if(o.length===0)return c?[u,""]:[u];let y=explodeOptionalSegments(o.join("/")),f=[];return f.push(...y.map(g=>g===""?u:[u,g].join("/"))),c&&f.push(...y),f.map(g=>e.startsWith("/")&&g===""?"/":g)}function rankRouteBranches(e){e.sort((r,t)=>r.score!==t.score?t.score-r.score:compareIndexes(r.routesMeta.map(o=>o.childrenIndex),t.routesMeta.map(o=>o.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,r){let t=e.split("/"),o=t.length;return t.some(isSplat)&&(o+=splatPenalty),r&&(o+=indexRouteValue),t.filter(c=>!isSplat(c)).reduce((c,u)=>c+(paramRe.test(u)?dynamicSegmentValue:u===""?emptySegmentValue:staticSegmentValue),o)}function compareIndexes(e,r){return e.length===r.length&&e.slice(0,-1).every((o,c)=>o===r[c])?e[e.length-1]-r[r.length-1]:0}function matchRouteBranch(e,r,t=!1){let{routesMeta:o}=e,c={},u="/",y=[];for(let f=0;f<o.length;++f){let g=o[f],_=f===o.length-1,p=u==="/"?r:r.slice(u.length)||"/",S=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:_},p),A=g.route;if(!S&&_&&t&&!o[o.length-1].route.index&&(S=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},p)),!S)return null;Object.assign(c,S.params),y.push({params:c,pathname:joinPaths([u,S.pathname]),pathnameBase:normalizePathname(joinPaths([u,S.pathnameBase])),route:A}),S.pathnameBase!=="/"&&(u=joinPaths([u,S.pathnameBase]))}return y}function matchPath(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,o]=compilePath(e.path,e.caseSensitive,e.end),c=r.match(t);if(!c)return null;let u=c[0],y=u.replace(/(.)\/+$/,"$1"),f=c.slice(1);return{params:o.reduce((_,{paramName:p,isOptional:S},A)=>{if(p==="*"){let z=f[A]||"";y=u.slice(0,u.length-z.length).replace(/(.)\/+$/,"$1")}const R=f[A];return S&&!R?_[p]=void 0:_[p]=(R||"").replace(/%2F/g,"/"),_},{}),pathname:u,pathnameBase:y,pattern:e}}function compilePath(e,r=!1,t=!0){warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let o=[],c="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(y,f,g)=>(o.push({paramName:f,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(o.push({paramName:"*"}),c+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?c+="\\/*$":e!==""&&e!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,r?void 0:"i"),o]}function decodePath(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return warning(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),e}}function stripBasename(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let t=r.endsWith("/")?r.length-1:r.length,o=e.charAt(t);return o&&o!=="/"?null:e.slice(t)||"/"}function resolvePath(e,r="/"){let{pathname:t,search:o="",hash:c=""}=typeof e=="string"?parsePath(e):e;return{pathname:t?t.startsWith("/")?t:resolvePathname(t,r):r,search:normalizeSearch(o),hash:normalizeHash(c)}}function resolvePathname(e,r){let t=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(c=>{c===".."?t.length>1&&t.pop():c!=="."&&t.push(c)}),t.length>1?t.join("/"):"/"}function getInvalidPathError(e,r,t,o){return`Cannot include a '${e}' character in a manually specified \`to.${r}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(e){return e.filter((r,t)=>t===0||r.route.path&&r.route.path.length>0)}function getResolveToMatches(e){let r=getPathContributingMatches(e);return r.map((t,o)=>o===r.length-1?t.pathname:t.pathnameBase)}function resolveTo(e,r,t,o=!1){let c;typeof e=="string"?c=parsePath(e):(c={...e},invariant(!c.pathname||!c.pathname.includes("?"),getInvalidPathError("?","pathname","search",c)),invariant(!c.pathname||!c.pathname.includes("#"),getInvalidPathError("#","pathname","hash",c)),invariant(!c.search||!c.search.includes("#"),getInvalidPathError("#","search","hash",c)));let u=e===""||c.pathname==="",y=u?"/":c.pathname,f;if(y==null)f=t;else{let S=r.length-1;if(!o&&y.startsWith("..")){let A=y.split("/");for(;A[0]==="..";)A.shift(),S-=1;c.pathname=A.join("/")}f=S>=0?r[S]:"/"}let g=resolvePath(c,f),_=y&&y!=="/"&&y.endsWith("/"),p=(u||y===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(_||p)&&(g.pathname+="/"),g}var joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";reactExports.createContext(!1);var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(e,{relative:r}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:o}=reactExports.useContext(NavigationContext),{hash:c,pathname:u,search:y}=useResolvedPath(e,{relative:r}),f=u;return t!=="/"&&(f=u==="/"?t:joinPaths([t,u])),o.createHref({pathname:f,search:y,hash:c})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(e){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let e=reactExports.useContext(DataRouterContext),{basename:r,navigator:t}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),u=JSON.stringify(getResolveToMatches(o)),y=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{y.current=!0}),reactExports.useCallback((g,_={})=>{if(warning(y.current,navigateEffectWarning),!y.current)return;if(typeof g=="number"){t.go(g);return}let p=resolveTo(g,JSON.parse(u),c,_.relative==="path");e==null&&r!=="/"&&(p.pathname=p.pathname==="/"?r:joinPaths([r,p.pathname])),(_.replace?t.replace:t.push)(p,_.state,_)},[r,t,u,c,e])}reactExports.createContext(null);function useResolvedPath(e,{relative:r}={}){let{matches:t}=reactExports.useContext(RouteContext),{pathname:o}=useLocation(),c=JSON.stringify(getResolveToMatches(t));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(c),o,r==="path"),[e,c,o,r])}function useRoutesImpl(e,r,t,o,c){invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=reactExports.useContext(NavigationContext),{matches:y}=reactExports.useContext(RouteContext),f=y[y.length-1],g=f?f.params:{},_=f?f.pathname:"/",p=f?f.pathnameBase:"/",S=f&&f.route;{let w=S&&S.path||"";warningOnce(_,!S||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${_}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let A=useLocation(),R;R=A;let z=R.pathname||"/",l=z;if(p!=="/"){let w=p.replace(/^\//,"").split("/");l="/"+z.replace(/^\//,"").split("/").slice(w.length).join("/")}let s=matchRoutes(e,{pathname:l});return warning(S||s!=null,`No routes matched location "${R.pathname}${R.search}${R.hash}" `),warning(s==null||s[s.length-1].route.element!==void 0||s[s.length-1].route.Component!==void 0||s[s.length-1].route.lazy!==void 0,`Matched leaf route at location "${R.pathname}${R.search}${R.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),_renderMatches(s&&s.map(w=>Object.assign({},w,{params:Object.assign({},g,w.params),pathname:joinPaths([p,u.encodeLocation?u.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?p:joinPaths([p,u.encodeLocation?u.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),y,t,o,c)}function DefaultErrorComponent(){let e=useRouteError(),r=isRouteErrorResponse(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,o="rgba(200,200,200, 0.5)",c={padding:"0.5rem",backgroundColor:o},u={padding:"2px 4px",backgroundColor:o},y=null;return console.error("Error handled by React Router default ErrorBoundary:",e),y=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null,"💿 Hey developer 👋"),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:u},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:u},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},r),t?reactExports.createElement("pre",{style:c},t):null,y)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){this.props.unstable_onError?this.props.unstable_onError(e,r):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:e,match:r,children:t}){let o=reactExports.useContext(DataRouterContext);return o&&o.static&&o.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=r.route.id),reactExports.createElement(RouteContext.Provider,{value:e},t)}function _renderMatches(e,r=[],t=null,o=null,c=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(r.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let u=e,y=t?.errors;if(y!=null){let _=u.findIndex(p=>p.route.id&&y?.[p.route.id]!==void 0);invariant(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(y).join(",")}`),u=u.slice(0,Math.min(u.length,_+1))}let f=!1,g=-1;if(t)for(let _=0;_<u.length;_++){let p=u[_];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(g=_),p.route.id){let{loaderData:S,errors:A}=t,R=p.route.loader&&!S.hasOwnProperty(p.route.id)&&(!A||A[p.route.id]===void 0);if(p.route.lazy||R){f=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}return u.reduceRight((_,p,S)=>{let A,R=!1,z=null,l=null;t&&(A=y&&p.route.id?y[p.route.id]:void 0,z=p.route.errorElement||defaultErrorElement,f&&(g<0&&S===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),R=!0,l=null):g===S&&(R=!0,l=p.route.hydrateFallbackElement||null)));let s=r.concat(u.slice(0,S+1)),v=()=>{let w;return A?w=z:R?w=l:p.route.Component?w=reactExports.createElement(p.route.Component,null):p.route.element?w=p.route.element:w=_,reactExports.createElement(RenderedRoute,{match:p,routeContext:{outlet:_,matches:s,isDataRoute:t!=null},children:w})};return t&&(p.route.ErrorBoundary||p.route.errorElement||S===0)?reactExports.createElement(RenderErrorBoundary,{location:t.location,revalidation:t.revalidation,component:z,error:A,children:v(),routeContext:{outlet:null,matches:s,isDataRoute:!0},unstable_onError:o}):v()},null)}function getDataRouterConsoleError(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(e){let r=reactExports.useContext(DataRouterContext);return invariant(r,getDataRouterConsoleError(e)),r}function useDataRouterState(e){let r=reactExports.useContext(DataRouterStateContext);return invariant(r,getDataRouterConsoleError(e)),r}function useRouteContext(e){let r=reactExports.useContext(RouteContext);return invariant(r,getDataRouterConsoleError(e)),r}function useCurrentRouteId(e){let r=useRouteContext(e),t=r.matches[r.matches.length-1];return invariant(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){let e=reactExports.useContext(RouteErrorContext),r=useDataRouterState("useRouteError"),t=useCurrentRouteId("useRouteError");return e!==void 0?e:r.errors?.[t]}function useNavigateStable(){let{router:e}=useDataRouterContext("useNavigate"),r=useCurrentRouteId("useNavigate"),t=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{t.current=!0}),reactExports.useCallback(async(c,u={})=>{warning(t.current,navigateEffectWarning),t.current&&(typeof c=="number"?e.navigate(c):await e.navigate(c,{fromRouteId:r,...u}))},[e,r])}var alreadyWarned={};function warningOnce(e,r,t){!r&&!alreadyWarned[e]&&(alreadyWarned[e]=!0,warning(!1,t))}reactExports.memo(DataRoutes);function DataRoutes({routes:e,future:r,state:t,unstable_onError:o}){return useRoutesImpl(e,void 0,t,o,r)}function Router({basename:e="/",children:r=null,location:t,navigationType:o="POP",navigator:c,static:u=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let y=e.replace(/^\/*/,"/"),f=reactExports.useMemo(()=>({basename:y,navigator:c,static:u,future:{}}),[y,c,u]);typeof t=="string"&&(t=parsePath(t));let{pathname:g="/",search:_="",hash:p="",state:S=null,key:A="default"}=t,R=reactExports.useMemo(()=>{let z=stripBasename(g,y);return z==null?null:{location:{pathname:z,search:_,hash:p,state:S,key:A},navigationType:o}},[y,g,_,p,S,A,o]);return warning(R!=null,`<Router basename="${y}"> is not able to match the URL "${g}${_}${p}" because it does not start with the basename, so the <Router> won't render anything.`),R==null?null:reactExports.createElement(NavigationContext.Provider,{value:f},reactExports.createElement(LocationContext.Provider,{children:r,value:R}))}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(e){return e!=null&&typeof e.tagName=="string"}function isButtonElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="button"}function isFormElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="form"}function isInputElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="input"}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,r){return e.button===0&&(!r||r==="_self")&&!isModifiedEvent(e)}function createSearchParams(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((r,t)=>{let o=e[t];return r.concat(Array.isArray(o)?o.map(c=>[t,c]):[[t,o]])},[]))}function getSearchParamsForLocation(e,r){let t=createSearchParams(e);return r&&r.forEach((o,c)=>{t.has(c)||r.getAll(c).forEach(u=>{t.append(c,u)})}),t}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(e){return e!=null&&!supportedFormEncTypes.has(e)?(warning(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):e}function getFormSubmissionInfo(e,r){let t,o,c,u,y;if(isFormElement(e)){let f=e.getAttribute("action");o=f?stripBasename(f,r):null,t=e.getAttribute("method")||defaultMethod,c=getFormEncType(e.getAttribute("enctype"))||defaultEncType,u=new FormData(e)}else if(isButtonElement(e)||isInputElement(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=e.getAttribute("formaction")||f.getAttribute("action");if(o=g?stripBasename(g,r):null,t=e.getAttribute("formmethod")||f.getAttribute("method")||defaultMethod,c=getFormEncType(e.getAttribute("formenctype"))||getFormEncType(f.getAttribute("enctype"))||defaultEncType,u=new FormData(f,e),!isFormDataSubmitterSupported()){let{name:_,type:p,value:S}=e;if(p==="image"){let A=_?`${_}.`:"";u.append(`${A}x`,"0"),u.append(`${A}y`,"0")}else _&&u.append(_,S)}}else{if(isHtmlElement(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=defaultMethod,o=null,c=defaultEncType,y=e}return u&&c==="text/plain"&&(y=u,u=void 0),{action:o,method:t.toLowerCase(),encType:c,formData:u,body:y}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function invariant2(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function singleFetchUrl(e,r,t){let o=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return o.pathname==="/"?o.pathname=`_root.${t}`:r&&stripBasename(o.pathname,r)==="/"?o.pathname=`${r.replace(/\/$/,"")}/_root.${t}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${t}`,o}async function loadRouteModule(e,r){if(e.id in r)return r[e.id];try{let t=await import(e.module);return r[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function getKeyedPrefetchLinks(e,r,t){let o=await Promise.all(e.map(async c=>{let u=r.routes[c.route.id];if(u){let y=await loadRouteModule(u,t);return y.links?y.links():[]}return[]}));return dedupeLinkDescriptors(o.flat(1).filter(isHtmlLinkDescriptor).filter(c=>c.rel==="stylesheet"||c.rel==="preload").map(c=>c.rel==="stylesheet"?{...c,rel:"prefetch",as:"style"}:{...c,rel:"prefetch"}))}function getNewMatchesForLinks(e,r,t,o,c,u){let y=(g,_)=>t[_]?g.route.id!==t[_].route.id:!0,f=(g,_)=>t[_].pathname!==g.pathname||t[_].route.path?.endsWith("*")&&t[_].params["*"]!==g.params["*"];return u==="assets"?r.filter((g,_)=>y(g,_)||f(g,_)):u==="data"?r.filter((g,_)=>{let p=o.routes[g.route.id];if(!p||!p.hasLoader)return!1;if(y(g,_)||f(g,_))return!0;if(g.route.shouldRevalidate){let S=g.route.shouldRevalidate({currentUrl:new URL(c.pathname+c.search+c.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof S=="boolean")return S}return!0}):[]}function getModuleLinkHrefs(e,r,{includeHydrateFallback:t}={}){return dedupeHrefs(e.map(o=>{let c=r.routes[o.route.id];if(!c)return[];let u=[c.module];return c.clientActionModule&&(u=u.concat(c.clientActionModule)),c.clientLoaderModule&&(u=u.concat(c.clientLoaderModule)),t&&c.hydrateFallbackModule&&(u=u.concat(c.hydrateFallbackModule)),c.imports&&(u=u.concat(c.imports)),u}).flat(1))}function dedupeHrefs(e){return[...new Set(e)]}function sortKeys(e){let r={},t=Object.keys(e).sort();for(let o of t)r[o]=e[o];return r}function dedupeLinkDescriptors(e,r){let t=new Set;return new Set(r),e.reduce((o,c)=>{let u=JSON.stringify(sortKeys(c));return t.has(u)||(t.add(u),o.push({key:u,link:c})),o},[])}function useDataRouterContext2(){let e=reactExports.useContext(DataRouterContext);return invariant2(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function useDataRouterStateContext(){let e=reactExports.useContext(DataRouterStateContext);return invariant2(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let e=reactExports.useContext(FrameworkContext);return invariant2(e,"You must render this element inside a <HydratedRouter> element"),e}function usePrefetchBehavior(e,r){let t=reactExports.useContext(FrameworkContext),[o,c]=reactExports.useState(!1),[u,y]=reactExports.useState(!1),{onFocus:f,onBlur:g,onMouseEnter:_,onMouseLeave:p,onTouchStart:S}=r,A=reactExports.useRef(null);reactExports.useEffect(()=>{if(e==="render"&&y(!0),e==="viewport"){let l=v=>{v.forEach(w=>{y(w.isIntersecting)})},s=new IntersectionObserver(l,{threshold:.5});return A.current&&s.observe(A.current),()=>{s.disconnect()}}},[e]),reactExports.useEffect(()=>{if(o){let l=setTimeout(()=>{y(!0)},100);return()=>{clearTimeout(l)}}},[o]);let R=()=>{c(!0)},z=()=>{c(!1),y(!1)};return t?e!=="intent"?[u,A,{}]:[u,A,{onFocus:composeEventHandlers(f,R),onBlur:composeEventHandlers(g,z),onMouseEnter:composeEventHandlers(_,R),onMouseLeave:composeEventHandlers(p,z),onTouchStart:composeEventHandlers(S,R)}]:[!1,A,{}]}function composeEventHandlers(e,r){return t=>{e&&e(t),t.defaultPrevented||r(t)}}function PrefetchPageLinks({page:e,...r}){let{router:t}=useDataRouterContext2(),o=reactExports.useMemo(()=>matchRoutes(t.routes,e,t.basename),[t.routes,e,t.basename]);return o?reactExports.createElement(PrefetchPageLinksImpl,{page:e,matches:o,...r}):null}function useKeyedPrefetchLinks(e){let{manifest:r,routeModules:t}=useFrameworkContext(),[o,c]=reactExports.useState([]);return reactExports.useEffect(()=>{let u=!1;return getKeyedPrefetchLinks(e,r,t).then(y=>{u||c(y)}),()=>{u=!0}},[e,r,t]),o}function PrefetchPageLinksImpl({page:e,matches:r,...t}){let o=useLocation(),{manifest:c,routeModules:u}=useFrameworkContext(),{basename:y}=useDataRouterContext2(),{loaderData:f,matches:g}=useDataRouterStateContext(),_=reactExports.useMemo(()=>getNewMatchesForLinks(e,r,g,c,o,"data"),[e,r,g,c,o]),p=reactExports.useMemo(()=>getNewMatchesForLinks(e,r,g,c,o,"assets"),[e,r,g,c,o]),S=reactExports.useMemo(()=>{if(e===o.pathname+o.search+o.hash)return[];let z=new Set,l=!1;if(r.forEach(v=>{let w=c.routes[v.route.id];!w||!w.hasLoader||(!_.some(E=>E.route.id===v.route.id)&&v.route.id in f&&u[v.route.id]?.shouldRevalidate||w.hasClientLoader?l=!0:z.add(v.route.id))}),z.size===0)return[];let s=singleFetchUrl(e,y,"data");return l&&z.size>0&&s.searchParams.set("_routes",r.filter(v=>z.has(v.route.id)).map(v=>v.route.id).join(",")),[s.pathname+s.search]},[y,f,o,c,_,r,e,u]),A=reactExports.useMemo(()=>getModuleLinkHrefs(p,c),[p,c]),R=useKeyedPrefetchLinks(p);return reactExports.createElement(reactExports.Fragment,null,S.map(z=>reactExports.createElement("link",{key:z,rel:"prefetch",as:"fetch",href:z,...t})),A.map(z=>reactExports.createElement("link",{key:z,rel:"modulepreload",href:z,...t})),R.map(({key:z,link:l})=>reactExports.createElement("link",{key:z,nonce:t.nonce,...l})))}function mergeRefs(...e){return r=>{e.forEach(t=>{typeof t=="function"?t(r):t!=null&&(t.current=r)})}}var isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser&&(window.__reactRouterVersion="7.8.2")}catch{}function BrowserRouter({basename:e,children:r,window:t}){let o=reactExports.useRef();o.current==null&&(o.current=createBrowserHistory({window:t,v5Compat:!0}));let c=o.current,[u,y]=reactExports.useState({action:c.action,location:c.location}),f=reactExports.useCallback(g=>{reactExports.startTransition(()=>y(g))},[y]);return reactExports.useLayoutEffect(()=>c.listen(f),[c,f]),reactExports.createElement(Router,{basename:e,children:r,location:u.location,navigationType:u.action,navigator:c})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:r,discover:t="render",prefetch:o="none",relative:c,reloadDocument:u,replace:y,state:f,target:g,to:_,preventScrollReset:p,viewTransition:S,...A},R){let{basename:z}=reactExports.useContext(NavigationContext),l=typeof _=="string"&&ABSOLUTE_URL_REGEX2.test(_),s,v=!1;if(typeof _=="string"&&l&&(s=_,isBrowser))try{let D=new URL(window.location.href),P=_.startsWith("//")?new URL(D.protocol+_):new URL(_),F=stripBasename(P.pathname,z);P.origin===D.origin&&F!=null?_=F+P.search+P.hash:v=!0}catch{warning(!1,`<Link to="${_}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=useHref(_,{relative:c}),[E,C,h]=usePrefetchBehavior(o,A),x=useLinkClickHandler(_,{replace:y,state:f,target:g,preventScrollReset:p,relative:c,viewTransition:S});function k(D){r&&r(D),D.defaultPrevented||x(D)}let M=reactExports.createElement("a",{...A,...h,href:s||w,onClick:v||u?r:k,ref:mergeRefs(R,C),target:g,"data-discover":!l&&t==="render"?"true":void 0});return E&&!l?reactExports.createElement(reactExports.Fragment,null,M,reactExports.createElement(PrefetchPageLinks,{page:w})):M});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":r="page",caseSensitive:t=!1,className:o="",end:c=!1,style:u,to:y,viewTransition:f,children:g,..._},p){let S=useResolvedPath(y,{relative:_.relative}),A=useLocation(),R=reactExports.useContext(DataRouterStateContext),{navigator:z,basename:l}=reactExports.useContext(NavigationContext),s=R!=null&&useViewTransitionState(S)&&f===!0,v=z.encodeLocation?z.encodeLocation(S).pathname:S.pathname,w=A.pathname,E=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;t||(w=w.toLowerCase(),E=E?E.toLowerCase():null,v=v.toLowerCase()),E&&l&&(E=stripBasename(E,l)||E);const C=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let h=w===v||!c&&w.startsWith(v)&&w.charAt(C)==="/",x=E!=null&&(E===v||!c&&E.startsWith(v)&&E.charAt(v.length)==="/"),k={isActive:h,isPending:x,isTransitioning:s},M=h?r:void 0,D;typeof o=="function"?D=o(k):D=[o,h?"active":null,x?"pending":null,s?"transitioning":null].filter(Boolean).join(" ");let P=typeof u=="function"?u(k):u;return reactExports.createElement(Link,{..._,"aria-current":M,className:D,ref:p,style:P,to:y,viewTransition:f},typeof g=="function"?g(k):g)});NavLink.displayName="NavLink";var Form$2=reactExports.forwardRef(({discover:e="render",fetcherKey:r,navigate:t,reloadDocument:o,replace:c,state:u,method:y=defaultMethod,action:f,onSubmit:g,relative:_,preventScrollReset:p,viewTransition:S,...A},R)=>{let z=useSubmit(),l=useFormAction(f,{relative:_}),s=y.toLowerCase()==="get"?"get":"post",v=typeof f=="string"&&ABSOLUTE_URL_REGEX2.test(f),w=E=>{if(g&&g(E),E.defaultPrevented)return;E.preventDefault();let C=E.nativeEvent.submitter,h=C?.getAttribute("formmethod")||y;z(C||E.currentTarget,{fetcherKey:r,method:h,navigate:t,replace:c,state:u,relative:_,preventScrollReset:p,viewTransition:S})};return reactExports.createElement("form",{ref:R,method:s,action:l,onSubmit:o?g:w,...A,"data-discover":!v&&e==="render"?"true":void 0})});Form$2.displayName="Form";function getDataRouterConsoleError2(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(e){let r=reactExports.useContext(DataRouterContext);return invariant(r,getDataRouterConsoleError2(e)),r}function useLinkClickHandler(e,{target:r,replace:t,state:o,preventScrollReset:c,relative:u,viewTransition:y}={}){let f=useNavigate(),g=useLocation(),_=useResolvedPath(e,{relative:u});return reactExports.useCallback(p=>{if(shouldProcessLinkClick(p,r)){p.preventDefault();let S=t!==void 0?t:createPath(g)===createPath(_);f(e,{replace:S,state:o,preventScrollReset:c,relative:u,viewTransition:y})}},[g,f,_,t,o,r,e,c,u,y])}function useSearchParams(e){warning(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let r=reactExports.useRef(createSearchParams(e)),t=reactExports.useRef(!1),o=useLocation(),c=reactExports.useMemo(()=>getSearchParamsForLocation(o.search,t.current?null:r.current),[o.search]),u=useNavigate(),y=reactExports.useCallback((f,g)=>{const _=createSearchParams(typeof f=="function"?f(new URLSearchParams(c)):f);t.current=!0,u("?"+_,g)},[u,c]);return[c,y]}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:e}=useDataRouterContext3("useSubmit"),{basename:r}=reactExports.useContext(NavigationContext),t=useRouteId();return reactExports.useCallback(async(o,c={})=>{let{action:u,method:y,encType:f,formData:g,body:_}=getFormSubmissionInfo(o,r);if(c.navigate===!1){let p=c.fetcherKey||getUniqueFetcherId();await e.fetch(p,t,c.action||u,{preventScrollReset:c.preventScrollReset,formData:g,body:_,formMethod:c.method||y,formEncType:c.encType||f,flushSync:c.flushSync})}else await e.navigate(c.action||u,{preventScrollReset:c.preventScrollReset,formData:g,body:_,formMethod:c.method||y,formEncType:c.encType||f,replace:c.replace,state:c.state,fromRouteId:t,flushSync:c.flushSync,viewTransition:c.viewTransition})},[e,r,t])}function useFormAction(e,{relative:r}={}){let{basename:t}=reactExports.useContext(NavigationContext),o=reactExports.useContext(RouteContext);invariant(o,"useFormAction must be used inside a RouteContext");let[c]=o.matches.slice(-1),u={...useResolvedPath(e||".",{relative:r})},y=useLocation();if(e==null){u.search=y.search;let f=new URLSearchParams(u.search),g=f.getAll("index");if(g.some(p=>p==="")){f.delete("index"),g.filter(S=>S).forEach(S=>f.append("index",S));let p=f.toString();u.search=p?`?${p}`:""}}return(!e||e===".")&&c.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:joinPaths([t,u.pathname])),createPath(u)}function useViewTransitionState(e,{relative:r}={}){let t=reactExports.useContext(ViewTransitionContext);invariant(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=useDataRouterContext3("useViewTransitionState"),c=useResolvedPath(e,{relative:r});if(!t.isTransitioning)return!1;let u=stripBasename(t.currentLocation.pathname,o)||t.currentLocation.pathname,y=stripBasename(t.nextLocation.pathname,o)||t.nextLocation.pathname;return matchPath(c.pathname,y)!=null||matchPath(c.pathname,u)!=null}var reactDomExports=requireReactDom();const ReactDOM=getDefaultExportFromCjs(reactDomExports);function cc(e){if(typeof e=="string"||typeof e=="number")return""+e;let r="";if(Array.isArray(e))for(let t=0,o;t<e.length;t++)(o=cc(e[t]))!==""&&(r+=(r&&" ")+o);else for(let t in e)e[t]&&(r+=(r&&" ")+t);return r}var withSelector={exports:{}},withSelector_production={},shim={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredUseSyncExternalStoreShim_production;function requireUseSyncExternalStoreShim_production(){if(hasRequiredUseSyncExternalStoreShim_production)return useSyncExternalStoreShim_production;hasRequiredUseSyncExternalStoreShim_production=1;var e=requireReact();function r(S,A){return S===A&&(S!==0||1/S===1/A)||S!==S&&A!==A}var t=typeof Object.is=="function"?Object.is:r,o=e.useState,c=e.useEffect,u=e.useLayoutEffect,y=e.useDebugValue;function f(S,A){var R=A(),z=o({inst:{value:R,getSnapshot:A}}),l=z[0].inst,s=z[1];return u(function(){l.value=R,l.getSnapshot=A,g(l)&&s({inst:l})},[S,R,A]),c(function(){return g(l)&&s({inst:l}),S(function(){g(l)&&s({inst:l})})},[S]),y(R),R}function g(S){var A=S.getSnapshot;S=S.value;try{var R=A();return!t(S,R)}catch{return!0}}function _(S,A){return A()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_:f;return useSyncExternalStoreShim_production.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:p,useSyncExternalStoreShim_production}var hasRequiredShim;function requireShim(){return hasRequiredShim||(hasRequiredShim=1,shim.exports=requireUseSyncExternalStoreShim_production()),shim.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredWithSelector_production;function requireWithSelector_production(){if(hasRequiredWithSelector_production)return withSelector_production;hasRequiredWithSelector_production=1;var e=requireReact(),r=requireShim();function t(_,p){return _===p&&(_!==0||1/_===1/p)||_!==_&&p!==p}var o=typeof Object.is=="function"?Object.is:t,c=r.useSyncExternalStore,u=e.useRef,y=e.useEffect,f=e.useMemo,g=e.useDebugValue;return withSelector_production.useSyncExternalStoreWithSelector=function(_,p,S,A,R){var z=u(null);if(z.current===null){var l={hasValue:!1,value:null};z.current=l}else l=z.current;z=f(function(){function v(x){if(!w){if(w=!0,E=x,x=A(x),R!==void 0&&l.hasValue){var k=l.value;if(R(k,x))return C=k}return C=x}if(k=C,o(E,x))return k;var M=A(x);return R!==void 0&&R(k,M)?(E=x,k):(E=x,C=M)}var w=!1,E,C,h=S===void 0?null:S;return[function(){return v(p())},h===null?void 0:function(){return v(h())}]},[p,S,A,R]);var s=c(_,z[0],z[1]);return y(function(){l.hasValue=!0,l.value=s},[s]),g(s),s},withSelector_production}var hasRequiredWithSelector;function requireWithSelector(){return hasRequiredWithSelector||(hasRequiredWithSelector=1,withSelector.exports=requireWithSelector_production()),withSelector.exports}var withSelectorExports=requireWithSelector();const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports),__vite_import_meta_env__={},createStoreImpl=e=>{let r;const t=new Set,o=(p,S)=>{const A=typeof p=="function"?p(r):p;if(!Object.is(A,r)){const R=r;r=S??(typeof A!="object"||A===null)?A:Object.assign({},r,A),t.forEach(z=>z(r,R))}},c=()=>r,g={setState:o,getState:c,getInitialState:()=>_,subscribe:p=>(t.add(p),()=>t.delete(p)),destroy:()=>{(__vite_import_meta_env__?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},_=r=e(o,c,g);return g},createStore=e=>e?createStoreImpl(e):createStoreImpl,{useDebugValue}=React,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports,identity$2=e=>e;function useStoreWithEqualityFn(e,r=identity$2,t){const o=useSyncExternalStoreWithSelector(e.subscribe,e.getState,e.getServerState||e.getInitialState,r,t);return useDebugValue(o),o}const createWithEqualityFnImpl=(e,r)=>{const t=createStore(e),o=(c,u=r)=>useStoreWithEqualityFn(t,c,u);return Object.assign(o,t),o},createWithEqualityFn=(e,r)=>e?createWithEqualityFnImpl(e,r):createWithEqualityFnImpl;function shallow$1(e,r){if(Object.is(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;if(e instanceof Map&&r instanceof Map){if(e.size!==r.size)return!1;for(const[o,c]of e)if(!Object.is(c,r.get(o)))return!1;return!0}if(e instanceof Set&&r instanceof Set){if(e.size!==r.size)return!1;for(const o of e)if(!r.has(o))return!1;return!0}const t=Object.keys(e);if(t.length!==Object.keys(r).length)return!1;for(const o of t)if(!Object.prototype.hasOwnProperty.call(r,o)||!Object.is(e[o],r[o]))return!1;return!0}var noop$1={value:()=>{}};function dispatch(){for(var e=0,r=arguments.length,t={},o;e<r;++e){if(!(o=arguments[e]+"")||o in t||/[\s.]/.test(o))throw new Error("illegal type: "+o);t[o]=[]}return new Dispatch(t)}function Dispatch(e){this._=e}function parseTypenames$1(e,r){return e.trim().split(/^|\s+/).map(function(t){var o="",c=t.indexOf(".");if(c>=0&&(o=t.slice(c+1),t=t.slice(0,c)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:o}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(e,r){var t=this._,o=parseTypenames$1(e+"",t),c,u=-1,y=o.length;if(arguments.length<2){for(;++u<y;)if((c=(e=o[u]).type)&&(c=get$1(t[c],e.name)))return c;return}if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++u<y;)if(c=(e=o[u]).type)t[c]=set$1(t[c],e.name,r);else if(r==null)for(c in t)t[c]=set$1(t[c],e.name,null);return this},copy:function(){var e={},r=this._;for(var t in r)e[t]=r[t].slice();return new Dispatch(e)},call:function(e,r){if((c=arguments.length-2)>0)for(var t=new Array(c),o=0,c,u;o<c;++o)t[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(u=this._[e],o=0,c=u.length;o<c;++o)u[o].value.apply(r,t)},apply:function(e,r,t){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],c=0,u=o.length;c<u;++c)o[c].value.apply(r,t)}};function get$1(e,r){for(var t=0,o=e.length,c;t<o;++t)if((c=e[t]).name===r)return c.value}function set$1(e,r,t){for(var o=0,c=e.length;o<c;++o)if(e[o].name===r){e[o]=noop$1,e=e.slice(0,o).concat(e.slice(o+1));break}return t!=null&&e.push({name:r,value:t}),e}var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(e){var r=e+="",t=r.indexOf(":");return t>=0&&(r=e.slice(0,t))!=="xmlns"&&(e=e.slice(t+1)),namespaces.hasOwnProperty(r)?{space:namespaces[r],local:e}:e}function creatorInherit(e){return function(){var r=this.ownerDocument,t=this.namespaceURI;return t===xhtml&&r.documentElement.namespaceURI===xhtml?r.createElement(e):r.createElementNS(t,e)}}function creatorFixed(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function creator(e){var r=namespace(e);return(r.local?creatorFixed:creatorInherit)(r)}function none(){}function selector$h(e){return e==null?none:function(){return this.querySelector(e)}}function selection_select(e){typeof e!="function"&&(e=selector$h(e));for(var r=this._groups,t=r.length,o=new Array(t),c=0;c<t;++c)for(var u=r[c],y=u.length,f=o[c]=new Array(y),g,_,p=0;p<y;++p)(g=u[p])&&(_=e.call(g,g.__data__,p,u))&&("__data__"in g&&(_.__data__=g.__data__),f[p]=_);return new Selection$1(o,this._parents)}function array(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function empty(){return[]}function selectorAll(e){return e==null?empty:function(){return this.querySelectorAll(e)}}function arrayAll(e){return function(){return array(e.apply(this,arguments))}}function selection_selectAll(e){typeof e=="function"?e=arrayAll(e):e=selectorAll(e);for(var r=this._groups,t=r.length,o=[],c=[],u=0;u<t;++u)for(var y=r[u],f=y.length,g,_=0;_<f;++_)(g=y[_])&&(o.push(e.call(g,g.__data__,_,y)),c.push(g));return new Selection$1(o,c)}function matcher(e){return function(){return this.matches(e)}}function childMatcher(e){return function(r){return r.matches(e)}}var find=Array.prototype.find;function childFind(e){return function(){return find.call(this.children,e)}}function childFirst(){return this.firstElementChild}function selection_selectChild(e){return this.select(e==null?childFirst:childFind(typeof e=="function"?e:childMatcher(e)))}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(e){return function(){return filter.call(this.children,e)}}function selection_selectChildren(e){return this.selectAll(e==null?children:childrenFilter(typeof e=="function"?e:childMatcher(e)))}function selection_filter(e){typeof e!="function"&&(e=matcher(e));for(var r=this._groups,t=r.length,o=new Array(t),c=0;c<t;++c)for(var u=r[c],y=u.length,f=o[c]=[],g,_=0;_<y;++_)(g=u[_])&&e.call(g,g.__data__,_,u)&&f.push(g);return new Selection$1(o,this._parents)}function sparse(e){return new Array(e.length)}function selection_enter(){return new Selection$1(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(e,r){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=r}EnterNode.prototype={constructor:EnterNode,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,r){return this._parent.insertBefore(e,r)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function constant$3(e){return function(){return e}}function bindIndex(e,r,t,o,c,u){for(var y=0,f,g=r.length,_=u.length;y<_;++y)(f=r[y])?(f.__data__=u[y],o[y]=f):t[y]=new EnterNode(e,u[y]);for(;y<g;++y)(f=r[y])&&(c[y]=f)}function bindKey(e,r,t,o,c,u,y){var f,g,_=new Map,p=r.length,S=u.length,A=new Array(p),R;for(f=0;f<p;++f)(g=r[f])&&(A[f]=R=y.call(g,g.__data__,f,r)+"",_.has(R)?c[f]=g:_.set(R,g));for(f=0;f<S;++f)R=y.call(e,u[f],f,u)+"",(g=_.get(R))?(o[f]=g,g.__data__=u[f],_.delete(R)):t[f]=new EnterNode(e,u[f]);for(f=0;f<p;++f)(g=r[f])&&_.get(A[f])===g&&(c[f]=g)}function datum(e){return e.__data__}function selection_data(e,r){if(!arguments.length)return Array.from(this,datum);var t=r?bindKey:bindIndex,o=this._parents,c=this._groups;typeof e!="function"&&(e=constant$3(e));for(var u=c.length,y=new Array(u),f=new Array(u),g=new Array(u),_=0;_<u;++_){var p=o[_],S=c[_],A=S.length,R=arraylike(e.call(p,p&&p.__data__,_,o)),z=R.length,l=f[_]=new Array(z),s=y[_]=new Array(z),v=g[_]=new Array(A);t(p,S,l,s,v,R,r);for(var w=0,E=0,C,h;w<z;++w)if(C=l[w]){for(w>=E&&(E=w+1);!(h=s[E])&&++E<z;);C._next=h||null}}return y=new Selection$1(y,o),y._enter=f,y._exit=g,y}function arraylike(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function selection_exit(){return new Selection$1(this._exit||this._groups.map(sparse),this._parents)}function selection_join(e,r,t){var o=this.enter(),c=this,u=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),r!=null&&(c=r(c),c&&(c=c.selection())),t==null?u.remove():t(u),o&&c?o.merge(c).order():c}function selection_merge(e){for(var r=e.selection?e.selection():e,t=this._groups,o=r._groups,c=t.length,u=o.length,y=Math.min(c,u),f=new Array(c),g=0;g<y;++g)for(var _=t[g],p=o[g],S=_.length,A=f[g]=new Array(S),R,z=0;z<S;++z)(R=_[z]||p[z])&&(A[z]=R);for(;g<c;++g)f[g]=t[g];return new Selection$1(f,this._parents)}function selection_order(){for(var e=this._groups,r=-1,t=e.length;++r<t;)for(var o=e[r],c=o.length-1,u=o[c],y;--c>=0;)(y=o[c])&&(u&&y.compareDocumentPosition(u)^4&&u.parentNode.insertBefore(y,u),u=y);return this}function selection_sort(e){e||(e=ascending);function r(S,A){return S&&A?e(S.__data__,A.__data__):!S-!A}for(var t=this._groups,o=t.length,c=new Array(o),u=0;u<o;++u){for(var y=t[u],f=y.length,g=c[u]=new Array(f),_,p=0;p<f;++p)(_=y[p])&&(g[p]=_);g.sort(r)}return new Selection$1(c,this._parents).order()}function ascending(e,r){return e<r?-1:e>r?1:e>=r?0:NaN}function selection_call(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var e=this._groups,r=0,t=e.length;r<t;++r)for(var o=e[r],c=0,u=o.length;c<u;++c){var y=o[c];if(y)return y}return null}function selection_size(){let e=0;for(const r of this)++e;return e}function selection_empty(){return!this.node()}function selection_each(e){for(var r=this._groups,t=0,o=r.length;t<o;++t)for(var c=r[t],u=0,y=c.length,f;u<y;++u)(f=c[u])&&e.call(f,f.__data__,u,c);return this}function attrRemove$1(e){return function(){this.removeAttribute(e)}}function attrRemoveNS$1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant$1(e,r){return function(){this.setAttribute(e,r)}}function attrConstantNS$1(e,r){return function(){this.setAttributeNS(e.space,e.local,r)}}function attrFunction$1(e,r){return function(){var t=r.apply(this,arguments);t==null?this.removeAttribute(e):this.setAttribute(e,t)}}function attrFunctionNS$1(e,r){return function(){var t=r.apply(this,arguments);t==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}function selection_attr(e,r){var t=namespace(e);if(arguments.length<2){var o=this.node();return t.local?o.getAttributeNS(t.space,t.local):o.getAttribute(t)}return this.each((r==null?t.local?attrRemoveNS$1:attrRemove$1:typeof r=="function"?t.local?attrFunctionNS$1:attrFunction$1:t.local?attrConstantNS$1:attrConstant$1)(t,r))}function defaultView(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function styleRemove$1(e){return function(){this.style.removeProperty(e)}}function styleConstant$1(e,r,t){return function(){this.style.setProperty(e,r,t)}}function styleFunction$1(e,r,t){return function(){var o=r.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,t)}}function selection_style(e,r,t){return arguments.length>1?this.each((r==null?styleRemove$1:typeof r=="function"?styleFunction$1:styleConstant$1)(e,r,t??"")):styleValue(this.node(),e)}function styleValue(e,r){return e.style.getPropertyValue(r)||defaultView(e).getComputedStyle(e,null).getPropertyValue(r)}function propertyRemove(e){return function(){delete this[e]}}function propertyConstant(e,r){return function(){this[e]=r}}function propertyFunction(e,r){return function(){var t=r.apply(this,arguments);t==null?delete this[e]:this[e]=t}}function selection_property(e,r){return arguments.length>1?this.each((r==null?propertyRemove:typeof r=="function"?propertyFunction:propertyConstant)(e,r)):this.node()[e]}function classArray(e){return e.trim().split(/^|\s+/)}function classList(e){return e.classList||new ClassList(e)}function ClassList(e){this._node=e,this._names=classArray(e.getAttribute("class")||"")}ClassList.prototype={add:function(e){var r=this._names.indexOf(e);r<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var r=this._names.indexOf(e);r>=0&&(this._names.splice(r,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function classedAdd(e,r){for(var t=classList(e),o=-1,c=r.length;++o<c;)t.add(r[o])}function classedRemove(e,r){for(var t=classList(e),o=-1,c=r.length;++o<c;)t.remove(r[o])}function classedTrue(e){return function(){classedAdd(this,e)}}function classedFalse(e){return function(){classedRemove(this,e)}}function classedFunction(e,r){return function(){(r.apply(this,arguments)?classedAdd:classedRemove)(this,e)}}function selection_classed(e,r){var t=classArray(e+"");if(arguments.length<2){for(var o=classList(this.node()),c=-1,u=t.length;++c<u;)if(!o.contains(t[c]))return!1;return!0}return this.each((typeof r=="function"?classedFunction:r?classedTrue:classedFalse)(t,r))}function textRemove(){this.textContent=""}function textConstant$1(e){return function(){this.textContent=e}}function textFunction$1(e){return function(){var r=e.apply(this,arguments);this.textContent=r??""}}function selection_text(e){return arguments.length?this.each(e==null?textRemove:(typeof e=="function"?textFunction$1:textConstant$1)(e)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(e){return function(){this.innerHTML=e}}function htmlFunction(e){return function(){var r=e.apply(this,arguments);this.innerHTML=r??""}}function selection_html(e){return arguments.length?this.each(e==null?htmlRemove:(typeof e=="function"?htmlFunction:htmlConstant)(e)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(e){var r=typeof e=="function"?e:creator(e);return this.select(function(){return this.appendChild(r.apply(this,arguments))})}function constantNull(){return null}function selection_insert(e,r){var t=typeof e=="function"?e:creator(e),o=r==null?constantNull:typeof r=="function"?r:selector$h(r);return this.select(function(){return this.insertBefore(t.apply(this,arguments),o.apply(this,arguments)||null)})}function remove(){var e=this.parentNode;e&&e.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var e=this.cloneNode(!1),r=this.parentNode;return r?r.insertBefore(e,this.nextSibling):e}function selection_cloneDeep(){var e=this.cloneNode(!0),r=this.parentNode;return r?r.insertBefore(e,this.nextSibling):e}function selection_clone(e){return this.select(e?selection_cloneDeep:selection_cloneShallow)}function selection_datum(e){return arguments.length?this.property("__data__",e):this.node().__data__}function contextListener(e){return function(r){e.call(this,r,this.__data__)}}function parseTypenames(e){return e.trim().split(/^|\s+/).map(function(r){var t="",o=r.indexOf(".");return o>=0&&(t=r.slice(o+1),r=r.slice(0,o)),{type:r,name:t}})}function onRemove(e){return function(){var r=this.__on;if(r){for(var t=0,o=-1,c=r.length,u;t<c;++t)u=r[t],(!e.type||u.type===e.type)&&u.name===e.name?this.removeEventListener(u.type,u.listener,u.options):r[++o]=u;++o?r.length=o:delete this.__on}}}function onAdd(e,r,t){return function(){var o=this.__on,c,u=contextListener(r);if(o){for(var y=0,f=o.length;y<f;++y)if((c=o[y]).type===e.type&&c.name===e.name){this.removeEventListener(c.type,c.listener,c.options),this.addEventListener(c.type,c.listener=u,c.options=t),c.value=r;return}}this.addEventListener(e.type,u,t),c={type:e.type,name:e.name,value:r,listener:u,options:t},o?o.push(c):this.__on=[c]}}function selection_on(e,r,t){var o=parseTypenames(e+""),c,u=o.length,y;if(arguments.length<2){var f=this.node().__on;if(f){for(var g=0,_=f.length,p;g<_;++g)for(c=0,p=f[g];c<u;++c)if((y=o[c]).type===p.type&&y.name===p.name)return p.value}return}for(f=r?onAdd:onRemove,c=0;c<u;++c)this.each(f(o[c],r,t));return this}function dispatchEvent(e,r,t){var o=defaultView(e),c=o.CustomEvent;typeof c=="function"?c=new c(r,t):(c=o.document.createEvent("Event"),t?(c.initEvent(r,t.bubbles,t.cancelable),c.detail=t.detail):c.initEvent(r,!1,!1)),e.dispatchEvent(c)}function dispatchConstant(e,r){return function(){return dispatchEvent(this,e,r)}}function dispatchFunction(e,r){return function(){return dispatchEvent(this,e,r.apply(this,arguments))}}function selection_dispatch(e,r){return this.each((typeof r=="function"?dispatchFunction:dispatchConstant)(e,r))}function*selection_iterator(){for(var e=this._groups,r=0,t=e.length;r<t;++r)for(var o=e[r],c=0,u=o.length,y;c<u;++c)(y=o[c])&&(yield y)}var root=[null];function Selection$1(e,r){this._groups=e,this._parents=r}function selection(){return new Selection$1([[document.documentElement]],root)}function selection_selection(){return this}Selection$1.prototype=selection.prototype={constructor:Selection$1,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};function select(e){return typeof e=="string"?new Selection$1([[document.querySelector(e)]],[document.documentElement]):new Selection$1([[e]],root)}function sourceEvent(e){let r;for(;r=e.sourceEvent;)e=r;return e}function pointer(e,r){if(e=sourceEvent(e),r===void 0&&(r=e.currentTarget),r){var t=r.ownerSVGElement||r;if(t.createSVGPoint){var o=t.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(r.getScreenCTM().inverse()),[o.x,o.y]}if(r.getBoundingClientRect){var c=r.getBoundingClientRect();return[e.clientX-c.left-r.clientLeft,e.clientY-c.top-r.clientTop]}}return[e.pageX,e.pageY]}const nonpassive={passive:!1},nonpassivecapture={capture:!0,passive:!1};function nopropagation$1(e){e.stopImmediatePropagation()}function noevent$1(e){e.preventDefault(),e.stopImmediatePropagation()}function dragDisable(e){var r=e.document.documentElement,t=select(e).on("dragstart.drag",noevent$1,nonpassivecapture);"onselectstart"in r?t.on("selectstart.drag",noevent$1,nonpassivecapture):(r.__noselect=r.style.MozUserSelect,r.style.MozUserSelect="none")}function yesdrag(e,r){var t=e.document.documentElement,o=select(e).on("dragstart.drag",null);r&&(o.on("click.drag",noevent$1,nonpassivecapture),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in t?o.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const constant$2=e=>()=>e;function DragEvent(e,{sourceEvent:r,subject:t,target:o,identifier:c,active:u,x:y,y:f,dx:g,dy:_,dispatch:p}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:r,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:c,enumerable:!0,configurable:!0},active:{value:u,enumerable:!0,configurable:!0},x:{value:y,enumerable:!0,configurable:!0},y:{value:f,enumerable:!0,configurable:!0},dx:{value:g,enumerable:!0,configurable:!0},dy:{value:_,enumerable:!0,configurable:!0},_:{value:p}})}DragEvent.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function defaultFilter$1(e){return!e.ctrlKey&&!e.button}function defaultContainer(){return this.parentNode}function defaultSubject(e,r){return r??{x:e.x,y:e.y}}function defaultTouchable$1(){return navigator.maxTouchPoints||"ontouchstart"in this}function drag(){var e=defaultFilter$1,r=defaultContainer,t=defaultSubject,o=defaultTouchable$1,c={},u=dispatch("start","drag","end"),y=0,f,g,_,p,S=0;function A(C){C.on("mousedown.drag",R).filter(o).on("touchstart.drag",s).on("touchmove.drag",v,nonpassive).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function R(C,h){if(!(p||!e.call(this,C,h))){var x=E(this,r.call(this,C,h),C,h,"mouse");x&&(select(C.view).on("mousemove.drag",z,nonpassivecapture).on("mouseup.drag",l,nonpassivecapture),dragDisable(C.view),nopropagation$1(C),_=!1,f=C.clientX,g=C.clientY,x("start",C))}}function z(C){if(noevent$1(C),!_){var h=C.clientX-f,x=C.clientY-g;_=h*h+x*x>S}c.mouse("drag",C)}function l(C){select(C.view).on("mousemove.drag mouseup.drag",null),yesdrag(C.view,_),noevent$1(C),c.mouse("end",C)}function s(C,h){if(e.call(this,C,h)){var x=C.changedTouches,k=r.call(this,C,h),M=x.length,D,P;for(D=0;D<M;++D)(P=E(this,k,C,h,x[D].identifier,x[D]))&&(nopropagation$1(C),P("start",C,x[D]))}}function v(C){var h=C.changedTouches,x=h.length,k,M;for(k=0;k<x;++k)(M=c[h[k].identifier])&&(noevent$1(C),M("drag",C,h[k]))}function w(C){var h=C.changedTouches,x=h.length,k,M;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),k=0;k<x;++k)(M=c[h[k].identifier])&&(nopropagation$1(C),M("end",C,h[k]))}function E(C,h,x,k,M,D){var P=u.copy(),F=pointer(D||x,h),X,B,L;if((L=t.call(C,new DragEvent("beforestart",{sourceEvent:x,target:A,identifier:M,active:y,x:F[0],y:F[1],dx:0,dy:0,dispatch:P}),k))!=null)return X=L.x-F[0]||0,B=L.y-F[1]||0,function H(U,Y,W){var q=F,G;switch(U){case"start":c[M]=H,G=y++;break;case"end":delete c[M],--y;case"drag":F=pointer(W||Y,h),G=y;break}P.call(U,C,new DragEvent(U,{sourceEvent:Y,subject:L,target:A,identifier:M,active:G,x:F[0]+X,y:F[1]+B,dx:F[0]-q[0],dy:F[1]-q[1],dispatch:P}),k)}}return A.filter=function(C){return arguments.length?(e=typeof C=="function"?C:constant$2(!!C),A):e},A.container=function(C){return arguments.length?(r=typeof C=="function"?C:constant$2(C),A):r},A.subject=function(C){return arguments.length?(t=typeof C=="function"?C:constant$2(C),A):t},A.touchable=function(C){return arguments.length?(o=typeof C=="function"?C:constant$2(!!C),A):o},A.on=function(){var C=u.on.apply(u,arguments);return C===u?A:C},A.clickDistance=function(C){return arguments.length?(S=(C=+C)*C,A):Math.sqrt(S)},A}function define(e,r,t){e.prototype=r.prototype=t,t.constructor=e}function extend(e,r){var t=Object.create(e.prototype);for(var o in r)t[o]=r[o];return t}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(e){var r,t;return e=(e+"").trim().toLowerCase(),(r=reHex.exec(e))?(t=r[1].length,r=parseInt(r[1],16),t===6?rgbn(r):t===3?new Rgb(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):t===8?rgba(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):t===4?rgba(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=reRgbInteger.exec(e))?new Rgb(r[1],r[2],r[3],1):(r=reRgbPercent.exec(e))?new Rgb(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=reRgbaInteger.exec(e))?rgba(r[1],r[2],r[3],r[4]):(r=reRgbaPercent.exec(e))?rgba(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=reHslPercent.exec(e))?hsla(r[1],r[2]/100,r[3]/100,1):(r=reHslaPercent.exec(e))?hsla(r[1],r[2]/100,r[3]/100,r[4]):named.hasOwnProperty(e)?rgbn(named[e]):e==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,e&255,1)}function rgba(e,r,t,o){return o<=0&&(e=r=t=NaN),new Rgb(e,r,t,o)}function rgbConvert(e){return e instanceof Color||(e=color(e)),e?(e=e.rgb(),new Rgb(e.r,e.g,e.b,e.opacity)):new Rgb}function rgb(e,r,t,o){return arguments.length===1?rgbConvert(e):new Rgb(e,r,t,o??1)}function Rgb(e,r,t,o){this.r=+e,this.g=+r,this.b=+t,this.opacity=+o}define(Rgb,rgb,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const e=clampa(this.opacity);return`${e===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${e===1?")":`, ${e})`}`}function clampa(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function clampi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hex(e){return e=clampi(e),(e<16?"0":"")+e.toString(16)}function hsla(e,r,t,o){return o<=0?e=r=t=NaN:t<=0||t>=1?e=r=NaN:r<=0&&(e=NaN),new Hsl(e,r,t,o)}function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color||(e=color(e)),!e)return new Hsl;if(e instanceof Hsl)return e;e=e.rgb();var r=e.r/255,t=e.g/255,o=e.b/255,c=Math.min(r,t,o),u=Math.max(r,t,o),y=NaN,f=u-c,g=(u+c)/2;return f?(r===u?y=(t-o)/f+(t<o)*6:t===u?y=(o-r)/f+2:y=(r-t)/f+4,f/=g<.5?u+c:2-u-c,y*=60):f=g>0&&g<1?0:y,new Hsl(y,f,g,e.opacity)}function hsl(e,r,t,o){return arguments.length===1?hslConvert(e):new Hsl(e,r,t,o??1)}function Hsl(e,r,t,o){this.h=+e,this.s=+r,this.l=+t,this.opacity=+o}define(Hsl,hsl,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,o=t+(t<.5?t:1-t)*r,c=2*t-o;return new Rgb(hsl2rgb(e>=240?e-240:e+120,c,o),hsl2rgb(e,c,o),hsl2rgb(e<120?e+240:e-120,c,o),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=clampa(this.opacity);return`${e===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function clamph(e){return e=(e||0)%360,e<0?e+360:e}function clampt(e){return Math.max(0,Math.min(1,e||0))}function hsl2rgb(e,r,t){return(e<60?r+(t-r)*e/60:e<180?t:e<240?r+(t-r)*(240-e)/60:r)*255}const constant$1=e=>()=>e;function linear(e,r){return function(t){return e+t*r}}function exponential(e,r,t){return e=Math.pow(e,t),r=Math.pow(r,t)-e,t=1/t,function(o){return Math.pow(e+o*r,t)}}function gamma(e){return(e=+e)==1?nogamma:function(r,t){return t-r?exponential(r,t,e):constant$1(isNaN(r)?t:r)}}function nogamma(e,r){var t=r-e;return t?linear(e,t):constant$1(isNaN(e)?r:e)}const interpolateRgb=(function e(r){var t=gamma(r);function o(c,u){var y=t((c=rgb(c)).r,(u=rgb(u)).r),f=t(c.g,u.g),g=t(c.b,u.b),_=nogamma(c.opacity,u.opacity);return function(p){return c.r=y(p),c.g=f(p),c.b=g(p),c.opacity=_(p),c+""}}return o.gamma=e,o})(1);function interpolateNumber(e,r){return e=+e,r=+r,function(t){return e*(1-t)+r*t}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(e){return function(){return e}}function one(e){return function(r){return e(r)+""}}function interpolateString(e,r){var t=reA.lastIndex=reB.lastIndex=0,o,c,u,y=-1,f=[],g=[];for(e=e+"",r=r+"";(o=reA.exec(e))&&(c=reB.exec(r));)(u=c.index)>t&&(u=r.slice(t,u),f[y]?f[y]+=u:f[++y]=u),(o=o[0])===(c=c[0])?f[y]?f[y]+=c:f[++y]=c:(f[++y]=null,g.push({i:y,x:interpolateNumber(o,c)})),t=reB.lastIndex;return t<r.length&&(u=r.slice(t),f[y]?f[y]+=u:f[++y]=u),f.length<2?g[0]?one(g[0].x):zero(r):(r=g.length,function(_){for(var p=0,S;p<r;++p)f[(S=g[p]).i]=S.x(_);return f.join("")})}var degrees=180/Math.PI,identity$1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(e,r,t,o,c,u){var y,f,g;return(y=Math.sqrt(e*e+r*r))&&(e/=y,r/=y),(g=e*t+r*o)&&(t-=e*g,o-=r*g),(f=Math.sqrt(t*t+o*o))&&(t/=f,o/=f,g/=f),e*o<r*t&&(e=-e,r=-r,g=-g,y=-y),{translateX:c,translateY:u,rotate:Math.atan2(r,e)*degrees,skewX:Math.atan(g)*degrees,scaleX:y,scaleY:f}}var svgNode;function parseCss(e){const r=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return r.isIdentity?identity$1:decompose(r.a,r.b,r.c,r.d,r.e,r.f)}function parseSvg(e){return e==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",e),!(e=svgNode.transform.baseVal.consolidate()))?identity$1:(e=e.matrix,decompose(e.a,e.b,e.c,e.d,e.e,e.f))}function interpolateTransform(e,r,t,o){function c(_){return _.length?_.pop()+" ":""}function u(_,p,S,A,R,z){if(_!==S||p!==A){var l=R.push("translate(",null,r,null,t);z.push({i:l-4,x:interpolateNumber(_,S)},{i:l-2,x:interpolateNumber(p,A)})}else(S||A)&&R.push("translate("+S+r+A+t)}function y(_,p,S,A){_!==p?(_-p>180?p+=360:p-_>180&&(_+=360),A.push({i:S.push(c(S)+"rotate(",null,o)-2,x:interpolateNumber(_,p)})):p&&S.push(c(S)+"rotate("+p+o)}function f(_,p,S,A){_!==p?A.push({i:S.push(c(S)+"skewX(",null,o)-2,x:interpolateNumber(_,p)}):p&&S.push(c(S)+"skewX("+p+o)}function g(_,p,S,A,R,z){if(_!==S||p!==A){var l=R.push(c(R)+"scale(",null,",",null,")");z.push({i:l-4,x:interpolateNumber(_,S)},{i:l-2,x:interpolateNumber(p,A)})}else(S!==1||A!==1)&&R.push(c(R)+"scale("+S+","+A+")")}return function(_,p){var S=[],A=[];return _=e(_),p=e(p),u(_.translateX,_.translateY,p.translateX,p.translateY,S,A),y(_.rotate,p.rotate,S,A),f(_.skewX,p.skewX,S,A),g(_.scaleX,_.scaleY,p.scaleX,p.scaleY,S,A),_=p=null,function(R){for(var z=-1,l=A.length,s;++z<l;)S[(s=A[z]).i]=s.x(R);return S.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),epsilon2=1e-12;function cosh(e){return((e=Math.exp(e))+1/e)/2}function sinh(e){return((e=Math.exp(e))-1/e)/2}function tanh(e){return((e=Math.exp(2*e))-1)/(e+1)}const interpolateZoom=(function e(r,t,o){function c(u,y){var f=u[0],g=u[1],_=u[2],p=y[0],S=y[1],A=y[2],R=p-f,z=S-g,l=R*R+z*z,s,v;if(l<epsilon2)v=Math.log(A/_)/r,s=function(k){return[f+k*R,g+k*z,_*Math.exp(r*k*v)]};else{var w=Math.sqrt(l),E=(A*A-_*_+o*l)/(2*_*t*w),C=(A*A-_*_-o*l)/(2*A*t*w),h=Math.log(Math.sqrt(E*E+1)-E),x=Math.log(Math.sqrt(C*C+1)-C);v=(x-h)/r,s=function(k){var M=k*v,D=cosh(h),P=_/(t*w)*(D*tanh(r*M+h)-sinh(h));return[f+P*R,g+P*z,_*D/cosh(r*M+h)]}}return s.duration=v*1e3*r/Math.SQRT2,s}return c.rho=function(u){var y=Math.max(.001,+u),f=y*y,g=f*f;return e(y,f,g)},c})(Math.SQRT2,2,4);var frame=0,timeout$1=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(e,r,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?now():+t)+(r==null?0:+r),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=e,this._time=t,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(e,r,t){var o=new Timer;return o.restart(e,r,t),o}function timerFlush(){now(),++frame;for(var e=taskHead,r;e;)(r=clockNow-e._time)>=0&&e._call.call(void 0,r),e=e._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var e=clock.now(),r=e-clockLast;r>pokeDelay&&(clockSkew-=r,clockLast=e)}function nap(){for(var e,r=taskHead,t,o=1/0;r;)r._call?(o>r._time&&(o=r._time),e=r,r=r._next):(t=r._next,r._next=null,r=e?e._next=t:taskHead=t);taskTail=e,sleep(o)}function sleep(e){if(!frame){timeout$1&&(timeout$1=clearTimeout(timeout$1));var r=e-clockNow;r>24?(e<1/0&&(timeout$1=setTimeout(wake,e-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout(e,r,t){var o=new Timer;return r=r==null?0:+r,o.restart(c=>{o.stop(),e(c+r)},r,t),o}var emptyOn=dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(e,r,t,o,c,u){var y=e.__transition;if(!y)e.__transition={};else if(t in y)return;create(e,t,{name:r,index:o,group:c,on:emptyOn,tween:emptyTween,time:u.time,delay:u.delay,duration:u.duration,ease:u.ease,timer:null,state:CREATED})}function init(e,r){var t=get(e,r);if(t.state>CREATED)throw new Error("too late; already scheduled");return t}function set(e,r){var t=get(e,r);if(t.state>STARTED)throw new Error("too late; already running");return t}function get(e,r){var t=e.__transition;if(!t||!(t=t[r]))throw new Error("transition not found");return t}function create(e,r,t){var o=e.__transition,c;o[r]=t,t.timer=timer(u,0,t.time);function u(_){t.state=SCHEDULED,t.timer.restart(y,t.delay,t.time),t.delay<=_&&y(_-t.delay)}function y(_){var p,S,A,R;if(t.state!==SCHEDULED)return g();for(p in o)if(R=o[p],R.name===t.name){if(R.state===STARTED)return timeout(y);R.state===RUNNING?(R.state=ENDED,R.timer.stop(),R.on.call("interrupt",e,e.__data__,R.index,R.group),delete o[p]):+p<r&&(R.state=ENDED,R.timer.stop(),R.on.call("cancel",e,e.__data__,R.index,R.group),delete o[p])}if(timeout(function(){t.state===STARTED&&(t.state=RUNNING,t.timer.restart(f,t.delay,t.time),f(_))}),t.state=STARTING,t.on.call("start",e,e.__data__,t.index,t.group),t.state===STARTING){for(t.state=STARTED,c=new Array(A=t.tween.length),p=0,S=-1;p<A;++p)(R=t.tween[p].value.call(e,e.__data__,t.index,t.group))&&(c[++S]=R);c.length=S+1}}function f(_){for(var p=_<t.duration?t.ease.call(null,_/t.duration):(t.timer.restart(g),t.state=ENDING,1),S=-1,A=c.length;++S<A;)c[S].call(e,p);t.state===ENDING&&(t.on.call("end",e,e.__data__,t.index,t.group),g())}function g(){t.state=ENDED,t.timer.stop(),delete o[r];for(var _ in o)return;delete e.__transition}}function interrupt(e,r){var t=e.__transition,o,c,u=!0,y;if(t){r=r==null?null:r+"";for(y in t){if((o=t[y]).name!==r){u=!1;continue}c=o.state>STARTING&&o.state<ENDING,o.state=ENDED,o.timer.stop(),o.on.call(c?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete t[y]}u&&delete e.__transition}}function selection_interrupt(e){return this.each(function(){interrupt(this,e)})}function tweenRemove(e,r){var t,o;return function(){var c=set(this,e),u=c.tween;if(u!==t){o=t=u;for(var y=0,f=o.length;y<f;++y)if(o[y].name===r){o=o.slice(),o.splice(y,1);break}}c.tween=o}}function tweenFunction(e,r,t){var o,c;if(typeof t!="function")throw new Error;return function(){var u=set(this,e),y=u.tween;if(y!==o){c=(o=y).slice();for(var f={name:r,value:t},g=0,_=c.length;g<_;++g)if(c[g].name===r){c[g]=f;break}g===_&&c.push(f)}u.tween=c}}function transition_tween(e,r){var t=this._id;if(e+="",arguments.length<2){for(var o=get(this.node(),t).tween,c=0,u=o.length,y;c<u;++c)if((y=o[c]).name===e)return y.value;return null}return this.each((r==null?tweenRemove:tweenFunction)(t,e,r))}function tweenValue(e,r,t){var o=e._id;return e.each(function(){var c=set(this,o);(c.value||(c.value={}))[r]=t.apply(this,arguments)}),function(c){return get(c,o).value[r]}}function interpolate(e,r){var t;return(typeof r=="number"?interpolateNumber:r instanceof color?interpolateRgb:(t=color(r))?(r=t,interpolateRgb):interpolateString)(e,r)}function attrRemove(e){return function(){this.removeAttribute(e)}}function attrRemoveNS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant(e,r,t){var o,c=t+"",u;return function(){var y=this.getAttribute(e);return y===c?null:y===o?u:u=r(o=y,t)}}function attrConstantNS(e,r,t){var o,c=t+"",u;return function(){var y=this.getAttributeNS(e.space,e.local);return y===c?null:y===o?u:u=r(o=y,t)}}function attrFunction(e,r,t){var o,c,u;return function(){var y,f=t(this),g;return f==null?void this.removeAttribute(e):(y=this.getAttribute(e),g=f+"",y===g?null:y===o&&g===c?u:(c=g,u=r(o=y,f)))}}function attrFunctionNS(e,r,t){var o,c,u;return function(){var y,f=t(this),g;return f==null?void this.removeAttributeNS(e.space,e.local):(y=this.getAttributeNS(e.space,e.local),g=f+"",y===g?null:y===o&&g===c?u:(c=g,u=r(o=y,f)))}}function transition_attr(e,r){var t=namespace(e),o=t==="transform"?interpolateTransformSvg:interpolate;return this.attrTween(e,typeof r=="function"?(t.local?attrFunctionNS:attrFunction)(t,o,tweenValue(this,"attr."+e,r)):r==null?(t.local?attrRemoveNS:attrRemove)(t):(t.local?attrConstantNS:attrConstant)(t,o,r))}function attrInterpolate(e,r){return function(t){this.setAttribute(e,r.call(this,t))}}function attrInterpolateNS(e,r){return function(t){this.setAttributeNS(e.space,e.local,r.call(this,t))}}function attrTweenNS(e,r){var t,o;function c(){var u=r.apply(this,arguments);return u!==o&&(t=(o=u)&&attrInterpolateNS(e,u)),t}return c._value=r,c}function attrTween(e,r){var t,o;function c(){var u=r.apply(this,arguments);return u!==o&&(t=(o=u)&&attrInterpolate(e,u)),t}return c._value=r,c}function transition_attrTween(e,r){var t="attr."+e;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(r==null)return this.tween(t,null);if(typeof r!="function")throw new Error;var o=namespace(e);return this.tween(t,(o.local?attrTweenNS:attrTween)(o,r))}function delayFunction(e,r){return function(){init(this,e).delay=+r.apply(this,arguments)}}function delayConstant(e,r){return r=+r,function(){init(this,e).delay=r}}function transition_delay(e){var r=this._id;return arguments.length?this.each((typeof e=="function"?delayFunction:delayConstant)(r,e)):get(this.node(),r).delay}function durationFunction(e,r){return function(){set(this,e).duration=+r.apply(this,arguments)}}function durationConstant(e,r){return r=+r,function(){set(this,e).duration=r}}function transition_duration(e){var r=this._id;return arguments.length?this.each((typeof e=="function"?durationFunction:durationConstant)(r,e)):get(this.node(),r).duration}function easeConstant(e,r){if(typeof r!="function")throw new Error;return function(){set(this,e).ease=r}}function transition_ease(e){var r=this._id;return arguments.length?this.each(easeConstant(r,e)):get(this.node(),r).ease}function easeVarying(e,r){return function(){var t=r.apply(this,arguments);if(typeof t!="function")throw new Error;set(this,e).ease=t}}function transition_easeVarying(e){if(typeof e!="function")throw new Error;return this.each(easeVarying(this._id,e))}function transition_filter(e){typeof e!="function"&&(e=matcher(e));for(var r=this._groups,t=r.length,o=new Array(t),c=0;c<t;++c)for(var u=r[c],y=u.length,f=o[c]=[],g,_=0;_<y;++_)(g=u[_])&&e.call(g,g.__data__,_,u)&&f.push(g);return new Transition(o,this._parents,this._name,this._id)}function transition_merge(e){if(e._id!==this._id)throw new Error;for(var r=this._groups,t=e._groups,o=r.length,c=t.length,u=Math.min(o,c),y=new Array(o),f=0;f<u;++f)for(var g=r[f],_=t[f],p=g.length,S=y[f]=new Array(p),A,R=0;R<p;++R)(A=g[R]||_[R])&&(S[R]=A);for(;f<o;++f)y[f]=r[f];return new Transition(y,this._parents,this._name,this._id)}function start(e){return(e+"").trim().split(/^|\s+/).every(function(r){var t=r.indexOf(".");return t>=0&&(r=r.slice(0,t)),!r||r==="start"})}function onFunction(e,r,t){var o,c,u=start(r)?init:set;return function(){var y=u(this,e),f=y.on;f!==o&&(c=(o=f).copy()).on(r,t),y.on=c}}function transition_on(e,r){var t=this._id;return arguments.length<2?get(this.node(),t).on.on(e):this.each(onFunction(t,e,r))}function removeFunction(e){return function(){var r=this.parentNode;for(var t in this.__transition)if(+t!==e)return;r&&r.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(e){var r=this._name,t=this._id;typeof e!="function"&&(e=selector$h(e));for(var o=this._groups,c=o.length,u=new Array(c),y=0;y<c;++y)for(var f=o[y],g=f.length,_=u[y]=new Array(g),p,S,A=0;A<g;++A)(p=f[A])&&(S=e.call(p,p.__data__,A,f))&&("__data__"in p&&(S.__data__=p.__data__),_[A]=S,schedule(_[A],r,t,A,_,get(p,t)));return new Transition(u,this._parents,r,t)}function transition_selectAll(e){var r=this._name,t=this._id;typeof e!="function"&&(e=selectorAll(e));for(var o=this._groups,c=o.length,u=[],y=[],f=0;f<c;++f)for(var g=o[f],_=g.length,p,S=0;S<_;++S)if(p=g[S]){for(var A=e.call(p,p.__data__,S,g),R,z=get(p,t),l=0,s=A.length;l<s;++l)(R=A[l])&&schedule(R,r,t,l,A,z);u.push(A),y.push(p)}return new Transition(u,y,r,t)}var Selection=selection.prototype.constructor;function transition_selection(){return new Selection(this._groups,this._parents)}function styleNull(e,r){var t,o,c;return function(){var u=styleValue(this,e),y=(this.style.removeProperty(e),styleValue(this,e));return u===y?null:u===t&&y===o?c:c=r(t=u,o=y)}}function styleRemove(e){return function(){this.style.removeProperty(e)}}function styleConstant(e,r,t){var o,c=t+"",u;return function(){var y=styleValue(this,e);return y===c?null:y===o?u:u=r(o=y,t)}}function styleFunction(e,r,t){var o,c,u;return function(){var y=styleValue(this,e),f=t(this),g=f+"";return f==null&&(g=f=(this.style.removeProperty(e),styleValue(this,e))),y===g?null:y===o&&g===c?u:(c=g,u=r(o=y,f))}}function styleMaybeRemove(e,r){var t,o,c,u="style."+r,y="end."+u,f;return function(){var g=set(this,e),_=g.on,p=g.value[u]==null?f||(f=styleRemove(r)):void 0;(_!==t||c!==p)&&(o=(t=_).copy()).on(y,c=p),g.on=o}}function transition_style(e,r,t){var o=(e+="")=="transform"?interpolateTransformCss:interpolate;return r==null?this.styleTween(e,styleNull(e,o)).on("end.style."+e,styleRemove(e)):typeof r=="function"?this.styleTween(e,styleFunction(e,o,tweenValue(this,"style."+e,r))).each(styleMaybeRemove(this._id,e)):this.styleTween(e,styleConstant(e,o,r),t).on("end.style."+e,null)}function styleInterpolate(e,r,t){return function(o){this.style.setProperty(e,r.call(this,o),t)}}function styleTween(e,r,t){var o,c;function u(){var y=r.apply(this,arguments);return y!==c&&(o=(c=y)&&styleInterpolate(e,y,t)),o}return u._value=r,u}function transition_styleTween(e,r,t){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(r==null)return this.tween(o,null);if(typeof r!="function")throw new Error;return this.tween(o,styleTween(e,r,t??""))}function textConstant(e){return function(){this.textContent=e}}function textFunction(e){return function(){var r=e(this);this.textContent=r??""}}function transition_text(e){return this.tween("text",typeof e=="function"?textFunction(tweenValue(this,"text",e)):textConstant(e==null?"":e+""))}function textInterpolate(e){return function(r){this.textContent=e.call(this,r)}}function textTween(e){var r,t;function o(){var c=e.apply(this,arguments);return c!==t&&(r=(t=c)&&textInterpolate(c)),r}return o._value=e,o}function transition_textTween(e){var r="text";if(arguments.length<1)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,textTween(e))}function transition_transition(){for(var e=this._name,r=this._id,t=newId(),o=this._groups,c=o.length,u=0;u<c;++u)for(var y=o[u],f=y.length,g,_=0;_<f;++_)if(g=y[_]){var p=get(g,r);schedule(g,e,t,_,y,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new Transition(o,this._parents,e,t)}function transition_end(){var e,r,t=this,o=t._id,c=t.size();return new Promise(function(u,y){var f={value:y},g={value:function(){--c===0&&u()}};t.each(function(){var _=set(this,o),p=_.on;p!==e&&(r=(e=p).copy(),r._.cancel.push(f),r._.interrupt.push(f),r._.end.push(g)),_.on=r}),c===0&&u()})}var id=0;function Transition(e,r,t,o){this._groups=e,this._parents=r,this._name=t,this._id=o}function newId(){return++id}var selection_prototype=selection.prototype;Transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,easeVarying:transition_easeVarying,end:transition_end,[Symbol.iterator]:selection_prototype[Symbol.iterator]};function cubicInOut(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(e,r){for(var t;!(t=e.__transition)||!(t=t[r]);)if(!(e=e.parentNode))throw new Error(`transition ${r} not found`);return t}function selection_transition(e){var r,t;e instanceof Transition?(r=e._id,e=e._name):(r=newId(),(t=defaultTiming).time=now(),e=e==null?null:e+"");for(var o=this._groups,c=o.length,u=0;u<c;++u)for(var y=o[u],f=y.length,g,_=0;_<f;++_)(g=y[_])&&schedule(g,e,r,_,y,t||inherit(g,r));return new Transition(o,this._parents,e,r)}selection.prototype.interrupt=selection_interrupt;selection.prototype.transition=selection_transition;const constant=e=>()=>e;function ZoomEvent(e,{sourceEvent:r,target:t,transform:o,dispatch:c}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:r,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:c}})}function Transform(e,r,t){this.k=e,this.x=r,this.y=t}Transform.prototype={constructor:Transform,scale:function(e){return e===1?this:new Transform(this.k*e,this.x,this.y)},translate:function(e,r){return e===0&r===0?this:new Transform(this.k,this.x+this.k*e,this.y+this.k*r)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity=new Transform(1,0,0);Transform.prototype;function nopropagation(e){e.stopImmediatePropagation()}function noevent(e){e.preventDefault(),e.stopImmediatePropagation()}function defaultFilter(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function defaultExtent(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function defaultTransform(){return this.__zoom||identity}function defaultWheelDelta(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function defaultConstrain(e,r,t){var o=e.invertX(r[0][0])-t[0][0],c=e.invertX(r[1][0])-t[1][0],u=e.invertY(r[0][1])-t[0][1],y=e.invertY(r[1][1])-t[1][1];return e.translate(c>o?(o+c)/2:Math.min(0,o)||Math.max(0,c),y>u?(u+y)/2:Math.min(0,u)||Math.max(0,y))}function zoom(){var e=defaultFilter,r=defaultExtent,t=defaultConstrain,o=defaultWheelDelta,c=defaultTouchable,u=[0,1/0],y=[[-1/0,-1/0],[1/0,1/0]],f=250,g=interpolateZoom,_=dispatch("start","zoom","end"),p,S,A,R=500,z=150,l=0,s=10;function v(L){L.property("__zoom",defaultTransform).on("wheel.zoom",M,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",P).filter(c).on("touchstart.zoom",F).on("touchmove.zoom",X).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(L,H,U,Y){var W=L.selection?L.selection():L;W.property("__zoom",defaultTransform),L!==W?h(L,H,U,Y):W.interrupt().each(function(){x(this,arguments).event(Y).start().zoom(null,typeof H=="function"?H.apply(this,arguments):H).end()})},v.scaleBy=function(L,H,U,Y){v.scaleTo(L,function(){var W=this.__zoom.k,q=typeof H=="function"?H.apply(this,arguments):H;return W*q},U,Y)},v.scaleTo=function(L,H,U,Y){v.transform(L,function(){var W=r.apply(this,arguments),q=this.__zoom,G=U==null?C(W):typeof U=="function"?U.apply(this,arguments):U,$=q.invert(G),Z=typeof H=="function"?H.apply(this,arguments):H;return t(E(w(q,Z),G,$),W,y)},U,Y)},v.translateBy=function(L,H,U,Y){v.transform(L,function(){return t(this.__zoom.translate(typeof H=="function"?H.apply(this,arguments):H,typeof U=="function"?U.apply(this,arguments):U),r.apply(this,arguments),y)},null,Y)},v.translateTo=function(L,H,U,Y,W){v.transform(L,function(){var q=r.apply(this,arguments),G=this.__zoom,$=Y==null?C(q):typeof Y=="function"?Y.apply(this,arguments):Y;return t(identity.translate($[0],$[1]).scale(G.k).translate(typeof H=="function"?-H.apply(this,arguments):-H,typeof U=="function"?-U.apply(this,arguments):-U),q,y)},Y,W)};function w(L,H){return H=Math.max(u[0],Math.min(u[1],H)),H===L.k?L:new Transform(H,L.x,L.y)}function E(L,H,U){var Y=H[0]-U[0]*L.k,W=H[1]-U[1]*L.k;return Y===L.x&&W===L.y?L:new Transform(L.k,Y,W)}function C(L){return[(+L[0][0]+ +L[1][0])/2,(+L[0][1]+ +L[1][1])/2]}function h(L,H,U,Y){L.on("start.zoom",function(){x(this,arguments).event(Y).start()}).on("interrupt.zoom end.zoom",function(){x(this,arguments).event(Y).end()}).tween("zoom",function(){var W=this,q=arguments,G=x(W,q).event(Y),$=r.apply(W,q),Z=U==null?C($):typeof U=="function"?U.apply(W,q):U,xe=Math.max($[1][0]-$[0][0],$[1][1]-$[0][1]),ce=W.__zoom,Ne=typeof H=="function"?H.apply(W,q):H,Pe=g(ce.invert(Z).concat(xe/ce.k),Ne.invert(Z).concat(xe/Ne.k));return function(De){if(De===1)De=Ne;else{var Me=Pe(De),Be=xe/Me[2];De=new Transform(Be,Z[0]-Me[0]*Be,Z[1]-Me[1]*Be)}G.zoom(null,De)}})}function x(L,H,U){return!U&&L.__zooming||new k(L,H)}function k(L,H){this.that=L,this.args=H,this.active=0,this.sourceEvent=null,this.extent=r.apply(L,H),this.taps=0}k.prototype={event:function(L){return L&&(this.sourceEvent=L),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(L,H){return this.mouse&&L!=="mouse"&&(this.mouse[1]=H.invert(this.mouse[0])),this.touch0&&L!=="touch"&&(this.touch0[1]=H.invert(this.touch0[0])),this.touch1&&L!=="touch"&&(this.touch1[1]=H.invert(this.touch1[0])),this.that.__zoom=H,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(L){var H=select(this.that).datum();_.call(L,this.that,new ZoomEvent(L,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:_}),H)}};function M(L,...H){if(!e.apply(this,arguments))return;var U=x(this,H).event(L),Y=this.__zoom,W=Math.max(u[0],Math.min(u[1],Y.k*Math.pow(2,o.apply(this,arguments)))),q=pointer(L);if(U.wheel)(U.mouse[0][0]!==q[0]||U.mouse[0][1]!==q[1])&&(U.mouse[1]=Y.invert(U.mouse[0]=q)),clearTimeout(U.wheel);else{if(Y.k===W)return;U.mouse=[q,Y.invert(q)],interrupt(this),U.start()}noevent(L),U.wheel=setTimeout(G,z),U.zoom("mouse",t(E(w(Y,W),U.mouse[0],U.mouse[1]),U.extent,y));function G(){U.wheel=null,U.end()}}function D(L,...H){if(A||!e.apply(this,arguments))return;var U=L.currentTarget,Y=x(this,H,!0).event(L),W=select(L.view).on("mousemove.zoom",Z,!0).on("mouseup.zoom",xe,!0),q=pointer(L,U),G=L.clientX,$=L.clientY;dragDisable(L.view),nopropagation(L),Y.mouse=[q,this.__zoom.invert(q)],interrupt(this),Y.start();function Z(ce){if(noevent(ce),!Y.moved){var Ne=ce.clientX-G,Pe=ce.clientY-$;Y.moved=Ne*Ne+Pe*Pe>l}Y.event(ce).zoom("mouse",t(E(Y.that.__zoom,Y.mouse[0]=pointer(ce,U),Y.mouse[1]),Y.extent,y))}function xe(ce){W.on("mousemove.zoom mouseup.zoom",null),yesdrag(ce.view,Y.moved),noevent(ce),Y.event(ce).end()}}function P(L,...H){if(e.apply(this,arguments)){var U=this.__zoom,Y=pointer(L.changedTouches?L.changedTouches[0]:L,this),W=U.invert(Y),q=U.k*(L.shiftKey?.5:2),G=t(E(w(U,q),Y,W),r.apply(this,H),y);noevent(L),f>0?select(this).transition().duration(f).call(h,G,Y,L):select(this).call(v.transform,G,Y,L)}}function F(L,...H){if(e.apply(this,arguments)){var U=L.touches,Y=U.length,W=x(this,H,L.changedTouches.length===Y).event(L),q,G,$,Z;for(nopropagation(L),G=0;G<Y;++G)$=U[G],Z=pointer($,this),Z=[Z,this.__zoom.invert(Z),$.identifier],W.touch0?!W.touch1&&W.touch0[2]!==Z[2]&&(W.touch1=Z,W.taps=0):(W.touch0=Z,q=!0,W.taps=1+!!p);p&&(p=clearTimeout(p)),q&&(W.taps<2&&(S=Z[0],p=setTimeout(function(){p=null},R)),interrupt(this),W.start())}}function X(L,...H){if(this.__zooming){var U=x(this,H).event(L),Y=L.changedTouches,W=Y.length,q,G,$,Z;for(noevent(L),q=0;q<W;++q)G=Y[q],$=pointer(G,this),U.touch0&&U.touch0[2]===G.identifier?U.touch0[0]=$:U.touch1&&U.touch1[2]===G.identifier&&(U.touch1[0]=$);if(G=U.that.__zoom,U.touch1){var xe=U.touch0[0],ce=U.touch0[1],Ne=U.touch1[0],Pe=U.touch1[1],De=(De=Ne[0]-xe[0])*De+(De=Ne[1]-xe[1])*De,Me=(Me=Pe[0]-ce[0])*Me+(Me=Pe[1]-ce[1])*Me;G=w(G,Math.sqrt(De/Me)),$=[(xe[0]+Ne[0])/2,(xe[1]+Ne[1])/2],Z=[(ce[0]+Pe[0])/2,(ce[1]+Pe[1])/2]}else if(U.touch0)$=U.touch0[0],Z=U.touch0[1];else return;U.zoom("touch",t(E(G,$,Z),U.extent,y))}}function B(L,...H){if(this.__zooming){var U=x(this,H).event(L),Y=L.changedTouches,W=Y.length,q,G;for(nopropagation(L),A&&clearTimeout(A),A=setTimeout(function(){A=null},R),q=0;q<W;++q)G=Y[q],U.touch0&&U.touch0[2]===G.identifier?delete U.touch0:U.touch1&&U.touch1[2]===G.identifier&&delete U.touch1;if(U.touch1&&!U.touch0&&(U.touch0=U.touch1,delete U.touch1),U.touch0)U.touch0[1]=this.__zoom.invert(U.touch0[0]);else if(U.end(),U.taps===2&&(G=pointer(G,this),Math.hypot(S[0]-G[0],S[1]-G[1])<s)){var $=select(this).on("dblclick.zoom");$&&$.apply(this,arguments)}}}return v.wheelDelta=function(L){return arguments.length?(o=typeof L=="function"?L:constant(+L),v):o},v.filter=function(L){return arguments.length?(e=typeof L=="function"?L:constant(!!L),v):e},v.touchable=function(L){return arguments.length?(c=typeof L=="function"?L:constant(!!L),v):c},v.extent=function(L){return arguments.length?(r=typeof L=="function"?L:constant([[+L[0][0],+L[0][1]],[+L[1][0],+L[1][1]]]),v):r},v.scaleExtent=function(L){return arguments.length?(u[0]=+L[0],u[1]=+L[1],v):[u[0],u[1]]},v.translateExtent=function(L){return arguments.length?(y[0][0]=+L[0][0],y[1][0]=+L[1][0],y[0][1]=+L[0][1],y[1][1]=+L[1][1],v):[[y[0][0],y[0][1]],[y[1][0],y[1][1]]]},v.constrain=function(L){return arguments.length?(t=L,v):t},v.duration=function(L){return arguments.length?(f=+L,v):f},v.interpolate=function(L){return arguments.length?(g=L,v):g},v.on=function(){var L=_.on.apply(_,arguments);return L===_?v:L},v.clickDistance=function(L){return arguments.length?(l=(L=+L)*L,v):Math.sqrt(l)},v.tapDistance=function(L){return arguments.length?(s=+L,v):s},v}const StoreContext=reactExports.createContext(null),Provider$1=StoreContext.Provider,errorMessages={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,r)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?r.targetHandle:r.sourceHandle}", edge id: ${r.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},zustandErrorMessage=errorMessages.error001();function useStore(e,r){const t=reactExports.useContext(StoreContext);if(t===null)throw new Error(zustandErrorMessage);return useStoreWithEqualityFn(t,e,r)}const useStoreApi=()=>{const e=reactExports.useContext(StoreContext);if(e===null)throw new Error(zustandErrorMessage);return reactExports.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},selector$g=e=>e.userSelectionActive?"none":"all";function Panel({position:e,children:r,className:t,style:o,...c}){const u=useStore(selector$g),y=`${e}`.split("-");return React.createElement("div",{className:cc(["react-flow__panel",t,...y]),style:{...o,pointerEvents:u},...c},r)}function Attribution({proOptions:e,position:r="bottom-right"}){return e?.hideAttribution?null:React.createElement(Panel,{position:r,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},React.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const EdgeText=({x:e,y:r,label:t,labelStyle:o={},labelShowBg:c=!0,labelBgStyle:u={},labelBgPadding:y=[2,4],labelBgBorderRadius:f=2,children:g,className:_,...p})=>{const S=reactExports.useRef(null),[A,R]=reactExports.useState({x:0,y:0,width:0,height:0}),z=cc(["react-flow__edge-textwrapper",_]);return reactExports.useEffect(()=>{if(S.current){const l=S.current.getBBox();R({x:l.x,y:l.y,width:l.width,height:l.height})}},[t]),typeof t>"u"||!t?null:React.createElement("g",{transform:`translate(${e-A.width/2} ${r-A.height/2})`,className:z,visibility:A.width?"visible":"hidden",...p},c&&React.createElement("rect",{width:A.width+2*y[0],x:-y[0],y:-y[1],height:A.height+2*y[1],className:"react-flow__edge-textbg",style:u,rx:f,ry:f}),React.createElement("text",{className:"react-flow__edge-text",y:A.height/2,dy:"0.3em",ref:S,style:o},t),g)};var EdgeText$1=reactExports.memo(EdgeText);const getDimensions=e=>({width:e.offsetWidth,height:e.offsetHeight}),clamp=(e,r=0,t=1)=>Math.min(Math.max(e,r),t),clampPosition=(e={x:0,y:0},r)=>({x:clamp(e.x,r[0][0],r[1][0]),y:clamp(e.y,r[0][1],r[1][1])}),calcAutoPanVelocity=(e,r,t)=>e<r?clamp(Math.abs(e-r),1,50)/50:e>t?-clamp(Math.abs(e-t),1,50)/50:0,calcAutoPan=(e,r)=>{const t=calcAutoPanVelocity(e.x,35,r.width-35)*20,o=calcAutoPanVelocity(e.y,35,r.height-35)*20;return[t,o]},getHostForElement=e=>e.getRootNode?.()||window?.document,getBoundsOfBoxes=(e,r)=>({x:Math.min(e.x,r.x),y:Math.min(e.y,r.y),x2:Math.max(e.x2,r.x2),y2:Math.max(e.y2,r.y2)}),rectToBox=({x:e,y:r,width:t,height:o})=>({x:e,y:r,x2:e+t,y2:r+o}),boxToRect=({x:e,y:r,x2:t,y2:o})=>({x:e,y:r,width:t-e,height:o-r}),nodeToRect=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),getOverlappingArea=(e,r)=>{const t=Math.max(0,Math.min(e.x+e.width,r.x+r.width)-Math.max(e.x,r.x)),o=Math.max(0,Math.min(e.y+e.height,r.y+r.height)-Math.max(e.y,r.y));return Math.ceil(t*o)},isRectObject=e=>isNumeric(e.width)&&isNumeric(e.height)&&isNumeric(e.x)&&isNumeric(e.y),isNumeric=e=>!isNaN(e)&&isFinite(e),internalsSymbol=Symbol.for("internals"),elementSelectionKeys=["Enter"," ","Escape"],devWarn=(e,r)=>{},isReactKeyboardEvent=e=>"nativeEvent"in e;function isInputDOMNode(e){const t=(isReactKeyboardEvent(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(t?.nodeName)||t?.hasAttribute("contenteditable")||!!t?.closest(".nokey")}const isMouseEvent=e=>"clientX"in e,getEventPosition=(e,r)=>{const t=isMouseEvent(e),o=t?e.clientX:e.touches?.[0].clientX,c=t?e.clientY:e.touches?.[0].clientY;return{x:o-(r?.left??0),y:c-(r?.top??0)}},isMacOs=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,BaseEdge=({id:e,path:r,labelX:t,labelY:o,label:c,labelStyle:u,labelShowBg:y,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:_,style:p,markerEnd:S,markerStart:A,interactionWidth:R=20})=>React.createElement(React.Fragment,null,React.createElement("path",{id:e,style:p,d:r,fill:"none",className:"react-flow__edge-path",markerEnd:S,markerStart:A}),R&&React.createElement("path",{d:r,fill:"none",strokeOpacity:0,strokeWidth:R,className:"react-flow__edge-interaction"}),c&&isNumeric(t)&&isNumeric(o)?React.createElement(EdgeText$1,{x:t,y:o,label:c,labelStyle:u,labelShowBg:y,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:_}):null);BaseEdge.displayName="BaseEdge";function getMouseHandler$1(e,r,t){return t===void 0?t:o=>{const c=r().edges.find(u=>u.id===e);c&&t(o,{...c})}}function getEdgeCenter({sourceX:e,sourceY:r,targetX:t,targetY:o}){const c=Math.abs(t-e)/2,u=t<e?t+c:t-c,y=Math.abs(o-r)/2,f=o<r?o+y:o-y;return[u,f,c,y]}function getBezierEdgeCenter({sourceX:e,sourceY:r,targetX:t,targetY:o,sourceControlX:c,sourceControlY:u,targetControlX:y,targetControlY:f}){const g=e*.125+c*.375+y*.375+t*.125,_=r*.125+u*.375+f*.375+o*.125,p=Math.abs(g-e),S=Math.abs(_-r);return[g,_,p,S]}var ConnectionMode;(function(e){e.Strict="strict",e.Loose="loose"})(ConnectionMode||(ConnectionMode={}));var PanOnScrollMode;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(PanOnScrollMode||(PanOnScrollMode={}));var SelectionMode;(function(e){e.Partial="partial",e.Full="full"})(SelectionMode||(SelectionMode={}));var ConnectionLineType;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ConnectionLineType||(ConnectionLineType={}));var MarkerType;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(MarkerType||(MarkerType={}));var Position;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Position||(Position={}));function getControl({pos:e,x1:r,y1:t,x2:o,y2:c}){return e===Position.Left||e===Position.Right?[.5*(r+o),t]:[r,.5*(t+c)]}function getSimpleBezierPath({sourceX:e,sourceY:r,sourcePosition:t=Position.Bottom,targetX:o,targetY:c,targetPosition:u=Position.Top}){const[y,f]=getControl({pos:t,x1:e,y1:r,x2:o,y2:c}),[g,_]=getControl({pos:u,x1:o,y1:c,x2:e,y2:r}),[p,S,A,R]=getBezierEdgeCenter({sourceX:e,sourceY:r,targetX:o,targetY:c,sourceControlX:y,sourceControlY:f,targetControlX:g,targetControlY:_});return[`M${e},${r} C${y},${f} ${g},${_} ${o},${c}`,p,S,A,R]}const SimpleBezierEdge=reactExports.memo(({sourceX:e,sourceY:r,targetX:t,targetY:o,sourcePosition:c=Position.Bottom,targetPosition:u=Position.Top,label:y,labelStyle:f,labelShowBg:g,labelBgStyle:_,labelBgPadding:p,labelBgBorderRadius:S,style:A,markerEnd:R,markerStart:z,interactionWidth:l})=>{const[s,v,w]=getSimpleBezierPath({sourceX:e,sourceY:r,sourcePosition:c,targetX:t,targetY:o,targetPosition:u});return React.createElement(BaseEdge,{path:s,labelX:v,labelY:w,label:y,labelStyle:f,labelShowBg:g,labelBgStyle:_,labelBgPadding:p,labelBgBorderRadius:S,style:A,markerEnd:R,markerStart:z,interactionWidth:l})});SimpleBezierEdge.displayName="SimpleBezierEdge";const handleDirections={[Position.Left]:{x:-1,y:0},[Position.Right]:{x:1,y:0},[Position.Top]:{x:0,y:-1},[Position.Bottom]:{x:0,y:1}},getDirection=({source:e,sourcePosition:r=Position.Bottom,target:t})=>r===Position.Left||r===Position.Right?e.x<t.x?{x:1,y:0}:{x:-1,y:0}:e.y<t.y?{x:0,y:1}:{x:0,y:-1},distance=(e,r)=>Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));function getPoints({source:e,sourcePosition:r=Position.Bottom,target:t,targetPosition:o=Position.Top,center:c,offset:u}){const y=handleDirections[r],f=handleDirections[o],g={x:e.x+y.x*u,y:e.y+y.y*u},_={x:t.x+f.x*u,y:t.y+f.y*u},p=getDirection({source:g,sourcePosition:r,target:_}),S=p.x!==0?"x":"y",A=p[S];let R=[],z,l;const s={x:0,y:0},v={x:0,y:0},[w,E,C,h]=getEdgeCenter({sourceX:e.x,sourceY:e.y,targetX:t.x,targetY:t.y});if(y[S]*f[S]===-1){z=c.x??w,l=c.y??E;const k=[{x:z,y:g.y},{x:z,y:_.y}],M=[{x:g.x,y:l},{x:_.x,y:l}];y[S]===A?R=S==="x"?k:M:R=S==="x"?M:k}else{const k=[{x:g.x,y:_.y}],M=[{x:_.x,y:g.y}];if(S==="x"?R=y.x===A?M:k:R=y.y===A?k:M,r===o){const B=Math.abs(e[S]-t[S]);if(B<=u){const L=Math.min(u-1,u-B);y[S]===A?s[S]=(g[S]>e[S]?-1:1)*L:v[S]=(_[S]>t[S]?-1:1)*L}}if(r!==o){const B=S==="x"?"y":"x",L=y[S]===f[B],H=g[B]>_[B],U=g[B]<_[B];(y[S]===1&&(!L&&H||L&&U)||y[S]!==1&&(!L&&U||L&&H))&&(R=S==="x"?k:M)}const D={x:g.x+s.x,y:g.y+s.y},P={x:_.x+v.x,y:_.y+v.y},F=Math.max(Math.abs(D.x-R[0].x),Math.abs(P.x-R[0].x)),X=Math.max(Math.abs(D.y-R[0].y),Math.abs(P.y-R[0].y));F>=X?(z=(D.x+P.x)/2,l=R[0].y):(z=R[0].x,l=(D.y+P.y)/2)}return[[e,{x:g.x+s.x,y:g.y+s.y},...R,{x:_.x+v.x,y:_.y+v.y},t],z,l,C,h]}function getBend(e,r,t,o){const c=Math.min(distance(e,r)/2,distance(r,t)/2,o),{x:u,y}=r;if(e.x===u&&u===t.x||e.y===y&&y===t.y)return`L${u} ${y}`;if(e.y===y){const _=e.x<t.x?-1:1,p=e.y<t.y?1:-1;return`L ${u+c*_},${y}Q ${u},${y} ${u},${y+c*p}`}const f=e.x<t.x?1:-1,g=e.y<t.y?-1:1;return`L ${u},${y+c*g}Q ${u},${y} ${u+c*f},${y}`}function getSmoothStepPath({sourceX:e,sourceY:r,sourcePosition:t=Position.Bottom,targetX:o,targetY:c,targetPosition:u=Position.Top,borderRadius:y=5,centerX:f,centerY:g,offset:_=20}){const[p,S,A,R,z]=getPoints({source:{x:e,y:r},sourcePosition:t,target:{x:o,y:c},targetPosition:u,center:{x:f,y:g},offset:_});return[p.reduce((s,v,w)=>{let E="";return w>0&&w<p.length-1?E=getBend(p[w-1],v,p[w+1],y):E=`${w===0?"M":"L"}${v.x} ${v.y}`,s+=E,s},""),S,A,R,z]}const SmoothStepEdge=reactExports.memo(({sourceX:e,sourceY:r,targetX:t,targetY:o,label:c,labelStyle:u,labelShowBg:y,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:_,style:p,sourcePosition:S=Position.Bottom,targetPosition:A=Position.Top,markerEnd:R,markerStart:z,pathOptions:l,interactionWidth:s})=>{const[v,w,E]=getSmoothStepPath({sourceX:e,sourceY:r,sourcePosition:S,targetX:t,targetY:o,targetPosition:A,borderRadius:l?.borderRadius,offset:l?.offset});return React.createElement(BaseEdge,{path:v,labelX:w,labelY:E,label:c,labelStyle:u,labelShowBg:y,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:_,style:p,markerEnd:R,markerStart:z,interactionWidth:s})});SmoothStepEdge.displayName="SmoothStepEdge";const StepEdge=reactExports.memo(e=>React.createElement(SmoothStepEdge,{...e,pathOptions:reactExports.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));StepEdge.displayName="StepEdge";function getStraightPath({sourceX:e,sourceY:r,targetX:t,targetY:o}){const[c,u,y,f]=getEdgeCenter({sourceX:e,sourceY:r,targetX:t,targetY:o});return[`M ${e},${r}L ${t},${o}`,c,u,y,f]}const StraightEdge=reactExports.memo(({sourceX:e,sourceY:r,targetX:t,targetY:o,label:c,labelStyle:u,labelShowBg:y,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:_,style:p,markerEnd:S,markerStart:A,interactionWidth:R})=>{const[z,l,s]=getStraightPath({sourceX:e,sourceY:r,targetX:t,targetY:o});return React.createElement(BaseEdge,{path:z,labelX:l,labelY:s,label:c,labelStyle:u,labelShowBg:y,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:_,style:p,markerEnd:S,markerStart:A,interactionWidth:R})});StraightEdge.displayName="StraightEdge";function calculateControlOffset(e,r){return e>=0?.5*e:r*25*Math.sqrt(-e)}function getControlWithCurvature({pos:e,x1:r,y1:t,x2:o,y2:c,c:u}){switch(e){case Position.Left:return[r-calculateControlOffset(r-o,u),t];case Position.Right:return[r+calculateControlOffset(o-r,u),t];case Position.Top:return[r,t-calculateControlOffset(t-c,u)];case Position.Bottom:return[r,t+calculateControlOffset(c-t,u)]}}function getBezierPath({sourceX:e,sourceY:r,sourcePosition:t=Position.Bottom,targetX:o,targetY:c,targetPosition:u=Position.Top,curvature:y=.25}){const[f,g]=getControlWithCurvature({pos:t,x1:e,y1:r,x2:o,y2:c,c:y}),[_,p]=getControlWithCurvature({pos:u,x1:o,y1:c,x2:e,y2:r,c:y}),[S,A,R,z]=getBezierEdgeCenter({sourceX:e,sourceY:r,targetX:o,targetY:c,sourceControlX:f,sourceControlY:g,targetControlX:_,targetControlY:p});return[`M${e},${r} C${f},${g} ${_},${p} ${o},${c}`,S,A,R,z]}const BezierEdge=reactExports.memo(({sourceX:e,sourceY:r,targetX:t,targetY:o,sourcePosition:c=Position.Bottom,targetPosition:u=Position.Top,label:y,labelStyle:f,labelShowBg:g,labelBgStyle:_,labelBgPadding:p,labelBgBorderRadius:S,style:A,markerEnd:R,markerStart:z,pathOptions:l,interactionWidth:s})=>{const[v,w,E]=getBezierPath({sourceX:e,sourceY:r,sourcePosition:c,targetX:t,targetY:o,targetPosition:u,curvature:l?.curvature});return React.createElement(BaseEdge,{path:v,labelX:w,labelY:E,label:y,labelStyle:f,labelShowBg:g,labelBgStyle:_,labelBgPadding:p,labelBgBorderRadius:S,style:A,markerEnd:R,markerStart:z,interactionWidth:s})});BezierEdge.displayName="BezierEdge";const NodeIdContext=reactExports.createContext(null),Provider$2=NodeIdContext.Provider;NodeIdContext.Consumer;const useNodeId=()=>reactExports.useContext(NodeIdContext),isEdge=e=>"id"in e&&"source"in e&&"target"in e,getEdgeId=({source:e,sourceHandle:r,target:t,targetHandle:o})=>`reactflow__edge-${e}${r||""}-${t}${o||""}`,getMarkerId=(e,r)=>typeof e>"u"?"":typeof e=="string"?e:`${r?`${r}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,connectionExists=(e,r)=>r.some(t=>t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle)),addEdge=(e,r)=>{if(!e.source||!e.target)return r;let t;return isEdge(e)?t={...e}:t={...e,id:getEdgeId(e)},connectionExists(t,r)?r:r.concat(t)},pointToRendererPoint=({x:e,y:r},[t,o,c],u,[y,f])=>{const g={x:(e-t)/c,y:(r-o)/c};return u?{x:y*Math.round(g.x/y),y:f*Math.round(g.y/f)}:g},rendererPointToPoint=({x:e,y:r},[t,o,c])=>({x:e*c+t,y:r*c+o}),getNodePositionWithOrigin=(e,r=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const t=(e.width??0)*r[0],o=(e.height??0)*r[1],c={x:e.position.x-t,y:e.position.y-o};return{...c,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-t,y:e.positionAbsolute.y-o}:c}},getNodesBounds=(e,r=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const t=e.reduce((o,c)=>{const{x:u,y}=getNodePositionWithOrigin(c,r).positionAbsolute;return getBoundsOfBoxes(o,rectToBox({x:u,y,width:c.width||0,height:c.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return boxToRect(t)},getNodesInside=(e,r,[t,o,c]=[0,0,1],u=!1,y=!1,f=[0,0])=>{const g={x:(r.x-t)/c,y:(r.y-o)/c,width:r.width/c,height:r.height/c},_=[];return e.forEach(p=>{const{width:S,height:A,selectable:R=!0,hidden:z=!1}=p;if(y&&!R||z)return!1;const{positionAbsolute:l}=getNodePositionWithOrigin(p,f),s={x:l.x,y:l.y,width:S||0,height:A||0},v=getOverlappingArea(g,s),w=typeof S>"u"||typeof A>"u"||S===null||A===null,E=u&&v>0,C=(S||0)*(A||0);(w||E||v>=C||p.dragging)&&_.push(p)}),_},getConnectedEdges=(e,r)=>{const t=e.map(o=>o.id);return r.filter(o=>t.includes(o.source)||t.includes(o.target))},getViewportForBounds=(e,r,t,o,c,u=.1)=>{const y=r/(e.width*(1+u)),f=t/(e.height*(1+u)),g=Math.min(y,f),_=clamp(g,o,c),p=e.x+e.width/2,S=e.y+e.height/2,A=r/2-p*_,R=t/2-S*_;return{x:A,y:R,zoom:_}},getD3Transition=(e,r=0)=>e.transition().duration(r);function getHandles(e,r,t,o){return(r[t]||[]).reduce((c,u)=>(`${e.id}-${u.id}-${t}`!==o&&c.push({id:u.id||null,type:t,nodeId:e.id,x:(e.positionAbsolute?.x??0)+u.x+u.width/2,y:(e.positionAbsolute?.y??0)+u.y+u.height/2}),c),[])}function getClosestHandle(e,r,t,o,c,u){const{x:y,y:f}=getEventPosition(e),_=r.elementsFromPoint(y,f).find(z=>z.classList.contains("react-flow__handle"));if(_){const z=_.getAttribute("data-nodeid");if(z){const l=getHandleType(void 0,_),s=_.getAttribute("data-handleid"),v=u({nodeId:z,id:s,type:l});if(v){const w=c.find(E=>E.nodeId===z&&E.type===l&&E.id===s);return{handle:{id:s,type:l,nodeId:z,x:w?.x||t.x,y:w?.y||t.y},validHandleResult:v}}}}let p=[],S=1/0;if(c.forEach(z=>{const l=Math.sqrt((z.x-t.x)**2+(z.y-t.y)**2);if(l<=o){const s=u(z);l<=S&&(l<S?p=[{handle:z,validHandleResult:s}]:l===S&&p.push({handle:z,validHandleResult:s}),S=l)}}),!p.length)return{handle:null,validHandleResult:defaultResult()};if(p.length===1)return p[0];const A=p.some(({validHandleResult:z})=>z.isValid),R=p.some(({handle:z})=>z.type==="target");return p.find(({handle:z,validHandleResult:l})=>R?z.type==="target":A?l.isValid:!0)||p[0]}const nullConnection={source:null,target:null,sourceHandle:null,targetHandle:null},defaultResult=()=>({handleDomNode:null,isValid:!1,connection:nullConnection,endHandle:null});function isValidHandle(e,r,t,o,c,u,y){const f=c==="target",g=y.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),_={...defaultResult(),handleDomNode:g};if(g){const p=getHandleType(void 0,g),S=g.getAttribute("data-nodeid"),A=g.getAttribute("data-handleid"),R=g.classList.contains("connectable"),z=g.classList.contains("connectableend"),l={source:f?S:t,sourceHandle:f?A:o,target:f?t:S,targetHandle:f?o:A};_.connection=l,R&&z&&(r===ConnectionMode.Strict?f&&p==="source"||!f&&p==="target":S!==t||A!==o)&&(_.endHandle={nodeId:S,handleId:A,type:p},_.isValid=u(l))}return _}function getHandleLookup({nodes:e,nodeId:r,handleId:t,handleType:o}){return e.reduce((c,u)=>{if(u[internalsSymbol]){const{handleBounds:y}=u[internalsSymbol];let f=[],g=[];y&&(f=getHandles(u,y,"source",`${r}-${t}-${o}`),g=getHandles(u,y,"target",`${r}-${t}-${o}`)),c.push(...f,...g)}return c},[])}function getHandleType(e,r){return e||(r?.classList.contains("target")?"target":r?.classList.contains("source")?"source":null)}function resetRecentHandle(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function getConnectionStatus(e,r){let t=null;return r?t="valid":e&&!r&&(t="invalid"),t}function handlePointerDown({event:e,handleId:r,nodeId:t,onConnect:o,isTarget:c,getState:u,setState:y,isValidConnection:f,edgeUpdaterType:g,onReconnectEnd:_}){const p=getHostForElement(e.target),{connectionMode:S,domNode:A,autoPanOnConnect:R,connectionRadius:z,onConnectStart:l,panBy:s,getNodes:v,cancelConnection:w}=u();let E=0,C;const{x:h,y:x}=getEventPosition(e),k=p?.elementFromPoint(h,x),M=getHandleType(g,k),D=A?.getBoundingClientRect();if(!D||!M)return;let P,F=getEventPosition(e,D),X=!1,B=null,L=!1,H=null;const U=getHandleLookup({nodes:v(),nodeId:t,handleId:r,handleType:M}),Y=()=>{if(!R)return;const[G,$]=calcAutoPan(F,D);s({x:G,y:$}),E=requestAnimationFrame(Y)};y({connectionPosition:F,connectionStatus:null,connectionNodeId:t,connectionHandleId:r,connectionHandleType:M,connectionStartHandle:{nodeId:t,handleId:r,type:M},connectionEndHandle:null}),l?.(e,{nodeId:t,handleId:r,handleType:M});function W(G){const{transform:$}=u();F=getEventPosition(G,D);const{handle:Z,validHandleResult:xe}=getClosestHandle(G,p,pointToRendererPoint(F,$,!1,[1,1]),z,U,ce=>isValidHandle(ce,S,t,r,c?"target":"source",f,p));if(C=Z,X||(Y(),X=!0),H=xe.handleDomNode,B=xe.connection,L=xe.isValid,y({connectionPosition:C&&L?rendererPointToPoint({x:C.x,y:C.y},$):F,connectionStatus:getConnectionStatus(!!C,L),connectionEndHandle:xe.endHandle}),!C&&!L&&!H)return resetRecentHandle(P);B.source!==B.target&&H&&(resetRecentHandle(P),P=H,H.classList.add("connecting","react-flow__handle-connecting"),H.classList.toggle("valid",L),H.classList.toggle("react-flow__handle-valid",L))}function q(G){(C||H)&&B&&L&&o?.(B),u().onConnectEnd?.(G),g&&_?.(G),resetRecentHandle(P),w(),cancelAnimationFrame(E),X=!1,L=!1,B=null,H=null,p.removeEventListener("mousemove",W),p.removeEventListener("mouseup",q),p.removeEventListener("touchmove",W),p.removeEventListener("touchend",q)}p.addEventListener("mousemove",W),p.addEventListener("mouseup",q),p.addEventListener("touchmove",W),p.addEventListener("touchend",q)}const alwaysValid=()=>!0,selector$f=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),connectingSelector=(e,r,t)=>o=>{const{connectionStartHandle:c,connectionEndHandle:u,connectionClickStartHandle:y}=o;return{connecting:c?.nodeId===e&&c?.handleId===r&&c?.type===t||u?.nodeId===e&&u?.handleId===r&&u?.type===t,clickConnecting:y?.nodeId===e&&y?.handleId===r&&y?.type===t}},Handle=reactExports.forwardRef(({type:e="source",position:r=Position.Top,isValidConnection:t,isConnectable:o=!0,isConnectableStart:c=!0,isConnectableEnd:u=!0,id:y,onConnect:f,children:g,className:_,onMouseDown:p,onTouchStart:S,...A},R)=>{const z=y||null,l=e==="target",s=useStoreApi(),v=useNodeId(),{connectOnClick:w,noPanClassName:E}=useStore(selector$f,shallow$1),{connecting:C,clickConnecting:h}=useStore(connectingSelector(v,z,e),shallow$1);v||s.getState().onError?.("010",errorMessages.error010());const x=D=>{const{defaultEdgeOptions:P,onConnect:F,hasDefaultEdges:X}=s.getState(),B={...P,...D};if(X){const{edges:L,setEdges:H}=s.getState();H(addEdge(B,L))}F?.(B),f?.(B)},k=D=>{if(!v)return;const P=isMouseEvent(D);c&&(P&&D.button===0||!P)&&handlePointerDown({event:D,handleId:z,nodeId:v,onConnect:x,isTarget:l,getState:s.getState,setState:s.setState,isValidConnection:t||s.getState().isValidConnection||alwaysValid}),P?p?.(D):S?.(D)},M=D=>{const{onClickConnectStart:P,onClickConnectEnd:F,connectionClickStartHandle:X,connectionMode:B,isValidConnection:L}=s.getState();if(!v||!X&&!c)return;if(!X){P?.(D,{nodeId:v,handleId:z,handleType:e}),s.setState({connectionClickStartHandle:{nodeId:v,type:e,handleId:z}});return}const H=getHostForElement(D.target),U=t||L||alwaysValid,{connection:Y,isValid:W}=isValidHandle({nodeId:v,id:z,type:e},B,X.nodeId,X.handleId||null,X.type,U,H);W&&x(Y),F?.(D),s.setState({connectionClickStartHandle:null})};return React.createElement("div",{"data-handleid":z,"data-nodeid":v,"data-handlepos":r,"data-id":`${v}-${z}-${e}`,className:cc(["react-flow__handle",`react-flow__handle-${r}`,"nodrag",E,_,{source:!l,target:l,connectable:o,connectablestart:c,connectableend:u,connecting:h,connectionindicator:o&&(c&&!C||u&&C)}]),onMouseDown:k,onTouchStart:k,onClick:w?M:void 0,ref:R,...A},g)});Handle.displayName="Handle";var Handle$1=reactExports.memo(Handle);const DefaultNode=({data:e,isConnectable:r,targetPosition:t=Position.Top,sourcePosition:o=Position.Bottom})=>React.createElement(React.Fragment,null,React.createElement(Handle$1,{type:"target",position:t,isConnectable:r}),e?.label,React.createElement(Handle$1,{type:"source",position:o,isConnectable:r}));DefaultNode.displayName="DefaultNode";var DefaultNode$1=reactExports.memo(DefaultNode);const InputNode=({data:e,isConnectable:r,sourcePosition:t=Position.Bottom})=>React.createElement(React.Fragment,null,e?.label,React.createElement(Handle$1,{type:"source",position:t,isConnectable:r}));InputNode.displayName="InputNode";var InputNode$1=reactExports.memo(InputNode);const OutputNode=({data:e,isConnectable:r,targetPosition:t=Position.Top})=>React.createElement(React.Fragment,null,React.createElement(Handle$1,{type:"target",position:t,isConnectable:r}),e?.label);OutputNode.displayName="OutputNode";var OutputNode$1=reactExports.memo(OutputNode);const GroupNode=()=>null;GroupNode.displayName="GroupNode";const selector$e=e=>({selectedNodes:e.getNodes().filter(r=>r.selected),selectedEdges:e.edges.filter(r=>r.selected).map(r=>({...r}))}),selectId=e=>e.id;function areEqual(e,r){return shallow$1(e.selectedNodes.map(selectId),r.selectedNodes.map(selectId))&&shallow$1(e.selectedEdges.map(selectId),r.selectedEdges.map(selectId))}const SelectionListener=reactExports.memo(({onSelectionChange:e})=>{const r=useStoreApi(),{selectedNodes:t,selectedEdges:o}=useStore(selector$e,areEqual);return reactExports.useEffect(()=>{const c={nodes:t,edges:o};e?.(c),r.getState().onSelectionChange.forEach(u=>u(c))},[t,o,e]),null});SelectionListener.displayName="SelectionListener";const changeSelector=e=>!!e.onSelectionChange;function Wrapper$1({onSelectionChange:e}){const r=useStore(changeSelector);return e||r?React.createElement(SelectionListener,{onSelectionChange:e}):null}const selector$d=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function useStoreUpdater(e,r){reactExports.useEffect(()=>{typeof e<"u"&&r(e)},[e])}function useDirectStoreUpdater(e,r,t){reactExports.useEffect(()=>{typeof r<"u"&&t({[e]:r})},[r])}const StoreUpdater=({nodes:e,edges:r,defaultNodes:t,defaultEdges:o,onConnect:c,onConnectStart:u,onConnectEnd:y,onClickConnectStart:f,onClickConnectEnd:g,nodesDraggable:_,nodesConnectable:p,nodesFocusable:S,edgesFocusable:A,edgesUpdatable:R,elevateNodesOnSelect:z,minZoom:l,maxZoom:s,nodeExtent:v,onNodesChange:w,onEdgesChange:E,elementsSelectable:C,connectionMode:h,snapGrid:x,snapToGrid:k,translateExtent:M,connectOnClick:D,defaultEdgeOptions:P,fitView:F,fitViewOptions:X,onNodesDelete:B,onEdgesDelete:L,onNodeDrag:H,onNodeDragStart:U,onNodeDragStop:Y,onSelectionDrag:W,onSelectionDragStart:q,onSelectionDragStop:G,noPanClassName:$,nodeOrigin:Z,rfId:xe,autoPanOnConnect:ce,autoPanOnNodeDrag:Ne,onError:Pe,connectionRadius:De,isValidConnection:Me,nodeDragThreshold:Be})=>{const{setNodes:ft,setEdges:Ot,setDefaultNodesAndEdges:Gt,setMinZoom:mt,setMaxZoom:je,setTranslateExtent:ht,setNodeExtent:Kt,reset:Jt}=useStore(selector$d,shallow$1),Wt=useStoreApi();return reactExports.useEffect(()=>{const Br=o?.map(zr=>({...zr,...P}));return Gt(t,Br),()=>{Jt()}},[]),useDirectStoreUpdater("defaultEdgeOptions",P,Wt.setState),useDirectStoreUpdater("connectionMode",h,Wt.setState),useDirectStoreUpdater("onConnect",c,Wt.setState),useDirectStoreUpdater("onConnectStart",u,Wt.setState),useDirectStoreUpdater("onConnectEnd",y,Wt.setState),useDirectStoreUpdater("onClickConnectStart",f,Wt.setState),useDirectStoreUpdater("onClickConnectEnd",g,Wt.setState),useDirectStoreUpdater("nodesDraggable",_,Wt.setState),useDirectStoreUpdater("nodesConnectable",p,Wt.setState),useDirectStoreUpdater("nodesFocusable",S,Wt.setState),useDirectStoreUpdater("edgesFocusable",A,Wt.setState),useDirectStoreUpdater("edgesUpdatable",R,Wt.setState),useDirectStoreUpdater("elementsSelectable",C,Wt.setState),useDirectStoreUpdater("elevateNodesOnSelect",z,Wt.setState),useDirectStoreUpdater("snapToGrid",k,Wt.setState),useDirectStoreUpdater("snapGrid",x,Wt.setState),useDirectStoreUpdater("onNodesChange",w,Wt.setState),useDirectStoreUpdater("onEdgesChange",E,Wt.setState),useDirectStoreUpdater("connectOnClick",D,Wt.setState),useDirectStoreUpdater("fitViewOnInit",F,Wt.setState),useDirectStoreUpdater("fitViewOnInitOptions",X,Wt.setState),useDirectStoreUpdater("onNodesDelete",B,Wt.setState),useDirectStoreUpdater("onEdgesDelete",L,Wt.setState),useDirectStoreUpdater("onNodeDrag",H,Wt.setState),useDirectStoreUpdater("onNodeDragStart",U,Wt.setState),useDirectStoreUpdater("onNodeDragStop",Y,Wt.setState),useDirectStoreUpdater("onSelectionDrag",W,Wt.setState),useDirectStoreUpdater("onSelectionDragStart",q,Wt.setState),useDirectStoreUpdater("onSelectionDragStop",G,Wt.setState),useDirectStoreUpdater("noPanClassName",$,Wt.setState),useDirectStoreUpdater("nodeOrigin",Z,Wt.setState),useDirectStoreUpdater("rfId",xe,Wt.setState),useDirectStoreUpdater("autoPanOnConnect",ce,Wt.setState),useDirectStoreUpdater("autoPanOnNodeDrag",Ne,Wt.setState),useDirectStoreUpdater("onError",Pe,Wt.setState),useDirectStoreUpdater("connectionRadius",De,Wt.setState),useDirectStoreUpdater("isValidConnection",Me,Wt.setState),useDirectStoreUpdater("nodeDragThreshold",Be,Wt.setState),useStoreUpdater(e,ft),useStoreUpdater(r,Ot),useStoreUpdater(l,mt),useStoreUpdater(s,je),useStoreUpdater(M,ht),useStoreUpdater(v,Kt),null},style={display:"none"},ariaLiveStyle={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ARIA_NODE_DESC_KEY="react-flow__node-desc",ARIA_EDGE_DESC_KEY="react-flow__edge-desc",ARIA_LIVE_MESSAGE="react-flow__aria-live",selector$c=e=>e.ariaLiveMessage;function AriaLiveMessage({rfId:e}){const r=useStore(selector$c);return React.createElement("div",{id:`${ARIA_LIVE_MESSAGE}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:ariaLiveStyle},r)}function A11yDescriptions({rfId:e,disableKeyboardA11y:r}){return React.createElement(React.Fragment,null,React.createElement("div",{id:`${ARIA_NODE_DESC_KEY}-${e}`,style},"Press enter or space to select a node.",!r&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),React.createElement("div",{id:`${ARIA_EDGE_DESC_KEY}-${e}`,style},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!r&&React.createElement(AriaLiveMessage,{rfId:e}))}var useKeyPress=(e=null,r={actInsideInputWithModifier:!0})=>{const[t,o]=reactExports.useState(!1),c=reactExports.useRef(!1),u=reactExports.useRef(new Set([])),[y,f]=reactExports.useMemo(()=>{if(e!==null){const _=(Array.isArray(e)?e:[e]).filter(S=>typeof S=="string").map(S=>S.split("+")),p=_.reduce((S,A)=>S.concat(...A),[]);return[_,p]}return[[],[]]},[e]);return reactExports.useEffect(()=>{const g=typeof document<"u"?document:null,_=r?.target||g;if(e!==null){const p=R=>{if(c.current=R.ctrlKey||R.metaKey||R.shiftKey,(!c.current||c.current&&!r.actInsideInputWithModifier)&&isInputDOMNode(R))return!1;const l=useKeyOrCode(R.code,f);u.current.add(R[l]),isMatchingKey(y,u.current,!1)&&(R.preventDefault(),o(!0))},S=R=>{if((!c.current||c.current&&!r.actInsideInputWithModifier)&&isInputDOMNode(R))return!1;const l=useKeyOrCode(R.code,f);isMatchingKey(y,u.current,!0)?(o(!1),u.current.clear()):u.current.delete(R[l]),R.key==="Meta"&&u.current.clear(),c.current=!1},A=()=>{u.current.clear(),o(!1)};return _?.addEventListener("keydown",p),_?.addEventListener("keyup",S),window.addEventListener("blur",A),()=>{_?.removeEventListener("keydown",p),_?.removeEventListener("keyup",S),window.removeEventListener("blur",A)}}},[e,o]),t};function isMatchingKey(e,r,t){return e.filter(o=>t||o.length===r.size).some(o=>o.every(c=>r.has(c)))}function useKeyOrCode(e,r){return r.includes(e)?"code":"key"}function calculateXYZPosition(e,r,t,o){const c=e.parentNode||e.parentId;if(!c)return t;const u=r.get(c),y=getNodePositionWithOrigin(u,o);return calculateXYZPosition(u,r,{x:(t.x??0)+y.x,y:(t.y??0)+y.y,z:(u[internalsSymbol]?.z??0)>(t.z??0)?u[internalsSymbol]?.z??0:t.z??0},o)}function updateAbsoluteNodePositions(e,r,t){e.forEach(o=>{const c=o.parentNode||o.parentId;if(c&&!e.has(c))throw new Error(`Parent node ${c} not found`);if(c||t?.[o.id]){const{x:u,y,z:f}=calculateXYZPosition(o,e,{...o.position,z:o[internalsSymbol]?.z??0},r);o.positionAbsolute={x:u,y},o[internalsSymbol].z=f,t?.[o.id]&&(o[internalsSymbol].isParent=!0)}})}function createNodeInternals(e,r,t,o){const c=new Map,u={},y=o?1e3:0;return e.forEach(f=>{const g=(isNumeric(f.zIndex)?f.zIndex:0)+(f.selected?y:0),_=r.get(f.id),p={...f,positionAbsolute:{x:f.position.x,y:f.position.y}},S=f.parentNode||f.parentId;S&&(u[S]=!0);const A=_?.type&&_?.type!==f.type;Object.defineProperty(p,internalsSymbol,{enumerable:!1,value:{handleBounds:A?void 0:_?.[internalsSymbol]?.handleBounds,z:g}}),c.set(f.id,p)}),updateAbsoluteNodePositions(c,t,u),c}function fitView(e,r={}){const{getNodes:t,width:o,height:c,minZoom:u,maxZoom:y,d3Zoom:f,d3Selection:g,fitViewOnInitDone:_,fitViewOnInit:p,nodeOrigin:S}=e(),A=r.initial&&!_&&p;if(f&&g&&(A||!r.initial)){const z=t().filter(s=>{const v=r.includeHiddenNodes?s.width&&s.height:!s.hidden;return r.nodes?.length?v&&r.nodes.some(w=>w.id===s.id):v}),l=z.every(s=>s.width&&s.height);if(z.length>0&&l){const s=getNodesBounds(z,S),{x:v,y:w,zoom:E}=getViewportForBounds(s,o,c,r.minZoom??u,r.maxZoom??y,r.padding??.1),C=identity.translate(v,w).scale(E);return typeof r.duration=="number"&&r.duration>0?f.transform(getD3Transition(g,r.duration),C):f.transform(g,C),!0}}return!1}function handleControlledNodeSelectionChange(e,r){return e.forEach(t=>{const o=r.get(t.id);o&&r.set(o.id,{...o,[internalsSymbol]:o[internalsSymbol],selected:t.selected})}),new Map(r)}function handleControlledEdgeSelectionChange(e,r){return r.map(t=>{const o=e.find(c=>c.id===t.id);return o&&(t.selected=o.selected),t})}function updateNodesAndEdgesSelections({changedNodes:e,changedEdges:r,get:t,set:o}){const{nodeInternals:c,edges:u,onNodesChange:y,onEdgesChange:f,hasDefaultNodes:g,hasDefaultEdges:_}=t();e?.length&&(g&&o({nodeInternals:handleControlledNodeSelectionChange(e,c)}),y?.(e)),r?.length&&(_&&o({edges:handleControlledEdgeSelectionChange(r,u)}),f?.(r))}const noop=()=>{},initialViewportHelper={zoomIn:noop,zoomOut:noop,zoomTo:noop,getZoom:()=>1,setViewport:noop,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:noop,fitBounds:noop,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},selector$b=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),useViewportHelper=()=>{const e=useStoreApi(),{d3Zoom:r,d3Selection:t}=useStore(selector$b,shallow$1);return reactExports.useMemo(()=>t&&r?{zoomIn:c=>r.scaleBy(getD3Transition(t,c?.duration),1.2),zoomOut:c=>r.scaleBy(getD3Transition(t,c?.duration),1/1.2),zoomTo:(c,u)=>r.scaleTo(getD3Transition(t,u?.duration),c),getZoom:()=>e.getState().transform[2],setViewport:(c,u)=>{const[y,f,g]=e.getState().transform,_=identity.translate(c.x??y,c.y??f).scale(c.zoom??g);r.transform(getD3Transition(t,u?.duration),_)},getViewport:()=>{const[c,u,y]=e.getState().transform;return{x:c,y:u,zoom:y}},fitView:c=>fitView(e.getState,c),setCenter:(c,u,y)=>{const{width:f,height:g,maxZoom:_}=e.getState(),p=typeof y?.zoom<"u"?y.zoom:_,S=f/2-c*p,A=g/2-u*p,R=identity.translate(S,A).scale(p);r.transform(getD3Transition(t,y?.duration),R)},fitBounds:(c,u)=>{const{width:y,height:f,minZoom:g,maxZoom:_}=e.getState(),{x:p,y:S,zoom:A}=getViewportForBounds(c,y,f,g,_,u?.padding??.1),R=identity.translate(p,S).scale(A);r.transform(getD3Transition(t,u?.duration),R)},project:c=>{const{transform:u,snapToGrid:y,snapGrid:f}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),pointToRendererPoint(c,u,y,f)},screenToFlowPosition:c=>{const{transform:u,snapToGrid:y,snapGrid:f,domNode:g}=e.getState();if(!g)return c;const{x:_,y:p}=g.getBoundingClientRect(),S={x:c.x-_,y:c.y-p};return pointToRendererPoint(S,u,y,f)},flowToScreenPosition:c=>{const{transform:u,domNode:y}=e.getState();if(!y)return c;const{x:f,y:g}=y.getBoundingClientRect(),_=rendererPointToPoint(c,u);return{x:_.x+f,y:_.y+g}},viewportInitialized:!0}:initialViewportHelper,[r,t])};function useReactFlow(){const e=useViewportHelper(),r=useStoreApi(),t=reactExports.useCallback(()=>r.getState().getNodes().map(l=>({...l})),[]),o=reactExports.useCallback(l=>r.getState().nodeInternals.get(l),[]),c=reactExports.useCallback(()=>{const{edges:l=[]}=r.getState();return l.map(s=>({...s}))},[]),u=reactExports.useCallback(l=>{const{edges:s=[]}=r.getState();return s.find(v=>v.id===l)},[]),y=reactExports.useCallback(l=>{const{getNodes:s,setNodes:v,hasDefaultNodes:w,onNodesChange:E}=r.getState(),C=s(),h=typeof l=="function"?l(C):l;if(w)v(h);else if(E){const x=h.length===0?C.map(k=>({type:"remove",id:k.id})):h.map(k=>({item:k,type:"reset"}));E(x)}},[]),f=reactExports.useCallback(l=>{const{edges:s=[],setEdges:v,hasDefaultEdges:w,onEdgesChange:E}=r.getState(),C=typeof l=="function"?l(s):l;if(w)v(C);else if(E){const h=C.length===0?s.map(x=>({type:"remove",id:x.id})):C.map(x=>({item:x,type:"reset"}));E(h)}},[]),g=reactExports.useCallback(l=>{const s=Array.isArray(l)?l:[l],{getNodes:v,setNodes:w,hasDefaultNodes:E,onNodesChange:C}=r.getState();if(E){const x=[...v(),...s];w(x)}else if(C){const h=s.map(x=>({item:x,type:"add"}));C(h)}},[]),_=reactExports.useCallback(l=>{const s=Array.isArray(l)?l:[l],{edges:v=[],setEdges:w,hasDefaultEdges:E,onEdgesChange:C}=r.getState();if(E)w([...v,...s]);else if(C){const h=s.map(x=>({item:x,type:"add"}));C(h)}},[]),p=reactExports.useCallback(()=>{const{getNodes:l,edges:s=[],transform:v}=r.getState(),[w,E,C]=v;return{nodes:l().map(h=>({...h})),edges:s.map(h=>({...h})),viewport:{x:w,y:E,zoom:C}}},[]),S=reactExports.useCallback(({nodes:l,edges:s})=>{const{nodeInternals:v,getNodes:w,edges:E,hasDefaultNodes:C,hasDefaultEdges:h,onNodesDelete:x,onEdgesDelete:k,onNodesChange:M,onEdgesChange:D}=r.getState(),P=(l||[]).map(H=>H.id),F=(s||[]).map(H=>H.id),X=w().reduce((H,U)=>{const Y=U.parentNode||U.parentId,W=!P.includes(U.id)&&Y&&H.find(G=>G.id===Y);return(typeof U.deletable=="boolean"?U.deletable:!0)&&(P.includes(U.id)||W)&&H.push(U),H},[]),B=E.filter(H=>typeof H.deletable=="boolean"?H.deletable:!0),L=B.filter(H=>F.includes(H.id));if(X||L){const H=getConnectedEdges(X,B),U=[...L,...H],Y=U.reduce((W,q)=>(W.includes(q.id)||W.push(q.id),W),[]);if((h||C)&&(h&&r.setState({edges:E.filter(W=>!Y.includes(W.id))}),C&&(X.forEach(W=>{v.delete(W.id)}),r.setState({nodeInternals:new Map(v)}))),Y.length>0&&(k?.(U),D&&D(Y.map(W=>({id:W,type:"remove"})))),X.length>0&&(x?.(X),M)){const W=X.map(q=>({id:q.id,type:"remove"}));M(W)}}},[]),A=reactExports.useCallback(l=>{const s=isRectObject(l),v=s?null:r.getState().nodeInternals.get(l.id);return!s&&!v?[null,null,s]:[s?l:nodeToRect(v),v,s]},[]),R=reactExports.useCallback((l,s=!0,v)=>{const[w,E,C]=A(l);return w?(v||r.getState().getNodes()).filter(h=>{if(!C&&(h.id===E.id||!h.positionAbsolute))return!1;const x=nodeToRect(h),k=getOverlappingArea(x,w);return s&&k>0||k>=w.width*w.height}):[]},[]),z=reactExports.useCallback((l,s,v=!0)=>{const[w]=A(l);if(!w)return!1;const E=getOverlappingArea(w,s);return v&&E>0||E>=w.width*w.height},[]);return reactExports.useMemo(()=>({...e,getNodes:t,getNode:o,getEdges:c,getEdge:u,setNodes:y,setEdges:f,addNodes:g,addEdges:_,toObject:p,deleteElements:S,getIntersectingNodes:R,isNodeIntersecting:z}),[e,t,o,c,u,y,f,g,_,p,S,R,z])}const deleteKeyOptions={actInsideInputWithModifier:!1};var useGlobalKeyHandler=({deleteKeyCode:e,multiSelectionKeyCode:r})=>{const t=useStoreApi(),{deleteElements:o}=useReactFlow(),c=useKeyPress(e,deleteKeyOptions),u=useKeyPress(r);reactExports.useEffect(()=>{if(c){const{edges:y,getNodes:f}=t.getState(),g=f().filter(p=>p.selected),_=y.filter(p=>p.selected);o({nodes:g,edges:_}),t.setState({nodesSelectionActive:!1})}},[c]),reactExports.useEffect(()=>{t.setState({multiSelectionActive:u})},[u])};function useResizeHandler(e){const r=useStoreApi();reactExports.useEffect(()=>{let t;const o=()=>{if(!e.current)return;const c=getDimensions(e.current);(c.height===0||c.width===0)&&r.getState().onError?.("004",errorMessages.error004()),r.setState({width:c.width||500,height:c.height||500})};return o(),window.addEventListener("resize",o),e.current&&(t=new ResizeObserver(()=>o()),t.observe(e.current)),()=>{window.removeEventListener("resize",o),t&&e.current&&t.unobserve(e.current)}},[])}const containerStyle={position:"absolute",width:"100%",height:"100%",top:0,left:0},viewChanged=(e,r)=>e.x!==r.x||e.y!==r.y||e.zoom!==r.k,eventToFlowTransform=e=>({x:e.x,y:e.y,zoom:e.k}),isWrappedWithClass=(e,r)=>e.target.closest(`.${r}`),isRightClickPan=(e,r)=>r===2&&Array.isArray(e)&&e.includes(2),wheelDelta=e=>{const r=e.ctrlKey&&isMacOs()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*r},selector$a=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),ZoomPane=({onMove:e,onMoveStart:r,onMoveEnd:t,onPaneContextMenu:o,zoomOnScroll:c=!0,zoomOnPinch:u=!0,panOnScroll:y=!1,panOnScrollSpeed:f=.5,panOnScrollMode:g=PanOnScrollMode.Free,zoomOnDoubleClick:_=!0,elementsSelectable:p,panOnDrag:S=!0,defaultViewport:A,translateExtent:R,minZoom:z,maxZoom:l,zoomActivationKeyCode:s,preventScrolling:v=!0,children:w,noWheelClassName:E,noPanClassName:C})=>{const h=reactExports.useRef(),x=useStoreApi(),k=reactExports.useRef(!1),M=reactExports.useRef(!1),D=reactExports.useRef(null),P=reactExports.useRef({x:0,y:0,zoom:0}),{d3Zoom:F,d3Selection:X,d3ZoomHandler:B,userSelectionActive:L}=useStore(selector$a,shallow$1),H=useKeyPress(s),U=reactExports.useRef(0),Y=reactExports.useRef(!1),W=reactExports.useRef();return useResizeHandler(D),reactExports.useEffect(()=>{if(D.current){const q=D.current.getBoundingClientRect(),G=zoom().scaleExtent([z,l]).translateExtent(R),$=select(D.current).call(G),Z=identity.translate(A.x,A.y).scale(clamp(A.zoom,z,l)),xe=[[0,0],[q.width,q.height]],ce=G.constrain()(Z,xe,R);G.transform($,ce),G.wheelDelta(wheelDelta),x.setState({d3Zoom:G,d3Selection:$,d3ZoomHandler:$.on("wheel.zoom"),transform:[ce.x,ce.y,ce.k],domNode:D.current.closest(".react-flow")})}},[]),reactExports.useEffect(()=>{X&&F&&(y&&!H&&!L?X.on("wheel.zoom",q=>{if(isWrappedWithClass(q,E))return!1;q.preventDefault(),q.stopImmediatePropagation();const G=X.property("__zoom").k||1;if(q.ctrlKey&&u){const Me=pointer(q),Be=wheelDelta(q),ft=G*Math.pow(2,Be);F.scaleTo(X,ft,Me,q);return}const $=q.deltaMode===1?20:1;let Z=g===PanOnScrollMode.Vertical?0:q.deltaX*$,xe=g===PanOnScrollMode.Horizontal?0:q.deltaY*$;!isMacOs()&&q.shiftKey&&g!==PanOnScrollMode.Vertical&&(Z=q.deltaY*$,xe=0),F.translateBy(X,-(Z/G)*f,-(xe/G)*f,{internal:!0});const ce=eventToFlowTransform(X.property("__zoom")),{onViewportChangeStart:Ne,onViewportChange:Pe,onViewportChangeEnd:De}=x.getState();clearTimeout(W.current),Y.current||(Y.current=!0,r?.(q,ce),Ne?.(ce)),Y.current&&(e?.(q,ce),Pe?.(ce),W.current=setTimeout(()=>{t?.(q,ce),De?.(ce),Y.current=!1},150))},{passive:!1}):typeof B<"u"&&X.on("wheel.zoom",function(q,G){if(!v&&q.type==="wheel"&&!q.ctrlKey||isWrappedWithClass(q,E))return null;q.preventDefault(),B.call(this,q,G)},{passive:!1}))},[L,y,g,X,F,B,H,u,v,E,r,e,t]),reactExports.useEffect(()=>{F&&F.on("start",q=>{if(!q.sourceEvent||q.sourceEvent.internal)return null;U.current=q.sourceEvent?.button;const{onViewportChangeStart:G}=x.getState(),$=eventToFlowTransform(q.transform);k.current=!0,P.current=$,q.sourceEvent?.type==="mousedown"&&x.setState({paneDragging:!0}),G?.($),r?.(q.sourceEvent,$)})},[F,r]),reactExports.useEffect(()=>{F&&(L&&!k.current?F.on("zoom",null):L||F.on("zoom",q=>{const{onViewportChange:G}=x.getState();if(x.setState({transform:[q.transform.x,q.transform.y,q.transform.k]}),M.current=!!(o&&isRightClickPan(S,U.current??0)),(e||G)&&!q.sourceEvent?.internal){const $=eventToFlowTransform(q.transform);G?.($),e?.(q.sourceEvent,$)}}))},[L,F,e,S,o]),reactExports.useEffect(()=>{F&&F.on("end",q=>{if(!q.sourceEvent||q.sourceEvent.internal)return null;const{onViewportChangeEnd:G}=x.getState();if(k.current=!1,x.setState({paneDragging:!1}),o&&isRightClickPan(S,U.current??0)&&!M.current&&o(q.sourceEvent),M.current=!1,(t||G)&&viewChanged(P.current,q.transform)){const $=eventToFlowTransform(q.transform);P.current=$,clearTimeout(h.current),h.current=setTimeout(()=>{G?.($),t?.(q.sourceEvent,$)},y?150:0)}})},[F,y,S,t,o]),reactExports.useEffect(()=>{F&&F.filter(q=>{const G=H||c,$=u&&q.ctrlKey;if((S===!0||Array.isArray(S)&&S.includes(1))&&q.button===1&&q.type==="mousedown"&&(isWrappedWithClass(q,"react-flow__node")||isWrappedWithClass(q,"react-flow__edge")))return!0;if(!S&&!G&&!y&&!_&&!u||L||!_&&q.type==="dblclick"||isWrappedWithClass(q,E)&&q.type==="wheel"||isWrappedWithClass(q,C)&&(q.type!=="wheel"||y&&q.type==="wheel"&&!H)||!u&&q.ctrlKey&&q.type==="wheel"||!G&&!y&&!$&&q.type==="wheel"||!S&&(q.type==="mousedown"||q.type==="touchstart")||Array.isArray(S)&&!S.includes(q.button)&&q.type==="mousedown")return!1;const Z=Array.isArray(S)&&S.includes(q.button)||!q.button||q.button<=1;return(!q.ctrlKey||q.type==="wheel")&&Z})},[L,F,c,u,y,_,S,p,H]),React.createElement("div",{className:"react-flow__renderer",ref:D,style:containerStyle},w)},selector$9=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function UserSelection(){const{userSelectionActive:e,userSelectionRect:r}=useStore(selector$9,shallow$1);return e&&r?React.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:r.width,height:r.height,transform:`translate(${r.x}px, ${r.y}px)`}}):null}function handleParentExpand(e,r){const t=r.parentNode||r.parentId,o=e.find(c=>c.id===t);if(o){const c=r.position.x+r.width-o.width,u=r.position.y+r.height-o.height;if(c>0||u>0||r.position.x<0||r.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,c>0&&(o.style.width+=c),u>0&&(o.style.height+=u),r.position.x<0){const y=Math.abs(r.position.x);o.position.x=o.position.x-y,o.style.width+=y,r.position.x=0}if(r.position.y<0){const y=Math.abs(r.position.y);o.position.y=o.position.y-y,o.style.height+=y,r.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function applyChanges(e,r){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const t=e.filter(o=>o.type==="add").map(o=>o.item);return r.reduce((o,c)=>{const u=e.filter(f=>f.id===c.id);if(u.length===0)return o.push(c),o;const y={...c};for(const f of u)if(f)switch(f.type){case"select":{y.selected=f.selected;break}case"position":{typeof f.position<"u"&&(y.position=f.position),typeof f.positionAbsolute<"u"&&(y.positionAbsolute=f.positionAbsolute),typeof f.dragging<"u"&&(y.dragging=f.dragging),y.expandParent&&handleParentExpand(o,y);break}case"dimensions":{typeof f.dimensions<"u"&&(y.width=f.dimensions.width,y.height=f.dimensions.height),typeof f.updateStyle<"u"&&(y.style={...y.style||{},...f.dimensions}),typeof f.resizing=="boolean"&&(y.resizing=f.resizing),y.expandParent&&handleParentExpand(o,y);break}case"remove":return o}return o.push(y),o},t)}function applyNodeChanges(e,r){return applyChanges(e,r)}function applyEdgeChanges(e,r){return applyChanges(e,r)}const createSelectionChange=(e,r)=>({id:e,type:"select",selected:r});function getSelectionChanges(e,r){return e.reduce((t,o)=>{const c=r.includes(o.id);return!o.selected&&c?(o.selected=!0,t.push(createSelectionChange(o.id,!0))):o.selected&&!c&&(o.selected=!1,t.push(createSelectionChange(o.id,!1))),t},[])}const wrapHandler=(e,r)=>t=>{t.target===r.current&&e?.(t)},selector$8=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Pane=reactExports.memo(({isSelecting:e,selectionMode:r=SelectionMode.Full,panOnDrag:t,onSelectionStart:o,onSelectionEnd:c,onPaneClick:u,onPaneContextMenu:y,onPaneScroll:f,onPaneMouseEnter:g,onPaneMouseMove:_,onPaneMouseLeave:p,children:S})=>{const A=reactExports.useRef(null),R=useStoreApi(),z=reactExports.useRef(0),l=reactExports.useRef(0),s=reactExports.useRef(),{userSelectionActive:v,elementsSelectable:w,dragging:E}=useStore(selector$8,shallow$1),C=()=>{R.setState({userSelectionActive:!1,userSelectionRect:null}),z.current=0,l.current=0},h=B=>{u?.(B),R.getState().resetSelectedElements(),R.setState({nodesSelectionActive:!1})},x=B=>{if(Array.isArray(t)&&t?.includes(2)){B.preventDefault();return}y?.(B)},k=f?B=>f(B):void 0,M=B=>{const{resetSelectedElements:L,domNode:H}=R.getState();if(s.current=H?.getBoundingClientRect(),!w||!e||B.button!==0||B.target!==A.current||!s.current)return;const{x:U,y:Y}=getEventPosition(B,s.current);L(),R.setState({userSelectionRect:{width:0,height:0,startX:U,startY:Y,x:U,y:Y}}),o?.(B)},D=B=>{const{userSelectionRect:L,nodeInternals:H,edges:U,transform:Y,onNodesChange:W,onEdgesChange:q,nodeOrigin:G,getNodes:$}=R.getState();if(!e||!s.current||!L)return;R.setState({userSelectionActive:!0,nodesSelectionActive:!1});const Z=getEventPosition(B,s.current),xe=L.startX??0,ce=L.startY??0,Ne={...L,x:Z.x<xe?Z.x:xe,y:Z.y<ce?Z.y:ce,width:Math.abs(Z.x-xe),height:Math.abs(Z.y-ce)},Pe=$(),De=getNodesInside(H,Ne,Y,r===SelectionMode.Partial,!0,G),Me=getConnectedEdges(De,U).map(ft=>ft.id),Be=De.map(ft=>ft.id);if(z.current!==Be.length){z.current=Be.length;const ft=getSelectionChanges(Pe,Be);ft.length&&W?.(ft)}if(l.current!==Me.length){l.current=Me.length;const ft=getSelectionChanges(U,Me);ft.length&&q?.(ft)}R.setState({userSelectionRect:Ne})},P=B=>{if(B.button!==0)return;const{userSelectionRect:L}=R.getState();!v&&L&&B.target===A.current&&h?.(B),R.setState({nodesSelectionActive:z.current>0}),C(),c?.(B)},F=B=>{v&&(R.setState({nodesSelectionActive:z.current>0}),c?.(B)),C()},X=w&&(e||v);return React.createElement("div",{className:cc(["react-flow__pane",{dragging:E,selection:e}]),onClick:X?void 0:wrapHandler(h,A),onContextMenu:wrapHandler(x,A),onWheel:wrapHandler(k,A),onMouseEnter:X?void 0:g,onMouseDown:X?M:void 0,onMouseMove:X?D:_,onMouseUp:X?P:void 0,onMouseLeave:X?F:p,ref:A,style:containerStyle},S,React.createElement(UserSelection,null))});Pane.displayName="Pane";function isParentSelected(e,r){const t=e.parentNode||e.parentId;if(!t)return!1;const o=r.get(t);return o?o.selected?!0:isParentSelected(o,r):!1}function hasSelector(e,r,t){let o=e;do{if(o?.matches(r))return!0;if(o===t.current)return!1;o=o.parentElement}while(o);return!1}function getDragItems(e,r,t,o){return Array.from(e.values()).filter(c=>(c.selected||c.id===o)&&(!c.parentNode||c.parentId||!isParentSelected(c,e))&&(c.draggable||r&&typeof c.draggable>"u")).map(c=>({id:c.id,position:c.position||{x:0,y:0},positionAbsolute:c.positionAbsolute||{x:0,y:0},distance:{x:t.x-(c.positionAbsolute?.x??0),y:t.y-(c.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:c.extent,parentNode:c.parentNode||c.parentId,parentId:c.parentNode||c.parentId,width:c.width,height:c.height,expandParent:c.expandParent}))}function clampNodeExtent(e,r){return!r||r==="parent"?r:[r[0],[r[1][0]-(e.width||0),r[1][1]-(e.height||0)]]}function calcNextPosition(e,r,t,o,c=[0,0],u){const y=clampNodeExtent(e,e.extent||o);let f=y;const g=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(g&&e.width&&e.height){const S=t.get(g),{x:A,y:R}=getNodePositionWithOrigin(S,c).positionAbsolute;f=S&&isNumeric(A)&&isNumeric(R)&&isNumeric(S.width)&&isNumeric(S.height)?[[A+e.width*c[0],R+e.height*c[1]],[A+S.width-e.width+e.width*c[0],R+S.height-e.height+e.height*c[1]]]:f}else u?.("005",errorMessages.error005()),f=y;else if(e.extent&&g&&e.extent!=="parent"){const S=t.get(g),{x:A,y:R}=getNodePositionWithOrigin(S,c).positionAbsolute;f=[[e.extent[0][0]+A,e.extent[0][1]+R],[e.extent[1][0]+A,e.extent[1][1]+R]]}let _={x:0,y:0};if(g){const S=t.get(g);_=getNodePositionWithOrigin(S,c).positionAbsolute}const p=f&&f!=="parent"?clampPosition(r,f):r;return{position:{x:p.x-_.x,y:p.y-_.y},positionAbsolute:p}}function getEventHandlerParams({nodeId:e,dragItems:r,nodeInternals:t}){const o=r.map(c=>({...t.get(c.id),position:c.position,positionAbsolute:c.positionAbsolute}));return[e?o.find(c=>c.id===e):o[0],o]}const getHandleBounds=(e,r,t,o)=>{const c=r.querySelectorAll(e);if(!c||!c.length)return null;const u=Array.from(c),y=r.getBoundingClientRect(),f={x:y.width*o[0],y:y.height*o[1]};return u.map(g=>{const _=g.getBoundingClientRect();return{id:g.getAttribute("data-handleid"),position:g.getAttribute("data-handlepos"),x:(_.left-y.left-f.x)/t,y:(_.top-y.top-f.y)/t,...getDimensions(g)}})};function getMouseHandler(e,r,t){return t===void 0?t:o=>{const c=r().nodeInternals.get(e);c&&t(o,{...c})}}function handleNodeClick({id:e,store:r,unselect:t=!1,nodeRef:o}){const{addSelectedNodes:c,unselectNodesAndEdges:u,multiSelectionActive:y,nodeInternals:f,onError:g}=r.getState(),_=f.get(e);if(!_){g?.("012",errorMessages.error012(e));return}r.setState({nodesSelectionActive:!1}),_.selected?(t||_.selected&&y)&&(u({nodes:[_],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):c([e])}function useGetPointerPosition(){const e=useStoreApi();return reactExports.useCallback(({sourceEvent:t})=>{const{transform:o,snapGrid:c,snapToGrid:u}=e.getState(),y=t.touches?t.touches[0].clientX:t.clientX,f=t.touches?t.touches[0].clientY:t.clientY,g={x:(y-o[0])/o[2],y:(f-o[1])/o[2]};return{xSnapped:u?c[0]*Math.round(g.x/c[0]):g.x,ySnapped:u?c[1]*Math.round(g.y/c[1]):g.y,...g}},[])}function wrapSelectionDragFunc(e){return(r,t,o)=>e?.(r,o)}function useDrag({nodeRef:e,disabled:r=!1,noDragClassName:t,handleSelector:o,nodeId:c,isSelectable:u,selectNodesOnDrag:y}){const f=useStoreApi(),[g,_]=reactExports.useState(!1),p=reactExports.useRef([]),S=reactExports.useRef({x:null,y:null}),A=reactExports.useRef(0),R=reactExports.useRef(null),z=reactExports.useRef({x:0,y:0}),l=reactExports.useRef(null),s=reactExports.useRef(!1),v=reactExports.useRef(!1),w=reactExports.useRef(!1),E=useGetPointerPosition();return reactExports.useEffect(()=>{if(e?.current){const C=select(e.current),h=({x:M,y:D})=>{const{nodeInternals:P,onNodeDrag:F,onSelectionDrag:X,updateNodePositions:B,nodeExtent:L,snapGrid:H,snapToGrid:U,nodeOrigin:Y,onError:W}=f.getState();S.current={x:M,y:D};let q=!1,G={x:0,y:0,x2:0,y2:0};if(p.current.length>1&&L){const Z=getNodesBounds(p.current,Y);G=rectToBox(Z)}if(p.current=p.current.map(Z=>{const xe={x:M-Z.distance.x,y:D-Z.distance.y};U&&(xe.x=H[0]*Math.round(xe.x/H[0]),xe.y=H[1]*Math.round(xe.y/H[1]));const ce=[[L[0][0],L[0][1]],[L[1][0],L[1][1]]];p.current.length>1&&L&&!Z.extent&&(ce[0][0]=Z.positionAbsolute.x-G.x+L[0][0],ce[1][0]=Z.positionAbsolute.x+(Z.width??0)-G.x2+L[1][0],ce[0][1]=Z.positionAbsolute.y-G.y+L[0][1],ce[1][1]=Z.positionAbsolute.y+(Z.height??0)-G.y2+L[1][1]);const Ne=calcNextPosition(Z,xe,P,ce,Y,W);return q=q||Z.position.x!==Ne.position.x||Z.position.y!==Ne.position.y,Z.position=Ne.position,Z.positionAbsolute=Ne.positionAbsolute,Z}),!q)return;B(p.current,!0,!0),_(!0);const $=c?F:wrapSelectionDragFunc(X);if($&&l.current){const[Z,xe]=getEventHandlerParams({nodeId:c,dragItems:p.current,nodeInternals:P});$(l.current,Z,xe)}},x=()=>{if(!R.current)return;const[M,D]=calcAutoPan(z.current,R.current);if(M!==0||D!==0){const{transform:P,panBy:F}=f.getState();S.current.x=(S.current.x??0)-M/P[2],S.current.y=(S.current.y??0)-D/P[2],F({x:M,y:D})&&h(S.current)}A.current=requestAnimationFrame(x)},k=M=>{const{nodeInternals:D,multiSelectionActive:P,nodesDraggable:F,unselectNodesAndEdges:X,onNodeDragStart:B,onSelectionDragStart:L}=f.getState();v.current=!0;const H=c?B:wrapSelectionDragFunc(L);(!y||!u)&&!P&&c&&(D.get(c)?.selected||X()),c&&u&&y&&handleNodeClick({id:c,store:f,nodeRef:e});const U=E(M);if(S.current=U,p.current=getDragItems(D,F,U,c),H&&p.current){const[Y,W]=getEventHandlerParams({nodeId:c,dragItems:p.current,nodeInternals:D});H(M.sourceEvent,Y,W)}};if(r)C.on(".drag",null);else{const M=drag().on("start",D=>{const{domNode:P,nodeDragThreshold:F}=f.getState();F===0&&k(D),w.current=!1;const X=E(D);S.current=X,R.current=P?.getBoundingClientRect()||null,z.current=getEventPosition(D.sourceEvent,R.current)}).on("drag",D=>{const P=E(D),{autoPanOnNodeDrag:F,nodeDragThreshold:X}=f.getState();if(D.sourceEvent.type==="touchmove"&&D.sourceEvent.touches.length>1&&(w.current=!0),!w.current){if(!s.current&&v.current&&F&&(s.current=!0,x()),!v.current){const B=P.xSnapped-(S?.current?.x??0),L=P.ySnapped-(S?.current?.y??0);Math.sqrt(B*B+L*L)>X&&k(D)}(S.current.x!==P.xSnapped||S.current.y!==P.ySnapped)&&p.current&&v.current&&(l.current=D.sourceEvent,z.current=getEventPosition(D.sourceEvent,R.current),h(P))}}).on("end",D=>{if(!(!v.current||w.current)&&(_(!1),s.current=!1,v.current=!1,cancelAnimationFrame(A.current),p.current)){const{updateNodePositions:P,nodeInternals:F,onNodeDragStop:X,onSelectionDragStop:B}=f.getState(),L=c?X:wrapSelectionDragFunc(B);if(P(p.current,!1,!1),L){const[H,U]=getEventHandlerParams({nodeId:c,dragItems:p.current,nodeInternals:F});L(D.sourceEvent,H,U)}}}).filter(D=>{const P=D.target;return!D.button&&(!t||!hasSelector(P,`.${t}`,e))&&(!o||hasSelector(P,o,e))});return C.call(M),()=>{C.on(".drag",null)}}}},[e,r,t,o,u,f,c,y,E]),g}function useUpdateNodePositions(){const e=useStoreApi();return reactExports.useCallback(t=>{const{nodeInternals:o,nodeExtent:c,updateNodePositions:u,getNodes:y,snapToGrid:f,snapGrid:g,onError:_,nodesDraggable:p}=e.getState(),S=y().filter(w=>w.selected&&(w.draggable||p&&typeof w.draggable>"u")),A=f?g[0]:5,R=f?g[1]:5,z=t.isShiftPressed?4:1,l=t.x*A*z,s=t.y*R*z,v=S.map(w=>{if(w.positionAbsolute){const E={x:w.positionAbsolute.x+l,y:w.positionAbsolute.y+s};f&&(E.x=g[0]*Math.round(E.x/g[0]),E.y=g[1]*Math.round(E.y/g[1]));const{positionAbsolute:C,position:h}=calcNextPosition(w,E,o,c,void 0,_);w.position=h,w.positionAbsolute=C}return w});u(v,!0,!1)},[])}const arrowKeyDiffs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var wrapNode=e=>{const r=({id:t,type:o,data:c,xPos:u,yPos:y,xPosOrigin:f,yPosOrigin:g,selected:_,onClick:p,onMouseEnter:S,onMouseMove:A,onMouseLeave:R,onContextMenu:z,onDoubleClick:l,style:s,className:v,isDraggable:w,isSelectable:E,isConnectable:C,isFocusable:h,selectNodesOnDrag:x,sourcePosition:k,targetPosition:M,hidden:D,resizeObserver:P,dragHandle:F,zIndex:X,isParent:B,noDragClassName:L,noPanClassName:H,initialized:U,disableKeyboardA11y:Y,ariaLabel:W,rfId:q,hasHandleBounds:G})=>{const $=useStoreApi(),Z=reactExports.useRef(null),xe=reactExports.useRef(null),ce=reactExports.useRef(k),Ne=reactExports.useRef(M),Pe=reactExports.useRef(o),De=E||w||p||S||A||R,Me=useUpdateNodePositions(),Be=getMouseHandler(t,$.getState,S),ft=getMouseHandler(t,$.getState,A),Ot=getMouseHandler(t,$.getState,R),Gt=getMouseHandler(t,$.getState,z),mt=getMouseHandler(t,$.getState,l),je=Jt=>{const{nodeDragThreshold:Wt}=$.getState();if(E&&(!x||!w||Wt>0)&&handleNodeClick({id:t,store:$,nodeRef:Z}),p){const Br=$.getState().nodeInternals.get(t);Br&&p(Jt,{...Br})}},ht=Jt=>{if(!isInputDOMNode(Jt)&&!Y)if(elementSelectionKeys.includes(Jt.key)&&E){const Wt=Jt.key==="Escape";handleNodeClick({id:t,store:$,unselect:Wt,nodeRef:Z})}else w&&_&&Object.prototype.hasOwnProperty.call(arrowKeyDiffs,Jt.key)&&($.setState({ariaLiveMessage:`Moved selected node ${Jt.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~u}, y: ${~~y}`}),Me({x:arrowKeyDiffs[Jt.key].x,y:arrowKeyDiffs[Jt.key].y,isShiftPressed:Jt.shiftKey}))};reactExports.useEffect(()=>()=>{xe.current&&(P?.unobserve(xe.current),xe.current=null)},[]),reactExports.useEffect(()=>{if(Z.current&&!D){const Jt=Z.current;(!U||!G||xe.current!==Jt)&&(xe.current&&P?.unobserve(xe.current),P?.observe(Jt),xe.current=Jt)}},[D,U,G]),reactExports.useEffect(()=>{const Jt=Pe.current!==o,Wt=ce.current!==k,Br=Ne.current!==M;Z.current&&(Jt||Wt||Br)&&(Jt&&(Pe.current=o),Wt&&(ce.current=k),Br&&(Ne.current=M),$.getState().updateNodeDimensions([{id:t,nodeElement:Z.current,forceUpdate:!0}]))},[t,o,k,M]);const Kt=useDrag({nodeRef:Z,disabled:D||!w,noDragClassName:L,handleSelector:F,nodeId:t,isSelectable:E,selectNodesOnDrag:x});return D?null:React.createElement("div",{className:cc(["react-flow__node",`react-flow__node-${o}`,{[H]:w},v,{selected:_,selectable:E,parent:B,dragging:Kt}]),ref:Z,style:{zIndex:X,transform:`translate(${f}px,${g}px)`,pointerEvents:De?"all":"none",visibility:U?"visible":"hidden",...s},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:Be,onMouseMove:ft,onMouseLeave:Ot,onContextMenu:Gt,onClick:je,onDoubleClick:mt,onKeyDown:h?ht:void 0,tabIndex:h?0:void 0,role:h?"button":void 0,"aria-describedby":Y?void 0:`${ARIA_NODE_DESC_KEY}-${q}`,"aria-label":W},React.createElement(Provider$2,{value:t},React.createElement(e,{id:t,data:c,type:o,xPos:u,yPos:y,selected:_,isConnectable:C,sourcePosition:k,targetPosition:M,dragging:Kt,dragHandle:F,zIndex:X})))};return r.displayName="NodeWrapper",reactExports.memo(r)};const selector$7=e=>{const r=e.getNodes().filter(t=>t.selected);return{...getNodesBounds(r,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function NodesSelection({onSelectionContextMenu:e,noPanClassName:r,disableKeyboardA11y:t}){const o=useStoreApi(),{width:c,height:u,x:y,y:f,transformString:g,userSelectionActive:_}=useStore(selector$7,shallow$1),p=useUpdateNodePositions(),S=reactExports.useRef(null);if(reactExports.useEffect(()=>{t||S.current?.focus({preventScroll:!0})},[t]),useDrag({nodeRef:S}),_||!c||!u)return null;const A=e?z=>{const l=o.getState().getNodes().filter(s=>s.selected);e(z,l)}:void 0,R=z=>{Object.prototype.hasOwnProperty.call(arrowKeyDiffs,z.key)&&p({x:arrowKeyDiffs[z.key].x,y:arrowKeyDiffs[z.key].y,isShiftPressed:z.shiftKey})};return React.createElement("div",{className:cc(["react-flow__nodesselection","react-flow__container",r]),style:{transform:g}},React.createElement("div",{ref:S,className:"react-flow__nodesselection-rect",onContextMenu:A,tabIndex:t?void 0:-1,onKeyDown:t?void 0:R,style:{width:c,height:u,top:f,left:y}}))}var NodesSelection$1=reactExports.memo(NodesSelection);const selector$6=e=>e.nodesSelectionActive,FlowRenderer=({children:e,onPaneClick:r,onPaneMouseEnter:t,onPaneMouseMove:o,onPaneMouseLeave:c,onPaneContextMenu:u,onPaneScroll:y,deleteKeyCode:f,onMove:g,onMoveStart:_,onMoveEnd:p,selectionKeyCode:S,selectionOnDrag:A,selectionMode:R,onSelectionStart:z,onSelectionEnd:l,multiSelectionKeyCode:s,panActivationKeyCode:v,zoomActivationKeyCode:w,elementsSelectable:E,zoomOnScroll:C,zoomOnPinch:h,panOnScroll:x,panOnScrollSpeed:k,panOnScrollMode:M,zoomOnDoubleClick:D,panOnDrag:P,defaultViewport:F,translateExtent:X,minZoom:B,maxZoom:L,preventScrolling:H,onSelectionContextMenu:U,noWheelClassName:Y,noPanClassName:W,disableKeyboardA11y:q})=>{const G=useStore(selector$6),$=useKeyPress(S),Z=useKeyPress(v),xe=Z||P,ce=Z||x,Ne=$||A&&xe!==!0;return useGlobalKeyHandler({deleteKeyCode:f,multiSelectionKeyCode:s}),React.createElement(ZoomPane,{onMove:g,onMoveStart:_,onMoveEnd:p,onPaneContextMenu:u,elementsSelectable:E,zoomOnScroll:C,zoomOnPinch:h,panOnScroll:ce,panOnScrollSpeed:k,panOnScrollMode:M,zoomOnDoubleClick:D,panOnDrag:!$&&xe,defaultViewport:F,translateExtent:X,minZoom:B,maxZoom:L,zoomActivationKeyCode:w,preventScrolling:H,noWheelClassName:Y,noPanClassName:W},React.createElement(Pane,{onSelectionStart:z,onSelectionEnd:l,onPaneClick:r,onPaneMouseEnter:t,onPaneMouseMove:o,onPaneMouseLeave:c,onPaneContextMenu:u,onPaneScroll:y,panOnDrag:xe,isSelecting:!!Ne,selectionMode:R},e,G&&React.createElement(NodesSelection$1,{onSelectionContextMenu:U,noPanClassName:W,disableKeyboardA11y:q})))};FlowRenderer.displayName="FlowRenderer";var FlowRenderer$1=reactExports.memo(FlowRenderer);function useVisibleNodes(e){return useStore(reactExports.useCallback(t=>e?getNodesInside(t.nodeInternals,{x:0,y:0,width:t.width,height:t.height},t.transform,!0):t.getNodes(),[e]))}function createNodeTypes(e){const r={input:wrapNode(e.input||InputNode$1),default:wrapNode(e.default||DefaultNode$1),output:wrapNode(e.output||OutputNode$1),group:wrapNode(e.group||GroupNode)},t={},o=Object.keys(e).filter(c=>!["input","default","output","group"].includes(c)).reduce((c,u)=>(c[u]=wrapNode(e[u]||DefaultNode$1),c),t);return{...r,...o}}const getPositionWithOrigin=({x:e,y:r,width:t,height:o,origin:c})=>!t||!o?{x:e,y:r}:c[0]<0||c[1]<0||c[0]>1||c[1]>1?{x:e,y:r}:{x:e-t*c[0],y:r-o*c[1]},selector$5=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),NodeRenderer=e=>{const{nodesDraggable:r,nodesConnectable:t,nodesFocusable:o,elementsSelectable:c,updateNodeDimensions:u,onError:y}=useStore(selector$5,shallow$1),f=useVisibleNodes(e.onlyRenderVisibleElements),g=reactExports.useRef(),_=reactExports.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const p=new ResizeObserver(S=>{const A=S.map(R=>({id:R.target.getAttribute("data-id"),nodeElement:R.target,forceUpdate:!0}));u(A)});return g.current=p,p},[]);return reactExports.useEffect(()=>()=>{g?.current?.disconnect()},[]),React.createElement("div",{className:"react-flow__nodes",style:containerStyle},f.map(p=>{let S=p.type||"default";e.nodeTypes[S]||(y?.("003",errorMessages.error003(S)),S="default");const A=e.nodeTypes[S]||e.nodeTypes.default,R=!!(p.draggable||r&&typeof p.draggable>"u"),z=!!(p.selectable||c&&typeof p.selectable>"u"),l=!!(p.connectable||t&&typeof p.connectable>"u"),s=!!(p.focusable||o&&typeof p.focusable>"u"),v=e.nodeExtent?clampPosition(p.positionAbsolute,e.nodeExtent):p.positionAbsolute,w=v?.x??0,E=v?.y??0,C=getPositionWithOrigin({x:w,y:E,width:p.width??0,height:p.height??0,origin:e.nodeOrigin});return React.createElement(A,{key:p.id,id:p.id,className:p.className,style:p.style,type:S,data:p.data,sourcePosition:p.sourcePosition||Position.Bottom,targetPosition:p.targetPosition||Position.Top,hidden:p.hidden,xPos:w,yPos:E,xPosOrigin:C.x,yPosOrigin:C.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!p.selected,isDraggable:R,isSelectable:z,isConnectable:l,isFocusable:s,resizeObserver:_,dragHandle:p.dragHandle,zIndex:p[internalsSymbol]?.z??0,isParent:!!p[internalsSymbol]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!p.width&&!!p.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:p.ariaLabel,hasHandleBounds:!!p[internalsSymbol]?.handleBounds})}))};NodeRenderer.displayName="NodeRenderer";var NodeRenderer$1=reactExports.memo(NodeRenderer);const shiftX=(e,r,t)=>t===Position.Left?e-r:t===Position.Right?e+r:e,shiftY=(e,r,t)=>t===Position.Top?e-r:t===Position.Bottom?e+r:e,EdgeUpdaterClassName="react-flow__edgeupdater",EdgeAnchor=({position:e,centerX:r,centerY:t,radius:o=10,onMouseDown:c,onMouseEnter:u,onMouseOut:y,type:f})=>React.createElement("circle",{onMouseDown:c,onMouseEnter:u,onMouseOut:y,className:cc([EdgeUpdaterClassName,`${EdgeUpdaterClassName}-${f}`]),cx:shiftX(r,o,e),cy:shiftY(t,o,e),r:o,stroke:"transparent",fill:"transparent"}),alwaysValidConnection=()=>!0;var wrapEdge=e=>{const r=({id:t,className:o,type:c,data:u,onClick:y,onEdgeDoubleClick:f,selected:g,animated:_,label:p,labelStyle:S,labelShowBg:A,labelBgStyle:R,labelBgPadding:z,labelBgBorderRadius:l,style:s,source:v,target:w,sourceX:E,sourceY:C,targetX:h,targetY:x,sourcePosition:k,targetPosition:M,elementsSelectable:D,hidden:P,sourceHandleId:F,targetHandleId:X,onContextMenu:B,onMouseEnter:L,onMouseMove:H,onMouseLeave:U,reconnectRadius:Y,onReconnect:W,onReconnectStart:q,onReconnectEnd:G,markerEnd:$,markerStart:Z,rfId:xe,ariaLabel:ce,isFocusable:Ne,isReconnectable:Pe,pathOptions:De,interactionWidth:Me,disableKeyboardA11y:Be})=>{const ft=reactExports.useRef(null),[Ot,Gt]=reactExports.useState(!1),[mt,je]=reactExports.useState(!1),ht=useStoreApi(),Kt=reactExports.useMemo(()=>`url('#${getMarkerId(Z,xe)}')`,[Z,xe]),Jt=reactExports.useMemo(()=>`url('#${getMarkerId($,xe)}')`,[$,xe]);if(P)return null;const Wt=rt=>{const{edges:Yt,addSelectedEdges:jt,unselectNodesAndEdges:re,multiSelectionActive:tt}=ht.getState(),lt=Yt.find(ar=>ar.id===t);lt&&(D&&(ht.setState({nodesSelectionActive:!1}),lt.selected&&tt?(re({nodes:[],edges:[lt]}),ft.current?.blur()):jt([t])),y&&y(rt,lt))},Br=getMouseHandler$1(t,ht.getState,f),zr=getMouseHandler$1(t,ht.getState,B),cr=getMouseHandler$1(t,ht.getState,L),Nr=getMouseHandler$1(t,ht.getState,H),At=getMouseHandler$1(t,ht.getState,U),Mt=(rt,Yt)=>{if(rt.button!==0)return;const{edges:jt,isValidConnection:re}=ht.getState(),tt=Yt?w:v,lt=(Yt?X:F)||null,ar=Yt?"target":"source",et=re||alwaysValidConnection,Ft=Yt,se=jt.find(J=>J.id===t);je(!0),q?.(rt,se,ar);const xt=J=>{je(!1),G?.(J,se,ar)};handlePointerDown({event:rt,handleId:lt,nodeId:tt,onConnect:J=>W?.(se,J),isTarget:Ft,getState:ht.getState,setState:ht.setState,isValidConnection:et,edgeUpdaterType:ar,onReconnectEnd:xt})},Jr=rt=>Mt(rt,!0),Yr=rt=>Mt(rt,!1),ie=()=>Gt(!0),ve=()=>Gt(!1),we=!D&&!y,it=rt=>{if(!Be&&elementSelectionKeys.includes(rt.key)&&D){const{unselectNodesAndEdges:Yt,addSelectedEdges:jt,edges:re}=ht.getState();rt.key==="Escape"?(ft.current?.blur(),Yt({edges:[re.find(lt=>lt.id===t)]})):jt([t])}};return React.createElement("g",{className:cc(["react-flow__edge",`react-flow__edge-${c}`,o,{selected:g,animated:_,inactive:we,updating:Ot}]),onClick:Wt,onDoubleClick:Br,onContextMenu:zr,onMouseEnter:cr,onMouseMove:Nr,onMouseLeave:At,onKeyDown:Ne?it:void 0,tabIndex:Ne?0:void 0,role:Ne?"button":"img","data-testid":`rf__edge-${t}`,"aria-label":ce===null?void 0:ce||`Edge from ${v} to ${w}`,"aria-describedby":Ne?`${ARIA_EDGE_DESC_KEY}-${xe}`:void 0,ref:ft},!mt&&React.createElement(e,{id:t,source:v,target:w,selected:g,animated:_,label:p,labelStyle:S,labelShowBg:A,labelBgStyle:R,labelBgPadding:z,labelBgBorderRadius:l,data:u,style:s,sourceX:E,sourceY:C,targetX:h,targetY:x,sourcePosition:k,targetPosition:M,sourceHandleId:F,targetHandleId:X,markerStart:Kt,markerEnd:Jt,pathOptions:De,interactionWidth:Me}),Pe&&React.createElement(React.Fragment,null,(Pe==="source"||Pe===!0)&&React.createElement(EdgeAnchor,{position:k,centerX:E,centerY:C,radius:Y,onMouseDown:Jr,onMouseEnter:ie,onMouseOut:ve,type:"source"}),(Pe==="target"||Pe===!0)&&React.createElement(EdgeAnchor,{position:M,centerX:h,centerY:x,radius:Y,onMouseDown:Yr,onMouseEnter:ie,onMouseOut:ve,type:"target"})))};return r.displayName="EdgeWrapper",reactExports.memo(r)};function createEdgeTypes(e){const r={default:wrapEdge(e.default||BezierEdge),straight:wrapEdge(e.bezier||StraightEdge),step:wrapEdge(e.step||StepEdge),smoothstep:wrapEdge(e.step||SmoothStepEdge),simplebezier:wrapEdge(e.simplebezier||SimpleBezierEdge)},t={},o=Object.keys(e).filter(c=>!["default","bezier"].includes(c)).reduce((c,u)=>(c[u]=wrapEdge(e[u]||BezierEdge),c),t);return{...r,...o}}function getHandlePosition(e,r,t=null){const o=(t?.x||0)+r.x,c=(t?.y||0)+r.y,u=t?.width||r.width,y=t?.height||r.height;switch(e){case Position.Top:return{x:o+u/2,y:c};case Position.Right:return{x:o+u,y:c+y/2};case Position.Bottom:return{x:o+u/2,y:c+y};case Position.Left:return{x:o,y:c+y/2}}}function getHandle(e,r){return e?e.length===1||!r?e[0]:r&&e.find(t=>t.id===r)||null:null}const getEdgePositions=(e,r,t,o,c,u)=>{const y=getHandlePosition(t,e,r),f=getHandlePosition(u,o,c);return{sourceX:y.x,sourceY:y.y,targetX:f.x,targetY:f.y}};function isEdgeVisible({sourcePos:e,targetPos:r,sourceWidth:t,sourceHeight:o,targetWidth:c,targetHeight:u,width:y,height:f,transform:g}){const _={x:Math.min(e.x,r.x),y:Math.min(e.y,r.y),x2:Math.max(e.x+t,r.x+c),y2:Math.max(e.y+o,r.y+u)};_.x===_.x2&&(_.x2+=1),_.y===_.y2&&(_.y2+=1);const p=rectToBox({x:(0-g[0])/g[2],y:(0-g[1])/g[2],width:y/g[2],height:f/g[2]}),S=Math.max(0,Math.min(p.x2,_.x2)-Math.max(p.x,_.x)),A=Math.max(0,Math.min(p.y2,_.y2)-Math.max(p.y,_.y));return Math.ceil(S*A)>0}function getNodeData(e){const r=e?.[internalsSymbol]?.handleBounds||null,t=r&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},r,!!t]}const defaultEdgeTree=[{level:0,isMaxLevel:!0,edges:[]}];function groupEdgesByZLevel(e,r,t=!1){let o=-1;const c=e.reduce((y,f)=>{const g=isNumeric(f.zIndex);let _=g?f.zIndex:0;if(t){const p=r.get(f.target),S=r.get(f.source),A=f.selected||p?.selected||S?.selected,R=Math.max(S?.[internalsSymbol]?.z||0,p?.[internalsSymbol]?.z||0,1e3);_=(g?f.zIndex:0)+(A?R:0)}return y[_]?y[_].push(f):y[_]=[f],o=_>o?_:o,y},{}),u=Object.entries(c).map(([y,f])=>{const g=+y;return{edges:f,level:g,isMaxLevel:g===o}});return u.length===0?defaultEdgeTree:u}function useVisibleEdges(e,r,t){const o=useStore(reactExports.useCallback(c=>e?c.edges.filter(u=>{const y=r.get(u.source),f=r.get(u.target);return y?.width&&y?.height&&f?.width&&f?.height&&isEdgeVisible({sourcePos:y.positionAbsolute||{x:0,y:0},targetPos:f.positionAbsolute||{x:0,y:0},sourceWidth:y.width,sourceHeight:y.height,targetWidth:f.width,targetHeight:f.height,width:c.width,height:c.height,transform:c.transform})}):c.edges,[e,r]));return groupEdgesByZLevel(o,r,t)}const ArrowSymbol=({color:e="none",strokeWidth:r=1})=>React.createElement("polyline",{style:{stroke:e,strokeWidth:r},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),ArrowClosedSymbol=({color:e="none",strokeWidth:r=1})=>React.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:r},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),MarkerSymbols={[MarkerType.Arrow]:ArrowSymbol,[MarkerType.ArrowClosed]:ArrowClosedSymbol};function useMarkerSymbol(e){const r=useStoreApi();return reactExports.useMemo(()=>Object.prototype.hasOwnProperty.call(MarkerSymbols,e)?MarkerSymbols[e]:(r.getState().onError?.("009",errorMessages.error009(e)),null),[e])}const Marker=({id:e,type:r,color:t,width:o=12.5,height:c=12.5,markerUnits:u="strokeWidth",strokeWidth:y,orient:f="auto-start-reverse"})=>{const g=useMarkerSymbol(r);return g?React.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${c}`,viewBox:"-10 -10 20 20",markerUnits:u,orient:f,refX:"0",refY:"0"},React.createElement(g,{color:t,strokeWidth:y})):null},markerSelector=({defaultColor:e,rfId:r})=>t=>{const o=[];return t.edges.reduce((c,u)=>([u.markerStart,u.markerEnd].forEach(y=>{if(y&&typeof y=="object"){const f=getMarkerId(y,r);o.includes(f)||(c.push({id:f,color:y.color||e,...y}),o.push(f))}}),c),[]).sort((c,u)=>c.id.localeCompare(u.id))},MarkerDefinitions=({defaultColor:e,rfId:r})=>{const t=useStore(reactExports.useCallback(markerSelector({defaultColor:e,rfId:r}),[e,r]),(o,c)=>!(o.length!==c.length||o.some((u,y)=>u.id!==c[y].id)));return React.createElement("defs",null,t.map(o=>React.createElement(Marker,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};MarkerDefinitions.displayName="MarkerDefinitions";var MarkerDefinitions$1=reactExports.memo(MarkerDefinitions);const selector$4=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),EdgeRenderer=({defaultMarkerColor:e,onlyRenderVisibleElements:r,elevateEdgesOnSelect:t,rfId:o,edgeTypes:c,noPanClassName:u,onEdgeContextMenu:y,onEdgeMouseEnter:f,onEdgeMouseMove:g,onEdgeMouseLeave:_,onEdgeClick:p,onEdgeDoubleClick:S,onReconnect:A,onReconnectStart:R,onReconnectEnd:z,reconnectRadius:l,children:s,disableKeyboardA11y:v})=>{const{edgesFocusable:w,edgesUpdatable:E,elementsSelectable:C,width:h,height:x,connectionMode:k,nodeInternals:M,onError:D}=useStore(selector$4,shallow$1),P=useVisibleEdges(r,M,t);return h?React.createElement(React.Fragment,null,P.map(({level:F,edges:X,isMaxLevel:B})=>React.createElement("svg",{key:F,style:{zIndex:F},width:h,height:x,className:"react-flow__edges react-flow__container"},B&&React.createElement(MarkerDefinitions$1,{defaultColor:e,rfId:o}),React.createElement("g",null,X.map(L=>{const[H,U,Y]=getNodeData(M.get(L.source)),[W,q,G]=getNodeData(M.get(L.target));if(!Y||!G)return null;let $=L.type||"default";c[$]||(D?.("011",errorMessages.error011($)),$="default");const Z=c[$]||c.default,xe=k===ConnectionMode.Strict?q.target:(q.target??[]).concat(q.source??[]),ce=getHandle(U.source,L.sourceHandle),Ne=getHandle(xe,L.targetHandle),Pe=ce?.position||Position.Bottom,De=Ne?.position||Position.Top,Me=!!(L.focusable||w&&typeof L.focusable>"u"),Be=L.reconnectable||L.updatable,ft=typeof A<"u"&&(Be||E&&typeof Be>"u");if(!ce||!Ne)return D?.("008",errorMessages.error008(ce,L)),null;const{sourceX:Ot,sourceY:Gt,targetX:mt,targetY:je}=getEdgePositions(H,ce,Pe,W,Ne,De);return React.createElement(Z,{key:L.id,id:L.id,className:cc([L.className,u]),type:$,data:L.data,selected:!!L.selected,animated:!!L.animated,hidden:!!L.hidden,label:L.label,labelStyle:L.labelStyle,labelShowBg:L.labelShowBg,labelBgStyle:L.labelBgStyle,labelBgPadding:L.labelBgPadding,labelBgBorderRadius:L.labelBgBorderRadius,style:L.style,source:L.source,target:L.target,sourceHandleId:L.sourceHandle,targetHandleId:L.targetHandle,markerEnd:L.markerEnd,markerStart:L.markerStart,sourceX:Ot,sourceY:Gt,targetX:mt,targetY:je,sourcePosition:Pe,targetPosition:De,elementsSelectable:C,onContextMenu:y,onMouseEnter:f,onMouseMove:g,onMouseLeave:_,onClick:p,onEdgeDoubleClick:S,onReconnect:A,onReconnectStart:R,onReconnectEnd:z,reconnectRadius:l,rfId:o,ariaLabel:L.ariaLabel,isFocusable:Me,isReconnectable:ft,pathOptions:"pathOptions"in L?L.pathOptions:void 0,interactionWidth:L.interactionWidth,disableKeyboardA11y:v})})))),s):null};EdgeRenderer.displayName="EdgeRenderer";var EdgeRenderer$1=reactExports.memo(EdgeRenderer);const selector$3=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Viewport({children:e}){const r=useStore(selector$3);return React.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:r}},e)}function useOnInitHandler(e){const r=useReactFlow(),t=reactExports.useRef(!1);reactExports.useEffect(()=>{!t.current&&r.viewportInitialized&&e&&(setTimeout(()=>e(r),1),t.current=!0)},[e,r.viewportInitialized])}const oppositePosition={[Position.Left]:Position.Right,[Position.Right]:Position.Left,[Position.Top]:Position.Bottom,[Position.Bottom]:Position.Top},ConnectionLine=({nodeId:e,handleType:r,style:t,type:o=ConnectionLineType.Bezier,CustomComponent:c,connectionStatus:u})=>{const{fromNode:y,handleId:f,toX:g,toY:_,connectionMode:p}=useStore(reactExports.useCallback(x=>({fromNode:x.nodeInternals.get(e),handleId:x.connectionHandleId,toX:(x.connectionPosition.x-x.transform[0])/x.transform[2],toY:(x.connectionPosition.y-x.transform[1])/x.transform[2],connectionMode:x.connectionMode}),[e]),shallow$1),S=y?.[internalsSymbol]?.handleBounds;let A=S?.[r];if(p===ConnectionMode.Loose&&(A=A||S?.[r==="source"?"target":"source"]),!y||!A)return null;const R=f?A.find(x=>x.id===f):A[0],z=R?R.x+R.width/2:(y.width??0)/2,l=R?R.y+R.height/2:y.height??0,s=(y.positionAbsolute?.x??0)+z,v=(y.positionAbsolute?.y??0)+l,w=R?.position,E=w?oppositePosition[w]:null;if(!w||!E)return null;if(c)return React.createElement(c,{connectionLineType:o,connectionLineStyle:t,fromNode:y,fromHandle:R,fromX:s,fromY:v,toX:g,toY:_,fromPosition:w,toPosition:E,connectionStatus:u});let C="";const h={sourceX:s,sourceY:v,sourcePosition:w,targetX:g,targetY:_,targetPosition:E};return o===ConnectionLineType.Bezier?[C]=getBezierPath(h):o===ConnectionLineType.Step?[C]=getSmoothStepPath({...h,borderRadius:0}):o===ConnectionLineType.SmoothStep?[C]=getSmoothStepPath(h):o===ConnectionLineType.SimpleBezier?[C]=getSimpleBezierPath(h):C=`M${s},${v} ${g},${_}`,React.createElement("path",{d:C,fill:"none",className:"react-flow__connection-path",style:t})};ConnectionLine.displayName="ConnectionLine";const selector$2=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function ConnectionLineWrapper({containerStyle:e,style:r,type:t,component:o}){const{nodeId:c,handleType:u,nodesConnectable:y,width:f,height:g,connectionStatus:_}=useStore(selector$2,shallow$1);return!(c&&u&&f&&y)?null:React.createElement("svg",{style:e,width:f,height:g,className:"react-flow__edges react-flow__connectionline react-flow__container"},React.createElement("g",{className:cc(["react-flow__connection",_])},React.createElement(ConnectionLine,{nodeId:c,handleType:u,style:r,type:t,CustomComponent:o,connectionStatus:_})))}function useNodeOrEdgeTypes(e,r){return reactExports.useRef(null),useStoreApi(),reactExports.useMemo(()=>r(e),[e])}const GraphView=({nodeTypes:e,edgeTypes:r,onMove:t,onMoveStart:o,onMoveEnd:c,onInit:u,onNodeClick:y,onEdgeClick:f,onNodeDoubleClick:g,onEdgeDoubleClick:_,onNodeMouseEnter:p,onNodeMouseMove:S,onNodeMouseLeave:A,onNodeContextMenu:R,onSelectionContextMenu:z,onSelectionStart:l,onSelectionEnd:s,connectionLineType:v,connectionLineStyle:w,connectionLineComponent:E,connectionLineContainerStyle:C,selectionKeyCode:h,selectionOnDrag:x,selectionMode:k,multiSelectionKeyCode:M,panActivationKeyCode:D,zoomActivationKeyCode:P,deleteKeyCode:F,onlyRenderVisibleElements:X,elementsSelectable:B,selectNodesOnDrag:L,defaultViewport:H,translateExtent:U,minZoom:Y,maxZoom:W,preventScrolling:q,defaultMarkerColor:G,zoomOnScroll:$,zoomOnPinch:Z,panOnScroll:xe,panOnScrollSpeed:ce,panOnScrollMode:Ne,zoomOnDoubleClick:Pe,panOnDrag:De,onPaneClick:Me,onPaneMouseEnter:Be,onPaneMouseMove:ft,onPaneMouseLeave:Ot,onPaneScroll:Gt,onPaneContextMenu:mt,onEdgeContextMenu:je,onEdgeMouseEnter:ht,onEdgeMouseMove:Kt,onEdgeMouseLeave:Jt,onReconnect:Wt,onReconnectStart:Br,onReconnectEnd:zr,reconnectRadius:cr,noDragClassName:Nr,noWheelClassName:At,noPanClassName:Mt,elevateEdgesOnSelect:Jr,disableKeyboardA11y:Yr,nodeOrigin:ie,nodeExtent:ve,rfId:we})=>{const it=useNodeOrEdgeTypes(e,createNodeTypes),rt=useNodeOrEdgeTypes(r,createEdgeTypes);return useOnInitHandler(u),React.createElement(FlowRenderer$1,{onPaneClick:Me,onPaneMouseEnter:Be,onPaneMouseMove:ft,onPaneMouseLeave:Ot,onPaneContextMenu:mt,onPaneScroll:Gt,deleteKeyCode:F,selectionKeyCode:h,selectionOnDrag:x,selectionMode:k,onSelectionStart:l,onSelectionEnd:s,multiSelectionKeyCode:M,panActivationKeyCode:D,zoomActivationKeyCode:P,elementsSelectable:B,onMove:t,onMoveStart:o,onMoveEnd:c,zoomOnScroll:$,zoomOnPinch:Z,zoomOnDoubleClick:Pe,panOnScroll:xe,panOnScrollSpeed:ce,panOnScrollMode:Ne,panOnDrag:De,defaultViewport:H,translateExtent:U,minZoom:Y,maxZoom:W,onSelectionContextMenu:z,preventScrolling:q,noDragClassName:Nr,noWheelClassName:At,noPanClassName:Mt,disableKeyboardA11y:Yr},React.createElement(Viewport,null,React.createElement(EdgeRenderer$1,{edgeTypes:rt,onEdgeClick:f,onEdgeDoubleClick:_,onlyRenderVisibleElements:X,onEdgeContextMenu:je,onEdgeMouseEnter:ht,onEdgeMouseMove:Kt,onEdgeMouseLeave:Jt,onReconnect:Wt,onReconnectStart:Br,onReconnectEnd:zr,reconnectRadius:cr,defaultMarkerColor:G,noPanClassName:Mt,elevateEdgesOnSelect:!!Jr,disableKeyboardA11y:Yr,rfId:we},React.createElement(ConnectionLineWrapper,{style:w,type:v,component:E,containerStyle:C})),React.createElement("div",{className:"react-flow__edgelabel-renderer"}),React.createElement(NodeRenderer$1,{nodeTypes:it,onNodeClick:y,onNodeDoubleClick:g,onNodeMouseEnter:p,onNodeMouseMove:S,onNodeMouseLeave:A,onNodeContextMenu:R,selectNodesOnDrag:L,onlyRenderVisibleElements:X,noPanClassName:Mt,noDragClassName:Nr,disableKeyboardA11y:Yr,nodeOrigin:ie,nodeExtent:ve,rfId:we})))};GraphView.displayName="GraphView";var GraphView$1=reactExports.memo(GraphView);const infiniteExtent=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],initialState={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:infiniteExtent,nodeExtent:infiniteExtent,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:ConnectionMode.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:devWarn,isValidConnection:void 0},createRFStore=()=>createWithEqualityFn((e,r)=>({...initialState,setNodes:t=>{const{nodeInternals:o,nodeOrigin:c,elevateNodesOnSelect:u}=r();e({nodeInternals:createNodeInternals(t,o,c,u)})},getNodes:()=>Array.from(r().nodeInternals.values()),setEdges:t=>{const{defaultEdgeOptions:o={}}=r();e({edges:t.map(c=>({...o,...c}))})},setDefaultNodesAndEdges:(t,o)=>{const c=typeof t<"u",u=typeof o<"u",y=c?createNodeInternals(t,new Map,r().nodeOrigin,r().elevateNodesOnSelect):new Map;e({nodeInternals:y,edges:u?o:[],hasDefaultNodes:c,hasDefaultEdges:u})},updateNodeDimensions:t=>{const{onNodesChange:o,nodeInternals:c,fitViewOnInit:u,fitViewOnInitDone:y,fitViewOnInitOptions:f,domNode:g,nodeOrigin:_}=r(),p=g?.querySelector(".react-flow__viewport");if(!p)return;const S=window.getComputedStyle(p),{m22:A}=new window.DOMMatrixReadOnly(S.transform),R=t.reduce((l,s)=>{const v=c.get(s.id);if(v?.hidden)c.set(v.id,{...v,[internalsSymbol]:{...v[internalsSymbol],handleBounds:void 0}});else if(v){const w=getDimensions(s.nodeElement);!!(w.width&&w.height&&(v.width!==w.width||v.height!==w.height||s.forceUpdate))&&(c.set(v.id,{...v,[internalsSymbol]:{...v[internalsSymbol],handleBounds:{source:getHandleBounds(".source",s.nodeElement,A,_),target:getHandleBounds(".target",s.nodeElement,A,_)}},...w}),l.push({id:v.id,type:"dimensions",dimensions:w}))}return l},[]);updateAbsoluteNodePositions(c,_);const z=y||u&&!y&&fitView(r,{initial:!0,...f});e({nodeInternals:new Map(c),fitViewOnInitDone:z}),R?.length>0&&o?.(R)},updateNodePositions:(t,o=!0,c=!1)=>{const{triggerNodeChanges:u}=r(),y=t.map(f=>{const g={id:f.id,type:"position",dragging:c};return o&&(g.positionAbsolute=f.positionAbsolute,g.position=f.position),g});u(y)},triggerNodeChanges:t=>{const{onNodesChange:o,nodeInternals:c,hasDefaultNodes:u,nodeOrigin:y,getNodes:f,elevateNodesOnSelect:g}=r();if(t?.length){if(u){const _=applyNodeChanges(t,f()),p=createNodeInternals(_,c,y,g);e({nodeInternals:p})}o?.(t)}},addSelectedNodes:t=>{const{multiSelectionActive:o,edges:c,getNodes:u}=r();let y,f=null;o?y=t.map(g=>createSelectionChange(g,!0)):(y=getSelectionChanges(u(),t),f=getSelectionChanges(c,[])),updateNodesAndEdgesSelections({changedNodes:y,changedEdges:f,get:r,set:e})},addSelectedEdges:t=>{const{multiSelectionActive:o,edges:c,getNodes:u}=r();let y,f=null;o?y=t.map(g=>createSelectionChange(g,!0)):(y=getSelectionChanges(c,t),f=getSelectionChanges(u(),[])),updateNodesAndEdgesSelections({changedNodes:f,changedEdges:y,get:r,set:e})},unselectNodesAndEdges:({nodes:t,edges:o}={})=>{const{edges:c,getNodes:u}=r(),y=t||u(),f=o||c,g=y.map(p=>(p.selected=!1,createSelectionChange(p.id,!1))),_=f.map(p=>createSelectionChange(p.id,!1));updateNodesAndEdgesSelections({changedNodes:g,changedEdges:_,get:r,set:e})},setMinZoom:t=>{const{d3Zoom:o,maxZoom:c}=r();o?.scaleExtent([t,c]),e({minZoom:t})},setMaxZoom:t=>{const{d3Zoom:o,minZoom:c}=r();o?.scaleExtent([c,t]),e({maxZoom:t})},setTranslateExtent:t=>{r().d3Zoom?.translateExtent(t),e({translateExtent:t})},resetSelectedElements:()=>{const{edges:t,getNodes:o}=r(),u=o().filter(f=>f.selected).map(f=>createSelectionChange(f.id,!1)),y=t.filter(f=>f.selected).map(f=>createSelectionChange(f.id,!1));updateNodesAndEdgesSelections({changedNodes:u,changedEdges:y,get:r,set:e})},setNodeExtent:t=>{const{nodeInternals:o}=r();o.forEach(c=>{c.positionAbsolute=clampPosition(c.position,t)}),e({nodeExtent:t,nodeInternals:new Map(o)})},panBy:t=>{const{transform:o,width:c,height:u,d3Zoom:y,d3Selection:f,translateExtent:g}=r();if(!y||!f||!t.x&&!t.y)return!1;const _=identity.translate(o[0]+t.x,o[1]+t.y).scale(o[2]),p=[[0,0],[c,u]],S=y?.constrain()(_,p,g);return y.transform(f,S),o[0]!==S.x||o[1]!==S.y||o[2]!==S.k},cancelConnection:()=>e({connectionNodeId:initialState.connectionNodeId,connectionHandleId:initialState.connectionHandleId,connectionHandleType:initialState.connectionHandleType,connectionStatus:initialState.connectionStatus,connectionStartHandle:initialState.connectionStartHandle,connectionEndHandle:initialState.connectionEndHandle}),reset:()=>e({...initialState})}),Object.is),ReactFlowProvider=({children:e})=>{const r=reactExports.useRef(null);return r.current||(r.current=createRFStore()),React.createElement(Provider$1,{value:r.current},e)};ReactFlowProvider.displayName="ReactFlowProvider";const Wrapper=({children:e})=>reactExports.useContext(StoreContext)?React.createElement(React.Fragment,null,e):React.createElement(ReactFlowProvider,null,e);Wrapper.displayName="ReactFlowWrapper";const defaultNodeTypes={input:InputNode$1,default:DefaultNode$1,output:OutputNode$1,group:GroupNode},defaultEdgeTypes={default:BezierEdge,straight:StraightEdge,step:StepEdge,smoothstep:SmoothStepEdge,simplebezier:SimpleBezierEdge},initNodeOrigin=[0,0],initSnapGrid=[15,15],initDefaultViewport={x:0,y:0,zoom:1},wrapperStyle={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ReactFlow=reactExports.forwardRef(({nodes:e,edges:r,defaultNodes:t,defaultEdges:o,className:c,nodeTypes:u=defaultNodeTypes,edgeTypes:y=defaultEdgeTypes,onNodeClick:f,onEdgeClick:g,onInit:_,onMove:p,onMoveStart:S,onMoveEnd:A,onConnect:R,onConnectStart:z,onConnectEnd:l,onClickConnectStart:s,onClickConnectEnd:v,onNodeMouseEnter:w,onNodeMouseMove:E,onNodeMouseLeave:C,onNodeContextMenu:h,onNodeDoubleClick:x,onNodeDragStart:k,onNodeDrag:M,onNodeDragStop:D,onNodesDelete:P,onEdgesDelete:F,onSelectionChange:X,onSelectionDragStart:B,onSelectionDrag:L,onSelectionDragStop:H,onSelectionContextMenu:U,onSelectionStart:Y,onSelectionEnd:W,connectionMode:q=ConnectionMode.Strict,connectionLineType:G=ConnectionLineType.Bezier,connectionLineStyle:$,connectionLineComponent:Z,connectionLineContainerStyle:xe,deleteKeyCode:ce="Backspace",selectionKeyCode:Ne="Shift",selectionOnDrag:Pe=!1,selectionMode:De=SelectionMode.Full,panActivationKeyCode:Me="Space",multiSelectionKeyCode:Be=isMacOs()?"Meta":"Control",zoomActivationKeyCode:ft=isMacOs()?"Meta":"Control",snapToGrid:Ot=!1,snapGrid:Gt=initSnapGrid,onlyRenderVisibleElements:mt=!1,selectNodesOnDrag:je=!0,nodesDraggable:ht,nodesConnectable:Kt,nodesFocusable:Jt,nodeOrigin:Wt=initNodeOrigin,edgesFocusable:Br,edgesUpdatable:zr,elementsSelectable:cr,defaultViewport:Nr=initDefaultViewport,minZoom:At=.5,maxZoom:Mt=2,translateExtent:Jr=infiniteExtent,preventScrolling:Yr=!0,nodeExtent:ie,defaultMarkerColor:ve="#b1b1b7",zoomOnScroll:we=!0,zoomOnPinch:it=!0,panOnScroll:rt=!1,panOnScrollSpeed:Yt=.5,panOnScrollMode:jt=PanOnScrollMode.Free,zoomOnDoubleClick:re=!0,panOnDrag:tt=!0,onPaneClick:lt,onPaneMouseEnter:ar,onPaneMouseMove:et,onPaneMouseLeave:Ft,onPaneScroll:se,onPaneContextMenu:xt,children:Vr,onEdgeContextMenu:J,onEdgeDoubleClick:ut,onEdgeMouseEnter:at,onEdgeMouseMove:me,onEdgeMouseLeave:Ze,onEdgeUpdate:vt,onEdgeUpdateStart:Qr,onEdgeUpdateEnd:Xr,onReconnect:Zr,onReconnectStart:xn,onReconnectEnd:Ei,reconnectRadius:zn=10,edgeUpdaterRadius:Pn=10,onNodesChange:Fn,onEdgesChange:mi,noDragClassName:xi="nodrag",noWheelClassName:Ca="nowheel",noPanClassName:Ra="nopan",fitView:ei=!1,fitViewOptions:ai,connectOnClick:ci=!0,attributionPosition:Xs,proOptions:Us,defaultEdgeOptions:fa,elevateNodesOnSelect:ll=!0,elevateEdgesOnSelect:cl=!1,disableKeyboardA11y:ul=!1,autoPanOnConnect:Ya=!0,autoPanOnNodeDrag:hi=!0,connectionRadius:dl=20,isValidConnection:La,onError:kc,style:On,id:Aa,nodeDragThreshold:pa,...Tl},$s)=>{const hl=Aa||"1";return React.createElement("div",{...Tl,style:{...On,...wrapperStyle},ref:$s,className:cc(["react-flow",c]),"data-testid":"rf__wrapper",id:Aa},React.createElement(Wrapper,null,React.createElement(GraphView$1,{onInit:_,onMove:p,onMoveStart:S,onMoveEnd:A,onNodeClick:f,onEdgeClick:g,onNodeMouseEnter:w,onNodeMouseMove:E,onNodeMouseLeave:C,onNodeContextMenu:h,onNodeDoubleClick:x,nodeTypes:u,edgeTypes:y,connectionLineType:G,connectionLineStyle:$,connectionLineComponent:Z,connectionLineContainerStyle:xe,selectionKeyCode:Ne,selectionOnDrag:Pe,selectionMode:De,deleteKeyCode:ce,multiSelectionKeyCode:Be,panActivationKeyCode:Me,zoomActivationKeyCode:ft,onlyRenderVisibleElements:mt,selectNodesOnDrag:je,defaultViewport:Nr,translateExtent:Jr,minZoom:At,maxZoom:Mt,preventScrolling:Yr,zoomOnScroll:we,zoomOnPinch:it,zoomOnDoubleClick:re,panOnScroll:rt,panOnScrollSpeed:Yt,panOnScrollMode:jt,panOnDrag:tt,onPaneClick:lt,onPaneMouseEnter:ar,onPaneMouseMove:et,onPaneMouseLeave:Ft,onPaneScroll:se,onPaneContextMenu:xt,onSelectionContextMenu:U,onSelectionStart:Y,onSelectionEnd:W,onEdgeContextMenu:J,onEdgeDoubleClick:ut,onEdgeMouseEnter:at,onEdgeMouseMove:me,onEdgeMouseLeave:Ze,onReconnect:Zr??vt,onReconnectStart:xn??Qr,onReconnectEnd:Ei??Xr,reconnectRadius:zn??Pn,defaultMarkerColor:ve,noDragClassName:xi,noWheelClassName:Ca,noPanClassName:Ra,elevateEdgesOnSelect:cl,rfId:hl,disableKeyboardA11y:ul,nodeOrigin:Wt,nodeExtent:ie}),React.createElement(StoreUpdater,{nodes:e,edges:r,defaultNodes:t,defaultEdges:o,onConnect:R,onConnectStart:z,onConnectEnd:l,onClickConnectStart:s,onClickConnectEnd:v,nodesDraggable:ht,nodesConnectable:Kt,nodesFocusable:Jt,edgesFocusable:Br,edgesUpdatable:zr,elementsSelectable:cr,elevateNodesOnSelect:ll,minZoom:At,maxZoom:Mt,nodeExtent:ie,onNodesChange:Fn,onEdgesChange:mi,snapToGrid:Ot,snapGrid:Gt,connectionMode:q,translateExtent:Jr,connectOnClick:ci,defaultEdgeOptions:fa,fitView:ei,fitViewOptions:ai,onNodesDelete:P,onEdgesDelete:F,onNodeDragStart:k,onNodeDrag:M,onNodeDragStop:D,onSelectionDrag:L,onSelectionDragStart:B,onSelectionDragStop:H,noPanClassName:Ra,nodeOrigin:Wt,rfId:hl,autoPanOnConnect:Ya,autoPanOnNodeDrag:hi,onError:kc,connectionRadius:dl,isValidConnection:La,nodeDragThreshold:pa}),React.createElement(Wrapper$1,{onSelectionChange:X}),Vr,React.createElement(Attribution,{proOptions:Us,position:Xs}),React.createElement(A11yDescriptions,{rfId:hl,disableKeyboardA11y:ul})))});ReactFlow.displayName="ReactFlow";const viewportSelector=e=>({x:e.transform[0],y:e.transform[1],zoom:e.transform[2]});function useViewport(){return useStore(viewportSelector,shallow$1)}function PlusIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},React.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function MinusIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},React.createElement("path",{d:"M0 0h32v4.2H0z"}))}function FitViewIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},React.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function LockIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},React.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function UnlockIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},React.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const ControlButton=({children:e,className:r,...t})=>React.createElement("button",{type:"button",className:cc(["react-flow__controls-button",r]),...t},e);ControlButton.displayName="ControlButton";const selector$1=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Controls=({style:e,showZoom:r=!0,showFitView:t=!0,showInteractive:o=!0,fitViewOptions:c,onZoomIn:u,onZoomOut:y,onFitView:f,onInteractiveChange:g,className:_,children:p,position:S="bottom-left"})=>{const A=useStoreApi(),[R,z]=reactExports.useState(!1),{isInteractive:l,minZoomReached:s,maxZoomReached:v}=useStore(selector$1,shallow$1),{zoomIn:w,zoomOut:E,fitView:C}=useReactFlow();if(reactExports.useEffect(()=>{z(!0)},[]),!R)return null;const h=()=>{w(),u?.()},x=()=>{E(),y?.()},k=()=>{C(c),f?.()},M=()=>{A.setState({nodesDraggable:!l,nodesConnectable:!l,elementsSelectable:!l}),g?.(!l)};return React.createElement(Panel,{className:cc(["react-flow__controls",_]),position:S,style:e,"data-testid":"rf__controls"},r&&React.createElement(React.Fragment,null,React.createElement(ControlButton,{onClick:h,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:v},React.createElement(PlusIcon,null)),React.createElement(ControlButton,{onClick:x,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:s},React.createElement(MinusIcon,null))),t&&React.createElement(ControlButton,{className:"react-flow__controls-fitview",onClick:k,title:"fit view","aria-label":"fit view"},React.createElement(FitViewIcon,null)),o&&React.createElement(ControlButton,{className:"react-flow__controls-interactive",onClick:M,title:"toggle interactivity","aria-label":"toggle interactivity"},l?React.createElement(UnlockIcon,null):React.createElement(LockIcon,null)),p)};Controls.displayName="Controls";var Controls$1=reactExports.memo(Controls),BackgroundVariant;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(BackgroundVariant||(BackgroundVariant={}));function LinePattern({color:e,dimensions:r,lineWidth:t}){return React.createElement("path",{stroke:e,strokeWidth:t,d:`M${r[0]/2} 0 V${r[1]} M0 ${r[1]/2} H${r[0]}`})}function DotPattern({color:e,radius:r}){return React.createElement("circle",{cx:r,cy:r,r,fill:e})}const defaultColor={[BackgroundVariant.Dots]:"#91919a",[BackgroundVariant.Lines]:"#eee",[BackgroundVariant.Cross]:"#e2e2e2"},defaultSize={[BackgroundVariant.Dots]:1,[BackgroundVariant.Lines]:1,[BackgroundVariant.Cross]:6},selector=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Background({id:e,variant:r=BackgroundVariant.Dots,gap:t=20,size:o,lineWidth:c=1,offset:u=2,color:y,style:f,className:g}){const _=reactExports.useRef(null),{transform:p,patternId:S}=useStore(selector,shallow$1),A=y||defaultColor[r],R=o||defaultSize[r],z=r===BackgroundVariant.Dots,l=r===BackgroundVariant.Cross,s=Array.isArray(t)?t:[t,t],v=[s[0]*p[2]||1,s[1]*p[2]||1],w=R*p[2],E=l?[w,w]:v,C=z?[w/u,w/u]:[E[0]/u,E[1]/u];return React.createElement("svg",{className:cc(["react-flow__background",g]),style:{...f,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:_,"data-testid":"rf__background"},React.createElement("pattern",{id:S+e,x:p[0]%v[0],y:p[1]%v[1],width:v[0],height:v[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${C[0]},-${C[1]})`},z?React.createElement(DotPattern,{color:A,radius:w/u}):React.createElement(LinePattern,{dimensions:E,color:A,lineWidth:c})),React.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${S+e})`}))}Background.displayName="Background";var Background$1=reactExports.memo(Background);function getNodeDisplay(e){`${e.aiida.uuid.split("-")[0]}`;const r="";switch(e.label){case"AbstractCode":return r;case"ArrayData":return r;case"BandsData":const o=e.attributes?.["array|bands"];return o?.[1]!==void 0?`Num. bands: ${o[1]}`:r;case"Bool":return e.attributes?.value!==void 0?`Value: ${e.attributes.value}`:r;case"CalcJobNode":const c=e?.aiida?.process_type?.split(":")[1];return c||r;case"Code":const u=e?.attributes?.input_plugin;return u||r;case"Dict":return e?.attributes?`Num. keys: ${Object.keys(e.attributes).length}`:r;case"EnumData":return r;case"Float":case"Int":return e.attributes?.value!==void 0?`Value: ${e.attributes.value}`:r;case"JsonableData":return r;case"List":return e.attributes?.value!==void 0?`Length: ${e.attributes.list.length}`:r;case"Str":return r;case"KpointsData":if(e.attributes?.mesh){const[y,f,g]=e.attributes.mesh;return`Grid: ${y} × ${f} × ${g}`}return e.attributes?.labels&&e.attributes?.label_numbers?`Path: ${e.attributes.labels.join(" → ")}`:r;case"StructureData":{let y=function(f,g=22){const _={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉"},p=f.replace(/\d/g,S=>_[S]||S);return p.length>g?p.slice(0,g-3)+"...":p};var t=y;return e.extras?.formula_hill?`${y(e.extras.formula_hill)}`:e.derived_properties?.formula?`${y(e.derived_properties?.formula)}`:r}case"UpfData":{const y=e.download?.pseudo_potential?.header?.element,f=e.download?.pseudo_potential?.header?.pseudo_type,g=e.download?.pseudo_potential?.header?.original_upf_file;return y&&f?`${g}`:r}case"XyData":return r;case"SinglefileData":return r;case"FolderData":return r;case"RemoteData":return r;case"InstalledCode":return r;case"PortableCode":return r;case"ContainerizedCode":return r;default:return r}}function getNodeColorClasses(e,r=!1){let t="bg-gray-200",o="text-black",c="transition-all";return e?.startsWith("process.workflow")?(t="bg-orange-300",c="border-orange-400 shadow-md"):e?.startsWith("process")?(t="bg-red-300",c="border-red-400 shadow-md"):e?.startsWith("data")&&(t="bg-green-300",c="border-green-400 shadow-md"),r&&(c="border-2 border-blue-600 shadow-md rounded-md transition duration-700",t="bg-blue-100 glow-4",o="text-black font-semibold"),{bgClass:t,textClass:o,borderStyle:c}}function HorizontalNode({data:e,selected:r}){const{zoom:t}=useViewport(),o="min-w-[120px] text-center p-1.5 px-3 rounded border-3",c=`absolute -translate-y-1/4
   whitespace-nowrap opacity-90
   bg-slate-200 border border-gray-300
   rounded-md px-1 py-0.5 text-gray-700 `,u=`${c} left-full ml-1 text-left`,y=`${c} right-full mr-1 text-right`,f=t>1.2,_=`
  absolute
  top-1/3
  bottom-1/3
  flex
  items-center
  ${f?"text-[8px]":"text-[10px]"}
  text-slate-600
  font-light
  ${f?"":"hidden"}
`,p=`${_} left-0 ml-0.5 pr-1 pl-0.5
   bg-gray-400 bg-opacity-40 rounded-r-md`,S=`${_} right-0 mr-0.5 pl-1 pr-0.5
   bg-gray-400 bg-opacity-40 rounded-l-md`,{bgClass:A,textClass:R,borderStyle:z}=getNodeColorClasses(e.node_type,r,e.pos),l=e.aiida.uuid.split("-")[0],s=getNodeDisplay(e),v=t>1.2?"text-[12px]":"text-[14px]",w=t>1.2?"text-[9px] px-2 py-1":"text-[12px] px-2 py-1",E=jsxRuntimeExports$1.jsxs("div",{className:`${v}`,children:[e.label,t>1.2&&jsxRuntimeExports$1.jsx("br",{}),t>1.2&&jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("div",{className:"text-[8px] opacity-80",children:`uuid: ${l}`}),jsxRuntimeExports$1.jsx("div",{className:"text-[8px] opacity-80 ",children:`${s}`})]})]}),C=e.aiida?.link_label&&e.pos!==0?jsxRuntimeExports$1.jsx("div",{className:`${e.pos===1?u:y} ${w}`,children:e.aiida.link_label.length>21?`${e.aiida.link_label.slice(0,18)}...`:e.aiida.link_label}):null;return jsxRuntimeExports$1.jsxs("div",{className:`${o} ${A} ${R} ${z}`,children:[C,jsxRuntimeExports$1.jsx("div",{className:p,children:e.parentCount??""}),jsxRuntimeExports$1.jsx("div",{className:S,children:e.childCount??""}),E,jsxRuntimeExports$1.jsx(Handle$1,{type:"target",position:Position.Left,style:{pointerEvents:"none",opacity:0,marginLeft:"4px"}}),jsxRuntimeExports$1.jsx(Handle$1,{type:"source",position:Position.Right,style:{pointerEvents:"none",opacity:0,marginRight:"4px"}})]})}const nodeTypes={custom:HorizontalNode};function FlowChart({nodes:e,edges:r,setNodes:t,setEdges:o,selectedNode:c,onNodeSelect:u,onNodeDoubleSelect:y,onInit:f}){const g=reactExports.useCallback((S,A)=>{u&&u(A)},[u]),_=reactExports.useCallback((S,A)=>{y&&y(A)},[y]),p=e.map(S=>({...S,type:"custom",selected:c?.id===S.id}));return jsxRuntimeExports$1.jsx("div",{className:"w-full h-full",children:jsxRuntimeExports$1.jsxs(ReactFlow,{className:"bg-slate-50",nodes:p,edges:r,nodeTypes,onNodesChange:S=>t(A=>applyNodeChanges(S,A)),onEdgesChange:S=>o(A=>applyEdgeChanges(S,A)),onNodeClick:g,onNodeDoubleClick:_,fitView:!0,nodesDraggable:!0,nodesConnectable:!1,onInit:f,children:[jsxRuntimeExports$1.jsx(Controls$1,{}),jsxRuntimeExports$1.jsx(Background$1,{variant:"dots",gap:12,size:1})]})})}function DebugPane({selectedNode:e}){return jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4",children:[jsxRuntimeExports$1.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Node Info"}),e?jsxRuntimeExports$1.jsxs("pre",{className:"bg-gray-100 p-2 rounded overflow-x-auto",children:[" ",JSON.stringify(e.data,null,2)]}):jsxRuntimeExports$1.jsx("p",{children:"Click a node to see top level details. Double click fetch the node and get all the details."})]})}function SortIcon({direction:e="asc",size:r=14,className:t=""}){return jsxRuntimeExports$1.jsx("svg",{width:r,height:r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",className:`${t} transform ${e==="asc"?"rotate-180":""}`,children:jsxRuntimeExports$1.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"})})}function DataTable({title:e,columns:r,data:t=[],maxWidth:o="1500px",sortableCols:c=!0,renderIfMissing:u=!1}){const[y,f]=reactExports.useState({key:null,direction:"asc"});if(!u&&(!t||t.length===0))return null;const g=reactExports.useMemo(()=>{if(!y.key)return t;const _=[...t].sort((p,S)=>{const A=p[y.key],R=S[y.key];return!isNaN(A)&&!isNaN(R)?A-R:String(A).localeCompare(String(R))});return y.direction==="asc"?_:_.reverse()},[t,y]);return jsxRuntimeExports$1.jsxs("div",{className:"p-2",style:{maxWidth:o},children:[jsxRuntimeExports$1.jsx("h2",{className:"text-xl font-semibold mb-2",children:e}),jsxRuntimeExports$1.jsx("div",{className:"overflow-x-auto shadow bg-white",children:jsxRuntimeExports$1.jsxs("table",{className:"min-w-full text-sm text-left",children:[jsxRuntimeExports$1.jsx("thead",{className:"bg-gray-100 text-gray-700",children:jsxRuntimeExports$1.jsx("tr",{children:r.map(_=>{const p=Array.isArray(c)?c.includes(_):c;return jsxRuntimeExports$1.jsx("th",{className:`px-4 py-2 font-medium ${p?"cursor-pointer select-none":""}`,onClick:()=>p&&f(S=>({key:_,direction:S.key===_&&S.direction==="asc"?"desc":"asc"})),children:jsxRuntimeExports$1.jsxs("div",{className:"flex items-center gap-1",children:[_,p&&y.key===_&&jsxRuntimeExports$1.jsx(SortIcon,{direction:y.direction,size:14,className:"ml-1 text-gray-500"})]})},_)})})}),jsxRuntimeExports$1.jsx("tbody",{children:g.map((_,p)=>jsxRuntimeExports$1.jsx("tr",{className:p%2===0?"bg-white":"bg-gray-50",children:r.map(S=>jsxRuntimeExports$1.jsx("td",{className:"px-4 py-2 text-gray-800",children:_[S]},S))},_.id||p))})]})})]})}function TreeDropdown({data:e,onSelect:r,openNodes:t,toggleNode:o,arrowClassName:c="w-8 h-8 text-blue-500 transform transition-transform duration-300"}){if(!e)return null;const u=({node:y})=>{const f=y.subspaces&&y.subspaces.length>0,g=!!t[y.full_type];return jsxRuntimeExports$1.jsxs("div",{className:"ml-2",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex items-center gap-1",children:[f&&jsxRuntimeExports$1.jsx("div",{className:"cursor-pointer",onClick:()=>o(y.full_type),children:jsxRuntimeExports$1.jsx("svg",{className:`${c} ${g?"rotate-90":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:jsxRuntimeExports$1.jsx("path",{d:"M6 6L14 10L6 14V6Z"})})}),jsxRuntimeExports$1.jsx("div",{className:"cursor-pointer text-gray-800 hover:bg-gray-100 p-1 rounded flex-1",onClick:()=>r&&r(y),children:y.label})]}),f&&jsxRuntimeExports$1.jsx("div",{className:"overflow-hidden transition-all duration-300 origin-top",style:{maxHeight:g?"1000px":"0"},children:y.subspaces.map(_=>jsxRuntimeExports$1.jsx(u,{node:_},_.full_type))})]})};return jsxRuntimeExports$1.jsx("div",{className:"border rounded p-2 bg-white shadow max-w-md",children:jsxRuntimeExports$1.jsx(u,{node:e})})}function layoutDefaults(e){return{spacingX:e.spacingX||280,spacingY:e.spacingY||70,groupGapY:e.groupGapY||100,centerX:e.centerX||window.innerWidth/2,centerY:e.centerY||window.innerHeight/2,edgeStyle:{stroke:"grey",strokeWidth:2}}}function edgeStyleFor(e,r){const t=e.data?.node_type||"";return t.includes("workflow")||t.includes("process")?{...r,strokeDasharray:"5,5"}:r}function arrangeDataCenterNode(e,r,t,o={}){const{spacingX:c,spacingY:u,groupGapY:y,centerX:f,centerY:g,edgeStyle:_}=layoutDefaults(o),p=[],S=[],A=r.filter(P=>P.data?.node_type.includes("calculation")),R=r.filter(P=>P.data?.node_type.includes("workflow")).sort((P,F)=>new Date(F.data.aiida.ctime)-new Date(P.data.aiida.ctime)),z=t.filter(P=>P.data?.node_type.includes("calculation")).sort((P,F)=>new Date(F.data.aiida.ctime)-new Date(P.data.aiida.ctime)),l=t.filter(P=>P.data?.node_type.includes("workflow")).sort((P,F)=>new Date(F.data.aiida.ctime)-new Date(P.data.aiida.ctime));[...A.map((P,F)=>F),...R.map((P,F)=>F)],[...z.map((P,F)=>F),...l.map((P,F)=>F)];const s=A.length+R.length,v=z.length+l.length,w=Math.max(s,v,1),E=g-(w-1)/2*u/2;p.push({...e,position:{x:f,y:E}});const C=g-(A.length-1)/2*u;A.forEach((P,F)=>{const X=C+F*u;p.push({...P,position:{x:f-c,y:X}}),S.push({id:`e-${P.id}->${e.id}`,source:P.id,target:e.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(P,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});let h=A.length>0?y:0;const x=C-h-(R.length-1)*u;R.forEach((P,F)=>{const X=x+F*u;p.push({...P,position:{x:f-c,y:X}}),S.push({id:`e-${P.id}->${e.id}`,source:P.id,target:e.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(P,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const k=g-(z.length-1)/2*u;z.forEach((P,F)=>{const X=k+F*u;p.push({...P,position:{x:f+c,y:X}}),S.push({id:`e-${e.id}->${P.id}`,source:e.id,target:P.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(P,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});let M=z.length>0?y:0,D=k-M-(l.length-1)*u;return l.forEach((P,F)=>{const X=D+F*u;p.push({...P,position:{x:f+c,y:X}}),S.push({id:`e-${e.id}->${P.id}`,source:e.id,target:P.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(P,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})}),{nodes:p,edges:S}}function arrangeCalculationCenterNode(e,r,t,o={}){const{spacingX:c,spacingY:u,groupGapY:y,centerX:f,centerY:g,edgeStyle:_}=layoutDefaults(o),p=[],S=[];p.push({...e,position:{x:f,y:g}});const A=r.filter(C=>C.data?.node_type.includes("data")).sort((C,h)=>C.data.label.localeCompare(h.data.label)),R=r.filter(C=>C.data?.node_type.includes("workflow")).sort((C,h)=>new Date(h.data.aiida.ctime)-new Date(C.data.aiida.ctime)),z=t.filter(C=>C.data?.node_type.startsWith("data")).sort((C,h)=>C.data.label.localeCompare(h.data.label)),l=t.filter(C=>C.data?.node_type.includes("workflow")).sort((C,h)=>new Date(h.data.aiida.ctime)-new Date(C.data.aiida.ctime)),s=g-(A.length-1)/2*u;A.forEach((C,h)=>{const x=s+h*u;p.push({...C,position:{x:f-c,y:x}}),S.push({id:`e-${C.id}->${e.id}`,source:C.id,target:e.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const v=s-y-(R.length-1)*u;R.forEach((C,h)=>{const x=v+h*u;p.push({...C,position:{x:f-c,y:x}}),S.push({id:`e-${C.id}->${e.id}`,source:C.id,target:e.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const w=g-(z.length-1)/2*u;z.forEach((C,h)=>{const x=w+h*u;p.push({...C,position:{x:f+c,y:x}}),S.push({id:`e-${e.id}->${C.id}`,source:e.id,target:C.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const E=w-y-(l.length-1)*u;return l.forEach((C,h)=>{const x=E+h*u;p.push({...C,position:{x:f+c,y:x}}),S.push({id:`e-${e.id}->${C.id}`,source:e.id,target:C.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})}),{nodes:p,edges:S}}function arrangeWorkflowCenterNode(e,r,t,o={}){const{spacingX:c,spacingY:u,groupGapY:y,centerX:f,centerY:g,edgeStyle:_}=layoutDefaults(o),p=[],S=[];p.push({...e,position:{x:f,y:g}});const A=r.filter(C=>C.data?.node_type.startsWith("data")),R=r.filter(C=>["calculation","workflow","process"].includes(C.data?.node_type.split(".")[1])),z=t.filter(C=>C.data?.node_type.startsWith("data")),l=t.filter(C=>["calculation","workflow","process"].includes(C.data?.node_type.split(".")[1])),s=g-(A.length-1)/2*u;A.forEach((C,h)=>{const x=s+h*u;p.push({...C,position:{x:f-c,y:x}}),S.push({id:`e-${C.id}->${e.id}`,source:C.id,target:e.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const v=s-y-(R.length-1)*u;R.forEach((C,h)=>{const x=v+h*u;p.push({...C,position:{x:f-c,y:x}}),S.push({id:`e-${C.id}->${e.id}`,source:C.id,target:e.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const w=g-(z.length-1)/2*u;z.forEach((C,h)=>{const x=w+h*u;p.push({...C,position:{x:f+c,y:x}}),S.push({id:`e-${e.id}->${C.id}`,source:e.id,target:C.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const E=w-y-(l.length-1)*u;return l.forEach((C,h)=>{const x=E+h*u;p.push({...C,position:{x:f+c,y:x}}),S.push({id:`e-${e.id}->${C.id}`,source:e.id,target:C.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})}),{nodes:p,edges:S}}function layoutGraphDefault(e,r,t,o={}){const c=e.data?.node_type.split(".")[0],u=e.data?.node_type.split(".")[1],y={data:arrangeDataCenterNode,calculation:arrangeCalculationCenterNode,workflow:arrangeWorkflowCenterNode},f=y[c]||y[u];return f?f(e,r,t,o):(console.warn("No arranger found for node type:",e.data?.node_type),{nodes:[e],edges:[]})}async function fetchUsers(e){try{const r=await fetch(`${e}/users/`);if(!r.ok)return null;const o=(await r.json()).data;return console.log("users",o),o}catch(r){return console.error("Error fetching node:",r),null}}async function fetchDownloadFormats(e){try{const r=await fetch(`${e}/nodes/download_formats/`);if(!r.ok)return null;const o=(await r.json()).data;return console.log("download_formats",o),o}catch(r){return console.error("Error fetching node:",r),null}}async function fetchNodeById(e,r){if(!r)return null;try{const t=await fetch(`${e}/nodes/${encodeURIComponent(r)}`);return t.ok?t.json():null}catch(t){return console.error("Error fetching node:",t),null}}async function fetchNodeContents(e,r){if(!r)return null;const t=["attributes","comments","extras","derived_properties"],o={};for(const c of t)try{const u=await fetch(`${e}/nodes/${encodeURIComponent(r)}/contents/${c}`);if(!u.ok){u.status!==404&&console.warn(`Endpoint ${c} failed for node ${r}:`,u.status);continue}const y=await u.json();o[c]=y?.data?.[c]??y??{}}catch(u){console.error(`Error fetching ${c} for node ${r}:`,u)}return o}async function fetchNodeRepoList(e,r){if(!r)return null;try{const t=await fetch(`${e}/nodes/${encodeURIComponent(r)}/repo/list`);return t.ok?t.json():null}catch(t){return console.error("Error fetching node:",t),null}}async function fetchAPIFullTypes(e){try{const r=await fetch(`${e}/nodes/full_types`);return r.ok?r.json():null}catch(r){return console.error("Error fetching node:",r),null}}async function fetchRetrievedUUID(e,r){if(!r)return null;try{const t=await fetch(`${e}/nodes/${encodeURIComponent(r)}/links/outgoing/`);if(!t.ok)return null;const o=await t.json();return console.log("d",o),(o?.data?.outgoing||[]).find(y=>y.link_label==="retrieved")?.uuid||null}catch(t){return console.error("Error fetching node:",t),null}}async function fetchFiles(e,r,t){if(!r)return null;const o=["input_files","output_files"],c={};for(const u of o)try{const y=`${e}/calcjobs/${encodeURIComponent(r)}/${u}`,f=await fetch(y);if(!f.ok){f.status!==404&&console.warn(`Endpoint ${u} failed for node ${r}:`,f.status);continue}const g=await f.json(),_=Array.isArray(g.data?.[u])?g.data[u]:Array.isArray(g.data)?g.data:[];console.log(r);const p=u==="input_files"?r:t,S=_.filter(A=>A.type==="FILE").map(A=>({...A,downloadUrl:`${e}/nodes/${encodeURIComponent(p)}/repo/contents?filename=%22${encodeURIComponent(A.name)}%22`}));c[u]=S}catch(y){console.error(`Error fetching ${u} for node ${r}:`,y)}return c}async function fetchJson(e,r){if(!r)return{incoming:[],outgoing:[]};try{const t=await fetch(`${e}/nodes/${encodeURIComponent(r)}/download?download_format=json`);return t.ok?t.json():null}catch(t){return console.error("Error fetching node:",t),null}}async function fetchCif(e,r){if(!r)return{cifText:null};try{const t=await fetch(`${e}/nodes/${encodeURIComponent(r)}/download?download_format=cif&download=false`);return t.ok?{cifText:(await t.json()).data.download.data||null}:{cifText:null}}catch(t){return console.error("Error fetching node:",t),{cifText:null}}}async function fetchSourceFile(e,r){if(!r)return{sourceFile:null};try{const t=await fetch(`${e}/nodes/${encodeURIComponent(r)}/repo/contents?filename=source_file`);return t.ok?{sourceFile:await t.text()}:{sourceFile:null}}catch(t){return console.error("Error fetching node:",t),{sourceFile:null}}}async function fetchGroups(e){try{const r=await fetch(`${e}/groups`);return r.ok?(await r.json())?.data?.groups||[]:null}catch(r){return console.error("Error fetching groups:",r),[]}}async function fetchFromQueryBuilder(e,r){try{const t=await fetch(`${e}/querybuilder/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return t.ok?(await t.json())?.data||[]:(console.error("QueryBuilder request failed:",t.status,t.statusText),[])}catch(t){return console.error("Error fetching from QueryBuilder:",t),[]}}async function fetchLinks(e,r){if(!r)return{incoming:[],outgoing:[]};try{const[t,o]=await Promise.all([fetch(`${e}/nodes/${encodeURIComponent(r)}/links/incoming`),fetch(`${e}/nodes/${encodeURIComponent(r)}/links/outgoing`)]),c=t.ok?await t.json():[],u=o.ok?await o.json():[];return{incoming:c,outgoing:u}}catch(t){return console.error("Error fetching links:",t),{incoming:[],outgoing:[]}}}async function fetchLinksFirstPage(e,r){if(!r)return{incoming:[],outgoing:[]};try{const[t,o]=await Promise.all([fetch(`${e}/nodes/${encodeURIComponent(r)}/links/incoming/page/1`),fetch(`${e}/nodes/${encodeURIComponent(r)}/links/outgoing/page/1`)]),c=t.ok?await t.json():[],u=o.ok?await o.json():[];return{incoming:c,outgoing:u}}catch(t){return console.error("Error fetching links:",t),{incoming:[],outgoing:[]}}}async function fetchLinkCounts(e,r=[]){if(!r.length)return r;try{return await Promise.all(r.map(async o=>{if(typeof o?.data?.parentCount=="number"&&typeof o?.data?.childCount=="number")return o;const{incoming:c,outgoing:u}=await fetchLinks(e,o.id),y=(c?.data?.incoming||[]).length,f=(u?.data?.outgoing||[]).length;return{...o,data:{...o.data,parentCount:y,childCount:f}}}))}catch(t){return console.error("Error fetching next level nodes:",t),r}}async function fetchLinkCountsFirstPage(e,r=[]){if(!r.length)return r;try{return await Promise.all(r.map(async o=>{if(typeof o?.data?.parentCount=="number"&&typeof o?.data?.childCount=="number")return o;const{incoming:c,outgoing:u}=await fetchLinksFirstPage(e,o.id),y=(c?.data?.incoming||[]).length,f=(u?.data?.outgoing||[]).length;return{...o,data:{...o.data,parentCount:y,childCount:f}}}))}catch(t){return console.error("Error fetching next level nodes:",t),r}}async function smartFetchData(e,r,t={}){const o=t[r.id];if(o)return console.log(`${r.id} data is already cached`),console.log("node",r),{...r,data:{...r.data,...o}};let c={...r.data};const u={StructureData:fetchCif,CifData:fetchCif,BandsData:fetchJson,ArrayData:fetchJson,UpfData:fetchJson,CalcFunctionNode:fetchSourceFile},y={CalcFunctionNode:fetchNodeRepoList,FolderData:fetchNodeRepoList,RemoteData:fetchNodeRepoList,BandsData:fetchNodeRepoList,ArrayData:fetchNodeRepoList},f=await fetchNodeContents(e,r.id);c={...c,...f};const g=u[r.data.label]?u[r.data.label](e,r.id):null,_=y[r.data.label]?y[r.data.label](e,r.id):null;let p=null;r.data.label==="CalcJobNode"&&(p=(async()=>{let z=c.retrievedUUID;z||(z=await fetchRetrievedUUID(e,r.id));const l=await fetchFiles(e,r.id,z);return{retrievedUUID:z,files:l}})());const[S,A,R]=await Promise.all([g,_,p]);return S&&(c.download=S),A&&(c.repo_list=A),R&&(c={...c,...R}),console.log(`Fetched data for node ${r.id}`),console.log(c),{...r,data:c}}async function fetchGraphByNodeId(e,r,t=!0){const c=(await fetchNodeById(e,r)).data.nodes[0];if(!c)return{nodes:[],edges:[]};let u,y;t?{incoming:u,outgoing:y}=await fetchLinksFirstPage(e,r):{incoming:u,outgoing:y}=await fetchLinks(e,r);const f=u?.data?.incoming||[],g=y?.data?.outgoing||[],_=[{id:c.uuid,data:{label:c.node_type.split(".").filter(Boolean).pop(),node_type:c.node_type,pos:0,aiida:c}},...f.map(A=>({id:A.uuid,data:{label:A.node_type.split(".").filter(Boolean).pop(),node_type:A.node_type,pos:1,link_label:A.link_label,aiida:A}})),...g.map(A=>({id:A.uuid,data:{label:A.node_type.split(".").filter(Boolean).pop(),node_type:A.node_type,pos:-1,link_label:A.link_label,aiida:A}}))],{nodes:p,edges:S}=layoutGraphDefault(_.find(A=>A.data.pos===0),_.filter(A=>A.data.pos===1),_.filter(A=>A.data.pos===-1));return{nodes:p,edges:S}}const columnLabels$1={uuid:"Unique ID",full_type:"Type",ctime:"Created",mtime:"Modified",id:"ID"},columnOrder$1=["Unique ID","Type","Created","Modified",""];function formatValue$1(e,r){switch(e){case"Type":return typeof r!="string"?r:r.replace(/\|$/,"").split(".").at(-1)||r;case"Created":case"Modified":return r?new Date(r).toLocaleString():"";default:return r}}function formatTableData$1(e){return e.map(r=>{const t={};return columnOrder$1.forEach(o=>{const c=Object.keys(columnLabels$1).find(u=>columnLabels$1[u]===o);c&&r[c]!==void 0&&(t[o]=formatValue$1(o,r[c]))}),t[""]=jsxRuntimeExports$1.jsx("a",{href:`?rootNode=${r.uuid}`,className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 transition",children:"View"}),t})}function GridViewer({baseUrl:e=""}){const[r,t]=reactExports.useState([]),[o,c]=reactExports.useState([]),[u,y]=reactExports.useState([]),[f,g]=reactExports.useState(null),[_,p]=reactExports.useState({});reactExports.useEffect(()=>{if(!e)return;async function z(){try{const l=await fetchAPIFullTypes(e);if(!l)return;t(l)}catch(l){console.error("Failed to fetch tree data",l)}}z()},[e]);const S=z=>{p(l=>({...l,[z]:!l[z]}))},A=reactExports.useCallback(async z=>{console.log("Selected node:",z),g(z);try{const l=`${e}/nodes/page/1?perpage=10&full_type="${z.full_type}"&orderby=-ctime`,s=await fetch(l);if(!s.ok)throw new Error("Failed to fetch node data");const w=(await s.json()).data.nodes||[];y(w),console.log("raw TD",w),c(formatTableData$1(w))}catch(l){console.error("Error fetching node data:",l)}},[e]),R=[...columnOrder$1];return jsxRuntimeExports$1.jsxs("div",{className:"flex gap-4 mt-2 ml-2 overflow-auto",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex-shrink-0",children:[jsxRuntimeExports$1.jsx("h3",{className:"pb-2 px-2",children:"AiiDA node datatypes:"}),r?.data?.subspaces?.map(z=>jsxRuntimeExports$1.jsx(TreeDropdown,{data:z,onSelect:A,openNodes:_,toggleNode:S},z.full_type))]}),jsxRuntimeExports$1.jsx("div",{className:"flex-1",children:o.length>0&&f&&jsxRuntimeExports$1.jsx(DataTable,{title:`All nodes with datatype ${f.full_type.split(".").slice(-2)[0]}:`,columns:R,data:o,sortableCols:["Unique ID","Type","Created","Modified"]})})]})}const columnLabels={uuid:"Unique ID",label:"Label",full_type:"Type",ctime:"Created",mtime:"Modified",id:"ID"},columnOrder=["Unique ID","Label","Type","Created","Modified",""];function formatValue(e,r){switch(e){case"Type":return typeof r!="string"?r:r.replace(/\|$/,"").split(".").at(-1)||r;case"Created":case"Modified":return r?new Date(r).toLocaleString():"";default:return r}}function formatTableData(e){return e.map(r=>{const t={};return columnOrder.forEach(o=>{const c=Object.keys(columnLabels).find(u=>columnLabels[u]===o);c&&r[c]!==void 0&&(t[o]=formatValue(o,r[c]))}),t[""]=jsxRuntimeExports$1.jsx("a",{href:`?rootNode=${r.uuid}`,className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 transition",children:"View"}),t})}function buildQuery({groups:e=[],nodeTypes:r=[],limit:t=50,offset:o=0}={}){const c=[{entity_type:"",orm_base:"node",tag:"node",joining_keyword:null,joining_value:null,edge_tag:null,outerjoin:!1}],u={node:{}},y={node:["id","uuid","node_type","label","ctime","mtime"]};if(r.length===1?u.node.node_type={like:r[0]}:r.length>1&&(u.node={or:r.map(f=>({node_type:{like:f}}))}),e.length>0){const f="core_1",g="node--core_1";c.push({entity_type:"group.core",orm_base:"group",tag:f,joining_keyword:"with_node",joining_value:"node",edge_tag:g,outerjoin:!1}),u[f]={type_string:{like:"%"},or:e.map(_=>({label:_}))},u[g]={},y[f]=[],y[g]=[]}return{path:c,filters:u,project:y,project_map:{},order_by:[],limit:t,offset:o,distinct:!0}}function GroupIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"M15.536 11.293a1 1 0 0 0 0 1.414l2.376 2.377a1 1 0 0 0 1.414 0l2.377-2.377a1 1 0 0 0 0-1.414l-2.377-2.377a1 1 0 0 0-1.414 0z"}),jsxRuntimeExports$1.jsx("path",{d:"M2.297 11.293a1 1 0 0 0 0 1.414l2.377 2.377a1 1 0 0 0 1.414 0l2.377-2.377a1 1 0 0 0 0-1.414L6.088 8.916a1 1 0 0 0-1.414 0z"}),jsxRuntimeExports$1.jsx("path",{d:"M8.916 17.912a1 1 0 0 0 0 1.415l2.377 2.376a1 1 0 0 0 1.414 0l2.377-2.376a1 1 0 0 0 0-1.415l-2.377-2.376a1 1 0 0 0-1.414 0z"}),jsxRuntimeExports$1.jsx("path",{d:"M8.916 4.674a1 1 0 0 0 0 1.414l2.377 2.376a1 1 0 0 0 1.414 0l2.377-2.376a1 1 0 0 0 0-1.414l-2.377-2.377a1 1 0 0 0-1.414 0z"})]})}function XIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"M18 6 6 18"}),jsxRuntimeExports$1.jsx("path",{d:"m6 6 12 12"})]})}function DownloadIcon({data:e=null,downloadUrl:r=null,filename:t="data.json",size:o=14,className:c=""}){const u=()=>{if(r){const y=document.createElement("a");y.href=r,y.download=t,y.target="_blank",y.rel="noopener noreferrer",y.click();return}if(e){const y=JSON.stringify(e,null,2),f=new Blob([y],{type:"application/json"}),g=URL.createObjectURL(f),_=document.createElement("a");_.href=g,_.download=t,_.click(),URL.revokeObjectURL(g)}};return jsxRuntimeExports$1.jsx("button",{type:"button",onClick:u,title:"Download",className:"p-1 hover:text-blue-600",children:jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:c,children:[jsxRuntimeExports$1.jsx("path",{d:"M12 15V3"}),jsxRuntimeExports$1.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),jsxRuntimeExports$1.jsx("path",{d:"m7 10 5 5 5-5"})]})})}function ClipBoardIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),jsxRuntimeExports$1.jsx("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})]})}function ClipboardCopyIcon({size:e=18,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"m12 15 2 2 4-4"}),jsxRuntimeExports$1.jsx("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),jsxRuntimeExports$1.jsx("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})]})}function RightDropDownIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:jsxRuntimeExports$1.jsx("path",{d:"m9 18 6-6-6-6"})})}function DownDropDownIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:jsxRuntimeExports$1.jsx("path",{d:"m6 9 6 6 6-6"})})}function ViewIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}),jsxRuntimeExports$1.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}function LinksIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),jsxRuntimeExports$1.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]})}function QuestionIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("circle",{cx:"12",cy:"12",r:"10"}),jsxRuntimeExports$1.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),jsxRuntimeExports$1.jsx("path",{d:"M12 17h.01"})]})}function ClickIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"M12.034 12.681a.498.498 0 0 1 .647-.647l9 3.5a.5.5 0 0 1-.033.943l-3.444 1.068a1 1 0 0 0-.66.66l-1.067 3.443a.5.5 0 0 1-.943.033z"}),jsxRuntimeExports$1.jsx("path",{d:"M5 3a2 2 0 0 0-2 2"}),jsxRuntimeExports$1.jsx("path",{d:"M19 3a2 2 0 0 1 2 2"}),jsxRuntimeExports$1.jsx("path",{d:"M5 21a2 2 0 0 1-2-2"}),jsxRuntimeExports$1.jsx("path",{d:"M9 3h1"}),jsxRuntimeExports$1.jsx("path",{d:"M9 21h2"}),jsxRuntimeExports$1.jsx("path",{d:"M14 3h1"}),jsxRuntimeExports$1.jsx("path",{d:"M3 9v1"}),jsxRuntimeExports$1.jsx("path",{d:"M21 9v2"}),jsxRuntimeExports$1.jsx("path",{d:"M3 14v1"})]})}function ClickIcon2({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:jsxRuntimeExports$1.jsx("path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z"})})}function DoubleClickIcon({size:e=24,className:r}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"M14 4.1 12 6"}),jsxRuntimeExports$1.jsx("path",{d:"m5.1 8-2.9-.8"}),jsxRuntimeExports$1.jsx("path",{d:"m6 12-1.9 2"}),jsxRuntimeExports$1.jsx("path",{d:"M7.2 2.2 8 5.1"}),jsxRuntimeExports$1.jsx("path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z"})]})}function BreadcrumbsIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"M16 14v2.2l1.6 1"}),jsxRuntimeExports$1.jsx("path",{d:"M7 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2"}),jsxRuntimeExports$1.jsx("circle",{cx:"16",cy:"16",r:"6"})]})}function GraphIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("rect",{x:"16",y:"16",width:"6",height:"6",rx:"1"}),jsxRuntimeExports$1.jsx("rect",{x:"2",y:"16",width:"6",height:"6",rx:"1"}),jsxRuntimeExports$1.jsx("rect",{x:"9",y:"2",width:"6",height:"6",rx:"1"}),jsxRuntimeExports$1.jsx("path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3"}),jsxRuntimeExports$1.jsx("path",{d:"M12 12V8"})]})}function GithubIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"}),jsxRuntimeExports$1.jsx("path",{d:"M9 18c-4.51 2-5-2-7-2"})]})}const aiidaTypes=[{label:"Data",type:"data",children:[{label:"Int",type:"data.core.int.%"},{label:"Float",type:"data.core.float.%"},{label:"ArrayData",type:"data.core.array.%",children:[{label:"ArrayData",type:"data.core.array.%"},{label:"BandsData",type:"data.core.array.bands.%"},{label:"XyData",type:"data.core.array.xy.%"},{label:"TrajectoryData",type:"data.core.array.trajectory.%"},{label:"KpointsData",type:"data.core.array.kpoints.%"}]},{label:"Str",type:"data.core.str.%"},{label:"Bool",type:"data.core.bool.%"},{label:"List",type:"data.core.list.%"},{label:"Dict",type:"data.core.dict.%"},{label:"StructureData",type:"data.core.structure.%"},{label:"RemoteData",type:"data.core.remote.%"},{label:"FolderData",type:"data.core.folder.%"},{label:"SinglefileData",type:"data.core.singlefile.%"},{label:"UpfData",type:"data.core.upf.%"},{label:"Code",type:"data.core.code.%"}]},{label:"Process",type:"process.%",children:[{label:"CalcJob",type:"process.calculation.calcjob.%"},{label:"CalcFunction",type:"process.calculation.calcjob.%"},{label:"WorkFunction",type:"process.workflow.workfunction.%"},{label:"Workgraph",type:"process.workflow.workgraph.%"},{label:"Workchain",type:"process.workflow.workgraph.%"}]}];function getFlattenedNodeTypes(e,r){const t=[],o=c=>{c.forEach(u=>{e.includes(u.label)&&t.push(u.type),u.children&&o(u.children)})};return o(r),t}function TypeCheckboxTree({types:e,selectedTypes:r,setSelectedTypes:t,level:o=0}){const[c,u]=reactExports.useState({}),y=_=>_.every(p=>r.includes(p.label)),f=_=>_.some(p=>r.includes(p.label))&&!y(_),g=(_,p)=>{if(!p||p.length===0){t(A=>A.includes(_)?A.filter(R=>R!==_):[...A,_]);return}t(A=>{const R=new Set(A),z=(s,v)=>{s.forEach(w=>{v?R.add(w.label):R.delete(w.label),w.children&&z(w.children,v)})};return R.has(_)&&y(p)?(R.delete(_),z(p,!1)):(R.add(_),z(p,!0)),[...R]});const S=A=>{const R={};return A.forEach(z=>{z.children&&(R[z.label]=!0,Object.assign(R,S(z.children)))}),R};u(A=>({...A,[_]:!0,...S(p)}))};return jsxRuntimeExports$1.jsx("div",{className:"flex flex-col",children:e.map(({label:_,children:p})=>{const S=r.includes(_),A=p&&f(p);return jsxRuntimeExports$1.jsxs("div",{style:{marginLeft:`${o*8}px`},children:[jsxRuntimeExports$1.jsxs("div",{className:"flex items-center gap-1 cursor-pointer",onClick:()=>g(_,p),children:[jsxRuntimeExports$1.jsx("input",{type:"checkbox",checked:S,ref:R=>{R&&(R.indeterminate=A)},onChange:R=>R.stopPropagation()}),p&&p.length>0&&jsxRuntimeExports$1.jsx("button",{type:"button",onClick:R=>{R.stopPropagation(),u(z=>({...z,[_]:!z[_]}))},className:"p-0.5 focus:outline-none",children:c[_]?jsxRuntimeExports$1.jsx(DownDropDownIcon,{size:14}):jsxRuntimeExports$1.jsx(RightDropDownIcon,{size:14})}),jsxRuntimeExports$1.jsx("span",{children:_})]}),p&&p.length>0&&c[_]&&jsxRuntimeExports$1.jsx(TypeCheckboxTree,{types:p,selectedTypes:r,setSelectedTypes:t,level:o+1})]},_)})})}function sortGroups(e){return[...e].sort((r,t)=>{const o=/^\d/.test(r.label),c=/^\d/.test(t.label);return o&&!c?1:!o&&c?-1:r.label.localeCompare(t.label,void 0,{numeric:!0})})}function GroupsViewer2({baseUrl:e=""}){const[r,t]=reactExports.useState([]),[o,c]=reactExports.useState([]),[u,y]=reactExports.useState([]),[f,g]=reactExports.useState([]),[_,p]=reactExports.useState(0),S=200;reactExports.useEffect(()=>{fetchGroups(e).then(t)},[e]),reactExports.useEffect(()=>{r.length>0&&f.length===0&&A(0,1e3)},[r,f.length]);const A=async(R=0,z=S)=>{try{const l=getFlattenedNodeTypes(u,aiidaTypes),s=buildQuery({groups:o,nodeTypes:l,limit:z,offset:R}),w=(await fetchFromQueryBuilder(e,s)).node||[];g(E=>R===0?formatTableData(w):[...E,...formatTableData(w)]),p(R+w.length)}catch(l){console.error("Failed to fetch nodes:",l)}};return jsxRuntimeExports$1.jsxs("div",{className:"flex gap-4 p-3 overflow-auto w-full items-start",children:[jsxRuntimeExports$1.jsxs("div",{className:"min-w-[250px] max-w-[400px] flex-shrink-0 bg-slate-50 p-2 px-4 rounded",children:[jsxRuntimeExports$1.jsx("h4",{className:"font-medium mt-4 mb-2",children:"Filter by Node Types"}),jsxRuntimeExports$1.jsx(TypeCheckboxTree,{types:aiidaTypes,selectedTypes:u,setSelectedTypes:y}),jsxRuntimeExports$1.jsx("h4",{className:"font-medium my-2 mt-4",children:"Filter by Defined Groups"}),sortGroups(r).map(R=>jsxRuntimeExports$1.jsxs("label",{className:"flex items-start gap-2 mb-1",children:[jsxRuntimeExports$1.jsx("input",{type:"checkbox",className:"mt-1",checked:o.includes(R.label),onChange:z=>c(l=>z.target.checked?[...l,R.label]:l.filter(s=>s!==R.label))}),jsxRuntimeExports$1.jsx("span",{className:"truncate block",title:R.label,children:R.label})]},R.label)),jsxRuntimeExports$1.jsx("button",{onClick:()=>A(0),className:"px-3 py-1 my-2 ml-2 rounded bg-indigo-700 text-white hover:bg-indigo-800 transition",children:"Apply"})]}),jsxRuntimeExports$1.jsxs("div",{className:"flex-1 bg-white p-2 rounded",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports$1.jsxs("h4",{className:"text-xl font-semibold",children:[f.length," nodes loaded"]}),f.length>0&&jsxRuntimeExports$1.jsx("button",{onClick:()=>A(_),className:"px-3 py-1 mr-10 rounded bg-gray-700 text-white hover:bg-gray-800 transition",children:"Load next 200"})]}),jsxRuntimeExports$1.jsx(DataTable,{columns:columnOrder,data:f||[],sortableCols:["Unique ID","Label","Type","Created","Modified"],renderIfMissing:!0})]})]})}function HelpViewer(){return jsxRuntimeExports$1.jsxs("div",{className:"p-6 w-full h-full overflow-y-auto bg-white",children:[jsxRuntimeExports$1.jsx("h2",{className:"text-2xl font-semibold mb-6 text-blue-700",children:"Aiida Explorer Help"}),jsxRuntimeExports$1.jsxs("section",{className:"mb-4",children:[jsxRuntimeExports$1.jsx("h3",{className:"text-xl  mb-3 flex items-center gap-2",children:"Overview"}),jsxRuntimeExports$1.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Aiida Explorer is an interactive tool for visualizing AiiDA workflows and calculations. You can navigate nodes, inspect their details, and explore relationships between workflows, calculations, and data nodes. This tool leverages the"," ",jsxRuntimeExports$1.jsx("a",{href:"https://aiida.readthedocs.io/projects/aiida-core/en/stable/internals/rest_api.html",className:"text-blue-400 hover:underline hover:text-blue-700",target:"_blank",children:"AiiDA REST API"})," ","and presents data retrieved from it in a curated manner."]})]}),jsxRuntimeExports$1.jsxs("section",{className:"mb-4",children:[jsxRuntimeExports$1.jsxs("h3",{className:"text-xl  mb-3 flex items-center gap-2",children:[jsxRuntimeExports$1.jsx(GraphIcon,{size:24})," Provenance"]}),jsxRuntimeExports$1.jsxs("p",{className:"text-gray-700 leading-relaxed",children:["Using AiiDA for high-throughput workflows comes with the benefit of AiiDA provenence. This provenence stores how calculations were performed and the results from them. Every node is part of a directed acyclic graph (DAG) that records the inputs, outputs, and intermediate steps. Understanding provenance helps reproducability and facilitates sharing. Learn more in the"," ",jsxRuntimeExports$1.jsx("a",{href:"https://aiida.readthedocs.io/projects/aiida-core/en/latest/",className:"text-blue-400 hover:underline hover:text-blue-700",target:"_blank",children:"official docs."})," ","This tool uses the the 'API endpoint /links' to build up a local view of each node."]})]}),jsxRuntimeExports$1.jsxs("section",{className:"mb-4",children:[jsxRuntimeExports$1.jsxs("h3",{className:"text-xl  mb-3 flex items-center gap-2",children:[jsxRuntimeExports$1.jsx(ClickIcon,{size:24})," Inspecting Nodes"]}),jsxRuntimeExports$1.jsxs("ul",{className:"pl-4 list-inside text-gray-700 space-y-1",children:[jsxRuntimeExports$1.jsxs("li",{className:"flex items-center gap-2",children:[jsxRuntimeExports$1.jsxs("strong",{className:"flex items-center gap-1",children:[jsxRuntimeExports$1.jsx(ClickIcon2,{size:22})," Click a node:"]}),jsxRuntimeExports$1.jsx("span",{className:"text-gray-700",children:"Highlights the node and displays detailed information in the side panel."})]}),jsxRuntimeExports$1.jsxs("li",{className:"flex items-center gap-2",children:[jsxRuntimeExports$1.jsxs("strong",{className:"flex items-center gap-1",children:[jsxRuntimeExports$1.jsx(DoubleClickIcon,{size:22})," Double-click a node:"]}),jsxRuntimeExports$1.jsx("span",{className:"text-gray-700",children:jsxRuntimeExports$1.jsx("li",{children:"Sets the node as the central focus, building the links and centering the graph."})})]}),jsxRuntimeExports$1.jsxs("li",{className:"flex items-center gap-2",children:[jsxRuntimeExports$1.jsxs("strong",{className:"flex items-center gap-1",children:[jsxRuntimeExports$1.jsx(BreadcrumbsIcon,{size:22})," Breadcrumbs:"]}),jsxRuntimeExports$1.jsx("span",{className:"text-gray-700",children:jsxRuntimeExports$1.jsx("li",{children:"Quickly navigate back to previously explored nodes. A history of the last 10 visited nodes. is retained."})})]})]})]}),jsxRuntimeExports$1.jsxs("section",{className:"mb-4",children:[jsxRuntimeExports$1.jsxs("h3",{className:"text-xl  mb-3 flex items-center gap-2",children:[jsxRuntimeExports$1.jsx(GraphIcon,{size:26})," Buttons & Controls"]}),jsxRuntimeExports$1.jsxs("ul",{className:"pl-4 list-inside text-gray-700 space-y-1 ",children:[jsxRuntimeExports$1.jsxs("li",{className:"flex items-center gap-2",children:[jsxRuntimeExports$1.jsxs("strong",{className:"flex items-center gap-1",children:[jsxRuntimeExports$1.jsx(GroupIcon,{size:22})," Query Database:"]}),jsxRuntimeExports$1.jsx("span",{className:"text-gray-700",children:"Provides a graphical interface for simple AiiDA queries using the querybuilder endpoint."})]}),jsxRuntimeExports$1.jsxs("li",{className:"flex items-center gap-2",children:[jsxRuntimeExports$1.jsxs("strong",{className:"flex items-center gap-1",children:[jsxRuntimeExports$1.jsx(LinksIcon,{size:20})," Get Counts:"]}),jsxRuntimeExports$1.jsx("span",{className:"text-gray-700",children:"PFetches the parent/child counts for all nodes currently visible in the graph."})]}),jsxRuntimeExports$1.jsxs("li",{className:"flex items-center gap-2",children:[jsxRuntimeExports$1.jsxs("strong",{className:"flex items-center gap-1",children:[jsxRuntimeExports$1.jsx(QuestionIcon,{size:20})," Help:"]}),jsxRuntimeExports$1.jsx("span",{className:"text-gray-700",children:"Opens this help overlay."})]}),jsxRuntimeExports$1.jsx("li",{})]})]}),jsxRuntimeExports$1.jsxs("p",{className:"text-gray-500 text-sm mt-6",children:["This tool is currently in beta testing stage. Report unexpected behaviour, bugs or general suggestions on"," ",jsxRuntimeExports$1.jsxs("a",{href:"https://github.com/Bud-Macaulay/aiida-explorer/issues/new",className:"group inline-flex items-center gap-0.5 text-blue-400",target:"_blank",children:[jsxRuntimeExports$1.jsx("span",{className:"transition-colors group-hover:text-blue-700",children:"GitHub."}),jsxRuntimeExports$1.jsx("span",{className:"inline-flex items-center justify-center w-5 h-5 rounded-full bg-blue-400 group-hover:bg-blue-700 transition-colors",children:jsxRuntimeExports$1.jsx(GithubIcon,{className:"w-[18-px] h-[18px] text-white"})})]})]})]})}function omitGraphKeys(e){const r=["label","node_type","pos","link_label"];return e==null||typeof e!="object"?e:Array.isArray(e)?e.map(t=>omitGraphKeys(t)):Object.fromEntries(Object.entries(e).filter(([t])=>!r.includes(t)).map(([t,o])=>[t,omitGraphKeys(o)]))}function KpointsDataVisualiser({nodeData:e={}}){e.download;const r=e.attributes||{},t=e.derivedProperties||{};if(!r&&!t)return jsxRuntimeExports$1.jsx("div",{children:"No attributes available"});const o=["x","y","z"],c=(r.cell||[]).map(R=>({x:R[0],y:R[1],z:R[2]})),u=["dimension","value"],y=(r.mesh||[]).map((R,z)=>({dimension:z+1,value:R})),f=["i","x","y","z"],g=(r.offset||[]).map((R,z)=>({i:z+1,x:R[0]??R,y:R[1]??0,z:R[2]??0})),_=["axis","periodic"],p=["pbc1","pbc2","pbc3"].filter(R=>R in r).map(R=>({axis:R,periodic:r[R]?"True":"False"})),S=["K-point number","x","y","z"],A=(t.explicit_kpoints_abs||[]).map((R,z)=>({"K-point number":z+1,x:R[0],y:R[1],z:R[2]}));return jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4 space-y-6 overflow-y-auto",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports$1.jsx("h3",{className:"text-2xl",children:"Kpoints Data"}),jsxRuntimeExports$1.jsx(DownloadIcon,{data:omitGraphKeys(e),filename:`${e.aiida.uuid}_KpointNodeDetails.json`,size:22,className:"pb-0.5"})]}),jsxRuntimeExports$1.jsx(DataTable,{title:"Cell",columns:o,data:c,sortableCols:!1},"cell"),jsxRuntimeExports$1.jsx(DataTable,{title:"Mesh",columns:u,data:y,sortableCols:!1},"mesh"),jsxRuntimeExports$1.jsx(DataTable,{title:"Offset",columns:f,data:g,sortableCols:!1},"offset"),jsxRuntimeExports$1.jsx(DataTable,{title:"PBC Flags",columns:_,data:p,sortableCols:!1},"pbc"),jsxRuntimeExports$1.jsx(DataTable,{title:"Explicit K-points (Absolute)",columns:S,data:A,sortableCols:!1},"kpoints")]})}function FolderDataVisualiser({nodeData:e}){const t=(e?.repo_list?.data?.repo_list??[]).map(o=>({Files:o.name}));return jsxRuntimeExports$1.jsx("div",{className:"w-full h-full p-4 space-y-6 overflow-y-auto",children:jsxRuntimeExports$1.jsx(DataTable,{title:"Folder Files",columns:["Files"],data:t,sortableCols:!1})})}function CalcJobVisualiser({nodeData:e={}}){const r=e.files||{},t=Array.isArray(r.input_files)?r.input_files:[],o=Array.isArray(r.output_files)?r.output_files:[],[c,u]=reactExports.useState(null),[y,f]=reactExports.useState(null),[g,_]=reactExports.useState(!1),p=async l=>{try{const v=await(await fetch(l.downloadUrl)).text();u(v),f(l.name),_(!0)}catch(s){console.error("Error loading preview:",s),u("Failed to load file."),_(!0)}},S=["Files","Download","View"],A=t.map(l=>({Files:l.name,Download:jsxRuntimeExports$1.jsx("a",{href:l.downloadUrl||"#",download:l.name||void 0,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 transition-colors",children:jsxRuntimeExports$1.jsx(DownloadIcon,{size:18})}),View:jsxRuntimeExports$1.jsx("button",{type:"button",onClick:()=>p(l),className:"text-green-600 hover:text-green-800 transition-colors",children:jsxRuntimeExports$1.jsx(ViewIcon,{size:18})})})),R=["Files","Download","View"],z=o.map(l=>({Files:l.name,Download:jsxRuntimeExports$1.jsx("a",{href:l.downloadUrl||"#",download:l.name||void 0,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 transition-colors",children:jsxRuntimeExports$1.jsx(DownloadIcon,{size:18})}),View:jsxRuntimeExports$1.jsx("button",{type:"button",onClick:()=>p(l),className:"text-green-600 hover:text-green-800 transition-colors",children:jsxRuntimeExports$1.jsx(ViewIcon,{size:18})})}));return jsxRuntimeExports$1.jsxs(jsxRuntimeExports$1.Fragment,{children:[jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4 space-y-6 overflow-y-auto",children:[A.length>0&&jsxRuntimeExports$1.jsx(DataTable,{title:"Input Files (in this node)",columns:S,data:A,sortableCols:["Files"]}),z.length>0&&jsxRuntimeExports$1.jsx(DataTable,{title:"Output Files (retrieved)",columns:R,data:z,sortableCols:["Files"]}),A.length===0&&z.length===0&&jsxRuntimeExports$1.jsx("div",{children:"No files available"})]}),g&&ReactDOM.createPortal(jsxRuntimeExports$1.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999]",onClick:()=>_(!1),children:jsxRuntimeExports$1.jsxs("div",{className:`bg-white p-4 rounded-xl shadow-lg w-[600px] max-h-[80vh] flex flex-col 
                         transform transition-all duration-200 ease-out animate-fadeIn`,onClick:l=>l.stopPropagation(),children:[jsxRuntimeExports$1.jsxs("div",{className:"flex justify-between items-center border-b pb-2 mb-2",children:[jsxRuntimeExports$1.jsxs("h2",{className:"text-lg font-semibold",children:["Preview: ",y||"File"]}),jsxRuntimeExports$1.jsx("button",{onClick:()=>_(!1),className:"text-gray-600 hover:text-black",children:"✕"})]}),jsxRuntimeExports$1.jsx("pre",{className:"overflow-y-auto whitespace-pre-wrap text-sm flex-1",children:c})]})}),document.body)]})}function UpfDataVisualiser({nodeData:e={},baseUrl:r=""}){const t=e.aiida.uuid,o=e.download,c=e.attributes,u=y=>!y||typeof y!="object"?[]:Object.entries(y).map(([f,g])=>({Key:f,Value:g==null?"—":typeof g=="object"?JSON.stringify(g,null,2):String(g)}));return jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4 space-y-6 overflow-y-auto",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports$1.jsx("h3",{className:"text-2xl",children:"UpfData Node"}),jsxRuntimeExports$1.jsx(DownloadIcon,{downloadUrl:`${r}/nodes/${t}/download?download_format=upf`,filename:`${o.pseudo_potential.header.original_upf_file}`,size:22,className:"pb-0.5"})]}),jsxRuntimeExports$1.jsx(DataTable,{title:"Attributes",columns:["Key","Value"],data:u(c)},"attributes")]})}const isBoolean=e=>typeof e=="boolean"||e instanceof Boolean,isNumber=e=>typeof e=="number"||e instanceof Number,isBigInt=e=>typeof e=="bigint"||e instanceof BigInt,isDate=e=>!!e&&e instanceof Date,isString=e=>typeof e=="string"||e instanceof String,isArray=e=>Array.isArray(e),isObject=e=>typeof e=="object"&&e!==null,isFunction=e=>!!e&&e instanceof Object&&typeof e=="function";function quoteString(e,r){return r===void 0&&(r=!1),!e||r?`"${e}"`:e}function quoteStringValue(e,r,t){return t?JSON.stringify(e):r?`"${e}"`:e}function ExpandableObject(e){let{field:r,value:t,data:o,lastElement:c,openBracket:u,closeBracket:y,level:f,style:g,shouldExpandNode:_,clickToExpandNode:p,outerRef:S,beforeExpandChange:A}=e;const R=reactExports.useRef(!1),[z,l]=reactExports.useState(()=>_(f,t,r)),s=reactExports.useRef(null);reactExports.useEffect(()=>{R.current?l(_(f,t,r)):R.current=!0},[_]);const v=reactExports.useId();if(o.length===0)return EmptyObject({field:r,openBracket:u,closeBracket:y,lastElement:c,style:g});const w=z?g.collapseIcon:g.expandIcon,E=z?g.ariaLables.collapseJson:g.ariaLables.expandJson,C=f+1,h=o.length-1,x=D=>{z!==D&&(!A||A({level:f,value:t,field:r,newExpandValue:D}))&&l(D)},k=D=>{if(D.key==="ArrowRight"||D.key==="ArrowLeft")D.preventDefault(),x(D.key==="ArrowRight");else if(D.key==="ArrowUp"||D.key==="ArrowDown"){D.preventDefault();const P=D.key==="ArrowUp"?-1:1;if(!S.current)return;const F=S.current.querySelectorAll("[role=button]");let X=-1;for(let L=0;L<F.length;L++)if(F[L].tabIndex===0){X=L;break}if(X<0)return;const B=(X+P+F.length)%F.length;F[X].tabIndex=-1,F[B].tabIndex=0,F[B].focus()}},M=()=>{var D;x(!z);const P=s.current;if(!P)return;const F=(D=S.current)===null||D===void 0?void 0:D.querySelector('[role=button][tabindex="0"]');F&&(F.tabIndex=-1),P.tabIndex=0,P.focus()};return reactExports.createElement("div",{className:g.basicChildStyle,role:"treeitem","aria-expanded":z,"aria-selected":void 0},reactExports.createElement("span",{className:w,onClick:M,onKeyDown:k,role:"button","aria-label":E,"aria-expanded":z,"aria-controls":z?v:void 0,ref:s,tabIndex:f===0?0:-1}),(r||r==="")&&(p?reactExports.createElement("span",{className:g.clickableLabel,onClick:M,onKeyDown:k},quoteString(r,g.quotesForFieldNames),":"):reactExports.createElement("span",{className:g.label},quoteString(r,g.quotesForFieldNames),":")),reactExports.createElement("span",{className:g.punctuation},u),z?reactExports.createElement("ul",{id:v,role:"group",className:g.childFieldsContainer},o.map((D,P)=>reactExports.createElement(DataRender,{key:D[0]||P,field:D[0],value:D[1],style:g,lastElement:P===h,level:C,shouldExpandNode:_,clickToExpandNode:p,beforeExpandChange:A,outerRef:S}))):reactExports.createElement("span",{className:g.collapsedContent,onClick:M,onKeyDown:k}),reactExports.createElement("span",{className:g.punctuation},y),!c&&reactExports.createElement("span",{className:g.punctuation},","))}function EmptyObject(e){let{field:r,openBracket:t,closeBracket:o,lastElement:c,style:u}=e;return reactExports.createElement("div",{className:u.basicChildStyle,role:"treeitem","aria-selected":void 0},(r||r==="")&&reactExports.createElement("span",{className:u.label},quoteString(r,u.quotesForFieldNames),":"),reactExports.createElement("span",{className:u.punctuation},t),reactExports.createElement("span",{className:u.punctuation},o),!c&&reactExports.createElement("span",{className:u.punctuation},","))}function JsonObject(e){let{field:r,value:t,style:o,lastElement:c,shouldExpandNode:u,clickToExpandNode:y,level:f,outerRef:g,beforeExpandChange:_}=e;return ExpandableObject({field:r,value:t,lastElement:c||!1,level:f,openBracket:"{",closeBracket:"}",style:o,shouldExpandNode:u,clickToExpandNode:y,data:Object.keys(t).map(p=>[p,t[p]]),outerRef:g,beforeExpandChange:_})}function JsonArray(e){let{field:r,value:t,style:o,lastElement:c,level:u,shouldExpandNode:y,clickToExpandNode:f,outerRef:g,beforeExpandChange:_}=e;return ExpandableObject({field:r,value:t,lastElement:c||!1,level:u,openBracket:"[",closeBracket:"]",style:o,shouldExpandNode:y,clickToExpandNode:f,data:t.map(p=>[void 0,p]),outerRef:g,beforeExpandChange:_})}function JsonPrimitiveValue(e){let{field:r,value:t,style:o,lastElement:c}=e,u,y=o.otherValue;return t===null?(u="null",y=o.nullValue):t===void 0?(u="undefined",y=o.undefinedValue):isString(t)?(u=quoteStringValue(t,!o.noQuotesForStringValues,o.stringifyStringValues),y=o.stringValue):isBoolean(t)?(u=t?"true":"false",y=o.booleanValue):isNumber(t)?(u=t.toString(),y=o.numberValue):isBigInt(t)?(u=`${t.toString()}n`,y=o.numberValue):isDate(t)?u=t.toISOString():isFunction(t)?u="function() { }":u=t.toString(),reactExports.createElement("div",{className:o.basicChildStyle,role:"treeitem","aria-selected":void 0},(r||r==="")&&reactExports.createElement("span",{className:o.label},quoteString(r,o.quotesForFieldNames),":"),reactExports.createElement("span",{className:y},u),!c&&reactExports.createElement("span",{className:o.punctuation},","))}function DataRender(e){const r=e.value;return isArray(r)?reactExports.createElement(JsonArray,Object.assign({},e)):isObject(r)&&!isDate(r)&&!isFunction(r)?reactExports.createElement(JsonObject,Object.assign({},e)):reactExports.createElement(JsonPrimitiveValue,Object.assign({},e))}var styles={"container-light":"_2IvMF _GzYRV","basic-element-style":"_2bkNM","child-fields-container":"_1BXBN","label-light":"_1MGIk","clickable-label-light":"_2YKJg _1MGIk _1MFti","punctuation-light":"_3uHL6 _3eOF8","value-null-light":"_2T6PJ","value-undefined-light":"_1Gho6","value-string-light":"_vGjyY","value-number-light":"_1bQdo","value-boolean-light":"_3zQKs","value-other-light":"_1xvuR","collapse-icon-light":"_oLqym _f10Tu _1MFti _1LId0","expand-icon-light":"_2AXVT _f10Tu _1MFti _1UmXx","collapsed-content-light":"_2KJWg _1pNG9 _1MFti"};const defaultAriaLables={collapseJson:"collapse JSON",expandJson:"expand JSON"},defaultStyles={container:styles["container-light"],basicChildStyle:styles["basic-element-style"],childFieldsContainer:styles["child-fields-container"],label:styles["label-light"],clickableLabel:styles["clickable-label-light"],nullValue:styles["value-null-light"],undefinedValue:styles["value-undefined-light"],stringValue:styles["value-string-light"],booleanValue:styles["value-boolean-light"],numberValue:styles["value-number-light"],otherValue:styles["value-other-light"],punctuation:styles["punctuation-light"],collapseIcon:styles["collapse-icon-light"],expandIcon:styles["expand-icon-light"],collapsedContent:styles["collapsed-content-light"],noQuotesForStringValues:!1,quotesForFieldNames:!1,ariaLables:defaultAriaLables,stringifyStringValues:!1},allExpanded=()=>!0,JsonView=e=>{let{data:r,style:t=defaultStyles,shouldExpandNode:o=allExpanded,clickToExpandNode:c=!1,beforeExpandChange:u,compactTopLevel:y,...f}=e;const g=reactExports.useRef(null);return reactExports.createElement("div",Object.assign({"aria-label":"JSON view"},f,{className:t.container,ref:g,role:"tree"}),y&&isObject(r)?Object.entries(r).map(_=>{let[p,S]=_;return reactExports.createElement(DataRender,{key:p,field:p,value:S,style:{...defaultStyles,...t},lastElement:!0,level:1,shouldExpandNode:o,clickToExpandNode:c,beforeExpandChange:u,outerRef:g})}):reactExports.createElement(DataRender,{value:r,style:{...defaultStyles,...t},lastElement:!0,level:0,shouldExpandNode:o,clickToExpandNode:c,outerRef:g,beforeExpandChange:u}))};function RawDataVisualiser({nodeData:e={}}){const r=[{title:"Attributes",data:e.attributes},{title:"Download",data:e.download},{title:"Derived Properties",data:e.derived_properties},{title:"Repository List",data:e.repo_list},{title:"Files",data:e.files},{title:"Extras",data:e.extras},{title:"Full AIIDA Metadata",data:e.aiida,collapseLevel:0}],[t,o]=reactExports.useState(null),c=(u,y)=>{navigator.clipboard.writeText(JSON.stringify(u,null,2)),o(y),setTimeout(()=>o(null),700)};return jsxRuntimeExports$1.jsx("div",{className:"flex flex-col gap-4 p-4",children:r.map((u,y)=>{const f=u.data||{};return Object.keys(f).length===0?null:jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports$1.jsx("h3",{className:"text-lg font-semibold",children:u.title}),jsxRuntimeExports$1.jsxs("button",{className:"relative flex items-center gap-1 hover:text-blue-500",onClick:()=>c(f,y),children:[jsxRuntimeExports$1.jsx(ClipBoardIcon,{size:22}),jsxRuntimeExports$1.jsxs("div",{className:`absolute left-full ml-2 top-1/2 -translate-y-1/2 flex items-center gap-1 text-green-400 text-sm transition-all duration-400 transform ${t===y?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:[jsxRuntimeExports$1.jsx(ClipboardCopyIcon,{size:16}),jsxRuntimeExports$1.jsx("span",{children:"Copied"})]})]})]}),jsxRuntimeExports$1.jsx("div",{className:"max-h-96 overflow-auto border border-gray-200 rounded p-2 bg-gray-50",children:jsxRuntimeExports$1.jsx(JsonView,{data:f,shouldExpandNode:g=>g<(u.collapseLevel??1)})})]},y)})})}function cn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ve={exports:{}},ae={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sn;function ri(){if(Sn)return ae;Sn=1;var e=React,r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function y(f,g,_){var p,S={},A=null,R=null;_!==void 0&&(A=""+_),g.key!==void 0&&(A=""+g.key),g.ref!==void 0&&(R=g.ref);for(p in g)o.call(g,p)&&!u.hasOwnProperty(p)&&(S[p]=g[p]);if(f&&f.defaultProps)for(p in g=f.defaultProps,g)S[p]===void 0&&(S[p]=g[p]);return{$$typeof:r,type:f,key:A,ref:R,props:S,_owner:c.current}}return ae.Fragment=t,ae.jsx=y,ae.jsxs=y,ae}Ve.exports=ri();var T=Ve.exports;function We(e,r){if(e.contains)return e.contains(r);if(e.compareDocumentPosition)return e===r||!!(e.compareDocumentPosition(r)&16)}var Je={exports:{}},ze,Mn;function un(){if(Mn)return ze;Mn=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ze=e,ze}var He,Nn;function _i(){if(Nn)return He;Nn=1;var e=un();function r(){}function t(){}return t.resetWarningCache=r,He=function(){function o(y,f,g,_,p,S){if(S!==e){var A=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw A.name="Invariant Violation",A}}o.isRequired=o;function c(){return o}var u={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:c,element:o,elementType:o,instanceOf:c,node:o,objectOf:c,oneOf:c,oneOfType:c,shape:c,exact:c,checkPropTypes:t,resetWarningCache:r};return u.PropTypes=u,u},He}Je.exports=_i()();var yi=Je.exports;const N=cn(yi);function ur(){const e=reactExports.useRef(!0),r=reactExports.useRef(()=>e.current);return reactExports.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),r.current}function bi(e){const r=reactExports.useRef(e);return r.current=e,r}function Pi(e){const r=bi(e);reactExports.useEffect(()=>()=>r.current(),[])}const Ge=2**31-1;function lr(e,r,t){const o=t-Date.now();e.current=o<=Ge?setTimeout(r,o):setTimeout(()=>lr(e,r,t),Ge)}function wi(){const e=ur(),r=reactExports.useRef();return Pi(()=>clearTimeout(r.current)),reactExports.useMemo(()=>{const t=()=>clearTimeout(r.current);function o(c,u=0){e()&&(t(),u<=Ge?r.current=setTimeout(c,u):lr(r,c,Date.now()+u))}return{set:o,clear:t,handleRef:r}},[])}var fr=function(){},Ai=fr;const dr=cn(Ai);function Oi(e,r){if(e==null)return{};var t={},o=Object.keys(e),c,u;for(u=0;u<o.length;u++)c=o[u],!(r.indexOf(c)>=0)&&(t[c]=e[c]);return t}function Ri(e,r,t){var o=reactExports.useRef(e!==void 0),c=reactExports.useState(r),u=c[0],y=c[1],f=e!==void 0,g=o.current;return o.current=f,!f&&g&&u!==r&&y(r),[f?e:u,reactExports.useCallback(function(_){for(var p=arguments.length,S=new Array(p>1?p-1:0),A=1;A<p;A++)S[A-1]=arguments[A];t&&t.apply(void 0,[_].concat(S)),y(_)},[t])]}function qe(e,r){return qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},qe(e,r)}function Ci$1(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,qe(e,r)}const Zn=e=>!e||typeof e=="function"?e:r=>{e.current=r};function Ti(e,r){const t=Zn(e),o=Zn(r);return c=>{t&&t(c),o&&o(c)}}function ne(e,r){return reactExports.useMemo(()=>Ti(e,r),[e,r])}var pr={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var r={}.hasOwnProperty;function t(){for(var u="",y=0;y<arguments.length;y++){var f=arguments[y];f&&(u=c(u,o(f)))}return u}function o(u){if(typeof u=="string"||typeof u=="number")return u;if(typeof u!="object")return"";if(Array.isArray(u))return t.apply(null,u);if(u.toString!==Object.prototype.toString&&!u.toString.toString().includes("[native code]"))return u.toString();var y="";for(var f in u)r.call(u,f)&&u[f]&&(y=c(y,f));return y}function c(u,y){return y?u?u+" "+y:u+y:u}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(pr);var Si=pr.exports;const Ut=cn(Si);function Hn(){return reactExports.useState(null)}var Un=Object.prototype.hasOwnProperty;function Yn(e,r,t){for(t of e.keys())if(fe(t,r))return t}function fe(e,r){var t,o,c;if(e===r)return!0;if(e&&r&&(t=e.constructor)===r.constructor){if(t===Date)return e.getTime()===r.getTime();if(t===RegExp)return e.toString()===r.toString();if(t===Array){if((o=e.length)===r.length)for(;o--&&fe(e[o],r[o]););return o===-1}if(t===Set){if(e.size!==r.size)return!1;for(o of e)if(c=o,c&&typeof c=="object"&&(c=Yn(r,c),!c)||!r.has(c))return!1;return!0}if(t===Map){if(e.size!==r.size)return!1;for(o of e)if(c=o[0],c&&typeof c=="object"&&(c=Yn(r,c),!c)||!fe(o[1],r.get(c)))return!1;return!0}if(t===ArrayBuffer)e=new Uint8Array(e),r=new Uint8Array(r);else if(t===DataView){if((o=e.byteLength)===r.byteLength)for(;o--&&e.getInt8(o)===r.getInt8(o););return o===-1}if(ArrayBuffer.isView(e)){if((o=e.byteLength)===r.byteLength)for(;o--&&e[o]===r[o];);return o===-1}if(!t||typeof e=="object"){o=0;for(t in e)if(Un.call(e,t)&&++o&&!Un.call(r,t)||!(t in r)||!fe(e[t],r[t]))return!1;return Object.keys(r).length===o}}return e!==e&&r!==r}function ki(e){const r=ur();return[e[0],reactExports.useCallback(t=>{if(r())return e[1](t)},[r,e[1]])]}var dt="top",yt="bottom",bt="right",pt="left",ln="auto",he=[dt,yt,bt,pt],$t="start",ge="end",Ii="clippingParents",mr="viewport",ue="popper",ji="reference",Vn=he.reduce(function(e,r){return e.concat([r+"-"+$t,r+"-"+ge])},[]),gr=[].concat(he,[ln]).reduce(function(e,r){return e.concat([r,r+"-"+$t,r+"-"+ge])},[]),Di="beforeRead",Fi="read",Mi="afterRead",Bi="beforeMain",zi="main",Li="afterMain",Ni="beforeWrite",Zi="write",Hi="afterWrite",Ui=[Di,Fi,Mi,Bi,zi,Li,Ni,Zi,Hi];function Pt(e){return e.split("-")[0]}function gt(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var r=e.ownerDocument;return r&&r.defaultView||window}return e}function Zt(e){var r=gt(e).Element;return e instanceof r||e instanceof Element}function wt(e){var r=gt(e).HTMLElement;return e instanceof r||e instanceof HTMLElement}function fn(e){if(typeof ShadowRoot>"u")return!1;var r=gt(e).ShadowRoot;return e instanceof r||e instanceof ShadowRoot}var Nt=Math.max,Te=Math.min,Qt=Math.round;function Ke(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(r){return r.brand+"/"+r.version}).join(" "):navigator.userAgent}function _r(){return!/^((?!chrome|android).)*safari/i.test(Ke())}function Xt(e,r,t){r===void 0&&(r=!1),t===void 0&&(t=!1);var o=e.getBoundingClientRect(),c=1,u=1;r&&wt(e)&&(c=e.offsetWidth>0&&Qt(o.width)/e.offsetWidth||1,u=e.offsetHeight>0&&Qt(o.height)/e.offsetHeight||1);var y=Zt(e)?gt(e):window,f=y.visualViewport,g=!_r()&&t,_=(o.left+(g&&f?f.offsetLeft:0))/c,p=(o.top+(g&&f?f.offsetTop:0))/u,S=o.width/c,A=o.height/u;return{width:S,height:A,top:p,right:_+S,bottom:p+A,left:_,x:_,y:p}}function dn(e){var r=Xt(e),t=e.offsetWidth,o=e.offsetHeight;return Math.abs(r.width-t)<=1&&(t=r.width),Math.abs(r.height-o)<=1&&(o=r.height),{x:e.offsetLeft,y:e.offsetTop,width:t,height:o}}function vr(e,r){var t=r.getRootNode&&r.getRootNode();if(e.contains(r))return!0;if(t&&fn(t)){var o=r;do{if(o&&e.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function It(e){return e?(e.nodeName||"").toLowerCase():null}function Rt(e){return gt(e).getComputedStyle(e)}function Yi(e){return["table","td","th"].indexOf(It(e))>=0}function Dt(e){return((Zt(e)?e.ownerDocument:e.document)||window.document).documentElement}function ke(e){return It(e)==="html"?e:e.assignedSlot||e.parentNode||(fn(e)?e.host:null)||Dt(e)}function Wn(e){return!wt(e)||Rt(e).position==="fixed"?null:e.offsetParent}function Vi(e){var r=/firefox/i.test(Ke()),t=/Trident/i.test(Ke());if(t&&wt(e)){var o=Rt(e);if(o.position==="fixed")return null}var c=ke(e);for(fn(c)&&(c=c.host);wt(c)&&["html","body"].indexOf(It(c))<0;){var u=Rt(c);if(u.transform!=="none"||u.perspective!=="none"||u.contain==="paint"||["transform","perspective"].indexOf(u.willChange)!==-1||r&&u.willChange==="filter"||r&&u.filter&&u.filter!=="none")return c;c=c.parentNode}return null}function ye(e){for(var r=gt(e),t=Wn(e);t&&Yi(t)&&Rt(t).position==="static";)t=Wn(t);return t&&(It(t)==="html"||It(t)==="body"&&Rt(t).position==="static")?r:t||Vi(e)||r}function pn(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function de(e,r,t){return Nt(e,Te(r,t))}function Wi(e,r,t){var o=de(e,r,t);return o>t?t:o}function hr(){return{top:0,right:0,bottom:0,left:0}}function yr(e){return Object.assign({},hr(),e)}function br(e,r){return r.reduce(function(t,o){return t[o]=e,t},{})}var Ji=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,yr(typeof e!="number"?e:br(e,he))};function Gi(e){var r,t=e.state,o=e.name,c=e.options,u=t.elements.arrow,y=t.modifiersData.popperOffsets,f=Pt(t.placement),g=pn(f),_=[pt,bt].indexOf(f)>=0,p=_?"height":"width";if(!(!u||!y)){var S=Ji(c.padding,t),A=dn(u),R=g==="y"?dt:pt,z=g==="y"?yt:bt,l=t.rects.reference[p]+t.rects.reference[g]-y[g]-t.rects.popper[p],s=y[g]-t.rects.reference[g],v=ye(u),w=v?g==="y"?v.clientHeight||0:v.clientWidth||0:0,E=l/2-s/2,C=S[R],h=w-A[p]-S[z],x=w/2-A[p]/2+E,k=de(C,x,h),M=g;t.modifiersData[o]=(r={},r[M]=k,r.centerOffset=k-x,r)}}function qi(e){var r=e.state,t=e.options,o=t.element,c=o===void 0?"[data-popper-arrow]":o;c!=null&&(typeof c=="string"&&(c=r.elements.popper.querySelector(c),!c)||vr(r.elements.popper,c)&&(r.elements.arrow=c))}const Ki={name:"arrow",enabled:!0,phase:"main",fn:Gi,effect:qi,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function te(e){return e.split("-")[1]}var $i={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Qi(e,r){var t=e.x,o=e.y,c=r.devicePixelRatio||1;return{x:Qt(t*c)/c||0,y:Qt(o*c)/c||0}}function Jn(e){var r,t=e.popper,o=e.popperRect,c=e.placement,u=e.variation,y=e.offsets,f=e.position,g=e.gpuAcceleration,_=e.adaptive,p=e.roundOffsets,S=e.isFixed,A=y.x,R=A===void 0?0:A,z=y.y,l=z===void 0?0:z,s=typeof p=="function"?p({x:R,y:l}):{x:R,y:l};R=s.x,l=s.y;var v=y.hasOwnProperty("x"),w=y.hasOwnProperty("y"),E=pt,C=dt,h=window;if(_){var x=ye(t),k="clientHeight",M="clientWidth";if(x===gt(t)&&(x=Dt(t),Rt(x).position!=="static"&&f==="absolute"&&(k="scrollHeight",M="scrollWidth")),x=x,c===dt||(c===pt||c===bt)&&u===ge){C=yt;var D=S&&x===h&&h.visualViewport?h.visualViewport.height:x[k];l-=D-o.height,l*=g?1:-1}if(c===pt||(c===dt||c===yt)&&u===ge){E=bt;var P=S&&x===h&&h.visualViewport?h.visualViewport.width:x[M];R-=P-o.width,R*=g?1:-1}}var F=Object.assign({position:f},_&&$i),X=p===!0?Qi({x:R,y:l},gt(t)):{x:R,y:l};if(R=X.x,l=X.y,g){var B;return Object.assign({},F,(B={},B[C]=w?"0":"",B[E]=v?"0":"",B.transform=(h.devicePixelRatio||1)<=1?"translate("+R+"px, "+l+"px)":"translate3d("+R+"px, "+l+"px, 0)",B))}return Object.assign({},F,(r={},r[C]=w?l+"px":"",r[E]=v?R+"px":"",r.transform="",r))}function Xi(e){var r=e.state,t=e.options,o=t.gpuAcceleration,c=o===void 0?!0:o,u=t.adaptive,y=u===void 0?!0:u,f=t.roundOffsets,g=f===void 0?!0:f,_={placement:Pt(r.placement),variation:te(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:c,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,Jn(Object.assign({},_,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:y,roundOffsets:g})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,Jn(Object.assign({},_,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:g})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}const to={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Xi,data:{}};var Ae={passive:!0};function eo(e){var r=e.state,t=e.instance,o=e.options,c=o.scroll,u=c===void 0?!0:c,y=o.resize,f=y===void 0?!0:y,g=gt(r.elements.popper),_=[].concat(r.scrollParents.reference,r.scrollParents.popper);return u&&_.forEach(function(p){p.addEventListener("scroll",t.update,Ae)}),f&&g.addEventListener("resize",t.update,Ae),function(){u&&_.forEach(function(p){p.removeEventListener("scroll",t.update,Ae)}),f&&g.removeEventListener("resize",t.update,Ae)}}const no={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:eo,data:{}};var ro={left:"right",right:"left",bottom:"top",top:"bottom"};function Re(e){return e.replace(/left|right|bottom|top/g,function(r){return ro[r]})}var io={start:"end",end:"start"};function Gn(e){return e.replace(/start|end/g,function(r){return io[r]})}function mn(e){var r=gt(e),t=r.pageXOffset,o=r.pageYOffset;return{scrollLeft:t,scrollTop:o}}function gn(e){return Xt(Dt(e)).left+mn(e).scrollLeft}function oo(e,r){var t=gt(e),o=Dt(e),c=t.visualViewport,u=o.clientWidth,y=o.clientHeight,f=0,g=0;if(c){u=c.width,y=c.height;var _=_r();(_||!_&&r==="fixed")&&(f=c.offsetLeft,g=c.offsetTop)}return{width:u,height:y,x:f+gn(e),y:g}}function so(e){var r,t=Dt(e),o=mn(e),c=(r=e.ownerDocument)==null?void 0:r.body,u=Nt(t.scrollWidth,t.clientWidth,c?c.scrollWidth:0,c?c.clientWidth:0),y=Nt(t.scrollHeight,t.clientHeight,c?c.scrollHeight:0,c?c.clientHeight:0),f=-o.scrollLeft+gn(e),g=-o.scrollTop;return Rt(c||t).direction==="rtl"&&(f+=Nt(t.clientWidth,c?c.clientWidth:0)-u),{width:u,height:y,x:f,y:g}}function _n(e){var r=Rt(e),t=r.overflow,o=r.overflowX,c=r.overflowY;return/auto|scroll|overlay|hidden/.test(t+c+o)}function Pr(e){return["html","body","#document"].indexOf(It(e))>=0?e.ownerDocument.body:wt(e)&&_n(e)?e:Pr(ke(e))}function pe(e,r){var t;r===void 0&&(r=[]);var o=Pr(e),c=o===((t=e.ownerDocument)==null?void 0:t.body),u=gt(o),y=c?[u].concat(u.visualViewport||[],_n(o)?o:[]):o,f=r.concat(y);return c?f:f.concat(pe(ke(y)))}function $e(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function ao(e,r){var t=Xt(e,!1,r==="fixed");return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function qn(e,r,t){return r===mr?$e(oo(e,t)):Zt(r)?ao(r,t):$e(so(Dt(e)))}function co(e){var r=pe(ke(e)),t=["absolute","fixed"].indexOf(Rt(e).position)>=0,o=t&&wt(e)?ye(e):e;return Zt(o)?r.filter(function(c){return Zt(c)&&vr(c,o)&&It(c)!=="body"}):[]}function uo(e,r,t,o){var c=r==="clippingParents"?co(e):[].concat(r),u=[].concat(c,[t]),y=u[0],f=u.reduce(function(g,_){var p=qn(e,_,o);return g.top=Nt(p.top,g.top),g.right=Te(p.right,g.right),g.bottom=Te(p.bottom,g.bottom),g.left=Nt(p.left,g.left),g},qn(e,y,o));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function wr(e){var r=e.reference,t=e.element,o=e.placement,c=o?Pt(o):null,u=o?te(o):null,y=r.x+r.width/2-t.width/2,f=r.y+r.height/2-t.height/2,g;switch(c){case dt:g={x:y,y:r.y-t.height};break;case yt:g={x:y,y:r.y+r.height};break;case bt:g={x:r.x+r.width,y:f};break;case pt:g={x:r.x-t.width,y:f};break;default:g={x:r.x,y:r.y}}var _=c?pn(c):null;if(_!=null){var p=_==="y"?"height":"width";switch(u){case $t:g[_]=g[_]-(r[p]/2-t[p]/2);break;case ge:g[_]=g[_]+(r[p]/2-t[p]/2);break}}return g}function _e(e,r){r===void 0&&(r={});var t=r,o=t.placement,c=o===void 0?e.placement:o,u=t.strategy,y=u===void 0?e.strategy:u,f=t.boundary,g=f===void 0?Ii:f,_=t.rootBoundary,p=_===void 0?mr:_,S=t.elementContext,A=S===void 0?ue:S,R=t.altBoundary,z=R===void 0?!1:R,l=t.padding,s=l===void 0?0:l,v=yr(typeof s!="number"?s:br(s,he)),w=A===ue?ji:ue,E=e.rects.popper,C=e.elements[z?w:A],h=uo(Zt(C)?C:C.contextElement||Dt(e.elements.popper),g,p,y),x=Xt(e.elements.reference),k=wr({reference:x,element:E,placement:c}),M=$e(Object.assign({},E,k)),D=A===ue?M:x,P={top:h.top-D.top+v.top,bottom:D.bottom-h.bottom+v.bottom,left:h.left-D.left+v.left,right:D.right-h.right+v.right},F=e.modifiersData.offset;if(A===ue&&F){var X=F[c];Object.keys(P).forEach(function(B){var L=[bt,yt].indexOf(B)>=0?1:-1,H=[dt,yt].indexOf(B)>=0?"y":"x";P[B]+=X[H]*L})}return P}function lo(e,r){r===void 0&&(r={});var t=r,o=t.placement,c=t.boundary,u=t.rootBoundary,y=t.padding,f=t.flipVariations,g=t.allowedAutoPlacements,_=g===void 0?gr:g,p=te(o),S=p?f?Vn:Vn.filter(function(z){return te(z)===p}):he,A=S.filter(function(z){return _.indexOf(z)>=0});A.length===0&&(A=S);var R=A.reduce(function(z,l){return z[l]=_e(e,{placement:l,boundary:c,rootBoundary:u,padding:y})[Pt(l)],z},{});return Object.keys(R).sort(function(z,l){return R[z]-R[l]})}function fo(e){if(Pt(e)===ln)return[];var r=Re(e);return[Gn(e),r,Gn(r)]}function po(e){var r=e.state,t=e.options,o=e.name;if(!r.modifiersData[o]._skip){for(var c=t.mainAxis,u=c===void 0?!0:c,y=t.altAxis,f=y===void 0?!0:y,g=t.fallbackPlacements,_=t.padding,p=t.boundary,S=t.rootBoundary,A=t.altBoundary,R=t.flipVariations,z=R===void 0?!0:R,l=t.allowedAutoPlacements,s=r.options.placement,v=Pt(s),w=v===s,E=g||(w||!z?[Re(s)]:fo(s)),C=[s].concat(E).reduce(function(ce,Ne){return ce.concat(Pt(Ne)===ln?lo(r,{placement:Ne,boundary:p,rootBoundary:S,padding:_,flipVariations:z,allowedAutoPlacements:l}):Ne)},[]),h=r.rects.reference,x=r.rects.popper,k=new Map,M=!0,D=C[0],P=0;P<C.length;P++){var F=C[P],X=Pt(F),B=te(F)===$t,L=[dt,yt].indexOf(X)>=0,H=L?"width":"height",U=_e(r,{placement:F,boundary:p,rootBoundary:S,altBoundary:A,padding:_}),Y=L?B?bt:pt:B?yt:dt;h[H]>x[H]&&(Y=Re(Y));var W=Re(Y),q=[];if(u&&q.push(U[X]<=0),f&&q.push(U[Y]<=0,U[W]<=0),q.every(function(ce){return ce})){D=F,M=!1;break}k.set(F,q)}if(M)for(var G=z?3:1,$=function(ce){var Ne=C.find(function(Pe){var De=k.get(Pe);if(De)return De.slice(0,ce).every(function(Me){return Me})});if(Ne)return D=Ne,"break"},Z=G;Z>0;Z--){var xe=$(Z);if(xe==="break")break}r.placement!==D&&(r.modifiersData[o]._skip=!0,r.placement=D,r.reset=!0)}}const mo={name:"flip",enabled:!0,phase:"main",fn:po,requiresIfExists:["offset"],data:{_skip:!1}};function Kn(e,r,t){return t===void 0&&(t={x:0,y:0}),{top:e.top-r.height-t.y,right:e.right-r.width+t.x,bottom:e.bottom-r.height+t.y,left:e.left-r.width-t.x}}function $n(e){return[dt,bt,yt,pt].some(function(r){return e[r]>=0})}function go(e){var r=e.state,t=e.name,o=r.rects.reference,c=r.rects.popper,u=r.modifiersData.preventOverflow,y=_e(r,{elementContext:"reference"}),f=_e(r,{altBoundary:!0}),g=Kn(y,o),_=Kn(f,c,u),p=$n(g),S=$n(_);r.modifiersData[t]={referenceClippingOffsets:g,popperEscapeOffsets:_,isReferenceHidden:p,hasPopperEscaped:S},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":p,"data-popper-escaped":S})}const _o={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:go};function vo(e,r,t){var o=Pt(e),c=[pt,dt].indexOf(o)>=0?-1:1,u=typeof t=="function"?t(Object.assign({},r,{placement:e})):t,y=u[0],f=u[1];return y=y||0,f=(f||0)*c,[pt,bt].indexOf(o)>=0?{x:f,y}:{x:y,y:f}}function ho(e){var r=e.state,t=e.options,o=e.name,c=t.offset,u=c===void 0?[0,0]:c,y=gr.reduce(function(p,S){return p[S]=vo(S,r.rects,u),p},{}),f=y[r.placement],g=f.x,_=f.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=g,r.modifiersData.popperOffsets.y+=_),r.modifiersData[o]=y}const yo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:ho};function bo(e){var r=e.state,t=e.name;r.modifiersData[t]=wr({reference:r.rects.reference,element:r.rects.popper,placement:r.placement})}const Po={name:"popperOffsets",enabled:!0,phase:"read",fn:bo,data:{}};function wo(e){return e==="x"?"y":"x"}function Eo(e){var r=e.state,t=e.options,o=e.name,c=t.mainAxis,u=c===void 0?!0:c,y=t.altAxis,f=y===void 0?!1:y,g=t.boundary,_=t.rootBoundary,p=t.altBoundary,S=t.padding,A=t.tether,R=A===void 0?!0:A,z=t.tetherOffset,l=z===void 0?0:z,s=_e(r,{boundary:g,rootBoundary:_,padding:S,altBoundary:p}),v=Pt(r.placement),w=te(r.placement),E=!w,C=pn(v),h=wo(C),x=r.modifiersData.popperOffsets,k=r.rects.reference,M=r.rects.popper,D=typeof l=="function"?l(Object.assign({},r.rects,{placement:r.placement})):l,P=typeof D=="number"?{mainAxis:D,altAxis:D}:Object.assign({mainAxis:0,altAxis:0},D),F=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,X={x:0,y:0};if(x){if(u){var B,L=C==="y"?dt:pt,H=C==="y"?yt:bt,U=C==="y"?"height":"width",Y=x[C],W=Y+s[L],q=Y-s[H],G=R?-M[U]/2:0,$=w===$t?k[U]:M[U],Z=w===$t?-M[U]:-k[U],xe=r.elements.arrow,ce=R&&xe?dn(xe):{width:0,height:0},Ne=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:hr(),Pe=Ne[L],De=Ne[H],Me=de(0,k[U],ce[U]),Be=E?k[U]/2-G-Me-Pe-P.mainAxis:$-Me-Pe-P.mainAxis,ft=E?-k[U]/2+G+Me+De+P.mainAxis:Z+Me+De+P.mainAxis,Ot=r.elements.arrow&&ye(r.elements.arrow),Gt=Ot?C==="y"?Ot.clientTop||0:Ot.clientLeft||0:0,mt=(B=F?.[C])!=null?B:0,je=Y+Be-mt-Gt,ht=Y+ft-mt,Kt=de(R?Te(W,je):W,Y,R?Nt(q,ht):q);x[C]=Kt,X[C]=Kt-Y}if(f){var Jt,Wt=C==="x"?dt:pt,Br=C==="x"?yt:bt,zr=x[h],cr=h==="y"?"height":"width",Nr=zr+s[Wt],At=zr-s[Br],Mt=[dt,pt].indexOf(v)!==-1,Jr=(Jt=F?.[h])!=null?Jt:0,Yr=Mt?Nr:zr-k[cr]-M[cr]-Jr+P.altAxis,ie=Mt?zr+k[cr]+M[cr]-Jr-P.altAxis:At,ve=R&&Mt?Wi(Yr,zr,ie):de(R?Yr:Nr,zr,R?ie:At);x[h]=ve,X[h]=ve-zr}r.modifiersData[o]=X}}const xo={name:"preventOverflow",enabled:!0,phase:"main",fn:Eo,requiresIfExists:["offset"]};function Ao(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Oo(e){return e===gt(e)||!wt(e)?mn(e):Ao(e)}function Ro(e){var r=e.getBoundingClientRect(),t=Qt(r.width)/e.offsetWidth||1,o=Qt(r.height)/e.offsetHeight||1;return t!==1||o!==1}function Co(e,r,t){t===void 0&&(t=!1);var o=wt(r),c=wt(r)&&Ro(r),u=Dt(r),y=Xt(e,c,t),f={scrollLeft:0,scrollTop:0},g={x:0,y:0};return(o||!o&&!t)&&((It(r)!=="body"||_n(u))&&(f=Oo(r)),wt(r)?(g=Xt(r,!0),g.x+=r.clientLeft,g.y+=r.clientTop):u&&(g.x=gn(u))),{x:y.left+f.scrollLeft-g.x,y:y.top+f.scrollTop-g.y,width:y.width,height:y.height}}function To(e){var r=new Map,t=new Set,o=[];e.forEach(function(u){r.set(u.name,u)});function c(u){t.add(u.name);var y=[].concat(u.requires||[],u.requiresIfExists||[]);y.forEach(function(f){if(!t.has(f)){var g=r.get(f);g&&c(g)}}),o.push(u)}return e.forEach(function(u){t.has(u.name)||c(u)}),o}function So(e){var r=To(e);return Ui.reduce(function(t,o){return t.concat(r.filter(function(c){return c.phase===o}))},[])}function ko(e){var r;return function(){return r||(r=new Promise(function(t){Promise.resolve().then(function(){r=void 0,t(e())})})),r}}function Io(e){var r=e.reduce(function(t,o){var c=t[o.name];return t[o.name]=c?Object.assign({},c,o,{options:Object.assign({},c.options,o.options),data:Object.assign({},c.data,o.data)}):o,t},{});return Object.keys(r).map(function(t){return r[t]})}var Qn={placement:"bottom",modifiers:[],strategy:"absolute"};function Xn(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return!r.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function jo(e){e===void 0&&(e={});var r=e,t=r.defaultModifiers,o=t===void 0?[]:t,c=r.defaultOptions,u=c===void 0?Qn:c;return function(y,f,g){g===void 0&&(g=u);var _={placement:"bottom",orderedModifiers:[],options:Object.assign({},Qn,u),modifiersData:{},elements:{reference:y,popper:f},attributes:{},styles:{}},p=[],S=!1,A={state:_,setOptions:function(l){var s=typeof l=="function"?l(_.options):l;z(),_.options=Object.assign({},u,_.options,s),_.scrollParents={reference:Zt(y)?pe(y):y.contextElement?pe(y.contextElement):[],popper:pe(f)};var v=So(Io([].concat(o,_.options.modifiers)));return _.orderedModifiers=v.filter(function(w){return w.enabled}),R(),A.update()},forceUpdate:function(){if(!S){var l=_.elements,s=l.reference,v=l.popper;if(Xn(s,v)){_.rects={reference:Co(s,ye(v),_.options.strategy==="fixed"),popper:dn(v)},_.reset=!1,_.placement=_.options.placement,_.orderedModifiers.forEach(function(M){return _.modifiersData[M.name]=Object.assign({},M.data)});for(var w=0;w<_.orderedModifiers.length;w++){if(_.reset===!0){_.reset=!1,w=-1;continue}var E=_.orderedModifiers[w],C=E.fn,h=E.options,x=h===void 0?{}:h,k=E.name;typeof C=="function"&&(_=C({state:_,options:x,name:k,instance:A})||_)}}}},update:ko(function(){return new Promise(function(l){A.forceUpdate(),l(_)})}),destroy:function(){z(),S=!0}};if(!Xn(y,f))return A;A.setOptions(g).then(function(l){!S&&g.onFirstUpdate&&g.onFirstUpdate(l)});function R(){_.orderedModifiers.forEach(function(l){var s=l.name,v=l.options,w=v===void 0?{}:v,E=l.effect;if(typeof E=="function"){var C=E({state:_,name:s,instance:A,options:w}),h=function(){};p.push(C||h)}})}function z(){p.forEach(function(l){return l()}),p=[]}return A}}const Do=jo({defaultModifiers:[_o,Po,to,no,yo,mo,xo,Ki]}),Fo=["enabled","placement","strategy","modifiers"];function Mo(e,r){if(e==null)return{};var t={},o=Object.keys(e),c,u;for(u=0;u<o.length;u++)c=o[u],!(r.indexOf(c)>=0)&&(t[c]=e[c]);return t}const Bo={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},zo={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:e})=>()=>{const{reference:r,popper:t}=e.elements;if("removeAttribute"in r){const o=(r.getAttribute("aria-describedby")||"").split(",").filter(c=>c.trim()!==t.id);o.length?r.setAttribute("aria-describedby",o.join(",")):r.removeAttribute("aria-describedby")}},fn:({state:e})=>{var r;const{popper:t,reference:o}=e.elements,c=(r=t.getAttribute("role"))==null?void 0:r.toLowerCase();if(t.id&&c==="tooltip"&&"setAttribute"in o){const u=o.getAttribute("aria-describedby");if(u&&u.split(",").indexOf(t.id)!==-1)return;o.setAttribute("aria-describedby",u?`${u},${t.id}`:t.id)}}},Lo=[];function No(e,r,t={}){let{enabled:o=!0,placement:c="bottom",strategy:u="absolute",modifiers:y=Lo}=t,f=Mo(t,Fo);const g=reactExports.useRef(y),_=reactExports.useRef(),p=reactExports.useCallback(()=>{var s;(s=_.current)==null||s.update()},[]),S=reactExports.useCallback(()=>{var s;(s=_.current)==null||s.forceUpdate()},[]),[A,R]=ki(reactExports.useState({placement:c,update:p,forceUpdate:S,attributes:{},styles:{popper:{},arrow:{}}})),z=reactExports.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:s})=>{const v={},w={};Object.keys(s.elements).forEach(E=>{v[E]=s.styles[E],w[E]=s.attributes[E]}),R({state:s,styles:v,attributes:w,update:p,forceUpdate:S,placement:s.placement})}}),[p,S,R]),l=reactExports.useMemo(()=>(fe(g.current,y)||(g.current=y),g.current),[y]);return reactExports.useEffect(()=>{!_.current||!o||_.current.setOptions({placement:c,strategy:u,modifiers:[...l,z,Bo]})},[u,c,z,o,l]),reactExports.useEffect(()=>{if(!(!o||e==null||r==null))return _.current=Do(e,r,Object.assign({},f,{placement:c,strategy:u,modifiers:[...l,zo,z]})),()=>{_.current!=null&&(_.current.destroy(),_.current=void 0,R(s=>Object.assign({},s,{attributes:{},styles:{popper:{}}})))}},[o,e,r]),A}const vn=!!(typeof window<"u"&&window.document&&window.document.createElement);var Qe=!1,Xe=!1;try{var Ue={get passive(){return Qe=!0},get once(){return Xe=Qe=!0}};vn&&(window.addEventListener("test",Ue,Ue),window.removeEventListener("test",Ue,!0))}catch{}function Zo(e,r,t,o){if(o&&typeof o!="boolean"&&!Xe){var c=o.once,u=o.capture,y=t;!Xe&&c&&(y=t.__once||function f(g){this.removeEventListener(r,f,u),t.call(this,g)},t.__once=y),e.addEventListener(r,y,Qe?o:u)}e.addEventListener(r,t,o)}function Ho(e,r,t,o){var c=o&&typeof o!="boolean"?o.capture:o;e.removeEventListener(r,t,c),t.__once&&e.removeEventListener(r,t.__once,c)}function Lt(e,r,t,o){return Zo(e,r,t,o),function(){Ho(e,r,t,o)}}function Ie(e){return e&&e.ownerDocument||document}function Uo(e){const r=reactExports.useRef(e);return reactExports.useEffect(()=>{r.current=e},[e]),r}function ee(e){const r=Uo(e);return reactExports.useCallback(function(...t){return r.current&&r.current(...t)},[r])}const tr=()=>{};function Yo(e){return e.button===0}function Vo(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}const Ce=e=>e&&("current"in e?e.current:e),er={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function Wo(e,r=tr,{disabled:t,clickTrigger:o="click"}={}){const c=reactExports.useRef(!1),u=reactExports.useRef(!1),y=reactExports.useCallback(_=>{const p=Ce(e);dr(!!p,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),c.current=!p||Vo(_)||!Yo(_)||!!We(p,_.target)||u.current,u.current=!1},[e]),f=ee(_=>{const p=Ce(e);p&&We(p,_.target)&&(u.current=!0)}),g=ee(_=>{c.current||r(_)});reactExports.useEffect(()=>{var _,p;if(t||e==null)return;const S=Ie(Ce(e)),A=S.defaultView||window;let R=(_=A.event)!=null?_:(p=A.parent)==null?void 0:p.event,z=null;er[o]&&(z=Lt(S,er[o],f,!0));const l=Lt(S,o,y,!0),s=Lt(S,o,w=>{if(w===R){R=void 0;return}g(w)});let v=[];return"ontouchstart"in S.documentElement&&(v=[].slice.call(S.body.children).map(w=>Lt(w,"mousemove",tr))),()=>{z?.(),l(),s(),v.forEach(w=>w())}},[e,t,o,y,f,g])}function Jo(e){return e.code==="Escape"||e.keyCode===27}const Go=()=>{};function qo(e,r,{disabled:t,clickTrigger:o}={}){const c=r||Go;Wo(e,c,{disabled:t,clickTrigger:o});const u=ee(y=>{Jo(y)&&c(y)});reactExports.useEffect(()=>{if(t||e==null)return;const y=Ie(Ce(e));let f=(y.defaultView||window).event;const g=Lt(y,"keyup",_=>{if(_===f){f=void 0;return}u(_)});return()=>{g()}},[e,t,u])}const Er=reactExports.createContext(vn?window:void 0);Er.Provider;function Ko(){return reactExports.useContext(Er)}const Ye=(e,r)=>vn?e==null?(r||Ie()).body:(typeof e=="function"&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null;function nr(e,r){const t=Ko(),[o,c]=reactExports.useState(()=>Ye(e,t?.document));if(!o){const u=Ye(e);u&&c(u)}return reactExports.useEffect(()=>{},[r,o]),reactExports.useEffect(()=>{const u=Ye(e);u!==o&&c(u)},[e,o]),o}function $o(e){const r={};return Array.isArray(e)?(e?.forEach(t=>{r[t.name]=t}),r):e||r}function Qo(e={}){return Array.isArray(e)?e:Object.keys(e).map(r=>(e[r].name=r,e[r]))}function Xo({enabled:e,enableEvents:r,placement:t,flip:o,offset:c,fixed:u,containerPadding:y,arrowElement:f,popperConfig:g={}}){var _,p,S,A;const R=$o(g.modifiers);return Object.assign({},g,{placement:t,enabled:e,strategy:u?"fixed":g.strategy,modifiers:Qo(Object.assign({},R,{eventListeners:{enabled:r,options:(_=R.eventListeners)==null?void 0:_.options},preventOverflow:Object.assign({},R.preventOverflow,{options:Object.assign({padding:y},(p=R.preventOverflow)==null?void 0:p.options)}),offset:{options:Object.assign({offset:c},(S=R.offset)==null?void 0:S.options)},arrow:Object.assign({},R.arrow,{enabled:!!f,options:Object.assign({},(A=R.arrow)==null?void 0:A.options,{element:f})}),flip:Object.assign({enabled:!!o},R.flip)}))})}const ts=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",es=typeof document<"u",tn=es||ts?reactExports.useLayoutEffect:reactExports.useEffect;function ns({children:e,in:r,onExited:t,mountOnEnter:o,unmountOnExit:c}){const u=reactExports.useRef(null),y=reactExports.useRef(r),f=ee(t);reactExports.useEffect(()=>{r?y.current=!0:f(u.current)},[r,f]);const g=ne(u,e.ref),_=reactExports.cloneElement(e,{ref:g});return r?_:c||!y.current&&o?null:_}function rs({in:e,onTransition:r}){const t=reactExports.useRef(null),o=reactExports.useRef(!0),c=ee(r);return tn(()=>{if(!t.current)return;let u=!1;return c({in:e,element:t.current,initial:o.current,isStale:()=>u}),()=>{u=!0}},[e,c]),tn(()=>(o.current=!1,()=>{o.current=!0}),[]),t}function is({children:e,in:r,onExited:t,onEntered:o,transition:c}){const[u,y]=reactExports.useState(!r);r&&u&&y(!1);const f=rs({in:!!r,onTransition:_=>{const p=()=>{_.isStale()||(_.in?o?.(_.element,_.initial):(y(!0),t?.(_.element)))};Promise.resolve(c(_)).then(p,S=>{throw _.in||y(!0),S})}}),g=ne(f,e.ref);return u&&!r?null:reactExports.cloneElement(e,{ref:g})}function os(e,r,t){return e?T.jsx(e,Object.assign({},t)):r?T.jsx(is,Object.assign({},t,{transition:r})):T.jsx(ns,Object.assign({},t))}const xr=reactExports.forwardRef((e,r)=>{const{flip:t,offset:o,placement:c,containerPadding:u,popperConfig:y={},transition:f,runTransition:g}=e,[_,p]=Hn(),[S,A]=Hn(),R=ne(p,r),z=nr(e.container),l=nr(e.target),[s,v]=reactExports.useState(!e.show),w=No(l,_,Xo({placement:c,enableEvents:!!e.show,containerPadding:u||5,flip:t,offset:o,arrowElement:S,popperConfig:y}));e.show&&s&&v(!1);const E=(...F)=>{v(!0),e.onExited&&e.onExited(...F)},C=e.show||!s;if(qo(_,e.onHide,{disabled:!e.rootClose||e.rootCloseDisabled,clickTrigger:e.rootCloseEvent}),!C)return null;const{onExit:h,onExiting:x,onEnter:k,onEntering:M,onEntered:D}=e;let P=e.children(Object.assign({},w.attributes.popper,{style:w.styles.popper,ref:R}),{popper:w,placement:c,show:!!e.show,arrowProps:Object.assign({},w.attributes.arrow,{style:w.styles.arrow,ref:A})});return P=os(f,g,{in:!!e.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:P,onExit:h,onExiting:x,onExited:E,onEnter:k,onEntering:M,onEntered:D}),z?ReactDOM.createPortal(P,z):null});xr.displayName="Overlay";function rr(e,r){return e.classList?!!r&&e.classList.contains(r):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+r+" ")!==-1}const ss=["xxl","xl","lg","md","sm","xs"],as="xs",Ar=reactExports.createContext({prefixes:{},breakpoints:ss,minBreakpoint:as});function Ht(e,r){const{prefixes:t}=reactExports.useContext(Ar);return e||t[r]||r}function Or(){const{dir:e}=reactExports.useContext(Ar);return e==="rtl"}const Rr=reactExports.forwardRef(({className:e,bsPrefix:r,as:t="div",...o},c)=>(r=Ht(r,"popover-header"),T.jsx(t,{ref:c,className:Ut(e,r),...o})));Rr.displayName="PopoverHeader";const hn=reactExports.forwardRef(({className:e,bsPrefix:r,as:t="div",...o},c)=>(r=Ht(r,"popover-body"),T.jsx(t,{ref:c,className:Ut(e,r),...o})));hn.displayName="PopoverBody";function Cr(e,r){let t=e;return e==="left"?t=r?"end":"start":e==="right"&&(t=r?"start":"end"),t}function Tr(e="absolute"){return{position:e,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const cs=reactExports.forwardRef(({bsPrefix:e,placement:r="right",className:t,style:o,children:c,body:u,arrowProps:y,hasDoneInitialMeasure:f,popper:g,show:_,...p},S)=>{const A=Ht(e,"popover"),R=Or(),[z]=r?.split("-")||[],l=Cr(z,R);let s=o;return _&&!f&&(s={...o,...Tr(g?.strategy)}),T.jsxs("div",{ref:S,role:"tooltip",style:s,"x-placement":z,className:Ut(t,A,z&&`bs-popover-${l}`),...p,children:[T.jsx("div",{className:"popover-arrow",...y}),u?T.jsx(hn,{children:c}):c]})}),en=Object.assign(cs,{Header:Rr,Body:hn,POPPER_OFFSET:[0,8]}),Sr=reactExports.forwardRef(({bsPrefix:e,placement:r="right",className:t,style:o,children:c,arrowProps:u,hasDoneInitialMeasure:y,popper:f,show:g,..._},p)=>{e=Ht(e,"tooltip");const S=Or(),[A]=r?.split("-")||[],R=Cr(A,S);let z=o;return g&&!y&&(z={...o,...Tr(f?.strategy)}),T.jsxs("div",{ref:p,style:z,role:"tooltip","x-placement":A,className:Ut(t,e,`bs-tooltip-${R}`),..._,children:[T.jsx("div",{className:"tooltip-arrow",...u}),T.jsx("div",{className:`${e}-inner`,children:c})]})});Sr.displayName="Tooltip";const kr=Object.assign(Sr,{TOOLTIP_OFFSET:[0,6]});function us(e){const r=reactExports.useRef(null),t=Ht(void 0,"popover"),o=Ht(void 0,"tooltip"),c=reactExports.useMemo(()=>({name:"offset",options:{offset:()=>{if(e)return e;if(r.current){if(rr(r.current,t))return en.POPPER_OFFSET;if(rr(r.current,o))return kr.TOOLTIP_OFFSET}return[0,0]}}}),[e,t,o]);return[r,[c]]}const ir={disabled:!1},Ir=React.createContext(null);var fs=function(e){return e.scrollTop},le="unmounted",Bt="exited",kt="entering",zt="entered",nn="exiting",Ct=(function(e){Ci$1(r,e);function r(o,c){var u;u=e.call(this,o,c)||this;var y=c,f=y&&!y.isMounting?o.enter:o.appear,g;return u.appearStatus=null,o.in?f?(g=Bt,u.appearStatus=kt):g=zt:o.unmountOnExit||o.mountOnEnter?g=le:g=Bt,u.state={status:g},u.nextCallback=null,u}r.getDerivedStateFromProps=function(o,c){var u=o.in;return u&&c.status===le?{status:Bt}:null};var t=r.prototype;return t.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},t.componentDidUpdate=function(o){var c=null;if(o!==this.props){var u=this.state.status;this.props.in?u!==kt&&u!==zt&&(c=kt):(u===kt||u===zt)&&(c=nn)}this.updateStatus(!1,c)},t.componentWillUnmount=function(){this.cancelNextCallback()},t.getTimeouts=function(){var o=this.props.timeout,c,u,y;return c=u=y=o,o!=null&&typeof o!="number"&&(c=o.exit,u=o.enter,y=o.appear!==void 0?o.appear:u),{exit:c,enter:u,appear:y}},t.updateStatus=function(o,c){if(o===void 0&&(o=!1),c!==null)if(this.cancelNextCallback(),c===kt){if(this.props.unmountOnExit||this.props.mountOnEnter){var u=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this);u&&fs(u)}this.performEnter(o)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Bt&&this.setState({status:le})},t.performEnter=function(o){var c=this,u=this.props.enter,y=this.context?this.context.isMounting:o,f=this.props.nodeRef?[y]:[ReactDOM.findDOMNode(this),y],g=f[0],_=f[1],p=this.getTimeouts(),S=y?p.appear:p.enter;if(!o&&!u||ir.disabled){this.safeSetState({status:zt},function(){c.props.onEntered(g)});return}this.props.onEnter(g,_),this.safeSetState({status:kt},function(){c.props.onEntering(g,_),c.onTransitionEnd(S,function(){c.safeSetState({status:zt},function(){c.props.onEntered(g,_)})})})},t.performExit=function(){var o=this,c=this.props.exit,u=this.getTimeouts(),y=this.props.nodeRef?void 0:ReactDOM.findDOMNode(this);if(!c||ir.disabled){this.safeSetState({status:Bt},function(){o.props.onExited(y)});return}this.props.onExit(y),this.safeSetState({status:nn},function(){o.props.onExiting(y),o.onTransitionEnd(u.exit,function(){o.safeSetState({status:Bt},function(){o.props.onExited(y)})})})},t.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},t.safeSetState=function(o,c){c=this.setNextCallback(c),this.setState(o,c)},t.setNextCallback=function(o){var c=this,u=!0;return this.nextCallback=function(y){u&&(u=!1,c.nextCallback=null,o(y))},this.nextCallback.cancel=function(){u=!1},this.nextCallback},t.onTransitionEnd=function(o,c){this.setNextCallback(c);var u=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this),y=o==null&&!this.props.addEndListener;if(!u||y){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var f=this.props.nodeRef?[this.nextCallback]:[u,this.nextCallback],g=f[0],_=f[1];this.props.addEndListener(g,_)}o!=null&&setTimeout(this.nextCallback,o)},t.render=function(){var o=this.state.status;if(o===le)return null;var c=this.props,u=c.children;c.in,c.mountOnEnter,c.unmountOnExit,c.appear,c.enter,c.exit,c.timeout,c.addEndListener,c.onEnter,c.onEntering,c.onEntered,c.onExit,c.onExiting,c.onExited,c.nodeRef;var y=Oi(c,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return React.createElement(Ir.Provider,{value:null},typeof u=="function"?u(o,y):React.cloneElement(React.Children.only(u),y))},r})(React.Component);Ct.contextType=Ir;Ct.propTypes={};function qt(){}Ct.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:qt,onEntering:qt,onEntered:qt,onExit:qt,onExiting:qt,onExited:qt};Ct.UNMOUNTED=le;Ct.EXITED=Bt;Ct.ENTERING=kt;Ct.ENTERED=zt;Ct.EXITING=nn;function ds(e){var r=Ie(e);return r&&r.defaultView||window}function ps(e,r){return ds(e).getComputedStyle(e,r)}var ms=/([A-Z])/g;function gs(e){return e.replace(ms,"-$1").toLowerCase()}var _s=/^ms-/;function Oe(e){return gs(e).replace(_s,"-ms-")}var vs=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function hs(e){return!!(e&&vs.test(e))}function jr(e,r){var t="",o="";if(typeof r=="string")return e.style.getPropertyValue(Oe(r))||ps(e).getPropertyValue(Oe(r));Object.keys(r).forEach(function(c){var u=r[c];!u&&u!==0?e.style.removeProperty(Oe(c)):hs(c)?o+=c+"("+u+") ":t+=Oe(c)+": "+u+";"}),o&&(t+="transform: "+o+";"),e.style.cssText+=";"+t}function ys(e,r,t,o){if(o===void 0&&(o=!0),e){var c=document.createEvent("HTMLEvents");c.initEvent(r,t,o),e.dispatchEvent(c)}}function bs(e){var r=jr(e,"transitionDuration")||"",t=r.indexOf("ms")===-1?1e3:1;return parseFloat(r)*t}function Ps(e,r,t){t===void 0&&(t=5);var o=!1,c=setTimeout(function(){o||ys(e,"transitionend",!0)},r+t),u=Lt(e,"transitionend",function(){o=!0},{once:!0});return function(){clearTimeout(c),u()}}function ws(e,r,t,o){t==null&&(t=bs(e)||0);var c=Ps(e,t,o),u=Lt(e,"transitionend",r);return function(){c(),u()}}function or(e,r){const t=jr(e,r)||"",o=t.indexOf("ms")===-1?1e3:1;return parseFloat(t)*o}function Es(e,r){const t=or(e,"transitionDuration"),o=or(e,"transitionDelay"),c=ws(e,u=>{u.target===e&&(c(),r(u))},t+o)}function xs(e){e.offsetHeight}function Se(e){return e&&"setState"in e?ReactDOM.findDOMNode(e):e??null}const As=React.forwardRef(({onEnter:e,onEntering:r,onEntered:t,onExit:o,onExiting:c,onExited:u,addEndListener:y,children:f,childRef:g,..._},p)=>{const S=reactExports.useRef(null),A=ne(S,g),R=x=>{A(Se(x))},z=x=>k=>{x&&S.current&&x(S.current,k)},l=reactExports.useCallback(z(e),[e]),s=reactExports.useCallback(z(r),[r]),v=reactExports.useCallback(z(t),[t]),w=reactExports.useCallback(z(o),[o]),E=reactExports.useCallback(z(c),[c]),C=reactExports.useCallback(z(u),[u]),h=reactExports.useCallback(z(y),[y]);return T.jsx(Ct,{ref:p,..._,onEnter:l,onEntered:v,onEntering:s,onExit:w,onExited:C,onExiting:E,addEndListener:h,nodeRef:S,children:typeof f=="function"?(x,k)=>f(x,{...k,ref:R}):React.cloneElement(f,{ref:R})})}),Os={[kt]:"show",[zt]:"show"},rn=reactExports.forwardRef(({className:e,children:r,transitionClasses:t={},onEnter:o,...c},u)=>{const y={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...c},f=reactExports.useCallback((g,_)=>{xs(g),o?.(g,_)},[o]);return T.jsx(As,{ref:u,addEndListener:Es,...y,onEnter:f,childRef:r.ref,children:(g,_)=>reactExports.cloneElement(r,{..._,className:Ut("fade",e,r.props.className,Os[g],t[g])})})});rn.displayName="Fade";function Rs(e,r){const{ref:t}=e,{ref:o}=r;e.ref=t.__wrapped||(t.__wrapped=c=>t(Se(c))),r.ref=o.__wrapped||(o.__wrapped=c=>o(Se(c)))}const Dr=reactExports.forwardRef(({children:e,transition:r=rn,popperConfig:t={},rootClose:o=!1,placement:c="top",show:u=!1,...y},f)=>{const g=reactExports.useRef({}),[_,p]=reactExports.useState(null),[S,A]=us(y.offset),R=ne(f,S),z=r===!0?rn:r||void 0,l=ee(s=>{p(s),t==null||t.onFirstUpdate==null||t.onFirstUpdate(s)});return tn(()=>{_&&y.target&&(g.current.scheduleUpdate==null||g.current.scheduleUpdate())},[_,y.target]),reactExports.useEffect(()=>{u||p(null)},[u]),T.jsx(xr,{...y,ref:R,popperConfig:{...t,modifiers:A.concat(t.modifiers||[]),onFirstUpdate:l},transition:z,rootClose:o,placement:c,show:u,children:(s,{arrowProps:v,popper:w,show:E})=>{var C,h;Rs(s,v);const x=w?.placement,k=Object.assign(g.current,{state:w?.state,scheduleUpdate:w?.update,placement:x,outOfBoundaries:(w==null||(C=w.state)==null||(h=C.modifiersData.hide)==null?void 0:h.isReferenceHidden)||!1,strategy:t.strategy}),M=!!_;return typeof e=="function"?e({...s,placement:x,show:E,...!r&&E&&{className:"show"},popper:k,arrowProps:v,hasDoneInitialMeasure:M}):reactExports.cloneElement(e,{...s,placement:x,arrowProps:v,popper:k,hasDoneInitialMeasure:M,className:Ut(e.props.className,!r&&E&&"show"),style:{...e.props.style,...s.style}})}})});Dr.displayName="Overlay";function Cs(e){return e&&typeof e=="object"?e:{show:e,hide:e}}function sr(e,r,t){const[o]=r,c=o.currentTarget,u=o.relatedTarget||o.nativeEvent[t];(!u||u!==c)&&!We(c,u)&&e(...r)}N.oneOf(["click","hover","focus"]);const yn=({trigger:e=["hover","focus"],overlay:r,children:t,popperConfig:o={},show:c,defaultShow:u=!1,onToggle:y,delay:f,placement:g,flip:_=g&&g.indexOf("auto")!==-1,...p})=>{const S=reactExports.useRef(null),A=ne(S,t.ref),R=wi(),z=reactExports.useRef(""),[l,s]=Ri(c,u,y),v=Cs(f),{onFocus:w,onBlur:E,onClick:C}=typeof t!="function"?reactExports.Children.only(t).props:{},h=H=>{A(Se(H))},x=reactExports.useCallback(()=>{if(R.clear(),z.current="show",!v.show){s(!0);return}R.set(()=>{z.current==="show"&&s(!0)},v.show)},[v.show,s,R]),k=reactExports.useCallback(()=>{if(R.clear(),z.current="hide",!v.hide){s(!1);return}R.set(()=>{z.current==="hide"&&s(!1)},v.hide)},[v.hide,s,R]),M=reactExports.useCallback((...H)=>{x(),w?.(...H)},[x,w]),D=reactExports.useCallback((...H)=>{k(),E?.(...H)},[k,E]),P=reactExports.useCallback((...H)=>{s(!l),C?.(...H)},[C,s,l]),F=reactExports.useCallback((...H)=>{sr(x,H,"fromElement")},[x]),X=reactExports.useCallback((...H)=>{sr(k,H,"toElement")},[k]),B=e==null?[]:[].concat(e),L={ref:h};return B.indexOf("click")!==-1&&(L.onClick=P),B.indexOf("focus")!==-1&&(L.onFocus=M,L.onBlur=D),B.indexOf("hover")!==-1&&(L.onMouseOver=F,L.onMouseOut=X),T.jsxs(T.Fragment,{children:[typeof t=="function"?t(L):reactExports.cloneElement(t,L),T.jsx(Dr,{...p,show:l,onHide:k,flip:_,placement:g,popperConfig:o,target:S.current,children:r})]})},Is=["as","disabled"];function js(e,r){if(e==null)return{};var t={},o=Object.keys(e),c,u;for(u=0;u<o.length;u++)c=o[u],!(r.indexOf(c)>=0)&&(t[c]=e[c]);return t}function Ds(e){return!e||e.trim()==="#"}function Fr({tagName:e,disabled:r,href:t,target:o,rel:c,role:u,onClick:y,tabIndex:f=0,type:g}){e||(t!=null||o!=null||c!=null?e="a":e="button");const _={tagName:e};if(e==="button")return[{type:g||"button",disabled:r},_];const p=A=>{if((r||e==="a"&&Ds(t))&&A.preventDefault(),r){A.stopPropagation();return}y?.(A)},S=A=>{A.key===" "&&(A.preventDefault(),p(A))};return e==="a"&&(t||(t="#"),r&&(t=void 0)),[{role:u??"button",disabled:void 0,tabIndex:r?void 0:f,href:t,target:e==="a"?o:void 0,"aria-disabled":r||void 0,rel:e==="a"?c:void 0,onClick:p,onKeyDown:S},_]}const Fs=reactExports.forwardRef((e,r)=>{let{as:t,disabled:o}=e,c=js(e,Is);const[u,{tagName:y}]=Fr(Object.assign({tagName:t,disabled:o},c));return T.jsx(y,Object.assign({},c,u,{ref:r}))});Fs.displayName="Button";const Mr=reactExports.forwardRef(({as:e,bsPrefix:r,variant:t="primary",size:o,active:c=!1,disabled:u=!1,className:y,...f},g)=>{const _=Ht(r,"btn"),[p,{tagName:S}]=Fr({tagName:e,disabled:u,...f}),A=S;return T.jsx(A,{...p,...f,ref:g,disabled:u,className:Ut(y,_,c&&"active",t&&`${_}-${t}`,o&&`${_}-${o}`,f.href&&u&&"disabled")})});Mr.displayName="Button";const Ms="_download_dropdown_menu_23m9j_1",Bs={download_dropdown_menu:Ms},zs=[{format:"cif",label:"CIF"},{format:"xsf",label:"XSF"},{format:"xyz",label:"XYZ"}];function Au(e){const r=`${e.aiida_rest_url}/nodes/${e.uuid}/download`,t=e.download_formats||zs,o=T.jsx(en,{children:T.jsx(en.Body,{style:{padding:"5px 0px"},children:T.jsx("ul",{className:Bs.download_dropdown_menu,children:t.map(({format:c,label:u})=>T.jsx("li",{children:T.jsx("a",{href:`${r}?download_format=${c}`,children:u})},c))})})});return T.jsx(yn,{trigger:"click",rootClose:!0,placement:"bottom",overlay:o,children:T.jsx(Mr,{size:"sm",style:{margin:"4px",padding:"2px 7px"},title:"Download",children:T.jsx("span",{className:"bi bi-download"})})})}var classnames={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var hasRequiredClassnames;function requireClassnames(){return hasRequiredClassnames||(hasRequiredClassnames=1,(function(e){(function(){var r={}.hasOwnProperty;function t(){for(var u="",y=0;y<arguments.length;y++){var f=arguments[y];f&&(u=c(u,o(f)))}return u}function o(u){if(typeof u=="string"||typeof u=="number")return u;if(typeof u!="object")return"";if(Array.isArray(u))return t.apply(null,u);if(u.toString!==Object.prototype.toString&&!u.toString.toString().includes("[native code]"))return u.toString();var y="";for(var f in u)r.call(u,f)&&u[f]&&(y=c(y,f));return y}function c(u,y){return y?u?u+" "+y:u+y:u}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(classnames)),classnames.exports}var classnamesExports=requireClassnames();const classNames=getDefaultExportFromCjs(classnamesExports),DEFAULT_BREAKPOINTS=["xxl","xl","lg","md","sm","xs"],DEFAULT_MIN_BREAKPOINT="xs",ThemeContext=reactExports.createContext({prefixes:{},breakpoints:DEFAULT_BREAKPOINTS,minBreakpoint:DEFAULT_MIN_BREAKPOINT}),{Consumer,Provider}=ThemeContext;function useBootstrapPrefix(e,r){const{prefixes:t}=reactExports.useContext(ThemeContext);return e||t[r]||r}function useBootstrapBreakpoints(){const{breakpoints:e}=reactExports.useContext(ThemeContext);return e}function useBootstrapMinBreakpoint(){const{minBreakpoint:e}=reactExports.useContext(ThemeContext);return e}var propTypes$2={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=e,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var e=requireReactPropTypesSecret();function r(){}function t(){}return t.resetWarningCache=r,factoryWithThrowingShims=function(){function o(y,f,g,_,p,S){if(S!==e){var A=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw A.name="Invariant Violation",A}}o.isRequired=o;function c(){return o}var u={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:c,element:o,elementType:o,instanceOf:c,node:o,objectOf:c,oneOf:c,oneOfType:c,shape:c,exact:c,checkPropTypes:t,resetWarningCache:r};return u.PropTypes=u,u},factoryWithThrowingShims}var hasRequiredPropTypes;function requirePropTypes(){return hasRequiredPropTypes||(hasRequiredPropTypes=1,propTypes$2.exports=requireFactoryWithThrowingShims()()),propTypes$2.exports}var propTypesExports=requirePropTypes();const PropTypes=getDefaultExportFromCjs(propTypesExports),_excluded=["as","disabled"];function _objectWithoutPropertiesLoose(e,r){if(e==null)return{};var t={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(r.indexOf(o)>=0)continue;t[o]=e[o]}return t}function isTrivialHref(e){return!e||e.trim()==="#"}function useButtonProps({tagName:e,disabled:r,href:t,target:o,rel:c,role:u,onClick:y,tabIndex:f=0,type:g}){e||(t!=null||o!=null||c!=null?e="a":e="button");const _={tagName:e};if(e==="button")return[{type:g||"button",disabled:r},_];const p=A=>{if((r||e==="a"&&isTrivialHref(t))&&A.preventDefault(),r){A.stopPropagation();return}y?.(A)},S=A=>{A.key===" "&&(A.preventDefault(),p(A))};return e==="a"&&(t||(t="#"),r&&(t=void 0)),[{role:u??"button",disabled:void 0,tabIndex:r?void 0:f,href:t,target:e==="a"?o:void 0,"aria-disabled":r||void 0,rel:e==="a"?c:void 0,onClick:p,onKeyDown:S},_]}const Button$1=reactExports.forwardRef((e,r)=>{let{as:t,disabled:o}=e,c=_objectWithoutPropertiesLoose(e,_excluded);const[u,{tagName:y}]=useButtonProps(Object.assign({tagName:t,disabled:o},c));return jsxRuntimeExports$1.jsx(y,Object.assign({},c,u,{ref:r}))});Button$1.displayName="Button";const Button=reactExports.forwardRef(({as:e,bsPrefix:r,variant:t="primary",size:o,active:c=!1,disabled:u=!1,className:y,...f},g)=>{const _=useBootstrapPrefix(r,"btn"),[p,{tagName:S}]=useButtonProps({tagName:e,disabled:u,...f}),A=S;return jsxRuntimeExports$1.jsx(A,{...p,...f,ref:g,disabled:u,className:classNames(y,_,c&&"active",t&&`${_}-${t}`,o&&`${_}-${o}`,f.href&&u&&"disabled")})});Button.displayName="Button";function hasChildOfType(e,r){return reactExports.Children.toArray(e).some(t=>reactExports.isValidElement(t)&&t.type===r)}function useCol({as:e,bsPrefix:r,className:t,...o}){r=useBootstrapPrefix(r,"col");const c=useBootstrapBreakpoints(),u=useBootstrapMinBreakpoint(),y=[],f=[];return c.forEach(g=>{const _=o[g];delete o[g];let p,S,A;typeof _=="object"&&_!=null?{span:p,offset:S,order:A}=_:p=_;const R=g!==u?`-${g}`:"";p&&y.push(p===!0?`${r}${R}`:`${r}${R}-${p}`),A!=null&&f.push(`order${R}-${A}`),S!=null&&f.push(`offset${R}-${S}`)}),[{...o,className:classNames(t,...y,...f)},{as:e,bsPrefix:r,spans:y}]}const Col=reactExports.forwardRef((e,r)=>{const[{className:t,...o},{as:c="div",bsPrefix:u,spans:y}]=useCol(e);return jsxRuntimeExports$1.jsx(c,{...o,ref:r,className:classNames(t,!y.length&&u)})});Col.displayName="Col";const propTypes$1={type:PropTypes.string,tooltip:PropTypes.bool,as:PropTypes.elementType},Feedback=reactExports.forwardRef(({as:e="div",className:r,type:t="valid",tooltip:o=!1,...c},u)=>jsxRuntimeExports$1.jsx(e,{...c,ref:u,className:classNames(r,`${t}-${o?"tooltip":"feedback"}`)}));Feedback.displayName="Feedback";Feedback.propTypes=propTypes$1;const FormContext=reactExports.createContext({}),FormCheckInput=reactExports.forwardRef(({id:e,bsPrefix:r,className:t,type:o="checkbox",isValid:c=!1,isInvalid:u=!1,as:y="input",...f},g)=>{const{controlId:_}=reactExports.useContext(FormContext);return r=useBootstrapPrefix(r,"form-check-input"),jsxRuntimeExports$1.jsx(y,{...f,ref:g,type:o,id:e||_,className:classNames(t,r,c&&"is-valid",u&&"is-invalid")})});FormCheckInput.displayName="FormCheckInput";const FormCheckLabel=reactExports.forwardRef(({bsPrefix:e,className:r,htmlFor:t,...o},c)=>{const{controlId:u}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-check-label"),jsxRuntimeExports$1.jsx("label",{...o,ref:c,htmlFor:t||u,className:classNames(r,e)})});FormCheckLabel.displayName="FormCheckLabel";const FormCheck=reactExports.forwardRef(({id:e,bsPrefix:r,bsSwitchPrefix:t,inline:o=!1,reverse:c=!1,disabled:u=!1,isValid:y=!1,isInvalid:f=!1,feedbackTooltip:g=!1,feedback:_,feedbackType:p,className:S,style:A,title:R="",type:z="checkbox",label:l,children:s,as:v="input",...w},E)=>{r=useBootstrapPrefix(r,"form-check"),t=useBootstrapPrefix(t,"form-switch");const{controlId:C}=reactExports.useContext(FormContext),h=reactExports.useMemo(()=>({controlId:e||C}),[C,e]),x=!s&&l!=null&&l!==!1||hasChildOfType(s,FormCheckLabel),k=jsxRuntimeExports$1.jsx(FormCheckInput,{...w,type:z==="switch"?"checkbox":z,ref:E,isValid:y,isInvalid:f,disabled:u,as:v});return jsxRuntimeExports$1.jsx(FormContext.Provider,{value:h,children:jsxRuntimeExports$1.jsx("div",{style:A,className:classNames(S,x&&r,o&&`${r}-inline`,c&&`${r}-reverse`,z==="switch"&&t),children:s||jsxRuntimeExports$1.jsxs(jsxRuntimeExports$1.Fragment,{children:[k,x&&jsxRuntimeExports$1.jsx(FormCheckLabel,{title:R,children:l}),_&&jsxRuntimeExports$1.jsx(Feedback,{type:p,tooltip:g,children:_})]})})})});FormCheck.displayName="FormCheck";const FormCheck$1=Object.assign(FormCheck,{Input:FormCheckInput,Label:FormCheckLabel}),FormControl=reactExports.forwardRef(({bsPrefix:e,type:r,size:t,htmlSize:o,id:c,className:u,isValid:y=!1,isInvalid:f=!1,plaintext:g,readOnly:_,as:p="input",...S},A)=>{const{controlId:R}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-control"),jsxRuntimeExports$1.jsx(p,{...S,type:r,size:o,ref:A,readOnly:_,id:c||R,className:classNames(u,g?`${e}-plaintext`:e,t&&`${e}-${t}`,r==="color"&&`${e}-color`,y&&"is-valid",f&&"is-invalid")})});FormControl.displayName="FormControl";const FormControl$1=Object.assign(FormControl,{Feedback}),FormFloating=reactExports.forwardRef(({className:e,bsPrefix:r,as:t="div",...o},c)=>(r=useBootstrapPrefix(r,"form-floating"),jsxRuntimeExports$1.jsx(t,{ref:c,className:classNames(e,r),...o})));FormFloating.displayName="FormFloating";const FormGroup=reactExports.forwardRef(({controlId:e,as:r="div",...t},o)=>{const c=reactExports.useMemo(()=>({controlId:e}),[e]);return jsxRuntimeExports$1.jsx(FormContext.Provider,{value:c,children:jsxRuntimeExports$1.jsx(r,{...t,ref:o})})});FormGroup.displayName="FormGroup";const FormLabel=reactExports.forwardRef(({as:e="label",bsPrefix:r,column:t=!1,visuallyHidden:o=!1,className:c,htmlFor:u,...y},f)=>{const{controlId:g}=reactExports.useContext(FormContext);r=useBootstrapPrefix(r,"form-label");let _="col-form-label";typeof t=="string"&&(_=`${_} ${_}-${t}`);const p=classNames(c,r,o&&"visually-hidden",t&&_);return u=u||g,t?jsxRuntimeExports$1.jsx(Col,{ref:f,as:"label",className:p,htmlFor:u,...y}):jsxRuntimeExports$1.jsx(e,{ref:f,className:p,htmlFor:u,...y})});FormLabel.displayName="FormLabel";const FormRange=reactExports.forwardRef(({bsPrefix:e,className:r,id:t,...o},c)=>{const{controlId:u}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-range"),jsxRuntimeExports$1.jsx("input",{...o,type:"range",ref:c,className:classNames(r,e),id:t||u})});FormRange.displayName="FormRange";const FormSelect=reactExports.forwardRef(({bsPrefix:e,size:r,htmlSize:t,className:o,isValid:c=!1,isInvalid:u=!1,id:y,...f},g)=>{const{controlId:_}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-select"),jsxRuntimeExports$1.jsx("select",{...f,size:t,ref:g,className:classNames(o,e,r&&`${e}-${r}`,c&&"is-valid",u&&"is-invalid"),id:y||_})});FormSelect.displayName="FormSelect";const FormText=reactExports.forwardRef(({bsPrefix:e,className:r,as:t="small",muted:o,...c},u)=>(e=useBootstrapPrefix(e,"form-text"),jsxRuntimeExports$1.jsx(t,{...c,ref:u,className:classNames(r,e,o&&"text-muted")})));FormText.displayName="FormText";const Switch=reactExports.forwardRef((e,r)=>jsxRuntimeExports$1.jsx(FormCheck$1,{...e,ref:r,type:"switch"}));Switch.displayName="Switch";const Switch$1=Object.assign(Switch,{Input:FormCheck$1.Input,Label:FormCheck$1.Label}),FloatingLabel=reactExports.forwardRef(({bsPrefix:e,className:r,children:t,controlId:o,label:c,...u},y)=>(e=useBootstrapPrefix(e,"form-floating"),jsxRuntimeExports$1.jsxs(FormGroup,{ref:y,className:classNames(r,e),controlId:o,...u,children:[t,jsxRuntimeExports$1.jsx("label",{htmlFor:o,children:c})]})));FloatingLabel.displayName="FloatingLabel";const propTypes={_ref:PropTypes.any,validated:PropTypes.bool,as:PropTypes.elementType},Form=reactExports.forwardRef(({className:e,validated:r,as:t="form",...o},c)=>jsxRuntimeExports$1.jsx(t,{...o,ref:c,className:classNames(e,r&&"was-validated")}));Form.displayName="Form";Form.propTypes=propTypes;const Form$1=Object.assign(Form,{Group:FormGroup,Control:FormControl$1,Floating:FormFloating,Check:FormCheck$1,Switch:Switch$1,Label:FormLabel,Text:FormText,Range:FormRange,Select:FormSelect,FloatingLabel});var Zs=Object.defineProperty,Ys=(e,r,t)=>r in e?Zs(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Ci=(e,r,t)=>(Ys(e,typeof r!="symbol"?r+"":r,t),t),commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},jsxRuntime={exports:{}},reactJsxRuntime_production_min={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var e=React,r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function y(f,g,_){var p,S={},A=null,R=null;_!==void 0&&(A=""+_),g.key!==void 0&&(A=""+g.key),g.ref!==void 0&&(R=g.ref);for(p in g)o.call(g,p)&&!u.hasOwnProperty(p)&&(S[p]=g[p]);if(f&&f.defaultProps)for(p in g=f.defaultProps,g)S[p]===void 0&&(S[p]=g[p]);return{$$typeof:r,type:f,key:A,ref:R,props:S,_owner:c.current}}return reactJsxRuntime_production_min.Fragment=t,reactJsxRuntime_production_min.jsx=y,reactJsxRuntime_production_min.jsxs=y,reactJsxRuntime_production_min}jsxRuntime.exports=requireReactJsxRuntime_production_min();var jsxRuntimeExports=jsxRuntime.exports;class ControlBox extends React.Component{constructor(){super(...arguments),Ci(this,"handleSupercellChange",(r,t)=>{let o=this.props.viewerParams.supercell;o[r]=parseInt(t),this.props.onViewerParamChange("supercell",o)}),Ci(this,"handleOptionChange",r=>{this.props.onViewerParamChange(r,!this.props.viewerParams[r])}),Ci(this,"handleCameraEvent",r=>{this.props.onViewerEvent("camera",r)})}render(){return jsxRuntimeExports.jsxs("div",{className:"control-box",children:[jsxRuntimeExports.jsxs("div",{className:"control-box-row",children:[jsxRuntimeExports.jsxs("div",{className:"supercell-container",children:[jsxRuntimeExports.jsx(Form$1.Label,{children:"Supercell: "}),jsxRuntimeExports.jsx("div",{style:{display:"flex"},children:[0,1,2].map(r=>jsxRuntimeExports.jsx(Form$1.Control,{className:"supercell-input",type:"number",min:"1",max:"99",value:this.props.viewerParams.supercell[r],onChange:t=>this.handleSupercellChange(r,t.target.value)},r))})]}),jsxRuntimeExports.jsxs("div",{className:"camera-controls",children:[jsxRuntimeExports.jsx(Form$1.Label,{children:"Camera: "}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("x"),children:"x"}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("y"),children:"y"}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("z"),children:"z"})]})]}),jsxRuntimeExports.jsxs("div",{className:"control-box-row",style:{display:"flex"},children:[jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.bonds,onChange:()=>this.handleOptionChange("bonds"),label:"Bonds"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.packedCell,onChange:()=>this.handleOptionChange("packedCell"),label:"Packed cell"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.atomLabels,onChange:()=>this.handleOptionChange("atomLabels"),label:"Atom labels"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.spaceFilling,onChange:()=>this.handleOptionChange("vdwRadius"),label:"vdW radius"})]})]})}}var _3Dmol={exports:{}};/*!
 * 3dmol v2.3.0
 * JavaScript/TypeScript molecular visualization library
 * Author: David Koes and contributors
 */(function(module,exports){(function(e,r){module.exports=r()})(commonjsGlobal,()=>(()=>{var __webpack_modules__={"./node_modules/iobuffer/lib-esm/IOBuffer.js":((e,r,t)=>{t.r(r),t.d(r,{IOBuffer:()=>f});var o=t("./node_modules/iobuffer/lib-esm/text.browser.js");const c=1024*8,u=(()=>{const g=new Uint8Array(4),_=new Uint32Array(g.buffer);return!((_[0]=1)&g[0])})(),y={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class f{constructor(_=c,p={}){let S=!1;typeof _=="number"?_=new ArrayBuffer(_):(S=!0,this.lastWrittenByte=_.byteLength);const A=p.offset?p.offset>>>0:0,R=_.byteLength-A;let z=A;(ArrayBuffer.isView(_)||_ instanceof f)&&(_.byteLength!==_.buffer.byteLength&&(z=_.byteOffset+A),_=_.buffer),S?this.lastWrittenByte=R:this.lastWrittenByte=0,this.buffer=_,this.length=R,this.byteLength=R,this.byteOffset=z,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,z,R),this._mark=0,this._marks=[]}available(_=1){return this.offset+_<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(_=1){return this.offset+=_,this}back(_=1){return this.offset-=_,this}seek(_){return this.offset=_,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const _=this._marks.pop();if(_===void 0)throw new Error("Mark stack empty");return this.seek(_),this}rewind(){return this.offset=0,this}ensureAvailable(_=1){if(!this.available(_)){const p=(this.offset+_)*2,S=new Uint8Array(p);S.set(new Uint8Array(this.buffer)),this.buffer=S.buffer,this.length=this.byteLength=p,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(_=1){return this.readArray(_,"uint8")}readArray(_,p){const S=y[p].BYTES_PER_ELEMENT*_,A=this.byteOffset+this.offset,R=this.buffer.slice(A,A+S);if(this.littleEndian===u&&p!=="uint8"&&p!=="int8"){const l=new Uint8Array(this.buffer.slice(A,A+S));l.reverse();const s=new y[p](l.buffer);return this.offset+=S,s.reverse(),s}const z=new y[p](R);return this.offset+=S,z}readInt16(){const _=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,_}readUint16(){const _=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,_}readInt32(){const _=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,_}readUint32(){const _=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,_}readFloat32(){const _=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,_}readFloat64(){const _=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,_}readBigInt64(){const _=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,_}readBigUint64(){const _=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,_}readChar(){return String.fromCharCode(this.readInt8())}readChars(_=1){let p="";for(let S=0;S<_;S++)p+=this.readChar();return p}readUtf8(_=1){return(0,o.decode)(this.readBytes(_))}decodeText(_=1,p="utf-8"){return(0,o.decode)(this.readBytes(_),p)}writeBoolean(_){return this.writeUint8(_?255:0),this}writeInt8(_){return this.ensureAvailable(1),this._data.setInt8(this.offset++,_),this._updateLastWrittenByte(),this}writeUint8(_){return this.ensureAvailable(1),this._data.setUint8(this.offset++,_),this._updateLastWrittenByte(),this}writeByte(_){return this.writeUint8(_)}writeBytes(_){this.ensureAvailable(_.length);for(let p=0;p<_.length;p++)this._data.setUint8(this.offset++,_[p]);return this._updateLastWrittenByte(),this}writeInt16(_){return this.ensureAvailable(2),this._data.setInt16(this.offset,_,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(_){return this.ensureAvailable(2),this._data.setUint16(this.offset,_,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(_){return this.ensureAvailable(4),this._data.setInt32(this.offset,_,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(_){return this.ensureAvailable(4),this._data.setUint32(this.offset,_,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(_){return this.ensureAvailable(4),this._data.setFloat32(this.offset,_,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(_){return this.ensureAvailable(8),this._data.setFloat64(this.offset,_,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(_){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,_,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(_){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,_,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(_){return this.writeUint8(_.charCodeAt(0))}writeChars(_){for(let p=0;p<_.length;p++)this.writeUint8(_.charCodeAt(p));return this}writeUtf8(_){return this.writeBytes((0,o.encode)(_))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}}),"./node_modules/iobuffer/lib-esm/text-encoding-polyfill.js":(function(){(function(e){if(e.TextEncoder&&e.TextDecoder)return!1;function r(o="utf-8"){if(o!=="utf-8")throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${o}') is invalid.`)}Object.defineProperty(r.prototype,"encoding",{value:"utf-8"}),r.prototype.encode=function(o,c={stream:!1}){if(c.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let u=0;const y=o.length;let f=0,g=Math.max(32,y+(y>>1)+7),_=new Uint8Array(g>>3<<3);for(;u<y;){let p=o.charCodeAt(u++);if(p>=55296&&p<=56319){if(u<y){const S=o.charCodeAt(u);(S&64512)===56320&&(++u,p=((p&1023)<<10)+(S&1023)+65536)}if(p>=55296&&p<=56319)continue}if(f+4>_.length){g+=8,g*=1+u/o.length*2,g=g>>3<<3;const S=new Uint8Array(g);S.set(_),_=S}if(p&4294967168)if(!(p&4294965248))_[f++]=p>>6&31|192;else if(!(p&4294901760))_[f++]=p>>12&15|224,_[f++]=p>>6&63|128;else if(!(p&4292870144))_[f++]=p>>18&7|240,_[f++]=p>>12&63|128,_[f++]=p>>6&63|128;else continue;else{_[f++]=p;continue}_[f++]=p&63|128}return _.slice(0,f)};function t(o="utf-8",c={fatal:!1}){if(o!=="utf-8")throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${o}') is invalid.`);if(c.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(t.prototype,"fatal",{value:!1}),Object.defineProperty(t.prototype,"ignoreBOM",{value:!1}),t.prototype.decode=function(o,c={stream:!1}){if(c.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const u=new Uint8Array(o);let y=0;const f=u.length,g=[];for(;y<f;){const _=u[y++];if(_===0)break;if(!(_&128))g.push(_);else if((_&224)===192){const p=u[y++]&63;g.push((_&31)<<6|p)}else if((_&240)===224){const p=u[y++]&63,S=u[y++]&63;g.push((_&31)<<12|p<<6|S)}else if((_&248)===240){const p=u[y++]&63,S=u[y++]&63,A=u[y++]&63;let R=(_&7)<<18|p<<12|S<<6|A;R>65535&&(R-=65536,g.push(R>>>10&1023|55296),R=56320|R&1023),g.push(R)}}return String.fromCharCode.apply(null,g)},e.TextEncoder=r,e.TextDecoder=t})(typeof window<"u"?window:typeof self<"u"?self:this)}),"./node_modules/iobuffer/lib-esm/text.browser.js":((e,r,t)=>{t.r(r),t.d(r,{decode:()=>o,encode:()=>u}),t("./node_modules/iobuffer/lib-esm/text-encoding-polyfill.js");function o(y,f="utf8"){return new TextDecoder(f).decode(y)}const c=new TextEncoder;function u(y){return c.encode(y)}}),"./node_modules/netcdfjs/lib-esm/data.js":((e,r,t)=>{t.r(r),t.d(r,{nonRecord:()=>c,record:()=>u});var o=t("./node_modules/netcdfjs/lib-esm/types.js");function c(y,f){const g=(0,o.str2num)(f.type),_=f.size/(0,o.num2bytes)(g),p=new Array(_);for(let S=0;S<_;S++)p[S]=(0,o.readType)(y,g,1);return p}function u(y,f,g){const _=(0,o.str2num)(f.type),p=f.size?f.size/(0,o.num2bytes)(_):1,S=g.length,A=new Array(S),R=g.recordStep;if(R)for(let z=0;z<S;z++){const l=y.offset;A[z]=(0,o.readType)(y,_,p),y.seek(l+R)}else throw new Error("recordDimension.recordStep is undefined");return A}}),"./node_modules/netcdfjs/lib-esm/header.js":((e,r,t)=>{t.r(r),t.d(r,{header:()=>p});var o=t("./node_modules/netcdfjs/lib-esm/types.js"),c=t("./node_modules/netcdfjs/lib-esm/utils.js");const u=0,y=10,f=11,g=12,_=0;function p(z,l){const s={version:l},v={length:z.readUint32()},w=S(z);Array.isArray(w)||(v.id=w.recordId,v.name=w.recordName,s.dimensions=w.dimensions),s.globalAttributes=A(z);const E=R(z,v?.id,l);return Array.isArray(E)||(s.variables=E.variables,v.recordStep=E.recordStep),s.recordDimension=v,s}function S(z){const l={};let s,v;const w=z.readUint32();let E;if(w===u)return(0,c.notNetcdf)(z.readUint32()!==u,"wrong empty tag for list of dimensions"),[];{(0,c.notNetcdf)(w!==y,"wrong tag for list of dimensions");const C=z.readUint32();E=new Array(C);for(let h=0;h<C;h++){const x=(0,c.readName)(z),k=z.readUint32();k===_&&(s=h,v=x),E[h]={name:x,size:k}}}return s!==void 0&&(l.recordId=s),v!==void 0&&(l.recordName=v),l.dimensions=E,l}function A(z){const l=z.readUint32();let s;if(l===u)return(0,c.notNetcdf)(z.readUint32()!==u,"wrong empty tag for list of attributes"),[];{(0,c.notNetcdf)(l!==g,"wrong tag for list of attributes");const v=z.readUint32();s=new Array(v);for(let w=0;w<v;w++){const E=(0,c.readName)(z),C=z.readUint32();(0,c.notNetcdf)(C<1||C>6,`non valid type ${C}`);const h=z.readUint32(),x=(0,o.readType)(z,C,h);(0,c.padding)(z),s[w]={name:E,type:(0,o.num2str)(C),value:x}}}return s}function R(z,l,s){const v=z.readUint32();let w=0,E;if(v===u)return(0,c.notNetcdf)(z.readUint32()!==u,"wrong empty tag for list of variables"),[];{(0,c.notNetcdf)(v!==f,"wrong tag for list of variables");const C=z.readUint32();E=new Array(C);for(let h=0;h<C;h++){const x=(0,c.readName)(z),k=z.readUint32(),M=new Array(k);for(let L=0;L<k;L++)M[L]=z.readUint32();const D=A(z),P=z.readUint32();(0,c.notNetcdf)(P<1&&P>6,`non valid type ${P}`);const F=z.readUint32();let X=z.readUint32();s===2&&((0,c.notNetcdf)(X>0,"offsets larger than 4GB not supported"),X=z.readUint32());let B=!1;typeof l<"u"&&M[0]===l&&(w+=F,B=!0),E[h]={name:x,dimensions:M,attributes:D,type:(0,o.num2str)(P),size:F,offset:X,record:B}}}return{variables:E,recordStep:w}}}),"./node_modules/netcdfjs/lib-esm/index.js":((e,r,t)=>{t.r(r),t.d(r,{NetCDFReader:()=>o.NetCDFReader});var o=t("./node_modules/netcdfjs/lib-esm/parser.js")}),"./node_modules/netcdfjs/lib-esm/parser.js":((e,r,t)=>{t.r(r),t.d(r,{NetCDFReader:()=>g});var o=t("./node_modules/iobuffer/lib-esm/IOBuffer.js"),c=t("./node_modules/netcdfjs/lib-esm/data.js"),u=t("./node_modules/netcdfjs/lib-esm/header.js"),y=t("./node_modules/netcdfjs/lib-esm/toString.js"),f=t("./node_modules/netcdfjs/lib-esm/utils.js");class g{constructor(p){this.toString=y.toString;const S=new o.IOBuffer(p);S.setBigEndian(),(0,f.notNetcdf)(S.readChars(3)!=="CDF","should start with CDF");const A=S.readByte();(0,f.notNetcdf)(A>2,"unknown version"),this.header=(0,u.header)(S,A),this.buffer=S}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(p){const S=this.globalAttributes.find(A=>A.name===p);return S?S.value:null}getDataVariableAsString(p){const S=this.getDataVariable(p);return S?S.join(""):null}get variables(){return this.header.variables}getDataVariable(p){let S;if(typeof p=="string"?S=this.header.variables.find(A=>A.name===p):S=p,S===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(S.offset),S.record?(0,c.record)(this.buffer,S,this.header.recordDimension):(0,c.nonRecord)(this.buffer,S)}dataVariableExists(p){return this.header.variables.find(S=>S.name===p)!==void 0}attributeExists(p){return this.globalAttributes.find(S=>S.name===p)!==void 0}}}),"./node_modules/netcdfjs/lib-esm/toString.js":((e,r,t)=>{t.r(r),t.d(r,{toString:()=>o});function o(){const c=[];c.push("DIMENSIONS");for(const y of this.dimensions)c.push(`  ${y.name.padEnd(30)} = size: ${y.size}`);c.push(""),c.push("GLOBAL ATTRIBUTES");for(const y of this.globalAttributes)c.push(`  ${y.name.padEnd(30)} = ${y.value}`);const u=JSON.parse(JSON.stringify(this.variables));c.push(""),c.push("VARIABLES:");for(const y of u){y.value=this.getDataVariable(y);let f=JSON.stringify(y.value);f.length>50&&(f=f.substring(0,50)),isNaN(y.value.length)||(f+=` (length: ${y.value.length})`),c.push(`  ${y.name.padEnd(30)} = ${f}`)}return c.join(`
`)}}),"./node_modules/netcdfjs/lib-esm/types.js":((e,r,t)=>{t.r(r),t.d(r,{num2bytes:()=>u,num2str:()=>c,readType:()=>g,str2num:()=>y});const o={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function c(p){switch(Number(p)){case o.BYTE:return"byte";case o.CHAR:return"char";case o.SHORT:return"short";case o.INT:return"int";case o.FLOAT:return"float";case o.DOUBLE:return"double";default:return"undefined"}}function u(p){switch(Number(p)){case o.BYTE:return 1;case o.CHAR:return 1;case o.SHORT:return 2;case o.INT:return 4;case o.FLOAT:return 4;case o.DOUBLE:return 8;default:return-1}}function y(p){switch(String(p)){case"byte":return o.BYTE;case"char":return o.CHAR;case"short":return o.SHORT;case"int":return o.INT;case"float":return o.FLOAT;case"double":return o.DOUBLE;default:return-1}}function f(p,S){if(p!==1){const A=new Array(p);for(let R=0;R<p;R++)A[R]=S();return A}else return S()}function g(p,S,A){switch(S){case o.BYTE:return Array.from(p.readBytes(A));case o.CHAR:return _(p.readChars(A));case o.SHORT:return f(A,p.readInt16.bind(p));case o.INT:return f(A,p.readInt32.bind(p));case o.FLOAT:return f(A,p.readFloat32.bind(p));case o.DOUBLE:return f(A,p.readFloat64.bind(p));default:throw new Error(`non valid type ${S}`)}}function _(p){return p.charCodeAt(p.length-1)===0?p.substring(0,p.length-1):p}}),"./node_modules/netcdfjs/lib-esm/utils.js":((e,r,t)=>{t.r(r),t.d(r,{notNetcdf:()=>o,padding:()=>c,readName:()=>u});function o(y,f){if(y)throw new TypeError(`Not a valid NetCDF v3.x file: ${f}`)}function c(y){y.offset%4!==0&&y.skip(4-y.offset%4)}function u(y){const f=y.readUint32(),g=y.readChars(f);return c(y),g}}),"./src/WebGL/shaders/lib/basic/basic.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;
    float fogFactor = smoothstep( fogNear, fogFar, depth );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
}`}),"./src/WebGL/shaders/lib/basic/basic.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`}),"./src/WebGL/shaders/lib/blur/blur.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`}),"./src/WebGL/shaders/lib/blur/blur.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/instanced/instanced.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`}),"./src/WebGL/shaders/lib/instanced/instanced.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`}),"./src/WebGL/shaders/lib/lambert/lambert.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}`}),"./src/WebGL/shaders/lib/lambert/lambert.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`}),"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`}),"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`}),"./src/WebGL/shaders/lib/outline/outline.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );
}


`}),"./src/WebGL/shaders/lib/outline/outline.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    gl_Position = projectionMatrix * mvPosition;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`}),"./src/WebGL/shaders/lib/screen/screen.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `}),"./src/WebGL/shaders/lib/screen/screen.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/screenaa/screenaa.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec3 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP).xyz;
    vec3 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP).xyz;
    vec3 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP).xyz;
    vec3 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP).xyz;
    vec3 rgbM  = texture2D(tex, fragCoord  * inverseVP).xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)).xyz +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5).xyz +
        texture2D(tex, fragCoord  + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, 1.0);
    else
        color = vec4(rgbB, 1.0);
    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        `}),"./src/WebGL/shaders/lib/screenaa/screenaa.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    float fogFactor = smoothstep( fogNear, fogFar, gl_FragDepthEXT/gl_FragCoord.w );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );


}

`}),"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`}),"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );
}


`}),"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);
    vec4 adjust = projectionMatrix* vec4(norm,normal.z,0.0); adjust.z = 0.0; adjust.w = 0.0;
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+adjust;
}

`}),"./src/WebGL/shaders/lib/sprite/sprite.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform int fogType;
uniform vec3 fogColor;
uniform float fogDensity;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogType > 0) {

        float depth = gl_FragCoord.z / gl_FragCoord.w;
        float fogFactor = 0.0;

        if (fogType == 1) {
            fogFactor = smoothstep(fogNear, fogFar, depth);
        }

        else {
            const float LOG2 = 1.442695;
            float fogFactor = exp2(- fogDensity * fogDensity * depth * depth * LOG2);
            fogFactor = 1.0 - clamp(fogFactor, 0.0, 1.0);
        }

        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);

    }
}

`}),"./src/WebGL/shaders/lib/sprite/sprite.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`}),"./src/WebGL/shaders/lib/ssao/ssao.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`}),"./src/WebGL/shaders/lib/ssao/ssao.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    float fogFactor = smoothstep( fogNear, fogFar, depth );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
}`}),"./src/WebGL/shaders/lib/stickimposter/stickimposter.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(projectionMatrix[3][3] == 0.0) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(projectionMatrix[3][3] == 0.0) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }
    vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
    mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`}),"./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`}),"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    to.xyz += normalize(to.xyz)*outlinePushback;
    pt.xyz += normalize(pt.xyz)*outlinePushback;

    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }
    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`}),"./src/WebGL/shaders/lib/volumetric/volumetric.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `}),"./src/WebGL/shaders/lib/volumetric/volumetric.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`}),"./src/GLDraw.ts":((e,r,t)=>{t.r(r),t.d(r,{CAP:()=>c,GLDraw:()=>u});var o=t("./src/WebGL/math/index.ts"),c;(function(y){y[y.NONE=0]="NONE",y[y.FLAT=1]="FLAT",y[y.ROUND=2]="ROUND"})(c||(c={}));var u;(function(y){function f(l,s,v){var w=Math.hypot(l,s),E,C,h,x,k;w<1e-4?(C=0,h=1):(C=-l/w,h=s/w),s=-C*l+h*s,E=Math.hypot(s,v),E<1e-4?(x=0,k=1):(x=v/E,k=s/E);var M=new Float32Array(9);return M[0]=h,M[1]=C,M[2]=0,M[3]=-C*k,M[4]=h*k,M[5]=x,M[6]=C*x,M[7]=-h*x,M[8]=k,M}class g{constructor(){this.cache={};let s=[],v=4,w=Math.pow(2,v),E=2,C=Math.pow(2,E),h=w/C,x;for(s[0]=new o.Vector3(-1,0,0),s[h]=new o.Vector3(0,0,1),s[h*2]=new o.Vector3(1,0,0),s[h*3]=new o.Vector3(0,0,-1),E=3;E<=v;E++){for(C=Math.pow(2,E-1),h=w/C,x=0;x<C-1;x++)s[h/2+x*h]=s[x*h].clone().add(s[(x+1)*h]).normalize();x=C-1,s[h/2+x*h]=s[x*h].clone().add(s[0]).normalize()}this.basisVectors=s}getVerticesForRadius(s,v,w){if(typeof this.cache<"u"&&this.cache[s]!==void 0&&this.cache[s][v+w]!==void 0)return this.cache[s][v+w];for(var E=this.basisVectors.length,C=[],h=[],x,k=0;k<E;k++)C.push(this.basisVectors[k].clone().multiplyScalar(s)),C.push(this.basisVectors[k].clone().multiplyScalar(s)),x=this.basisVectors[k].clone().normalize(),h.push(x),h.push(x);var M=[],D=10,P=E,F=0,X=Math.PI*2,B=0,L=Math.PI,H,U,Y=!1,W=!1;for(U=0;U<=D;U++){Y=U===0||U===D,W=U===D/2;var q=[],G=[];for(H=0;H<=P;H++){if(W){var $=H<P?2*H:0;G.push($+1),q.push($);continue}var Z=H/P,xe=U/D;if(!Y||H===0)if(H<P){var ce=new o.Vector3;ce.x=-s*Math.cos(F+Z*X)*Math.sin(B+xe*L),v==1?ce.y=0:ce.y=s*Math.cos(B+xe*L),ce.z=s*Math.sin(F+Z*X)*Math.sin(B+xe*L),Math.abs(ce.x)<1e-5&&(ce.x=0),Math.abs(ce.y)<1e-5&&(ce.y=0),Math.abs(ce.z)<1e-5&&(ce.z=0),v==c.FLAT?(x=new o.Vector3(0,Math.cos(B+xe*L),0),x.normalize()):(x=new o.Vector3(ce.x,ce.y,ce.z),x.normalize()),C.push(ce),h.push(x),q.push(C.length-1)}else q.push(C.length-P);else Y&&q.push(C.length-1)}W&&M.push(G),M.push(q)}var Ne={vertices:C,normals:h,verticesRows:M,w:P,h:D};return s in this.cache||(this.cache[s]={}),this.cache[s][v+w]=Ne,Ne}}var _=new g;function p(l,s,v,w,E,C=0,h=0){if(!s||!v)return;let x=function(vt){if(typeof vt=="string"){let Qr=vt;return Qr.toLowerCase()=="flat"?c.FLAT:Qr.toLowerCase()=="round"?c.ROUND:c.NONE}else return vt};C=x(C),h=x(h);var k=h||C;E=E||{r:0,g:0,b:0};var M=f(v.x-s.x,v.y-s.y,v.z-s.z),D=_.getVerticesForRadius(w,h,"to"),P=D.w,F=D.h,X=k?F*P+2:2*P,B=l.updateGeoGroup(X),L=D.vertices,H=D.normals,U=D.verticesRows,Y=U[F/2],W=U[F/2+1],q=B.vertices,G,$,Z,xe,ce,Ne,Pe=B.vertexArray,De=B.normalArray,Me=B.colorArray,Be=B.faceArray;for(Z=0;Z<P;++Z){var ft=2*Z;xe=M[0]*L[ft].x+M[3]*L[ft].y+M[6]*L[ft].z,ce=M[1]*L[ft].x+M[4]*L[ft].y+M[7]*L[ft].z,Ne=M[5]*L[ft].y+M[8]*L[ft].z,G=3*(q+ft),$=B.faceidx,Pe[G]=xe+s.x,Pe[G+1]=ce+s.y,Pe[G+2]=Ne+s.z,Pe[G+3]=xe+v.x,Pe[G+4]=ce+v.y,Pe[G+5]=Ne+v.z,De[G]=xe,De[G+3]=xe,De[G+1]=ce,De[G+4]=ce,De[G+2]=Ne,De[G+5]=Ne,Me[G]=E.r,Me[G+3]=E.r,Me[G+1]=E.g,Me[G+4]=E.g,Me[G+2]=E.b,Me[G+5]=E.b,Be[$]=W[Z]+q,Be[$+1]=W[Z+1]+q,Be[$+2]=Y[Z]+q,Be[$+3]=Y[Z]+q,Be[$+4]=W[Z+1]+q,Be[$+5]=Y[Z+1]+q,B.faceidx+=6}if(k){var Ot=h?0:F/2,Gt=C?F+1:F/2+1,mt,je,ht,Kt,Jt,Wt,Br,zr,cr,Nr,At,Mt,Jr,Yr,ie,ve,we,it,rt,Yt,jt,re,tt,lt,ar,et,Ft,se,xt,Vr,J,ut;for(ce=Ot;ce<Gt;ce++)if(ce!==F/2){var at=ce<=F/2?v:s,me=_.getVerticesForRadius(w,h,"to"),Ze=_.getVerticesForRadius(w,C,"from");for(at===v?(L=me.vertices,H=me.normals,U=me.verticesRows):at==s&&(L=Ze.vertices,H=Ze.normals,U=Ze.verticesRows),xe=0;xe<P;xe++)$=B.faceidx,mt=U[ce][xe+1],xt=(mt+q)*3,je=U[ce][xe],Vr=(je+q)*3,ht=U[ce+1][xe],J=(ht+q)*3,Kt=U[ce+1][xe+1],ut=(Kt+q)*3,Jt=M[0]*L[mt].x+M[3]*L[mt].y+M[6]*L[mt].z,Wt=M[0]*L[je].x+M[3]*L[je].y+M[6]*L[je].z,Br=M[0]*L[ht].x+M[3]*L[ht].y+M[6]*L[ht].z,zr=M[0]*L[Kt].x+M[3]*L[Kt].y+M[6]*L[Kt].z,cr=M[1]*L[mt].x+M[4]*L[mt].y+M[7]*L[mt].z,Nr=M[1]*L[je].x+M[4]*L[je].y+M[7]*L[je].z,At=M[1]*L[ht].x+M[4]*L[ht].y+M[7]*L[ht].z,Mt=M[1]*L[Kt].x+M[4]*L[Kt].y+M[7]*L[Kt].z,Jr=M[5]*L[mt].y+M[8]*L[mt].z,Yr=M[5]*L[je].y+M[8]*L[je].z,ie=M[5]*L[ht].y+M[8]*L[ht].z,ve=M[5]*L[Kt].y+M[8]*L[Kt].z,Pe[xt]=Jt+at.x,Pe[Vr]=Wt+at.x,Pe[J]=Br+at.x,Pe[ut]=zr+at.x,Pe[xt+1]=cr+at.y,Pe[Vr+1]=Nr+at.y,Pe[J+1]=At+at.y,Pe[ut+1]=Mt+at.y,Pe[xt+2]=Jr+at.z,Pe[Vr+2]=Yr+at.z,Pe[J+2]=ie+at.z,Pe[ut+2]=ve+at.z,Me[xt]=E.r,Me[Vr]=E.r,Me[J]=E.r,Me[ut]=E.r,Me[xt+1]=E.g,Me[Vr+1]=E.g,Me[J+1]=E.g,Me[ut+1]=E.g,Me[xt+2]=E.b,Me[Vr+2]=E.b,Me[J+2]=E.b,Me[ut+2]=E.b,we=M[0]*H[mt].x+M[3]*H[mt].y+M[6]*H[mt].z,it=M[0]*H[je].x+M[3]*H[je].y+M[6]*H[je].z,rt=M[0]*H[ht].x+M[3]*H[ht].y+M[6]*H[ht].z,Yt=M[0]*H[Kt].x+M[3]*H[Kt].y+M[6]*H[Kt].z,jt=M[1]*H[mt].x+M[4]*H[mt].y+M[7]*H[mt].z,re=M[1]*H[je].x+M[4]*H[je].y+M[7]*H[je].z,tt=M[1]*H[ht].x+M[4]*H[ht].y+M[7]*H[ht].z,lt=M[1]*H[Kt].x+M[4]*H[Kt].y+M[7]*H[Kt].z,ar=M[5]*H[mt].y+M[8]*H[mt].z,et=M[5]*H[je].y+M[8]*H[je].z,Ft=M[5]*H[ht].y+M[8]*H[ht].z,se=M[5]*H[Kt].y+M[8]*H[Kt].z,ce===0?(De[xt]=we,De[J]=rt,De[ut]=Yt,De[xt+1]=jt,De[J+1]=tt,De[ut+1]=lt,De[xt+2]=ar,De[J+2]=Ft,De[ut+2]=se,Be[$]=mt+q,Be[$+1]=ht+q,Be[$+2]=Kt+q,B.faceidx+=3):ce===Gt-1?(De[xt]=we,De[Vr]=it,De[J]=rt,De[xt+1]=jt,De[Vr+1]=re,De[J+1]=tt,De[xt+2]=ar,De[Vr+2]=et,De[J+2]=Ft,Be[$]=mt+q,Be[$+1]=je+q,Be[$+2]=ht+q,B.faceidx+=3):(De[xt]=we,De[Vr]=it,De[ut]=Yt,De[xt+1]=jt,De[Vr+1]=re,De[ut+1]=lt,De[xt+2]=ar,De[Vr+2]=et,De[ut+2]=se,De[Vr]=it,De[J]=rt,De[ut]=Yt,De[Vr+1]=re,De[J+1]=tt,De[ut+1]=lt,De[Vr+2]=et,De[J+2]=Ft,De[ut+2]=se,Be[$]=mt+q,Be[$+1]=je+q,Be[$+2]=Kt+q,Be[$+3]=je+q,Be[$+4]=ht+q,Be[$+5]=Kt+q,B.faceidx+=6)}}B.vertices+=X}y.drawCylinder=p;function S(l,s,v,w,E){if(!s||!v)return;E=E||{r:0,g:0,b:0};let C=new o.Vector3(v.x-s.x,v.y-s.y,v.z-s.z);var h=f(C.x,C.y,C.z);C=C.normalize();var x=_.basisVectors.length,k=_.basisVectors,M=x+2,D=l.updateGeoGroup(M),P=D.vertices,F,X,B,L,H,U,Y=D.vertexArray,W=D.normalArray,q=D.colorArray,G=D.faceArray;for(F=P*3,Y[F]=s.x,Y[F+1]=s.y,Y[F+2]=s.z,W[F]=-C.x,W[F+1]=-C.y,W[F+2]=-C.z,q[F]=E.r,q[F+1]=E.g,q[F+2]=E.b,Y[F+3]=v.x,Y[F+4]=v.y,Y[F+5]=v.z,W[F+3]=C.x,W[F+4]=C.y,W[F+5]=C.z,q[F+3]=E.r,q[F+4]=E.g,q[F+5]=E.b,F+=6,B=0;B<x;++B){var $=k[B].clone();$.multiplyScalar(w),L=h[0]*$.x+h[3]*$.y+h[6]*$.z,H=h[1]*$.x+h[4]*$.y+h[7]*$.z,U=h[5]*$.y+h[8]*$.z,Y[F]=L+s.x,Y[F+1]=H+s.y,Y[F+2]=U+s.z,W[F]=L,W[F+1]=H,W[F+2]=U,q[F]=E.r,q[F+1]=E.g,q[F+2]=E.b,F+=3}for(D.vertices+=x+2,X=D.faceidx,B=0;B<x;B++){var Z=P+2+B,xe=P+2+(B+1)%x;G[X]=Z,G[X+1]=xe,G[X+2]=P,X+=3,G[X]=Z,G[X+1]=xe,G[X+2]=P+1,X+=3}D.faceidx+=6*x}y.drawCone=S;class A{constructor(){this.cache=new Map}getVerticesForRadius(s,v){v=v||2,this.cache.has(v)||this.cache.set(v,new Map);let w=this.cache.get(v);if(w.has(s))return w.get(s);var E={vertices:[],verticesRows:[],normals:[]},C=16*v,h=10*v;s<1&&(C=10*v,h=8*v);var x=0,k=Math.PI*2,M=0,D=Math.PI,P,F;for(F=0;F<=h;F++){let B=[];for(P=0;P<=C;P++){let L=P/C,H=F/h,U=-s*Math.cos(x+L*k)*Math.sin(M+H*D),Y=s*Math.cos(M+H*D),W=s*Math.sin(x+L*k)*Math.sin(M+H*D);var X=new o.Vector3(U,Y,W);X.normalize(),E.vertices.push({x:U,y:Y,z:W}),E.normals.push(X),B.push(E.vertices.length-1)}E.verticesRows.push(B)}return w.set(s,E),E}}var R=new A;function z(l,s,v,w,E){var C=R.getVerticesForRadius(v,E),h=C.vertices,x=C.normals,k=l.updateGeoGroup(h.length),M=k.vertices,D=k.vertexArray,P=k.colorArray,F=k.faceArray,X=k.lineArray,B=k.normalArray;for(let U=0,Y=h.length;U<Y;++U){let W=3*(M+U),q=h[U];D[W]=q.x+s.x,D[W+1]=q.y+s.y,D[W+2]=q.z+s.z,P[W]=w.r,P[W+1]=w.g,P[W+2]=w.b}k.vertices+=h.length;let L=C.verticesRows,H=L.length-1;for(let U=0;U<H;U++){let Y=L[U].length-1;for(let W=0;W<Y;W++){let q=k.faceidx,G=k.lineidx,$=L[U][W+1]+M,Z=$*3,xe=L[U][W]+M,ce=xe*3,Ne=L[U+1][W]+M,Pe=Ne*3,De=L[U+1][W+1]+M,Me=De*3,Be=x[$-M],ft=x[xe-M],Ot=x[Ne-M],Gt=x[De-M];Math.abs(h[$-M].y)===v?(B[Z]=Be.x,B[Pe]=Ot.x,B[Me]=Gt.x,B[Z+1]=Be.y,B[Pe+1]=Ot.y,B[Me+1]=Gt.y,B[Z+2]=Be.z,B[Pe+2]=Ot.z,B[Me+2]=Gt.z,F[q]=$,F[q+1]=Ne,F[q+2]=De,X[G]=$,X[G+1]=Ne,X[G+2]=$,X[G+3]=De,X[G+4]=Ne,X[G+5]=De,k.faceidx+=3,k.lineidx+=6):Math.abs(h[Ne-M].y)===v?(B[Z]=Be.x,B[ce]=ft.x,B[Pe]=Ot.x,B[Z+1]=Be.y,B[ce+1]=ft.y,B[Pe+1]=Ot.y,B[Z+2]=Be.z,B[ce+2]=ft.z,B[Pe+2]=Ot.z,F[q]=$,F[q+1]=xe,F[q+2]=Ne,X[G]=$,X[G+1]=xe,X[G+2]=$,X[G+3]=Ne,X[G+4]=xe,X[G+5]=Ne,k.faceidx+=3,k.lineidx+=6):(B[Z]=Be.x,B[ce]=ft.x,B[Me]=Gt.x,B[Z+1]=Be.y,B[ce+1]=ft.y,B[Me+1]=Gt.y,B[Z+2]=Be.z,B[ce+2]=ft.z,B[Me+2]=Gt.z,B[ce]=ft.x,B[Pe]=Ot.x,B[Me]=Gt.x,B[ce+1]=ft.y,B[Pe+1]=Ot.y,B[Me+1]=Gt.y,B[ce+2]=ft.z,B[Pe+2]=Ot.z,B[Me+2]=Gt.z,F[q]=$,F[q+1]=xe,F[q+2]=De,F[q+3]=xe,F[q+4]=Ne,F[q+5]=De,X[G]=$,X[G+1]=xe,X[G+2]=$,X[G+3]=De,X[G+4]=xe,X[G+5]=Ne,X[G+6]=Ne,X[G+7]=De,k.faceidx+=6,k.lineidx+=8)}}}y.drawSphere=z})(u||(u={}))}),"./src/GLModel.ts":((e,r,t)=>{t.r(r),t.d(r,{GLModel:()=>z});var o=t("./src/WebGL/index.ts"),c=t("./src/WebGL/shapes/index.ts"),u=t("./src/WebGL/math/index.ts"),y=t("./src/colors.ts"),f=t("./src/GLDraw.ts"),g=t("./src/glcartoon.ts"),_=t("./src/utilities.ts"),p=t("./src/Gradient.ts"),S=t("./src/parsers/index.ts"),A=t("./node_modules/netcdfjs/lib-esm/index.js"),R=t("./src/parsers/utils/assignBonds.ts");class z{static sameObj(s,v){return s&&v?JSON.stringify(s)==JSON.stringify(v):s==v}constructor(s,v){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new u.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=y.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=v||{},this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:y.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=s}getRadiusFromStyle(s,v){var w=this.defaultSphereRadius;if(typeof v.radius<"u")w=v.radius;else if(z.vdwRadii[s.elem])w=z.vdwRadii[s.elem];else if(s.elem.length>1){let E=s.elem;E=E[0].toUpperCase()+E[1].toLowerCase(),z.vdwRadii[E]&&(w=z.vdwRadii[E])}return typeof v.scale<"u"&&(w*=v.scale),w}drawAtomCross(s,v){if(s.style.cross){var w=s.style.cross;if(!w.hidden){var E=w.linewidth||z.defaultlineWidth;v[E]||(v[E]=new o.Geometry);var C=v[E].updateGeoGroup(6),h=this.getRadiusFromStyle(s,w),x=[[h,0,0],[-h,0,0],[0,h,0],[0,-h,0],[0,0,h],[0,0,-h]],k=s.clickable||s.hoverable;k&&s.intersectionShape===void 0&&(s.intersectionShape={sphere:[],cylinder:[],line:[]});for(var M=(0,_.getColorFromStyle)(s,w),D=C.vertexArray,P=C.colorArray,F=0;F<6;F++){var X=C.vertices*3;if(C.vertices++,D[X]=s.x+x[F][0],D[X+1]=s.y+x[F][1],D[X+2]=s.z+x[F][2],P[X]=M.r,P[X+1]=M.g,P[X+2]=M.b,k){var B=new u.Vector3(x[F][0],x[F][1],x[F][2]);B.multiplyScalar(.1),B.set(B.x+s.x,B.y+s.y,B.z+s.z),s.intersectionShape.line.push(B)}}}}}getGoodCross(s,v,w,E){for(var C=null,h=-1,x=0,k=s.bonds.length;x<k;x++)if(s.bonds[x]!=v.index){let D=s.bonds[x],P=this.atoms[D],F=new u.Vector3(P.x,P.y,P.z).clone();F.sub(w);let X=F.clone();X.cross(E);var M=X.lengthSq();if(M>h&&(h=M,C=X,h>.1))return C}return C}getSideBondV(s,v,w){var E,C,h,x,k,M=new u.Vector3(s.x,s.y,s.z),D=new u.Vector3(v.x,v.y,v.z),P=D.clone(),F=null;if(P.sub(M),s.bonds.length===1)v.bonds.length===1?(F=P.clone(),Math.abs(F.x)>1e-4?F.y+=1:F.x+=1):(E=(w+1)%v.bonds.length,C=v.bonds[E],h=this.atoms[C],h.index==s.index&&(E=(E+1)%v.bonds.length,C=v.bonds[E],h=this.atoms[C]),x=new u.Vector3(h.x,h.y,h.z),k=x.clone(),k.sub(M),F=k.clone(),F.cross(P));else if(F=this.getGoodCross(s,v,M,P),F.lengthSq()<.01){var X=this.getGoodCross(v,s,M,P);X!=null&&(F=X)}return F.lengthSq()<.01&&(F=P.clone(),Math.abs(F.x)>1e-4?F.y+=1:F.x+=1),F.cross(P),F.normalize(),F}addLine(s,v,w,E,C,h){s[w]=E.x,s[w+1]=E.y,s[w+2]=E.z,v[w]=h.r,v[w+1]=h.g,v[w+2]=h.b,s[w+3]=C.x,s[w+4]=C.y,s[w+5]=C.z,v[w+3]=h.r,v[w+4]=h.g,v[w+5]=h.b}drawBondLines(s,v,w){if(s.style.line){var E=s.style.line;if(!E.hidden){var C,h,x,k,M=E.linewidth||z.defaultlineWidth;w[M]||(w[M]=new o.Geometry);for(var D=w[M].updateGeoGroup(6*s.bonds.length),P=D.vertexArray,F=D.colorArray,X=0;X<s.bonds.length;X++){var B=s.bonds[X],L=v[B];if(L.style.line&&!(s.index>=L.index)){var H=new u.Vector3(s.x,s.y,s.z),U=new u.Vector3(L.x,L.y,L.z),Y=H.clone().add(U).multiplyScalar(.5),W=!1,q=s.clickable||s.hoverable,G=L.clickable||L.hoverable;(q||G)&&(q&&(s.intersectionShape===void 0&&(s.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),s.intersectionShape.line.push(H),s.intersectionShape.line.push(Y)),G&&(L.intersectionShape===void 0&&(L.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),L.intersectionShape.line.push(Y),L.intersectionShape.line.push(U)));var $=(0,_.getColorFromStyle)(s,s.style.line),Z=(0,_.getColorFromStyle)(L,L.style.line);if(s.bondStyles&&s.bondStyles[X]){var xe=s.bondStyles[X];if(!xe.iswire)continue;xe.singleBond&&(W=!0),typeof xe.color1<"u"&&($=y.CC.color(xe.color1)),typeof xe.color2<"u"&&(Z=y.CC.color(xe.color2))}var ce=D.vertices*3,Ne,Pe;if(s.bondOrder[X]>1&&s.bondOrder[X]<4&&!W){var De=this.getSideBondV(s,L,X),Me=U.clone();Me.sub(H),s.bondOrder[X]==2?(De.multiplyScalar(.1),C=H.clone(),C.add(De),h=H.clone(),h.sub(De),x=C.clone(),x.add(Me),k=h.clone(),k.add(Me),$==Z?(D.vertices+=4,this.addLine(P,F,ce,C,x,$),this.addLine(P,F,ce+6,h,k,$)):(D.vertices+=8,Me.multiplyScalar(.5),Ne=C.clone(),Ne.add(Me),Pe=h.clone(),Pe.add(Me),this.addLine(P,F,ce,C,Ne,$),this.addLine(P,F,ce+6,Ne,x,Z),this.addLine(P,F,ce+12,h,Pe,$),this.addLine(P,F,ce+18,Pe,k,Z))):s.bondOrder[X]==3&&(De.multiplyScalar(.1),C=H.clone(),C.add(De),h=H.clone(),h.sub(De),x=C.clone(),x.add(Me),k=h.clone(),k.add(Me),$==Z?(D.vertices+=6,this.addLine(P,F,ce,H,U,$),this.addLine(P,F,ce+6,C,x,$),this.addLine(P,F,ce+12,h,k,$)):(D.vertices+=12,Me.multiplyScalar(.5),Ne=C.clone(),Ne.add(Me),Pe=h.clone(),Pe.add(Me),this.addLine(P,F,ce,H,Y,$),this.addLine(P,F,ce+6,Y,U,Z),this.addLine(P,F,ce+12,C,Ne,$),this.addLine(P,F,ce+18,Ne,x,Z),this.addLine(P,F,ce+24,h,Pe,$),this.addLine(P,F,ce+30,Pe,k,Z)))}else $==Z?(D.vertices+=2,this.addLine(P,F,ce,H,U,$)):(D.vertices+=4,this.addLine(P,F,ce,H,Y,$),this.addLine(P,F,ce+6,Y,U,Z))}}}}}drawAtomSphere(s,v){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var E=(0,_.getColorFromStyle)(s,w),C=this.getRadiusFromStyle(s,w);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var h=new u.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(h,C))}f.GLDraw.drawSphere(v,s,C,E)}}}drawAtomClickSphere(s){if(s.style.clicksphere){var v=s.style.clicksphere;if(!v.hidden){var w=this.getRadiusFromStyle(s,v);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var E=new u.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(E,w))}}}}drawAtomInstanced(s,v){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var E=this.getRadiusFromStyle(s,w),C=(0,_.getColorFromStyle)(s,w),h=v.updateGeoGroup(1),x=h.vertices,k=x*3,M=h.vertexArray,D=h.colorArray,P=h.radiusArray;if(M[k]=s.x,M[k+1]=s.y,M[k+2]=s.z,D[k]=C.r,D[k+1]=C.g,D[k+2]=C.b,P[x]=E,(s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var F=new u.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(F,E))}h.vertices+=1}}}drawSphereImposter(s,v,w,E){var C=s.updateGeoGroup(4),h,x=C.vertices,k=x*3,M=C.vertexArray,D=C.colorArray;for(h=0;h<4;h++)M[k+3*h]=v.x,M[k+3*h+1]=v.y,M[k+3*h+2]=v.z;var P=C.normalArray;for(h=0;h<4;h++)D[k+3*h]=E.r,D[k+3*h+1]=E.g,D[k+3*h+2]=E.b;P[k+0]=-w,P[k+1]=w,P[k+2]=0,P[k+3]=-w,P[k+4]=-w,P[k+5]=0,P[k+6]=w,P[k+7]=-w,P[k+8]=0,P[k+9]=w,P[k+10]=w,P[k+11]=0,C.vertices+=4;var F=C.faceArray,X=C.faceidx;F[X+0]=x,F[X+1]=x+1,F[X+2]=x+2,F[X+3]=x+2,F[X+4]=x+3,F[X+5]=x,C.faceidx+=6}drawAtomImposter(s,v){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var E=this.getRadiusFromStyle(s,w),C=(0,_.getColorFromStyle)(s,w);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var h=new u.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(h,E))}this.drawSphereImposter(v,s,E,C)}}}calculateDashes(s,v,w,E,C){var h=Math.sqrt(Math.pow(s.x-v.x,2)+Math.pow(s.y-v.y,2)+Math.pow(s.z-v.z,2));w=Math.max(w,0),C=Math.max(C,0)+2*w,E=Math.max(E,.001),E+C>h&&(E=h,C=0);var x=Math.floor((h-E)/(E+C))+1,k=x*E;C=(h-k)/x;for(var M,D=new u.Vector3(s.x,s.y,s.z),P=new u.Vector3((v.x-s.x)/(h/C),(v.y-s.y)/(h/C),(v.z-s.z)/(h/C)),F=new u.Vector3((v.x-s.x)/(h/E),(v.y-s.y)/(h/E),(v.z-s.z)/(h/E)),X=[],B=0;B<x;B++)M=new u.Vector3(D.x+F.x,D.y+F.y,D.z+F.z),X.push({from:D,to:M}),D=new u.Vector3(M.x+P.x,M.y+P.y,M.z+P.z);return X}static drawStickImposter(s,v,w,E,C,h=0,x=0){for(var k=s.updateGeoGroup(4),M=k.vertices,D=M*3,P=k.vertexArray,F=k.colorArray,X=k.radiusArray,B=k.normalArray,L=C.r,H=C.g,U=C.b,Y=function(Z){var xe=-Z;return xe==0&&(xe=-1e-4),xe},W=D,q=0;q<4;q++)P[W]=v.x,B[W]=w.x,F[W]=L,W++,P[W]=v.y,B[W]=w.y,F[W]=H,W++,P[W]=v.z,B[W]=w.z,q<2?F[W]=U:F[W]=Y(U),W++;k.vertices+=4,X[M]=-E,X[M+1]=E,X[M+2]=-E,X[M+3]=E;var G=k.faceArray,$=k.faceidx;G[$+0]=M,G[$+1]=M+1,G[$+2]=M+2,G[$+3]=M+2,G[$+4]=M+3,G[$+5]=M,k.faceidx+=6}drawBondSticks(s,v,w){var E,C;if(s.style.stick){var h=s.style.stick;if(!h.hidden){var x=h.radius||this.defaultStickRadius,k=h.doubleBondScaling||.4,M=h.tripleBondScaling||.25,D=((E=h.dashedBondConfig)===null||E===void 0?void 0:E.dashLength)||.1,P=((C=h.dashedBondConfig)===null||C===void 0?void 0:C.gapLength)||.25,F=x,X=h.singleBonds||!1,B=h.dashedBonds||!1,L=0,H=0,U,Y,W,q,G,$,Z,xe,ce,Ne,Pe,De=(0,_.getColorFromStyle)(s,h),Me,Be,ft;!s.capDrawn&&s.bonds.length<4&&(L=2);var Ot=tt=>{var lt=w.imposter?z.drawStickImposter:f.GLDraw.drawCylinder;return!B&&tt>=1?lt:(ar,et,Ft,se,xt,Vr=0,J=0,ut=.1,at=.25)=>{var me=this.calculateDashes(et,Ft,se,ut,at);me.forEach(Ze=>{lt(ar,Ze.from,Ze.to,se,xt,Vr,J)})}};for(W=0;W<s.bonds.length;W++){var Gt=Ot(s.bondOrder[W]),mt=s.bonds[W],je=v[mt];if(Me=Be=ft=null,s.index<je.index){var ht=je.style;if(!ht.stick||ht.stick.hidden)continue;var Kt=(0,_.getColorFromStyle)(je,ht.stick);if(F=x,q=X,s.bondStyles&&s.bondStyles[W]){if(G=s.bondStyles[W],G.iswire)continue;G.radius&&(F=G.radius),G.singleBond&&(q=!0),typeof G.color1<"u"&&(De=y.CC.color(G.color1)),typeof G.color2<"u"&&(Kt=y.CC.color(G.color2))}var Jt=new u.Vector3(s.x,s.y,s.z),Wt=new u.Vector3(je.x,je.y,je.z);if(s.bondOrder[W]<=1||q||s.bondOrder[W]>3){if(s.bondOrder[W]<1&&(F*=s.bondOrder[W]),!je.capDrawn&&je.bonds.length<4&&(H=2),De!=Kt?(Me=new u.Vector3().addVectors(Jt,Wt).multiplyScalar(.5),Gt(w,Jt,Me,F,De,L,0,D,P),Gt(w,Me,Wt,F,Kt,0,H,D,P)):Gt(w,Jt,Wt,F,De,L,H,D,P),U=s.clickable||s.hoverable,Y=je.clickable||je.hoverable,U||Y){if(Me||(Me=new u.Vector3().addVectors(Jt,Wt).multiplyScalar(.5)),U){var Br=new c.Cylinder(Jt,Me,F),zr=new c.Sphere(Jt,F);s.intersectionShape.cylinder.push(Br),s.intersectionShape.sphere.push(zr)}if(Y){var cr=new c.Cylinder(Wt,Me,F),Nr=new c.Sphere(Wt,F);je.intersectionShape.cylinder.push(cr),je.intersectionShape.sphere.push(Nr)}}}else if(s.bondOrder[W]>1){var At=0,Mt=0;F!=x&&(At=2,Mt=2);var Jr=Wt.clone(),Yr=null;Jr.sub(Jt);var ie,ve,we,it,rt;Yr=this.getSideBondV(s,je,W),s.bondOrder[W]==2?(ie=F*k,Yr.multiplyScalar(ie*1.5),ve=Jt.clone(),ve.add(Yr),we=Jt.clone(),we.sub(Yr),it=ve.clone(),it.add(Jr),rt=we.clone(),rt.add(Jr),De!=Kt?(Me=new u.Vector3().addVectors(ve,it).multiplyScalar(.5),Be=new u.Vector3().addVectors(we,rt).multiplyScalar(.5),Gt(w,ve,Me,ie,De,At,0),Gt(w,Me,it,ie,Kt,0,Mt),Gt(w,we,Be,ie,De,At,0),Gt(w,Be,rt,ie,Kt,0,Mt)):(Gt(w,ve,it,ie,De,At,Mt),Gt(w,we,rt,ie,De,At,Mt)),U=s.clickable||s.hoverable,Y=je.clickable||je.hoverable,(U||Y)&&(Me||(Me=new u.Vector3().addVectors(ve,it).multiplyScalar(.5)),Be||(Be=new u.Vector3().addVectors(we,rt).multiplyScalar(.5)),U&&($=new c.Cylinder(ve,Me,ie),Z=new c.Cylinder(we,Be,ie),s.intersectionShape.cylinder.push($),s.intersectionShape.cylinder.push(Z)),Y&&(ce=new c.Cylinder(it,Me,ie),Ne=new c.Cylinder(rt,Be,ie),je.intersectionShape.cylinder.push(ce),je.intersectionShape.cylinder.push(Ne)))):s.bondOrder[W]==3&&(ie=F*M,Yr.cross(Jr),Yr.normalize(),Yr.multiplyScalar(ie*3),ve=Jt.clone(),ve.add(Yr),we=Jt.clone(),we.sub(Yr),it=ve.clone(),it.add(Jr),rt=we.clone(),rt.add(Jr),De!=Kt?(Me=new u.Vector3().addVectors(ve,it).multiplyScalar(.5),Be=new u.Vector3().addVectors(we,rt).multiplyScalar(.5),ft=new u.Vector3().addVectors(Jt,Wt).multiplyScalar(.5),Gt(w,ve,Me,ie,De,At,0),Gt(w,Me,it,ie,Kt,0,Mt),Gt(w,Jt,ft,ie,De,L,0),Gt(w,ft,Wt,ie,Kt,0,H),Gt(w,we,Be,ie,De,At,0),Gt(w,Be,rt,ie,Kt,0,Mt)):(Gt(w,ve,it,ie,De,At,Mt),Gt(w,Jt,Wt,ie,De,L,H),Gt(w,we,rt,ie,De,At,Mt)),U=s.clickable||s.hoverable,Y=je.clickable||je.hoverable,(U||Y)&&(Me||(Me=new u.Vector3().addVectors(ve,it).multiplyScalar(.5)),Be||(Be=new u.Vector3().addVectors(we,rt).multiplyScalar(.5)),ft||(ft=new u.Vector3().addVectors(Jt,Wt).multiplyScalar(.5)),U&&($=new c.Cylinder(ve.clone(),Me.clone(),ie),Z=new c.Cylinder(we.clone(),Be.clone(),ie),xe=new c.Cylinder(Jt.clone(),ft.clone(),ie),s.intersectionShape.cylinder.push($),s.intersectionShape.cylinder.push(Z),s.intersectionShape.cylinder.push(xe)),Y&&(ce=new c.Cylinder(it.clone(),Me.clone(),ie),Ne=new c.Cylinder(rt.clone(),Be.clone(),ie),Pe=new c.Cylinder(Wt.clone(),ft.clone(),ie),je.intersectionShape.cylinder.push(ce),je.intersectionShape.cylinder.push(Ne),je.intersectionShape.cylinder.push(Pe))))}}}var Yt=!1,jt=0,re=!1;for(W=0;W<s.bonds.length;W++)q=X,s.bondStyles&&s.bondStyles[W]&&(G=s.bondStyles[W],G.singleBond&&(q=!0),G.radius&&G.radius!=x&&(re=!0)),(q||s.bondOrder[W]==1)&&jt++;re?jt>0&&(Yt=!0):jt==0&&(s.bonds.length>0||h.showNonBonded)&&(Yt=!0),Yt&&(F=x,w.imposter?this.drawSphereImposter(w.sphereGeometry,s,F,De):f.GLDraw.drawSphere(w,s,F,De))}}}createMolObj(s,v){v=v||{};var w=new o.Object3D,E=[],C={},h={},x=this.drawAtomSphere,k=null,M=null;v.supportsImposters?(x=this.drawAtomImposter,k=new o.Geometry(!0),k.imposter=!0,M=new o.Geometry(!0,!0),M.imposter=!0,M.sphereGeometry=new o.Geometry(!0),M.sphereGeometry.imposter=!0,M.drawnCaps={}):v.supportsAIA?(x=this.drawAtomInstanced,k=new o.Geometry(!1,!0,!0),k.instanced=!0,M=new o.Geometry(!0)):(k=new o.Geometry(!0),M=new o.Geometry(!0));var D,P,F,X,B={},L=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(D=0,F=s.length;D<F;D++){var H=s[D];if(H&&H.style){(H.clickable||H.hoverable)&&H.intersectionShape===void 0&&(H.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),X={line:void 0,cross:void 0,stick:void 0,sphere:void 0};for(P in X)H.style[P]?H.style[P].opacity?X[P]=parseFloat(H.style[P].opacity):X[P]=1:X[P]=void 0,B[P]?X[P]!=null&&B[P]!=X[P]&&(console.log("Warning: "+P+" opacity is ambiguous"),B[P]=1):B[P]=X[P];x.call(this,H,k),this.drawAtomClickSphere(H),this.drawAtomCross(H,h),this.drawBondLines(H,s,C),this.drawBondSticks(H,s,M),typeof H.style.cartoon<"u"&&!H.style.cartoon.hidden&&(H.style.cartoon.color==="spectrum"&&typeof H.resi=="number"&&!H.hetflag&&(H.resi<L[0]&&(L[0]=H.resi),H.resi>L[1]&&(L[1]=H.resi)),E.push(H))}}if(E.length>0&&(0,g.drawCartoon)(w,E,L,this.defaultCartoonQuality),k&&k.vertices>0){k.initTypedArrays();var U=null,Y=null;k.imposter?U=new o.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):k.instanced?(Y=new o.Geometry(!0),f.GLDraw.drawSphere(Y,{x:0,y:0,z:0},1,new y.Color(.5,.5,.5)),Y.initTypedArrays(),U=new o.InstancedMaterial({sphereMaterial:new o.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:Y})):U=new o.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),B.sphere<1&&B.sphere>=0&&(U.transparent=!0,U.opacity=B.sphere),Y=new o.Mesh(k,U),w.add(Y)}if(M.vertices>0){var W=null,q=null,G=M.sphereGeometry;(!G||typeof G.vertices>"u"||G.vertices==0)&&(G=null),M.initTypedArrays(),G&&G.initTypedArrays();var $={ambient:0,vertexColors:!0,reflectivity:0};M.imposter?(W=new o.StickImposterMaterial($),q=new o.SphereImposterMaterial($)):(W=new o.MeshLambertMaterial($),q=new o.MeshLambertMaterial($),W.wireframe&&(M.setUpWireframe(),G&&G.setUpWireframe())),B.stick<1&&B.stick>=0&&(W.transparent=!0,W.opacity=B.stick,q.transparent=!0,q.opacity=B.stick);var Z=new o.Mesh(M,W);if(w.add(Z),G){var xe=new o.Mesh(G,q);w.add(xe)}}var ce;for(D in C)if(C.hasOwnProperty(D)){ce=D;var Ne=new o.LineBasicMaterial({linewidth:ce,vertexColors:!0});B.line<1&&B.line>=0&&(Ne.transparent=!0,Ne.opacity=B.line),C[D].initTypedArrays();var Pe=new o.Line(C[D],Ne,o.LineStyle.LinePieces);w.add(Pe)}for(D in h)if(h.hasOwnProperty(D)){ce=D;var De=new o.LineBasicMaterial({linewidth:ce,vertexColors:!0});B.cross<1&&B.cross>=0&&(De.transparent=!0,De.opacity=B.cross),h[D].initTypedArrays();var Me=new o.Line(h[D],De,o.LineStyle.LinePieces);w.add(Me)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var Be=new o.Object3D,ft;for(ft=0;ft<this.modelData.symmetries.length;ft++){var Ot=new o.Object3D;Ot=w.clone(),Ot.matrix.copy(this.modelData.symmetries[ft]),Ot.matrixAutoUpdate=!1,Be.add(Ot)}return Be}return w}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(s){this.atoms=s.atoms,this.frames=s.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const s=this.modelData.cryst;this.modelData.cryst.matrix=(0,u.conversionMatrix3)(s.a,s.b,s.c,s.alpha,s.beta,s.gamma)}return this.modelData.cryst}else return null}setCrystData(s,v,w,E,C,h){s=s||1,v=v||1,w=w||1,E=E||90,C=C||90,h=h||90;const x=(0,u.conversionMatrix3)(s,v,w,E,C,h);this.modelData.cryst={a:s,b:v,c:w,alpha:E,beta:C,gamma:h,matrix:x}}setCrystMatrix(s){s=s||new u.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:s}}getSymmetries(){return typeof this.modelData.symmetries>"u"&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(s){typeof s>"u"?this.modelData.symmetries=[this.idMatrix]:this.modelData.symmetries=s}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(s,v,w,E){var C=v-s;return C<-w?v+E:C>w?v-E:v}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var s=this.box[0],v=this.box[1],w=this.box[2],E=s*.9,C=v*.9,h=w*.9,x=0;x<this.atomdfs.length;x++)for(var k=this.atomdfs[x],M=1;M<k.length;M++){var D=this.atoms[k[M][0]],P=this.atoms[k[M][1]];D.x=this.adjustCoord(P.x,D.x,E,s),D.y=this.adjustCoord(P.y,D.y,C,v),D.z=this.adjustCoord(P.z,D.z,h,w)}}setFrame(s,v){var w=this.getNumFrames();let E=this;return new Promise(function(C,h){if(w==0&&C(),(s<0||s>=w)&&(s=w-1),E.frames.url!=null){var x=E.frames.url;(0,_.getbin)(x+"/traj/frame/"+s+"/"+E.frames.path,void 0,"POST",void 0).then(function(k){for(var M=new Float32Array(k,44),D=0,P=0;P<E.atoms.length;P++)E.atoms[P].x=M[D++],E.atoms[P].y=M[D++],E.atoms[P].z=M[D++];E.box&&E.atomdfs&&E.adjustCoordinatesToBox(),C()}).catch(h)}else E.atoms=E.frames[s],C();E.molObj=null,E.modelDatas&&s<E.modelDatas.length&&(E.modelData=E.modelDatas[s],E.unitCellObjects&&v&&(v.removeUnitCell(E),v.addUnitCell(E)))})}addFrame(s){this.frames.push(s)}vibrate(s=10,v=1,w=!1,E,C){var h=0,x=s;w&&(h=-s,x=s),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),h<x&&(this.frames=[]),w&&(this.frames.origIndex=s);for(var k=h;k<x;k++){var M=[],D=this.frames.length;if(k==0&&!C){this.frames.push(this.atoms);continue}for(var P=0;P<this.atoms.length;P++){var F=(0,_.getAtomProperty)(this.atoms[P],"dx"),X=(0,_.getAtomProperty)(this.atoms[P],"dy"),B=(0,_.getAtomProperty)(this.atoms[P],"dz"),L=new u.Vector3(F,X,B),H=new u.Vector3(this.atoms[P].x,this.atoms[P].y,this.atoms[P].z),U=k*v/s;L.multiplyScalar(U),H.add(L);var Y={};for(var W in this.atoms[P])Y[W]=this.atoms[P][W];if(Y.x=H.x,Y.y=H.y,Y.z=H.z,M.push(Y),E&&C){var q=(0,_.extend)({},C),G=new u.Vector3(F,X,B);if(G.multiplyScalar(v),G.add(H),q.start=H,q.end=G,q.frame=D,!q.color){var $=Y.style.sphere;$||($=Y.style.stick),$||($=Y.style.line),q.color=(0,_.getColorFromStyle)(Y,$)}E.addArrow(q)}}this.frames.push(M)}}setAtomDefaults(s){for(let v=0;v<s.length;v++){let w=s[v];w&&(w.style=w.style||(0,_.deepCopy)(z.defaultAtomStyle),w.color=w.color||this.ElementColors[w.elem]||this.defaultColor,w.model=this.id,(w.clickable||w.hoverable)&&(w.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(s,v,w={}){var E=z.parseMolData(s,v,w);this.dontDuplicateAtoms=!w.duplicateAssemblyAtoms;var C=E.modelData;if(C&&(Array.isArray(C)?(this.modelData=C[0],w.frames&&(this.modelDatas=C)):this.modelData=C),E.box?this.box=E.box:this.box=null,this.frames.length==0){for(let x=0;x<E.length;x++)E[x].length!=0&&this.frames.push(E[x]);this.frames[0]&&(this.atoms=this.frames[0])}else if(w.frames)for(let x=0;x<E.length;x++)this.frames.push(E[x]);else for(var h=0;h<E.length;h++)this.addAtoms(E[h]);for(let x=0;x<this.frames.length;x++)this.setAtomDefaults(this.frames[x]);w.vibrate&&w.vibrate.frames&&w.vibrate.amplitude&&this.vibrate(w.vibrate.frames,w.vibrate.amplitude),w.style&&this.setStyle({},w.style)}setDontDuplicateAtoms(s){this.dontDuplicateAtoms=s}setModelData(s){this.modelData=s}propertyMatches(s,v){if(s==v)return!0;if(typeof v=="string"&&typeof s=="number"){var w=v.match(/(-?\d+)\s*-\s*(-?\d+)/);if(w){var E=parseInt(w[1]),C=parseInt(w[2]);if(w&&s>=E&&s<=C)return!0}}return!1}static deepCopyAndCache(s,v){if(typeof s!="object"||s==null||s.__cache_created)return s;const w={};for(const E in s){const C=s[E];if(Array.isArray(C)){w[E]=[];for(let h=0;h<C.length;h++)w[E].push(z.deepCopyAndCache(C[h],v))}else typeof C=="object"&&E!="properties"&&E!="model"?w[E]=z.deepCopyAndCache(C,v):w[E]=C;if(E=="and"||E=="or"){const h=[];for(const x of w[E]){const k=new Set;for(const M of v.selectedAtoms(x))k.add(M.index);h.push(k)}if(E=="and"){const x=function(M,D){const P=new Set;for(const F of D)M.has(F)&&P.add(F);return P};let k=new Set(h[0]);for(const M of h.splice(1))k=x(k,M);w[E].__cached_results=k}else if(E=="or"){const x=new Set;for(const k of h)for(const M of k)x.add(M);w[E].__cached_results=x}}}return w.__cache_created=!0,w}atomIsSelected(s,v){if(typeof v>"u")return!0;var w=!!v.invert,E=!0;for(var C in v)if(C=="and"||C=="or"||C=="not"){if(C=="not"){if(this.atomIsSelected(s,v[C])){E=!1;break}}else if(v[C].__cached_results===void 0&&(v=z.deepCopyAndCache(v,this)),E=v[C].__cached_results.has(s.index),!E)break}else if(C==="predicate"){if(!v.predicate(s)){E=!1;break}}else if(C=="properties"&&s[C]){for(var h in v.properties)if(!h.startsWith("__cache")){if(typeof s.properties[h]>"u"){E=!1;break}if(s.properties[h]!=v.properties[h]){E=!1;break}}}else if(v.hasOwnProperty(C)&&!z.ignoredKeys.has(C)&&!C.startsWith("__cache")){if(typeof s[C]>"u"){E=!1;break}var x=!1;if(C==="bonds"){var k=v[C];if(k!=s.bonds.length){E=!1;break}}else if(Array.isArray(v[C])){var M=v[C],D=s[C];for(let P=0;P<M.length;P++)if(this.propertyMatches(D,M[P])){x=!0;break}if(!x){E=!1;break}}else{let P=v[C];if(!this.propertyMatches(s[C],P)){E=!1;break}}}return w?!E:E}static squaredDistance(s,v){var w=v.x-s.x,E=v.y-s.y,C=v.z-s.z;return w*w+E*E+C*C}expandAtomList(s,v){if(v<=0)return s;for(var w=(0,_.getExtent)(s,void 0),E=[[],[],[]],C=0;C<3;C++)E[0][C]=w[0][C]-v,E[1][C]=w[1][C]+v,E[2][C]=w[2][C];var h=[];for(let D=0;D<this.atoms.length;D++){var x=this.atoms[D].x,k=this.atoms[D].y,M=this.atoms[D].z;x>=E[0][0]&&x<=E[1][0]&&k>=E[0][1]&&k<=E[1][1]&&M>=E[0][2]&&M<=E[1][2]&&(x>=w[0][0]&&x<=w[1][0]&&k>=w[0][1]&&k<=w[1][1]&&M>=w[0][2]&&M<=w[1][2]||h.push(this.atoms[D]))}return h}static getFloat(s){return typeof s=="number"?s:parseFloat(s)}selectedAtoms(s,v){var w=[];s=z.deepCopyAndCache(s||{},this),v||(v=this.atoms);for(var E=v.length,C=0;C<E;C++){var h=v[C];h&&this.atomIsSelected(h,s)&&w.push(h)}if(s.hasOwnProperty("expand")){const Y=z.getFloat(s.expand);let W=this.expandAtomList(w,Y),q=w.length;const G=Y*Y;for(let $=0;$<W.length;$++)for(let Z=0;Z<q;Z++){var x=z.squaredDistance(W[$],w[Z]);x<G&&x>0&&w.push(W[$])}}if(s.hasOwnProperty("within")&&s.within.hasOwnProperty("sel")&&s.within.hasOwnProperty("distance")){var k=this.selectedAtoms(s.within.sel,this.atoms),M={};const Y=z.getFloat(s.within.distance),W=Y*Y;for(let q=0;q<k.length;q++)for(let G=0;G<w.length;G++){let $=z.squaredDistance(k[q],w[G]);$<W&&$>0&&(M[G]=1)}var D=[];if(s.within.invert)for(let q=0;q<w.length;q++)M[q]||D.push(w[q]);else for(let q in M)D.push(w[q]);w=D}if(s.hasOwnProperty("byres")){var P={},F=[],X=[];for(let Y=0;Y<w.length;Y++){let W=w[Y];var B=W.chain,L=W.resi;if(P[B]===void 0&&(P[B]={}),W.hasOwnProperty("resi")&&P[B][L]===void 0){for(P[B][L]=!0,X.push(W);X.length>0;)if(W=X.pop(),B=W.chain,L=W.resi,F[W.index]===void 0){F[W.index]=!0;for(var H=0;H<W.bonds.length;H++){var U=this.atoms[W.bonds[H]];F[U.index]===void 0&&U.hasOwnProperty("resi")&&U.chain==B&&U.resi==L&&(X.push(U),w.push(U))}}}}}return w}addAtoms(s){this.molObj=null;var v=this.atoms.length,w=[],E;for(E=0;E<s.length;E++)typeof s[E].index>"u"&&(s[E].index=E),typeof s[E].serial>"u"&&(s[E].serial=E),w[s[E].index]=v+E;for(E=0;E<s.length;E++){var C=s[E],h=w[C.index],x=(0,_.extend)({},C);x.index=h,x.bonds=[],x.bondOrder=[],x.model=this.id,x.style=x.style||(0,_.deepCopy)(z.defaultAtomStyle),typeof x.color>"u"&&(x.color=this.ElementColors[x.elem]||this.defaultColor);for(var k=C.bonds?C.bonds.length:0,M=0;M<k;M++){var D=w[C.bonds[M]];typeof D<"u"&&(x.bonds.push(D),x.bondOrder.push(C.bondOrder?C.bondOrder[M]:1))}this.atoms.push(x)}}assignBonds(){(0,R.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(s){this.molObj=null;var v=[],w;for(w=0;w<s.length;w++)v[s[w].index]=!0;var E=[];for(w=0;w<this.atoms.length;w++){var C=this.atoms[w];v[C.index]||E.push(C)}this.atoms=[],this.addAtoms(E)}setStyle(s,v,w){typeof v>"u"&&typeof w>"u"&&(v=s,s={}),s=s,typeof v=="string"&&(v=(0,_.specStringToObject)(v));var E=!1,C=this,h=function(k){var M=C.selectedAtoms(s,k);for(let D=0;D<k.length;D++)k[D]&&(k[D].capDrawn=!1);for(let D=0;D<M.length;D++){E=!0,(M[D].clickable||M[D].hoverable)&&(M[D].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),w||(M[D].style={});for(let P in v)v.hasOwnProperty(P)&&(M[D].style[P]=M[D].style[P]||{},Object.assign(M[D].style[P],v[P]))}};if(s.frame!==void 0&&s.frame<this.frames.length){let k=s.frame;k<0&&(k=this.frames.length+k),h(this.frames[k])}else{h(this.atoms);for(var x=0;x<this.frames.length;x++)this.frames[x]!==this.atoms&&h(this.frames[x])}E&&(this.molObj=null)}setClickable(s,v,w){if(v=!!v,w=(0,_.makeFunction)(w),w===null){console.log("Callback is not a function");return}var E=this.selectedAtoms(s,this.atoms),C=E.length;for(let h=0;h<C;h++)E[h].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},E[h].clickable=v,w&&(E[h].callback=w);C>0&&(this.molObj=null)}setHoverable(s,v,w,E){if(v=!!v,w=(0,_.makeFunction)(w),E=(0,_.makeFunction)(E),w===null){console.log("Hover_callback is not a function");return}if(E===null){console.log("Unhover_callback is not a function");return}var C=this.selectedAtoms(s,this.atoms),h=C.length;for(let x=0;x<h;x++)C[x].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},C[x].hoverable=v,w&&(C[x].hover_callback=w),E&&(C[x].unhover_callback=E);h>0&&(this.molObj=null)}enableContextMenu(s,v){v=!!v;var w,E=this.selectedAtoms(s,this.atoms),C=E.length;for(w=0;w<C;w++)E[w].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},E[w].contextMenuEnabled=v;C>0&&(this.molObj=null)}setColorByElement(s,v){if(!(this.molObj!==null&&z.sameObj(v,this.lastColors))){this.lastColors=v;var w=this.selectedAtoms(s,w);w.length>0&&(this.molObj=null);for(var E=0;E<w.length;E++){var C=w[E];typeof v[C.elem]<"u"&&(C.color=v[C.elem])}}}setColorByProperty(s,v,w,E){var C,h,x=this.selectedAtoms(s,x);for(this.lastColors=null,x.length>0&&(this.molObj=null),typeof w=="string"&&typeof p.Gradient.builtinGradients[w]<"u"&&(w=new p.Gradient.builtinGradients[w]),w=w,E||(E=w.range()),E||(E=(0,_.getPropertyRange)(x,v)),C=0;C<x.length;C++){h=x[C];var k=(0,_.getAtomProperty)(h,v);k!=null&&(h.color=w.valueToHex(parseFloat(h.properties[v]),E))}}setColorByFunction(s,v){var w=this.selectedAtoms(s,w);if(typeof v=="function"){this.lastColors=null,w.length>0&&(this.molObj=null);for(let E=0;E<w.length;E++){let C=w[E];C.color=v(C)}}}toCDObject(s=!1){var v={a:[],b:[]};s&&(v.s=[]);for(let E=0;E<this.atoms.length;E++){let C={},h=this.atoms[E];if(C.x=h.x,C.y=h.y,C.z=h.z,h.elem!="C"&&(C.l=h.elem),s){for(var w=0;w<v.s.length&&JSON.stringify(h.style)!==JSON.stringify(v.s[w]);)w++;w===v.s.length&&v.s.push(h.style),w!==0&&(C.s=w)}v.a.push(C);for(let x=0;x<h.bonds.length;x++){let k=E,M=h.bonds[x];if(k>=M)continue;let D={b:k,e:M},P=h.bondOrder[x];P!=1&&(D.o=P),v.b.push(D)}}return v}globj(s,v){(this.molObj===null||v.regen)&&(this.molObj=this.createMolObj(this.atoms,v),this.renderedMolObj&&(s.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),s.add(this.renderedMolObj))}exportVRML(){var s=this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1});return s.vrml()}removegl(s){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),s.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(s,v,w,E){for(var C=this.selectedAtoms(v,C),h=(0,_.deepCopy)(E),x=0;x<C.length;x++){var k=C[x],M=null;typeof k[s]<"u"?M=String(k[s]):typeof k.properties[s]<"u"&&(M=String(k.properties[s])),M!=null&&(h.position=k,w.addLabel(M,h))}}addResLabels(s,v,w,E=!1){var C=[],h=function(k,M){for(var D=k.selectedAtoms(s,D),P={},F=0;F<D.length;F++){var X=D[F],B=X.chain,L=X.resn,H=X.resi,U=L+""+H;P[B]||(P[B]={}),P[B][U]||(P[B][U]=[]),P[B][U].push(X)}var Y=(0,_.deepCopy)(w);for(let q in P)if(P.hasOwnProperty(q)){var W=P[q];for(let G in W)if(W.hasOwnProperty(G)){let $=W[G],Z=new u.Vector3(0,0,0);for(let ce=0;ce<$.length;ce++){let Ne=$[ce];Z.x+=Ne.x,Z.y+=Ne.y,Z.z+=Ne.z}Z.divideScalar($.length),Y.position=Z,Y.frame=M;let xe=v.addLabel(G,Y,void 0,!0);C.push(xe)}}};if(E){var x=this.getNumFrames();let k=this.atoms;for(let M=0;M<x;M++)this.frames[M]&&(this.atoms=this.frames[M],h(this,M));this.atoms=k}else h(this);return C}setupDFS(){this.atomdfs=[];var s=this,v=new Int8Array(this.atoms.length);v.fill(0);for(var w=function(x,k,M){M.push([x,k]);var D=s.atoms[x];v[x]=1;for(var P=0;P<D.bonds.length;P++){var F=D.bonds[P];s.atoms[F]&&!v[F]&&w(F,x,M)}},E=0;E<this.atoms.length;E++){var C=this.atoms[E];if(C&&!v[E]){var h=[];w(E,-1,h),this.atomdfs.push(h)}}}setCoordinatesFromURL(s,v){this.frames=[];var w=this;return this.box&&this.setupDFS(),s.startsWith("http")||(s="http://"+s),(0,_.get)(s+"/traj/numframes/"+v,function(E){if(!isNaN(parseInt(E)))return w.frames.push(w.atoms),w.frames.numFrames=E,w.frames.url=s,w.frames.path=v,w.setFrame(0)})}setCoordinates(s,v){if(v=v||"",!s)return[];if(/\.gz$/.test(v)){v=v.replace(/\.gz$/,"");try{s=(0,_.inflateString)(s)}catch(P){console.log(P)}}var w={mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""};if(w.hasOwnProperty(v)){this.frames=[];for(var E=this.atoms.length,C=z.parseCrd(s,v),h=0;h<C.length;){for(var x=[],k=0;k<E;k++){var M={};for(var D in this.atoms[k])M[D]=this.atoms[k][D];x[k]=M,x[k].x=C[h++],x[k].y=C[h++],x[k].z=C[h++]}this.frames.push(x)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(s){}static parseCrd(s,v){var w=[],E=0;if(v=="pdb")for(var C=s.indexOf(`
ATOM`);C!=-1;){for(;s.slice(C,C+5)==`
ATOM`||s.slice(C,C+7)==`
HETATM`;)w[E++]=parseFloat(s.slice(C+31,C+39)),w[E++]=parseFloat(s.slice(C+39,C+47)),w[E++]=parseFloat(s.slice(C+47,C+55)),C=s.indexOf(`
`,C+54),s.slice(C,C+4)==`
TER`&&(C=s.indexOf(`
`,C+5));C=s.indexOf(`
ATOM`,C)}else if(v=="netcdf"){var h=new A.NetCDFReader(s);w=[].concat.apply([],h.getDataVariable("coordinates"))}else{if(v=="array"||Array.isArray(s))return s.flat(2);{let x=s.indexOf(`
`);v=="inpcrd"&&(x=s.indexOf(`
`,x+1)),s=s.slice(x+1),w=s.match(/\S+/g).map(parseFloat)}}return w}static parseMolData(s,v="",w){if(!s)return[];if(/\.gz$/.test(v)){v=v.replace(/\.gz$/,"");try{v.match(/bcif/i)?s=(0,_.inflateString)(s,!1):s=(0,_.inflateString)(s)}catch(h){console.log(h)}}typeof S.Parsers[v]>"u"&&(v=v.split(".").pop(),typeof S.Parsers[v]>"u"&&(console.log("Unknown format: "+v),s instanceof Uint8Array?v="bcif":s.match(/^@<TRIPOS>MOLECULE/gm)?v="mol2":s.match(/^data_/gm)&&s.match(/^loop_/gm)?v="cif":s.match(/^HETATM/gm)||s.match(/^ATOM/gm)?v="pdb":s.match(/ITEM: TIMESTEP/gm)?v="lammpstrj":s.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?v="sdf":s.match(/^%VERSION\s+VERSION_STAMP/gm)?v="prmtop":v="xyz",console.log("Best guess: "+v)));var E=S.Parsers[v],C=E(s,w);return C}}z.defaultAtomStyle={line:{}},z.defaultlineWidth=1,z.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},z.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"])}),"./src/GLShape.ts":((e,r,t)=>{t.r(r),t.d(r,{GLShape:()=>A,splitMesh:()=>R});var o=t("./src/WebGL/index.ts"),c=t("./src/WebGL/shapes/index.ts"),u=t("./src/WebGL/math/index.ts"),y=t("./src/colors.ts"),f=t("./src/ProteinSurface4.ts"),g=t("./src/VolumeData.ts"),_=t("./src/GLDraw.ts"),p=t("./src/glcartoon.ts"),S=t("./src/utilities.ts");class A{static finalizeGeo(l){var s=l.updateGeoGroup(0);s.vertices>0&&s.truncateArrayBuffers(!0,!0)}static updateColor(l,s){s=s||y.CC.color(s),l.colorsNeedUpdate=!0;var v,w,E;s.constructor!==Array&&(v=s.r,w=s.g,E=s.b);for(let C in l.geometryGroups){let h=l.geometryGroups[C],x=h.colorArray;for(let k=0,M=h.vertices;k<M;++k){if(s.constructor===Array){let D=s[k];v=D.r,w=D.g,E=D.b}x[k*3]=v,x[k*3+1]=w,x[k*3+2]=E}}}static drawArrow(l,s,v){var w=v.start,E=v.end,C=v.radius,h=v.radiusRatio,x=v.mid,k=v.midpos;if(!(w&&E))return;var M=s.updateGeoGroup(51),D=new u.Vector3(E.x,E.y,E.z).sub(w);if(k){let et=D.length();k>0?x=k/et:x=(et+k)/et}D.multiplyScalar(x);var P=new u.Vector3(w.x,w.y,w.z).add(D),F=D.clone().negate();let X=new u.Vector3(w.x,w.y,w.z);l.intersectionShape.cylinder.push(new c.Cylinder(X,P.clone(),C)),l.intersectionShape.sphere.push(new c.Sphere(X,C));var B=[];B[0]=D.clone(),Math.abs(B[0].x)>1e-4?B[0].y+=1:B[0].x+=1,B[0].cross(D),B[0].normalize(),B[4]=B[0].clone(),B[4].crossVectors(B[0],D),B[4].normalize(),B[8]=B[0].clone().negate(),B[12]=B[4].clone().negate(),B[2]=B[0].clone().add(B[4]).normalize(),B[6]=B[4].clone().add(B[8]).normalize(),B[10]=B[8].clone().add(B[12]).normalize(),B[14]=B[12].clone().add(B[0]).normalize(),B[1]=B[0].clone().add(B[2]).normalize(),B[3]=B[2].clone().add(B[4]).normalize(),B[5]=B[4].clone().add(B[6]).normalize(),B[7]=B[6].clone().add(B[8]).normalize(),B[9]=B[8].clone().add(B[10]).normalize(),B[11]=B[10].clone().add(B[12]).normalize(),B[13]=B[12].clone().add(B[14]).normalize(),B[15]=B[14].clone().add(B[0]).normalize();var L=M.vertices,H=M.vertexArray,U=M.faceArray,Y=M.normalArray,W=M.lineArray,q,G,$;for(G=0,$=B.length;G<$;++G){q=3*(L+3*G);var Z=B[G].clone().multiplyScalar(C).add(w),xe=B[G].clone().multiplyScalar(C).add(P),ce=B[G].clone().multiplyScalar(C*h).add(P);if(H[q]=Z.x,H[q+1]=Z.y,H[q+2]=Z.z,H[q+3]=xe.x,H[q+4]=xe.y,H[q+5]=xe.z,H[q+6]=ce.x,H[q+7]=ce.y,H[q+8]=ce.z,G>0){var Ne=H[q-3],Pe=H[q-2],De=H[q-1],Me=new u.Vector3(Ne,Pe,De),Be=new u.Vector3(E.x,E.y,E.z),ft=P.clone(),Ot=new u.Vector3(ce.x,ce.y,ce.z);l.intersectionShape.triangle.push(new c.Triangle(Ot,Be,Me)),l.intersectionShape.triangle.push(new c.Triangle(Me.clone(),ft,Ot.clone()))}}M.vertices+=48,q=M.vertices*3,H[q]=w.x,H[q+1]=w.y,H[q+2]=w.z,H[q+3]=P.x,H[q+4]=P.y,H[q+5]=P.z,H[q+6]=E.x,H[q+7]=E.y,H[q+8]=E.z,M.vertices+=3;var Gt,mt,je,ht,Kt,Jt,Wt,Br,zr,cr,Nr,At,Mt,Jr,Yr,ie,ve,we,it,rt=M.vertices-3,Yt=M.vertices-2,jt=M.vertices-1,re=rt*3,tt=Yt*3,lt=jt*3;for(G=0,$=B.length-1;G<$;++G){var ar=L+3*G;q=ar*3,mt=M.faceidx,je=M.lineidx,ht=ar,cr=ht*3,Kt=ar+1,Nr=Kt*3,Jt=ar+2,At=Jt*3,Wt=ar+4,Mt=Wt*3,Br=ar+5,Jr=Br*3,zr=ar+3,Yr=zr*3,ie=ve=B[G],we=it=B[G+1],Y[cr]=ie.x,Y[Nr]=ve.x,Y[Yr]=it.x,Y[cr+1]=ie.y,Y[Nr+1]=ve.y,Y[Yr+1]=it.y,Y[cr+2]=ie.z,Y[Nr+2]=ve.z,Y[Yr+2]=it.z,Y[Nr]=ve.x,Y[Mt]=we.x,Y[Yr]=it.x,Y[Nr+1]=ve.y,Y[Mt+1]=we.y,Y[Yr+1]=it.y,Y[Nr+2]=ve.z,Y[Mt+2]=we.z,Y[Yr+2]=it.z,Y[At]=ve.x,Y[Jr]=we.x,Y[At+1]=ve.y,Y[Jr+1]=we.y,Y[At+2]=ve.z,Y[Jr+2]=we.z,U[mt]=ht,U[mt+1]=Kt,U[mt+2]=zr,U[mt+3]=Kt,U[mt+4]=Wt,U[mt+5]=zr,U[mt+6]=ht,U[mt+7]=zr,U[mt+8]=rt,U[mt+9]=Jt,U[mt+10]=Yt,U[mt+11]=Br,U[mt+12]=Jt,U[mt+13]=jt,U[mt+14]=Br,W[je]=ht,W[je+1]=Kt,W[je+2]=ht,W[je+3]=zr,W[je+4]=Wt,W[je+5]=zr,W[je+6]=ht,W[je+7]=zr,W[je+8]=Jt,W[je+9]=Kt,W[je+10]=Jt,W[je+11]=Br,W[je+12]=Wt,W[je+13]=Br,W[je+14]=Jt,W[je+15]=jt,W[je+16]=Jt,W[je+17]=Br,W[je+18]=jt,W[je+19]=Br,M.faceidx+=15,M.lineidx+=20}Gt=[L+45,L+46,L+1,L,L+47,L+2],mt=M.faceidx,je=M.lineidx,ht=Gt[0],cr=ht*3,Kt=Gt[1],Nr=Kt*3,Jt=Gt[4],At=Jt*3,Wt=Gt[2],Mt=Wt*3,Br=Gt[5],Jr=Br*3,zr=Gt[3],Yr=zr*3,ie=ve=B[15],we=it=B[0],Y[cr]=ie.x,Y[Nr]=ve.x,Y[Yr]=it.x,Y[cr+1]=ie.y,Y[Nr+1]=ve.y,Y[Yr+1]=it.y,Y[cr+2]=ie.z,Y[Nr+2]=ve.z,Y[Yr+2]=it.z,Y[Nr]=ve.x,Y[Mt]=we.x,Y[Yr]=it.x,Y[Nr+1]=ve.y,Y[Mt+1]=we.y,Y[Yr+1]=it.y,Y[Nr+2]=ve.z,Y[Mt+2]=we.z,Y[Yr+2]=it.z,Y[At]=ve.x,Y[Jr]=we.x,Y[At+1]=ve.y,Y[Jr+1]=we.y,Y[At+2]=ve.z,Y[Jr+2]=we.z,D.normalize(),F.normalize(),Y[re]=F.x,Y[tt]=Y[lt]=D.x,Y[re+1]=F.y,Y[tt+1]=Y[lt+1]=D.y,Y[re+2]=F.z,Y[tt+2]=Y[lt+2]=D.z,U[mt]=ht,U[mt+1]=Kt,U[mt+2]=zr,U[mt+3]=Kt,U[mt+4]=Wt,U[mt+5]=zr,U[mt+6]=ht,U[mt+7]=zr,U[mt+8]=rt,U[mt+9]=Jt,U[mt+10]=Yt,U[mt+11]=Br,U[mt+12]=Jt,U[mt+13]=jt,U[mt+14]=Br,W[je]=ht,W[je+1]=Kt,W[je+2]=ht,W[je+3]=zr,W[je+4]=Wt,W[je+5]=zr,W[je+6]=ht,W[je+7]=zr,W[je+8]=Jt,W[je+9]=Kt,W[je+10]=Jt,W[je+11]=Br,W[je+12]=Wt,W[je+13]=Br,W[je+14]=Jt,W[je+15]=jt,W[je+16]=Jt,W[je+17]=Br,W[je+18]=jt,W[je+19]=Br,M.faceidx+=15,M.lineidx+=20}static updateBoundingFromPoints(l,s,v,w){l.center.set(0,0,0);let E=1/0,C=1/0,h=1/0,x=-1/0,k=-1/0,M=-1/0;l.box&&(E=l.box.min.x,x=l.box.max.x,C=l.box.min.y,k=l.box.max.y,h=l.box.min.z,M=l.box.max.z);for(let X=0,B=w;X<B;X++){var D=v[X*3],P=v[X*3+1],F=v[X*3+2];D<E&&(E=D),P<C&&(C=P),F<h&&(h=F),D>x&&(x=D),P>k&&(k=P),F>M&&(M=F)}l.center.set((x+E)/2,(k+C)/2,(M+h)/2),l.radius=l.center.distanceTo({x,y:k,z:M}),l.box={min:{x:E,y:C,z:h},max:{x,y:k,z:M}}}static addCustomGeo(l,s,v,w,E){var C=s.addGeoGroup(),h=v.vertexArr,x=v.normalArr,k=v.faceArr;C.vertices=h.length,C.faceidx=k.length;var M,D,P,F,X,B,L,H,U,Y=C.vertexArray,W=C.colorArray;for(w.constructor!==Array&&(H=w.r,U=w.g,F=w.b),B=0,L=C.vertices;B<L;++B)M=B*3,D=h[B],Y[M]=D.x,Y[M+1]=D.y,Y[M+2]=D.z,w.constructor===Array&&(X=w[B],H=X.r,U=X.g,F=X.b),W[M]=H,W[M+1]=U,W[M+2]=F;if(E)for(B=0,L=C.faceidx/3;B<L;++B){M=B*3,P=k[M],F=k[M+1],X=k[M+2];var q=new u.Vector3,G=new u.Vector3,$=new u.Vector3;l.intersectionShape.triangle.push(new c.Triangle(q.copy(h[P]),G.copy(h[F]),$.copy(h[X])))}if(E){var Z=new u.Vector3(0,0,0),xe=0;for(let Pe=0;Pe<s.geometryGroups.length;Pe++)Z.add(s.geometryGroups[Pe].getCentroid()),xe++;Z.divideScalar(xe),A.updateBoundingFromPoints(l.boundingSphere,{centroid:Z},Y,C.vertices)}if(C.faceArray=new Uint16Array(k),C.truncateArrayBuffers(!0,!0),x.length<C.vertices)C.setNormals();else{var ce=C.normalArray=new Float32Array(C.vertices*3),Ne;for(B=0,L=C.vertices;B<L;++B)M=B*3,Ne=x[B],ce[M]=Ne.x,ce[M+1]=Ne.y,ce[M+2]=Ne.z}C.setLineIndices(),C.lineidx=C.lineArray.length}static updateFromStyle(l,s){typeof s.color<"u"?(l.color=s.color||new y.Color,s.color instanceof y.Color||(l.color=y.CC.color(s.color))):l.color=y.CC.color(0),l.wireframe=!!s.wireframe,l.opacity=s.alpha?(0,u.clamp)(s.alpha,0,1):1,typeof s.opacity<"u"&&(l.opacity=(0,u.clamp)(s.opacity,0,1)),l.side=s.side!==void 0?s.side:o.DoubleSide,l.linewidth=typeof s.linewidth>"u"?1:s.linewidth,l.clickable=!!s.clickable,l.callback=(0,S.makeFunction)(s.callback),l.hoverable=!!s.hoverable,l.hover_callback=(0,S.makeFunction)(s.hover_callback),l.unhover_callback=(0,S.makeFunction)(s.unhover_callback),l.contextMenuEnabled=!!s.contextMenuEnabled,l.hidden=s.hidden,l.frame=s.frame}constructor(l){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=o.DoubleSide,this.stylespec=l||{},this.boundingSphere=new c.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},A.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new o.Geometry(!0),this.linegeo=new o.Geometry(!0)}updateStyle(l){for(var s in l)this.stylespec[s]=l[s];if(A.updateFromStyle(this,this.stylespec),l.voldata&&l.volscheme){(0,S.adjustVolumeStyle)(l);const v=l.volscheme,w=l.voldata,E=y.CC,C=v.range()||[-1,1];this.geo.setColors(function(h,x,k){let M=w.getVal(h,x,k);return E.color(v.valueToHex(M,C))}),delete this.color}}addCustom(l){l.vertexArr=l.vertexArr||[],l.faceArr=l.faceArr||[],l.normalArr=l.normalArr||[],A.drawCustom(this,this.geo,l)}addSphere(l){l.center||(l.center=new u.Vector3(0,0,0)),l.radius=l.radius?(0,u.clamp)(l.radius,0,1/0):1.5,l.color=y.CC.color(l.color),this.intersectionShape.sphere.push(new c.Sphere(l.center,l.radius)),_.GLDraw.drawSphere(this.geo,l.center,l.radius,l.color,l.quality),this.components.push({centroid:new u.Vector3(l.center.x,l.center.y,l.center.z)});var s=this.geo.updateGeoGroup(0);A.updateBoundingFromPoints(this.boundingSphere,this.components,s.vertexArray,s.vertices)}addBox(l){var s=l.dimensions||{w:1,h:1,d:1},v;typeof s.w=="number"?v={x:s.w,y:0,z:0}:v=s.w;var w;typeof s.h=="number"?w={x:0,y:s.h,z:0}:w=s.h;var E;typeof s.d=="number"?E={x:0,y:0,z:s.d}:E=s.d;var C=l.corner;C==null&&(l.center!==void 0?C={x:l.center.x-.5*(v.x+w.x+E.x),y:l.center.y-.5*(v.y+w.y+E.y),z:l.center.z-.5*(v.z+w.z+E.z)}:C={x:0,y:0,z:0});var h=[{x:C.x,y:C.y,z:C.z},{x:C.x+v.x,y:C.y+v.y,z:C.z+v.z},{x:C.x+w.x,y:C.y+w.y,z:C.z+w.z},{x:C.x+v.x+w.x,y:C.y+v.y+w.y,z:C.z+v.z+w.z},{x:C.x+E.x,y:C.y+E.y,z:C.z+E.z},{x:C.x+v.x+E.x,y:C.y+v.y+E.y,z:C.z+v.z+E.z},{x:C.x+w.x+E.x,y:C.y+w.y+E.y,z:C.z+w.z+E.z},{x:C.x+v.x+w.x+E.x,y:C.y+v.y+w.y+E.y,z:C.z+v.z+w.z+E.z}],x=[],k=[];x.splice(x.length,0,h[0],h[1],h[2],h[3]),k.splice(k.length,0,0,2,1,1,2,3);var M=4;x.splice(x.length,0,h[2],h[3],h[6],h[7]),k.splice(k.length,0,M+0,M+2,M+1,M+1,M+2,M+3),M+=4,x.splice(x.length,0,h[4],h[5],h[0],h[1]),k.splice(k.length,0,M+0,M+2,M+1,M+1,M+2,M+3),M+=4,x.splice(x.length,0,h[6],h[7],h[4],h[5]),k.splice(k.length,0,M+0,M+2,M+1,M+1,M+2,M+3),M+=4,x.splice(x.length,0,h[3],h[1],h[7],h[5]),k.splice(k.length,0,M+0,M+2,M+1,M+1,M+2,M+3),M+=4,x.splice(x.length,0,h[2],h[6],h[0],h[4]),k.splice(k.length,0,M+0,M+2,M+1,M+1,M+2,M+3),M+=4;var D=(0,S.extend)({},l);D.vertexArr=x,D.faceArr=k,D.normalArr=[],A.drawCustom(this,this.geo,D);var P=new u.Vector3;this.components.push({centroid:P.addVectors(h[0],h[7]).multiplyScalar(.5)});var F=this.geo.updateGeoGroup(0);A.updateBoundingFromPoints(this.boundingSphere,this.components,F.vertexArray,F.vertices)}addCylinder(l){var s,v;l.start?s=new u.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):s=new u.Vector3(0,0,0),l.end?(v=new u.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof v.x>"u"&&(v.x=3)):v=new u.Vector3(0,0,0);var w=l.radius||.1,E=y.CC.color(l.color);this.intersectionShape.cylinder.push(new c.Cylinder(s,v,w)),_.GLDraw.drawCylinder(this.geo,s,v,w,E,l.fromCap,l.toCap);var C=new u.Vector3;this.components.push({centroid:C.addVectors(s,v).multiplyScalar(.5)});var h=this.geo.updateGeoGroup(0);A.updateBoundingFromPoints(this.boundingSphere,this.components,h.vertexArray,h.vertices)}addDashedCylinder(l){l.dashLength=l.dashLength||.25,l.gapLength=l.gapLength||.25;var s;l.start?s=new u.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):s=new u.Vector3(0,0,0);var v;l.end?(v=new u.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof v.x>"u"&&(v.x=3)):v=new u.Vector3(3,0,0);for(var w=l.radius||.1,E=y.CC.color(l.color),C=Math.sqrt(Math.pow(s.x-v.x,2)+Math.pow(s.y-v.y,2)+Math.pow(s.z-v.z,2)),h=C/(l.gapLength+l.dashLength),x=new u.Vector3(l.start.x||0,l.start.y||0,l.start.z||0),k=new u.Vector3(l.end.x,l.end.y||0,l.end.z||0),M=new u.Vector3((v.x-s.x)/(C/l.gapLength),(v.y-s.y)/(C/l.gapLength),(v.z-s.z)/(C/l.gapLength)),D=new u.Vector3((v.x-s.x)/(C/l.dashLength),(v.y-s.y)/(C/l.dashLength),(v.z-s.z)/(C/l.dashLength)),P=0;P<h;P++)k=new u.Vector3(x.x+D.x,x.y+D.y,x.z+D.z),this.intersectionShape.cylinder.push(new c.Cylinder(x,k,w)),_.GLDraw.drawCylinder(this.geo,x,k,w,E,l.fromCap,l.toCap),x=new u.Vector3(k.x+M.x,k.y+M.y,k.z+M.z);var F=new u.Vector3;this.components.push({centroid:F.addVectors(s,v).multiplyScalar(.5)});var X=this.geo.updateGeoGroup(0);A.updateBoundingFromPoints(this.boundingSphere,this.components,X.vertexArray,X.vertices)}addCurve(l){l.points=l.points||[],l.smooth=l.smooth||10,typeof l.fromCap>"u"&&(l.fromCap=2),typeof l.toCap>"u"&&(l.toCap=2);var s=(0,p.subdivide_spline)(l.points,l.smooth);if(s.length<3){console.log("Too few points in addCurve");return}var v=l.radius||.1,w=y.CC.color(l.color),E=0,C=s.length-1,h=s[0].distanceTo(s[1]),x=Math.ceil(2*v/h);if(l.toArrow){C-=x;let P={start:s[C],end:s[s.length-1],radius:v,color:w,mid:1e-4};this.addArrow(P)}if(l.fromArrow){E+=x;let P={start:s[E],end:s[0],radius:v,color:w,mid:1e-4};this.addArrow(P)}for(var k=Math.ceil(s.length/2),M={radius:v,color:w,fromCap:2,toCap:2},D=E;D<C;D++)M.start=s[D],M.end=s[D+1],M.fromCap=2,M.toCap=2,D<k?(M.fromCap=2,M.toCap=0):D>k?(M.fromCap=0,M.toCap=2):(M.fromCap=2,M.toCap=2),this.addCylinder(M)}addLine(l){var s,v;l.start?s=new u.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):s=new u.Vector3(0,0,0),l.end?(v=new u.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof v.x>"u"&&(v.x=3)):v=new u.Vector3(3,0,0);var w=this.geo.updateGeoGroup(2),E=w.vertices,C=E*3,h=w.vertexArray;h[C]=s.x,h[C+1]=s.y,h[C+2]=s.z,h[C+3]=v.x,h[C+4]=v.y,h[C+5]=v.z,w.vertices+=2;var x=w.lineArray,k=w.lineidx;x[k]=E,x[k+1]=E+1,w.lineidx+=2;var M=new u.Vector3;this.components.push({centroid:M.addVectors(s,v).multiplyScalar(.5)}),w=this.geo.updateGeoGroup(0),A.updateBoundingFromPoints(this.boundingSphere,this.components,w.vertexArray,w.vertices)}addArrow(l){if(l.start?l.start=new u.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):l.start=new u.Vector3(0,0,0),l.dir instanceof u.Vector3&&typeof l.length=="number"){var s=l.dir.clone().multiplyScalar(l.length).add(l.start);l.end=s}else l.end?(l.end=new u.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof l.end.x>"u"&&(l.end.x=3)):l.end=new u.Vector3(3,0,0);l.radius=l.radius||.1,l.radiusRatio=l.radiusRatio||1.618034,l.mid=0<l.mid&&l.mid<1?l.mid:.618034,A.drawArrow(this,this.geo,l);var v=new u.Vector3;this.components.push({centroid:v.addVectors(l.start,l.end).multiplyScalar(.5)});var w=this.geo.updateGeoGroup(0);A.updateBoundingFromPoints(this.boundingSphere,this.components,w.vertexArray,w.vertices)}static distance_from(l,s){return Math.sqrt(Math.pow(l.x-s.x,2)+Math.pow(l.y-s.y,2)+Math.pow(l.z-s.z,2))}static inSelectedRegion(l,s,v){for(var w=0;w<s.length;w++)if(A.distance_from(s[w],l)<=v)return!0;return!1}addIsosurface(l,s,v,w){var E=s.isoval!==void 0&&typeof s.isoval=="number"?s.isoval:0,C=!!s.voxel,h=s.smoothness===void 0?1:s.smoothness,x=l.size.x,k=l.size.y,M=l.size.z,D=new Int16Array(x*k*M),P=l.data,F,X;for(F=0,X=D.length;F<X;++F)D[F]=-1;var B=new Uint8Array(x*k*M);for(F=0,X=P.length;F<X;++F){var L=E>=0?P[F]-E:E-P[F];L>0&&(B[F]|=A.ISDONE)}var H=[],U=[];f.MarchingCube.march(B,H,U,{fulltable:!0,voxel:C,unitCube:l.unit,origin:l.origin,matrix:l.matrix,nX:x,nY:k,nZ:M}),!C&&h>0&&f.MarchingCube.laplacianSmooth(h,H,U);var Y=[],W=[],q=[];if(s.selectedRegion&&s.coords===void 0&&(s.coords=s.selectedRegion),s.coords===void 0&&s.selection!==void 0&&(w?s.coords=w.selectedAtoms(s.selection):console.log("addIsosurface needs viewer is selection provided.")),s.coords!==void 0){var G=s.coords[0].x,$=s.coords[0].y,Z=s.coords[0].z,xe=s.coords[0].x,ce=s.coords[0].y,Ne=s.coords[0].z;for(let je=0;je<s.coords.length;je++)s.coords[je].x>G?G=s.coords[je].x:s.coords[je].x<xe&&(xe=s.coords[je].x),s.coords[je].y>$?$=s.coords[je].y:s.coords[je].y<ce&&(ce=s.coords[je].y),s.coords[je].z>Z?Z=s.coords[je].z:s.coords[je].z<Ne&&(Ne=s.coords[je].z);var Pe=2;s.radius!==void 0&&(Pe=s.radius),s.selectedOffset!==void 0&&(Pe=s.selectedOffset),s.seldist!==void 0&&(Pe=s.seldist),xe-=Pe,G+=Pe,ce-=Pe,$+=Pe,Ne-=Pe,Z+=Pe;for(let je=0;je<H.length;je++)H[je].x>xe&&H[je].x<G&&H[je].y>ce&&H[je].y<$&&H[je].z>Ne&&H[je].z<Z&&A.inSelectedRegion(H[je],s.coords,Pe)?(Y.push(W.length),W.push(H[je])):Y.push(-1);for(let je=0;je+2<U.length;je+=3)Y[U[je]]!==-1&&Y[U[je+1]]!==-1&&Y[U[je+2]]!==-1&&(q.push(U[je]-(U[je]-Y[U[je]])),q.push(U[je+1]-(U[je+1]-Y[U[je+1]])),q.push(U[je+2]-(U[je+2]-Y[U[je+2]])));H=W,U=q}A.drawCustom(this,this.geo,{vertexArr:H,faceArr:U,normalArr:[],clickable:s.clickable,hoverable:s.hoverable}),this.updateStyle(s);var De=new u.Vector3(l.origin.x,l.origin.y,l.origin.z),Me=new u.Vector3(l.size.x*l.unit.x,l.size.y*l.unit.y,l.size.z*l.unit.z),Be=new u.Vector3(0,0,0),ft=De.clone(),Ot=De.clone().add(Me);for(let je=0;je<H.length;je++)Be.add(H[je]),ft.max(H[je]),Ot.min(H[je]);Be.divideScalar(H.length);var Gt=Be.distanceTo(Ot),mt=Be.distanceTo(ft);this.boundingSphere.center=Be,this.boundingSphere.radius=Math.max(Gt,mt),typeof v=="function"&&v()}addVolumetricData(l,s,v){l=new g.VolumeData(l,s),this.addIsosurface(l,v)}finalize(){return A.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj(l){if(this.renderedShapeObj&&(l.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){A.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),typeof this.color<"u"&&A.updateColor(this.geo,this.color),this.shapeObj=new o.Object3D;var s=null;this.side==o.DoubleSide?s=new o.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:o.Coloring.VertexColors}):s=new o.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:o.Coloring.VertexColors});var v=new o.Mesh(this.geo,s);if(this.shapeObj.add(v),this.linegeo&&this.linegeo.vertices>0){var w=new o.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),E=new o.Line(this.linegeo,w,o.LineStyle.LinePieces);this.shapeObj.add(E)}this.renderedShapeObj=this.shapeObj.clone(),l.add(this.renderedShapeObj)}}removegl(l){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),l.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}A.ISDONE=2,A.drawCustom=function(z,l,s){var v=s,w=v.vertexArr,E=v.faceArr;(w.length===0||E.length===0)&&console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var C=s.color;typeof C>"u"&&(C=z.color),C=y.CC.color(C);for(var h=R(v),x=0,k=h.length;x<k;x++)A.addCustomGeo(z,l,h[x],h[x].colorArr?h[x].colorArr:C,s.clickable)};function R(z){var l=64e3;if(z.vertexArr.length<l)return[z];var s=[{vertexArr:[],normalArr:[],faceArr:[]}];z.colorArr&&(s.colorArr=[]);var v=[],w=[],E=0,C=z.faceArr;for(let x=0,k=C.length;x<k;x+=3){let M=s[E];for(let D=0;D<3;D++){var h=C[x+D];v[h]!==E&&(v[h]=E,w[h]=M.vertexArr.length,M.vertexArr.push(z.vertexArr[h]),z.normalArr&&z.normalArr[h]&&M.normalArr.push(z.normalArr[h]),z.colorArr&&z.colorArr[h]&&M.colorArr.push(z.colorArr[h])),M.faceArr.push(w[h])}M.vertexArr.length>=l&&(s.push({vertexArr:[],normalArr:[],faceArr:[]}),z.colorArr&&(s.colorArr=[]),E++)}return s}}),"./src/GLViewer.ts":((e,r,t)=>{t.r(r),t.d(r,{CONTEXTS_PER_VIEWPORT:()=>l,GLViewer:()=>s,createStereoViewer:()=>E,createViewer:()=>v,createViewerGrid:()=>w});var o=t("./src/WebGL/index.ts"),c=t("./src/WebGL/math/index.ts"),u=t("./src/colors.ts"),y=t("./src/utilities.ts"),f=t("./src/Gradient.ts"),g=t("./src/GLModel.ts"),_=t("./src/Label.ts"),p=t("./src/GLShape.ts"),S=t("./src/VolumeData.ts"),A=t("./src/ProteinSurface4.ts"),R=t("./src/VolumetricRender.ts"),z=t("./node_modules/upng-js/UPNG.js");const l=16;class s{getWidth(){let h=this.container,x=h.offsetWidth;if(x==0&&h.style.display==="none"){let k=h.style.position,M=h.style.visibility;h.style.display="block",h.style.visibility="hidden",h.style.position="absolute",x=h.offsetWidth,h.style.display="none",h.style.visibility=M,h.style.position=k}return x}getHeight(){let h=this.container,x=h.offsetHeight;if(x==0&&h.style.display==="none"){let k=h.style.position,M=h.style.visibility;h.style.display="block",h.style.visibility="hidden",h.style.position="absolute",x=h.offsetHeight,h.style.display="none",h.style.visibility=M,h.style.position=k}return x}setupRenderer(){this.renderer=new o.Renderer({antialias:this.config.antialias,preserveDrawingBuffer:!0,premultipliedAlpha:!1,id:this.config.id,row:this.config.row,col:this.config.col,rows:this.config.rows,cols:this.config.cols,canvas:this.config.canvas,containerWidth:this.WIDTH,containerHeight:this.HEIGHT,ambientOcclusion:this.config.ambientOcclusion,outline:this.config.outline}),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new o.Scene,this.scene.fog=new o.Fog(this.bgColor,100,200),this.modelGroup=new o.Object3D,this.rotationGroup=new o.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new c.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var h=new o.Light(16777215);h.position=new c.Vector3(.2,.2,1).normalize(),h.intensity=1,this.scene.add(h)}_handleLostContext(h){const x=function(k){const M=k.getBoundingClientRect();return!(M.right<0||M.bottom<0||M.top>(window.innerHeight||document.documentElement.clientHeight)||M.left>(window.innerWidth||document.documentElement.clientWidth))};if(x(this.container)){let k=0;for(let M of document.getElementsByTagName("canvas"))if(x(M)&&M._3dmol_viewer!=null&&(M._3dmol_viewer.resize(),k+=1,k>=l))break}}initContainer(h){this.container=h,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var h=0;for(let k in this.surfaces)if(this.surfaces.hasOwnProperty(k)){var x=parseInt(k);isNaN(x)||x>h&&(h=x)}return h+1}setSlabAndFog(){let h=this.camera.position.z-this.rotationGroup.position.z;h<1&&(h=1),this.camera.near=h+this.slabNear,this.camera.near<1&&(this.camera.near=1),this.camera.far=h+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=h*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.far,this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(h){if(this.renderer.setViewport(),!!this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!h&&this.linkedViewers.length>0))for(var x=this._viewer.getView(),k=0;k<this.linkedViewers.length;k++){var M=this.linkedViewers[k];M.setView(x,!0)}}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let h=0,x=this.models.length;h<x;h++){let k=this.models[h];if(k){let M=k.selectedAtoms({clickable:!0}),D=k.selectedAtoms({hoverable:!0}),P=k.selectedAtoms({contextMenuEnabled:!0});for(let F=0;F<D.length;F++)this.hoverables.push(D[F]);for(let F=0;F<M.length;F++)this.clickables.push(M[F]);for(let F=0;F<P.length;F++)this.contextMenuEnabledObjects.push(P[F])}}for(let h=0,x=this.shapes.length;h<x;h++){let k=this.shapes[h];k&&k.clickable&&this.clickables.push(k),k&&k.hoverable&&this.hoverables.push(k),k&&k.contextMenuEnabled&&this.contextMenuEnabledObjects.push(k)}}handleClickSelection(h,x,k){let M=this.targetedObjects(h,x,this.clickables);if(M.length){var D=M[0].clickable;D.callback!==void 0&&(typeof D.callback!="function"&&(D.callback=(0,y.makeFunction)(D.callback)),typeof D.callback=="function"&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(D)&&this.userContextMenuHandler||D.callback(D,this._viewer,k,this.container,M)))}}canvasOffset(){let h=this.glDOM,x=h.getBoundingClientRect(),k=h.ownerDocument,M=k.documentElement,D=k.defaultView;return{top:x.top+D.pageYOffset-M.clientTop,left:x.left+D.pageXOffset-M.clientLeft}}setHover(h,x,k){this.current_hover!=h&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,y.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,x,this.container,k)),this.current_hover=h,h&&h.hover_callback!==void 0&&(typeof h.hover_callback!="function"&&(h.hover_callback=(0,y.makeFunction)(h.hover_callback)),typeof h.hover_callback=="function"&&h.hover_callback(h,this._viewer,x,this.container,k)))}handleHoverSelection(h,x,k){if(this.hoverables.length==0)return;let M=this.targetedObjects(h,x,this.hoverables);if(M.length){var D=M[0].clickable;this.setHover(D,k,M),this.current_hover=D}else this.setHover(null)}handleHoverContinue(h,x){let k=this.targetedObjects(h,x,this.hoverables);(k.length==0||k[0]===void 0)&&this.setHover(null),k[0]!==void 0&&k[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(h,{allowTolerance:x=h.targetTouches,tolerance:k=5}={}){const M=this.getX(h),D=this.getY(h);if(x){const P=Math.abs(M-this.mouseStartX),F=Math.abs(D-this.mouseStartY);return P<=k&&F<=k}else return M===this.mouseStartX&&D===this.mouseStartY}calcTouchDistance(h){var x=h.targetTouches[0].pageX-h.targetTouches[1].pageX,k=h.targetTouches[0].pageY-h.targetTouches[1].pageY;return Math.hypot(x,k)}getX(h){var x=h.pageX;return x==null&&(x=h.pageX),h.targetTouches&&h.targetTouches[0]?x=h.targetTouches[0].pageX:h.changedTouches&&h.changedTouches[0]&&(x=h.changedTouches[0].pageX),x}getY(h){var x=h.pageY;return x==null&&(x=h.pageY),h.targetTouches&&h.targetTouches[0]?x=h.targetTouches[0].pageY:h.changedTouches&&h.changedTouches[0]&&(x=h.changedTouches[0].pageY),x}isInViewer(h,x){if(this.viewers!=null){var k=this.WIDTH/this.cols,M=this.HEIGHT/this.rows,D=this.canvasOffset(),P=h-D.left,F=x-D.top,X=this.rows-Math.floor(F/M)-1,B=Math.floor(P/k);if(X!=this.row||B!=this.col)return!1}return!0}adjustZoomToLimits(h){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let x=this.CAMERA_Z-this.config.lowerZoomLimit;h>x&&(h=x)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let x=this.CAMERA_Z-this.config.upperZoomLimit;h<x&&(h=x)}return h>this.CAMERA_Z-1&&(h=this.CAMERA_Z-1),h}static slerp(h,x,k){if(k==1)return x.clone();if(k==0)return h.clone();let M=h.x*x.x+h.y*x.y+h.z*x.z+h.w*x.w;if(M>.9995){let H=new c.Quaternion(h.x+k*(x.x-h.x),h.y+k*(x.y-h.y),h.z+k*(x.z-h.z),h.w+k*(x.w-h.w));return H.normalize(),H}M<0&&(x=x.clone().multiplyScalar(-1),M=-M),M>1?M=1:M<-1&&(M=-1);var D=Math.acos(M),P=D*k,F=x.clone();F.sub(h.clone().multiplyScalar(M)),F.normalize();var X=Math.cos(P),B=Math.sin(P),L=new c.Quaternion(h.x*X+F.x*B,h.y*X+F.y*B,h.z*X+F.z*B,h.w*X+F.w*B);return L.normalize(),L}constructor(h,x={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.slabNear=-50,this.slabFar=50,this.cq=new c.Quaternion(0,0,0,1),this.dq=new c.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=x,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=u.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",typeof this.config.backgroundColor<"u"&&(this.bgColor=u.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,typeof this.config.camerax<"u"&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=h,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new o.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new c.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new c.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new o.Raycaster(new c.Vector3(0,0,0),new c.Vector3(0,0,0)),this.projector=new o.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=u.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),typeof window.ResizeObserver<"u"&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),typeof window.IntersectionObserver<"u"){let k=(M,D)=>{M.forEach(P=>{P.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(k),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(k){console.log("error with glviewer callback: "+k)}}targetedObjects(h,x,k){var M={x:h,y:x,z:-1};return Array.isArray(k)||(k=this.selectedAtoms(k)),k.length==0?[]:(this.raycaster.setFromCamera(M,this.camera),this.raycaster.intersectObjects(this.modelGroup,k))}modelToScreen(h){let x=!1;Array.isArray(h)||(h=[h],x=!0);let k=this.renderer.getXRatio(),M=this.renderer.getYRatio(),D=this.col,P=this.row,F=D*(this.WIDTH/k),X=(M-P-1)*(this.HEIGHT/M),B=[],L=this.canvasOffset();return h.forEach(H=>{let U=new c.Vector3(H.x,H.y,H.z);U.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector(U,this.camera);let Y=this.WIDTH/k*(U.x+1)/2+L.left+F,W=-(this.HEIGHT/M)*(U.y-1)/2+L.top+X;B.push({x:Y,y:W})}),x&&(B=B[0]),B}screenOffsetToModel(h,x,k){var M=h/this.WIDTH,D=x/this.HEIGHT,P=k===void 0?this.rotationGroup.position.z:k,F=this.rotationGroup.quaternion,X=new c.Vector3(0,0,P);return this.projector.projectVector(X,this.camera),X.x+=M*2,X.y-=D*2,this.projector.unprojectVector(X,this.camera),X.z=0,X.applyQuaternion(F),X}screenToModelDistance(h,x){let k=this.canvasOffset(),M=new c.Vector3(x.x,x.y,x.z);M.applyMatrix4(this.modelGroup.matrixWorld);let D=M.clone();this.projector.projectVector(M,this.camera);let P=new c.Vector3((h.x-k.left)*2/this.WIDTH-1,(h.y-k.top)*2/-this.HEIGHT+1,M.z);return this.projector.unprojectVector(P,this.camera),P.distanceTo(D)}setViewChangeCallback(h){(typeof h=="function"||h==null)&&(this.viewChangeCallback=h)}setStateChangeCallback(h){(typeof h=="function"||h==null)&&(this.stateChangeCallback=h)}getConfig(){return this.config}setConfig(h){this.config=h,h.ambientOcclusion&&this.renderer.enableAmbientOcclusion(h.ambientOcclusion)}getInternalState(){var h={models:[],surfaces:[],shapes:[],labels:[]};for(let x=0;x<this.models.length;x++)this.models[x]&&(h.models[x]=this.models[x].getInternalState());return h}setInternalState(h){this.clear();var x=h.models;for(let k=0;k<x.length;k++)x[k]&&(this.models[k]=new g.GLModel(k),this.models[k].setInternalState(x[k]));this.render()}setZoomLimits(h,x){typeof h<"u"&&(this.config.lowerZoomLimit=h),x&&(this.config.upperZoomLimit=x),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(h){h.fov!==void 0&&(this.fov=h.fov,this.camera.fov=this.fov),h.z!==void 0&&(this.CAMERA_Z=h.z,this.camera.z=this.CAMERA_Z),h.orthographic!==void 0&&(this.camera.ortho=h.orthographic)}_handleMouseDown(h){if(h.preventDefault(),!this.scene)return;var x=this.getX(h),k=this.getY(h);if(x===void 0)return;this.isDragging=!0,this.mouseButton=h.which,this.mouseStartX=x,this.mouseStartY=k,this.touchHold=!0,this.touchDistanceStart=0,h.targetTouches&&h.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(h)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let M=this;h.targetTouches&&h.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(M.touchHold==!0){M.glDOM=M.renderer.domElement;const D=h.targetTouches[0],P=new PointerEvent("contextmenu",Object.assign(Object.assign({},h),{pageX:D.pageX,pageY:D.pageY,screenX:D.screenX,screenY:D.screenY,clientX:D.clientX,clientY:D.clientY}));M.glDOM.dispatchEvent(P)}},this.longTouchDuration))}_handleMouseUp(h){if(this.touchHold=!1,this.isDragging&&this.scene){var x=this.getX(h),k=this.getY(h);if(this.closeEnoughForClick(h)&&this.isInViewer(x,k)){let M=this.mouseXY(x,k);this.handleClickSelection(M.x,M.y,h)}}this.isDragging=!1}_handleMouseScroll(h){if(h.preventDefault(),!!this.scene){var x=this.getX(h),k=this.getY(h);if(x!==void 0&&!(!this.control_all&&!this.isInViewer(x,k))){var M=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,D=1;if(h.ctrlKey&&(D=-1),h.detail)this.rotationGroup.position.z+=D*M*h.detail/10;else if(h.wheelDelta){let P=h.wheelDelta*600/(h.wheelDelta+600);this.rotationGroup.position.z-=D*M*P/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(h){let x=this;return h=h||1,new Promise(function(k){let M=0,D=x.viewChangeCallback,P=[],F=[],X=Date.now();x.viewChangeCallback=function(){F.push(Date.now()-X),X=Date.now(),P.push(new Promise(B=>{x.getCanvas().toBlob(function(L){L.arrayBuffer().then(B)},"image/png")})),M+=1,M==h&&(x.viewChangeCallback=D,Promise.all(P).then(B=>{let L=[];for(let G=0;G<B.length;G++){let $=(0,z.decode)(B[G]);L.push((0,z.toRGBA8)($)[0])}let H=x.getCanvas().width,U=x.getCanvas().height,Y=(0,z.encode)(L,H,U,0,F),W=new Blob([Y],{type:"image/png"}),q=new FileReader;q.onload=function(G){k(G.target.result)},q.readAsDataURL(W)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(h){this.hoverDuration=h}mouseXY(h,x){let k=this.canvasOffset(),M=this.renderer.getXRatio(),D=this.renderer.getYRatio(),P=this.col,F=this.row,X=P*(this.WIDTH/M),B=(D-F-1)*(this.HEIGHT/D),L=(h-k.left-X)/(this.WIDTH/M)*2-1,H=-((x-k.top-B)/(this.HEIGHT/D))*2+1;return{x:L,y:H}}_handleMouseMove(h){clearTimeout(this.hoverTimeout),h.preventDefault();let x=this.getX(h),k=this.getY(h);if(x===void 0)return;let M=this.renderer.getXRatio(),D=this.renderer.getYRatio(),P=this.mouseXY(x,k),F=this;this.current_hover!==null&&this.handleHoverContinue(P.x,P.y);var X=0;if(!(!this.control_all&&!this.isInViewer(x,k))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){F.handleHoverSelection(P.x,P.y,h)},this.hoverDuration)),!!this.isDragging)){h.targetTouches&&(h.targetTouches.length>1||h.targetTouches.length===1&&!this.closeEnoughForClick(h))&&clearTimeout(this.longTouchTimeout);var B=(x-this.mouseStartX)/this.WIDTH,L=(k-this.mouseStartY)/this.HEIGHT;if(this.touchDistanceStart!=0&&h.targetTouches&&h.targetTouches.length==2){var H=this.calcTouchDistance(h);X=2,L=(H-this.touchDistanceStart)*2/(this.WIDTH+this.HEIGHT)}else h.targetTouches&&h.targetTouches.length==3&&(X=1);B*=M,L*=D;var U=Math.hypot(B,L),Y;if(X==3||this.mouseButton==3&&h.ctrlKey)this.slabNear=this.cslabNear+B*100,this.slabFar=this.cslabFar-L*100;else if(X==2||this.mouseButton==3||h.shiftKey)Y=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,Y<80&&(Y=80),this.rotationGroup.position.z=this.cz+L*Y,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(X==1||this.mouseButton==2||h.ctrlKey){var W=this.screenOffsetToModel(M*(x-this.mouseStartX),D*(k-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,W)}else if((X===0||this.mouseButton==1)&&U!==0){var q=Math.sin(U*Math.PI)/U;this.dq.x=Math.cos(U*Math.PI),this.dq.y=0,this.dq.z=q*B,this.dq.w=-q*L,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(h){if(h.preventDefault(),this.closeEnoughForClick(h)){var M=this.mouseStartX,D=this.mouseStartY,k=this.canvasOffset();let P=this.mouseXY(M,D),F=P.x,X=P.y,B=this.targetedObjects(F,X,this.contextMenuEnabledObjects);var x=null;B.length&&(x=B[0].clickable);var k=this.canvasOffset(),M=this.mouseStartX-k.left,D=this.mouseStartY-k.top;this.userContextMenuHandler&&(this.userContextMenuHandler(x,M,D,B,h),this.isDragging=!1)}}setContainer(h){let x=(0,y.getElement)(h)||this.container;return this.initContainer(x),this}setBackgroundColor(h,x){(typeof x>"u"||x<0||x>1)&&(x=1);var k=u.CC.color(h);return this.scene.fog.color=k,this.bgColor=k.getHex(),this.renderer.setClearColorHex(k.getHex(),x),this.show(),this}setProjection(h){this.camera.ortho=h==="orthographic",this.setSlabAndFog()}setViewStyle(h){if(h=h||{},h.style=h.style||"",h.style.includes("outline")){var x={};h.color&&(x.color=u.CC.color(h.color)),h.width&&(x.width=h.width),this.renderer.enableOutline(x)}else this.renderer.disableOutline();if(h.style.includes("ambientOcclusion")){var x={};h.strength&&(x.strength=h.strength),h.radius&&(x.radius=h.radius),this.renderer.enableAmbientOcclusion(x)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(h){return this.WIDTH=h||this.WIDTH,this.updateSize(),this}setHeight(h){return this.HEIGHT=h||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let h=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let x=!1,k=this.container.querySelector("canvas");k&&k!=this.renderer.getCanvas()?this.config.canvas=k:(k.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,x=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),h=!0,x&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),h){let x=this.renderer.supportedExtensions();if(x.regen=!0,this.viewers)for(let k=0,M=this.viewers.length;k<M;k++)for(let D=0,P=this.viewers[k].length;D<P;D++)this.viewers[k][D].render(null,x);this._viewer.render(null,x)}else this.show();return this}getModel(h){return h===void 0?this.models.length==0?null:this.models[this.models.length-1]:h instanceof g.GLModel?h:h in this.models?this.models[h]:this.models.length==0?null:this.models[this.models.length-1]}spin(h,x=1){if(clearInterval(this.spinInterval),typeof h>"u"&&(h="y"),typeof h=="boolean")if(h)h="y";else return;Array.isArray(h)&&(h={x:h[0],y:h[1],z:h[2]});var k=this;this.spinInterval=setInterval(function(){!k.getCanvas().isConnected&&k.renderer.isLost()&&clearInterval(k.spinInterval),k.rotate(1*x,h)},25)}animateMotion(h,x,k,M,D,P){var F=20,X=Math.ceil(h/F);X<1&&(X=1),this.incAnim();var B={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(x){let U=new Array(X);for(let G=0;G<X;G++){let $=(G+1)/X,Z={mpos:B.mpos,rz:B.rz,rot:B.rot};Z.mpos=k.clone().sub(B.mpos).multiplyScalar($).add(B.mpos),Z.rz=B.rz+$*(M-B.rz),Z.rot=s.slerp(B.rot,D,$),Z.cam=P.clone().sub(B.cam).multiplyScalar($).add(B.cam),U[G]=Z}let Y=0,W=this,q=function(){var G=U[Y];Y+=1,W.modelGroup.position=G.mpos,W.rotationGroup.position.z=G.rz,W.rotationGroup.quaternion=G.rot,W.camera.lookAt(G.cam),Y<U.length?setTimeout(q,F):W.decAnim(),W.show()};setTimeout(q,F)}else{var L={};let U=1/X;if(k&&(L.mpos=k.clone().sub(B.mpos).multiplyScalar(U)),typeof M<"u"&&M!=null&&(L.rz=U*(M-B.rz)),D){var H=s.slerp(B.rot,D,U);L.rot=B.rot.clone().inverse().multiply(H)}P&&(L.cam=P.clone().sub(B.cam).multiplyScalar(U));let Y=0,W=this,q=function(){Y+=1,L.mpos&&W.modelGroup.position.add(L.mpos),L.rz&&(W.rotationGroup.position.z+=L.rz),L.rot&&W.rotationGroup.quaternion.multiply(L.rot),L.cam&&(W.lookingAt.add(L.cam),W.camera.lookAt(W.lookingAt)),Y<X?setTimeout(q,F):W.decAnim(),W.show()};setTimeout(q,F)}}rotate(h,x="y",k=0,M=!1){if(x=="x"?x={x:1,y:0,z:0}:x=="y"?x={x:0,y:1,z:0}:x=="z"&&(x={x:0,y:0,z:1}),x=="vx"?x={vx:1,vy:0,vz:0}:x=="vy"?x={vx:0,vy:1,vz:0}:x=="vz"&&(x={vx:0,vy:0,vz:1}),typeof x.vx<"u"){var D=new c.Vector3(x.vx,x.vy,x.vz);D.applyQuaternion(this.rotationGroup.quaternion),x={x:D.x,y:D.y,z:D.z}}var P=function(L){var H=Math.sin(L/2),U=Math.cos(L/2),Y=0,W=0,q=0;return Y=x.x*H,W=x.y*H,q=x.z*H,new c.Quaternion(Y,W,q,U).normalize()},F=Math.PI*h/180,X=P(F);if(k){var B=new c.Quaternion().copy(this.rotationGroup.quaternion).multiply(X);this.animateMotion(k,M,this.modelGroup.position,this.rotationGroup.position.z,B,this.lookingAt)}else this.rotationGroup.quaternion.multiply(X),this.show();return this}surfacesFinished(){for(var h in this.surfaces)if(!this.surfaces[h][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var h=this.modelGroup.position,x=this.rotationGroup.quaternion;return[h.x,h.y,h.z,this.rotationGroup.position.z,x.x,x.y,x.z,x.w]}setView(h,x){return h===void 0||!(h instanceof Array||h.length!==8)?this:!this.modelGroup||!this.rotationGroup?this:(this.modelGroup.position.x=h[0],this.modelGroup.position.y=h[1],this.modelGroup.position.z=h[2],this.rotationGroup.position.z=h[3],this.rotationGroup.quaternion.x=h[4],this.rotationGroup.quaternion.y=h[5],this.rotationGroup.quaternion.z=h[6],this.rotationGroup.quaternion.w=h[7],typeof h[8]<"u"&&(this.rotationGroup.position.x=h[8],this.rotationGroup.position.y=h[9]),this.show(x),this)}render(h,x){this.renderer.setViewport(),this.updateClickables();var k=this.getView();this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState());var M,D;for(x||(x=this.renderer.supportedExtensions()),M=0;M<this.models.length;M++)this.models[M]&&this.models[M].globj(this.modelGroup,x);for(M=0;M<this.shapes.length;M++)this.shapes[M]&&(typeof this.shapes[M].frame>"u"||this.viewer_frame<0||this.shapes[M].frame<0||this.shapes[M].frame==this.viewer_frame?this.shapes[M].globj(this.modelGroup,x):this.shapes[M].removegl(this.modelGroup));for(M=0;M<this.labels.length;M++)x.regen&&(this.labels[M].dispose(),this.modelGroup.remove(this.labels[M].sprite),this.labels[M].setContext(),this.modelGroup.add(this.labels[M].sprite)),this.labels[M]&&typeof this.labels[M].frame<"u"&&this.labels[M].frame>=0&&(this.modelGroup.remove(this.labels[M].sprite),(this.viewer_frame<0||this.labels[M].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[M].sprite));for(M in this.surfaces)if(this.surfaces.hasOwnProperty(M)){var P=this.surfaces[M];for(D=0;D<P.length;D++)if(P.hasOwnProperty(D)){var F=P[D].geo;if(!P[D].finished||x.regen){F.verticesNeedUpdate=!0,F.elementsNeedUpdate=!0,F.normalsNeedUpdate=!0,F.colorsNeedUpdate=!0,F.buffersNeedUpdate=!0,F.boundingSphere=null,P[D].mat.needsUpdate=!0,P[D].done&&(P[D].finished=!0),P[D].lastGL&&this.modelGroup.remove(P[D].lastGL);var X=null;if(P[D].mat instanceof o.LineBasicMaterial?X=new o.Line(F,P[D].mat):X=new o.Mesh(F,P[D].mat),P[D].mat.transparent&&P[D].mat.opacity==0?X.visible=!1:X.visible=!0,P[D].symmetries.length>1||P[D].symmetries.length==1&&!P[D].symmetries[D].isIdentity()){var B,L=new o.Object3D;for(B=0;B<P[D].symmetries.length;B++){var H=X.clone();H.matrix=P[D].symmetries[B],H.matrixAutoUpdate=!1,L.add(H)}P[D].lastGL=L,this.modelGroup.add(L)}else P[D].lastGL=X,this.modelGroup.add(X)}}}return this.setView(k),typeof h=="function"&&h(this),this}getModelList(h){let x=[];if(typeof h>"u"||typeof h.model>"u")for(let M=0;M<this.models.length;M++)this.models[M]&&x.push(this.models[M]);else{let M=h.model;Array.isArray(M)||(M=[M]);for(let D=0;D<M.length;D++)if(typeof M[D]=="number"){var k=M[D];k<0&&(k+=this.models.length),x.push(this.models[k])}else x.push(M[D])}return x}getAtomsFromSel(h){var x=[];typeof h>"u"&&(h={});var k=this.getModelList(h);for(let M=0;M<k.length;M++)x=x.concat(k[M].selectedAtoms(h));return x}atomIsSelected(h,x){typeof x>"u"&&(x={});for(var k=this.getModelList(x),M=0;M<k.length;M++)if(k[M].atomIsSelected(h,x))return!0;return!1}selectedAtoms(h){return this.getAtomsFromSel(h)}getUniqueValues(h,x){typeof x>"u"&&(x={});var k=this.getAtomsFromSel(x),M={};for(var D in k)if(k[D].hasOwnProperty(h)){var P=k[D][h];M[P]=!0}return Object.keys(M)}pdbData(h){for(var x=this.getAtomsFromSel(h),k="",M=0,D=x.length;M<D;++M)k+=x[M].pdbline+`
`;return k}zoom(h=2,x=0,k=!1){var M=(this.CAMERA_Z-this.rotationGroup.position.z)/h,D=this.CAMERA_Z-M;return x>0?this.animateMotion(x,k,this.modelGroup.position,this.adjustZoomToLimits(D),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(D),this.show()),this}translate(h,x,k=0,M=!1){var D=h/this.WIDTH,P=x/this.HEIGHT,F=new c.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(F,this.camera),F.x-=D,F.y-=P,this.projector.unprojectVector(F,this.camera),F.z=0;var X=this.lookingAt.clone().add(F);return k>0?this.animateMotion(k,M,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,X):(this.lookingAt=X,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(h,x,k=0,M=!1){var D=this.screenOffsetToModel(h,x),P=this.modelGroup.position.clone().add(D);return k>0?this.animateMotion(k,M,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=P,this.show()),this}fitSlab(h){h=h||{};var x=this.getAtomsFromSel(h),k=(0,y.getExtent)(x),M=k[1][0]-k[0][0],D=k[1][1]-k[0][1],P=k[1][2]-k[0][2],F=Math.hypot(M,D,P);return F<5&&(F=5),this.slabNear=-F/1.9,this.slabFar=F/2,this}center(h={},x=0,k=!1){var M,D,P=this.getAtomsFromSel(h),F=(0,y.getExtent)(P);(0,y.isEmptyObject)(h)?(this.shapes.forEach($=>{if($&&$.boundingSphere&&$.boundingSphere.center){var Z=$.boundingSphere.center,xe=$.boundingSphere.radius;xe>0?(P.push(new c.Vector3(Z.x+xe,Z.y,Z.z)),P.push(new c.Vector3(Z.x-xe,Z.y,Z.z)),P.push(new c.Vector3(Z.x,Z.y+xe,Z.z)),P.push(new c.Vector3(Z.x,Z.y-xe,Z.z)),P.push(new c.Vector3(Z.x,Z.y,Z.z+xe)),P.push(new c.Vector3(Z.x,Z.y,Z.z-xe))):P.push(Z)}}),F=(0,y.getExtent)(P),M=P,D=F):(M=this.getAtomsFromSel({}),D=(0,y.getExtent)(M));var X=new c.Vector3(F[2][0],F[2][1],F[2][2]),B=D[1][0]-D[0][0],L=D[1][1]-D[0][1],H=D[1][2]-D[0][2],U=Math.hypot(B,L,H);U<5&&(U=5),this.slabNear=-U/1.9,this.slabFar=U/2,B=F[1][0]-F[0][0],L=F[1][1]-F[0][1],H=F[1][2]-F[0][2],U=Math.hypot(B,L,H),U<5&&(U=5);for(var Y=25,W=0;W<P.length;W++)if(P[W]){var q=X.distanceToSquared(P[W]);q>Y&&(Y=q)}U=Math.sqrt(Y)*2;var G=X.clone().multiplyScalar(-1);return x>0?this.animateMotion(x,k,G,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=G,this.show()),this}zoomTo(h={},x=0,k=!1){let M=this.getAtomsFromSel(h),D=(0,y.getExtent)(M),P=D;if((0,y.isEmptyObject)(h)){let Z=M&&M.length;if(this.shapes.forEach(xe=>{if(xe&&xe.boundingSphere){if(xe.boundingSphere.box){let Pe=xe.boundingSphere.box;M.push(new c.Vector3(Pe.min.x,Pe.min.y,Pe.min.z)),M.push(new c.Vector3(Pe.max.x,Pe.max.y,Pe.max.z))}else if(xe.boundingSphere.center){var ce=xe.boundingSphere.center,Ne=xe.boundingSphere.radius;Ne>0?(M.push(new c.Vector3(ce.x+Ne,ce.y,ce.z)),M.push(new c.Vector3(ce.x-Ne,ce.y,ce.z)),M.push(new c.Vector3(ce.x,ce.y+Ne,ce.z)),M.push(new c.Vector3(ce.x,ce.y-Ne,ce.z)),M.push(new c.Vector3(ce.x,ce.y,ce.z+Ne)),M.push(new c.Vector3(ce.x,ce.y,ce.z-Ne))):M.push(ce)}}}),P=(0,y.getExtent)(M),!Z)for(let xe=0;xe<3;xe++)D[2][xe]=(P[0][xe]+P[1][xe])/2}else{let Z=this.getAtomsFromSel({});P=(0,y.getExtent)(Z)}var F=new c.Vector3(D[2][0],D[2][1],D[2][2]),X=P[1][0]-P[0][0],B=P[1][1]-P[0][1],L=P[1][2]-P[0][2],H=Math.hypot(X,B,L);H<5&&(H=5),this.slabNear=-H/1.9,this.slabFar=H/2,Object.keys(h).length===0&&(this.slabNear=Math.min(-H*2,-50),this.slabFar=Math.max(H*2,50));var U=this.config.minimumZoomToDistance||5;X=D[1][0]-D[0][0],B=D[1][1]-D[0][1],L=D[1][2]-D[0][2],H=Math.hypot(X,B,L),H<U&&(H=U);for(var Y=U*U,W=0;W<M.length;W++)if(M[W]){var q=F.distanceToSquared(M[W]);q>Y&&(Y=q)}H=Math.sqrt(Y)*2;var G=F.clone().multiplyScalar(-1),$=-(H*.5/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return $=this.adjustZoomToLimits($),x>0?this.animateMotion(x,k,G,$,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=G,this.rotationGroup.position.z=$,this.show()),this}setSlab(h,x){this.slabNear=h,this.slabFar=x}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(h,x={},k,M=!1){if(k){var D=(0,y.getExtent)(this.getAtomsFromSel(k));x.position={x:D[2][0],y:D[2][1],z:D[2][2]}}var P=new _.Label(h,x);return P.setContext(),this.modelGroup.add(P.sprite),this.labels.push(P),M||this.show(),P}addResLabels(h,x,k=!1){let M=this.labels.length;return this.applyToModels("addResLabels",h,this,x,k),this.show(),this.labels.slice(M)}addPropertyLabels(h,x,k){return this.applyToModels("addPropertyLabels",h,x,this,k),this.show(),this}removeLabel(h){for(var x=0;x<this.labels.length;x++)if(this.labels[x]==h){this.labels.splice(x,1),h.dispose(),this.modelGroup.remove(h.sprite);break}return this.show(),this}removeAllLabels(){for(var h=0;h<this.labels.length;h++)this.labels[h]&&this.labels[h].sprite&&this.modelGroup.remove(this.labels[h].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}setLabelStyle(h,x){return this.modelGroup.remove(h.sprite),h.dispose(),h.stylespec=x,h.setContext(),this.modelGroup.add(h.sprite),this.show(),h}setLabelText(h,x){return this.modelGroup.remove(h.sprite),h.dispose(),h.text=x,h.setContext(),this.modelGroup.add(h.sprite),this.show(),h}addShape(h){h=h||{};var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,this.shapes.push(x),x}removeShape(h){if(!h)return this;for(h.removegl(this.modelGroup),delete this.shapes[h.shapePosition];this.shapes.length>0&&typeof this.shapes[this.shapes.length-1]>"u";)this.shapes.pop();return this}removeAllShapes(){for(var h=0;h<this.shapes.length;h++){var x=this.shapes[h];x&&x.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(h){if(h.hasOwnProperty("x")&&h.hasOwnProperty("y")&&h.hasOwnProperty("z"))return h;var x=this.getAtomsFromSel(h);if(x.length==0)return{x:0,y:0,z:0};var k=(0,y.getExtent)(x);return{x:k[0][0]+(k[1][0]-k[0][0])/2,y:k[0][1]+(k[1][1]-k[0][1])/2,z:k[0][2]+(k[1][2]-k[0][2])/2}}addSphere(h){h=h||{},h.center=this.getSelectionCenter(h.center);var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,x.addSphere(h),this.shapes.push(x),x.finalize(),x}addBox(h={}){h.corner!=null&&(h.corner=this.getSelectionCenter(h.corner)),h.center!=null&&(h.center=this.getSelectionCenter(h.center));var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,x.addBox(h),this.shapes.push(x),x.finalize(),x}addArrow(h={}){h.start=this.getSelectionCenter(h.start),h.end=this.getSelectionCenter(h.end);var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,x.addArrow(h),this.shapes.push(x),x.finalize(),x}addCylinder(h={}){h.start=this.getSelectionCenter(h.start),h.end=this.getSelectionCenter(h.end);var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,h.dashed?x.addDashedCylinder(h):x.addCylinder(h),this.shapes.push(x),x.finalize(),x}addCurve(h={}){var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,x.addCurve(h),this.shapes.push(x),x.finalize(),x}addLine(h={}){h.start=this.getSelectionCenter(h.start),h.end=this.getSelectionCenter(h.end),h.wireframe=!0;var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,h.dashed?x=this.addLineDashed(h,x):x.addLine(h),this.shapes.push(x),x.finalize(),x}addUnitCell(h,x){h=this.getModel(h),x=x||{alabel:"a",blabel:"b",clabel:"c"},x.box=x.box||{},x.astyle=x.astyle||{color:"red",radius:.1,midpos:-1},x.bstyle=x.bstyle||{color:"green",radius:.1,midpos:-1},x.cstyle=x.cstyle||{color:"blue",radius:.1,midpos:-1},x.alabelstyle=x.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},x.blabelstyle=x.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},x.clabelstyle=x.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},h.unitCellObjects&&this.removeUnitCell(h),h.unitCellObjects={shapes:[],labels:[]};var k=h.getCrystData(),M=null;if(k){if(k.matrix)M=k.matrix;else{var D=k.a,P=k.b,F=k.c,X=k.alpha,B=k.beta,L=k.gamma;X=X*Math.PI/180,B=B*Math.PI/180,L=L*Math.PI/180;var H,U,Y;H=Math.cos(B),U=(Math.cos(X)-Math.cos(B)*Math.cos(L))/Math.sin(L),Y=Math.sqrt(Math.max(0,1-H*H-U*U)),M=new c.Matrix3(D,P*Math.cos(L),F*H,0,P*Math.sin(L),F*U,0,0,F*Y)}var W=[new c.Vector3(0,0,0),new c.Vector3(1,0,0),new c.Vector3(0,1,0),new c.Vector3(0,0,1),new c.Vector3(1,1,0),new c.Vector3(0,1,1),new c.Vector3(1,0,1),new c.Vector3(1,1,1)];if(k.matrix4)for(let G=0;G<W.length;G++)k.size&&W[G].multiplyVectors(W[G],k.size),W[G]=W[G].applyMatrix4(k.matrix4);else for(let G=0;G<W.length;G++)W[G]=W[G].applyMatrix3(M);if(x.box&&!x.box.hidden){x.box.wireframe=!0;var q=new p.GLShape(x.box);q.shapePosition=this.shapes.length,q.addLine({start:W[0],end:W[1]}),q.addLine({start:W[0],end:W[2]}),q.addLine({start:W[1],end:W[4]}),q.addLine({start:W[2],end:W[4]}),q.addLine({start:W[0],end:W[3]}),q.addLine({start:W[3],end:W[5]}),q.addLine({start:W[2],end:W[5]}),q.addLine({start:W[1],end:W[6]}),q.addLine({start:W[4],end:W[7]}),q.addLine({start:W[6],end:W[7]}),q.addLine({start:W[3],end:W[6]}),q.addLine({start:W[5],end:W[7]}),this.shapes.push(q),h.unitCellObjects.shapes.push(q),q.finalize()}if(!x.astyle.hidden){x.astyle.start=W[0],x.astyle.end=W[1];let G=this.addArrow(x.astyle);h.unitCellObjects.shapes.push(G)}if(!x.bstyle.hidden){x.bstyle.start=W[0],x.bstyle.end=W[2];let G=this.addArrow(x.bstyle);h.unitCellObjects.shapes.push(G)}if(!x.cstyle.hidden){x.cstyle.start=W[0],x.cstyle.end=W[3];let G=this.addArrow(x.cstyle);h.unitCellObjects.shapes.push(G)}if(x.alabel){x.alabelstyle.position=W[1];let G=this.addLabel(x.alabel,x.alabelstyle);h.unitCellObjects.labels.push(G)}if(x.blabel){x.blabelstyle.position=W[2];let G=this.addLabel(x.blabel,x.blabelstyle);h.unitCellObjects.labels.push(G)}if(x.clabel){x.clabelstyle.position=W[3];let G=this.addLabel(x.clabel,x.clabelstyle);h.unitCellObjects.labels.push(G)}}}removeUnitCell(h){if(h=this.getModel(h),h.unitCellObjects){let x=this;h.unitCellObjects.shapes.forEach(function(k){x.removeShape(k)}),h.unitCellObjects.labels.forEach(function(k){x.removeLabel(k)})}delete h.unitCellObjects}replicateUnitCell(h=3,x=h,k=x,M,D,P){M=this.getModel(M);let F=M.getCrystData();if(F){const X=M.selectedAtoms({}),B=F.matrix;let L=function(U){return U%2==0?-U/2:Math.ceil(U/2)};h<=1&&x<=1&&k<=1&&(P=!0,h=x=k=3);let H=function(U,Y,W){return!1};if(P){const U=new c.Matrix3().getInverse3(B);H=function(Y,W,q){let G=new c.Vector3(Y,W,q).applyMatrix3(U);return!(G.x>-1e-4&&G.x<1.0001&&G.y>-1e-4&&G.y<1.0001&&G.z>-1e-4&&G.z<1.0001)}}for(let U=0;U<h;U++)for(let Y=0;Y<x;Y++)for(let W=0;W<k;W++){if(U==0&&Y==0&&W==0)continue;let q=new c.Vector3(L(U),L(Y),L(W));q.applyMatrix3(B);let G=[];for(let $=0;$<X.length;$++){let Z=X[$].x+q.x,xe=X[$].y+q.y,ce=X[$].z+q.z;if(H(Z,xe,ce))continue;let Ne={};for(let Pe in X[$])Ne[Pe]=X[$][Pe];Ne.x=Z,Ne.y=xe,Ne.z=ce,G.push(Ne)}M.addAtoms(G)}D&&M.assignBonds()}}addLineDashed(h,x){h.dashLength=h.dashLength||.5,h.gapLength=h.gapLength||.5;var k;h.start?k=new c.Vector3(h.start.x||0,h.start.y||0,h.start.z||0):k=new c.Vector3(0,0,0);var M;h.end?M=new c.Vector3(h.end.x,h.end.y||0,h.end.z||0):M=new c.Vector3(0,0,0);var D=new c.Vector3,P=new c.Vector3,F=new c.Vector3,X,B,L,H=k.clone(),U=0;for(D.subVectors(M,k),X=D.length(),D.normalize(),P=D.clone(),F=D.clone(),P.multiplyScalar(h.dashLength),F.multiplyScalar(h.gapLength),B=P.length(),L=F.length();U<X;){if(U+B>X){h.start=k,h.end=M,x.addLine(h);break}H.addVectors(k,P),h.start=k,h.end=H,x.addLine(h),k=H.clone(),U+=B,H.addVectors(k,F),k=H.clone(),U+=L}return x.finalize(),x}addCustom(h){h=h||{};var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,x.addCustom(h),this.shapes.push(x),x.finalize(),x}addVolumetricData(h,x,k={}){var M=new S.VolumeData(h,x);return k.hasOwnProperty("transferfn")?this.addVolumetricRender(M,k):this.addIsosurface(M,k)}addIsosurface(h,x={},k){var M=new p.GLShape(x);return M.shapePosition=this.shapes.length,M.addIsosurface(h,x,k,this),this.shapes.push(M),M}addVolumetricRender(h,x){x=x||{};var k=new R.GLVolumetricRender(h,x,this);return k.shapePosition=this.shapes.length,this.shapes.push(k),k}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(h){h?this.scene.fog=new o.Fog(this.bgColor,100,200):(this.config.disableFog=!0,this.show())}setFrame(h){this.viewer_frame=h;let x=this;return new Promise(function(k){var M=x.models.map(function(D){return D.setFrame(h,x)});Promise.all(M).then(function(){k()})})}getFrame(){return this.viewer_frame}getNumFrames(){var h=0;for(let x=0;x<this.models.length;x++)this.models[x].getNumFrames()>h&&(h=this.models[x].getNumFrames());for(let x=0;x<this.shapes.length;x++)this.shapes[x].frame&&this.shapes[x].frame>=h&&(h=this.shapes[x].frame+1);for(let x=0;x<this.labels.length;x++)this.labels[x].frame&&this.labels[x].frame>=h&&(h=this.labels[x].frame+1);return h}animate(h){this.incAnim();var x=100,k="forward",M=1/0;h=h||{},h.interval&&(x=h.interval),h.loop&&(k=h.loop),h.reps&&(M=h.reps);var D=this.getNumFrames(),P=this,F=0;h.startFrame&&(F=h.startFrame%D);var X=1;h.step&&(X=h.step,M/=X);var B=0,L=D*M,H=new Date,U,Y,W=function(q){H=new Date,q=="forward"?P.setFrame(F).then(function(){F=(F+X)%D,U()}):q=="backward"?P.setFrame(D-1-F).then(function(){F=(F+X)%D,U()}):P.setFrame(F).then(function(){F+=X,X*=F%(D-1)==0?-1:1,U()})};return U=function(){if(P.render(),!P.getCanvas().isConnected)P.stopAnimate();else if(++B>=L||!P.isAnimated())Y.cancel(),P.animationTimers.delete(Y),P.decAnim();else{var q=x-(new Date().getTime()-H.getTime());q=q>0?q:0,P.animationTimers.delete(Y),Y=new y.PausableTimer(W,q,k),P.animationTimers.add(Y)}},Y=new y.PausableTimer(W,0,k),this.animationTimers.add(Y),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(h){h.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(h){h.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(h){h.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(h){return h&&!h.defaultcolors?(h.defaultcolors=this.defaultcolors,h.cartoonQuality=h.cartoonQuality||this.config.cartoonQuality):typeof h>"u"&&(h={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),h}addModel(h,x="",k){k=this.getModelOpt(k);var M=new g.GLModel(this.models.length,k);return M.addMolData(h,x,k),this.models.push(M),M}addModels(h,x,k){k=this.getModelOpt(k),k.multimodel=!0,k.frames=!0;for(var M=g.GLModel.parseMolData(h,x,k),D=0;D<M.length;D++){var P=new g.GLModel(this.models.length,k);P.setAtomDefaults(M[D]),P.addFrame(M[D]),P.setFrame(0),M.modelData&&P.setModelData(M.modelData[D]),P.setDontDuplicateAtoms(!k.duplicateAssemblyAtoms),this.models.push(P)}return this.models}addModelsAsFrames(h,x,k){k=this.getModelOpt(k),k.multimodel=!0,k.frames=!0;var M=new g.GLModel(this.models.length,k);return M.addMolData(h,x,k),this.models.push(M),M}addAsOneMolecule(h,x,k){k=this.getModelOpt(k),k.multimodel=!0,k.onemol=!0;var M=new g.GLModel(this.models.length,k);return M.addMolData(h,x,k),this.models.push(M),M}removeModel(h){if(h=this.getModel(h),!!h){for(h.removegl(this.modelGroup),delete this.models[h.getID()];this.models.length>0&&typeof this.models[this.models.length-1]>"u";)this.models.pop();return this}}removeAllModels(){for(var h=0;h<this.models.length;h++){var x=this.models[h];x&&x.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(h,x){var k={};return x===void 0?k.m=this.models.map(function(M){return M.toCDObject(h)}):k.m=[this.models[x].toCDObject()],JSON.stringify(k)}exportVRML(){var h=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new o.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var x=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=h,x}createModelFrom(h,x=!1){for(var k=new g.GLModel(this.models.length,this.defaultcolors),M=0;M<this.models.length;M++)if(this.models[M]){var D=this.models[M].selectedAtoms(h);k.addAtoms(D),x&&this.models[M].removeAtoms(D)}return this.models.push(k),k}applyToModels(h,x,k,M,D,P,F){for(var X=this.getModelList(x),B=0;B<X.length;B++)X[B][h](x,k,M,D,P,F)}setStyle(h,x){return typeof x>"u"&&(x=h,h={}),this.applyToModels("setStyle",h,x,!1),this}addStyle(h,x){return typeof x>"u"&&(x=h,h={}),this.applyToModels("setStyle",h,x,!0),this}setClickable(h,x,k){return this.applyToModels("setClickable",h,x,k),this}setHoverable(h,x,k,M){return this.applyToModels("setHoverable",h,x,k,M),this}enableContextMenu(h,x){return this.applyToModels("enableContextMenu",h,x),this}vibrate(h,x,k,M){return this.applyToModels("vibrate",h,x,k,this,M),this}setColorByProperty(h,x,k,M){return this.applyToModels("setColorByProperty",h,x,k,M),this}setColorByElement(h,x){return this.applyToModels("setColorByElement",h,x),this}static getAtomsWithin(h,x){var k=[];for(let D=0;D<h.length;D++){var M=h[D];typeof M>"u"||M.x<x[0][0]||M.x>x[1][0]||M.y<x[0][1]||M.y>x[1][1]||M.z<x[0][2]||M.z>x[1][2]||k.push(M)}return k}static volume(h){var x=h[1][0]-h[0][0],k=h[1][1]-h[0][1],M=h[1][2]-h[0][2];return x*k*M}carveUpExtent(h,x,k){let M=[],D={};for(let H=0,U=x.length;H<U;H++)D[x[H].index]=H;let P=function(H){let U=[];for(let Y=0,W=H.length;Y<W;Y++)H[Y].index in D&&U.push(D[H[Y].index]);return U},F=function(H){let U=[];return U[0]=[H[0][0],H[0][1],H[0][2]],U[1]=[H[1][0],H[1][1],H[1][2]],U},X=function(H){if(s.volume(H)<s.maxVolume)return[H];var U=H[1][0]-H[0][0],Y=H[1][1]-H[0][1],W=H[1][2]-H[0][2],q;U>Y&&U>W?q=0:Y>U&&Y>W?q=1:q=2;var G=F(H),$=F(H),Z=(H[1][q]-H[0][q])/2+H[0][q];G[1][q]=Z,$[0][q]=Z;var xe=X(G),ce=X($);return xe.concat(ce)},B=X(h),L=6;for(let H=0,U=B.length;H<U;H++){let Y=F(B[H]);Y[0][0]-=L,Y[0][1]-=L,Y[0][2]-=L,Y[1][0]+=L,Y[1][1]+=L,Y[1][2]+=L;let W=s.getAtomsWithin(x,Y),q=s.getAtomsWithin(k,B[H]);M.push({extent:B[H],atoms:P(W),toshow:P(q)})}return M}static generateSurfaceMesh(h,x,k){var M=new o.Geometry(!0),D=M.updateGeoGroup(0),P=[];for(let Gt=0,mt=h.length;Gt<mt;Gt++){var F=h[Gt];F&&(typeof F.surfaceColor<"u"?P[Gt]=F.surfaceColor:F.color&&(P[Gt]=u.CC.color(F.color)))}var X=D.vertexArray,B=x.vertices;for(let Gt=0,mt=B.length;Gt<mt;Gt++){let je=D.vertices*3;X[je]=B[Gt].x,X[je+1]=B[Gt].y,X[je+2]=B[Gt].z,D.vertices++}var L=D.colorArray;if(k.voldata&&k.volscheme){var H=k.volscheme,U=k.voldata,Y=H.range()||[-1,1];for(let Gt=0,mt=B.length;Gt<mt;Gt++){let je=U.getVal(B[Gt].x,B[Gt].y,B[Gt].z),ht=u.CC.color(H.valueToHex(je,Y)),Kt=Gt*3;L[Kt]=ht.r,L[Kt+1]=ht.g,L[Kt+2]=ht.b}}else if(P.length>0)for(let Gt=0,mt=B.length;Gt<mt;Gt++){let je=B[Gt].atomid,ht=Gt*3;L[ht]=P[je].r,L[ht+1]=P[je].g,L[ht+2]=P[je].b}var W=x.faces;D.faceidx=W.length,M.initTypedArrays();var q=D.vertexArray,G=D.normalArray,$,Z,xe,ce;for(let Gt=0,mt=W.length;Gt<mt;Gt+=3){var Ne=W[Gt],Pe=W[Gt+1],De=W[Gt+2],Me=Ne*3,Be=Pe*3,ft=De*3;$=new c.Vector3(q[Me],q[Me+1],q[Me+2]),Z=new c.Vector3(q[Be],q[Be+1],q[Be+2]),xe=new c.Vector3(q[ft],q[ft+1],q[ft+2]),xe.subVectors(xe,Z),$.subVectors($,Z),xe.cross($),ce=xe,ce.normalize(),G[Me]+=ce.x,G[Be]+=ce.x,G[ft]+=ce.x,G[Me+1]+=ce.y,G[Be+1]+=ce.y,G[ft+1]+=ce.y,G[Me+2]+=ce.z,G[Be+2]+=ce.z,G[ft+2]+=ce.z}D.faceArray=new Uint16Array(W);var Ot=new o.Mesh(M,k);return Ot}static generateMeshSyncHelper(h,x,k,M,D,P){var F=new A.ProteinSurface;return F.initparm(x,h!==1,P),F.fillvoxels(D,k),F.buildboundary(),(h==A.SurfaceType.SES||h==A.SurfaceType.MS)&&(F.fastdistancemap(),F.boundingatom(!1),F.fillvoxelswaals(D,k)),F.marchingcube(h),F.getFacesAndVertices(M)}static getMatWithStyle(h){let x=null;h.onesided?x=new o.MeshLambertMaterial:x=new o.MeshDoubleLambertMaterial,x.vertexColors=o.Coloring.VertexColors;for(var k in h)k==="color"||k==="map"||h.hasOwnProperty(k)&&(x[k]=h[k]);return h.opacity!==void 0&&(h.opacity===1?x.transparent=!1:x.transparent=!0),x}addMesh(h){var x={geo:h.geometry,mat:h.material,done:!0,finished:!1},k=this.nextSurfID();return this.surfaces[k]=x,k}static shallowCopy(h){var x=[];let k=h.length;for(let M=0;M<k;M++)x[M]=(0,y.extend)({},h[M]);return x}addSurface(h,x={},k={},M,D,P){let F=this.nextSurfID(),X=null,B=this,L=A.SurfaceType.VDW;typeof h=="string"?s.surfaceTypeMap[h.toUpperCase()]!==void 0?L=s.surfaceTypeMap[h]:console.log("Surface type : "+h+" is not recognized"):typeof h=="number"&&(L=h);var H=null,U=null,Y=s.shallowCopy(this.getAtomsFromSel(k));M?H=s.shallowCopy(this.getAtomsFromSel(M)):H=Y,(0,y.adjustVolumeStyle)(x);var W=!1,q;for(q=0;q<this.models.length;q++)if(this.models[q]){var G=this.models[q].getSymmetries();if(G.length>1||G.length==1&&!G[0].isIdentity()){W=!0;break}}var $=function(De,Me,Be){D?U=s.shallowCopy(B.getAtomsFromSel(D)):U=Be;var ft,Ot=(0,y.getExtent)(Be,!0);if(x.map&&x.map.prop){var Gt=x.map.prop;let At=(0,f.getGradient)(x.map.scheme||x.map.gradient||new f.Gradient.RWB),Mt=At.range();Mt||(Mt=(0,y.getPropertyRange)(Be,Gt)),x.colorscheme={prop:Gt,gradient:At}}for(let At=0,Mt=Me.length;At<Mt;At++)ft=Me[At],ft.surfaceColor=(0,y.getColorFromStyle)(ft,x);var mt=s.volume(Ot),je=B.carveUpExtent(Ot,Me,Be);if(U&&U.length&&U.length>0){var ht=(0,y.getExtent)(U,!0),Kt=function(At,Mt){var Jr=function(ve,we){var it=ve.extent,rt=it[1][0]-it[0][0],Yt=it[1][1]-it[0][1],jt=it[1][2]-it[0][2],re=rt-we[2][0];re*=re;var tt=Yt-we[2][1];tt*=tt;var lt=jt-we[2][2];return lt*=lt,re+tt+lt},Yr=Jr(At,ht),ie=Jr(Mt,ht);return Yr-ie};je.sort(Kt)}var Jt=[];for(let At=0,Mt=Me.length;At<Mt;At++)ft=Me[At],Jt[At]={x:ft.x,y:ft.y,z:ft.z,serial:At,elem:ft.elem};var Wt=!!A.syncSurface;if(Wt){var Br=function(At){return new Promise(function(Mt){for(var Jr=s.generateMeshSyncHelper(L,je[At].extent,je[At].atoms,je[At].toshow,Jt,mt),Yr=(0,p.splitMesh)({vertexArr:Jr.vertices,faceArr:Jr.faces}),ie=0,ve=Yr.length;ie<ve;ie++){Jr={vertices:Yr[ie].vertexArr,faces:Yr[ie].faceArr};var we=s.generateSurfaceMesh(Me,Jr,X);(0,y.mergeGeos)(De.geo,we)}B.render(),Mt()})},zr=[];for(let At=0;At<je.length;At++)zr.push(Br(At));return Promise.all(zr).then(function(){return De.done=!0,Promise.resolve(F)})}else{var cr=[];L<0&&(L=0);for(let At=0,Mt=s.numWorkers;At<Mt;At++){var Nr=new Worker($3Dmol.SurfaceWorker);cr.push(Nr),Nr.postMessage({type:-1,atoms:Jt,volume:mt})}return new Promise(function(At,Mt){var Jr=0,Yr=function(){!cr||!cr.length||cr.forEach(function(it){it&&it.terminate&&it.terminate()})},ie=function(it){for(var rt=(0,p.splitMesh)({vertexArr:it.data.vertices,faceArr:it.data.faces}),Yt=0,jt=rt.length;Yt<jt;Yt++){var re={vertices:rt[Yt].vertexArr,faces:rt[Yt].faceArr},tt=s.generateSurfaceMesh(Me,re,X);(0,y.mergeGeos)(De.geo,tt)}B.render(),Jr++,Jr==je.length&&(De.done=!0,Yr(),At(F))},ve=function(it){Yr(),console.log(it.message+" ("+it.filename+":"+it.lineno+")"),Mt(it)};for(let it=0;it<je.length;it++){var we=cr[it%cr.length];we.onmessage=ie,we.onerror=ve,we.postMessage({type:L,expandedExtent:je[it].extent,extendedAtoms:je[it].atoms,atomsToShow:je[it].toshow})}})}};x=x||{},X=s.getMatWithStyle(x);var Z=[];Z.style=x,Z.atomsel=k,Z.allsel=M,Z.focus=D;var xe=null;if(W){var ce={},Ne={};for(q=0;q<this.models.length;q++)ce[q]=[],Ne[q]=[];for(q=0;q<H.length;q++)ce[H[q].model].push(H[q]);for(q=0;q<Y.length;q++)Ne[Y[q].model].push(Y[q]);var Pe=[];for(q=0;q<this.models.length;q++)Ne[q].length>0&&(Z.push({geo:new o.Geometry(!0),mat:X,done:!1,finished:!1,symmetries:this.models[q].getSymmetries()}),Pe.push($(Z[Z.length-1],ce[q],Ne[q])));xe=Promise.all(Pe)}else Z.push({geo:new o.Geometry(!0),mat:X,done:!1,finished:!1,symmetries:[new c.Matrix4]}),xe=$(Z[Z.length-1],H,Y);return this.surfaces[F]=Z,xe.surfid=F,P&&typeof P=="function"?(xe.then(function(De){P(De)}),F):xe}setSurfaceMaterialStyle(h,x){if((0,y.adjustVolumeStyle)(x),this.surfaces[h]){var k=this.surfaces[h];k.style=x;for(var M=0;M<k.length;M++){var D=k[M].mat=s.getMatWithStyle(x);if(k[M].mat.side=o.FrontSide,x.color){k[M].mat.color=x.color,k[M].geo.colorsNeedUpdate=!0;const P=u.CC.color(x.color);k[M].geo.setColors(function(){return P})}else if(D.voldata&&D.volscheme){const P=D.volscheme,F=D.voldata,X=u.CC,B=P.range()||[-1,1];k[M].geo.setColors(function(L,H,U){let Y=F.getVal(L,H,U);return X.color(P.valueToHex(Y,B))})}k[M].finished=!1}}return this}getSurface(h){return this.surfaces[h]}removeSurface(h){for(var x=this.surfaces[h],k=0;k<x.length;k++)x[k]&&x[k].lastGL&&(x[k].geo!==void 0&&x[k].geo.dispose(),x[k].mat!==void 0&&x[k].mat.dispose(),this.modelGroup.remove(x[k].lastGL));return delete this.surfaces[h],this.show(),this}removeAllSurfaces(){for(var h in this.surfaces)if(this.surfaces.hasOwnProperty(h)){for(var x=this.surfaces[h],k=0;k<x.length;k++)x[k]&&x[k].lastGL&&(x[k].geo!==void 0&&x[k].geo.dispose(),x[k].mat!==void 0&&x[k].mat.dispose(),this.modelGroup.remove(x[k].lastGL));delete this.surfaces[h]}return this.show(),this}jmolMoveTo(){var h=this.modelGroup.position,x="center { "+-h.x+" "+-h.y+" "+-h.z+" }; ",k=this.rotationGroup.quaternion;return x+="moveto .5 quaternion { "+k.x+" "+k.y+" "+k.z+" "+k.w+" };",x}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(h,x){x=x||{};var k=this.getAtomsFromSel(x);if(typeof h=="function")for(let P=0,F=k.length;P<F;P++){let X=k[P];h(X)}else for(let P=0,F=k.length;P<F;P++){var M=k[P];for(let X=0,B=h.length;X<B;X++){let L=h[X];if(L.props)for(var D in L.props)L.props.hasOwnProperty(D)&&this.atomIsSelected(M,L)&&(M.properties||(M.properties={}),M.properties[D]=L.props[D])}}return this}linkViewer(h){return this.linkedViewers.push(h),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(h){this.rotationGroup.position.z=this.CAMERA_Z-h}setAutoEyeSeparation(h,x){var k=this.getPerceivedDistance();return x||(x=5),h||this.camera.position.x>0?this.camera.position.x=k*Math.tan(Math.PI/180*x):this.camera.position.x=-k*Math.tan(Math.PI/180*x),this.camera.lookAt(new c.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(h){this.config.cartoonQuality=h}}s.numWorkers=4,s.maxVolume=64e3,s.surfaceTypeMap={VDW:A.SurfaceType.VDW,MS:A.SurfaceType.MS,SAS:A.SurfaceType.SAS,SES:A.SurfaceType.SES};function v(C,h){if(C=(0,y.getElement)(C),!!C){h=h||{};try{var x=new s(C,h);return x}catch(k){throw"error creating viewer: "+k}}}function w(C,h={},x={}){if(C=(0,y.getElement)(C),!!C){var k=[],M=document.createElement("canvas");x.rows=h.rows,x.cols=h.cols,x.control_all=h.control_all!=null?h.control_all:!1,C.appendChild(M);try{for(var D=0;D<h.rows;D++){for(var P=[],F=0;F<h.cols;F++){x.row=D,x.col=F,x.canvas=M,x.viewers=k,x.control_all=h.control_all;var X=v(C,(0,y.extend)({},x));P.push(X)}k.unshift(P)}}catch(B){throw"error creating viewer grid: "+B}return k}}function E(C){var h=this;if(C=(0,y.getElement)(C),!!C){var x=w(C,{rows:1,cols:2,control_all:!0});this.glviewer1=x[0][0],this.glviewer2=x[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var k=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(D){return typeof h.glviewer1[D]=="function"}),M=0;M<k.length;M++)this[k[M]]=(function(D){return function(){var P=this.glviewer1[D].apply(this.glviewer1,arguments),F=this.glviewer2[D].apply(this.glviewer2,arguments);return[P,F]}})(k[M]);this.setCoordinates=function(D,P,F){for(var X=0;X<D.length;X++)D[X].setCoordinates(P,F)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(D){this.glviewer1.render(),this.glviewer2.render(),D&&D(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}}),"./src/Gradient.ts":((e,r,t)=>{t.r(r),t.d(r,{CustomLinear:()=>p,Gradient:()=>A,GradientType:()=>c,ROYGB:()=>g,RWB:()=>f,Sinebow:()=>_,builtinGradients:()=>S,getGradient:()=>y,normalizeValue:()=>u});var o=t("./src/colors.ts");class c{}function u(R,z,l){return z>=R?(l<R&&(l=R),l>z&&(l=z),{lo:R,hi:z,val:l}):(l>R&&(l=R),l<z&&(l=z),l=R-l+z,{lo:z,hi:R,val:l})}function y(R){if(R instanceof c)return R;if(R.gradient!==void 0&&S[R.gradient]){let z=R.min===void 0?-1:R.min,l=R.max===void 0?1:R.max;return R.mid===void 0?R.colors===void 0?new S[R.gradient](z,l):new S[R.gradient](z,l,R.colors):new S[R.gradient](z,l,R.mid)}else if(typeof R.gradient=="string"&&R.gradient.startsWith("linear_")){let z=R.gradient.split("_");z.shift();let l=R.min===void 0?-1:R.min,s=R.max===void 0?1:R.max;return new p(l,s,z)}return R}class f extends c{constructor(z,l,s){super(),this.gradient="RWB",this.mult=1,this.mid=s,this.min=z,this.max=l,typeof l>"u"&&Array.isArray(z)&&z.length>=2?(this.max=z[1],this.min=z[0]):z&&l&&!Array.isArray(z)&&(this.min=z,this.max=l)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(z,l){var s,v;if(z=this.mult*z,l?(s=l[0],v=l[1]):(s=this.min,v=this.max),z===void 0)return 16777215;var w=u(s,v,z);s=w.lo,v=w.hi,z=w.val;var E=(v+s)/2;l&&typeof l[2]<"u"?E=l[2]:typeof this.mid<"u"?E=this.mid:E=(s+v)/2;var C,h;return z<E?(C=Math.floor(255*Math.sqrt((z-s)/(E-s))),h=16711680+256*C+C,h):z>E?(C=Math.floor(255*Math.sqrt(1-(z-E)/(v-E))),h=65536*C+256*C+255,h):16777215}}class g extends c{constructor(z,l){super(),this.gradient="ROYGB",this.mult=1,this.min=z,this.max=l,typeof l>"u"&&Array.isArray(z)&&z.length>=2?(this.max=z[1],this.min=z[0]):z&&l&&!Array.isArray(z)&&(this.min=z,this.max=l)}valueToHex(z,l){var s,v;if(z=this.mult*z,l?(s=l[0],v=l[1]):(s=this.min,v=this.max),typeof z>"u")return 16777215;var w=u(s,v,z);s=w.lo,v=w.hi,z=w.val;var E=(s+v)/2,C=(s+E)/2,h=(E+v)/2,x,k;return z<C?(x=Math.floor(255*Math.sqrt((z-s)/(C-s))),k=16711680+256*x+0,k):z<E?(x=Math.floor(255*Math.sqrt(1-(z-C)/(E-C))),k=65536*x+65280+0,k):z<h?(x=Math.floor(255*Math.sqrt((z-E)/(h-E))),k=65280+1*x,k):(x=Math.floor(255*Math.sqrt(1-(z-h)/(v-h))),k=0+256*x+255,k)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class _ extends c{constructor(z,l){super(),this.gradient="Sinebow",this.mult=1,this.min=z,this.max=l,typeof l>"u"&&Array.isArray(z)&&z.length>=2&&(this.max=z[1],this.min=z[0]),l<z&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(z,l){var s,v;if(z=this.mult*z,l?(s=l[0],v=l[1]):(s=this.min,v=this.max),typeof z>"u")return 16777215;var w=A.normalizeValue(s,v,z);s=w.lo,v=w.hi,z=w.val;var E=(z-s)/(v-s),C=5*E/6+.5,h=Math.sin(Math.PI*C);h*=h*255;var x=Math.sin(Math.PI*(C+1/3));x*=x*255;var k=Math.sin(Math.PI*(C+2/3));return k*=k*255,65536*Math.floor(h)+256*Math.floor(k)+1*Math.floor(x)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class p extends c{constructor(z,l,s){super(),this.gradient="linear",this.colors=new Array;var v;if(Array.isArray(z)&&z.length>=2?(this.max=z[1],this.min=z[0],v=l):(this.min=z,this.max=l,v=s),v)for(let w of v)this.colors.push(o.CC.color(w));else this.colors.push(o.CC.color(0))}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(z,l){var s,v;if(l?(s=l[0],v=l[1]):(s=this.min,v=this.max),z===void 0)return 16777215;var w=u(s,v,z);s=w.lo,v=w.hi,z=w.val;let E=this.colors.length,C=(v-s)/E,h=Math.min(Math.floor((z-s)/C),E-1),x=Math.min(h+1,E-1),k=(z-s-h*C)/C,M=this.colors[h],D=this.colors[x];return new o.Color(M.r+k*(D.r-M.r),M.g+k*(D.g-M.g),M.b+k*(D.b-M.b)).getHex()}}const S={rwb:f,RWB:f,roygb:g,ROYGB:g,sinebow:_,linear:p};class A extends c{valueToHex(z,l){return 0}range(){return null}}A.RWB=f,A.ROYGB=g,A.Sinebow=_,A.CustomLinear=p,A.builtinGradients=S,A.normalizeValue=u,A.getGradient=y}),"./src/Label.ts":((e,r,t)=>{t.r(r),t.d(r,{Label:()=>_,LabelCount:()=>y});var o=t("./src/WebGL/index.ts"),c=t("./src/Gradient.ts"),u=t("./src/colors.ts");let y=0;function f(p,S,A,R,z,l,s){p.beginPath(),p.moveTo(S+l,A),p.lineTo(S+R-l,A),p.quadraticCurveTo(S+R,A,S+R,A+l),p.lineTo(S+R,A+z-l),p.quadraticCurveTo(S+R,A+z,S+R-l,A+z),p.lineTo(S+l,A+z),p.quadraticCurveTo(S,A+z,S,A+z-l),p.lineTo(S,A+l),p.quadraticCurveTo(S,A,S+l,A),p.closePath(),p.fill(),s&&p.stroke()}function g(p,S,A){var R=A;return typeof p<"u"&&(p instanceof u.Color?R=p.scaled():(R=u.CC.color(p),typeof R.scaled<"u"&&(R=R.scaled()))),typeof S<"u"&&(R.a=parseFloat(S)),R}class _{constructor(S,A){this.id=y++,this.stylespec=A||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new o.Sprite,this.text=S,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}setContext(){var S=this.stylespec,A=typeof S.useScreen>"u"?!1:S.useScreen,R=S.showBackground;(R==="0"||R==="false")&&(R=!1),typeof R>"u"&&(R=!0);var z=S.font?S.font:"sans-serif",l=parseInt(S.fontSize)?parseInt(S.fontSize):18,s=g(S.fontColor,S.fontOpacity,{r:255,g:255,b:255,a:1}),v=S.padding?S.padding:4,w=S.borderThickness?S.borderThickness:0,E=g(S.backgroundColor,S.backgroundOpacity,{r:0,g:0,b:0,a:1}),C=g(S.borderColor,S.borderOpacity,E),h=S.position?S.position:{x:-10,y:1,z:1},x=S.inFront!==void 0?S.inFront:!0;(x==="false"||x==="0")&&(x=!1);var k=S.alignment||o.SpriteAlignment.topLeft;typeof k=="string"&&k in o.SpriteAlignment&&(k=o.SpriteAlignment[k]);var M="";S.bold&&(M="bold "),this.context.font=M+l+"px  "+z;var D=this.context.measureText(this.text),P=D.width;R||(w=0);var F=P+2.5*w+2*v,X=l*1.25+2*w+2*v;if(S.backgroundImage){var B=S.backgroundImage,L=S.backgroundWidth?S.backgroundWidth:B.width,H=S.backgroundHeight?S.backgroundHeight:B.height;L>F&&(F=L),H>X&&(X=H)}if(this.canvas.width=F,this.canvas.height=X,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),M="",S.bold&&(M="bold "),this.context.font=M+l+"px  "+z,this.context.fillStyle="rgba("+E.r+","+E.g+","+E.b+","+E.a+")",this.context.strokeStyle="rgba("+C.r+","+C.g+","+C.b+","+C.a+")",S.backgroundGradient){let Y=this.context.createLinearGradient(0,X/2,F,X/2),W=c.Gradient.getGradient(S.backgroundGradient),q=W.range(),G=-1,$=1;q&&(G=q[0],$=q[1]);let Z=$-G;for(let xe=0;xe<1.01;xe+=.1){let ce=g(W.valueToHex(G+Z*xe)),Ne="rgba("+ce.r+","+ce.g+","+ce.b+","+ce.a+")";Y.addColorStop(xe,Ne)}this.context.fillStyle=Y}this.context.lineWidth=w,R&&f(this.context,w,w,F-2*w,X-2*w,6,w>0),S.backgroundImage&&this.context.drawImage(B,0,0,F,X),this.context.fillStyle="rgba("+s.r+","+s.g+","+s.b+","+s.a+")",this.context.fillText(this.text,w+v,l+w+v,P);var U=new o.Texture(this.canvas);U.needsUpdate=!0,this.sprite.material=new o.SpriteMaterial({map:U,useScreenCoordinates:A,alignment:k,depthTest:!x,screenOffset:S.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(h.x,h.y,h.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}}),"./src/ProteinSurface4.ts":((e,r,t)=>{t.r(r),t.d(r,{MarchingCube:()=>g,MarchingCubeInitializer:()=>f,PointGrid:()=>_,ProteinSurface:()=>p,SurfaceType:()=>c,setSyncSurface:()=>y,syncSurface:()=>u});var o=t("./src/WebGL/math/index.ts"),c;(function(S){S[S.VDW=1]="VDW",S[S.MS=2]="MS",S[S.SAS=3]="SAS",S[S.SES=4]="SES"})(c||(c={}));var u=!1;function y(S){u=S}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&(u=!0);class f{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(A,R,z,l){let s=!!l.fulltable,v=l.hasOwnProperty("origin")&&l.origin.hasOwnProperty("x")?l.origin:{x:0,y:0,z:0},w=!!l.voxel,E=l.matrix,C=l.nX||0,h=l.nY||0,x=l.nZ||0,k=l.scale||1,M=null;l.unitCube?M=l.unitCube:M={x:k,y:k,z:k};let D=new Int32Array(C*h*x),P,F;for(P=0,F=D.length;P<F;++P)D[P]=-1;let X=function(U,Y,W,q,G,$){let Z={x:0,y:0,z:0},xe=!!(q&1<<G),ce=!!(q&1<<$),Ne=G;if(!xe&&ce&&(Ne=$),Ne&1&&W++,Ne&2&&Y++,Ne&4&&U++,E){let De=new o.Vector3(U,Y,W);De=De.applyMatrix4(E),Z={x:De.x,y:De.y,z:De.z}}else Z.x=v.x+M.x*U,Z.y=v.y+M.y*Y,Z.z=v.z+M.z*W;let Pe=(h*U+Y)*x+W;return w?(R.push(Z),R.length-1):(D[Pe]<0&&(D[Pe]=R.length,R.push(Z)),D[Pe])},B=new Int32Array(12),L=s?this.edgeTable2:this.edgeTable,H=s?this.triTable2:this.triTable;for(P=0;P<C-1;++P)for(let U=0;U<h-1;++U)for(let Y=0;Y<x-1;++Y){let W=0;for(let $=0;$<8;++$){let Z=(h*(P+(($&4)>>2))+U+(($&2)>>1))*x+Y+($&1),xe=!!(A[Z]&this.ISDONE);W|=xe<<$}if(W===0||W===255)continue;let q=L[W];if(q===0)continue;let G=H[W];q&1&&(B[0]=X(P,U,Y,W,0,1)),q&2&&(B[1]=X(P,U,Y,W,1,3)),q&4&&(B[2]=X(P,U,Y,W,3,2)),q&8&&(B[3]=X(P,U,Y,W,2,0)),q&16&&(B[4]=X(P,U,Y,W,4,5)),q&32&&(B[5]=X(P,U,Y,W,5,7)),q&64&&(B[6]=X(P,U,Y,W,7,6)),q&128&&(B[7]=X(P,U,Y,W,6,4)),q&256&&(B[8]=X(P,U,Y,W,0,4)),q&512&&(B[9]=X(P,U,Y,W,1,5)),q&1024&&(B[10]=X(P,U,Y,W,3,7)),q&2048&&(B[11]=X(P,U,Y,W,2,6));for(let $=0;$<G.length;$+=3){let Z=B[G[$]],xe=B[G[$+1]],ce=B[G[$+2]];w&&$>=3&&(R.push(R[Z]),Z=R.length-1,R.push(R[xe]),xe=R.length-1,R.push(R[ce]),ce=R.length-1),z.push(Z),z.push(xe),z.push(ce)}}}laplacianSmooth(A,R,z){let l=new Array(R.length),s,v,w,E,C;for(s=0,v=R.length;s<v;s++)l[s]={x:0,y:0,z:0};let h=new Array(20),x;for(s=0;s<20;s++)h[s]=new Array(R.length);for(s=0,v=R.length;s<v;s++)h[0][s]=0;for(s=0,v=z.length/3;s<v;s++){let D=s*3,P=s*3+1,F=s*3+2;for(x=!0,w=0,E=h[0][z[D]];w<E;w++)if(z[P]==h[w+1][z[D]]){x=!1;break}for(x&&(h[0][z[D]]++,h[h[0][z[D]]][z[D]]=z[P]),x=!0,w=0,E=h[0][z[D]];w<E;w++)if(z[F]==h[w+1][z[D]]){x=!1;break}for(x&&(h[0][z[D]]++,h[h[0][z[D]]][z[D]]=z[F]),x=!0,w=0,E=h[0][z[P]];w<E;w++)if(z[D]==h[w+1][z[P]]){x=!1;break}for(x&&(h[0][z[P]]++,h[h[0][z[P]]][z[P]]=z[D]),x=!0,w=0,E=h[0][z[P]];w<E;w++)if(z[F]==h[w+1][z[P]]){x=!1;break}for(x&&(h[0][z[P]]++,h[h[0][z[P]]][z[P]]=z[F]),x=!0,w=0;w<h[0][z[F]];w++)if(z[D]==h[w+1][z[F]]){x=!1;break}for(x&&(h[0][z[F]]++,h[h[0][z[F]]][z[F]]=z[D]),x=!0,w=0,E=h[0][z[F]];w<E;w++)if(z[P]==h[w+1][z[F]]){x=!1;break}x&&(h[0][z[F]]++,h[h[0][z[F]]][z[F]]=z[P])}let k=1,M=.5;for(C=0;C<A;C++){for(s=0,v=R.length;s<v;s++)if(h[0][s]<3)l[s].x=R[s].x,l[s].y=R[s].y,l[s].z=R[s].z;else if(h[0][s]==3||h[0][s]==4){for(l[s].x=0,l[s].y=0,l[s].z=0,w=0,E=h[0][s];w<E;w++)l[s].x+=R[h[w+1][s]].x,l[s].y+=R[h[w+1][s]].y,l[s].z+=R[h[w+1][s]].z;l[s].x+=M*R[s].x,l[s].y+=M*R[s].y,l[s].z+=M*R[s].z,l[s].x/=M+h[0][s],l[s].y/=M+h[0][s],l[s].z/=M+h[0][s]}else{for(l[s].x=0,l[s].y=0,l[s].z=0,w=0,E=h[0][s];w<E;w++)l[s].x+=R[h[w+1][s]].x,l[s].y+=R[h[w+1][s]].y,l[s].z+=R[h[w+1][s]].z;l[s].x+=k*R[s].x,l[s].y+=k*R[s].y,l[s].z+=k*R[s].z,l[s].x/=k+h[0][s],l[s].y/=k+h[0][s],l[s].z/=k+h[0][s]}for(s=0,v=R.length;s<v;s++)R[s].x=l[s].x,R[s].y=l[s].y,R[s].z=l[s].z}}}let g=new f;class _{constructor(A,R,z){this.data=new Int32Array(A*R*z*3),this.width=R,this.height=z}set(A,R,z,l){let s=((A*this.width+R)*this.height+z)*3;this.data[s]=l.ix,this.data[s+1]=l.iy,this.data[s+2]=l.iz}get(A,R,z){let l=((A*this.width+R)*this.height+z)*3;return{ix:this.data[l],iy:this.data[l+1],iz:this.data[l+2]}}}class p{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],p.MarchingCube||(p.MarchingCube=new f)}getVDWIndex(A){return!A.elem||typeof this.vdwRadii[A.elem]>"u"?"X":A.elem}getFacesAndVertices(A){let R={};for(let s=0,v=A.length;s<v;s++)R[A[s]]=!0;let z=this.verts;for(let s=0,v=z.length;s<v;s++)z[s].x=z[s].x/this.scaleFactor-this.ptranx,z[s].y=z[s].y/this.scaleFactor-this.ptrany,z[s].z=z[s].z/this.scaleFactor-this.ptranz;let l=[];for(let s=0,v=this.faces.length;s<v;s+=3){let w=this.faces[s],E=this.faces[s+1],C=this.faces[s+2],h=z[w].atomid,x=z[E].atomid,k=z[C].atomid,M=h;x<M&&(M=x),k<M&&(M=k),R[M]&&w!==E&&E!==C&&w!==C&&(l.push(w),l.push(E),l.push(C))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:z,faces:l}}initparm(A,R,z){z>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let l=1/this.scaleFactor*5.5;this.pminx=A[0][0],this.pmaxx=A[1][0],this.pminy=A[0][1],this.pmaxy=A[1][1],this.pminz=A[0][2],this.pmaxz=A[1][2],R?(this.pminx-=this.probeRadius+l,this.pminy-=this.probeRadius+l,this.pminz-=this.probeRadius+l,this.pmaxx+=this.probeRadius+l,this.pmaxy+=this.probeRadius+l,this.pmaxz+=this.probeRadius+l):(this.pminx-=l,this.pminy-=l,this.pminz-=l,this.pmaxx+=l,this.pmaxy+=l,this.pmaxz+=l),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(R),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(A){let R={};for(const z in this.vdwRadii){let l=this.vdwRadii[z];A?R[z]=(l+this.probeRadius)*this.scaleFactor+.5:R[z]=l*this.scaleFactor+.5;let s=R[z]*R[z];this.widxz[z]=Math.floor(R[z])+1,this.depty[z]=new Int32Array(this.widxz[z]*this.widxz[z]);let v=0;for(let w=0;w<this.widxz[z];w++)for(let E=0;E<this.widxz[z];E++){let C=w*w+E*E;if(C>s)this.depty[z][v]=-1;else{let h=Math.sqrt(s-C);this.depty[z][v]=Math.floor(h)}v++}}}fillvoxels(A,R){for(let z=0,l=this.vpBits.length;z<l;z++)this.vpBits[z]=0,this.vpDistance[z]=-1,this.vpAtomID[z]=-1;for(let z in R){let l=A[R[z]];l!==void 0&&this.fillAtom(l,A)}for(let z=0,l=this.vpBits.length;z<l;z++)this.vpBits[z]&this.INOUT&&(this.vpBits[z]|=this.ISDONE)}fillAtom(A,R){let z=Math.floor(.5+this.scaleFactor*(A.x+this.ptranx)),l=Math.floor(.5+this.scaleFactor*(A.y+this.ptrany)),s=Math.floor(.5+this.scaleFactor*(A.z+this.ptranz)),v=this.getVDWIndex(A),w=0,E=this.pWidth*this.pHeight;for(let C=0,h=this.widxz[v];C<h;C++)for(let x=0;x<h;x++){if(this.depty[v][w]!=-1){for(let k=-1;k<2;k++)for(let M=-1;M<2;M++)for(let D=-1;D<2;D++)if(k!==0&&M!==0&&D!==0){let P=k*C,F=D*x;for(let X=0;X<=this.depty[v][w];X++){let B=X*M,L=z+P,H=l+B,U=s+F;if(L<0||H<0||U<0||L>=this.pLength||H>=this.pWidth||U>=this.pHeight)continue;let Y=L*E+H*this.pHeight+U;if(!(this.vpBits[Y]&this.INOUT))this.vpBits[Y]|=this.INOUT,this.vpAtomID[Y]=A.serial;else{let W=R[this.vpAtomID[Y]];if(W.serial!=A.serial){let q=z+P-Math.floor(.5+this.scaleFactor*(W.x+this.ptranx)),G=l+B-Math.floor(.5+this.scaleFactor*(W.y+this.ptrany)),$=s+F-Math.floor(.5+this.scaleFactor*(W.z+this.ptranz));P*P+B*B+F*F<q*q+G*G+$*$&&(this.vpAtomID[Y]=A.serial)}}}}}w++}}fillvoxelswaals(A,R){for(let z=0,l=this.vpBits.length;z<l;z++)this.vpBits[z]&=~this.ISDONE;for(let z in R){let l=A[R[z]];l!==void 0&&this.fillAtomWaals(l,A)}}fillAtomWaals(A,R){let z=0,l=Math.floor(.5+this.scaleFactor*(A.x+this.ptranx)),s=Math.floor(.5+this.scaleFactor*(A.y+this.ptrany)),v=Math.floor(.5+this.scaleFactor*(A.z+this.ptranz)),w=this.getVDWIndex(A),E=this.pWidth*this.pHeight;for(let C=0,h=this.widxz[w];C<h;C++)for(let x=0;x<h;x++){if(this.depty[w][z]!=-1){for(let k=-1;k<2;k++)for(let M=-1;M<2;M++)for(let D=-1;D<2;D++)if(k!==0&&M!==0&&D!==0){let P=k*C,F=D*x;for(let X=0;X<=this.depty[w][z];X++){let B=X*M,L=l+P,H=s+B,U=v+F;if(L<0||H<0||U<0||L>=this.pLength||H>=this.pWidth||U>=this.pHeight)continue;let Y=L*E+H*this.pHeight+U;if(!(this.vpBits[Y]&this.ISDONE))this.vpBits[Y]|=this.ISDONE,this.vpAtomID[Y]=A.serial;else{let W=R[this.vpAtomID[Y]];if(W.serial!=A.serial){let q=l+P-Math.floor(.5+this.scaleFactor*(W.x+this.ptranx)),G=s+B-Math.floor(.5+this.scaleFactor*(W.y+this.ptrany)),$=v+F-Math.floor(.5+this.scaleFactor*(W.z+this.ptranz));P*P+B*B+F*F<q*q+G*G+$*$&&(this.vpAtomID[Y]=A.serial)}}}}}z++}}buildboundary(){let A=this.pWidth*this.pHeight;for(let R=0;R<this.pLength;R++)for(let z=0;z<this.pHeight;z++)for(let l=0;l<this.pWidth;l++){let s=R*A+l*this.pHeight+z;if(this.vpBits[s]&this.INOUT){let v=0;for(;v<26;){let w=R+this.nb[v][0],E=z+this.nb[v][2],C=l+this.nb[v][1];if(w>-1&&w<this.pLength&&C>-1&&C<this.pWidth&&E>-1&&E<this.pHeight&&!(this.vpBits[w*A+C*this.pHeight+E]&this.INOUT)){this.vpBits[s]|=this.ISBOUND;break}else v++}}}}fastdistancemap(){let A=new _(this.pLength,this.pWidth,this.pHeight),R=this.pWidth*this.pHeight,z=this.cutRadius*this.cutRadius,l=[],s=[],v;for(let C=0;C<this.pLength;C++)for(let h=0;h<this.pWidth;h++)for(let x=0;x<this.pHeight;x++)if(v=C*R+h*this.pHeight+x,this.vpBits[v]&=~this.ISDONE,this.vpBits[v]&this.INOUT&&this.vpBits[v]&this.ISBOUND){let k={ix:C,iy:h,iz:x};A.set(C,h,x,k),l.push(k),this.vpDistance[v]=0,this.vpBits[v]|=this.ISDONE,this.vpBits[v]&=~this.ISBOUND}do{s=this.fastoneshell(l,A),l=[];for(let C=0,h=s.length;C<h;C++)v=R*s[C].ix+this.pHeight*s[C].iy+s[C].iz,this.vpBits[v]&=~this.ISBOUND,this.vpDistance[v]<=1.0404*z&&l.push({ix:s[C].ix,iy:s[C].iy,iz:s[C].iz})}while(l.length!==0);l=[],s=[],A=null;let w=this.scaleFactor-.5;w<0&&(w=0);let E=z-.5/(.1+w);for(let C=0;C<this.pLength;C++)for(let h=0;h<this.pWidth;h++)for(let x=0;x<this.pHeight;x++)v=C*R+h*this.pHeight+x,this.vpBits[v]&=~this.ISBOUND,this.vpBits[v]&this.INOUT&&(!(this.vpBits[v]&this.ISDONE)||this.vpBits[v]&this.ISDONE&&this.vpDistance[v]>=E)&&(this.vpBits[v]|=this.ISBOUND)}fastoneshell(A,R){let z,l,s,v,w,E,C,h,x,k=[];if(A.length===0)return k;let M={ix:-1,iy:-1,iz:-1},D=this.pWidth*this.pHeight;for(let P=0,F=A.length;P<F;P++){z=A[P].ix,l=A[P].iy,s=A[P].iz,h=R.get(z,l,s);for(let X=0;X<6;X++)M.ix=z+this.nb[X][0],M.iy=l+this.nb[X][1],M.iz=s+this.nb[X][2],M.ix<this.pLength&&M.ix>-1&&M.iy<this.pWidth&&M.iy>-1&&M.iz<this.pHeight&&M.iz>-1&&(x=M.ix*D+this.pHeight*M.iy+M.iz,this.vpBits[x]&this.INOUT&&!(this.vpBits[x]&this.ISDONE)?(R.set(M.ix,M.iy,s+this.nb[X][2],h),v=M.ix-h.ix,w=M.iy-h.iy,E=M.iz-h.iz,C=v*v+w*w+E*E,this.vpDistance[x]=C,this.vpBits[x]|=this.ISDONE,this.vpBits[x]|=this.ISBOUND,k.push({ix:M.ix,iy:M.iy,iz:M.iz})):this.vpBits[x]&this.INOUT&&this.vpBits[x]&this.ISDONE&&(v=M.ix-h.ix,w=M.iy-h.iy,E=M.iz-h.iz,C=v*v+w*w+E*E,C<this.vpDistance[x]&&(R.set(M.ix,M.iy,M.iz,h),this.vpDistance[x]=C,this.vpBits[x]&this.ISBOUND||(this.vpBits[x]|=this.ISBOUND,k.push({ix:M.ix,iy:M.iy,iz:M.iz})))))}for(let P=0,F=A.length;P<F;P++){z=A[P].ix,l=A[P].iy,s=A[P].iz,h=R.get(z,l,s);for(let X=6;X<18;X++)M.ix=z+this.nb[X][0],M.iy=l+this.nb[X][1],M.iz=s+this.nb[X][2],M.ix<this.pLength&&M.ix>-1&&M.iy<this.pWidth&&M.iy>-1&&M.iz<this.pHeight&&M.iz>-1&&(x=M.ix*D+this.pHeight*M.iy+M.iz,this.vpBits[x]&this.INOUT&&!(this.vpBits[x]&this.ISDONE)?(R.set(M.ix,M.iy,s+this.nb[X][2],h),v=M.ix-h.ix,w=M.iy-h.iy,E=M.iz-h.iz,C=v*v+w*w+E*E,this.vpDistance[x]=C,this.vpBits[x]|=this.ISDONE,this.vpBits[x]|=this.ISBOUND,k.push({ix:M.ix,iy:M.iy,iz:M.iz})):this.vpBits[x]&this.INOUT&&this.vpBits[x]&this.ISDONE&&(v=M.ix-h.ix,w=M.iy-h.iy,E=M.iz-h.iz,C=v*v+w*w+E*E,C<this.vpDistance[x]&&(R.set(M.ix,M.iy,M.iz,h),this.vpDistance[x]=C,this.vpBits[x]&this.ISBOUND||(this.vpBits[x]|=this.ISBOUND,k.push({ix:M.ix,iy:M.iy,iz:M.iz})))))}for(let P=0,F=A.length;P<F;P++){z=A[P].ix,l=A[P].iy,s=A[P].iz,h=R.get(z,l,s);for(let X=18;X<26;X++)M.ix=z+this.nb[X][0],M.iy=l+this.nb[X][1],M.iz=s+this.nb[X][2],M.ix<this.pLength&&M.ix>-1&&M.iy<this.pWidth&&M.iy>-1&&M.iz<this.pHeight&&M.iz>-1&&(x=M.ix*D+this.pHeight*M.iy+M.iz,this.vpBits[x]&this.INOUT&&!(this.vpBits[x]&this.ISDONE)?(R.set(M.ix,M.iy,s+this.nb[X][2],h),v=M.ix-h.ix,w=M.iy-h.iy,E=M.iz-h.iz,C=v*v+w*w+E*E,this.vpDistance[x]=C,this.vpBits[x]|=this.ISDONE,this.vpBits[x]|=this.ISBOUND,k.push({ix:M.ix,iy:M.iy,iz:M.iz})):this.vpBits[x]&this.INOUT&&this.vpBits[x]&this.ISDONE&&(v=M.ix-h.ix,w=M.iy-h.iy,E=M.iz-h.iz,C=v*v+w*w+E*E,C<this.vpDistance[x]&&(R.set(M.ix,M.iy,M.iz,h),this.vpDistance[x]=C,this.vpBits[x]&this.ISBOUND||(this.vpBits[x]|=this.ISBOUND,k.push({ix:M.ix,iy:M.iy,iz:M.iz})))))}return k}marchingcubeinit(A){for(let R=0,z=this.vpBits.length;R<z;R++)A==1?this.vpBits[R]&=~this.ISBOUND:A==4?(this.vpBits[R]&=~this.ISDONE,this.vpBits[R]&this.ISBOUND&&(this.vpBits[R]|=this.ISDONE),this.vpBits[R]&=~this.ISBOUND):A==2?this.vpBits[R]&this.ISBOUND&&this.vpBits[R]&this.ISDONE?this.vpBits[R]&=~this.ISBOUND:this.vpBits[R]&this.ISBOUND&&!(this.vpBits[R]&this.ISDONE)&&(this.vpBits[R]|=this.ISDONE):A==3&&(this.vpBits[R]&=~this.ISBOUND)}marchingcube(A){this.marchingcubeinit(A),this.verts=[],this.faces=[],p.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let R=this.pWidth*this.pHeight;for(let z=0,l=this.verts.length;z<l;z++)this.verts[z].atomid=this.vpAtomID[this.verts[z].x*R+this.pHeight*this.verts[z].y+this.verts[z].z];p.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}p.MarchingCube=new f}),"./src/VolumeData.ts":((e,r,t)=>{t.r(r),t.d(r,{VolumeData:()=>g});var o=t("./src/utilities.ts"),c=t("./src/WebGL/math/index.ts"),u=t("./src/parsers/VASP.ts"),y=t("./src/parsers/CUBE.ts"),f=t("./node_modules/pako/dist/pako.esm.mjs");class g{constructor(p,S,A){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(v){var w=v/(this.size.y*this.size.z),E=v%(this.size.y*this.size.z),C=v%this.size.z;return w*=this.unit.x,E*=this.unit.y,C*=this.unit.z,w+=this.origin.x,E+=this.origin.y,C+=this.origin.z,{x:w,y:E,z:C}},this.vasp=function(v){var w=v.replace(/^\s+/,"").split(/[\n\r]/),E=(0,u.VASP)(v)[0],C=E.length;if(C==0){console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),this.data=[];return}var h=1.889725992,x=.036749309,k=parseFloat(w[1]),M;M=w[2].replace(/^\s+/,"").split(/\s+/);var D=new c.Vector3(parseFloat(M[0]),parseFloat(M[1]),parseFloat(M[2])).multiplyScalar(k*h);M=w[3].replace(/^\s+/,"").split(/\s+/);var P=new c.Vector3(parseFloat(M[0]),parseFloat(M[1]),parseFloat(M[2])).multiplyScalar(k*h);M=w[4].replace(/^\s+/,"").split(/\s+/);var F=new c.Vector3(parseFloat(M[0]),parseFloat(M[1]),parseFloat(M[2])).multiplyScalar(k*h),X=D.x*(P.y*F.z-F.y*P.z)-P.x*(D.y*F.z-F.y*D.z)+F.x*(D.y*P.z-P.y*D.z);X=Math.abs(X)/Math.pow(h,3);var B=1/X;w.splice(0,8+C+1);var L=w[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),H=Math.abs(parseFloat(L[0])),U=Math.abs(parseFloat(L[1])),Y=Math.abs(parseFloat(L[2])),W=this.origin=new c.Vector3(0,0,0);this.size={x:H,y:U,z:Y},this.unit=new c.Vector3(D.x,P.y,F.z),D=D.multiplyScalar(1/(h*H)),P=P.multiplyScalar(1/(h*U)),F=F.multiplyScalar(1/(h*Y)),(D.y!=0||D.z!=0||P.x!=0||P.z!=0||F.x!=0||F.y!=0)&&(this.matrix=new c.Matrix4(D.x,P.x,F.x,0,D.y,P.y,F.y,0,D.z,P.z,F.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new c.Matrix4().makeTranslation(W.x,W.y,W.z)),this.origin=new c.Vector3(0,0,0),this.unit=new c.Vector3(1,1,1)),w.splice(0,1);var q=w.join(" ");q=q.replace(/^\s+/,"");var G=q.split(/[\s\r]+/);G.splice(H*U*Y+1);for(var $=Float32Array.from(G,parseFloat),Z=0;Z<$.length;Z++)$[Z]=$[Z]*B*x;this.data=$},this.dx=function(v){var w=v.split(/[\n\r]+/),E,C=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,h=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,x=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,k=/data follows/,M=0;for(M=0;M<w.length;M++){var D=w[M];if(E=C.exec(D)){var P=parseInt(E[1]),F=parseInt(E[2]),X=parseInt(E[3]);this.size={x:P,y:F,z:X}}else if(E=x.exec(D)){var B=parseFloat(E[1]);if((parseFloat(E[2])!=0||parseFloat(E[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),M+=1,D=w[M],E=x.exec(D),E==null){console.error("Parse error in dx delta matrix");return}var L=parseFloat(E[2]);if((parseFloat(E[1])!=0||parseFloat(E[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),M+=1,D=w[M],E=x.exec(D),E==null){console.error("Parse error in dx delta matrix");return}var H=parseFloat(E[3]);(parseFloat(E[1])!=0||parseFloat(E[2])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new c.Vector3(B,L,H)}else if(E=h.exec(D)){var U=parseFloat(E[1]),Y=parseFloat(E[2]),W=parseFloat(E[3]);this.origin=new c.Vector3(U,Y,W)}else if(E=k.exec(D))break}if(M+=1,!this.size||!this.origin||!this.unit||!this.size){console.error("Error parsing dx format");return}var q=w.splice(M).join(" "),G=q.split(/[\s\r]+/);this.data=Float32Array.from(G,parseFloat)},S=S.toLowerCase(),/\.gz$/.test(S)){S=S.replace(/\.gz$/,"");try{this[S]&&this.isbinary.has(S)?(typeof p=="string"&&(p=(0,o.base64ToArray)(p)),p=(0,f.inflate)(p)):p=new TextDecoder("utf-8").decode((0,f.inflate)(p))}catch(v){console.error(v)}}if(this[S]&&(this.isbinary.has(S)&&typeof p=="string"&&(p=(0,o.base64ToArray)(p)),this[S](p)),A){if(A.negate)for(let v=0,w=this.data.length;v<w;v++)this.data[v]=-this.data[v];if(A.normalize){var R=0;for(let v=0,w=this.data.length;v<w;v++)R+=this.data[v];var z=R/this.data.length;R=0;for(let v=0,w=this.data.length;v<w;v++){var l=this.data[v]-z;R+=l*l}var s=R/this.data.length;for(let v=0,w=this.data.length;v<w;v++)this.data[v]=(this.data[v]-z)/s}}}getIndex(p,S,A){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new c.Matrix4().getInverse(this.matrix));var R=new c.Vector3(p,S,A);R=R.applyMatrix4(this.inversematrix),p=R.x,S=R.y,A=R.z}else p-=this.origin.x,S-=this.origin.y,A-=this.origin.z,p/=this.unit.x,S/=this.unit.y,A/=this.unit.z;return p=Math.round(p),S=Math.round(S),A=Math.round(A),p<0||p>=this.size.x||S<0||S>=this.size.y||A<0||A>=this.size.z?-1:p*this.size.y*this.size.z+S*this.size.z+A}getVal(p,S,A){let R=this.getIndex(p,S,A);return R<0?0:this.data[R]}cube(p){var S=p.split(/\r?\n/);if(!(S.length<6)){var A=(0,y.CUBE)(p,{}).modelData[0].cryst,R=S[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),z=parseFloat(R[0]),l=Math.abs(z);this.origin=A.origin,this.size=A.size,this.unit=A.unit,this.matrix=A.matrix4;var s=6;z<0&&s++;var v=S.splice(l+s).join(" ");v=v.replace(/^\s+/,"");var w=v.split(/[\s\r]+/);this.data=Float32Array.from(w,parseFloat)}}ccp4(p){var S={};p=new Int8Array(p);var A=new Int32Array(p.buffer,0,56),R=new Float32Array(p.buffer,0,56),z=new DataView(p.buffer);if(S.MAP=String.fromCharCode(z.getUint8(208),z.getUint8(209),z.getUint8(210),z.getUint8(211)),S.MACHST=[z.getUint8(212),z.getUint8(213)],S.MACHST[0]===17&&S.MACHST[1]===17)for(var l=p.byteLength,s=0;s<l;s+=4)z.setFloat32(s,z.getFloat32(s),!0);S.NX=A[0],S.NY=A[1],S.NZ=A[2],S.MODE=A[3],S.NXSTART=A[4],S.NYSTART=A[5],S.NZSTART=A[6],S.MX=A[7],S.MY=A[8],S.MZ=A[9],S.xlen=R[10],S.ylen=R[11],S.zlen=R[12],S.alpha=R[13],S.beta=R[14],S.gamma=R[15],S.MAPC=A[16],S.MAPR=A[17],S.MAPS=A[18],S.DMIN=R[19],S.DMAX=R[20],S.DMEAN=R[21],S.ISPG=A[22],S.NSYMBT=A[23],S.LSKFLG=A[24],S.originX=R[49],S.originY=R[50],S.originZ=R[51],S.ARMS=R[54];var v=S,w=[v.xlen,0,0],E=[v.ylen*Math.cos(Math.PI/180*v.gamma),v.ylen*Math.sin(Math.PI/180*v.gamma),0],C=[v.zlen*Math.cos(Math.PI/180*v.beta),v.zlen*(Math.cos(Math.PI/180*v.alpha)-Math.cos(Math.PI/180*v.gamma)*Math.cos(Math.PI/180*v.beta))/Math.sin(Math.PI/180*v.gamma),0];C[2]=Math.sqrt(v.zlen*v.zlen*Math.sin(Math.PI/180*v.beta)*Math.sin(Math.PI/180*v.beta)-C[1]*C[1]);var h=[0,w,E,C],x=[0,v.MX,v.MY,v.MZ],k=[0,v.MAPC,v.MAPR,v.MAPS];this.matrix=new c.Matrix4,this.matrix.set(h[k[1]][0]/x[k[1]],h[k[2]][0]/x[k[2]],h[k[3]][0]/x[k[3]],0,h[k[1]][1]/x[k[1]],h[k[2]][1]/x[k[2]],h[k[3]][1]/x[k[3]],0,h[k[1]][2]/x[k[1]],h[k[2]][2]/x[k[2]],h[k[3]][2]/x[k[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new c.Matrix4().makeTranslation(v.NXSTART+v.originX,v.NYSTART+v.originY,v.NZSTART+v.originZ)),this.origin=new c.Vector3(0,0,0),this.unit=new c.Vector3(1,1,1),this.size={x:S.NX,y:S.NY,z:S.NZ},this.dimensionorder=[S.MAPC,S.MAPR,S.MAPS];var M=new Float32Array(p.buffer,1024+S.NSYMBT),D=S.NX,P=S.NY,F=S.NZ;this.data=new Float32Array(D*P*F);for(let X=0;X<D;X++)for(let B=0;B<P;B++)for(let L=0;L<F;L++)this.data[(X*P+B)*F+L]=M[(L*P+B)*D+X]}}}),"./src/VolumetricRender.ts":((e,r,t)=>{t.r(r),t.d(r,{GLVolumetricRender:()=>g});var o=t("./src/WebGL/shapes/index.ts"),c=t("./src/WebGL/math/index.ts"),u=t("./src/WebGL/index.ts"),y=t("./src/colors.ts"),f=t("./src/GLShape.ts");class g{static interpolateArray(p,S){function A(C,h,x){return C+(h-C)*x}var R=[],z=(p.length-1)/(S-1);R[0]=p[0];for(var l=1;l<S-1;l++){var s=l*z,v=Math.floor(s),w=Math.ceil(s),E=s-v;R[l]=A(p[v],p[w],E)}return R[S-1]=p[p.length-1],R}constructor(p,S,A){this.hidden=!1,this.boundingSphere=new o.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,S=S||{};var R=Object.assign([],S.transferfn);this.subsamples=S.subsamples||5;let z=256;R.forEach(function(P){P.value=parseFloat(P.value)}),R.sort(function(P,F){return P.value-F.value}),this.min=R[0].value,R.length==0&&R.push(R[0]),this.max=R[R.length-1].value;var l,s,v,w,E,C,h,x,k,M;for(let P=0;P<R.length-1;P++)if(v=y.CC.color(R[P].color),w=y.CC.color(R[P+1].color),k=R[P].opacity,M=R[P+1].opacity,l=Math.floor((R[P].value-this.min)*z/(this.max-this.min)),s=Math.floor((R[P+1].value-this.min)*z/(this.max-this.min)),l!=s){E=g.interpolateArray([v.r*255,w.r*255],s-l),C=g.interpolateArray([v.g*255,w.g*255],s-l),h=g.interpolateArray([v.b*255,w.b*255],s-l),x=g.interpolateArray([k*255,M*255],s-l);for(let F=0;F<E.length;F++)this.transferfunctionbuffer.push(E[F]),this.transferfunctionbuffer.push(C[F]),this.transferfunctionbuffer.push(h[F]),this.transferfunctionbuffer.push(x[F])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),p.matrix){let P=new c.Vector3(0,0,0),F=new c.Vector3(p.size.x,p.size.y,p.size.z),X=new c.Vector3(1,1,1);P.applyMatrix4(p.matrix),F.applyMatrix4(p.matrix),X.applyMatrix4(p.matrix).sub(P),this.extent=[[P.x,P.y,P.z],[F.x,F.y,F.z]];for(let U=1;U<7;U++)F.x=U&1?p.size.x:0,F.y=U&2?p.size.y:0,F.z=U&4?p.size.z:0,F.applyMatrix4(p.matrix),this.extent[0][0]=Math.min(this.extent[0][0],F.x),this.extent[0][1]=Math.min(this.extent[0][1],F.y),this.extent[0][2]=Math.min(this.extent[0][2],F.z),this.extent[1][0]=Math.max(this.extent[1][0],F.x),this.extent[1][1]=Math.max(this.extent[1][1],F.y),this.extent[1][2]=Math.max(this.extent[1][2],F.z);let B=F.x-P.x,L=F.y-P.y,H=F.z-P.z;this.maxdepth=Math.sqrt(B*B+L*L+H*H),this.minunit=Math.min(Math.min(X.x,X.y),X.z),this.texmatrix=new c.Matrix4().identity().scale({x:p.size.x,y:p.size.y,z:p.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(p.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new c.Matrix4().identity();let P=p.unit.x*p.size.x,F=p.unit.y*p.size.y,X=p.unit.z*p.size.z;this.texmatrix.makeTranslation(-p.origin.x/P,-p.origin.y/F,-p.origin.z/X),this.texmatrix.scale({x:1/P,y:1/F,z:1/X}),this.minunit=Math.min(Math.min(p.unit.x,p.unit.y),p.unit.z),this.extent=[[p.origin.x,p.origin.y,p.origin.z],[p.origin.x+P,p.origin.y+F,p.origin.z+X]],this.maxdepth=Math.sqrt(P*P+F*F+X*X)}var D=new f.GLShape({});if(D.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=D.finalize(),this.boundingSphere.center=new c.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,S.coords===void 0&&S.selection!==void 0&&(A?S.coords=A.selectedAtoms(S.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),S.coords!==void 0&&S.seldist!==void 0){let P=new Uint8Array(p.data.length),F=S.seldist,X=F*F;for(let B=0,L=S.coords.length;B<L;B++){let H=S.coords[B],U=H.x-F,Y=H.y-F,W=H.z-F,q=H.x+F,G=H.y+F,$=H.z+F;if(p.getIndex(U,Y,W)>=0||p.getIndex(q,G,$)>=0)for(let Z=U;Z<q;Z+=this.minunit)for(let xe=Y;xe<G;xe+=this.minunit)for(let ce=W;ce<$;ce+=this.minunit){let Ne=p.getIndex(Z,xe,ce);Ne>=0&&!P[Ne]&&(Z-H.x)*(Z-H.x)+(xe-H.y)*(xe-H.y)+(ce-H.z)*(ce-H.z)<X&&(P[Ne]=1)}}for(let B=0,L=p.data.length;B<L;B++)P[B]==0&&(p.data[B]=1/0)}this.data=p}globj(p){if(this.renderedShapeObj&&(p.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new u.Object3D;var S=null,A=new u.Texture(this.data,!0),R=new u.Texture(this.transferfunctionbuffer,!1);A.needsUpdate=!0,R.needsUpdate=!0,R.flipY=!1,S=new u.VolumetricMaterial({transferfn:R,transfermin:this.min,transfermax:this.max,map:A,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var z=new u.Mesh(this.geo,S);this.shapeObj.add(z),this.renderedShapeObj=this.shapeObj.clone(),p.add(this.renderedShapeObj)}}removegl(p){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),p.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}}),"./src/WebGL/Camera.ts":((e,r,t)=>{t.r(r),t.d(r,{Camera:()=>u});var o=t("./src/WebGL/core/index.ts"),c=t("./src/WebGL/math/index.ts");class u extends o.Object3D{constructor(f=50,g=1,_=.1,p=2e3,S=!1){super(),this.projectionMatrix=new c.Matrix4,this.projectionMatrixInverse=new c.Matrix4,this.matrixWorldInverse=new c.Matrix4,this.fov=f,this.aspect=g,this.near=_,this.far=p;var A=this.position.z;this.right=A*Math.tan(Math.PI/180*f),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!S,this.updateProjectionMatrix()}lookAt(f){this.matrix.lookAt(this.position,f,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof c.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}}),"./src/WebGL/Fog.ts":((e,r,t)=>{t.r(r),t.d(r,{Fog:()=>c});var o=t("./src/colors.ts");class c{constructor(y,f=1,g=1e3){this.name="",this.color=new o.Color(y),this.near=f,this.far=g}clone(){return new c(this.color.getHex(),this.near,this.far)}}}),"./src/WebGL/Renderer.ts":((e,r,t)=>{t.r(r),t.d(r,{Renderer:()=>R});var o=t("./src/WebGL/Camera.ts"),c=t("./src/WebGL/constants/Sides.ts"),u=t("./src/WebGL/constants/TextureConstants.ts"),y=t("./src/WebGL/core/index.ts"),f=t("./src/colors.ts"),g=t("./src/WebGL/materials/index.ts"),_=t("./src/WebGL/math/index.ts"),p=t("./src/WebGL/objects/index.ts"),S=t("./src/WebGL/shaders/index.ts"),A=t("./src/WebGL/SpritePlugin.ts");class R{constructor(l){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new _.Vector3,this._worldInverse=new _.Matrix4,this._projInverse=new _.Matrix4,this._textureMatrix=new _.Matrix4,this._fullProjModelMatrix=new _.Matrix4,this._fullProjModelMatrixInv=new _.Matrix4,this._direction=new _.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new A.SpritePlugin,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,l=l||{},this.row=l.row,this.col=l.col,this.rows=l.rows,this.cols=l.cols,this._canvas=l.canvas!==void 0?l.canvas:document.createElement("canvas"),this._precision=l.precision!==void 0?l.precision:"highp",this._alpha=l.alpha!==void 0?l.alpha:!0,this._premultipliedAlpha=l.premultipliedAlpha!==void 0?l.premultipliedAlpha:!0,this._antialias=l.antialias!==void 0?l.antialias:!1,this._preserveDrawingBuffer=l.preserveDrawingBuffer!==void 0?l.preserveDrawingBuffer:!1,this._clearColor=l.clearColor!==void 0?new f.Color(l.clearColor):new f.Color(0),this._clearAlpha=l.clearAlpha!==void 0?l.clearAlpha:0,this._outlineMaterial=new g.MeshOutlineMaterial(l.outline),this._outlineSphereImposterMaterial=new g.SphereImposterOutlineMaterial(l.outline),this._outlineStickImposterMaterial=new g.StickImposterOutlineMaterial(l.outline),this._outlineEnabled=!!l.outline,this._AOEnabled=!!l.ambientOcclusion,l.ambientOcclusion&&typeof l.ambientOcclusion.strength<"u"&&(this._AOstrength=parseFloat(l.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),l.ambientOcclusion&&typeof l.ambientOcclusion.radius<"u"&&(this._AOradius=parseFloat(l.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=l.id,!(l.containerWidth==0||l.containerHeight==0)&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(l,s){this._clearColor.setHex(l),this._clearAlpha=s,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(l){this._outlineMaterial=new g.MeshOutlineMaterial(l),this._outlineSphereImposterMaterial=new g.SphereImposterOutlineMaterial(l),this._outlineStickImposterMaterial=new g.StickImposterOutlineMaterial(l),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(l){l&&(l.strength&&(this._AOstrength=l.strength),l.scale&&(this._AOradius=l.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var l=this._canvas.width/this.cols,s=this._canvas.height/this.rows;this._viewportWidth=l,this._viewportHeight=s,this.isLost()||(this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(l*this.col,s*this.row,l,s),this._gl.viewport(l*this.col,s*this.row,l,s))}}setSize(l,s){if(this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._antialias&&this.devicePixelRatio<2&&(this.devicePixelRatio*=2),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var v=l/this.cols,w=s/this.rows;this._canvas.width=l*this.devicePixelRatio,this._canvas.height=s*this.devicePixelRatio,this._viewportWidth=v*this.devicePixelRatio,this._viewportHeight=w*this.devicePixelRatio,this._canvas.style.width=l+"px",this._canvas.style.height=s+"px",this.setViewport()}else this._viewportWidth=this._canvas.width=l*this.devicePixelRatio,this._viewportHeight=this._canvas.height=s*this.devicePixelRatio,this._canvas.style.width=l+"px",this._canvas.style.height=s+"px",this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight);this.initFrameBuffer()}clear(l,s,v){var w=0;(l===void 0||l)&&(w|=this._gl.COLOR_BUFFER_BIT),(s===void 0||s)&&(w|=this._gl.DEPTH_BUFFER_BIT),(v===void 0||v)&&(w|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(w)}setMaterialFaces(l,s){var v=l.side===c.DoubleSide,w=l.side===c.BackSide;l.imposter||(w=s?!w:w),this._oldDoubleSided!==v&&(v?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=v),this._oldFlipSided!==w&&(w?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=w),this._gl.cullFace(this._gl.BACK)}setDepthTest(l){this._oldDepthTest!==l&&(l?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=l)}setDepthWrite(l){this._oldDepthWrite!==l&&(this._gl.depthMask(l),this._oldDepthWrite=l)}setBlending(l){l?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(l,s,v,w){l.addEventListener("dispose",this.onMaterialDispose.bind(this));var E,C;if(C=l.shaderID,C){var h=S.ShaderLib[C];l.vertexShader=h.vertexShader,l.fragmentShader=h.fragmentShader,l.uniforms=S.ShaderUtils.clone(h.uniforms),l.shaded&&l.makeShaded(this.SHADE_TEXTURE)}E={wireframe:l.wireframe,fragdepth:l.imposter,volumetric:l.volumetric,shaded:l.shaded},l.program=this.buildProgram(l.fragmentShader,l.vertexShader,l.uniforms,E)}renderBuffer(l,s,v,w,E,C){if(w.visible){var h,x;if(h=this.setProgram(l,s,v,w,C,this),!!h){x=h.attributes;var k=!1,M=w.wireframe?1:0,D=E.id*16777215+h.id*2+M;D!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=D,k=!0),k&&(this.disableAttributes(),x.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglVertexBuffer),this.enableAttribute(x.position),this._gl.vertexAttribPointer(x.position,3,this._gl.FLOAT,!1,0,0)),x.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglColorBuffer),this.enableAttribute(x.color),this._gl.vertexAttribPointer(x.color,3,this._gl.FLOAT,!1,0,0)),x.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglNormalBuffer),this.enableAttribute(x.normal),this._gl.vertexAttribPointer(x.normal,3,this._gl.FLOAT,!1,0,0)),x.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglOffsetBuffer),this.enableAttribute(x.offset),this._gl.vertexAttribPointer(x.offset,3,this._gl.FLOAT,!1,0,0)),x.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglRadiusBuffer),this.enableAttribute(x.radius),this._gl.vertexAttribPointer(x.radius,1,this._gl.FLOAT,!1,0,0)));var P,F;if(C instanceof p.Mesh){if(w.shaderID==="instanced"){var X=w.sphere.geometryGroups[0];k&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,X.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,X.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,E.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,X.faceArray,this._gl.STATIC_DRAW)),P=X.faceidx,this._extInstanced.vertexAttribDivisorANGLE(x.offset,1),this._extInstanced.vertexAttribDivisorANGLE(x.radius,1),this._extInstanced.vertexAttribDivisorANGLE(x.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,P,this._gl.UNSIGNED_SHORT,0,E.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(x.offset,0),this._extInstanced.vertexAttribDivisorANGLE(x.radius,0),this._extInstanced.vertexAttribDivisorANGLE(x.color,0)}else w.wireframe?(F=E.lineidx,this.setLineWidth(w.wireframeLinewidth),k&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,E.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,F,this._gl.UNSIGNED_SHORT,0)):(P=E.faceidx,k&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,E.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,P,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=P,this.info.render.faces+=P/3}else C instanceof p.Line&&(F=E.vertices,this.setLineWidth(w.linewidth),this._gl.drawArrays(this._gl.LINES,0,F),this.info.render.calls++)}}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(l,s,v){let w=l.__lights,E=l.fog,C=[];for(let k=0,M=l.__webglObjects.length;k<M;k++){let D=l.__webglObjects[k];D.render&&D[v]&&C.push(D)}if(C.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(l.__webglObjects,!0,v+"Depth",s,w,E,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let h=this._AOshader.uniforms;this._gl.uniform1f(h.total_strength,this._AOstrength),this._gl.uniform1f(h.radius,this._AOradius),this._fullProjModelMatrix=new _.Matrix4,this._fullProjModelMatrixInv=new _.Matrix4;let x=C[0].object;this._fullProjModelMatrix.multiplyMatrices(s.projectionMatrix,x._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(h.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(h.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(l,s){if(!(s instanceof o.Camera)){console.error("Renderer.render: camera is not an instance of Camera.");return}var v,w,E,C,h,x=l.__lights,k=l.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&l.updateMatrixWorld(),s.parent===void 0&&s.updateMatrixWorld(),s.matrixWorldInverse.getInverse(s.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(l),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),h=l.__webglObjects;let M=!1,D=this._AOEnabled;for(v=0,w=h.length;v<w;v++)E=h[v],C=E.object,E.render=!1,C.visible&&(this.setupMatrices(C,s),this.unrollBufferMaterial(E),E.render=!0,E.volumetric&&(M=!0),E.hasAO&&(D=!0));this.setBlending(!1),D&&this.setShading(l,s,"opaque"),this.renderObjects(l.__webglObjects,!0,"opaque",s,x,k,!1),D&&this.clearShading(),this.renderSprites(l,s,!1),this.renderObjects(l.__webglObjects,!0,"transparentDepth",s,x,k,!0),this.renderObjects(l.__webglObjects,!1,"transparent",s,x,k,!0),M&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(l.__webglObjects,!1,"volumetric",s,x,k,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(l,s,!0)}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let l=this._viewportWidth,s=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,l,s),this._gl.viewport(0,0,l,s),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,l,s,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,l,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,l,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,l,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let l=this._viewportWidth,s=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,l,s),this._gl.viewport(0,0,l,s),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var v=this._antialias?S.ShaderLib.screenaa:S.ShaderLib.screen;this._screenshader=this.buildProgram(v.fragmentShader,v.vertexShader,v.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition");var w=[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1];this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(w),this._gl.STATIC_DRAW);let E=S.ShaderLib.ssao;this._AOshader=this.buildProgram(E.fragmentShader,E.vertexShader,E.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let C=S.ShaderLib.blur;this._blurshader=this.buildProgram(C.fragmentShader,C.vertexShader,C.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(l){if(l.__webglObjects||(l.__webglObjects=[],l.__webglObjectsImmediate=[],l.__webglSprites=[],l.__webglFlares=[]),l.__objectsAdded.length){for(;l.__objectsAdded.length;)this.addObject(l.__objectsAdded[0],l),l.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;l.__objectsRemoved.length;)this.removeObject(l.__objectsRemoved[0],l),l.__objectsRemoved.splice(0,1);for(var s=0,v=l.__webglObjects.length;s<v;s++)this.updateObject(l.__webglObjects[s].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(l,s){(l==null||s==null)&&(l=this._canvas.width,s=this._canvas.height);var v=l/s;if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var w=l/this.cols,E=s/this.rows;v=w/E}return v}setTexture(l,s,v){if(l.needsUpdate){l.__webglInit||(l.__webglInit=!0,l.addEventListener("dispose",this.onTextureDispose.bind(this)),l.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+s);var w=v?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(w,l.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,l.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,l.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,l.unpackAlignment);var E=this.paramToGL(l.format),C=this.paramToGL(l.type);if(v)this.setTextureParameters(this._gl.TEXTURE_3D,l),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,l.image.size.z,l.image.size.y,l.image.size.x,0,this._gl.RED,this._gl.FLOAT,l.image.data);else{var h=l.image,x=h.width,k=h.height;typeof x>"u"&&(x=h.length,E==this._gl.RGBA&&(x/=4),k=1),this.setTextureParameters(this._gl.TEXTURE_2D,l),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,E,E,C,l.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,E,x,k,0,E,C,l.image)}l.needsUpdate=!1,l.onUpdate&&l.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+s),v?this._gl.bindTexture(this._gl.TEXTURE_3D,l.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,l.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(l){this._enabledAttributes[l]||(this._gl.enableVertexAttribArray(l),this._enabledAttributes[l]=!0)}disableAttributes(){for(let l in this._enabledAttributes)this._enabledAttributes[l]&&(this._gl.disableVertexAttribArray(l),this._enabledAttributes[l]=!1)}setPolygonOffset(l,s,v){this._oldPolygonOffset!==l&&(l?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(l){l!==this._oldLineWidth&&(this._gl.lineWidth(l),this._oldLineWidth=l)}deallocateGeometry(l){if(l.__webglInit=void 0,l.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(l.__webglVertexBuffer),l.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(l.__webglColorBuffer),l.geometryGroups!==void 0)for(var s=0,v=l.groups;s<v;s++){var w=l.geometryGroups[s];w.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(w.__webglVertexBuffer),w.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(w.__webglColorBuffer),w.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(w.__webglNormalBuffer),w.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(w.__webglFaceBuffer),w.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(w.__webglLineBuffer)}}deallocateMaterial(l){var s=l.program;if(s!==void 0){l.program=void 0;var v,w,E,C=!1;for(v=0,w=this._programs.length;v<w;v++)if(E=this._programs[v],E.program===s){E.usedTimes--,E.usedTimes===0&&(C=!0);break}if(C===!0){var h=[];for(v=0,w=this._programs.length;v<w;v++)E=this._programs[v],E.program!==s&&h.push(E);this._programs=h,this._gl.deleteProgram(s),this.info.memory.programs--}}}deallocateTexture(l){if(l.image&&l.image.__webglTextureCube)this._gl.deleteTexture(l.image.__webglTextureCube);else{if(!l.__webglInit)return;l.__webglInit=!1,this._gl.deleteTexture(l.__webglTexture)}}onGeometryDispose(l){var s=l.target;s.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(s),this.info.memory.geometries--}onTextureDispose(l){var s=l.target;s.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(s),this.info.memory.textures--}onMaterialDispose(l){var s=l.target;s.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(s)}getShader(l,s){var v;return!this.isWebGL1()&&!s.startsWith("#version")&&(s=s.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),l=="fragment"?s=s.replace(/varying/g,"in"):s=s.replace(/varying/g,"out"),s=s.replace(/attribute/g,"in"),s=s.replace(/texture2D/g,"texture"),s=s.replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;"),s=s.replace(/gl_FragColor/g,"glFragColor"),s=`#version 300 es
`+s),l==="fragment"?v=this._gl.createShader(this._gl.FRAGMENT_SHADER):l==="vertex"&&(v=this._gl.createShader(this._gl.VERTEX_SHADER)),v==null?null:(this._gl.shaderSource(v,s),this._gl.compileShader(v),this._gl.getShaderParameter(v,this._gl.COMPILE_STATUS)?v:(console.error(this._gl.getShaderInfoLog(v)),console.error("could not initialize shader"),null))}buildProgram(l,s,v,w){var E,C,h,x,k=[];k.push(l),k.push(s);for(E in w)k.push(E),k.push(w[E]);for(x=k.join(),E=0,C=this._programs.length;E<C;E++){var M=this._programs[E];if(M.code===x)return M.usedTimes++,M.program}if(this.isWebGL1()&&w.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if(h=this._gl.createProgram(),h==null)return null;var D=this._precision,P="precision "+D+" float;",F=[w.volumetric?"#version 300 es":"",P].join(`
`),X=[w.volumetric?"#version 300 es":"",w.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",w.shaded?"#define SHADED 1":"",w.wireframe?"#define WIREFRAME 1":"",P].join(`
`),B=this.getShader("fragment",X+l),L=this.getShader("vertex",F+s);L!=null&&this._gl.attachShader(h,L),B!=null&&this._gl.attachShader(h,B),this._gl.linkProgram(h),this._gl.getProgramParameter(h,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),h.uniforms={},h.attributes={};var H,U,Y;H=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix"];for(U in v)H.push(U);for(Y=0;Y<H.length;Y++){var W=H[Y];h.uniforms[W]=this._gl.getUniformLocation(h,W)}for(H=["position","normal","color","lineDistance","offset","radius"],Y=0;Y<H.length;Y++){var q=H[Y];h.attributes[q]=this._gl.getAttribLocation(h,q)}return h.id=this._programs_counter++,this._programs.push({program:h,code:x,usedTimes:1}),this.info.memory.programs=this._programs.length,h}setProgram(l,s,v,w,E,C){if(w.needsUpdate&&(w.program&&this.deallocateMaterial(w),this.initMaterial(w,s,v,E),w.needsUpdate=!1),w.program==null)return null;var h=!1,x=w.program,k=x.uniforms,M=w.uniforms;if(x!=this._currentProgram&&(this._gl.useProgram(x),this._currentProgram=x,h=!0),w.id!=this._currentMaterialId&&(this._currentMaterialId=w.id,h=!0),l!=this._currentCamera&&(this._currentCamera=l,h=!0),k.projectionMatrix&&this._gl.uniformMatrix4fv(k.projectionMatrix,!1,l.projectionMatrix.elements),k.modelViewMatrix&&this._gl.uniformMatrix4fv(k.modelViewMatrix,!1,E._modelViewMatrix.elements),k.normalMatrix&&this._gl.uniformMatrix3fv(k.normalMatrix,!1,E._normalMatrix.elements),k.projinv&&(this._projInverse.getInverse(l.projectionMatrix),this._gl.uniformMatrix4fv(k.projinv,!1,this._projInverse.elements)),k.viewMatrix&&this._gl.uniformMatrix4fv(k.viewMatrix,!1,l.matrixWorldInverse.elements),h){if(M.fogColor.value=v.color,M.fogNear.value=v.near,M.fogFar.value=v.far,w.shaderID.startsWith("lambert")||w.shaderID==="instanced"||w.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(x,s),this._lightsNeedUpdate=!1),M.directionalLightColor.value=this._lights.directional.colors,M.directionalLightDirection.value=this._lights.directional.positions;else if(w.shaderID.endsWith("outline"))M.outlineColor.value=w.outlineColor,M.outlineWidth.value=w.outlineWidth,M.outlinePushback.value=w.outlinePushback;else if(w.shaderID==="volumetric"){E._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(E._modelViewMatrix),this._projInverse.getInverse(l.projectionMatrix),this._textureMatrix.multiplyMatrices(E.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(k.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(k.projinv,!1,this._projInverse.elements);let D=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);M.step.value=E.material.unit*D,M.maxdepth.value=E.material.maxdepth*D,M.transfermax.value=E.material.transfermax,M.transfermin.value=E.material.transfermin,M.subsamples.value=E.material.subsamples,C.setTexture(E.material.transferfn,4,!1),C.setTexture(E.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}M.opacity.value=w.opacity,this.loadMaterialUniforms(k,M)}return M.shading&&(M.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),x}loadMaterialUniforms(l,s){var v,w,E,C;for(v in s)l[v]&&(w=s[v].type,E=s[v].value,C=l[v],w==="f"?this._gl.uniform1f(C,E):w==="i"?this._gl.uniform1i(C,E):w==="fv"?this._gl.uniform3fv(C,E):w==="c"?this._gl.uniform3f(C,E.r,E.g,E.b):w==="f4"&&this._gl.uniform4f(C,E[0],E[1],E[2],E[3]))}addObject(l,s){var v,w,E,C;if(!l.__webglInit&&(l.__webglInit=!0,l._modelViewMatrix=new _.Matrix4,l._normalMatrix=new _.Matrix3,l.geometry!==void 0&&l.geometry.__webglInit===void 0&&(l.geometry.__webglInit=!0,l.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),l instanceof p.Mesh||l instanceof p.Line))for(E=l.geometry,v=0,w=E.geometryGroups.length;v<w;v++)C=E.geometryGroups[v],C.id=this._geometryGroupCounter++,C.__webglVertexBuffer||(l instanceof p.Mesh?(this.createMeshBuffers(C),E.elementsNeedUpdate=!0,E.normalsNeedUpdate=!0):l instanceof p.Line&&this.createLineBuffers(C),E.verticesNeedUpdate=!0,E.colorsNeedUpdate=!0);if(!l.__webglActive){if(l instanceof p.Mesh||l instanceof p.Line)for(E=l.geometry,v=0,w=E.geometryGroups.length;v<w;v++)C=E.geometryGroups[v],this.addBuffer(s.__webglObjects,C,l);else l instanceof p.Sprite&&s.__webglSprites.push(l);l.__webglActive=!0}}updateObject(l){var s=l.geometry,v;if(l instanceof p.Mesh||l instanceof p.Line){for(var w=0,E=s.geometryGroups.length;w<E;w++)v=s.geometryGroups[w],(s.verticesNeedUpdate||s.elementsNeedUpdate||s.colorsNeedUpdate||s.normalsNeedUpdate)&&this.setBuffers(v,this._gl.STATIC_DRAW);s.verticesNeedUpdate=!1,s.elementsNeedUpdate=!1,s.normalsNeedUpdate=!1,s.colorsNeedUpdate=!1,s.buffersNeedUpdate=!1}}removeObject(l,s){l instanceof p.Mesh||l instanceof p.Line?this.removeInstances(s.__webglObjects,l):l instanceof p.Sprite&&this.removeInstancesDirect(s.__webglSprites,l),l.__webglActive=!1}removeInstances(l,s){for(var v=l.length-1;v>=0;--v)l[v].object===s&&l.splice(v,1)}removeInstancesDirect(l,s){for(var v=l.length-1;v>=0;--v)l[v]===s&&l.splice(v,1)}unrollBufferMaterial(l){var s=l.object,v=s.material;if(v.volumetric)l.opaque=null,l.transparent=null,l.volumetric=v;else if(v.transparent){if(l.opaque=null,l.volumetric=null,l.transparent=v,!v.wireframe){let w=v.clone();w.opacity=0,l.transparentDepth=w}}else{if(l.opaque=v,l.transparent=null,l.volumetric=null,!v.wireframe){let w=v.clone();w.opacity=0,l.opaqueDepth=w}v.hasAO&&(l.hasAO=!0),(this._AOEnabled||l.hasAO)&&(l.opaqueShaded=v.clone(),l.opaqueShaded.shaded=!0)}}setBuffers(l,s){var v=l.vertexArray,w=l.colorArray;if(l.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,v,s)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,v,s)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,w,s),l.normalArray&&l.__webglNormalBuffer!==void 0){var E=l.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,E,s)}if(l.radiusArray&&l.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,l.radiusArray,s)),l.faceArray&&l.__webglFaceBuffer!==void 0){var C=l.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,l.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,C,s)}if(l.lineArray&&l.__webglLineBuffer!==void 0){var h=l.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,l.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,h,s)}}createMeshBuffers(l){l.radiusArray&&(l.__webglRadiusBuffer=this._gl.createBuffer()),l.useOffset&&(l.__webglOffsetBuffer=this._gl.createBuffer()),l.__webglVertexBuffer=this._gl.createBuffer(),l.__webglNormalBuffer=this._gl.createBuffer(),l.__webglColorBuffer=this._gl.createBuffer(),l.__webglFaceBuffer=this._gl.createBuffer(),l.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(l){l.__webglVertexBuffer=this._gl.createBuffer(),l.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(l,s,v){l.push({buffer:s,object:v,opaque:null,transparent:null})}setupMatrices(l,s){l._modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,l.matrixWorld),l._normalMatrix.getInverse(l._modelViewMatrix),l._normalMatrix.transpose()}filterFallback(l){return this._gl.LINEAR}setTextureParameters(l,s){l==this._gl.TEXTURE_2D?(this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(s.magFilter)),this._gl.texParameteri(l,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(s.minFilter))):(this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(l,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(l,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(l,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(l,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(l){return l===u.UnsignedByteType?this._gl.UNSIGNED_BYTE:l===u.RGBAFormat?this._gl.RGBA:l===u.NearestFilter?this._gl.NEAREST:0}setupLights(l,s){var v,w,E,C=0,h=0,x=0,k,M,D=this._lights,P=D.directional.colors,F=D.directional.positions,X=0,B=0;for(v=0,w=s.length;v<w;v++)if(E=s[v],k=E.color,M=E.intensity,E instanceof y.Light){if(this._direction.getPositionFromMatrix(E.matrixWorld),this._vector3.getPositionFromMatrix(E.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;F[B]=this._direction.x,F[B+1]=this._direction.y,F[B+2]=this._direction.z,P[B]=k.r*M,P[B+1]=k.g*M,P[B+2]=k.b*M,B+=3,X++}D.ambient[0]=C,D.ambient[1]=h,D.ambient[2]=x,D.directional.length=X}initGL(){try{if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context.";var l=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(l[6])}catch(s){console.error(s)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearColor(0,0,0,1),this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(l,s,v,w,E,C,h){var x,k,M,D,P,F,X;s?(P=l.length-1,F=-1,X=-1):(P=0,F=l.length,X=1);for(var B=P;B!==F;B+=X)if(x=l[B],x.render){if(k=x.object,M=x.buffer,D=x[v],(x.hasAO||this._AOEnabled)&&x[v+"Shaded"]&&(D=x[v+"Shaded"]),!D)continue;h&&this.setBlending(!0),this.setDepthTest(D.depthTest),this.setDepthWrite(D.depthWrite),this.setPolygonOffset(D.polygonOffset,D.polygonOffsetFactor,D.polygonOffsetUnits);var L=k._modelViewMatrix.isReflected();if(this.setMaterialFaces(D,L),this.renderBuffer(w,E,C,D,M,k),(this._outlineEnabled||D.outline)&&!D.wireframe&&D.shaderID!=="basic"&&D.opacity!==0){let H=this._outlineMaterial;D.shaderID=="sphereimposter"?H=this._outlineSphereImposterMaterial:D.shaderID=="stickimposter"&&(H=this._outlineStickImposterMaterial),this.renderBuffer(w,E,C,H,M,k)}}}renderSprites(l,s,v){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(l,s,this._currentWidth,this._currentHeight,v),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}}),"./src/WebGL/SpritePlugin.ts":((e,r,t)=>{t.r(r),t.d(r,{SpritePlugin:()=>c});var o=t("./src/WebGL/shaders/index.ts");class c{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(f){this.gl=f.context,this.renderer=f,this.precision=f.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var g=0;this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=1,g=0,this.sprite.faces[g++]=0,this.sprite.faces[g++]=1,this.sprite.faces[g++]=2,this.sprite.faces[g++]=0,this.sprite.faces[g++]=2,this.sprite.faces[g++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(o.ShaderLib.sprite,this.precision||1),this.sprite.attributes={};const _={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),_.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),_.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),_.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),_.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),_.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),_.color=this.gl.getUniformLocation(this.sprite.program,"color"),_.map=this.gl.getUniformLocation(this.sprite.program,"map"),_.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),_.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),_.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),_.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),_.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),_.fogType=this.gl.getUniformLocation(this.sprite.program,"fogType"),_.fogDensity=this.gl.getUniformLocation(this.sprite.program,"fogDensity"),_.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),_.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),_.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),_.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=_}render(f,g,_,p,S){var A,R,z,l,s,v,w,E,C,h;if(!this.gl)throw new Error("WebGLRenderer not initialized");let x=[];(A=f?.__webglSprites)===null||A===void 0||A.forEach(xe=>{(S&&xe.material.depthTest==!1||!S&&xe.material.depthTest)&&x.push(xe)});let k=x.length;if(!k)return;const M=this.sprite.attributes,D=this.sprite.uniforms;if(!D)throw new Error("Uniforms not defined");var P=_*.5,F=p*.5;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(M.position),this.gl.enableVertexAttribArray(M.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(M.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(M.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(D.projectionMatrix,!1,g.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(D.map,0);var X=0,B=0,L=f.fog;L?(this.gl.uniform3f(D.fogColor,L.color.r,L.color.g,L.color.b),this.gl.uniform1f(D.fogNear,L.near),this.gl.uniform1f(D.fogFar,L.far),this.gl.uniform1i(D.fogType,1),X=1,B=1):(this.gl.uniform1i(D.fogType,0),X=0,B=0);var H;let U,Y,W,q,G=[];for(H=0;H<k;H++)U=x[H],Y=U.material,Y&&(Y.depthTest==!1&&!S||!U.visible||Y.opacity===0||(Y.useScreenCoordinates?U.z=-U.position.z:(U._modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,U.matrixWorld),U.z=-U._modelViewMatrix.elements[14])));for(x.sort(u),H=0;H<k;H++)if(U=x[H],Y=U.material,!!Y&&!(!U.visible||Y.opacity===0)&&Y.map&&Y.map.image&&Y.map.image.width){this.gl.uniform1f(D?.alphaTest||null,Y.alphaTest);var $=Y.map.image.width,Z=Y.map.image.height;G[0]=$*this.renderer.devicePixelRatio/_,G[1]=Z*this.renderer.devicePixelRatio/p,Y.useScreenCoordinates===!0?(this.gl.uniform1i(D.useScreenCoordinates,1),this.gl.uniform3f(D.screenPosition,(U.position.x*this.renderer.devicePixelRatio-P)/P,(F-U.position.y*this.renderer.devicePixelRatio)/F,Math.max(0,Math.min(1,U.position.z)))):(this.gl.uniform1i(D.useScreenCoordinates,0),this.gl.uniformMatrix4fv(D.modelViewMatrix,!1,U._modelViewMatrix.elements)),f.fog&&Y.fog?q=B:q=0,X!==q&&(this.gl.uniform1i(D.fogType,q),X=q),W=1/(Y.scaleByViewport?p:1),G[0]*=W*U.scale.x,G[1]*=W*U.scale.y;let xe=(R=Y?.alignment)===null||R===void 0?void 0:R.x,ce=(z=Y?.alignment)===null||z===void 0?void 0:z.y;Y.screenOffset&&(xe=(xe||0)+2*Y.screenOffset.x/$,ce=(ce||0)+2*Y.screenOffset.y/Z),this.gl.uniform2f(D.uvScale,((l=Y?.uvScale)===null||l===void 0?void 0:l.x)||1,((s=Y?.uvScale)===null||s===void 0?void 0:s.y)||1),this.gl.uniform2f(D.uvOffset,((v=Y?.uvOffset)===null||v===void 0?void 0:v.x)||0,((w=Y?.uvOffset)===null||w===void 0?void 0:w.y)||0),this.gl.uniform2f(D.alignment,xe||0,ce||0),this.gl.uniform1f(D.opacity,Y.opacity),this.gl.uniform3f(D.color,((E=Y?.color)===null||E===void 0?void 0:E.r)||0,((C=Y?.color)===null||C===void 0?void 0:C.g)||0,((h=Y?.color)===null||h===void 0?void 0:h.b)||0),this.gl.uniform1f(D.rotation,U.rotation),this.gl.uniform2fv(D.scale,G),this.renderer.setDepthTest(Y.depthTest),this.renderer.setDepthWrite(Y.depthWrite),this.renderer.setTexture(Y.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(f,g){if(!this.gl)throw new Error("WebGL Rendering context not found");var _=this.gl.createProgram();if(!_)throw new Error("Error creating webgl program");var p=this.gl.createShader(this.gl.FRAGMENT_SHADER),S=this.gl.createShader(this.gl.VERTEX_SHADER);if(!p)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!S)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var A="precision "+g+` float;
`;if(this.gl.shaderSource(p,A+f.fragmentShader),this.gl.shaderSource(S,A+f.vertexShader),this.gl.compileShader(p),this.gl.compileShader(S),!this.gl.getShaderParameter(p,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(S,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(p)} 
      ${this.gl.getShaderInfoLog(S)}`);return this.gl.attachShader(_,p),this.gl.attachShader(_,S),this.gl.linkProgram(_),this.gl.getProgramParameter(_,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),_}}function u(y,f){return y.z!==f.z?f.z-y.z:f.id-y.id}}),"./src/WebGL/constants/Coloring.ts":((e,r,t)=>{t.r(r),t.d(r,{Coloring:()=>o});var o;(function(c){c[c.NoColors=0]="NoColors",c[c.FaceColors=1]="FaceColors",c[c.VertexColors=2]="VertexColors"})(o||(o={}))}),"./src/WebGL/constants/Shading.ts":((e,r,t)=>{t.r(r),t.d(r,{Shading:()=>o});var o;(function(c){c[c.NoShading=0]="NoShading",c[c.FlatShading=1]="FlatShading",c[c.SmoothShading=2]="SmoothShading"})(o||(o={}))}),"./src/WebGL/constants/Sides.ts":((e,r,t)=>{t.r(r),t.d(r,{BackSide:()=>c,DoubleSide:()=>u,FrontSide:()=>o});const o=0,c=1,u=2}),"./src/WebGL/constants/SpriteAlignment.ts":((e,r,t)=>{t.r(r),t.d(r,{SpriteAlignment:()=>c});var o=t("./src/WebGL/math/index.ts");const c={topLeft:new o.Vector2(1,-1),topCenter:new o.Vector2(0,-1),topRight:new o.Vector2(-1,-1),centerLeft:new o.Vector2(1,0),center:new o.Vector2(0,0),centerRight:new o.Vector2(-1,0),bottomLeft:new o.Vector2(1,1),bottomCenter:new o.Vector2(0,1),bottomRight:new o.Vector2(-1,1)}}),"./src/WebGL/constants/TextureConstants.ts":((e,r,t)=>{t.r(r),t.d(r,{ClampToEdgeWrapping:()=>o,FloatType:()=>g,LinearFilter:()=>c,LinearMipMapLinearFilter:()=>y,NearestFilter:()=>u,R32Format:()=>S,RFormat:()=>p,RGBAFormat:()=>_,UnsignedByteType:()=>f});const o=1001,c=1006,u=1007,y=1008,f=1009,g=1010,_=1021,p=1022,S=1023}),"./src/WebGL/constants/TextureOperations.ts":((e,r,t)=>{t.r(r),t.d(r,{TextureOperations:()=>o});var o;(function(c){c[c.MultiplyOperation=0]="MultiplyOperation",c[c.MixOperation=1]="MixOperation",c[c.AddOperation=2]="AddOperation"})(o||(o={}))}),"./src/WebGL/constants/index.ts":((e,r,t)=>{t.r(r),t.d(r,{BackSide:()=>c.BackSide,ClampToEdgeWrapping:()=>f.ClampToEdgeWrapping,Coloring:()=>o.Coloring,DoubleSide:()=>c.DoubleSide,FloatType:()=>f.FloatType,FrontSide:()=>c.FrontSide,LinearFilter:()=>f.LinearFilter,LinearMipMapLinearFilter:()=>f.LinearMipMapLinearFilter,NearestFilter:()=>f.NearestFilter,R32Format:()=>f.R32Format,RFormat:()=>f.RFormat,RGBAFormat:()=>f.RGBAFormat,Shading:()=>u.Shading,SpriteAlignment:()=>y.SpriteAlignment,TextureOperations:()=>g.TextureOperations,UnsignedByteType:()=>f.UnsignedByteType});var o=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Sides.ts"),u=t("./src/WebGL/constants/Shading.ts"),y=t("./src/WebGL/constants/SpriteAlignment.ts"),f=t("./src/WebGL/constants/TextureConstants.ts"),g=t("./src/WebGL/constants/TextureOperations.ts")}),"./src/WebGL/core/EventDispatcher.ts":((e,r,t)=>{t.r(r),t.d(r,{EventDispatcher:()=>o});class o{constructor(){this.listeners={}}dispatchEvent(u){var y=this.listeners[u.type];if(y!==void 0){u.target=this;for(var f=0,g=y.length;f<g;f++)y[f].call(this,u)}}removeEventListener(u,y){if(!y)this.listeners[u]=[];else{var f=this.listeners[u].indexOf(y);f!==-1&&this.listeners[u].splice(f,1)}}addEventListener(u,y){this.listeners[u]===void 0&&(this.listeners[u]=[]),this.listeners[u].indexOf(y)===-1&&this.listeners[u].push(y)}}}),"./src/WebGL/core/Geometry.ts":((e,r,t)=>{t.r(r),t.d(r,{Geometry:()=>_,GeometryGroup:()=>g,GeometryIDCount:()=>p});var o=t("./src/WebGL/materials/LineBasicMaterial.ts"),c=t("./src/WebGL/core/EventDispatcher.ts"),u=t("./src/WebGL/math/index.ts"),y=t("./src/colors.ts");const f=65535;class g{constructor(A=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=A}setColors(A){var R=this.vertexArray,z=this.colorArray;if(!R)throw new Error("vertex array not initialized");if(!z)throw new Error("color array not initialized");if(R.length!=z.length){console.log("Cannot re-color geometry group due to mismatched lengths.");return}for(var l=0;l<R.length;l+=3){var s=A(R[l],R[l+1],R[l+2]);s instanceof y.Color||(s=y.CC.color(s)),z[l]=s.r,z[l+1]=s.g,z[l+2]=s.b}}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var A=new u.Vector3,R,z,l,s,v=0;v<this.vertices;++v)R=v*3,z=this.vertexArray[R],l=this.vertexArray[R+1],s=this.vertexArray[R+2],A.x+=z,A.y+=l,A.z+=s;return A.divideScalar(this.vertices),A}setNormals(){var A=this.faceArray,R=this.vertexArray,z=this.normalArray;if(!(!this.vertices||!this.faceidx)){if(!A)throw new Error("face array not initialized");if(!R)throw new Error("vertex array not initialized");if(!z)throw new Error("normal array not initialized");for(var l,s,v,w,E,C,h,x=0;x<A.length/3;++x)l=A[x*3]*3,s=A[x*3+1]*3,v=A[x*3+2]*3,w=new u.Vector3(R[l],R[l+1],R[l+2]),E=new u.Vector3(R[s],R[s+1],R[s+2]),C=new u.Vector3(R[v],R[v+1],R[v+2]),w.subVectors(w,E),C.subVectors(C,E),C.cross(w),h=C,h.normalize(),z[l]+=h.x,z[s]+=h.x,z[v]+=h.x,z[l+1]+=h.y,z[s+1]+=h.y,z[v+1]+=h.y,z[l+2]+=h.z,z[s+2]+=h.z,z[v+2]+=h.z}}setLineIndices(){if(this.faceidx&&!(this.lineArray&&this.lineArray.length==this.faceidx*2&&this.lineidx==this.faceidx*2)){var A=this.faceArray,R=this.lineArray=new Uint16Array(this.faceidx*2);if(this.lineidx=this.faceidx*2,!A)throw new Error("face array not initialized");for(var z=0;z<this.faceidx/3;++z){var l=z*3,s=l*2,v=A[l],w=A[l+1],E=A[l+2];R[s]=v,R[s+1]=w,R[s+2]=v,R[s+3]=E,R[s+4]=w,R[s+5]=E}}}vrml(A,R){var z,l,s,v,w,E,C,h,x,k,M,D,P,F,X,B,L,H,U="";if(U+=A+`Shape {
`+A+` appearance Appearance {
`+A+`  material Material {
`+A+"   diffuseColor "+((z=R?.color)===null||z===void 0?void 0:z.r)+" "+((l=R?.color)===null||l===void 0?void 0:l.g)+" "+((s=R?.color)===null||s===void 0?void 0:s.b)+`
`,R.wireframe&&this.colorArray){let W=this.colorArray;U+=A+"    emissiveColor "+W[0]+" "+W[1]+" "+W[2]+`
`}R!=null&&R.transparent&&(U+=A+"   transparency "+(1-R.opacity)+`
`),U+=A+`  }
`,U+=A+` }
`;var Y=A;if(A+=" ",R instanceof o.LineBasicMaterial||R.wireframe){U+=A+`geometry IndexedLineSet {
`+A+` colorPerVertex TRUE
`+A+` coord Coordinate {
`+A+`  point [
`;let W,q,G;for(let $=0;$<this.vertices;++$){let Z=$*3;W=(v=this.vertexArray)===null||v===void 0?void 0:v[Z],q=(w=this.vertexArray)===null||w===void 0?void 0:w[Z+1],G=(E=this.vertexArray)===null||E===void 0?void 0:E[Z+2],U+=A+"   "+W+" "+q+" "+G+`,
`}if(U+=A+`  ]
`,U+=A+` }
`,this.colorArray&&!R.wireframe){U+=A+` color Color {
`+A+`  color [
`;for(let $=0;$<this.vertices;++$){let Z=$*3;W=this.colorArray[Z],q=this.colorArray[Z+1],G=this.colorArray[Z+2],U+=A+"   "+W+" "+q+" "+G+`,
`}U+=A+`  ]
`,U+=A+` }
`}if(U+=A+` coordIndex [
`,R.wireframe&&this.faceArray)for(let $=0;$<this.faceidx;$+=3)W=(C=this.faceArray)===null||C===void 0?void 0:C[$],q=(h=this.faceArray)===null||h===void 0?void 0:h[$+1],G=(x=this.faceArray)===null||x===void 0?void 0:x[$+2],U+=A+"  "+W+", "+q+", "+G+`, -1,
`;else for(let $=0;$<this.vertices-1;$+=2)U+=A+"  "+$+", "+($+1)+`, -1,
`;U+=A+` ]
`,U+=A+`}
`}else{U+=A+`geometry IndexedFaceSet {
`+A+` colorPerVertex TRUE
`+A+` normalPerVertex TRUE
`+A+` solid FALSE
`,U+=A+` coord Coordinate {
`+A+`  point [
`;let W,q,G;for(let $=0;$<this.vertices;++$){let Z=$*3;W=(k=this.vertexArray)===null||k===void 0?void 0:k[Z],q=(M=this.vertexArray)===null||M===void 0?void 0:M[Z+1],G=(D=this.vertexArray)===null||D===void 0?void 0:D[Z+2],U+=A+"   "+W+" "+q+" "+G+`,
`}U+=A+`  ]
`,U+=A+` }
`,U+=A+` normal Normal {
`+A+`  vector [
`;for(let $=0;$<this.vertices;++$){let Z=$*3;W=(P=this.normalArray)===null||P===void 0?void 0:P[Z],q=(F=this.normalArray)===null||F===void 0?void 0:F[Z+1],G=(X=this.normalArray)===null||X===void 0?void 0:X[Z+2],U+=A+"   "+W+" "+q+" "+G+`,
`}if(U+=A+`  ]
`,U+=A+` }
`,this.colorArray){U+=A+` color Color {
`+A+`  color [
`;for(let $=0;$<this.vertices;++$){let Z=$*3;W=this.colorArray[Z],q=this.colorArray[Z+1],G=this.colorArray[Z+2],U+=A+"   "+W+" "+q+" "+G+`,
`}U+=A+`  ]
`,U+=A+` }
`}U+=A+` coordIndex [
`;for(let $=0;$<this.faceidx;$+=3)W=(B=this.faceArray)===null||B===void 0?void 0:B[$],q=(L=this.faceArray)===null||L===void 0?void 0:L[$+1],G=(H=this.faceArray)===null||H===void 0?void 0:H[$+2],U+=A+"  "+W+", "+q+", "+G+`, -1,
`;U+=A+` ]
`,U+=A+`}
`}return U+=Y+"}",U}truncateArrayBuffers(A=!0,R=!1){var z=this.vertexArray,l=this.colorArray,s=this.normalArray,v=this.faceArray,w=this.lineArray,E=this.radiusArray;this.vertexArray=z?.subarray(0,this.vertices*3)||null,this.colorArray=l?.subarray(0,this.vertices*3)||null,A?(this.normalArray=s?.subarray(0,this.vertices*3)||null,this.faceArray=v?.subarray(0,this.faceidx)||null,this.lineidx>0?this.lineArray=w?.subarray(0,this.lineidx)||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),E&&(this.radiusArray=E.subarray(0,this.vertices)),R&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class _ extends c.EventDispatcher{constructor(A=!1,R=!1,z=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=p++,this.mesh=A,this.radii=R,this.offset=z}updateGeoGroup(A=0){var R,z=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!z||z.vertices+A>(((R=z?.vertexArray)===null||R===void 0?void 0:R.length)||0)/3)&&(z=this.addGeoGroup()),z}vrml(A,R){for(var z="",l=this.geometryGroups.length,s=0;s<l;s++){var v=this.geometryGroups[s];z+=v.vrml(A,R)+`,
`}return z}addGeoGroup(){var A=new g(this.geometryGroups.length);return this.geometryGroups.push(A),this.groups=this.geometryGroups.length,A.vertexArray=new Float32Array(f*3),A.colorArray=new Float32Array(f*3),this.mesh&&(A.normalArray=new Float32Array(f*3),A.faceArray=new Uint16Array(f*6),A.lineArray=new Uint16Array(f*6)),this.radii&&(A.radiusArray=new Float32Array(f)),A.useOffset=this.offset,A}setUpNormals(...A){for(var R=0;R<this.groups;R++){var z=this.geometryGroups[R];z.setNormals(...A)}}setColors(...A){for(var R=this.geometryGroups.length,z=0;z<R;z++){var l=this.geometryGroups[z];l.setColors(...A)}}setUpWireframe(...A){for(var R=0;R<this.groups;R++){var z=this.geometryGroups[R];z.setLineIndices(...A)}}initTypedArrays(){for(var A=0;A<this.groups;A++){var R=this.geometryGroups[A];R.__inittedArrays!==!0&&R.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var A=0,R=0;R<this.groups;R++)A+=this.geometryGroups[R].vertices;return A}}let p=0}),"./src/WebGL/core/Object3D.ts":((e,r,t)=>{t.r(r),t.d(r,{Light:()=>g,Object3D:()=>y,Object3DIDCount:()=>u,Scene:()=>f});var o=t("./src/WebGL/math/index.ts"),c=t("./src/colors.ts");let u=0;class y{constructor(){this.id=u++,this.name="",this.children=[],this.position=new o.Vector3,this.rotation=new o.Vector3,this.matrix=new o.Matrix4,this.matrixWorld=new o.Matrix4,this.quaternion=new o.Quaternion,this.eulerOrder="XYZ",this.up=new o.Vector3(0,1,0),this.scale=new o.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(p){this.matrix.lookAt(p,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof o.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(p){if(p===this){console.error("Can't add $3Dmol.Object3D to itself");return}p.parent=this,this.children.push(p);for(var S=this;S.parent!==void 0;)S=S.parent;S!==void 0&&S instanceof f&&S.__addObject(p)}remove(p){var S=this.children.indexOf(p);if(S!==-1){p.parent=void 0,this.children.splice(S,1);for(var A=this;A.parent!==void 0;)A=A.parent;A!==void 0&&A instanceof f&&A.__removeObject(p)}}vrml(p){p||(p=" ");var S=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),A=0,R=0,z=0;if(S!=0){let v=Math.sin(S/2);A=this.quaternion.x/v,R=this.quaternion.y/v,z=this.quaternion.z/v}var l=p+`Transform {
`+p+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+p+" rotation "+A+" "+R+" "+z+" "+S+`
`+p+` children [
`;this.geometry&&(l+=this.geometry.vrml(p,this.material));for(var s=0;s<this.children.length;s++)l+=this.children[s].vrml(p+" ")+`,
`;return l+=` ]
`,l+="}",l}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof o.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),(this.scale.x!==1||this.scale.y!==1||this.scale.z!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(p){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||p===!0)&&(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var S=0;S<this.children.length;S++)this.children[S].updateMatrixWorld(!0)}clone(p){p===void 0&&(p=new y),p.name=this.name,p.up.copy(this.up),p.position.copy(this.position),p.rotation instanceof o.Vector3&&this.rotation instanceof o.Vector3?p.rotation.copy(this.rotation):p.rotation=this.rotation,p.eulerOrder=this.eulerOrder,p.scale.copy(this.scale),p.rotationAutoUpdate=this.rotationAutoUpdate,p.matrix.copy(this.matrix),p.matrixWorld.copy(this.matrixWorld),p.quaternion.copy(this.quaternion),p.matrixAutoUpdate=this.matrixAutoUpdate,p.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,p.useQuaternion=this.useQuaternion,p.visible=this.visible;for(var S=0;S<this.children.length;S++){var A=this.children[S];p.add(A.clone())}return p}setVisible(p){this.visible=p;for(var S=0;S<this.children.length;S++){var A=this.children[S];A.setVisible(p)}}}class f extends y{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(p){if(p instanceof g)this.__lights.indexOf(p)===-1&&this.__lights.push(p),p.target&&p.target.parent===void 0&&this.add(p.target);else if(this.__objects.indexOf(p)===-1){this.__objects.push(p),this.__objectsAdded.push(p);var S=this.__objectsRemoved.indexOf(p);S!==-1&&this.__objectsRemoved.splice(S,1)}for(var A=0;A<p.children.length;A++)this.__addObject(p.children[A])}__removeObject(p){var S;if(p instanceof g)S=this.__lights.indexOf(p),S!==-1&&this.__lights.splice(S,1);else if(S=this.__objects.indexOf(p),S!==-1){this.__objects.splice(S,1),this.__objectsRemoved.push(p);var A=this.__objectsAdded.indexOf(p);A!==-1&&this.__objectsAdded.splice(S,1)}for(var R=0;R<p.children.length;R++)this.__removeObject(p.children[R])}}class g extends y{constructor(p,S=1){super(),this.position=new o.Vector3(0,1,0),this.target=new y,this.castShadow=!1,this.onlyShadow=!1,this.color=new c.Color(p),this.intensity=S}}}),"./src/WebGL/core/Projector.ts":((e,r,t)=>{t.r(r),t.d(r,{Projector:()=>u});var o=t("./src/WebGL/math/index.ts");const c=new o.Matrix4;class u{static unprojectVector(f,g){return g.projectionMatrixInverse.getInverse(g.projectionMatrix),c.multiplyMatrices(g.matrixWorld,g.projectionMatrixInverse),f.applyProjection(c)}static projectVector(f,g){return g.matrixWorldInverse.getInverse(g.matrixWorld),c.multiplyMatrices(g.projectionMatrix,g.matrixWorldInverse),f.applyProjection(c)}projectVector(f,g){return u.projectVector(f,g)}unprojectVector(f,g){return u.unprojectVector(f,g)}}}),"./src/WebGL/core/Raycaster.ts":((e,r,t)=>{t.r(r),t.d(r,{Raycaster:()=>f,intersectObject:()=>v});var o=t("./src/WebGL/math/index.ts"),c=t("./src/WebGL/shapes/index.ts");const u=(w,E)=>w.distance-E.distance,y=new o.Matrix4;class f{constructor(E,C,h,x){this.precision=1e-4,this.linePrecision=.2,this.ray=new o.Ray(E,C),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=x||0,this.far=h||1/0}set(E,C){this.ray.set(E,C)}setFromCamera(E,C){C.ortho?(this.ray.origin.set(E.x,E.y,(C.near+C.far)/(C.near-C.far)).unproject(C),this.ray.direction.set(0,0,-1).transformDirection(C.matrixWorld)):(this.ray.origin.setFromMatrixPosition(C.matrixWorld),this.ray.direction.set(E.x,E.y,E.z),C.projectionMatrixInverse.getInverse(C.projectionMatrix),y.multiplyMatrices(C.matrixWorld,C.projectionMatrixInverse),this.ray.direction.applyProjection(y),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(E,C){for(var h=[],x=0,k=C.length;x<k;x++)v(E,C[x],this,h);return h.sort(u),h}}const g=w=>Math.min(Math.max(w,-1),1);var _=new c.Sphere,p=new c.Cylinder,S=new c.Triangle,A=new o.Vector3,R=new o.Vector3,z=new o.Vector3,l=new o.Vector3,s=new o.Vector3;function v(w,E,C,h){if(s.getPositionFromMatrix(w.matrixWorld),E.intersectionShape===void 0)return h;var x=E.intersectionShape,k=C.linePrecision;k*=w.matrixWorld.getMaxScaleOnAxis();var M=k*k;if(E.boundingSphere!==void 0&&E.boundingSphere instanceof c.Sphere&&(_.copy(E.boundingSphere),_.applyMatrix4(w.matrixWorld),!C.ray.isIntersectionSphere(_)))return h;var D,P,F,X,B,L,H,U,Y,W,q,G,$,Z;for(D=0,P=x.triangle.length;D<P;D++)if(x.triangle[D]instanceof c.Triangle){if(S.copy(x.triangle[D]),S.applyMatrix4(w.matrixWorld),F=S.getNormal(),X=C.ray.direction.dot(F),X>=0||(A.subVectors(S.a,C.ray.origin),H=F.dot(A)/X,H<0))continue;R.copy(C.ray.direction).multiplyScalar(H).add(C.ray.origin),R.sub(S.a),z.copy(S.b).sub(S.a),l.copy(S.c).sub(S.a);var xe=z.dot(l),ce=z.lengthSq(),Ne=l.lengthSq();if(G=(ce*R.dot(l)-xe*R.dot(z))/(ce*Ne-xe*xe),G<0||G>1||(q=(R.dot(z)-G*xe)/ce,q<0||q>1||q+G>1))continue;h.push({clickable:E,distance:H})}for(D=0,P=x.cylinder.length;D<P;D++)if(x.cylinder[D]instanceof c.Cylinder){if(p.copy(x.cylinder[D]),p.applyMatrix4(w.matrixWorld),A.subVectors(p.c1,C.ray.origin),B=A.dot(p.direction),L=A.dot(C.ray.direction),X=g(C.ray.direction.dot(p.direction)),Y=1-X*X,Y===0)continue;$=(X*L-B)/Y,Z=(L-X*B)/Y,R.copy(p.direction).multiplyScalar($).add(p.c1),z.copy(C.ray.direction).multiplyScalar(Z).add(C.ray.origin),U=l.subVectors(R,z).lengthSq();var Pe=p.radius*p.radius;if(U<=Pe){if(W=(X*B-L)*(X*B-L)-Y*(A.lengthSq()-B*B-Pe),W<=0?G=H=Math.sqrt(U):G=H=(L-X*B-Math.sqrt(W))/Y,q=X*G-B,q<0||q*q>p.lengthSq()||G<0)continue;h.push({clickable:E,distance:H})}}for(D=0,P=x.line.length;D<P;D+=2){R.copy(x.line[D]),R.applyMatrix4(w.matrixWorld),z.copy(x.line[D+1]),z.applyMatrix4(w.matrixWorld),l.subVectors(z,R);var De=l.lengthSq();l.normalize(),A.subVectors(R,C.ray.origin);var Me=A.dot(l);L=A.dot(C.ray.direction),X=g(C.ray.direction.dot(l)),Y=1-X*X,Y!==0&&($=(X*L-Me)/Y,Z=(L-X*Me)/Y,R.add(l.multiplyScalar($)),z.copy(C.ray.direction).multiplyScalar(Z).add(C.ray.origin),U=l.subVectors(z,R).lengthSq(),U<M&&$*$<De&&h.push({clickable:E,distance:Z}))}for(D=0,P=x.sphere.length;D<P;D++)if(x.sphere[D]instanceof c.Sphere&&(_.copy(x.sphere[D]),_.applyMatrix4(w.matrixWorld),C.ray.isIntersectionSphere(_))){R.subVectors(_.center,C.ray.origin);var Be=R.dot(C.ray.direction);if(W=Be*Be-(R.lengthSq()-_.radius*_.radius),Be<0)return h;W<=0?H=Be:H=Be-Math.sqrt(W),h.push({clickable:E,distance:H})}return h}}),"./src/WebGL/core/Texture.ts":((e,r,t)=>{t.r(r),t.d(r,{Texture:()=>f,TextureIdCount:()=>g});var o=t("./src/WebGL/constants/TextureConstants.ts"),c=t("./src/WebGL/math/index.ts"),u=t("./src/WebGL/core/EventDispatcher.ts"),y=t("./src/WebGL/core/UVMapping.ts");class f extends u.EventDispatcher{constructor(p,S){super(),this.id=g++,this.name="",this.image=p,this.mapping=new y.UVMapping,this.wrapS=o.ClampToEdgeWrapping,this.wrapT=o.ClampToEdgeWrapping,this.anisotropy=1,S?(this.format=o.RFormat,this.type=o.FloatType,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=o.NearestFilter,this.minFilter=o.NearestFilter):(this.format=o.RGBAFormat,this.type=o.UnsignedByteType,this.offset=new c.Vector2(0,0),this.repeat=new c.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=o.LinearFilter,this.minFilter=o.LinearMipMapLinearFilter),this.needsUpdate=!1,this.onUpdate=null}clone(p=new f){return p.image=this.image,p.mapping=this.mapping,p.wrapS=this.wrapS,p.wrapT=this.wrapT,p.magFilter=this.magFilter,p.minFilter=this.minFilter,p.anisotropy=this.anisotropy,p.format=this.format,p.type=this.type,p.offset.copy(this.offset),p.repeat.copy(this.repeat),p.premultiplyAlpha=this.premultiplyAlpha,p.flipY=this.flipY,p.unpackAlignment=this.unpackAlignment,p}dispose(){this.dispatchEvent({type:"dispose"})}}let g=0}),"./src/WebGL/core/UVMapping.ts":((e,r,t)=>{t.r(r),t.d(r,{UVMapping:()=>o});class o{}}),"./src/WebGL/core/index.ts":((e,r,t)=>{t.r(r),t.d(r,{EventDispatcher:()=>o.EventDispatcher,Geometry:()=>c.Geometry,GeometryGroup:()=>c.GeometryGroup,GeometryIDCount:()=>c.GeometryIDCount,Light:()=>u.Light,Object3D:()=>u.Object3D,Object3DIDCount:()=>u.Object3DIDCount,Projector:()=>y.Projector,Raycaster:()=>f.Raycaster,Scene:()=>u.Scene,Texture:()=>g.Texture,TextureIdCount:()=>g.TextureIdCount,UVMapping:()=>_.UVMapping,intersectObject:()=>f.intersectObject});var o=t("./src/WebGL/core/EventDispatcher.ts"),c=t("./src/WebGL/core/Geometry.ts"),u=t("./src/WebGL/core/Object3D.ts"),y=t("./src/WebGL/core/Projector.ts"),f=t("./src/WebGL/core/Raycaster.ts"),g=t("./src/WebGL/core/Texture.ts"),_=t("./src/WebGL/core/UVMapping.ts")}),"./src/WebGL/index.ts":((e,r,t)=>{t.r(r),t.d(r,{BackSide:()=>o.BackSide,Camera:()=>p.Camera,ClampToEdgeWrapping:()=>o.ClampToEdgeWrapping,Coloring:()=>o.Coloring,Cylinder:()=>_.Cylinder,DoubleSide:()=>o.DoubleSide,EventDispatcher:()=>c.EventDispatcher,FloatType:()=>o.FloatType,Fog:()=>S.Fog,FrontSide:()=>o.FrontSide,Geometry:()=>c.Geometry,GeometryGroup:()=>c.GeometryGroup,GeometryIDCount:()=>c.GeometryIDCount,ImposterMaterial:()=>u.ImposterMaterial,InstancedMaterial:()=>u.InstancedMaterial,Light:()=>c.Light,Line:()=>f.Line,LineBasicMaterial:()=>u.LineBasicMaterial,LineStyle:()=>f.LineStyle,LinearFilter:()=>o.LinearFilter,LinearMipMapLinearFilter:()=>o.LinearMipMapLinearFilter,Material:()=>u.Material,MaterialIdCount:()=>u.MaterialIdCount,Matrix3:()=>y.Matrix3,Matrix4:()=>y.Matrix4,Mesh:()=>f.Mesh,MeshDoubleLambertMaterial:()=>u.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>u.MeshLambertMaterial,MeshOutlineMaterial:()=>u.MeshOutlineMaterial,NearestFilter:()=>o.NearestFilter,Object3D:()=>c.Object3D,Object3DIDCount:()=>c.Object3DIDCount,Projector:()=>c.Projector,Quaternion:()=>y.Quaternion,R32Format:()=>o.R32Format,RFormat:()=>o.RFormat,RGBAFormat:()=>o.RGBAFormat,Ray:()=>y.Ray,Raycaster:()=>c.Raycaster,Renderer:()=>A.Renderer,Scene:()=>c.Scene,ShaderLib:()=>g.ShaderLib,ShaderUtils:()=>g.ShaderUtils,Shading:()=>o.Shading,Sphere:()=>_.Sphere,SphereImposterMaterial:()=>u.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>u.SphereImposterOutlineMaterial,Sprite:()=>f.Sprite,SpriteAlignment:()=>o.SpriteAlignment,SpriteMaterial:()=>u.SpriteMaterial,SpritePlugin:()=>R.SpritePlugin,StickImposterMaterial:()=>u.StickImposterMaterial,StickImposterOutlineMaterial:()=>u.StickImposterOutlineMaterial,Texture:()=>c.Texture,TextureIdCount:()=>c.TextureIdCount,TextureOperations:()=>o.TextureOperations,Triangle:()=>_.Triangle,UVMapping:()=>c.UVMapping,UnsignedByteType:()=>o.UnsignedByteType,Vector2:()=>y.Vector2,Vector3:()=>y.Vector3,VolumetricMaterial:()=>u.VolumetricMaterial,basic:()=>g.basic,clamp:()=>y.clamp,clone:()=>g.clone,conversionMatrix3:()=>y.conversionMatrix3,degToRad:()=>y.degToRad,instanced:()=>g.instanced,intersectObject:()=>c.intersectObject,lambert:()=>g.lambert,lambertdouble:()=>g.lambertdouble,outline:()=>g.outline,screen:()=>g.screen,screenaa:()=>g.screenaa,sphereimposter:()=>g.sphereimposter,sphereimposteroutline:()=>g.sphereimposteroutline,sprite:()=>g.sprite,stickimposter:()=>g.stickimposter,stickimposteroutline:()=>g.stickimposteroutline,volumetric:()=>g.volumetric});var o=t("./src/WebGL/constants/index.ts"),c=t("./src/WebGL/core/index.ts"),u=t("./src/WebGL/materials/index.ts"),y=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/objects/index.ts"),g=t("./src/WebGL/shaders/index.ts"),_=t("./src/WebGL/shapes/index.ts"),p=t("./src/WebGL/Camera.ts"),S=t("./src/WebGL/Fog.ts"),A=t("./src/WebGL/Renderer.ts"),R=t("./src/WebGL/SpritePlugin.ts")}),"./src/WebGL/materials/ImposterMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{ImposterMaterial:()=>g});var o=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Shading.ts"),u=t("./src/colors.ts"),y=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/materials/Material.ts");class g extends f.Material{constructor(p){super(),this.color=new u.Color(16777215),this.ambient=new u.Color(1048575),this.emissive=new u.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new y.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=c.Shading.SmoothShading,this.shaderID=null,this.vertexColors=o.Coloring.NoColors,this.skinning=!1,this.setValues(p)}clone(p=new g){return super.clone.call(this,p),p.color.copy(this.color),p.ambient.copy(this.ambient),p.emissive.copy(this.emissive),p.wrapAround=this.wrapAround,p.wrapRGB.copy(this.wrapRGB),p.map=this.map,p.lightMap=this.lightMap,p.specularMap=this.specularMap,p.envMap=this.envMap,p.combine=this.combine,p.reflectivity=this.reflectivity,p.refractionRatio=this.refractionRatio,p.fog=this.fog,p.shading=this.shading,p.shaderID=this.shaderID,p.vertexColors=this.vertexColors,p.skinning=this.skinning,p.morphTargets=this.morphTargets,p.morphNormals=this.morphNormals,p}}}),"./src/WebGL/materials/InstancedMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{InstancedMaterial:()=>g});var o=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Shading.ts"),u=t("./src/colors.ts"),y=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/materials/Material.ts");class g extends f.Material{constructor(p){super(),this.color=new u.Color(16777215),this.ambient=new u.Color(1048575),this.emissive=new u.Color(0),this.wrapAround=!1,this.wrapRGB=new y.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=c.Shading.SmoothShading,this.shaderID="instanced",this.vertexColors=o.Coloring.NoColors,this.skinning=!1,this.sphere=null,this.setValues(p)}clone(p=new g){return super.clone.call(this,p),p.color.copy(this.color),p.ambient.copy(this.ambient),p.emissive.copy(this.emissive),p.wrapAround=this.wrapAround,p.wrapRGB.copy(this.wrapRGB),p.map=this.map,p.lightMap=this.lightMap,p.specularMap=this.specularMap,p.envMap=this.envMap,p.combine=this.combine,p.reflectivity=this.reflectivity,p.refractionRatio=this.refractionRatio,p.fog=this.fog,p.shading=this.shading,p.shaderID=this.shaderID,p.vertexColors=this.vertexColors,p.skinning=this.skinning,p.morphTargets=this.morphTargets,p.morphNormals=this.morphNormals,p.sphere=this.sphere,p}}}),"./src/WebGL/materials/LineBasicMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{LineBasicMaterial:()=>u});var o=t("./src/colors.ts"),c=t("./src/WebGL/materials/Material.ts");class u extends c.Material{constructor(f){super(),this.color=new o.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(f)}clone(f=new u){return super.clone.call(this,f),f.color.copy(this.color),f}}}),"./src/WebGL/materials/Material.ts":((e,r,t)=>{t.r(r),t.d(r,{Material:()=>f,MaterialIdCount:()=>g});var o=t("./src/WebGL/constants/Sides.ts"),c=t("./src/WebGL/core/index.ts"),u=t("./src/WebGL/math/index.ts"),y=t("./src/colors.ts");class f extends c.EventDispatcher{constructor(){super(...arguments),this.id=g++,this.name="",this.side=o.FrontSide,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(p={}){if(p!==void 0)for(var S in p){var A=p[S];if(A===void 0){console.warn("$3Dmol.Material: '"+S+"' parameter is undefined.");continue}if(S in this){var R=this[S];R instanceof y.Color&&A instanceof y.Color?R.copy(A):R instanceof y.Color?R.set(A):R instanceof u.Vector3&&A instanceof u.Vector3?R.copy(A):this[S]=A}}}clone(p=new f){return p.name=this.name,p.side=this.side,p.opacity=this.opacity,p.transparent=this.transparent,p.depthTest=this.depthTest,p.depthWrite=this.depthWrite,p.polygonOffset=this.polygonOffset,p.polygonOffsetFactor=this.polygonOffsetFactor,p.polygonOffsetUnits=this.polygonOffsetUnits,p.alphaTest=this.alphaTest,p.overdraw=this.overdraw,p.visible=this.visible,p}makeShaded(p){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:p},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let g=0}),"./src/WebGL/materials/MeshDoubleLambertMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{MeshDoubleLambertMaterial:()=>u});var o=t("./src/WebGL/constants/Sides.ts"),c=t("./src/WebGL/materials/MeshLambertMaterial.ts");class u extends c.MeshLambertMaterial{constructor(f){super(f),this.shaderID="lambertdouble",this.side=o.DoubleSide,this.outline=!1}clone(f=new u){return super.clone.call(this,f),f}}}),"./src/WebGL/materials/MeshLambertMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{MeshLambertMaterial:()=>g});var o=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Shading.ts"),u=t("./src/WebGL/materials/Material.ts"),y=t("./src/colors.ts"),f=t("./src/WebGL/math/index.ts");class g extends u.Material{constructor(p){super(),this.color=new y.Color(16777215),this.ambient=new y.Color(1048575),this.emissive=new y.Color(0),this.wrapAround=!1,this.wrapRGB=new f.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=c.Shading.SmoothShading,this.shaderID="lambert",this.vertexColors=o.Coloring.NoColors,this.skinning=!1,this.setValues(p)}clone(p=new g){return super.clone.call(this,p),p.color.copy(this.color),p.ambient.copy(this.ambient),p.emissive.copy(this.emissive),p.wrapAround=this.wrapAround,p.wrapRGB.copy(this.wrapRGB),p.map=this.map,p.lightMap=this.lightMap,p.specularMap=this.specularMap,p.envMap=this.envMap,p.combine=this.combine,p.reflectivity=this.reflectivity,p.refractionRatio=this.refractionRatio,p.fog=this.fog,p.shading=this.shading,p.shaderID=this.shaderID,p.vertexColors=this.vertexColors,p.skinning=this.skinning,p.morphTargets=this.morphTargets,p.morphNormals=this.morphNormals,p}}}),"./src/WebGL/materials/MeshOutlineMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{MeshOutlineMaterial:()=>u});var o=t("./src/colors.ts"),c=t("./src/WebGL/materials/Material.ts");class u extends c.Material{constructor(f){super(),f=f||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=f.color||new o.Color(0,0,0),this.outlineWidth=f.width||.1,this.outlinePushback=f.pushback||1}clone(f=new u){return super.clone.call(this,f),f.fog=this.fog,f.shaderID=this.shaderID,f.wireframe=this.wireframe,f}}}),"./src/WebGL/materials/SphereImposterMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{SphereImposterMaterial:()=>c});var o=t("./src/WebGL/materials/ImposterMaterial.ts");class c extends o.ImposterMaterial{constructor(y){super(y),this.shaderID="sphereimposter",this.setValues(y)}clone(y=new c){return super.clone.call(this,y),y}}}),"./src/WebGL/materials/SphereImposterOutlineMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{SphereImposterOutlineMaterial:()=>u});var o=t("./src/colors.ts"),c=t("./src/WebGL/materials/ImposterMaterial.ts");class u extends c.ImposterMaterial{constructor(f){super(f),f=f||{},this.shaderID="sphereimposteroutline",this.outlineColor=f.color||new o.Color(0,0,0),this.outlineWidth=f.width||.1,this.outlinePushback=f.pushback||1,this.setValues(f)}clone(f=new u){return super.clone.call(this,f),f.outlineColor=this.outlineColor,f.outlineWidth=this.outlineWidth,f.outlinePushback=this.outlinePushback,f}}}),"./src/WebGL/materials/SpriteMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{SpriteMaterial:()=>g});var o=t("./src/WebGL/constants/SpriteAlignment.ts"),c=t("./src/WebGL/core/Texture.ts"),u=t("./src/colors.ts"),y=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/materials/Material.ts");class g extends f.Material{constructor(p){super(),this.color=new u.Color(16777215),this.map=new c.Texture,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new y.Vector2(0,0),this.uvScale=new y.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=o.SpriteAlignment.center.clone(),this.setValues(p),p=p||{},p.depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),p.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),p.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(p=new g){return super.clone.call(this,p),p.color.copy(this.color),p.map=this.map,p.useScreenCoordinates=this.useScreenCoordinates,p.screenOffset=this.screenOffset,p.sizeAttenuation=this.sizeAttenuation,p.scaleByViewport=this.scaleByViewPort,p.alignment.copy(this.alignment),p.uvOffset.copy(this.uvOffset),p}}}),"./src/WebGL/materials/StickImposterMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{StickImposterMaterial:()=>c});var o=t("./src/WebGL/materials/ImposterMaterial.ts");class c extends o.ImposterMaterial{constructor(y){super(y),this.shaderID="stickimposter",this.setValues(y)}clone(y=new c){return super.clone.call(this,y),y}}}),"./src/WebGL/materials/StickImposterOutlineMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{StickImposterOutlineMaterial:()=>u});var o=t("./src/colors.ts"),c=t("./src/WebGL/materials/ImposterMaterial.ts");class u extends c.ImposterMaterial{constructor(f={}){super(f),this.shaderID="stickimposteroutline",this.outlineColor=new o.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,f.color&&(this.outlineColor=f.color),f.width&&(this.outlineWidth=f.width),f.pushback&&(this.outlinePushback=f.pushback),this.setValues(f)}clone(f=new u){return super.clone.call(this,f),f.outlineColor=this.outlineColor,f.outlineWidth=this.outlineWidth,f.outlinePushback=this.outlinePushback,f}}}),"./src/WebGL/materials/VolumetricMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{VolumetricMaterial:()=>y});var o=t("./src/WebGL/constants/Sides.ts"),c=t("./src/colors.ts"),u=t("./src/WebGL/materials/Material.ts");class y extends u.Material{constructor(g){super(),this.transparent=!1,this.volumetric=!0,this.color=new c.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=o.FrontSide,this.setValues(g)}clone(g=new y){return super.clone.call(this,g),g.transparent=this.transparent,g.volumetric=this.volumetric,g.color=this.color,g.transferfn=this.transferfn,g.map=this.map,g.extent=this.extent,g.maxdepth=this.maxdepth,g.unit=this.unit,g.texmatrix=this.texmatrix,g.transfermin=this.transfermin,g.transfermax=this.transfermax,g.subsamples=this.subsamples,g.shaderID=this.shaderID,g.side=this.side,g}}}),"./src/WebGL/materials/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ImposterMaterial:()=>o.ImposterMaterial,InstancedMaterial:()=>c.InstancedMaterial,LineBasicMaterial:()=>u.LineBasicMaterial,Material:()=>y.Material,MaterialIdCount:()=>y.MaterialIdCount,MeshDoubleLambertMaterial:()=>f.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>g.MeshLambertMaterial,MeshOutlineMaterial:()=>_.MeshOutlineMaterial,SphereImposterMaterial:()=>p.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>S.SphereImposterOutlineMaterial,SpriteMaterial:()=>A.SpriteMaterial,StickImposterMaterial:()=>R.StickImposterMaterial,StickImposterOutlineMaterial:()=>z.StickImposterOutlineMaterial,VolumetricMaterial:()=>l.VolumetricMaterial});var o=t("./src/WebGL/materials/ImposterMaterial.ts"),c=t("./src/WebGL/materials/InstancedMaterial.ts"),u=t("./src/WebGL/materials/LineBasicMaterial.ts"),y=t("./src/WebGL/materials/Material.ts"),f=t("./src/WebGL/materials/MeshDoubleLambertMaterial.ts"),g=t("./src/WebGL/materials/MeshLambertMaterial.ts"),_=t("./src/WebGL/materials/MeshOutlineMaterial.ts"),p=t("./src/WebGL/materials/SphereImposterMaterial.ts"),S=t("./src/WebGL/materials/SphereImposterOutlineMaterial.ts"),A=t("./src/WebGL/materials/SpriteMaterial.ts"),R=t("./src/WebGL/materials/StickImposterMaterial.ts"),z=t("./src/WebGL/materials/StickImposterOutlineMaterial.ts"),l=t("./src/WebGL/materials/VolumetricMaterial.ts")}),"./src/WebGL/math/Quaternion.ts":((e,r,t)=>{t.r(r),t.d(r,{Quaternion:()=>o});class o{constructor(u,y,f,g){this.x=u||0,this.y=y||0,this.z=f||0,this.w=g!==void 0?g:1}set(u,y,f,g){return this.x=u,this.y=y,this.z=f,this.w=g,this}copy(u){return this.x=u.x,this.y=u.y,this.z=u.z,this.w=u.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let u=this.length();return u===0?(this.x=0,this.y=0,this.z=0,this.w=1):(u=1/u,this.x*=u,this.y*=u,this.z*=u,this.w*=u),this}multiply(u){return this.multiplyQuaternions(this,u)}multiplyScalar(u){return this.x*=u,this.y*=u,this.z*=u,this.w*=u,this}multiplyQuaternions(u,y){const f=u.x,g=u.y,_=u.z,p=u.w,S=y.x,A=y.y,R=y.z,z=y.w;return this.x=f*z+p*S+g*R-_*A,this.y=g*z+p*A+_*S-f*R,this.z=_*z+p*R+f*A-g*S,this.w=p*z-f*S-g*A-_*R,this}sub(u){return this.x-=u.x,this.y-=u.y,this.z-=u.z,this.w-=u.w,this}clone(){return new o(this.x,this.y,this.z,this.w)}setFromEuler(u){const y=Math.cos(u.x/2),f=Math.cos(u.y/2),g=Math.cos(u.z/2),_=Math.sin(u.x/2),p=Math.sin(u.y/2),S=Math.sin(u.z/2);return this.x=_*f*g+y*p*S,this.y=y*p*g-_*f*S,this.z=y*f*S+_*p*g,this.w=y*f*g-_*p*S,this}}}),"./src/WebGL/math/Vector2.ts":((e,r,t)=>{t.r(r),t.d(r,{Vector2:()=>o});class o{constructor(u,y){this.x=u||0,this.y=y||0}set(u,y){return this.x=u,this.y=y,this}subVectors(u,y){return this.x=u.x-y.x,this.y=u.y-y.y,this}copy(u){return this.x=u.x,this.y=u.y,this}clone(){return new o(this.x,this.y)}}}),"./src/WebGL/math/index.ts":((e,r,t)=>{t.r(r),t.d(r,{Matrix3:()=>g.Matrix3,Matrix4:()=>g.Matrix4,Quaternion:()=>o.Quaternion,Ray:()=>g.Ray,Vector2:()=>c.Vector2,Vector3:()=>g.Vector3,clamp:()=>u.clamp,conversionMatrix3:()=>y.conversionMatrix3,degToRad:()=>f.degToRad});var o=t("./src/WebGL/math/Quaternion.ts"),c=t("./src/WebGL/math/Vector2.ts"),u=t("./src/WebGL/math/utils/clamp.ts"),y=t("./src/WebGL/math/utils/conversionMatrix3.ts"),f=t("./src/WebGL/math/utils/degToRad.ts"),g=t("./src/WebGL/math/math.ts")}),"./src/WebGL/math/math.ts":((e,r,t)=>{t.r(r),t.d(r,{Matrix3:()=>A,Matrix4:()=>p,Ray:()=>R,Vector3:()=>S});var o=t("./src/WebGL/math/utils/degToRad.ts"),c=t("./src/WebGL/math/utils/clamp.ts"),u,y,f,g,_;class p{constructor(l=1,s=0,v=0,w=0,E=0,C=1,h=0,x=0,k=0,M=0,D=1,P=0,F=0,X=0,B=0,L=1){typeof l<"u"&&typeof l!="number"?this.elements=new Float32Array(l):(this.elements=new Float32Array(16),this.elements[0]=l,this.elements[4]=s,this.elements[8]=v,this.elements[12]=w,this.elements[1]=E,this.elements[5]=C,this.elements[9]=h,this.elements[13]=x,this.elements[2]=k,this.elements[6]=M,this.elements[10]=D,this.elements[14]=P,this.elements[3]=F,this.elements[7]=X,this.elements[11]=B,this.elements[15]=L)}makeScale(l,s,v){throw new Error("Method not implemented.")}set(l,s,v,w,E,C,h,x,k,M,D,P,F,X,B,L){const H=this.elements;return H[0]=l,H[4]=s,H[8]=v,H[12]=w,H[1]=E,H[5]=C,H[9]=h,H[13]=x,H[2]=k,H[6]=M,H[10]=D,H[14]=P,H[3]=F,H[7]=X,H[11]=B,H[15]=L,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(l){const s=l.elements;return this.set(s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14],s[3],s[7],s[11],s[15]),this}matrix3FromTopLeft(){const l=this.elements;return new A(l[0],l[4],l[8],l[1],l[5],l[9],l[2],l[6],l[10])}setRotationFromEuler(l,s){const v=this.elements,{x:w,y:E,z:C}=l,h=Math.cos(w),x=Math.sin(w),k=Math.cos(E),M=Math.sin(E),D=Math.cos(C),P=Math.sin(C);if(s===void 0||s==="XYZ"){const F=h*D,X=h*P,B=x*D,L=x*P;v[0]=k*D,v[4]=-k*P,v[8]=M,v[1]=X+B*M,v[5]=F-L*M,v[9]=-x*k,v[2]=L-F*M,v[6]=B+X*M,v[10]=h*k}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${s}`);return this}setRotationFromQuaternion(l){const s=this.elements,{x:v,y:w,z:E,w:C}=l,h=v+v,x=w+w,k=E+E,M=v*h,D=v*x,P=v*k,F=w*x,X=w*k,B=E*k,L=C*h,H=C*x,U=C*k;return s[0]=1-(F+B),s[4]=D-U,s[8]=P+H,s[1]=D+U,s[5]=1-(M+B),s[9]=X-L,s[2]=P-H,s[6]=X+L,s[10]=1-(M+F),this}multiplyMatrices(l,s){const v=l.elements,w=s.elements,E=this.elements,C=v[0],h=v[4],x=v[8],k=v[12],M=v[1],D=v[5],P=v[9],F=v[13],X=v[2],B=v[6],L=v[10],H=v[14],U=v[3],Y=v[7],W=v[11],q=v[15],G=w[0],$=w[4],Z=w[8],xe=w[12],ce=w[1],Ne=w[5],Pe=w[9],De=w[13],Me=w[2],Be=w[6],ft=w[10],Ot=w[14],Gt=w[3],mt=w[7],je=w[11],ht=w[15];return E[0]=C*G+h*ce+x*Me+k*Gt,E[4]=C*$+h*Ne+x*Be+k*mt,E[8]=C*Z+h*Pe+x*ft+k*je,E[12]=C*xe+h*De+x*Ot+k*ht,E[1]=M*G+D*ce+P*Me+F*Gt,E[5]=M*$+D*Ne+P*Be+F*mt,E[9]=M*Z+D*Pe+P*ft+F*je,E[13]=M*xe+D*De+P*Ot+F*ht,E[2]=X*G+B*ce+L*Me+H*Gt,E[6]=X*$+B*Ne+L*Be+H*mt,E[10]=X*Z+B*Pe+L*ft+H*je,E[14]=X*xe+B*De+L*Ot+H*ht,E[3]=U*G+Y*ce+W*Me+q*Gt,E[7]=U*$+Y*Ne+W*Be+q*mt,E[11]=U*Z+Y*Pe+W*ft+q*je,E[15]=U*xe+Y*De+W*Ot+q*ht,this}multiplyScalar(l){const s=this.elements;return s[0]*=l,s[4]*=l,s[8]*=l,s[12]*=l,s[1]*=l,s[5]*=l,s[9]*=l,s[13]*=l,s[2]*=l,s[6]*=l,s[10]*=l,s[14]*=l,s[3]*=l,s[7]*=l,s[11]*=l,s[15]*=l,this}makeTranslation(l,s,v){return this.set(1,0,0,l,0,1,0,s,0,0,1,v,0,0,0,1),this}snap(l){const s=Math.pow(10,4),v=this.elements;for(let w=0;w<16;w++){const E=Math.round(v[w]);E===Math.round(v[w]*s)/s&&(v[w]=E)}return this}transpose(){const l=this.elements;let s;return s=l[1],l[1]=l[4],l[4]=s,s=l[2],l[2]=l[8],l[8]=s,s=l[6],l[6]=l[9],l[9]=s,s=l[3],l[3]=l[12],l[12]=s,s=l[7],l[7]=l[13],l[13]=s,s=l[11],l[11]=l[14],l[14]=s,this}setPosition(l){const s=this.elements;return s[12]=l.x,s[13]=l.y,s[14]=l.z,this}translate(l){const s=this.elements;return s[12]+=l.x,s[13]+=l.y,s[14]+=l.z,this}getInverse(l,s){const v=this.elements,w=l.elements,E=w[0],C=w[4],h=w[8],x=w[12],k=w[1],M=w[5],D=w[9],P=w[13],F=w[2],X=w[6],B=w[10],L=w[14],H=w[3],U=w[7],Y=w[11],W=w[15];v[0]=D*L*U-P*B*U+P*X*Y-M*L*Y-D*X*W+M*B*W,v[4]=x*B*U-h*L*U-x*X*Y+C*L*Y+h*X*W-C*B*W,v[8]=h*P*U-x*D*U+x*M*Y-C*P*Y-h*M*W+C*D*W,v[12]=x*D*X-h*P*X-x*M*B+C*P*B+h*M*L-C*D*L,v[1]=P*B*H-D*L*H-P*F*Y+k*L*Y+D*F*W-k*B*W,v[5]=h*L*H-x*B*H+x*F*Y-E*L*Y-h*F*W+E*B*W,v[9]=x*D*H-h*P*H-x*k*Y+E*P*Y+h*k*W-E*D*W,v[13]=h*P*F-x*D*F+x*k*B-E*P*B-h*k*L+E*D*L,v[2]=M*L*H-P*X*H+P*F*U-k*L*U-M*F*W+k*X*W,v[6]=x*X*H-C*L*H-x*F*U+E*L*U+C*F*W-E*X*W,v[10]=C*P*H-x*M*H+x*k*U-E*P*U-C*k*W+E*M*W,v[14]=x*M*F-C*P*F-x*k*X+E*P*X+C*k*L-E*M*L,v[3]=D*X*H-M*B*H-D*F*U+k*B*U+M*F*Y-k*X*Y,v[7]=C*B*H-h*X*H+h*F*U-E*B*U-C*F*Y+E*X*Y,v[11]=h*M*H-C*D*H-h*k*U+E*D*U+C*k*Y-E*M*Y,v[15]=C*D*F-h*M*F+h*k*X-E*D*X-C*k*B+E*M*B;const q=E*v[0]+k*v[4]+F*v[8]+H*v[12];if(q===0){const G="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(s)throw new Error(G);return console.warn(G),this.identity(),this}return this.multiplyScalar(1/q),this}isReflected(){const l=this.elements,s=l[0],v=l[4],w=l[8],E=l[1],C=l[5],h=l[9],x=l[2],k=l[6],M=l[10];return s*C*M+E*k*w+x*v*h-x*C*w-E*v*M-s*k*h<0}scale(l){const s=this.elements,{x:v}=l,{y:w}=l,{z:E}=l;return s[0]*=v,s[4]*=w,s[8]*=E,s[1]*=v,s[5]*=w,s[9]*=E,s[2]*=v,s[6]*=w,s[10]*=E,s[3]*=v,s[7]*=w,s[11]*=E,this}getMaxScaleOnAxis(){const l=this.elements,s=l[0]*l[0]+l[1]*l[1]+l[2]*l[2],v=l[4]*l[4]+l[5]*l[5]+l[6]*l[6],w=l[8]*l[8]+l[9]*l[9]+l[10]*l[10];return Math.sqrt(Math.max(s,Math.max(v,w)))}makeFrustum(l,s,v,w,E,C){const h=this.elements,x=2*E/(s-l),k=2*E/(w-v),M=(s+l)/(s-l),D=(w+v)/(w-v),P=-(C+E)/(C-E),F=-2*C*E/(C-E);return h[0]=x,h[4]=0,h[8]=M,h[12]=0,h[1]=0,h[5]=k,h[9]=D,h[13]=0,h[2]=0,h[6]=0,h[10]=P,h[14]=F,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makePerspective(l,s,v,w){const E=v*Math.tan((0,o.degToRad)(l*.5)),C=-E,h=C*s,x=E*s;return this.makeFrustum(h,x,C,E,v,w)}makeOrthographic(l,s,v,w,E,C){const h=this.elements,x=1/(s-l),k=1/(v-w),M=1/(C-E),D=(s+l)*x,P=(v+w)*k,F=(C+E)*M;return h[0]=2*x,h[4]=0,h[8]=0,h[12]=-D,h[1]=0,h[5]=2*k,h[9]=0,h[13]=-P,h[2]=0,h[6]=0,h[10]=-2*M,h[14]=-F,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}isEqual(l){const s=l.elements,v=this.elements;return v[0]===s[0]&&v[4]===s[4]&&v[8]===s[8]&&v[12]===s[12]&&v[1]===s[1]&&v[5]===s[5]&&v[9]===s[9]&&v[13]===s[13]&&v[2]===s[2]&&v[6]===s[6]&&v[10]===s[10]&&v[14]===s[14]&&v[3]===s[3]&&v[7]===s[7]&&v[11]===s[11]&&v[15]===s[15]}clone(){const l=this.elements;return new p(l[0],l[4],l[8],l[12],l[1],l[5],l[9],l[13],l[2],l[6],l[10],l[14],l[3],l[7],l[11],l[15])}isIdentity(){const l=this.elements;return l[0]===1&&l[4]===0&&l[8]===0&&l[12]===0&&l[1]===0&&l[5]===1&&l[9]===0&&l[13]===0&&l[2]===0&&l[6]===0&&l[10]===1&&l[14]===0&&l[3]===0&&l[7]===0&&l[11]===0&&l[15]===1}isNearlyIdentity(l){return this.clone().snap(l).isIdentity()}getScale(l){const s=this.elements;return l=l||new S,f.set(s[0],s[1],s[2]),g.set(s[4],s[5],s[6]),_.set(s[8],s[9],s[10]),l.x=f.length(),l.y=g.length(),l.z=_.length(),l}lookAt(l,s,v){const w=this.elements;return _.subVectors(l,s).normalize(),_.length()===0&&(_.z=1),f.crossVectors(v,_).normalize(),f.length()===0&&(_.x+=1e-4,f.crossVectors(v,_).normalize()),g.crossVectors(_,f),w[0]=f.x,w[4]=g.x,w[8]=_.x,w[1]=f.y,w[5]=g.y,w[9]=_.y,w[2]=f.z,w[6]=g.z,w[10]=_.z,this}compose(l,s,v){const w=this.elements;return u.identity(),u.setRotationFromQuaternion(s),y.makeScale(v.x,v.y,v.z),this.multiplyMatrices(u,y),w[12]=l.x,w[13]=l.y,w[14]=l.z,this}}u=new p,y=new p;class S{constructor(l,s,v){this.x=l||0,this.y=s||0,this.z=v||0,this.atomid=void 0}set(l,s,v){return this.x=l,this.y=s,this.z=v,this}copy(l){return this.x=l.x,this.y=l.y,this.z=l.z,this}add(l){return this.x+=l.x,this.y+=l.y,this.z+=l.z,this}addVectors(l,s){return this.x=l.x+s.x,this.y=l.y+s.y,this.z=l.z+s.z,this}multiplyVectors(l,s){return this.x=l.x*s.x,this.y=l.y*s.y,this.z=l.z*s.z,this}sub(l){return this.x-=l.x,this.y-=l.y,this.z-=l.z,this}subVectors(l,s){return this.x=l.x-s.x,this.y=l.y-s.y,this.z=l.z-s.z,this}multiplyScalar(l){return this.x*=l,this.y*=l,this.z*=l,this}divideScalar(l){return l!==0?(this.x/=l,this.y/=l,this.z/=l):(this.x=0,this.y=0,this.z=0),this}max(l){return this.x=Math.max(this.x,l.x),this.y=Math.max(this.y,l.y),this.z=Math.max(this.z,l.z),this}min(l){return this.x=Math.min(this.x,l.x),this.y=Math.min(this.y,l.y),this.z=Math.min(this.z,l.z),this}distanceTo(l){return Math.sqrt(this.distanceToSquared(l))}distanceToSquared(l){const s=this.x-l.x,v=this.y-l.y,w=this.z-l.z;return s*s+v*v+w*w}applyMatrix3(l){const{x:s}=this,{y:v}=this,{z:w}=this,E=l.elements;return this.x=E[0]*s+E[3]*v+E[6]*w,this.y=E[1]*s+E[4]*v+E[7]*w,this.z=E[2]*s+E[5]*v+E[8]*w,this}applyMatrix4(l){const{x:s}=this,{y:v}=this,{z:w}=this,E=l.elements;return this.x=E[0]*s+E[4]*v+E[8]*w+E[12],this.y=E[1]*s+E[5]*v+E[9]*w+E[13],this.z=E[2]*s+E[6]*v+E[10]*w+E[14],this}applyProjection(l){const{x:s}=this,{y:v}=this,{z:w}=this,E=l.elements,C=E[3]*s+E[7]*v+E[11]*w+E[15];return this.x=(E[0]*s+E[4]*v+E[8]*w+E[12])/C,this.y=(E[1]*s+E[5]*v+E[9]*w+E[13])/C,this.z=(E[2]*s+E[6]*v+E[10]*w+E[14])/C,this}applyQuaternion(l){const{x:s}=this,{y:v}=this,{z:w}=this,E=l.x,C=l.y,h=l.z,x=l.w,k={};k.x=2*(v*h-w*C),k.y=2*(w*E-s*h),k.z=2*(s*C-v*E);const M={};return M.x=k.y*h-k.z*C,M.y=k.z*E-k.x*h,M.z=k.x*C-k.y*E,this.x=s+x*k.x+M.x,this.y=v+x*k.y+M.y,this.z=w+x*k.z+M.z,this}negate(){return this.multiplyScalar(-1)}dot(l){return this.x*l.x+this.y*l.y+this.z*l.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross(l){const{x:s}=this,{y:v}=this,{z:w}=this;return this.x=v*l.z-w*l.y,this.y=w*l.x-s*l.z,this.z=s*l.y-v*l.x,this}crossVectors(l,s){return this.x=l.y*s.z-l.z*s.y,this.y=l.z*s.x-l.x*s.z,this.z=l.x*s.y-l.y*s.x,this}equals(l){return this.x==l.x&&this.y==l.y&&this.z==l.z}getPositionFromMatrix(l){return this.x=l.elements[12],this.y=l.elements[13],this.z=l.elements[14],this}setEulerFromRotationMatrix(l,s){const v=l.elements,w=v[0],E=v[4],C=v[8],h=v[5],x=v[9],k=v[6],M=v[10];return s===void 0||s==="XYZ"?(this.y=Math.asin((0,c.clamp)(C,-1,1)),Math.abs(C)<.99999?(this.x=Math.atan2(-x,M),this.z=Math.atan2(-E,w)):(this.x=Math.atan2(k,h),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${s}`),this}rotateAboutVector(l,s){l.normalize();const v=Math.cos(s),w=Math.sin(s),E=this.clone().multiplyScalar(v),C=l.clone().cross(this).multiplyScalar(w),h=l.clone().multiplyScalar(l.clone().dot(this)).multiplyScalar(1-v),x=E.add(C).add(h);return this.x=x.x,this.y=x.y,this.z=x.z,this}setFromMatrixPosition(l){const s=l.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}transformDirection(l){const{x:s}=this,{y:v}=this,{z:w}=this,E=l.elements;return this.x=E[0]*s+E[4]*v+E[8]*w,this.y=E[1]*s+E[5]*v+E[9]*w,this.z=E[2]*s+E[6]*v+E[10]*w,this.normalize()}clone(){return new S(this.x,this.y,this.z)}unproject(l){const s=u;return s.multiplyMatrices(l.matrixWorld,s.getInverse(l.projectionMatrix)),this.applyMatrix4(s)}}f=new S,g=new S,_=new S;class A{constructor(l=1,s=0,v=0,w=0,E=1,C=0,h=0,x=0,k=1){this.elements=new Float32Array(9),this.set(l,s,v,w,E,C,h,x,k)}set(l,s,v,w,E,C,h,x,k){const M=this.elements;return M[0]=l,M[3]=s,M[6]=v,M[1]=w,M[4]=E,M[7]=C,M[2]=h,M[5]=x,M[8]=k,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(l){const s=l.elements;this.set(s[0],s[3],s[6],s[1],s[4],s[7],s[2],s[5],s[8])}multiplyScalar(l){const s=this.elements;return s[0]*=l,s[3]*=l,s[6]*=l,s[1]*=l,s[4]*=l,s[7]*=l,s[2]*=l,s[5]*=l,s[8]*=l,this}getInverse3(l){const s=l.elements,v=this.elements;v[0]=s[4]*s[8]-s[5]*s[7],v[3]=s[6]*s[5]-s[3]*s[8],v[6]=s[3]*s[7]-s[6]*s[4],v[1]=s[7]*s[2]-s[1]*s[8],v[4]=s[0]*s[8]-s[6]*s[2],v[7]=s[1]*s[6]-s[0]*s[7],v[2]=s[1]*s[5]-s[2]*s[4],v[5]=s[2]*s[3]-s[0]*s[5],v[8]=s[0]*s[4]-s[1]*s[3];const w=s[0]*v[0]+s[3]*v[1]+s[6]*v[2];return this.multiplyScalar(1/w),this}getInverse(l,s){const v=l.elements,w=this.elements;w[0]=v[10]*v[5]-v[6]*v[9],w[1]=-v[10]*v[1]+v[2]*v[9],w[2]=v[6]*v[1]-v[2]*v[5],w[3]=-v[10]*v[4]+v[6]*v[8],w[4]=v[10]*v[0]-v[2]*v[8],w[5]=-v[6]*v[0]+v[2]*v[4],w[6]=v[9]*v[4]-v[5]*v[8],w[7]=-v[9]*v[0]+v[1]*v[8],w[8]=v[5]*v[0]-v[1]*v[4];const E=v[0]*w[0]+v[1]*w[3]+v[2]*w[6];if(E===0){const C="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(s)throw new Error(C);return console.warn(C),this.identity(),this}return this.multiplyScalar(1/E),this}getDeterminant(){const l=this.elements;return l[0]*l[4]*l[8]+l[1]*l[5]*l[6]+l[2]*l[3]*l[7]-l[2]*l[4]*l[6]-l[1]*l[3]*l[8]-l[0]*l[5]*l[7]}transpose(){let l;const s=this.elements;return l=s[1],s[1]=s[3],s[3]=l,l=s[2],s[2]=s[6],s[6]=l,l=s[5],s[5]=s[7],s[7]=l,this}clone(){const l=this.elements;return new A(l[0],l[3],l[6],l[1],l[4],l[7],l[2],l[5],l[8])}getMatrix4(){const l=this.elements;return new p(l[0],l[3],l[6],0,l[1],l[4],l[7],0,l[2],l[5],l[8],0)}}class R{constructor(l,s){this.origin=l!==void 0?l:new S,this.direction=s!==void 0?s:new S}set(l,s){return this.origin.copy(l),this.direction.copy(s),this}copy(l){return this.origin.copy(l.origin),this.direction.copy(l.direction),this}at(l,s){return(s||new S).copy(this.direction).multiplyScalar(l).add(this.origin)}recast(l){const s=f;return this.origin.copy(this.at(l,s)),this}closestPointToPoint(l,s){const v=s||new S;v.subVectors(l,this.origin);const w=v.dot(this.direction);return v.copy(this.direction).multiplyScalar(w).add(this.origin)}distanceToPoint(l){const s=f,v=s.subVectors(l,this.origin).dot(this.direction);return s.copy(this.direction).multiplyScalar(v).add(this.origin),s.distanceTo(l)}isIntersectionCylinder(){}isIntersectionSphere(l){return this.distanceToPoint(l.center)<=l.radius}isIntersectionPlane(l){return l.normal.dot(this.direction)!==0||l.distanceToPoint(this.origin)===0}distanceToPlane(l){const s=l.normal.dot(this.direction);return s===0?l.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot(l.normal)+l.constant)/s}intersectPlane(l,s){const v=this.distanceToPlane(l);if(v!==void 0)return this.at(v,s)}applyMatrix4(l){return this.direction.add(this.origin).applyMatrix4(l),this.origin.applyMatrix4(l),this.direction.sub(this.origin),this}clone(){return new R().copy(this)}}}),"./src/WebGL/math/utils/clamp.ts":((e,r,t)=>{t.r(r),t.d(r,{clamp:()=>o});function o(c,u,y){return Math.min(Math.max(c,u),y)}}),"./src/WebGL/math/utils/conversionMatrix3.ts":((e,r,t)=>{t.r(r),t.d(r,{conversionMatrix3:()=>c});var o=t("./src/WebGL/math/math.ts");function c(u,y,f,g,_,p){g=g*Math.PI/180,_=_*Math.PI/180,p=p*Math.PI/180;const S=s=>s*s,A=Math.cos(g),R=Math.cos(_),z=Math.cos(p),l=Math.sin(p);return new o.Matrix3(u,y*z,f*R,0,y*l,f*(A-R*z)/l,0,0,f*Math.sqrt(1-S(A)-S(R)-S(z)+2*A*R*z)/l)}}),"./src/WebGL/math/utils/degToRad.ts":((e,r,t)=>{t.r(r),t.d(r,{degToRad:()=>c});const o=Math.PI/180;function c(u){return u*o}}),"./src/WebGL/objects/Line.ts":((e,r,t)=>{t.r(r),t.d(r,{Line:()=>y,LineStyle:()=>u});var o=t("./src/WebGL/materials/index.ts"),c=t("./src/WebGL/core/index.ts"),u;(function(f){f[f.LineStrip=0]="LineStrip",f[f.LinePieces=1]="LinePieces"})(u||(u={}));class y extends c.Object3D{constructor(g,_=new o.LineBasicMaterial({color:Math.random()*16777215}),p=u.LineStrip){super(),this.geometry=g,this.material=_,this.type=p}clone(g=new y(this.geometry,this.material,this.type)){return super.clone.call(this,g),g}}}),"./src/WebGL/objects/Mesh.ts":((e,r,t)=>{t.r(r),t.d(r,{Mesh:()=>c});var o=t("./src/WebGL/core/index.ts");class c extends o.Object3D{constructor(y,f){super(),this.geometry=y,this.material=f}clone(y){return y===void 0&&(y=new c(this.geometry,this.material)),super.clone.call(this,y),y}}}),"./src/WebGL/objects/Sprite.ts":((e,r,t)=>{t.r(r),t.d(r,{Sprite:()=>u});var o=t("./src/WebGL/materials/index.ts"),c=t("./src/WebGL/core/index.ts");class u extends c.Object3D{constructor(f=new o.SpriteMaterial){super(),this.material=f,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),(this.scale.x!==1||this.scale.y!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(f=new u(this.material)){return c.Object3D.prototype.clone.call(this,f),f}}}),"./src/WebGL/objects/index.ts":((e,r,t)=>{t.r(r),t.d(r,{Line:()=>o.Line,LineStyle:()=>o.LineStyle,Mesh:()=>c.Mesh,Sprite:()=>u.Sprite});var o=t("./src/WebGL/objects/Line.ts"),c=t("./src/WebGL/objects/Mesh.ts"),u=t("./src/WebGL/objects/Sprite.ts")}),"./src/WebGL/shaders/ShaderType.ts":((e,r,t)=>{t.r(r)}),"./src/WebGL/shaders/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ShaderLib:()=>o.ShaderLib,ShaderUtils:()=>c.ShaderUtils,basic:()=>o.basic,clone:()=>c.clone,instanced:()=>o.instanced,lambert:()=>o.lambert,lambertdouble:()=>o.lambertdouble,outline:()=>o.outline,screen:()=>o.screen,screenaa:()=>o.screenaa,sphereimposter:()=>o.sphereimposter,sphereimposteroutline:()=>o.sphereimposteroutline,sprite:()=>o.sprite,stickimposter:()=>o.stickimposter,stickimposteroutline:()=>o.stickimposteroutline,volumetric:()=>o.volumetric});var o=t("./src/WebGL/shaders/lib/index.ts"),c=t("./src/WebGL/shaders/utils/index.ts");t("./src/WebGL/shaders/ShaderType.ts")}),"./src/WebGL/shaders/lib/basic/index.ts":((e,r,t)=>{t.r(r),t.d(r,{basic:()=>y});var o=t("./src/WebGL/shaders/lib/basic/uniforms.ts"),c=t("./src/WebGL/shaders/lib/basic/basic.frag"),u=t("./src/WebGL/shaders/lib/basic/basic.vert");const y={vertexShader:u.default.replace("#define GLSLIFY 1",""),fragmentShader:c.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/basic/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}}}),"./src/WebGL/shaders/lib/blur/index.ts":((e,r,t)=>{t.r(r),t.d(r,{blur:()=>y});var o=t("./src/WebGL/shaders/lib/blur/uniforms.ts"),c=t("./src/WebGL/shaders/lib/blur/blur.frag"),u=t("./src/WebGL/shaders/lib/blur/blur.vert");const y={fragmentShader:c.default,vertexShader:u.default,uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/blur/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>o});const o={}}),"./src/WebGL/shaders/lib/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ShaderLib:()=>w,basic:()=>o.basic,instanced:()=>c.instanced,lambert:()=>u.lambert,lambertdouble:()=>y.lambertdouble,outline:()=>f.outline,screen:()=>g.screen,screenaa:()=>_.screenaa,sphereimposter:()=>p.sphereimposter,sphereimposteroutline:()=>S.sphereimposteroutline,sprite:()=>A.sprite,stickimposter:()=>R.stickimposter,stickimposteroutline:()=>z.stickimposteroutline,volumetric:()=>l.volumetric});var o=t("./src/WebGL/shaders/lib/basic/index.ts"),c=t("./src/WebGL/shaders/lib/instanced/index.ts"),u=t("./src/WebGL/shaders/lib/lambert/index.ts"),y=t("./src/WebGL/shaders/lib/lambertdouble/index.ts"),f=t("./src/WebGL/shaders/lib/outline/index.ts"),g=t("./src/WebGL/shaders/lib/screen/index.ts"),_=t("./src/WebGL/shaders/lib/screenaa/index.ts"),p=t("./src/WebGL/shaders/lib/sphereimposter/index.ts"),S=t("./src/WebGL/shaders/lib/sphereimposteroutline/index.ts"),A=t("./src/WebGL/shaders/lib/sprite/index.ts"),R=t("./src/WebGL/shaders/lib/stickimposter/index.ts"),z=t("./src/WebGL/shaders/lib/stickimposteroutline/index.ts"),l=t("./src/WebGL/shaders/lib/volumetric/index.ts"),s=t("./src/WebGL/shaders/lib/ssao/index.ts"),v=t("./src/WebGL/shaders/lib/blur/index.ts");const w={basic:o.basic,blur:v.blur,instanced:c.instanced,lambert:u.lambert,lambertdouble:y.lambertdouble,outline:f.outline,screen:g.screen,screenaa:_.screenaa,ssao:s.ssao,sphereimposter:p.sphereimposter,sphereimposteroutline:S.sphereimposteroutline,sprite:A.sprite,stickimposter:R.stickimposter,stickimposteroutline:z.stickimposteroutline,volumetric:l.volumetric}}),"./src/WebGL/shaders/lib/instanced/index.ts":((e,r,t)=>{t.r(r),t.d(r,{instanced:()=>y});var o=t("./src/WebGL/shaders/lib/instanced/uniforms.ts"),c=t("./src/WebGL/shaders/lib/instanced/instanced.frag"),u=t("./src/WebGL/shaders/lib/instanced/instanced.vert");const y={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/instanced/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/lambert/index.ts":((e,r,t)=>{t.r(r),t.d(r,{lambert:()=>y});var o=t("./src/WebGL/shaders/lib/lambert/uniforms.ts"),c=t("./src/WebGL/shaders/lib/lambert/lambert.frag"),u=t("./src/WebGL/shaders/lib/lambert/lambert.vert");const y={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/lambert/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/lambertdouble/index.ts":((e,r,t)=>{t.r(r),t.d(r,{lambertdouble:()=>y});var o=t("./src/WebGL/shaders/lib/lambertdouble/uniforms.ts"),c=t("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag"),u=t("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert");const y={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/lambertdouble/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/outline/index.ts":((e,r,t)=>{t.r(r),t.d(r,{outline:()=>y});var o=t("./src/WebGL/shaders/lib/outline/uniforms.ts"),c=t("./src/WebGL/shaders/lib/outline/outline.frag"),u=t("./src/WebGL/shaders/lib/outline/outline.vert");const y={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/outline/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new o.Color(0,0,0)},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/screen/index.ts":((e,r,t)=>{t.r(r),t.d(r,{screen:()=>y});var o=t("./src/WebGL/shaders/lib/screen/uniforms.ts"),c=t("./src/WebGL/shaders/lib/screen/screen.frag"),u=t("./src/WebGL/shaders/lib/screen/screen.vert");const y={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/screen/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>o});const o={}}),"./src/WebGL/shaders/lib/screenaa/index.ts":((e,r,t)=>{t.r(r),t.d(r,{screenaa:()=>y});var o=t("./src/WebGL/shaders/lib/screenaa/uniforms.ts"),c=t("./src/WebGL/shaders/lib/screenaa/screenaa.frag"),u=t("./src/WebGL/shaders/lib/screenaa/screenaa.vert");const y={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/screenaa/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>o});const o={}}),"./src/WebGL/shaders/lib/sphereimposter/index.ts":((e,r,t)=>{t.r(r),t.d(r,{sphereimposter:()=>y});var o=t("./src/WebGL/shaders/lib/sphereimposter/uniforms.ts"),c=t("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag"),u=t("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert");const y={vertexShader:u.default.replace("#define GLSLIFY 1",""),fragmentShader:c.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/sphereimposter/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/sphereimposteroutline/index.ts":((e,r,t)=>{t.r(r),t.d(r,{sphereimposteroutline:()=>y});var o=t("./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts"),c=t("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag"),u=t("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert");const y={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new o.Color(0,0,0)},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/sprite/index.ts":((e,r,t)=>{t.r(r),t.d(r,{sprite:()=>y});var o=t("./src/WebGL/shaders/lib/sprite/uniforms.ts"),c=t("./src/WebGL/shaders/lib/sprite/sprite.frag"),u=t("./src/WebGL/shaders/lib/sprite/sprite.vert");const y={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/sprite/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>o});const o={}}),"./src/WebGL/shaders/lib/ssao/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ssao:()=>y});var o=t("./src/WebGL/shaders/lib/ssao/uniforms.ts"),c=t("./src/WebGL/shaders/lib/ssao/ssao.frag"),u=t("./src/WebGL/shaders/lib/ssao/ssao.vert");const y={fragmentShader:c.default,vertexShader:u.default,uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/ssao/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>o});const o={total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}}),"./src/WebGL/shaders/lib/stickimposter/index.ts":((e,r,t)=>{t.r(r),t.d(r,{stickimposter:()=>f});var o=t("./src/WebGL/shaders/lib/stickimposter/uniforms.ts"),c=t("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),u=t("./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag"),y=t("./src/WebGL/shaders/lib/stickimposter/stickimposter.vert");const f={fragmentShader:[c.default,u.default].join(`
`),vertexShader:y.default,uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/stickimposter/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/stickimposteroutline/index.ts":((e,r,t)=>{t.r(r),t.d(r,{stickimposteroutline:()=>y});var o=t("./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts"),c=t("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),u=t("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert");const y={fragmentShader:c.default+"gl_FragColor = vec4(color,1.0);}",vertexShader:u.default,uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new o.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/volumetric/index.ts":((e,r,t)=>{t.r(r),t.d(r,{volumetric:()=>y});var o=t("./src/WebGL/shaders/lib/volumetric/uniforms.ts"),c=t("./src/WebGL/shaders/lib/volumetric/volumetric.frag"),u=t("./src/WebGL/shaders/lib/volumetric/volumetric.vert");const y={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/volumetric/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}}}),"./src/WebGL/shaders/utils/clone.ts":((e,r,t)=>{t.r(r),t.d(r,{clone:()=>c});var o=t("./src/colors.ts");function c(u){let y={};for(const g in u){y[g]={},y[g].type=u[g].type;var f=u[g].value;f instanceof o.Color?y[g].value=f.clone():typeof f=="number"?y[g].value=f:f instanceof Array?y[g].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return y}}),"./src/WebGL/shaders/utils/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ShaderUtils:()=>c,clone:()=>o.clone});var o=t("./src/WebGL/shaders/utils/clone.ts");const c={clone:o.clone}}),"./src/WebGL/shapes/Cylinder.ts":((e,r,t)=>{t.r(r),t.d(r,{Cylinder:()=>u});var o=t("./src/WebGL/math/index.ts");let c=new o.Vector3;class u{constructor(f=new o.Vector3,g=new o.Vector3,_=0){this.c1=f,this.c2=g,this.radius=_,this.direction=new o.Vector3().subVectors(this.c2,this.c1).normalize()}copy(f){return this.c1.copy(f.c1),this.c2.copy(f.c2),this.direction.copy(f.direction),this.radius=f.radius,this}lengthSq(){return c.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(f){return this.direction.add(this.c1).applyMatrix4(f),this.c1.applyMatrix4(f),this.c2.applyMatrix4(f),this.direction.sub(this.c1).normalize(),this.radius=this.radius*f.getMaxScaleOnAxis(),this}}}),"./src/WebGL/shapes/Sphere.ts":((e,r,t)=>{t.r(r),t.d(r,{Sphere:()=>c});var o=t("./src/WebGL/math/index.ts");class c{constructor(y={x:0,y:0,z:0},f=0){this.center=new o.Vector3(y.x,y.y,y.z),this.radius=f}set(y,f){return this.center.copy(y),this.radius=f,this}copy(y){return this.center.copy(y.center),this.radius=y.radius,this}applyMatrix4(y){return this.center.applyMatrix4(y),this.radius=this.radius*y.getMaxScaleOnAxis(),this}translate(y){return this.center.add(y),this}equals(y){return y.center.equals(this.center)&&y.radius===this.radius}clone(){return new c().copy(this)}}}),"./src/WebGL/shapes/Triangle.ts":((e,r,t)=>{t.r(r),t.d(r,{Triangle:()=>u});var o=t("./src/WebGL/math/index.ts");const c=new o.Vector3;class u{constructor(f=new o.Vector3,g=new o.Vector3,_=new o.Vector3){this.a=f,this.b=g,this.c=_}copy(f){return this.a.copy(f.a),this.b.copy(f.b),this.c.copy(f.c),this}applyMatrix4(f){return this.a.applyMatrix4(f),this.b.applyMatrix4(f),this.c.applyMatrix4(f),this}getNormal(){var f=this.a.clone();return f.sub(this.b),c.subVectors(this.c,this.b),f.cross(c),f.normalize(),f}}}),"./src/WebGL/shapes/index.ts":((e,r,t)=>{t.r(r),t.d(r,{Cylinder:()=>c.Cylinder,Sphere:()=>o.Sphere,Triangle:()=>u.Triangle});var o=t("./src/WebGL/shapes/Sphere.ts"),c=t("./src/WebGL/shapes/Cylinder.ts"),u=t("./src/WebGL/shapes/Triangle.ts")}),"./src/autoload.ts":((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{autoinit:()=>autoinit,autoload:()=>autoload,processing_autoinit:()=>processing_autoinit,viewers:()=>viewers});var _GLViewer__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/GLViewer.ts"),_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/ProteinSurface4.ts"),_utilities__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utilities.ts"),_colors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/colors.ts"),autoinit=!1,processing_autoinit=!1,viewers={};function autoload(viewer,callback){var i,dataname,type;if(document.querySelector(".viewer_3Dmoljs")!=null&&(autoinit=!0),autoinit){processing_autoinit=!0,viewer=viewer??null;var nviewers=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(viewerdiv=>{var datauri=[],datatypes=[],uri="";viewerdiv.style.position=="static"&&(viewerdiv.style.position="relative");var UI=null;if(type=null,viewerdiv.dataset.pdb)datauri.push("https://files.rcsb.org/view/"+viewerdiv.dataset.pdb+".pdb"),datatypes.push("pdb");else if(viewerdiv.dataset.cid)datatypes.push("sdf"),datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+viewerdiv.dataset.cid+"/SDF?record_type=3d");else if(viewerdiv.dataset.href||viewerdiv.dataset.url){if(viewerdiv.dataset.href?uri=viewerdiv.dataset.href:uri=viewerdiv.dataset.url,datauri.push(uri),type=uri.substring(uri.lastIndexOf(".")+1),type=="gz"){let e=uri.substring(0,uri.lastIndexOf(".")).lastIndexOf(".");type=uri.substring(e+1)}datatypes.push(type);var molName=uri.substring(uri.lastIndexOf("/")+1,uri.lastIndexOf("."));molName=="/"&&(molName=uri.substring(uri.lastIndexOf("/")+1)),viewerdiv.dataset[datatypes[datatypes.length-1]]=molName}let divdata=viewerdiv.dataset;for(i in divdata)i.substring(0,3)==="pdb"&&i!=="pdb"?(datauri.push("https://files.rcsb.org/view/"+divdata[i]+".pdb"),datatypes.push("pdb")):i.substring(0,4)==="href"&&i!=="href"?(uri=divdata[i],datauri.push(uri),datatypes.push(uri.substring(uri.lastIndexOf(".")+1))):i.substring(0,3)==="cid"&&i!=="cid"&&(datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+divdata[i]+"/SDF?record_type=3d"),datatypes.push("sdf"));var options={};viewerdiv.dataset.options&&(options=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.options));var bgcolor=_colors__WEBPACK_IMPORTED_MODULE_3__.CC.color(viewerdiv.dataset.backgroundcolor),bgalpha=viewerdiv.dataset.backgroundalpha;bgalpha=bgalpha==null?1:parseFloat(bgalpha);var style={line:{}};viewerdiv.dataset.style&&(style=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.style));var select={};viewerdiv.dataset.select&&(select=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.select));var selectstylelist=[],surfaces=[],labels=[],zoomto={},spin=null,d=viewerdiv.dataset,stylere=/style(.+)/,surfre=/surface(.*)/,reslabre=/labelres(.*)/,keys=[];for(dataname in d)Object.prototype.hasOwnProperty.call(d,dataname)&&keys.push(dataname);for(keys.sort(),i=0;i<keys.length;i++){dataname=keys[i];var m=stylere.exec(dataname),selname,newsel,styleobj;m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),selectstylelist.push([newsel,styleobj])),m=surfre.exec(dataname),m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),surfaces.push([newsel,styleobj])),m=reslabre.exec(dataname),m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),labels.push([newsel,styleobj])),dataname=="zoomto"&&(zoomto=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname])),dataname=="spin"&&(spin=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]))}var applyStyles=function(e){for(e.setStyle(select,style),UI&&UI.createSelectionAndStyle(select,style),i=0;i<selectstylelist.length;i++){let r=selectstylelist[i][0]||{},t=selectstylelist[i][1]||{line:{}};e.setStyle(r,t),UI&&UI.createSelectionAndStyle(select,style)}for(i=0;i<surfaces.length;i++){let r=surfaces[i][0]||{},t=surfaces[i][1]||{};UI?e.addSurface(_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__.SurfaceType.VDW,t,r,r).then(o=>{UI.loadSurface("VDW",r,t,o)}):e.addSurface(_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__.SurfaceType.VDW,t,r,r)}for(i=0;i<labels.length;i++){let r=labels[i][0]||{},t=labels[i][1]||{};e.addResLabels(r,t)}e.render(),e.zoomTo(zoomto),spin&&e.spin(spin.axis,spin.speed)};let glviewer=viewer;try{var config=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.config)||{};config.backgroundColor===void 0&&(config.backgroundColor=bgcolor),config.backgroundAlpha===void 0&&(config.backgroundAlpha=bgalpha),glviewer==null?glviewer=viewers[viewerdiv.id||nviewers++]=(0,_GLViewer__WEBPACK_IMPORTED_MODULE_0__.createViewer)(viewerdiv,config):(glviewer.setBackgroundColor(bgcolor,bgalpha),glviewer.setConfig(config),UI&&UI.initiateUI()),viewerdiv.dataset.ui&&$3Dmol.StateManager&&(UI=new $3Dmol.StateManager(glviewer))}catch(e){console.log(e),viewerdiv.textContent="WebGL appears to be disabled."}if(datauri.length!=0){let i=0,process=((viewerdiv,glviewer)=>function(moldata){uri=datauri[i];var type=viewerdiv.dataset.type||viewerdiv.dataset.datatype||datatypes[i];if(glviewer.addModel(moldata,type,options),UI){var modelName=viewerdiv.dataset[datatypes[i]];UI.setModelTitle(modelName)}if(i+=1,i<datauri.length)(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.get)(datauri[i]).then(process);else{if(applyStyles(glviewer),viewerdiv.dataset.callback){var runres=eval(viewerdiv.dataset.callback);typeof runres=="function"&&runres(glviewer)}processing_autoinit=!1,callback&&callback(glviewer)}})(viewerdiv,glviewer);type&&type.endsWith("gz")?(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.getbin)(datauri[0]).then(process):(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.get)(datauri[0]).then(process)}else{if(viewerdiv.dataset.element){var moldataid="#"+viewerdiv.dataset.element,molelem=document.querySelector(moldataid),moldata=molelem?molelem.textContent:"";type=viewerdiv.dataset.type||viewerdiv.dataset.datatype,glviewer.addModel(moldata,type,options)}if(applyStyles(glviewer),viewerdiv.dataset.callback){var runres=eval(viewerdiv.dataset.callback);typeof runres=="function"&&runres(glviewer)}processing_autoinit=!1,callback&&callback(glviewer)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&autoload()}}),"./src/colors.ts":((e,r,t)=>{t.r(r),t.d(r,{CC:()=>c,Color:()=>o,builtinColorSchemes:()=>S,chains:()=>p,elementColors:()=>g,htmlColors:()=>u,residues:()=>_,ssColors:()=>y});class o{constructor(R,z,l){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof R=="number"?(this.r=R||0,this.g=z||0,this.b=l||0,this):this.set(R||0)}set(R){return R instanceof o?R.clone():(typeof R=="number"?this.setHex(R):typeof R=="object"&&(this.r=R?.r||0,this.g=R?.g||0,this.b=R?.b||0),this)}setHex(R){return R=Math.floor(R),this.r=(R>>16&255)/255,this.g=(R>>8&255)/255,this.b=(R&255)/255,this}getHex(){var R=Math.round(this.r*255),z=Math.round(this.g*255),l=Math.round(this.b*255);return R<<16|z<<8|l}clone(){return new o(this.r,this.g,this.b)}copy(R){return this.r=R.r,this.g=R.g,this.b=R.b,this}scaled(){var R={};return R.r=Math.round(this.r*255),R.g=Math.round(this.g*255),R.b=Math.round(this.b*255),R.a=1,R}}class c{static color(R){if(!R)return c.cache[0];if(R instanceof o)return R;if(typeof R=="number"&&typeof c.cache[R]<"u")return c.cache[R];if(R&&Array.isArray(R))return R.map(c.color);let z=c.getHex(R),l=new o(z);return c.cache[z]=l,l}static getHex(R){var z;if(Array.isArray(R))return R.map(c.getHex);if(typeof R=="string"){let l=R;if(!isNaN(parseInt(l)))return parseInt(l);if(l=l.trim(),l.length==4&&l[0]=="#"&&(l="#"+l[1]+l[1]+l[2]+l[2]+l[3]+l[3]),l.length==7&&l[0]=="#")return parseInt(l.substring(1),16);let s=c.rgbRegEx.exec(l);if(s){s[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let v=0;for(let w=2;w<5;w++){v*=256;let E=s[w].endsWith("%")?255*parseFloat(s[w])/100:parseFloat(s[w]);v+=Math.round(E)}return v}return((z=window?.$3Dmol)===null||z===void 0?void 0:z.htmlColors[R.toLowerCase()])||0}return R}}c.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,c.cache={0:new o(0)};const u={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},y={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},f={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},g={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:f,defaultColors:Object.assign({},f),greenCarbon:Object.assign(Object.assign({},f),{C:65280}),cyanCarbon:Object.assign(Object.assign({},f),{C:65535}),magentaCarbon:Object.assign(Object.assign({},f),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},f),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},f),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},f),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},f),{C:8388736}),blueCarbon:Object.assign(Object.assign({},f),{C:255})},_={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},p={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},S={ssPyMol:{prop:"ss",map:y.pyMol},ssJmol:{prop:"ss",map:y.Jmol},Jmol:{prop:"elem",map:g.Jmol},amino:{prop:"resn",map:_.amino},shapely:{prop:"resn",map:_.shapely},nucleic:{prop:"resn",map:_.nucleic},chain:{prop:"chain",map:p.atom},rasmol:{prop:"elem",map:g.rasmol},default:{prop:"elem",map:g.defaultColors},greenCarbon:{prop:"elem",map:g.greenCarbon},chainHetatm:{prop:"chain",map:p.hetatm},cyanCarbon:{prop:"elem",map:g.cyanCarbon},magentaCarbon:{prop:"elem",map:g.magentaCarbon},purpleCarbon:{prop:"elem",map:g.purpleCarbon},whiteCarbon:{prop:"elem",map:g.whiteCarbon},orangeCarbon:{prop:"elem",map:g.orangeCarbon},yellowCarbon:{prop:"elem",map:g.yellowCarbon},blueCarbon:{prop:"elem",map:g.blueCarbon}}}),"./src/glcartoon.ts":((e,r,t)=>{t.r(r),t.d(r,{drawCartoon:()=>X,subdivide_spline:()=>p});var o=t("./src/WebGL/math/index.ts"),c=t("./src/WebGL/shapes/index.ts"),u=t("./src/WebGL/index.ts"),y=t("./src/Gradient.ts"),f=t("./src/colors.ts"),g=t("./src/GLDraw.ts"),_=t("./src/utilities.ts");function p(B,L){var H=[],U=B;U=[],U.push(B[0]);var Y,W,q,G,$,Z,xe,ce,Ne;for(Y=1,W=B.length-1;Y<W;Y++)if($=B[Y],Z=B[Y+1],$.smoothen){var Pe=new o.Vector3(($.x+Z.x)/2,($.y+Z.y)/2,($.z+Z.z)/2);Pe.atom=$.atom,U.push(Pe)}else U.push($);for(U.push(B[B.length-1]),Y=-1,q=U.length;Y<=q-3;Y++)if(G=U[Y===-1?0:Y],$=U[Y+1],Z=U[Y+2],xe=U[Y===q-3?q-1:Y+3],ce=new o.Vector3().subVectors(Z,G).multiplyScalar(.5),Ne=new o.Vector3().subVectors(xe,$).multiplyScalar(.5),!Z.skip)for(var De=0;De<L;De++){var Me=1/L*De,Be=$.x+Me*ce.x+Me*Me*(-3*$.x+3*Z.x-2*ce.x-Ne.x)+Me*Me*Me*(2*$.x-2*Z.x+ce.x+Ne.x),ft=$.y+Me*ce.y+Me*Me*(-3*$.y+3*Z.y-2*ce.y-Ne.y)+Me*Me*Me*(2*$.y-2*Z.y+ce.y+Ne.y),Ot=$.z+Me*ce.z+Me*Me*(-3*$.z+3*Z.z-2*ce.z-Ne.z)+Me*Me*Me*(2*$.z-2*Z.z+ce.z+Ne.z),Gt=new o.Vector3(Be,ft,Ot);De<L/2?Gt.atom=$.atom:Gt.atom=Z.atom,H.push(Gt)}return H.push(U[U.length-1]),H}const S=.5,A=1.3,R=.8,z=.4,l=.4;function s(B,L,H,U){for(var Y,W,q,G,$=0,Z=L.length;$<Z;$++){G=Math.round($*(U.length-1)/Z),q=f.CC.color(U[G]);var xe=B.updateGeoGroup(2),ce=xe.vertexArray,Ne=xe.colorArray,Pe=xe.faceArray;Y=xe.vertices,W=Y*3,ce[W]=L[$].x,ce[W+1]=L[$].y,ce[W+2]=L[$].z,ce[W+3]=H[$].x,ce[W+4]=H[$].y,ce[W+5]=H[$].z;for(var De=0;De<6;++De)Ne[W+3*De]=q.r,Ne[W+1+3*De]=q.g,Ne[W+2+3*De]=q.b;if($>0){var Me=[Y,Y+1,Y-1,Y-2],Be=xe.faceidx;Pe[Be]=Me[0],Pe[Be+1]=Me[1],Pe[Be+2]=Me[3],Pe[Be+3]=Me[1],Pe[Be+4]=Me[2],Pe[Be+5]=Me[3],xe.faceidx+=6}xe.vertices+=2}}function v(B,L,H,U,Y,W,q){var G,$,Z,xe;if(Z=L.length,Z<2||L[0].length<2)return;for(G=0;G<Z;G++)L[G]=p(L[G],U);if(xe=L[0].length,!Y)return s(B,L[0],L[Z-1],H);var ce,Ne,Pe,De,Me,Be,ft=[],Ot=[],Gt=[];for($=0;$<Z;$++)ft.push(.25+1.5*Math.sqrt((Z-1)*$-Math.pow($,2))/(Z-1)),Ot.push(.5),Gt.push(2*(Math.pow($/Z,2)-$/Z)+.6);var mt=[];for($=0;$<Z*2-1;$++)mt[$]=[$,$+1,$+1-2*Z,$-2*Z];mt[Z*2-1]=[$,$+1-2*Z,$+1-4*Z,$-2*Z];var je,ht,Kt,Jt,Wt,Br,zr,cr,Nr,At;let Mt=B.updateGeoGroup();for(G=0;G<xe;G++){let ve=B.groups,we=!1;Mt=B.updateGeoGroup(2*Z),ve!=B.groups&&G>0&&(G=G-1,we=!0),Br=Math.round(G*(H.length-1)/xe),Wt=f.CC.color(H[Br]),Me=Pe,Be=De,Pe=[],De=[],ce=[],L[0][G].atom!==void 0&&(Jt=L[0][G].atom,q==="oval"?Ne=ft:q==="rectangle"?Ne=Ot:q==="parabola"&&(Ne=Gt)),Ne||(Ne=Ot);var Jr,Yr;for($=0;$<Z;$++)G<xe-1?Jr=L[$][G+1].clone().sub(L[$][G]):Jr=L[$][G-1].clone().sub(L[$][G]).negate(),$<Z-1?Yr=L[$+1][G].clone().sub(L[$][G]):Yr=L[$-1][G].clone().sub(L[$][G]).negate(),ce[$]=Yr.cross(Jr).normalize().multiplyScalar(Y*Ne[$]);for($=0;$<Z;$++)Pe[$]=L[$][G].clone().add(ce[$].clone().negate());for($=0;$<Z;$++)De[$]=L[$][G].clone().add(ce[$]);for(zr=Mt.vertexArray,cr=Mt.colorArray,Nr=Mt.faceArray,je=Mt.vertices,ht=je*3,$=0;$<Z;$++)zr[ht+3*$+0]=Pe[$].x,zr[ht+3*$+1]=Pe[$].y,zr[ht+3*$+2]=Pe[$].z;for($=0;$<Z;$++)zr[ht+3*$+0+3*Z]=De[Z-1-$].x,zr[ht+3*$+1+3*Z]=De[Z-1-$].y,zr[ht+3*$+2+3*Z]=De[Z-1-$].z;for($=0;$<2*Z;++$)cr[ht+3*$+0]=Wt.r,cr[ht+3*$+1]=Wt.g,cr[ht+3*$+2]=Wt.b;if(G>0&&!we){for($=0;$<Z*2;$++)At=[je+mt[$][0],je+mt[$][1],je+mt[$][2],je+mt[$][3]],Kt=Mt.faceidx,Nr[Kt]=At[0],Nr[Kt+1]=At[1],Nr[Kt+2]=At[3],Nr[Kt+3]=At[1],Nr[Kt+4]=At[2],Nr[Kt+5]=At[3],Mt.faceidx+=6;if(Jt.clickable||Jt.hoverable){var ie=[];ie.push(new c.Triangle(Me[0],Pe[0],Pe[Z-1])),ie.push(new c.Triangle(Me[0],Pe[Z-1],Me[Z-1])),ie.push(new c.Triangle(Me[Z-1],Pe[Z-1],De[Z-1])),ie.push(new c.Triangle(Me[Z-1],De[Z-1],Be[Z-1])),ie.push(new c.Triangle(De[0],Be[0],Be[Z-1])),ie.push(new c.Triangle(De[Z-1],De[0],Be[Z-1])),ie.push(new c.Triangle(Pe[0],Me[0],Be[0])),ie.push(new c.Triangle(De[0],Pe[0],Be[0]));for($ in ie)Jt.intersectionShape.triangle.push(ie[$])}}Mt.vertices+=2*Z}for(zr=Mt.vertexArray,cr=Mt.colorArray,Nr=Mt.faceArray,je=Mt.vertices,ht=je*3,Kt=Mt.faceidx,G=0;G<Z-1;G++)At=[G,G+1,2*Z-2-G,2*Z-1-G],Kt=Mt.faceidx,Nr[Kt]=At[0],Nr[Kt+1]=At[1],Nr[Kt+2]=At[3],Nr[Kt+3]=At[1],Nr[Kt+4]=At[2],Nr[Kt+5]=At[3],Mt.faceidx+=6;for(G=0;G<Z-1;G++)At=[je-1-G,je-2-G,je-2*Z+G+1,je-2*Z+G],Kt=Mt.faceidx,Nr[Kt]=At[0],Nr[Kt+1]=At[1],Nr[Kt+2]=At[3],Nr[Kt+3]=At[1],Nr[Kt+4]=At[2],Nr[Kt+5]=At[3],Mt.faceidx+=6}function w(B,L,H,U,Y,W){if(!(L.length<2)){var q,G;if(q=L[0],G=L[L.length-1],q=p(q,U),G=p(G,U),!Y)return s(B,q,G,H);var $=[],Z,xe,ce,Ne,Pe,De=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],Me,Be,ft,Ot,Gt,mt,je,ht,Kt,Jt,Wt,Br,zr,cr,Nr,At,Mt;for(ht=0,Kt=q.length;ht<Kt;ht++){if(Gt=Math.round(ht*(H.length-1)/Kt),Ot=f.CC.color(H[Gt]),$.push(xe=q[ht]),$.push(xe),$.push(ce=G[ht]),$.push(ce),ht<Kt-1){var Jr=q[ht+1].clone().sub(q[ht]),Yr=G[ht].clone().sub(q[ht]);Z=Yr.cross(Jr).normalize().multiplyScalar(Y)}for($.push(Ne=q[ht].clone().add(Z)),$.push(Ne),$.push(Pe=G[ht].clone().add(Z)),$.push(Pe),xe.atom!==void 0&&(mt=xe.atom),cr=B.updateGeoGroup(8),Nr=cr.vertexArray,At=cr.colorArray,Mt=cr.faceArray,Me=cr.vertices,Be=Me*3,Nr[Be]=xe.x,Nr[Be+1]=xe.y,Nr[Be+2]=xe.z,Nr[Be+3]=xe.x,Nr[Be+4]=xe.y,Nr[Be+5]=xe.z,Nr[Be+6]=ce.x,Nr[Be+7]=ce.y,Nr[Be+8]=ce.z,Nr[Be+9]=ce.x,Nr[Be+10]=ce.y,Nr[Be+11]=ce.z,Nr[Be+12]=Ne.x,Nr[Be+13]=Ne.y,Nr[Be+14]=Ne.z,Nr[Be+15]=Ne.x,Nr[Be+16]=Ne.y,Nr[Be+17]=Ne.z,Nr[Be+18]=Pe.x,Nr[Be+19]=Pe.y,Nr[Be+20]=Pe.z,Nr[Be+21]=Pe.x,Nr[Be+22]=Pe.y,Nr[Be+23]=Pe.z,Jt=0;Jt<8;++Jt)At[Be+3*Jt]=Ot.r,At[Be+1+3*Jt]=Ot.g,At[Be+2+3*Jt]=Ot.b;if(ht>0){var ie=je!==void 0&&mt!==void 0&&je.serial!==mt.serial;for(Jt=0;Jt<4;Jt++){var ve=[Me+De[Jt][0],Me+De[Jt][1],Me+De[Jt][2],Me+De[Jt][3]];if(ft=cr.faceidx,Mt[ft]=ve[0],Mt[ft+1]=ve[1],Mt[ft+2]=ve[3],Mt[ft+3]=ve[1],Mt[ft+4]=ve[2],Mt[ft+5]=ve[3],cr.faceidx+=6,mt.clickable||je.clickable||mt.hoverable||je.hoverable){var we=$[ve[3]].clone(),it=$[ve[0]].clone(),rt=$[ve[2]].clone(),Yt=$[ve[1]].clone();if(we.atom=$[ve[3]].atom||null,rt.atom=$[ve[2]].atom||null,it.atom=$[ve[0]].atom||null,Yt.atom=$[ve[1]].atom||null,ie){var jt=we.clone().add(it).multiplyScalar(.5),re=rt.clone().add(Yt).multiplyScalar(.5),tt=we.clone().add(Yt).multiplyScalar(.5);Jt%2===0?((je.clickable||je.hoverable)&&(Wt=new c.Triangle(jt,tt,we),Br=new c.Triangle(re,rt,tt),zr=new c.Triangle(tt,rt,we),je.intersectionShape.triangle.push(Wt),je.intersectionShape.triangle.push(Br),je.intersectionShape.triangle.push(zr)),(mt.clickable||mt.hoverable)&&(Wt=new c.Triangle(it,Yt,tt),Br=new c.Triangle(Yt,re,tt),zr=new c.Triangle(it,tt,jt),mt.intersectionShape.triangle.push(Wt),mt.intersectionShape.triangle.push(Br),mt.intersectionShape.triangle.push(zr))):((mt.clickable||mt.hoverable)&&(Wt=new c.Triangle(jt,tt,we),Br=new c.Triangle(re,rt,tt),zr=new c.Triangle(tt,rt,we),mt.intersectionShape.triangle.push(Wt),mt.intersectionShape.triangle.push(Br),mt.intersectionShape.triangle.push(zr)),(je.clickable||je.hoverable)&&(Wt=new c.Triangle(it,Yt,tt),Br=new c.Triangle(Yt,re,tt),zr=new c.Triangle(it,tt,jt),je.intersectionShape.triangle.push(Wt),je.intersectionShape.triangle.push(Br),je.intersectionShape.triangle.push(zr)))}else(mt.clickable||mt.hoverable)&&(Wt=new c.Triangle(it,Yt,we),Br=new c.Triangle(Yt,rt,we),mt.intersectionShape.triangle.push(Wt),mt.intersectionShape.triangle.push(Br))}}}cr.vertices+=8,je=mt}var lt=$.length-8;for(cr=B.updateGeoGroup(8),Nr=cr.vertexArray,At=cr.colorArray,Mt=cr.faceArray,Me=cr.vertices,Be=Me*3,ft=cr.faceidx,ht=0;ht<4;ht++){$.push($[ht*2]),$.push($[lt+ht*2]);var ar=$[ht*2],et=$[lt+ht*2];Nr[Be+6*ht]=ar.x,Nr[Be+1+6*ht]=ar.y,Nr[Be+2+6*ht]=ar.z,Nr[Be+3+6*ht]=et.x,Nr[Be+4+6*ht]=et.y,Nr[Be+5+6*ht]=et.z,At[Be+6*ht]=Ot.r,At[Be+1+6*ht]=Ot.g,At[Be+2+6*ht]=Ot.b,At[Be+3+6*ht]=Ot.r,At[Be+4+6*ht]=Ot.g,At[Be+5+6*ht]=Ot.b}lt+=8,Wt=[Me,Me+2,Me+6,Me+4],Br=[Me+1,Me+5,Me+7,Me+3],Mt[ft]=Wt[0],Mt[ft+1]=Wt[1],Mt[ft+2]=Wt[3],Mt[ft+3]=Wt[1],Mt[ft+4]=Wt[2],Mt[ft+5]=Wt[3],Mt[ft+6]=Br[0],Mt[ft+7]=Br[1],Mt[ft+8]=Br[3],Mt[ft+9]=Br[1],Mt[ft+10]=Br[2],Mt[ft+11]=Br[3],cr.faceidx+=12,cr.vertices+=8}}function E(B,L,H,U,Y,W,q){(!q||q==="default")&&(q="rectangle"),q==="edged"?w(B,L,H,U,Y):(q==="rectangle"||q==="oval"||q==="parabola")&&v(B,L,H,U,Y,W,q)}function C(B){return B&&B.elem==="C"&&B.atom==="CA"}function h(B,L){if(B&&L&&B.chain===L.chain){if(!B.hetflag&&!L.hetflag&&B.reschain===L.reschain&&(B.resi===L.resi||B.resi===L.resi-1))return!0;if(B.resi<L.resi){var H=B.x-L.x,U=B.y-L.y,Y=B.z-L.z,W=H*H+U*U+Y*Y;if(B.atom=="CA"&&L.atom=="CA"&&W<16||(B.atom=="P"||L.atom=="P")&&W<64)return!0}}return!1}function x(B,L,H,U,Y){if(!(L==null||L.vertices==0)){Y&&(L.initTypedArrays(),L.setUpNormals());var W=new u.MeshDoubleLambertMaterial;W.vertexColors=u.Coloring.FaceColors,typeof H=="number"&&H>=0&&H<1&&(W.transparent=!0,W.opacity=H),W.outline=U;var q=new u.Mesh(L,W);B.add(q)}}function k(B,L,H,U,Y,W,q,G,$){var Z,xe,ce,Ne,Pe,De;if(!(!U||!Y||!q)){var Me=Y.sub(U);Me.normalize();var Be=G[$];for(xe=$+1;xe<G.length&&(Be=G[xe],Be.atom!=q.atom);xe++);if(Be=Be?new o.Vector3(Be.x,Be.y,Be.z):new o.Vector3(0,0,0),Be.sub(U),q.ss==="arrow start"){var ft=Be.clone().multiplyScalar(.3).cross(Y);U.add(ft);var Ot=Be.clone().cross(Me).normalize();Me.rotateAboutVector(Ot,.43)}for(q.style.cartoon.ribbon?Z=q.style.cartoon.thickness||z:q.style.cartoon.width?Z=q.style.cartoon.width:q.ss==="c"?q.atom==="P"?Z=R:Z=S:q.ss==="arrow start"?(Z=A,Pe=!0):q.ss==="arrow end"||q.ss==="h"&&q.style.cartoon.tubes||q.ss==="tube start"?Z=S:Z=A,W!=null&&Me.dot(W)<0&&Me.negate(),Me.multiplyScalar(Z),xe=0;xe<L;xe++)ce=-1+xe*2/(L-1),Ne=new o.Vector3(U.x+ce*Me.x,U.y+ce*Me.y,U.z+ce*Me.z),Ne.atom=q,q.ss==="s"&&(Ne.smoothen=!0),B[xe].push(Ne);if(Pe)for(Me.multiplyScalar(2),xe=0;xe<L;xe++)ce=-1+xe*2/(L-1),Ne=new o.Vector3(U.x+ce*Me.x,U.y+ce*Me.y,U.z+ce*Me.z),Ne.atom=q,Ne.smoothen=!1,Ne.skip=!0,B[xe].push(Ne);return De=q.style.cartoon.style||"default",B.style?B.style!=De&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),B.style="default"):B.style=De,(q.ss==="arrow start"||q.ss==="arrow end")&&(q.ss="s"),Pe}}const M={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},D={DA:!0,DG:!0,A:!0,G:!0},P={DT:!0,DC:!0,U:!0,C:!0,T:!0},F={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function X(B,L,H,U=10){let Y=U,W=U;var q,G,$,Z,xe,ce,Ne,Pe,De,Me,Be,ft,Ot,Gt,mt,je,ht,Kt,Jt=new u.Geometry(!0),Wt=new u.Geometry(!0),Br=[],zr=[],cr=1,Nr=!1,At={};for(var Mt in y.Gradient.builtinGradients)y.Gradient.builtinGradients.hasOwnProperty(Mt)&&(At[Mt]=new y.Gradient.builtinGradients[Mt](H[1],H[0]));var Jr=function(se,xt){return H&&xt.color==="spectrum"?xt.colorscheme in At?At[xt.colorscheme].valueToHex(se.resi):At.sinebow.valueToHex(se.resi):(0,_.getColorFromStyle)(se,xt).getHex()};for(Pe=0;Pe<Y;Pe++)zr[Pe]=[];var Yr=!1,ie=!1,ve=[];for(Pe in L){if(Z=L[Pe],Z.elem==="C"&&Z.atom==="CA"){var we=h($,Z);we&&Z.ss==="s"?Yr=!0:Yr&&($&&G&&$.style.cartoon.arrows&&G.style.cartoon.arrows&&($.ss="arrow end",G.ss="arrow start"),Yr=!1),we&&($.ss==="h"||$.ss=="tube start")&&$.style.cartoon.tubes?!ie&&$.ss!="tube start"&&Z.style.cartoon.tubes&&(Z.ss="tube start",ie=!0):ie&&($.ss==="tube start"?$.ss="tube end":G&&G.style.cartoon.tubes&&(G.ss="tube end"),ie=!1),G=$,$=Z}Z&&Z.atom in M&&ve.push(Z)}ie&&$.style.cartoon.tubes&&($.ss="tube end",ie=!1);var it=function(se){zr[0].length>0&&E(Wt,zr,Br,W,Ne,cr,zr.style);var xt=[],Vr=null;if(se){for(Pe=0;Pe<Y;Pe++)xt[Pe]=zr[Pe][zr[Pe].length-1];Vr=Br[Br.length-1]}for(zr=[],Pe=0;Pe<Y;Pe++)zr[Pe]=[];if(Br=[],se){for(Pe=0;Pe<Y;Pe++)zr[Pe].push(xt[Pe]);Br.push(Vr)}x(B,Wt,cr,Nr,!0),x(B,Jt,cr,Nr,!1),Wt=new u.Geometry(!0),Jt=new u.Geometry(!0)};$=void 0;for(var rt=0;rt<ve.length;rt++){Z=ve[rt];var Yt=Z.resn.trim(),jt=Yt in F;if(cr=1,q=Z.style.cartoon,$&&$.style.cartoon&&(cr=$.style.cartoon.opacity),$&&$.style.cartoon&&$.style.cartoon.outline&&(Nr=$.style.cartoon.outline),$&&$.style.cartoon&&(!Z.style.cartoon||$.style.cartoon.opacity!=Z.style.cartoon.opacity)&&it($.chain==Z.chain),q.style==="trace"){if(!Z.hetflag&&(Z.elem==="C"&&Z.atom==="CA"||jt&&Z.atom==="P"||Z.atom==="BB")){if(ce=Jr(Z,q),(0,_.isNumeric)(q.thickness)?Ne=q.thickness:Ne=z,h($,Z))if(ce==xe){var re=f.CC.color(ce);g.GLDraw.drawCylinder(Jt,$,Z,Ne,re,2,2)}else{var tt=new o.Vector3().addVectors($,Z).multiplyScalar(.5),lt=f.CC.color(xe),ar=f.CC.color(ce);g.GLDraw.drawCylinder(Jt,$,tt,Ne,lt,2,0),g.GLDraw.drawCylinder(Jt,tt,Z,Ne,ar,0,2)}if((Z.clickable===!0||Z.hoverable)&&Z.intersectionShape!==void 0){var et=new o.Vector3(Z.x,Z.y,Z.z);Z.intersectionShape.sphere.push(new c.Sphere(et,Ne))}$=Z,xe=ce}}else{if(C(Z)||jt&&(Z.atom==="P"||Z.atom.indexOf("O5")==0)){if(Kt)if(Z.ss==="tube end")Kt=!1,ht=new o.Vector3(Z.x,Z.y,Z.z),g.GLDraw.drawCylinder(Jt,je,ht,2,f.CC.color(xe),1,1),Z.ss="h";else if($.chain!=Z.chain||$.ss==="tube end")Kt=!1,$.ss="h",ht=new o.Vector3($.x,$.y,$.z),g.GLDraw.drawCylinder(Jt,je,ht,2,f.CC.color(xe),1,1);else continue;if($&&(!h($,Z)||$.ss==="tube start")){for($.ss==="tube start"&&(Kt=!0,je=new o.Vector3($.x,$.y,$.z),$.ss="h"),mt&&(ft?Gt=new o.Vector3().addVectors($,ft).multiplyScalar(.5):Gt=new o.Vector3($.x,$.y,$.z),g.GLDraw.drawCylinder(Jt,Gt,mt,l,f.CC.color(mt.color),0,2),k(zr,Y,!0,ft,Ot,Be,$,ve,rt),Br.push(ce),Gt=null,mt=null),zr[0].length>0&&E(Wt,zr,Br,W,Ne,cr,zr.style),zr=[],Pe=0;Pe<Y;Pe++)zr[Pe]=[];Br=[]}if($===void 0||$.rescode!=Z.rescode||$.resi!=Z.resi){if(mt&&$!=null){Gt=new o.Vector3().addVectors($,Z).multiplyScalar(.5);var Ft=Gt.clone().sub(mt).multiplyScalar(.02);Gt.add(Ft),g.GLDraw.drawCylinder(Jt,Gt,mt,l,f.CC.color(mt.color),0,2),Gt=null,mt=null}ce=Jr(Z,q),Br.push(ce),(0,_.isNumeric)(q.thickness)?Ne=q.thickness:Ne=z,$=Z,De=new o.Vector3($.x,$.y,$.z),De.resi=$.resi,xe=ce}(Z.clickable===!0||Z.hoverable===!0)&&(Z.intersectionShape===void 0||Z.intersectionShape.triangle===void 0)&&(Z.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else $!=null&&(C($)&&Z.atom==="O"||jt&&$.atom==="P"&&(Z.atom==="OP2"||Z.atom==="O2P")||jt&&$.atom.indexOf("O5")==0&&Z.atom.indexOf("C5")==0)?(Me=new o.Vector3(Z.x,Z.y,Z.z),Me.resi=Z.resi,(Z.atom==="OP2"||Z.atom==="O2P")&&(Ot=new o.Vector3(Z.x,Z.y,Z.z))):jt&&Z.atom.indexOf("O3")==0?ft=new o.Vector3(Z.x,Z.y,Z.z):(Z.atom==="N1"&&Yt in D||Z.atom==="N3"&&Yt in P)&&(mt=new o.Vector3(Z.x,Z.y,Z.z),mt.color=(0,_.getColorFromStyle)(Z,q).getHex());Me&&De&&Me.resi===De.resi&&(k(zr,Y,!0,De,Me,Be,$,ve,rt),Be=Me,De=null,Me=null,Br.push(ce))}}mt&&(ft?Gt=new o.Vector3().addVectors($,ft).multiplyScalar(.5):Gt=new o.Vector3($.x,$.y,$.z),g.GLDraw.drawCylinder(Jt,Gt,mt,l,f.CC.color(mt.color),0,2),k(zr,Y,!0,ft,Ot,Be,$,ve,rt),Br.push(ce)),it(!1)}}),"./src/index.ts":((e,r,t)=>{t.r(r),t.d(r,{CAP:()=>l.CAP,CC:()=>c.CC,CONTEXTS_PER_VIEWPORT:()=>w.CONTEXTS_PER_VIEWPORT,Color:()=>c.Color,CustomLinear:()=>o.CustomLinear,Cylinder:()=>_.Cylinder,GLDraw:()=>l.GLDraw,GLModel:()=>v.GLModel,GLShape:()=>z.GLShape,GLViewer:()=>w.GLViewer,GLVolumetricRender:()=>R.GLVolumetricRender,Gradient:()=>o.Gradient,GradientType:()=>o.GradientType,Label:()=>u.Label,LabelCount:()=>u.LabelCount,MarchingCube:()=>S.MarchingCube,MarchingCubeInitializer:()=>S.MarchingCubeInitializer,Matrix3:()=>g.Matrix3,Matrix4:()=>g.Matrix4,Parsers:()=>f.Parsers,PausableTimer:()=>p.PausableTimer,PointGrid:()=>S.PointGrid,ProteinSurface:()=>S.ProteinSurface,Quaternion:()=>g.Quaternion,ROYGB:()=>o.ROYGB,RWB:()=>o.RWB,Ray:()=>g.Ray,Sinebow:()=>o.Sinebow,Sphere:()=>_.Sphere,SurfaceType:()=>S.SurfaceType,Triangle:()=>_.Triangle,Vector2:()=>g.Vector2,Vector3:()=>g.Vector3,VolumeData:()=>A.VolumeData,adjustVolumeStyle:()=>p.adjustVolumeStyle,applyPartialCharges:()=>y.applyPartialCharges,autoinit:()=>E.autoinit,autoload:()=>E.autoload,base64ToArray:()=>p.base64ToArray,bondLength:()=>f.bondLength,builtinColorSchemes:()=>c.builtinColorSchemes,builtinGradients:()=>o.builtinGradients,chains:()=>c.chains,clamp:()=>g.clamp,conversionMatrix3:()=>g.conversionMatrix3,createStereoViewer:()=>w.createStereoViewer,createViewer:()=>w.createViewer,createViewerGrid:()=>w.createViewerGrid,deepCopy:()=>p.deepCopy,degToRad:()=>g.degToRad,download:()=>p.download,drawCartoon:()=>s.drawCartoon,elementColors:()=>c.elementColors,extend:()=>p.extend,get:()=>p.get,getAtomProperty:()=>p.getAtomProperty,getColorFromStyle:()=>p.getColorFromStyle,getElement:()=>p.getElement,getExtent:()=>p.getExtent,getGradient:()=>o.getGradient,getPropertyRange:()=>p.getPropertyRange,getbin:()=>p.getbin,htmlColors:()=>c.htmlColors,inflateString:()=>p.inflateString,isEmptyObject:()=>p.isEmptyObject,isNumeric:()=>p.isNumeric,makeFunction:()=>p.makeFunction,mergeGeos:()=>p.mergeGeos,normalizeValue:()=>o.normalizeValue,partialCharges:()=>y.partialCharges,processing_autoinit:()=>E.processing_autoinit,residues:()=>c.residues,setBondLength:()=>f.setBondLength,setSyncSurface:()=>S.setSyncSurface,specStringToObject:()=>p.specStringToObject,splitMesh:()=>z.splitMesh,ssColors:()=>c.ssColors,subdivide_spline:()=>s.subdivide_spline,syncSurface:()=>S.syncSurface,viewers:()=>E.viewers});var o=t("./src/Gradient.ts"),c=t("./src/colors.ts"),u=t("./src/Label.ts"),y=t("./src/partialCharges.ts"),f=t("./src/parsers/index.ts"),g=t("./src/WebGL/math/index.ts"),_=t("./src/WebGL/shapes/index.ts"),p=t("./src/utilities.ts"),S=t("./src/ProteinSurface4.ts"),A=t("./src/VolumeData.ts"),R=t("./src/VolumetricRender.ts"),z=t("./src/GLShape.ts"),l=t("./src/GLDraw.ts"),s=t("./src/glcartoon.ts"),v=t("./src/GLModel.ts"),w=t("./src/GLViewer.ts"),E=t("./src/autoload.ts");t("./src/specs.ts"),window&&(window.$3Dmol=r)}),"./src/parsers/BCIF.ts":((e,r,t)=>{t.r(r),t.d(r,{BCIF:()=>z});var o=t("./src/utilities.ts"),c=t("./src/parsers/utils/computeSecondaryStructure.ts"),u=t("./src/parsers/utils/processSymmetries.ts"),y=t("./src/parsers/cifutils/category.ts"),f=t("./src/parsers/utils/assignPDBBonds.ts"),g=t("./src/WebGL/index.ts"),_=t("./src/parsers/utils/isEmpty.ts"),p=t("./src/vendor/mmtf.js");class S{constructor(s){if(this.C={},s){let v=s.getField("comp_id"),w=s.getField("atom_id_1"),E=s.getField("atom_id_2"),C=s.getField("value_order");for(let h=0;h<v.length;h++){let x=v[h],k=w[h],M=E[h],D=C[h],P=1;D=="doub"?P=2:D=="trip"&&(P=3),this.C[x]==null&&(this.C[x]={}),this.C[x][k]==null&&(this.C[x][k]={}),this.C[x][M]==null&&(this.C[x][M]={}),this.C[x][k][M]=P,this.C[x][M][k]=P}}}order(s,v,w){return this.C[s]!==void 0&&this.C[s][v]!==void 0&&this.C[s][v][w]!==void 0?this.C[s][v][w]:0}}class A{constructor(s){if(this.C=[],s){let v=s.getField("conn_type_id"),w=s.getField("ptnr1_label_asym_id"),E=s.getField("ptnr1_label_seq_id"),C=s.getField("ptnr1_label_comp_id"),h=s.getField("ptnr1_label_atom_id"),x=s.getField("ptnr2_label_asym_id"),k=s.getField("ptnr2_label_seq_id"),M=s.getField("ptnr2_label_comp_id"),D=s.getField("ptnr2_label_atom_id"),P=s.getField("pdbx_value_order");for(let F=0;F<v.length;F++)if(v[F]=="disulf"||v[F]=="covale"){let X=P?P[F]==""?1:parseInt(P[F]):1;this.C.push([[w[F],E[F],C[F],h[F]],[x[F],k[F],M[F],D[F]],X])}}}}class R{constructor(){this.R={}}add(s){this.R[s.lchain]==null&&(this.R[s.lchain]={}),this.R[s.lchain][s.lresi]==null&&(this.R[s.lchain][s.lresi]={}),this.R[s.lchain][s.lresi][s.lresn]==null&&(this.R[s.lchain][s.lresi][s.lresn]=[]),this.R[s.lchain][s.lresi][s.lresn].push(s),this.R[s.lchain][s.lresi][s.lresn][s.atom]=s}geta([s,v,w,E]){if(this.R[s]!==void 0&&this.R[s][v]!==void 0&&this.R[s][v][w]!==void 0)return this.R[s][v][w][E]}setBonds(s,v){for(let w in this.R)for(let E in this.R[w])for(let C in this.R[w][E]){let h=this.R[w][E][C];for(let x=0;x<h.length;x++)for(let k=x+1;k<h.length;k++){let M=h[x],D=h[k],P=s.order(C,M.atom,D.atom);P>0&&(M.bonds.push(D.index),D.bonds.push(M.index),M.bondOrder.push(P),D.bondOrder.push(P))}}for(let w of v.C){let E=w[0],C=w[1],h=w[2],x=this.geta(E),k=this.geta(C);x!=null&&k!=null&&(x.bonds.push(k.index),k.bonds.push(x.index),x.bondOrder.push(h),k.bondOrder.push(h))}}}function z(l,s){var v=!s.keepH,w=s.altLoc?s.altLoc:"A",E=!s.noComputeSecondaryStructure;const C=!s.doAssembly,h=s.assignBonds===void 0?!0:s.assignBonds;if(typeof l=="string")try{l=(0,o.base64ToArray)(l)}catch{l=new TextEncoder().encode(l)}else l=new Uint8Array(l);var x=p.decodeMsgpack(l);x==31&&(l=(0,o.inflateString)(l,!1),x=p.decodeMsgpack(l));var k=[],M=k.modelData=[],D=x.dataBlocks.length;if(D==0)return k;s.multimodel||(D=1);for(let P=0;P<D;P++){let F=k.length;const X=[];M.push({symmetries:[]}),k.push([]);const B=x.dataBlocks[P],L=Object.create(null);for(const At of B.categories)L[At.name.substr(1)]=(0,y.Category)(At);let H={},U=L.struct_conf;if(U){let At=U.getField("conf_type_id"),Mt=U.getField("beg_label_asym_id"),Jr=U.getField("beg_label_seq_id"),Yr=U.getField("end_label_seq_id");for(let ie=0;ie<At.length;ie++)if(At[ie].startsWith("H")){let ve=Mt[ie],we=Jr[ie],it=Yr[ie];ve in H||(H[ve]={}),H[ve][we]="h1";for(let rt=we+1;rt<it;rt++)H[ve][rt]="h";H[ve][it]="h2"}}let Y=L.struct_sheet_range;if(Y){let At=Y.getField("id"),Mt=Y.getField("beg_label_asym_id"),Jr=Y.getField("beg_label_seq_id"),Yr=Y.getField("end_label_seq_id");for(let ie=0;ie<At.length;ie++){let ve=Mt[ie],we=Jr[ie],it=Yr[ie];ve in H||(H[ve]={}),H[ve][we]="s1";for(let rt=we+1;rt<it;rt++)H[ve][rt]="s";H[ve][it]="s2"}}let W=L.pdbx_struct_oper_list,q=W.getField("id");if(q&&!C){let At=W.getField("matrix[1][1]"),Mt=W.getField("matrix[1][2]"),Jr=W.getField("matrix[1][3]"),Yr=W.getField("matrix[2][1]"),ie=W.getField("matrix[2][2]"),ve=W.getField("matrix[2][3]"),we=W.getField("matrix[3][1]"),it=W.getField("matrix[3][2]"),rt=W.getField("matrix[3][3]"),Yt=W.getField("vector[1]"),jt=W.getField("vector[2]"),re=W.getField("vector[3]");for(let tt=0;tt<q.length;tt++){const lt=new g.Matrix4(At[tt],Mt[tt],Jr[tt],Yt[tt],Yr[tt],ie[tt],ve[tt],jt[tt],we[tt],it[tt],rt[tt],re[tt]);M[M.length-1].symmetries.push(lt)}}let G=new S(L.chem_comp_bond),$=new R,Z=new A(L.struct_conn),xe=L.atom_site,ce=xe.rowCount,Ne=xe.getField("group_PDB"),Pe=xe.getField("Cartn_x"),De=xe.getField("Cartn_y"),Me=xe.getField("Cartn_z"),Be=xe.getField("auth_asym_id"),ft=xe.getField("label_asym_id"),Ot=xe.getField("auth_seq_id"),Gt=xe.getField("label_seq_id"),mt=xe.getField("auth_comp_id"),je=xe.getField("label_comp_id"),ht=xe.getField("auth_atom_id"),Kt=xe.getField("label_atom_id"),Jt=xe.getField("type_symbol"),Wt=xe.getField("B_iso_or_equiv"),Br=xe.getField("id"),zr=xe.getField("label_alt_id"),cr=xe.getField("pdbx_PDB_model_num"),Nr=cr?cr[0]:0;for(let At=0;At<ce;At++){if(Ne!==void 0&&Ne[At]==="TER")continue;if(cr&&cr[At]!=Nr)if(Nr=cr[At],s.multimodel)s.onemol||(k.push([]),M.push(M[M.length-1]),Nr=cr[At],$.setBonds(G,Z),$=new R);else break;const Mt={};Mt.x=Pe[At],Mt.y=De[At],Mt.z=Me[At],Mt.chain=Be?Be[At]:ft?ft[At]:void 0,Mt.lchain=ft?ft[At]:void 0,Mt.resi=Ot?Ot[At]:Gt?Gt[At]:void 0,Mt.lresi=Gt?Gt[At]:void 0,Mt.resn=mt?mt[At].trim():je?je[At].trim():void 0,Mt.lresn=je?je[At].trim():void 0,Mt.atom=ht?ht[At].replace(/"/gm,""):Kt?Kt[At].replace(/"/gm,""):void 0,Mt.icode=zr?zr[At]:void 0,Mt.altLoc=Mt.icode,Mt.hetflag=!Ne||Ne[At]==="HETA"||Ne[At]==="HETATM";let Jr="X";Jt&&(Jr=Jt[At].replace(/\(?\+?\d+.*/,"")),Mt.elem=Jr[0].toUpperCase()+Jr.substring(1,2).toLowerCase(),Wt&&(Mt.b=Wt[At]),!(v&&Mt.elem=="H")&&(Mt.altLoc!=""&&Mt.altLoc!=w&&w!="*"||(Mt.bonds=[],Mt.ss="c",Mt.serial=Br[At],Mt.model=Nr,Mt.bondOrder=[],Mt.properties={},Mt.index=k[k.length-1].length,X[Mt.serial]=[k.length,Mt.index],k[k.length-1].push(Mt),$.add(Mt)))}if($.setBonds(G,Z),!(0,_.isEmpty)(H))for(let At=F;At<k.length;At++){let Mt=k[At];for(let Jr=0;Jr<Mt.length;Jr++){const Yr=Mt[Jr];if(Yr!==void 0&&Yr.lchain in H&&Yr.lresi in H[Yr.lchain]){const ie=H[Yr.lchain][Yr.lresi];Yr.ss=ie[0],ie.length>1&&(ie[1]=="1"?Yr.ssbegin=!0:ie[1]=="2"&&(Yr.ssend=!0))}}}s.multimodel&&P<D-1&&(s.onemol||(k.push([]),M.push({symmetries:[]})))}for(let P=0;P<k.length;P++)h&&!(s.duplicateAssemblyAtoms&&!s.dontConnectDuplicatedAtoms)&&(0,f.assignPDBBonds)(k[P],s),E&&(0,c.computeSecondaryStructure)(k[P],s.hbondCutoff),(0,u.processSymmetries)(M[P].symmetries,k[P],s,M[P].cryst),s.duplicateAssemblyAtoms&&!s.dontConnectDuplicatedAtoms&&h&&(0,f.assignPDBBonds)(k[P],s);return k}}),"./src/parsers/CDJSON.ts":((e,r,t)=>{t.r(r),t.d(r,{CDJSON:()=>o});function o(c,u){var y=[[]];typeof c=="string"&&(c=JSON.parse(c));for(var f=c.m,g=f[0].a,_=f[0].b,p=f[0].s,S=u!==void 0&&u.parseStyle!==void 0?u.parseStyle:p!==void 0,A=y[y.length-1].length,R=0;R<g.length;R++){var z=g[R],l={};l.id=z.i,l.x=z.x,l.y=z.y,l.z=z.z||0,l.bonds=[],l.bondOrder=[];var s=z.l||"C";l.elem=s[0].toUpperCase()+s.substring(1).toLowerCase(),l.serial=y[y.length-1].length,S&&(l.style=p[z.s||0]),y[y.length-1].push(l)}for(let v=0;v<_.length;v++){let w=_[v],E=w.b+A,C=w.e+A,h=w.o||1,x=y[y.length-1][E],k=y[y.length-1][C];x.bonds.push(C),x.bondOrder.push(h),k.bonds.push(E),k.bondOrder.push(h)}return y}}),"./src/parsers/CIF.ts":((e,r,t)=>{t.r(r),t.d(r,{CIF:()=>g});var o=t("./src/parsers/utils/computeSecondaryStructure.ts"),c=t("./src/parsers/utils/processSymmetries.ts"),u=t("./src/WebGL/index.ts"),y=t("./src/parsers/utils/assignPDBBonds.ts");const f=function(_,p,S,A){return new u.Vector3(p,S,A).applyMatrix3(_)};function g(_,p={}){const S=[],A=!p.doAssembly,R=S.modelData=[],z=p.assignBonds===void 0?!0:p.assignBonds;function l(h,x){const k=[];let M=0,D=0;for(;D<h.length;){for(;h.substring(D,D+x.length)!==x&&D<h.length;)if(h[D]==="'"){for(D++;D<h.length&&h[D]!=="'";)D++;for(;h.substring(D,D+x.length)!==x&&D<h.length;)D++}else if(h[D]==='"'){for(D++;D<h.length&&h[D]!=='"';)D++;D++}else D++;k.push(h.substring(M,D)),M=D=D+x.length}return k}const s=_.split(/\r?\n|\r/),v=[];let w=!1;for(let h=0;h<s.length;h++){var E=s[h].split("#")[0];if(w?E[0]===";"&&(w=!1):E[0]===";"&&(w=!0),w||E!==""){if(!w&&(E=E.trim(),E[0]==="_")){const x=E.split(/\s/)[0].indexOf(".");if(x>-1){let k=E.split("");k[x]="_",E=k.join(""),E=E.substring(0,x)+"_"+E.substring(x+1)}}v.push(E)}}let C=0;for(;C<v.length;){for(;!v[C].startsWith("data_")||v[C]==="data_global";)C++;C++;const h={};for(;C<v.length&&!v[C].startsWith("data_");)if(v[C][0]===void 0)C++;else if(v[C][0]==="_"){const D=v[C].split(/\s/)[0].toLowerCase(),P=h[D]=h[D]||[],F=v[C].substring(v[C].indexOf(D)+D.length);if(F==="")if(C++,v[C][0]===";"){let X=v[C].substring(1);for(C++;v[C]!==";";)X=X+`
`+v[C],C++;P.push(X)}else P.push(v[C]);else P.push(F.trim());C++}else if(v[C].substring(0,5)==="loop_"){C++;const D=[];for(;v[C]===""||v[C][0]==="_";){if(v[C]!==""){let F=v[C].split(/\s/)[0].toLowerCase(),X=h[F]=h[F]||[];D.push(X)}C++}let P=0;for(;C<v.length&&v[C][0]!=="_"&&!v[C].startsWith("loop_")&&!v[C].startsWith("data_");){let F=l(v[C]," ");for(let X=0;X<F.length;X++)F[X]!==""&&(D[P].push(F[X]),P=(P+1)%D.length);C++}}else C++;R.push({symmetries:[]}),S.push([]);const x=h._atom_site_id!==void 0?h._atom_site_id.length:h._atom_site_label.length;let k;if(h._cell_length_a!==void 0){const D=parseFloat(h._cell_length_a),P=parseFloat(h._cell_length_b),F=parseFloat(h._cell_length_c),X=parseFloat(h._cell_angle_alpha)||90,B=parseFloat(h._cell_angle_beta)||90,L=parseFloat(h._cell_angle_gamma)||90;k=(0,u.conversionMatrix3)(D,P,F,X,B,L),R[R.length-1].cryst={a:D,b:P,c:F,alpha:X,beta:B,gamma:L}}for(let D=0;D<x;D++){if(h._atom_site_group_pdb!==void 0&&h._atom_site_group_pdb[D]==="TER")continue;const P={};if(h._atom_site_cartn_x!==void 0)P.x=parseFloat(h._atom_site_cartn_x[D]),P.y=parseFloat(h._atom_site_cartn_y[D]),P.z=parseFloat(h._atom_site_cartn_z[D]);else{const X=f(k,parseFloat(h._atom_site_fract_x[D]),parseFloat(h._atom_site_fract_y[D]),parseFloat(h._atom_site_fract_z[D]));P.x=X.x,P.y=X.y,P.z=X.z}P.chain=h._atom_site_auth_asym_id?h._atom_site_auth_asym_id[D]:h._atom_site_label_asym_id?h._atom_site_label_asym_id[D]:void 0,P.resi=h._atom_site_auth_seq_id?parseInt(h._atom_site_auth_seq_id[D]):h._atom_site_label_seq_id?h._atom_site_label_seq_id[D]:void 0,P.resn=h._atom_site_auth_comp_id?h._atom_site_auth_comp_id[D].trim():h._atom_site_label_comp_id?h._atom_site_label_comp_id[D].trim():void 0,P.atom=h._atom_site_auth_atom_id?h._atom_site_auth_atom_id[D].replace(/"/gm,""):h._atom_site_label_atom_id?h._atom_site_label_atom_id[D].replace(/"/gm,""):void 0,P.hetflag=!h._atom_site_group_pdb||h._atom_site_group_pdb[D]==="HETA"||h._atom_site_group_pdb[D]==="HETATM",h._atom_site_b_iso_or_equiv&&(P.b=parseFloat(h._atom_site_b_iso_or_equiv[D]));let F="X";h._atom_site_type_symbol?F=h._atom_site_type_symbol[D].replace(/\(?\+?\d+.*/,""):h._atom_site_label&&(F=h._atom_site_label[D].split("_")[0].replace(/\(?\d+.*/,"")),P.elem=F[0].toUpperCase()+F.substring(1,2).toLowerCase(),P.bonds=[],P.ss="c",P.serial=D,P.bondOrder=[],P.properties={},S[S.length-1].push(P)}if(h._pdbx_struct_oper_list_id!==void 0&&!A)for(let D=0;D<h._pdbx_struct_oper_list_id.length;D++){const P=parseFloat(h["_pdbx_struct_oper_list_matrix[1][1]"][D]),F=parseFloat(h["_pdbx_struct_oper_list_matrix[1][2]"][D]),X=parseFloat(h["_pdbx_struct_oper_list_matrix[1][3]"][D]),B=parseFloat(h["_pdbx_struct_oper_list_vector[1]"][D]),L=parseFloat(h["_pdbx_struct_oper_list_matrix[2][1]"][D]),H=parseFloat(h["_pdbx_struct_oper_list_matrix[2][2]"][D]),U=parseFloat(h["_pdbx_struct_oper_list_matrix[2][3]"][D]),Y=parseFloat(h["_pdbx_struct_oper_list_vector[2]"][D]),W=parseFloat(h["_pdbx_struct_oper_list_matrix[3][1]"][D]),q=parseFloat(h["_pdbx_struct_oper_list_matrix[3][2]"][D]),G=parseFloat(h["_pdbx_struct_oper_list_matrix[3][3]"][D]),$=parseFloat(h["_pdbx_struct_oper_list_vector[3]"][D]),Z=new u.Matrix4(P,F,X,B,L,H,U,Y,W,q,G,$);R[R.length-1].symmetries.push(Z)}const M=function(D){const P=D.match("-");D=D.replace(/[-xyz]/g,"");const F=D.split("/");let X,B;return F[1]===void 0?B=1:B=parseInt(F[1]),F[0]===""?X=1:X=parseInt(F[0]),X/B*(P?-1:1)};if(h._symmetry_equiv_pos_as_xyz!==void 0&&!A)for(let D=0;D<h._symmetry_equiv_pos_as_xyz.length;D++){const P=h._symmetry_equiv_pos_as_xyz[D].replace(/["' ]/g,"").split(",").map(function(L){return L.replace(/-/g,"+-")});let F=new u.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let L=0;L<3;L++){const H=P[L].split("+");for(let U=0;U<H.length;U++){const Y=H[U];if(Y==="")continue;const W=M(Y);Y.match("x")?F.elements[L+0]=W:Y.match("y")?F.elements[L+4]=W:Y.match("z")?F.elements[L+8]=W:F.elements[L+12]=W}}const X=k.getMatrix4(),B=new u.Matrix4().getInverse(X,!0);F=new u.Matrix4().multiplyMatrices(F,B),F=new u.Matrix4().multiplyMatrices(X,F),R[R.length-1].symmetries.push(F)}}for(let h=0;h<S.length;h++)z&&!(p.duplicateAssemblyAtoms&&!p.dontConnectDuplicatedAtoms)&&(0,y.assignPDBBonds)(S[h],p),(0,o.computeSecondaryStructure)(S[h],p.hbondCutoff),(0,c.processSymmetries)(R[h].symmetries,S[h],p,R[h].cryst),p.duplicateAssemblyAtoms&&!p.dontConnectDuplicatedAtoms&&z&&(0,y.assignPDBBonds)(S[h],p);return S}}),"./src/parsers/CUBE.ts":((e,r,t)=>{t.r(r),t.d(r,{CUBE:()=>y});var o=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/assignBonds.ts"),u=t("./src/parsers/utils/anumToSymbol.ts");function y(f,g){g=g||{};const _=[[]];let p=f.split(/\r?\n/);const S=g.assignBonds===void 0?!0:g.assignBonds;if(p.length<6)return _;let A=p[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const R=Math.abs(parseFloat(A[0]));let z={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const l=z.origin=new o.Vector3(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3]));A=p[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),A=p[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const s=A[0]>0?.529177:1;l.multiplyScalar(s);const v=Math.abs(A[0]),w=new o.Vector3(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3])).multiplyScalar(s);A=p[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const E=Math.abs(A[0]),C=new o.Vector3(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3])).multiplyScalar(s);A=p[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const h=Math.abs(A[0]),x=new o.Vector3(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3])).multiplyScalar(s);if(z.size={x:v,y:E,z:h},z.unit=new o.Vector3(w.x,C.y,x.z),w.y!=0||w.z!=0||C.x!=0||C.z!=0||x.x!=0||x.y!=0){z.matrix4=new o.Matrix4(w.x,C.x,x.x,0,w.y,C.y,x.y,0,w.z,C.z,x.z,0,0,0,0,1);let B=new o.Matrix4().makeTranslation(l.x,l.y,l.z);z.matrix4=z.matrix4.multiplyMatrices(B,z.matrix4),z.matrix=z.matrix4.matrix3FromTopLeft(),z.origin=new o.Vector3(0,0,0),z.unit=new o.Vector3(1,1,1)}_.modelData=[{cryst:z}],p=p.splice(6,R);for(var k=_[_.length-1].length,M=k+p.length,D=k;D<M;++D){var P={};P.serial=D;var F=p[D-k],X=F.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");P.elem=u.anumToSymbol[X[0]],P.x=parseFloat(X[2])*s,P.y=parseFloat(X[3])*s,P.z=parseFloat(X[4])*s,P.hetflag=!0,P.bonds=[],P.bondOrder=[],P.properties={},_[_.length-1].push(P)}if(S)for(let B=0;B<_.length;B++)(0,c.assignBonds)(_[B],g);return _}}),"./src/parsers/GRO.ts":((e,r,t)=>{t.r(r),t.d(r,{GRO:()=>u});var o=t("./src/parsers/utils/assignPDBBonds.ts"),c=t("./src/parsers/utils/atomNameToElem.ts");function u(y,f){const g=[],_=y.split(/\r?\n|\r/);for(;_.length>0;){const p=parseInt(_[1]);if(_.length<3||isNaN(p)||p<=0||_.length<p+3)break;const S=[];g.push(S);let A=2;const R=S.length,z=R+p;for(let l=R;l<z;l++){const s=_[A++],v={};v.serial=l,v.atom=s.slice(10,15).trim(),v.elem=(0,c.atomNameToElem)(v.atom,!0),v.x=10*parseFloat(s.slice(20,28)),v.y=10*parseFloat(s.slice(28,36)),v.z=10*parseFloat(s.slice(36,44)),v.resi=parseInt(s.slice(0,5)),v.resn=s.slice(5,10).trim(),v.bonds=[],v.bondOrder=[],v.properties={},s.length>44&&(v.dx=10*parseFloat(s.slice(44,52)),v.dy=10*parseFloat(s.slice(52,60)),v.dz=10*parseFloat(s.slice(60,68))),S[l]=v}if(_.length<=A+3){const l=_[A++].trim().split(/\s+/);if(l.length===3){for(let s=0;s<3;s++)l[s]=(parseFloat(l[s])*10).toString();g.box=l}}_.splice(0,++A)}for(let p=0;p<g.length;p++)(0,o.assignPDBBonds)(g[p],f);return g}}),"./src/parsers/LAMMPSTRJ.ts":((e,r,t)=>{t.r(r),t.d(r,{LAMMPSTRJ:()=>u});var o=t("./src/parsers/utils/assignBonds.ts");const c={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function u(y,f){const g=[],_=y.split(/\r?\n|\r/);let p=0,S=0,A=0;for(;A<_.length-9;){for(var R=A;R<_.length;R++)if(_[R].match(/ITEM: NUMBER OF ATOMS/)&&(S=parseInt(_[R+1])),_[R].match(/ITEM: ATOMS/)){p=R+1;break}const z=_[p-1].replace("ITEM: ATOMS ","").split(" ");g.push([]);for(let l=p;l<p+S;l++){const s={},v={},w=_[l].split(" ");for(let E=0;E<w.length;E++){const C=c[z[E]];C!==void 0&&(C==="serial"?s[C]=parseInt(w[E]):C==="x"||C==="y"||C==="z"?s[C]=parseFloat(w[E]):C==="charge"||C==="radius"?v[C]=parseFloat(w[E]):s[C]=w[E]),s.properties=v,s.bonds=[],s.bondOrder=[]}g[g.length-1][l-p]=s}A=p+S-1}if(f.assignBonds)for(let z=0;z<g.length;z++)(0,o.assignBonds)(g[z],f);return g}}),"./src/parsers/MMTF.ts":((e,r,t)=>{t.r(r),t.d(r,{MMTFparser:()=>S});var o=t("./src/utilities.ts"),c=t("./src/WebGL/index.ts"),u=t("./src/parsers/utils/computeSecondaryStructure.ts"),y=t("./src/parsers/utils/processSymmetries.ts"),f=t("./src/vendor/mmtf.js"),g=function(A){return String.fromCharCode.apply(null,A).replace(/\0/g,"")},_=function(A){return A==0||A==2||A==4?"h":A==3?"s":"c"};let p=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function S(A,R){var z=!R.keepH,l=R.altLoc?R.altLoc:"A",s=!!R.noSecondaryStructure,v=!R.noComputeSecondaryStructure,w=!R.doAssembly,E=R.assemblyIndex?R.assemblyIndex:0;typeof A=="string"?A=(0,o.base64ToArray)(A):A=new Uint8Array(A);var C=f.decode(A),h=[[]],x=h.modelData=[],k=0,M=0,D=0,P=C.secStructList,F=C.bFactorList,X=C.altLocList,B=C.occupancyList,L=C.bondAtomList,H=C.bondOrderList,U=C.numModels;if(U==0)return h;R.multimodel||(U=1);var Y,W,q,G,$,Z,xe=[];if(!w&&C.bioAssemblyList&&C.bioAssemblyList.length>0){var ce=C.bioAssemblyList[E].transformList;for(Y=0,Z=ce.length;Y<Z;Y++){var Ne=new c.Matrix4(ce[Y].matrix);Ne.transpose(),xe.push(Ne)}}var Pe=null;if(C.unitCell){var De=C.unitCell;Pe={a:De[0],b:De[1],c:De[2],alpha:De[3],beta:De[4],gamma:De[5]}}let Me=[];C.entityList.forEach(at=>{at.chainIndexList.forEach(me=>{Me[me]=at.type=="polymer"})});var Be=0;for($=0;$<U;$++){var ft=C.chainsPerModel[$],Ot=h[h.length-1],Gt=[];for(x.push({symmetries:xe,cryst:Pe}),Y=0;Y<ft;++Y){var mt=C.groupsPerChain[k],je=g(C.chainIdList.subarray(k*4,k*4+4));C.chainNameList&&(je=g(C.chainNameList.subarray(k*4,k*4+4)));var ht=M,Kt="";for(W=0;W<mt;++W){var Jt=C.groupList[C.groupTypeList[M]],Wt=Jt.atomNameList.length,Br=0,zr=!1,cr=!1;if(P){Br=P[M];var Nr=_(Br);(M==0||Nr!=Kt)&&(zr=!0),Kt=Nr;var At=M+1;(At>=P.length||_(P[At]!=Nr))&&(cr=!0)}var Mt=C.groupIdList[M],Jr=Jt.groupName;let at=Jt.chemCompType;var Yr=D;let me=p.has(at)||!Me[k];for(q=0;q<Wt;++q){var ie=Jt.elementList[q];if(z&&ie=="H"){D+=1;continue}var ve="";F&&(ve=F[D]);var we="";X&&X[D]&&(we=String.fromCharCode(X[D]));var it="";if(B&&(it=B[D]),we!=""&&we!=l&&l!="*"){D+=1;continue}var rt=C.atomIdList[D],Yt=Jt.atomNameList[q],jt=0;Jt.atomChargeList&&(jt=Jt.atomChargeList[q]);var re=C.xCoordList[D],tt=C.yCoordList[D],lt=C.zCoordList[D];Gt[D]=Ot.length,Ot.push({resn:Jr,x:re,y:tt,z:lt,elem:ie,hetflag:me,chain:je,resi:Mt,icode:we,rescode:Mt+(we!=" "?"^"+we:""),serial:rt,altLoc:we,index:D,atom:Yt,bonds:[],ss:_(Br),ssbegin:zr,ssend:cr,bondOrder:[],properties:{charge:jt,occupancy:it},b:ve}),D+=1}var ar=Jt.bondAtomList;for(q=0,G=Jt.bondOrderList.length;q<G;++q){var et=Yr+ar[q*2],Ft=Yr+ar[q*2+1],se=Jt.bondOrderList[q],xt=Gt[et],Vr=Gt[Ft],J=Ot[xt],ut=Ot[Vr];J&&ut&&(J.bonds.push(Vr),J.bondOrder.push(se),ut.bonds.push(xt),ut.bondOrder.push(se))}M+=1}for(M=ht,W=0;W<mt;++W)M+=1;k+=1}if(L)for(let at=Be,me=L.length;at<me;at+=2){let Ze=L[at],vt=L[at+1],Qr=H?H[at/2]:1;if(Ze>=D){Be=at;break}let Xr=Gt[Ze],Zr=Gt[vt],xn=Ot[Xr],Ei=Ot[Zr];xn&&Ei&&(xn.bonds.push(Zr),xn.bondOrder.push(Qr),Ei.bonds.push(Xr),Ei.bondOrder.push(Qr))}R.multimodel&&(R.onemol||h.push([]))}if(!w)for(let at=0;at<h.length;at++)(0,y.processSymmetries)(x[at].symmetries,h[at],R,x[at].cryst);return v&&!s&&(0,u.computeSecondaryStructure)(h,R.hbondCutoff),h}}),"./src/parsers/MOL2.ts":((e,r,t)=>{t.r(r),t.d(r,{MOL2:()=>c});let o={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function c(u,y){var f=[[]],g=!1;typeof y.keepH<"u"&&(g=!y.keepH);var _=u.search(/@<TRIPOS>MOLECULE/),p=u.search(/@<TRIPOS>ATOM/);if(_==-1||p==-1)return f;for(var S=u.substring(_).split(/\r?\n|\r/);S.length>0;){var A=[],R=S[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),z=parseInt(R[0]),l=0;R.length>1&&(l=parseInt(R[1]));var s=4,v;for(v=3;v<S.length;v++)if(S[v]=="@<TRIPOS>ATOM"){s=v+1;break}var w=f[f.length-1].length,E=w+z,C;for(v=w;v<E;v++){C=S[s++],R=C.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var h={},x=R[5];if(o[x]!==void 0?x=o[x]:(x=x.split(".")[0],x=x[0].toUpperCase()+x.substring(1).toLowerCase()),h.atom=R[1],h.elem=x,!(h.elem=="H"&&g)){var k=f[f.length-1].length,M=parseInt(R[0]);h.serial=M,h.x=parseFloat(R[2]),h.y=parseFloat(R[3]),h.z=parseFloat(R[4]),h.atom=R[5];var D=parseFloat(R[8]);h.index=k,h.bonds=[],h.bondOrder=[],h.properties={charge:D,partialCharge:D},A[M]=k,f[f.length-1].push(h)}}for(var P=!1;s<S.length;)if(S[s++]=="@<TRIPOS>BOND"){P=!0;break}if(P&&l)for(v=0;v<l;v++){C=S[s++],R=C.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var F=parseInt(R[1]),X=f[f.length-1][A[F]],B=parseInt(R[2]),L=f[f.length-1][A[B]],H=parseInt(R[3]);isNaN(H)&&(H=1),X!==void 0&&L!==void 0&&(X.bonds.push(A[B]),X.bondOrder.push(H),L.bonds.push(A[F]),L.bondOrder.push(H))}if(y.multimodel){y.onemol||f.push([]),S.splice(0,s),u=S.join(`
`);continue}else break}return f}}),"./src/parsers/PDB.ts":((e,r,t)=>{t.r(r),t.d(r,{PDB:()=>c});var o=t("./src/parsers/utils/getSinglePDB.ts");function c(u,y){y=y||{};var f=[],g={};f.modelData=[];for(var _=u.split(/\r?\n|\r/);_.length>0;){var p=(0,o.getSinglePDB)(_,y,g),S=p[0],A=p[1];if(_=p[2],S.length!=0){if(y.multimodel&&y.onemol&&f.length>0)for(var R=f[0].length,z=0;z<S.length;z++){var l=S[z];l.index=z;for(var s=0;s<l.bonds.length;s++)l.bonds[s]+=R;f[0].push(l)}else f.modelData.push(A),f.push(S);if(!y.multimodel)break}}return f}}),"./src/parsers/PQR.ts":((e,r,t)=>{t.r(r),t.d(r,{PQR:()=>u});var o=t("./src/parsers/utils/assignPDBBonds.ts"),c=t("./src/parsers/utils/computeSecondaryStructure.ts");function u(y,f){var g=[[]],_=!f.noSecondaryStructure;g.modelData=[{symmetries:[]}];var p=[],S=y.split(/\r?\n|\r/),A;for(let P=0;P<S.length;P++){A=S[P].replace(/^\s*/,"");var R=A.substring(0,6);if(R.indexOf("END")==0)if(f.multimodel){f.onemol||g.push([]);continue}else break;else if(R=="ATOM  "||R=="HETATM"){var z;let F=parseInt(A.substring(6,11)),X=A.substring(12,16).replace(/ /g,""),B=A.substring(17,20).trim(),L=A.substring(21,22),H=parseInt(A.substring(22,26));var l=A.substring(30).trim().split(/\s+/),s=parseFloat(l[0]),v=parseFloat(l[1]),w=parseFloat(l[2]),E=parseFloat(l[3]),C=parseFloat(l[4]),h=X[0];X.length>1&&X[1].toUpperCase()!=X[1]&&(h=X.substring(0,2)),A[0]=="H"?z=!0:z=!1,p[F]=g[g.length-1].length,g[g.length-1].push({resn:B,x:s,y:v,z:w,elem:h,hetflag:z,chain:L,resi:H,serial:F,atom:X,bonds:[],ss:"c",bondOrder:[],properties:{charge:E,partialCharge:E,radius:C},pdbline:A})}else if(R=="CONECT"){var x=parseInt(A.substring(6,11)),k=g[g.length-1][p[x]];for(let F=0;F<4;F++){var M=parseInt(A.substring([11,16,21,26][F],[11,16,21,26][F]+5)),D=g[g.length-1][p[M]];k!==void 0&&D!==void 0&&(k.bonds.push(p[M]),k.bondOrder.push(1))}}}for(let P=0;P<g.length;P++)(0,o.assignPDBBonds)(g[P],f),_&&(0,c.computeSecondaryStructure)(g[P],f.hbondCutoff);return g}}),"./src/parsers/PRMTOP.ts":((e,r,t)=>{t.r(r),t.d(r,{PRMTOP:()=>o});function o(c){var u=[],y,f=0,g=c.split(/\r?\n|\r/);if(g.length>0&&g[0].includes("VERSION")){var _=g.filter(function(s){return s.includes("POINTERS")||s.includes("ATOM_NAME")||s.includes("CHARGE")||s.includes("RADII")||s.includes("BONDS_INC_HYDROGEN")||s.includes("BONDS_WITHOUT_HYDROGEN")}),p=z("POINTERS");if(p==-1)return[];var S=l(p),A=parseInt(g[p+1].slice(0,S[1]));if(isNaN(A)||A<=0)return[];if(p=z("ATOM_NAME"),p==-1)return[];S=l(p);var R=S[0];for(let s=0;s<A/S[0];s++){s==parseInt(A/S[0])&&(R=A%S[0]);for(let v=0;v<R;v++){let w={},E={charge:"",radii:""};w.serial=f,w.x=0,w.y=0,w.z=0,w.atom=g[p+1].slice(S[1]*v,S[1]*(v+1)).trim(),w.elem=g[p+1].slice(S[1]*v,S[1]*v+1).trim(),w.properties=E,w.bonds=[],w.bondOrder=[],u.push(w),f++}p++}if(p=z("CHARGE"),p!=-1){S=l(p),f=0,R=S[0];for(let s=0;s<A/S[0];s++){s==parseInt(A/S[0])&&(R=A%S[0]);for(let v=0;v<R;v++)u[f].properties.charge=parseFloat(g[p+1].slice(S[1]*v,S[1]*(v+1))),f++;p++}}if(p=z("RADII"),p!=-1){S=l(p),f=0,R=S[0];for(let s=0;s<A/S[0];s++){s==parseInt(A/S[0])&&(R=A%S[0]);for(let v=0;v<R;v++)u[f].properties.radii=parseFloat(g[p+1].slice(S[1]*v,S[1]*(v+1))),f++;p++}}if(p=z("BONDS_WITHOUT_HYDROGEN"),p!=-1)for(S=l(p),f=0,R=S[0],p=p+1;!g[p].match(/^%FLAG/);){g[p+1].match(/^%FLAG/)&&(R=A%S[0]);for(let s=0;s<R;s++)f%3==0?y=parseInt(g[p].slice(S[1]*s,S[1]*(s+1))/3):f%3==1&&u[y].bonds.push(parseInt(g[p].slice(S[1]*s,S[1]*(s+1))/3)),f++;p++}if(p=z("BONDS_INC_HYDROGEN"),p!=-1)for(S=l(p),f=0,R=S[0],p=p+1;!g[p].match(/^%FLAG/);){g[p+1].match(/^%FLAG/)&&(R=A%S[0]);for(let s=0;s<R;s++)f%3==0?y=parseInt(g[p].slice(S[1]*s,S[1]*(s+1))/3):f%3==1&&u[y].bonds.push(parseInt(g[p].slice(S[1]*s,S[1]*(s+1))/3)),f++;p++}}else return[];function z(s){var v=g.indexOf(_.filter(function(w){return w.includes(s)})[0]);if(Number.isInteger(v)&&v>0){for(;!g[v].includes("FORMAT");)v++;return v}else return-1}function l(s){var v=g[s].match(/\((\d*)\S*/),w=g[s].match(/[a-zA-Z](\d*)\)\s*/);return w==null&&(w=g[s].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[v[1],w[1]]}return[u]}}),"./src/parsers/SDF.ts":((e,r,t)=>{t.r(r),t.d(r,{SDF:()=>u});var o=function(y,f){var g=[[]],_=!1;for(typeof f.keepH<"u"&&(_=!f.keepH);y.length>0&&!(y.length<4);){var p=parseInt(y[3].substring(0,3));if(isNaN(p)||p<=0)break;var S=parseInt(y[3].substring(3,6)),A=4;if(y.length<4+p+S)break;var R=[],z=g[g.length-1].length,l=z+p,s,v;for(s=z;s<l;s++,A++){v=y[A];var w={},E=v.substring(31,34).replace(/ /g,"");w.atom=w.elem=E[0].toUpperCase()+E.substring(1).toLowerCase(),(w.elem!=="H"||!_)&&(w.serial=s,R[s]=g[g.length-1].length,w.x=parseFloat(v.substring(0,10)),w.y=parseFloat(v.substring(10,20)),w.z=parseFloat(v.substring(20,30)),w.hetflag=!0,w.bonds=[],w.bondOrder=[],w.properties={},w.index=g[g.length-1].length,g[g.length-1].push(w))}for(s=0;s<S;s++,A++){v=y[A];var C=R[parseInt(v.substring(0,3))-1+z],h=R[parseInt(v.substring(3,6))-1+z],x=parseFloat(v.substring(6));typeof C<"u"&&typeof h<"u"&&(g[g.length-1][C].bonds.push(h),g[g.length-1][C].bondOrder.push(x),g[g.length-1][h].bonds.push(C),g[g.length-1][h].bondOrder.push(x))}if(f.multimodel){for(f.onemol||g.push([]);y[A]!=="$$$$"&&A<y.length;)A++;y.splice(0,++A)}else break}return g},c=function(y,f){var g=[[]],_=!1;for(typeof f.keepH<"u"&&(_=!f.keepH);y.length>0&&!(y.length<8||!y[4].startsWith("M  V30 BEGIN CTAB")||!y[5].startsWith("M  V30 COUNTS")||y[5].length<14);){var p=y[5].substring(13).match(/\S+/g);if(p.length<2)break;var S=parseInt(p[0]);if(isNaN(S)||S<=0)break;var A=parseInt(p[1]),R=7;if(y.length<8+S+A)break;var z=[],l=g[g.length-1].length,s=l+S,v,w;for(v=l;v<s;v++,R++){w=y[R];var E=w.substring(6).match(/\S+/g);if(E.length>4){var C={},h=E[1].replace(/ /g,"");C.atom=C.elem=h[0].toUpperCase()+h.substring(1).toLowerCase(),(C.elem!=="H"||!_)&&(C.serial=v,z[v]=g[g.length-1].length,C.x=parseFloat(E[2]),C.y=parseFloat(E[3]),C.z=parseFloat(E[4]),C.hetflag=!0,C.bonds=[],C.bondOrder=[],C.properties={},C.index=g[g.length-1].length,g[g.length-1].push(C))}}if(y[R]==="M  V30 END ATOM")R++;else break;if(A!==0&&y[R]==="M  V30 BEGIN BOND")R++;else break;for(v=0;v<A;v++,R++){w=y[R];var x=w.substring(6).match(/\S+/g);if(x.length>3){var k=z[parseInt(x[2])-1+l],M=z[parseInt(x[3])-1+l],D=parseFloat(x[1]);typeof k<"u"&&typeof M<"u"&&(g[g.length-1][k].bonds.push(M),g[g.length-1][k].bondOrder.push(D),g[g.length-1][M].bonds.push(k),g[g.length-1][M].bondOrder.push(D))}}if(f.multimodel){for(f.onemol||g.push([]);y[R]!=="$$$$"&&R<y.length;)R++;y.splice(0,++R)}else break}return g};function u(y,f){var g="V2000",_=y.split(/\r?\n|\r/);return _.length>3&&_[3].length>38&&(g=_[3].substring(34,39)),g==="V2000"?o(_,f):g==="V3000"?c(_,f):[[""]]}}),"./src/parsers/VASP.ts":((e,r,t)=>{t.r(r),t.d(r,{VASP:()=>u});var o=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/assignBonds.ts");function u(y,f={}){var g=[[]],_={};const p=f.assignBonds===void 0?!0:f.assignBonds;var S=y.replace(/^\s+/,"").split(/\r?\n/);if(S.length<3)return g;if(S[1].match(/\d+/))_.length=parseFloat(S[1]);else return console.log("Warning: second line of the vasp structure file must be a number"),g;if(_.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),g;_.xVec=new Float32Array(S[2].replace(/^\s+/,"").split(/\s+/)),_.yVec=new Float32Array(S[3].replace(/^\s+/,"").split(/\s+/)),_.zVec=new Float32Array(S[4].replace(/^\s+/,"").split(/\s+/));var A=new o.Matrix3(_.xVec[0],_.xVec[1],_.xVec[2],_.yVec[0],_.yVec[1],_.yVec[2],_.zVec[0],_.zVec[1],_.zVec[2]);A.multiplyScalar(_.length),g.modelData=[{symmetries:[],cryst:{matrix:A}}];var R=S[5].replace(/\s+/,"").replace(/\s+$/,"").split(/\s+/),z=new Int16Array(S[6].replace(/^\s+/,"").split(/\s+/)),l=S[7].replace(/\s+/,""),s=!1;if(l.match(/S/)&&(s=!0,l=S[8].replace(/\s+/,"")),l.match(/C/))l="cartesian";else if(l.match(/D/))l="direct";else return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),g;if(R.length!=z.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(R),console.log(z),g;s?S.splice(0,9):S.splice(0,8);for(var v=0,w=0,E=R.length;w<E;w++){for(var C=R[w],h=0,x=z[w];h<x;h++){var k=new Float32Array(S[v+h].replace(/^\s+/,"").split(/\s+/)),M={};M.elem=C,l=="cartesian"?(M.x=_.length*k[0],M.y=_.length*k[1],M.z=_.length*k[2]):(M.x=_.length*(k[0]*_.xVec[0]+k[1]*_.yVec[0]+k[2]*_.zVec[0]),M.y=_.length*(k[0]*_.xVec[1]+k[1]*_.yVec[1]+k[2]*_.zVec[1]),M.z=_.length*(k[0]*_.xVec[2]+k[1]*_.yVec[2]+k[2]*_.zVec[2])),M.bonds=[],M.bondOrder=[],g[0].push(M)}v+=z[w]}if(p)for(let D=0;D<g.length;D++)(0,c.assignBonds)(g[D],f);return g}}),"./src/parsers/XYZ.ts":((e,r,t)=>{t.r(r),t.d(r,{XYZ:()=>u});var o=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/assignBonds.ts");function u(y,f){f=f||{};for(var g=[[]],_=f.assignBonds===void 0?!0:f.assignBonds,p=y.split(/\r?\n|\r/);p.length>0&&!(p.length<3);){var S=parseInt(p[0]);if(isNaN(S)||S<=0||p.length<S+2)break;var A=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi,R=A.exec(p[1]);if(R!=null&&R.length>1){var z=new Float32Array(R[1].split(/\s+/)),l=new o.Matrix3(z[0],z[3],z[6],z[1],z[4],z[7],z[2],z[5],z[8]);g.modelData=[{cryst:{matrix:l}}]}for(var s=2,v=g[g.length-1].length,w=v+S,E=v;E<w;E++){var C=p[s++],h=C.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),x={};x.serial=E;var k=h[0];x.atom=x.elem=k[0].toUpperCase()+k.substring(1,2).toLowerCase(),x.x=parseFloat(h[1]),x.y=parseFloat(h[2]),x.z=parseFloat(h[3]),x.hetflag=!0,x.bonds=[],x.bondOrder=[],x.properties={},g[g.length-1][E]=x,h.length>=7&&(x.dx=parseFloat(h[4]),x.dy=parseFloat(h[5]),x.dz=parseFloat(h[6]))}if(f.multimodel)g.push([]),p.splice(0,s);else break}if(_)for(let D=0;D<g.length;D++)(0,c.assignBonds)(g[D],f);if(f.onemol){var M=g;g=[],g.push(M[0]);for(let D=1;D<M.length;D++){let P=g[0].length;for(let F=0;F<M[D].length;F++){let X=M[D][F];for(let B=0;B<X.bonds.length;B++)X.bonds[B]=X.bonds[B]+P;X.index=g[0].length,X.serial=g[0].length,g[0].push(X)}}}return g}}),"./src/parsers/cifutils/category.ts":((e,r,t)=>{t.r(r),t.d(r,{Category:()=>c});var o=t("./src/parsers/cifutils/decoder.ts");function c(u){const y=Object.create(null),f=Object.create(null);for(const g of u.columns)y[g.name]=g;return{rowCount:u.rowCount,name:u.name.substring(1),fieldNames:u.columns.map(g=>g.name),getField(g){const _=y[g];if(_)return f[g]||(f[g]=(0,o.decode)(_.data)),f[g]}}}}),"./src/parsers/cifutils/decoder.ts":((e,r,t)=>{t.r(r),t.d(r,{decode:()=>y});var o=t("./src/parsers/cifutils/encoding.ts");const c=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function u(P,F){const X=new ArrayBuffer(P.length),B=new Uint8Array(X);for(let L=0,H=P.length;L<H;L+=F)for(let U=0;U<F;U++)B[L+F-U-1]=P[L+U];return X}function y(P){let F=P.data;for(let X=P.encoding.length-1;X>=0;X--)F=f(F,P.encoding[X]);return F}function f(P,F){switch(F.kind){case"ByteArray":switch(F.type){case o.Encoding.IntDataType.Uint8:return P;case o.Encoding.IntDataType.Int8:return p(P);case o.Encoding.IntDataType.Int16:return A(P);case o.Encoding.IntDataType.Uint16:return R(P);case o.Encoding.IntDataType.Int32:return z(P);case o.Encoding.IntDataType.Uint32:return l(P);case o.Encoding.FloatDataType.Float32:return s(P);case o.Encoding.FloatDataType.Float64:return v(P);default:throw new Error("unreachable")}case"FixedPoint":return w(P,F);case"IntervalQuantization":return E(P,F);case"RunLength":return C(P,F);case"Delta":return h(P,F);case"IntegerPacking":return M(P,F);case"StringArray":return D(P,F)}}function g(P,F){switch(P){case o.Encoding.IntDataType.Int8:return new Int8Array(F);case o.Encoding.IntDataType.Int16:return new Int16Array(F);case o.Encoding.IntDataType.Int32:return new Int32Array(F);case o.Encoding.IntDataType.Uint8:return new Uint8Array(F);case o.Encoding.IntDataType.Uint16:return new Uint16Array(F);case o.Encoding.IntDataType.Uint32:return new Uint32Array(F);default:return new Int32Array(F)}}function _(P,F){switch(P){case o.Encoding.FloatDataType.Float32:return new Float32Array(F);case o.Encoding.FloatDataType.Float64:return new Float64Array(F);default:return new Float64Array(F)}}function p(P){return new Int8Array(P.buffer,P.byteOffset)}function S(P,F,X){return(P.byteOffset!=0||P.byteLength!=P.buffer.byteLength)&&(P=new Uint8Array(P)),c?new X(P.buffer):new X(u(P,F))}function A(P){return S(P,2,Int16Array)}function R(P){return S(P,2,Uint16Array)}function z(P){return S(P,4,Int32Array)}function l(P){return S(P,4,Uint32Array)}function s(P){return S(P,4,Float32Array)}function v(P){return S(P,8,Float64Array)}function w(P,F){const X=P.length,B=_(F.srcType,X),L=1/F.factor;for(let H=0;H<X;H++)B[H]=L*P[H];return B}function E(P,F){const X=P.length,B=_(F.srcType,X),L=(F.max-F.min)/(F.numSteps-1),H=F.min;for(let U=0;U<X;U++)B[U]=H+L*P[U];return B}function C(P,F){const X=g(F.srcType,F.srcSize);let B=0;for(let L=0,H=P.length;L<H;L+=2){const U=P[L],Y=P[L+1];for(let W=0;W<Y;++W)X[B++]=U}return X}function h(P,F){const X=P.length,B=g(F.srcType,X);if(!X)return P;B[0]=P[0]+(F.origin|0);for(let L=1;L<X;++L)B[L]=P[L]+B[L-1];return B}function x(P,F){const X=F.byteCount===1?127:32767,B=-X-1,L=P.length,H=new Int32Array(F.srcSize);let U=0,Y=0;for(;U<L;){let W=0,q=P[U];for(;q===X||q===B;)W+=q,U++,q=P[U];W+=q,H[Y]=W,U++,Y++}return H}function k(P,F){const X=F.byteCount===1?255:65535,B=P.length,L=new Int32Array(F.srcSize);let H=0,U=0;for(;H<B;){let Y=0,W=P[H];for(;W===X;)Y+=W,H++,W=P[H];Y+=W,L[U]=Y,H++,U++}return L}function M(P,F){return P.length===F.srcSize?P:F.isUnsigned?k(P,F):x(P,F)}function D(P,F){const X=y({encoding:F.offsetEncoding,data:F.offsets}),B=y({encoding:F.dataEncoding,data:P}),L=F.stringData,H=new Array(X.length);H[0]="";for(let W=1,q=X.length;W<q;W++)H[W]=L.substring(X[W-1],X[W]);let U=0;const Y=new Array(B.length);for(let W=0,q=B.length;W<q;W++)Y[U++]=H[B[W]+1];return Y}}),"./src/parsers/cifutils/encoding.ts":((e,r,t)=>{t.r(r),t.d(r,{Encoding:()=>c,VERSION:()=>o});const o="0.3.0";var c;(function(u){(function(g){g[g.Int8=1]="Int8",g[g.Int16=2]="Int16",g[g.Int32=3]="Int32",g[g.Uint8=4]="Uint8",g[g.Uint16=5]="Uint16",g[g.Uint32=6]="Uint32"})(u.IntDataType||(u.IntDataType={})),(function(g){g[g.Float32=32]="Float32",g[g.Float64=33]="Float64"})(u.FloatDataType||(u.FloatDataType={}));function y(g){let _;return g instanceof Int8Array?_=u.IntDataType.Int8:g instanceof Int16Array?_=u.IntDataType.Int16:g instanceof Int32Array?_=u.IntDataType.Int32:g instanceof Uint8Array?_=u.IntDataType.Uint8:g instanceof Uint16Array?_=u.IntDataType.Uint16:g instanceof Uint32Array?_=u.IntDataType.Uint32:g instanceof Float32Array?_=u.FloatDataType.Float32:g instanceof Float64Array?_=u.FloatDataType.Float64:_=u.IntDataType.Int32,_}u.getDataType=y;function f(g){if(g instanceof Int8Array||g instanceof Int16Array||g instanceof Int32Array)return!0;for(let _=0,p=g.length;_<p;_++)if(_<0)return!1;return!0}u.isSignedIntegerDataType=f})(c||(c={}))}),"./src/parsers/index.ts":((e,r,t)=>{t.r(r),t.d(r,{Parsers:()=>w,bondLength:()=>v.bondLength,setBondLength:()=>v.setBondLength});var o=t("./src/parsers/VASP.ts"),c=t("./src/parsers/CUBE.ts"),u=t("./src/parsers/XYZ.ts"),y=t("./src/parsers/SDF.ts"),f=t("./src/parsers/CDJSON.ts"),g=t("./src/parsers/CIF.ts"),_=t("./src/parsers/MOL2.ts"),p=t("./src/parsers/PDB.ts"),S=t("./src/parsers/PQR.ts"),A=t("./src/parsers/MMTF.ts"),R=t("./src/parsers/PRMTOP.ts"),z=t("./src/parsers/GRO.ts"),l=t("./src/parsers/LAMMPSTRJ.ts"),s=t("./src/parsers/BCIF.ts"),v=t("./src/parsers/utils/bondLength.ts");const w={vasp:o.VASP,VASP:o.VASP,cube:c.CUBE,CUBE:c.CUBE,xyz:u.XYZ,XYZ:u.XYZ,sdf:y.SDF,SDF:y.SDF,json:f.CDJSON,cdjson:f.CDJSON,CDJSON:f.CDJSON,mcif:g.CIF,cif:g.CIF,CIF:g.CIF,mol2:_.MOL2,MOL2:_.MOL2,pdb:p.PDB,PDB:p.PDB,pdbqt:p.PDB,PDBQT:p.PDB,pqr:S.PQR,PQR:S.PQR,mmtf:A.MMTFparser,MMTF:A.MMTFparser,prmtop:R.PRMTOP,PRMTOP:R.PRMTOP,gro:z.GRO,GRO:z.GRO,lammpstrj:l.LAMMPSTRJ,LAMMPSTRJ:l.LAMMPSTRJ,bcif:s.BCIF,BCIF:s.BCIF}}),"./src/parsers/utils/anumToSymbol.ts":((e,r,t)=>{t.r(r),t.d(r,{anumToSymbol:()=>o});const o={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"}}),"./src/parsers/utils/areConnected.ts":((e,r,t)=>{t.r(r),t.d(r,{areConnected:()=>u});var o=t("./src/parsers/utils/bondLength.ts");const c=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function u(y,f,g){if(g&&g.unboundCations&&(c.has(y.elem)||c.has(f.elem)))return!1;let _=(0,o.bondLength)(y.elem)+(0,o.bondLength)(f.elem);_+=.25,_*=_;let p=y.x-f.x;if(p*=p,p>_)return!1;let S=y.y-f.y;if(S*=S,S>_)return!1;let A=y.z-f.z;if(A*=A,A>_)return!1;const R=p+S+A;return!(isNaN(R)||R<.5||R>_||y.altLoc!==f.altLoc&&y.altLoc.trim()!==""&&f.altLoc.trim()!=="")}}),"./src/parsers/utils/assignBackboneHBonds.ts":((e,r,t)=>{t.r(r),t.d(r,{assignBackboneHBonds:()=>o});function o(c,u){const y=u||3.2,f=y*y,g=[];for(let _=0,p=c.length;_<p;_++){c[_].index=_;const S=c[_];!S.hetflag&&(S.atom==="N"||S.atom==="O")&&(g.push(S),S.hbondOther=null,S.hbondDistanceSq=Number.POSITIVE_INFINITY)}g.sort(function(_,p){return _.z-p.z});for(let _=0,p=g.length;_<p;_++){const S=g[_];for(let A=_+1;A<p;A++){const R=g[A],z=R.z-S.z;if(z>y)break;if(R.atom==S.atom)continue;const l=Math.abs(R.y-S.y);if(l>y)continue;const s=Math.abs(R.x-S.x);if(s>y)continue;const v=s*s+l*l+z*z;v>f||R.chain==S.chain&&Math.abs(R.resi-S.resi)<4||(v<S.hbondDistanceSq&&(S.hbondOther=R,S.hbondDistanceSq=v),v<R.hbondDistanceSq&&(R.hbondOther=S,R.hbondDistanceSq=v))}}}}),"./src/parsers/utils/assignBonds.ts":((e,r,t)=>{t.r(r),t.d(r,{assignBonds:()=>y});var o=t("./src/parsers/utils/areConnected.ts");const c=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],u=4.95;function y(f,g){for(let S=0,A=f.length;S<A;S++)f[S].index||(f[S].index=S);const _={x:{y:{z:[]}}};for(let S=0;S<f.length;S++){const A=f[S],R=Math.floor(A.x/u),z=Math.floor(A.y/u),l=Math.floor(A.z/u);_[R]||(_[R]={}),_[R][z]||(_[R][z]={}),_[R][z][l]||(_[R][z][l]=[]),_[R][z][l].push(A)}function p(S,A){for(let R=0;R<S.length;R++){const z=S[R];for(let l=0;l<A.length;l++){const s=A[l];if((0,o.areConnected)(z,s,g)){const v=z.bonds.indexOf(s.index),w=s.bonds.indexOf(z.index);v===-1&&w===-1?(z.bonds.push(s.index),z.bondOrder.push(1),s.bonds.push(z.index),s.bondOrder.push(1)):v===-1?(z.bonds.push(s.index),z.bondOrder.push(s.bondOrder[w])):w===-1&&(s.bonds.push(z.index),s.bondOrder.push(z.bondOrder[v]))}}}}for(let S in _){const A=parseInt(S);for(let R in _[A]){const z=parseInt(R);for(let l in _[A][z]){const s=parseInt(l),v=_[A][z][s];for(let w=0;w<v.length;w++){const E=v[w];for(let C=w+1;C<v.length;C++){const h=v[C];(0,o.areConnected)(E,h,g)&&E.bonds.indexOf(h.index)==-1&&(E.bonds.push(h.index),E.bondOrder.push(1),h.bonds.push(E.index),h.bondOrder.push(1))}}for(let w=0;w<c.length;w++){const E=c[w];if(!_[A+E.x]||!_[A+E.x][z+E.y]||!_[A+E.x][z+E.y][s+E.z])continue;const C=_[A+E.x][z+E.y][s+E.z];p(v,C)}}}}}}),"./src/parsers/utils/assignPDBBonds.ts":((e,r,t)=>{t.r(r),t.d(r,{assignPDBBonds:()=>y});var o=t("./src/parsers/utils/areConnected.ts"),c=t("./src/parsers/utils/assignBonds.ts"),u=t("./src/parsers/utils/standardResidues.ts");function y(f,g){const _=[],p=[];for(let z=0,l=f.length;z<l;z++){const s=f[z];s.index=z,s.hetflag||!u.standardResidues.has(s.resn)?p.push(s):_.push(s)}(0,c.assignBonds)(p,g),_.sort(function(z,l){return z.chain!==l.chain?z.chain<l.chain?-1:1:z.resi-l.resi});let S=-1,A=-1,R;for(let z=0,l=_.length;z<l;z++){const s=_[z];s.resi!==S&&(S=s.resi,R||A++,R=!1),s.reschain=A;for(let v=z+1;v<_.length;v++){const w=_[v];if(w.chain!==s.chain||w.resi-s.resi>1)break;(0,o.areConnected)(s,w,g)&&(s.bonds.indexOf(w.index)===-1&&(s.bonds.push(w.index),s.bondOrder.push(1),w.bonds.push(s.index),w.bondOrder.push(1)),s.resi!==w.resi&&(R=!0))}}}}),"./src/parsers/utils/atomNameToElem.ts":((e,r,t)=>{t.r(r),t.d(r,{atomNameToElem:()=>c});var o=t("./src/parsers/utils/bondLength.ts");function c(u,y){let f=u.replace(/ /g,"");return f.length>0&&f[0]==="H"&&f!=="Hg"&&f!=="He"&&f!=="Hf"&&f!=="Hs"&&f!=="Ho"&&(f="H"),f.length>1&&(f=f[0].toUpperCase()+f.substring(1).toLowerCase(),o.bondTable[f]===void 0?f=f[0]:y&&(f==="Ca"||f==="Cd")&&(f="C")),f}}),"./src/parsers/utils/bondLength.ts":((e,r,t)=>{t.r(r),t.d(r,{bondLength:()=>c,bondTable:()=>o,setBondLength:()=>u});let o={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function c(y){return o[y]||1.6}function u(y,f){f<0&&(f=0),o[y]=f}}),"./src/parsers/utils/computeSecondaryStructure.ts":((e,r,t)=>{t.r(r),t.d(r,{computeSecondaryStructure:()=>c});var o=t("./src/parsers/utils/assignBackboneHBonds.ts");function c(u,y){(0,o.assignBackboneHBonds)(u,y);const f={};let g,_,p,S,A,R;for(g=0,_=u.length;g<_;g++)if(A=u[g],f[A.chain]===void 0&&(f[A.chain]=[]),isFinite(A.hbondDistanceSq)){const z=A.hbondOther;f[z.chain]===void 0&&(f[z.chain]=[]),Math.abs(z.resi-A.resi)===4&&(f[A.chain][A.resi]="h")}for(p in f)for(S=1;S<f[p].length-1;S++){const z=f[p][S-1],l=f[p][S+1];R=f[p][S],z=="h"&&z==l&&R!=z&&(f[p][S]=z)}for(g=0,_=u.length;g<_;g++)A=u[g],isFinite(A.hbondDistanceSq)&&f[A.chain][A.resi]!="h"&&A.ss!=="h"&&(f[A.chain][A.resi]="maybesheet");for(let z=0,l=u.length;z<l;z++)if(A=u[z],isFinite(A.hbondDistanceSq)&&f[A.chain][A.resi]=="maybesheet"){let s=A.hbondOther,v=f[s.chain][s.resi];(v=="maybesheet"||v=="s")&&(f[A.chain][A.resi]="s",f[s.chain][s.resi]="s")}for(let z in f){for(let l=1;l<f[z].length-1;l++){const s=f[z][l-1],v=f[z][l+1];R=f[z][l],s=="s"&&s==v&&R!=s&&(f[z][l]=s)}for(let l=0;l<f[z].length;l++){const s=f[z][l];(s=="h"||s=="s")&&f[z][l-1]!=s&&f[z][l+1]!=s&&delete f[z][l]}}for(g=0,_=u.length;g<_;g++)A=u[g],R=f[A.chain][A.resi],delete A.hbondOther,delete A.hbondDistanceSq,!(R===void 0||R==="maybesheet")&&(A.ss=R,f[A.chain][A.resi-1]!=R&&(A.ssbegin=!0),f[A.chain][A.resi+1]!=R&&(A.ssend=!0))}}),"./src/parsers/utils/getSinglePDB.ts":((e,r,t)=>{t.r(r),t.d(r,{getSinglePDB:()=>S});var o=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/atomNameToElem.ts"),u=t("./src/parsers/utils/bondLength.ts"),y=t("./src/parsers/utils/computeSecondaryStructure.ts"),f=t("./src/parsers/utils/isEmpty.ts"),g=t("./src/parsers/utils/processSymmetries.ts"),_=t("./src/parsers/utils/assignPDBBonds.ts"),p=t("./src/parsers/utils/validateBonds.ts");function S(A,R,z){const l=[],s=R.assignBonds===void 0?!0:R.assignBonds,v=!R.keepH,w=!!R.noSecondaryStructure,E=!R.noComputeSecondaryStructure,C=!R.doAssembly,h=R.altLoc?R.altLoc:"A",x={symmetries:[],cryst:void 0};let k,M=[];const D=[];let P;const F={};for(let X=0;X<A.length;X++){P=A[X].replace(/^\s*/,"");const B=P.substring(0,6);let L,H,U;if(B.indexOf("END")===0){if(M=A.slice(X+1),B==="END")for(const Y in z)z.hasOwnProperty(Y)&&delete z[Y];break}else if(B==="ATOM  "||B==="HETATM"){let Y,W,q,G,$,Z,xe,ce,Ne,Pe,De,Me;if(De=P.substring(16,17),De!==" "&&De!==h&&h!=="*"||(Pe=parseInt(P.substring(6,11)),k=P.substring(12,16).replace(/ /g,""),Y=P.substring(17,20).replace(/ /g,""),W=P.substring(21,22),q=parseInt(P.substring(22,26)),G=P.substring(26,27),$=parseFloat(P.substring(30,38)),Z=parseFloat(P.substring(38,46)),xe=parseFloat(P.substring(46,54)),Me=parseFloat(P.substring(60,68)),Ne=P.substring(76,78).replace(/ /g,""),Ne===""||u.bondTable[Ne]===void 0?Ne=(0,c.atomNameToElem)(P.substring(12,14),P[0]=="A"):Ne=Ne[0].toUpperCase()+Ne.substring(1).toLowerCase(),Ne==="H"&&v))continue;B[0]=="H"?ce=!0:ce=!1,D[Pe]=l.length,l.push({resn:Y,x:$,y:Z,z:xe,elem:Ne,hetflag:ce,altLoc:De,chain:W,resi:q,icode:G,rescode:q+(G!==" "?"^"+G:""),serial:Pe,atom:k,bonds:[],ss:"c",bondOrder:[],properties:{},b:Me,pdbline:P})}else if(B==="SHEET "){L=P.substring(21,22),H=parseInt(P.substring(22,26)),U=parseInt(P.substring(33,37)),L in z||(z[L]={}),z[L][H]="s1";for(let Y=H+1;Y<U;Y++)z[L][Y]="s";z[L][U]="s2"}else if(B==="CONECT"){const Y=parseInt(P.substring(6,11)),W=D[Y],q=l[W],G=[11,16,21,26];for(let $=0;$<4;$++){const Z=parseInt(P.substring(G[$],G[$]+5)),xe=D[Z];let ce=W+":"+xe;const Ne=l[xe];if(q!==void 0&&Ne!==void 0)if(!F[ce])F[ce]=1,(q.bonds.length==0||q.bonds[q.bonds.length-1]!==xe)&&(q.bonds.push(xe),q.bondOrder.push(1));else{F[ce]+=1;for(let Pe=0;Pe<q.bonds.length;Pe++)if(q.bonds[Pe]==xe){const De=F[ce];De>=4?q.bondOrder[Pe]=1:q.bondOrder[Pe]=De}}}}else if(B==="HELIX "){L=P.substring(19,20),H=parseInt(P.substring(21,25)),U=parseInt(P.substring(33,37)),L in z||(z[L]={}),z[L][H]="h1";for(let Y=H+1;Y<U;Y++)z[L][Y]="h";z[L][U]="h2"}else if(!C&&B==="REMARK"&&P.substring(13,18)==="BIOMT"){let Y,W=new o.Matrix4;for(Y=1;Y<=3;Y++)if(P=A[X].replace(/^\s*/,""),parseInt(P.substring(18,19))==Y)W.elements[Y-1]=parseFloat(P.substring(23,33)),W.elements[Y-1+4]=parseFloat(P.substring(33,43)),W.elements[Y-1+8]=parseFloat(P.substring(43,53)),W.elements[Y-1+12]=parseFloat(P.substring(53)),X++;else for(;P.substring(13,18)==="BIOMT";)X++,P=A[X].replace(/^\s*/,"");W.elements[3]=0,W.elements[7]=0,W.elements[11]=0,W.elements[15]=1,x.symmetries.push(W),X--}else if(B==="CRYST1"){let Y,W,q,G,$,Z;Y=parseFloat(P.substring(7,15)),W=parseFloat(P.substring(16,24)),q=parseFloat(P.substring(25,33)),G=parseFloat(P.substring(34,40)),$=parseFloat(P.substring(41,47)),Z=parseFloat(P.substring(48,54)),x.cryst={a:Y,b:W,c:q,alpha:G,beta:$,gamma:Z}}else if(B==="ANISOU"){const Y=parseInt(P.substring(6,11)),W=D[Y],q=l[W];if(q){const G=P.substring(30).trim().split(/\s+/),$={u11:parseInt(G[0]),u22:parseInt(G[1]),u33:parseInt(G[2]),u12:parseInt(G[3]),u13:parseInt(G[4]),u23:parseInt(G[5])};q.uMat=$}}}if((0,p.validateBonds)(l,D),s&&(0,_.assignPDBBonds)(l,R),C||(0,g.processSymmetries)(x.symmetries,l,R,x.cryst),E&&!w&&(0,y.computeSecondaryStructure)(l,R.hbondCutoff),!(0,f.isEmpty)(z))for(let X=0;X<l.length;X++){const B=l[X];if(B!==void 0&&B.chain in z&&B.resi in z[B.chain]){const L=z[B.chain][B.resi];B.ss=L[0],L.length>1&&(L[1]=="1"?B.ssbegin=!0:L[1]=="2"&&(B.ssend=!0))}}return[l,x,M]}}),"./src/parsers/utils/isEmpty.ts":((e,r,t)=>{t.r(r),t.d(r,{isEmpty:()=>o});function o(c){for(const u in c)return!1;return!0}}),"./src/parsers/utils/processSymmetries.ts":((e,r,t)=>{t.r(r),t.d(r,{processSymmetries:()=>c});var o=t("./src/WebGL/index.ts");function c(u,y,f,g){const _=!f.duplicateAssemblyAtoms,p=y.length;let S=p,A=-1,R=null,z=null;(f.normalizeAssembly||f.wrapAtoms)&&g&&(R=(0,o.conversionMatrix3)(g.a,g.b,g.c,g.alpha,g.beta,g.gamma),z=new o.Matrix3,z.getInverse3(R));let l=function(w){let E=w.clone().applyMatrix3(z);const C=[E.x,E.y,E.z],h=[0,0,0];for(let k=0;k<3;k++){for(;C[k]<-.001;)C[k]+=1,h[k]+=1;for(;C[k]>1.001;)C[k]-=1,h[k]-=1}const x=new o.Vector3(h[0],h[1],h[2]);return x.applyMatrix3(R),x};if(f.normalizeAssembly&&g)for(let w=0;w<u.length;w++){const E=new o.Vector3(0,0,0);for(let h=0;h<p;h++){const x=new o.Vector3(y[h].x,y[h].y,y[h].z);x.applyMatrix4(u[w]),E.add(x)}E.divideScalar(p);const C=l(E);u[w].isNearlyIdentity()&&C.lengthSq()>.001&&(A=w),u[w].translate(C)}if(_){if(u.length>1)for(let w=0;w<y.length;w++){var s=[];for(let E=0;E<u.length;E++)if(!u[E].isNearlyIdentity()){var v=new o.Vector3;v.set(y[w].x,y[w].y,y[w].z),v.applyMatrix4(u[E]),s.push(v)}y[w].symmetries=s}}else{for(let w=0;w<p;w++)y[w].sym=-1;for(let w=0;w<u.length;w++)if(!u[w].isNearlyIdentity()&&A!=w){let E=new o.Vector3;for(let C=0;C<p;C++){const h=[];for(let k=0;k<y[C].bonds.length;k++)h.push(y[C].bonds[k]+S);if(E.set(y[C].x,y[C].y,y[C].z),E.applyMatrix4(u[w]),f.wrapAtoms&&g){let k=l(E);E.add(k)}const x={};for(const k in y[C])x[k]=y[C][k];x.x=E.x,x.y=E.y,x.z=E.z,x.bonds=h,x.sym=w,x.index=y.length,y.push(x)}S=y.length}else for(let E=0;E<p;E++)y[E].sym=w;if(f.wrapAtoms&&g){let w=new o.Vector3;for(let E=0;E<p;E++){w.set(y[E].x,y[E].y,y[E].z);let C=l(w);w.add(C),y[E].x=w.x,y[E].y=w.y,y[E].z=w.z}}if(A>=0){const w=new o.Vector3;for(let E=0;E<p;E++)w.set(y[E].x,y[E].y,y[E].z),w.applyMatrix4(u[A]),y[E].x=w.x,y[E].y=w.y,y[E].z=w.z}u.length=0}}}),"./src/parsers/utils/standardResidues.ts":((e,r,t)=>{t.r(r),t.d(r,{standardResidues:()=>o});const o=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"])}),"./src/parsers/utils/validateBonds.ts":((e,r,t)=>{t.r(r),t.d(r,{validateBonds:()=>o});function o(c,u){for(let y=0,f=c.length;y<f;y++){const g=c[y];for(let _=0;_<g.bonds.length;_++){const p=g.bonds[_],S=c[p],A=u[g.serial];S&&A&&S.bonds.indexOf(A)<0&&(S.bonds.push(A),S.bondOrder.push(g.bondOrder[_]))}}}}),"./src/partialCharges.ts":((e,r,t)=>{t.r(r),t.d(r,{applyPartialCharges:()=>c,partialCharges:()=>o});const o={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function c(u,y){if((!y||typeof u.partialCharge>"u")&&u.resn&&u.atom){var f=u.resn+":"+u.atom;u.properties.partialCharge=o[f]}}}),"./src/specs.ts":((e,r,t)=>{t.r(r)}),"./src/utilities.ts":((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/Gradient.ts"),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/VolumeData.ts"),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/colors.ts"),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/pako/dist/pako.esm.mjs");function extend(e,r){for(var t in r)r.hasOwnProperty(t)&&r[t]!==void 0&&(e[t]=r[t]);return e}function deepCopy(e){let r,t,o;if(e==null)return{};if(typeof e!="object"||e===null)return e;r=Array.isArray(e)?[]:{};for(o in e)t=e[o],r[o]=deepCopy(t);return r}function isNumeric(e){var r=typeof e;return(r==="number"||r==="string")&&!isNaN(e-parseFloat(e))}function isEmptyObject(e){var r;for(r in e)return!1;return!0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?null:callback}function adjustVolumeStyle(e){e&&(e.volformat&&!(e.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData)&&(e.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(e.voldata,e.volformat)),e.volscheme&&(e.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(e.volscheme)))}function getExtent(e,r){var t,o,c,u,y,f,g,_,p,S,A=!r;if(t=o=c=9999,u=y=f=-9999,g=_=p=S=0,e.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var R=0;R<e.length;R++){var z=e[R];if(!(typeof z>"u"||!isFinite(z.x)||!isFinite(z.y)||!isFinite(z.z))&&(S++,g+=z.x,_+=z.y,p+=z.z,t=t<z.x?t:z.x,o=o<z.y?o:z.y,c=c<z.z?c:z.z,u=u>z.x?u:z.x,y=y>z.y?y:z.y,f=f>z.z?f:z.z,z.symmetries&&A))for(var l=0;l<z.symmetries.length;l++)S++,g+=z.symmetries[l].x,_+=z.symmetries[l].y,p+=z.symmetries[l].z,t=t<z.symmetries[l].x?t:z.symmetries[l].x,o=o<z.symmetries[l].y?o:z.symmetries[l].y,c=c<z.symmetries[l].z?c:z.symmetries[l].z,u=u>z.symmetries[l].x?u:z.symmetries[l].x,y=y>z.symmetries[l].y?y:z.symmetries[l].y,f=f>z.symmetries[l].z?f:z.symmetries[l].z}return[[t,o,c],[u,y,f],[g/S,_/S,p/S]]}function getPropertyRange(e,r){for(var t=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,c=0,u=e.length;c<u;c++){var y=e[c],f=getAtomProperty(y,r);f!=null&&(f<t&&(t=f),f>o&&(o=f))}return!isFinite(t)&&!isFinite(o)?t=o=0:isFinite(t)?isFinite(o)||(o=t):t=o,[t,o]}class PausableTimer{constructor(r,t,o){this.total_time_run=0,this.fn=r,this.arg=o,this.countdown=t,this.start_time=new Date().getTime(),this.ident=setTimeout(r,t,o)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(e){for(var r=window.atob(e),t=r.length,o=new Uint8Array(t),c=0;c<t;c++)o[c]=r.charCodeAt(c);return o}function getAtomProperty(e,r){var t=null;return e.properties&&typeof e.properties[r]<"u"?t=e.properties[r]:typeof e[r]<"u"&&(t=e[r]),t}function mergeGeos(e,r){var t=r.geometry;t!==void 0&&e.geometryGroups.push(t.geometryGroups[0])}function specStringToObject(e){if(typeof e=="object"||typeof e>"u"||e==null)return e;try{return JSON.parse(e)}catch{}e=e.replace(/%7E/g,"~");var r=function(A){return isNumeric(A)?Math.floor(parseFloat(A))==parseInt(A)||A.indexOf(".")>=0?parseFloat(A):parseInt(A):A==="true"?!0:A==="false"?!1:A},t={};if(e==="all")return t;for(var o=e.split(";"),c=0;c<o.length;c++){var u=o[c].split(":"),y=u[0],f={},g=u[1];if(g)if(g=g.replace(/~/g,"="),g.indexOf("=")!==-1)for(var _=g.split(","),p=0;p<_.length;p++){var S=_[p].split("=",2);f[S[0]]=r(S[1])}else g.indexOf(",")!==-1?f=g.split(","):f=r(g);t[y]=f}return t}function checkStatus(e){if(!e.ok)throw new Error(`HTTP ${e.status} - ${e.statusText}`);return e}function get(e,r){var t=fetch(e).then(checkStatus).then(o=>o.text());return r?t.then(r):t}function getbin(e,r,t,o){var c;return t=="POST"?c=fetch(e,{method:"POST",body:o}).then(u=>checkStatus(u)).then(u=>u.arrayBuffer()):c=fetch(e).then(u=>checkStatus(u)).then(u=>u.arrayBuffer()),r?c.then(r):c}function download(e,r,t,o){var c="",u="",y="",f=null,g=r.addModel();if(e.indexOf(":")<0&&(e.length==4?e="pdb:"+e:isNaN(e)?e="url:"+e:e="cid:"+e),e.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),e="bcif:"+e.slice(5)),e.substring(0,5)==="bcif:")e=e.substring(5).toUpperCase(),y="https://models.rcsb.org/"+e+".bcif.gz",t&&typeof t.noComputeSecondaryStructure>"u"&&(t.noComputeSecondaryStructure=!0),f=new Promise(function(p){getbin(y).then(function(S){g.addMolData(S,"bcif.gz",t),r.zoomTo(),r.render(),p(g)},function(){console.error("fetch of "+y+" failed.")})});else{if(e.substring(0,4)==="pdb:"){if(c="bcif",t&&t.format&&(c=t.format),t&&typeof t.noComputeSecondaryStructure>"u"&&(t.noComputeSecondaryStructure=!0),e=e.substring(4).toUpperCase(),!e.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}c=="bcif"?y="https://models.rcsb.org/"+e.toUpperCase()+".bcif.gz":(u=t&&t.pdbUri?t.pdbUri:"https://files.rcsb.org/view/",y=u+e+"."+c)}else if(e.substring(0,4)=="cid:"){if(c="sdf",e=e.substring(4),!e.match(/^[0-9]+$/)){alert("Wrong Compound ID");return}y="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+e+"/SDF?record_type=3d"}else e.substring(0,4)=="url:"&&(y=e.substring(4),c=y);var _=function(p){g.addMolData(p,c,t),r.zoomTo(),r.render()};f=new Promise(function(p){c=="bcif"?getbin(y).then(function(S){_(S),p(g)}).catch(function(){u=t&&t.pdbUri?t.pdbUri:"https://files.rcsb.org/view/",y=u+e+".pdb",c="pdb",console.warn("falling back to pdb format"),get(y).then(function(S){_(S),p(g)}).catch(function(S){_(""),p(g),console.error("fetch of "+y+" failed: "+S.statusText)})}):get(y).then(function(S){_(S),p(g)}).catch(function(S){_(""),p(g),console.error("fetch of "+y+" failed: "+S.statusText)})})}return o?(f.then(function(p){o(p)}),g):f}function getColorFromStyle(e,r){let t=r.colorscheme;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]<"u")t=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t];else if(typeof t=="string"&&t.endsWith("Carbon")){let u=t.substring(0,t.lastIndexOf("Carbon")).toLowerCase();if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[u]<"u"){let y=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);y.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[u],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]={prop:"elem",map:y},t=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]}}let o=e.color;if(typeof r.color<"u"&&r.color!="spectrum"&&(o=r.color),typeof t<"u"){let u,y;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[t]<"u")t=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[t],typeof t[e[t.prop]]<"u"&&(o=t.map[e[t.prop]]);else if(typeof t[e[t.prop]]<"u")o=t.map[e[t.prop]];else if(typeof t.prop<"u"&&typeof t.gradient<"u"){u=t.prop;var c=t.gradient;c instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(c=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(t));let f=c.range()||[-1,1];y=getAtomProperty(e,u),y!=null&&(o=c.valueToHex(y,f))}else typeof t.prop<"u"&&typeof t.map<"u"?(u=t.prop,y=getAtomProperty(e,u),typeof t.map[y]<"u"&&(o=t.map[y])):typeof r.colorscheme[e.elem]<"u"?o=r.colorscheme[e.elem]:console.warn("Could not interpret colorscheme "+t)}else typeof r.colorfunc<"u"&&(o=r.colorfunc(e));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(o)}function getElement(e){let r=e;return typeof e=="string"?r=document.querySelector("#"+e):typeof e=="object"&&e.get&&(r=e.get(0)),r}function inflateString(e,r=!0){let t;return typeof e=="string"?t=new TextEncoder().encode(e):t=new Uint8Array(e),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(t,{to:r?"string":null})}}),"./node_modules/upng-js/UPNG.js":((e,r,t)=>{(function(){var o={},c;e.exports=o,c=t("./node_modules/upng-js/node_modules/pako/index.js"),(function(u,y){u.toRGBA8=function(f){var g=f.width,_=f.height;if(f.tabs.acTL==null)return[u.toRGBA8.decodeImage(f.data,g,_,f).buffer];var p=[];f.frames[0].data==null&&(f.frames[0].data=f.data);for(var S,A=new Uint8Array(g*_*4),R=0;R<f.frames.length;R++){var z=f.frames[R],l=z.rect.x,s=z.rect.y,v=z.rect.width,w=z.rect.height,E=u.toRGBA8.decodeImage(z.data,v,w,f);if(R==0?S=E:z.blend==0?u._copyTile(E,v,w,S,g,_,l,s,0):z.blend==1&&u._copyTile(E,v,w,S,g,_,l,s,1),p.push(S.buffer),S=S.slice(0),z.dispose!=0){if(z.dispose==1)u._copyTile(A,v,w,S,g,_,l,s,0);else if(z.dispose==2){for(var C=R-1;f.frames[C].dispose==2;)C--;S=new Uint8Array(p[C]).slice(0)}}}return p},u.toRGBA8.decodeImage=function(f,g,_,p){var S=g*_,A=u.decode._getBPP(p),R=Math.ceil(g*A/8),z=new Uint8Array(S*4),l=new Uint32Array(z.buffer),s=p.ctype,v=p.depth,w=u._bin.readUshort;if(s==6){var E=S<<2;if(v==8)for(var C=0;C<E;C++)z[C]=f[C];if(v==16)for(var C=0;C<E;C++)z[C]=f[C<<1]}else if(s==2){var h=p.tabs.tRNS,x=-1,k=-1,M=-1;if(h&&(x=h[0],k=h[1],M=h[2]),v==8)for(var C=0;C<S;C++){var D=C<<2,P=C*3;z[D]=f[P],z[D+1]=f[P+1],z[D+2]=f[P+2],z[D+3]=255,x!=-1&&f[P]==x&&f[P+1]==k&&f[P+2]==M&&(z[D+3]=0)}if(v==16)for(var C=0;C<S;C++){var D=C<<2,P=C*6;z[D]=f[P],z[D+1]=f[P+2],z[D+2]=f[P+4],z[D+3]=255,x!=-1&&w(f,P)==x&&w(f,P+2)==k&&w(f,P+4)==M&&(z[D+3]=0)}}else if(s==3){var F=p.tabs.PLTE,X=p.tabs.tRNS,B=X?X.length:0;if(v==1)for(var L=0;L<_;L++)for(var H=L*R,U=L*g,C=0;C<g;C++){var D=U+C<<2,Y=f[H+(C>>3)]>>7-((C&7)<<0)&1,W=3*Y;z[D]=F[W],z[D+1]=F[W+1],z[D+2]=F[W+2],z[D+3]=Y<B?X[Y]:255}if(v==2)for(var L=0;L<_;L++)for(var H=L*R,U=L*g,C=0;C<g;C++){var D=U+C<<2,Y=f[H+(C>>2)]>>6-((C&3)<<1)&3,W=3*Y;z[D]=F[W],z[D+1]=F[W+1],z[D+2]=F[W+2],z[D+3]=Y<B?X[Y]:255}if(v==4)for(var L=0;L<_;L++)for(var H=L*R,U=L*g,C=0;C<g;C++){var D=U+C<<2,Y=f[H+(C>>1)]>>4-((C&1)<<2)&15,W=3*Y;z[D]=F[W],z[D+1]=F[W+1],z[D+2]=F[W+2],z[D+3]=Y<B?X[Y]:255}if(v==8)for(var C=0;C<S;C++){var D=C<<2,Y=f[C],W=3*Y;z[D]=F[W],z[D+1]=F[W+1],z[D+2]=F[W+2],z[D+3]=Y<B?X[Y]:255}}else if(s==4){if(v==8)for(var C=0;C<S;C++){var D=C<<2,q=C<<1,G=f[q];z[D]=G,z[D+1]=G,z[D+2]=G,z[D+3]=f[q+1]}if(v==16)for(var C=0;C<S;C++){var D=C<<2,q=C<<2,G=f[q];z[D]=G,z[D+1]=G,z[D+2]=G,z[D+3]=f[q+2]}}else if(s==0){var x=p.tabs.tRNS?p.tabs.tRNS:-1;if(v==1)for(var C=0;C<S;C++){var G=255*(f[C>>3]>>7-(C&7)&1),$=G==x*255?0:255;l[C]=$<<24|G<<16|G<<8|G}if(v==2)for(var C=0;C<S;C++){var G=85*(f[C>>2]>>6-((C&3)<<1)&3),$=G==x*85?0:255;l[C]=$<<24|G<<16|G<<8|G}if(v==4)for(var C=0;C<S;C++){var G=17*(f[C>>1]>>4-((C&1)<<2)&15),$=G==x*17?0:255;l[C]=$<<24|G<<16|G<<8|G}if(v==8)for(var C=0;C<S;C++){var G=f[C],$=G==x?0:255;l[C]=$<<24|G<<16|G<<8|G}if(v==16)for(var C=0;C<S;C++){var G=f[C<<1],$=w(f,C<<1)==x?0:255;l[C]=$<<24|G<<16|G<<8|G}}return z},u.decode=function(f){for(var g=new Uint8Array(f),_=8,p=u._bin,S=p.readUshort,A=p.readUint,R={tabs:{},frames:[]},z=new Uint8Array(g.length),l=0,s,v=0,w=[137,80,78,71,13,10,26,10],E=0;E<8;E++)if(g[E]!=w[E])throw"The input is not a PNG file!";for(;_<g.length;){var C=p.readUint(g,_);_+=4;var h=p.readASCII(g,_,4);if(_+=4,h=="IHDR")u.decode._IHDR(g,_,R);else if(h=="IDAT"){for(var E=0;E<C;E++)z[l+E]=g[_+E];l+=C}else if(h=="acTL")R.tabs[h]={num_frames:A(g,_),num_plays:A(g,_+4)},s=new Uint8Array(g.length);else if(h=="fcTL"){if(v!=0){var x=R.frames[R.frames.length-1];x.data=u.decode._decompress(R,s.slice(0,v),x.rect.width,x.rect.height),v=0}var k={x:A(g,_+12),y:A(g,_+16),width:A(g,_+4),height:A(g,_+8)},M=S(g,_+22);M=S(g,_+20)/(M==0?100:M);var D={rect:k,delay:Math.round(M*1e3),dispose:g[_+24],blend:g[_+25]};R.frames.push(D)}else if(h=="fdAT"){for(var E=0;E<C-4;E++)s[v+E]=g[_+E+4];v+=C-4}else if(h=="pHYs")R.tabs[h]=[p.readUint(g,_),p.readUint(g,_+4),g[_+8]];else if(h=="cHRM"){R.tabs[h]=[];for(var E=0;E<8;E++)R.tabs[h].push(p.readUint(g,_+E*4))}else if(h=="tEXt"){R.tabs[h]==null&&(R.tabs[h]={});var P=p.nextZero(g,_),F=p.readASCII(g,_,P-_),X=p.readASCII(g,P+1,_+C-P-1);R.tabs[h][F]=X}else if(h=="iTXt"){R.tabs[h]==null&&(R.tabs[h]={});var P=0,B=_;P=p.nextZero(g,B);var F=p.readASCII(g,B,P-B);B=P+1,g[B],g[B+1],B+=2,P=p.nextZero(g,B),p.readASCII(g,B,P-B),B=P+1,P=p.nextZero(g,B),p.readUTF8(g,B,P-B),B=P+1;var X=p.readUTF8(g,B,C-(B-_));R.tabs[h][F]=X}else if(h=="PLTE")R.tabs[h]=p.readBytes(g,_,C);else if(h=="hIST"){var L=R.tabs.PLTE.length/3;R.tabs[h]=[];for(var E=0;E<L;E++)R.tabs[h].push(S(g,_+E*2))}else if(h=="tRNS")R.ctype==3?R.tabs[h]=p.readBytes(g,_,C):R.ctype==0?R.tabs[h]=S(g,_):R.ctype==2&&(R.tabs[h]=[S(g,_),S(g,_+2),S(g,_+4)]);else if(h=="gAMA")R.tabs[h]=p.readUint(g,_)/1e5;else if(h=="sRGB")R.tabs[h]=g[_];else if(h=="bKGD")R.ctype==0||R.ctype==4?R.tabs[h]=[S(g,_)]:R.ctype==2||R.ctype==6?R.tabs[h]=[S(g,_),S(g,_+2),S(g,_+4)]:R.ctype==3&&(R.tabs[h]=g[_]);else if(h=="IEND"){if(v!=0){var x=R.frames[R.frames.length-1];x.data=u.decode._decompress(R,s.slice(0,v),x.rect.width,x.rect.height),v=0}R.data=u.decode._decompress(R,z,R.width,R.height);break}_+=C,p.readUint(g,_),_+=4}return delete R.compress,delete R.interlace,delete R.filter,R},u.decode._decompress=function(f,g,_,p){return f.compress==0&&(g=u.decode._inflate(g)),f.interlace==0?g=u.decode._filterZero(g,f,0,_,p):f.interlace==1&&(g=u.decode._readInterlace(g,f)),g},u.decode._inflate=function(f){return y.inflate(f)},u.decode._readInterlace=function(f,g){for(var _=g.width,p=g.height,S=u.decode._getBPP(g),A=S>>3,R=Math.ceil(_*S/8),z=new Uint8Array(p*R),l=0,s=[0,0,4,0,2,0,1],v=[0,4,0,2,0,1,0],w=[8,8,8,4,4,2,2],E=[8,8,4,4,2,2,1],C=0;C<7;){for(var h=w[C],x=E[C],k=0,M=0,D=s[C];D<p;)D+=h,M++;for(var P=v[C];P<_;)P+=x,k++;var F=Math.ceil(k*S/8);u.decode._filterZero(f,g,l,k,M);for(var X=0,B=s[C];B<p;){for(var L=v[C],H=l+X*F<<3;L<_;){if(S==1){var U=f[H>>3];U=U>>7-(H&7)&1,z[B*R+(L>>3)]|=U<<7-((L&3)<<0)}if(S==2){var U=f[H>>3];U=U>>6-(H&7)&3,z[B*R+(L>>2)]|=U<<6-((L&3)<<1)}if(S==4){var U=f[H>>3];U=U>>4-(H&7)&15,z[B*R+(L>>1)]|=U<<4-((L&1)<<2)}if(S>=8)for(var Y=B*R+L*A,W=0;W<A;W++)z[Y+W]=f[(H>>3)+W];H+=S,L+=x}X++,B+=h}k*M!=0&&(l+=M*(1+F)),C=C+1}return z},u.decode._getBPP=function(f){var g=[1,null,3,1,2,null,4][f.ctype];return g*f.depth},u.decode._filterZero=function(f,g,_,p,S){var A=u.decode._getBPP(g),R=Math.ceil(p*A/8),z=u.decode._paeth;A=Math.ceil(A/8);for(var l=0;l<S;l++){var s=_+l*R,v=s+l+1,w=f[v-1];if(w==0)for(var E=0;E<R;E++)f[s+E]=f[v+E];else if(w==1){for(var E=0;E<A;E++)f[s+E]=f[v+E];for(var E=A;E<R;E++)f[s+E]=f[v+E]+f[s+E-A]&255}else if(l==0){for(var E=0;E<A;E++)f[s+E]=f[v+E];if(w==2)for(var E=A;E<R;E++)f[s+E]=f[v+E]&255;if(w==3)for(var E=A;E<R;E++)f[s+E]=f[v+E]+(f[s+E-A]>>1)&255;if(w==4)for(var E=A;E<R;E++)f[s+E]=f[v+E]+z(f[s+E-A],0,0)&255}else{if(w==2)for(var E=0;E<R;E++)f[s+E]=f[v+E]+f[s+E-R]&255;if(w==3){for(var E=0;E<A;E++)f[s+E]=f[v+E]+(f[s+E-R]>>1)&255;for(var E=A;E<R;E++)f[s+E]=f[v+E]+(f[s+E-R]+f[s+E-A]>>1)&255}if(w==4){for(var E=0;E<A;E++)f[s+E]=f[v+E]+z(0,f[s+E-R],0)&255;for(var E=A;E<R;E++)f[s+E]=f[v+E]+z(f[s+E-A],f[s+E-R],f[s+E-A-R])&255}}}return f},u.decode._paeth=function(f,g,_){var p=f+g-_,S=Math.abs(p-f),A=Math.abs(p-g),R=Math.abs(p-_);return S<=A&&S<=R?f:A<=R?g:_},u.decode._IHDR=function(f,g,_){var p=u._bin;_.width=p.readUint(f,g),g+=4,_.height=p.readUint(f,g),g+=4,_.depth=f[g],g++,_.ctype=f[g],g++,_.compress=f[g],g++,_.filter=f[g],g++,_.interlace=f[g],g++},u._bin={nextZero:function(f,g){for(;f[g]!=0;)g++;return g},readUshort:function(f,g){return f[g]<<8|f[g+1]},writeUshort:function(f,g,_){f[g]=_>>8&255,f[g+1]=_&255},readUint:function(f,g){return f[g]*16777216+(f[g+1]<<16|f[g+2]<<8|f[g+3])},writeUint:function(f,g,_){f[g]=_>>24&255,f[g+1]=_>>16&255,f[g+2]=_>>8&255,f[g+3]=_&255},readASCII:function(f,g,_){for(var p="",S=0;S<_;S++)p+=String.fromCharCode(f[g+S]);return p},writeASCII:function(f,g,_){for(var p=0;p<_.length;p++)f[g+p]=_.charCodeAt(p)},readBytes:function(f,g,_){for(var p=[],S=0;S<_;S++)p.push(f[g+S]);return p},pad:function(f){return f.length<2?"0"+f:f},readUTF8:function(f,g,_){for(var p="",S,A=0;A<_;A++)p+="%"+u._bin.pad(f[g+A].toString(16));try{S=decodeURIComponent(p)}catch{return u._bin.readASCII(f,g,_)}return S}},u._copyTile=function(f,g,_,p,S,A,R,z,l){for(var s=Math.min(g,S),v=Math.min(_,A),w=0,E=0,C=0;C<v;C++)for(var h=0;h<s;h++)if(R>=0&&z>=0?(w=C*g+h<<2,E=(z+C)*S+R+h<<2):(w=(-z+C)*g-R+h<<2,E=C*S+h<<2),l==0)p[E]=f[w],p[E+1]=f[w+1],p[E+2]=f[w+2],p[E+3]=f[w+3];else if(l==1){var x=f[w+3]*.00392156862745098,k=f[w]*x,M=f[w+1]*x,D=f[w+2]*x,P=p[E+3]*(1/255),F=p[E]*P,X=p[E+1]*P,B=p[E+2]*P,L=1-x,H=x+P*L,U=H==0?0:1/H;p[E+3]=255*H,p[E+0]=(k+F*L)*U,p[E+1]=(M+X*L)*U,p[E+2]=(D+B*L)*U}else if(l==2){var x=f[w+3],k=f[w],M=f[w+1],D=f[w+2],P=p[E+3],F=p[E],X=p[E+1],B=p[E+2];x==P&&k==F&&M==X&&D==B?(p[E]=0,p[E+1]=0,p[E+2]=0,p[E+3]=0):(p[E]=k,p[E+1]=M,p[E+2]=D,p[E+3]=x)}else if(l==3){var x=f[w+3],k=f[w],M=f[w+1],D=f[w+2],P=p[E+3],F=p[E],X=p[E+1],B=p[E+2];if(x==P&&k==F&&M==X&&D==B)continue;if(x<220&&P>20)return!1}return!0},u.encode=function(f,g,_,p,S,A){p==null&&(p=0),A==null&&(A=!1);for(var R=new Uint8Array(f[0].byteLength*f.length+100),z=[137,80,78,71,13,10,26,10],l=0;l<8;l++)R[l]=z[l];var s=8,v=u._bin,w=u.crc.crc,E=v.writeUint,C=v.writeUshort,h=v.writeASCII,x=u.encode.compressPNG(f,g,_,p,A);E(R,s,13),s+=4,h(R,s,"IHDR"),s+=4,E(R,s,g),s+=4,E(R,s,_),s+=4,R[s]=x.depth,s++,R[s]=x.ctype,s++,R[s]=0,s++,R[s]=0,s++,R[s]=0,s++,E(R,s,w(R,s-17,17)),s+=4,E(R,s,1),s+=4,h(R,s,"sRGB"),s+=4,R[s]=1,s++,E(R,s,w(R,s-5,5)),s+=4;var k=f.length>1;if(k&&(E(R,s,8),s+=4,h(R,s,"acTL"),s+=4,E(R,s,f.length),s+=4,E(R,s,0),s+=4,E(R,s,w(R,s-12,12)),s+=4),x.ctype==3){var M=x.plte.length;E(R,s,M*3),s+=4,h(R,s,"PLTE"),s+=4;for(var l=0;l<M;l++){var D=l*3,P=x.plte[l],F=P&255,X=P>>8&255,B=P>>16&255;R[s+D+0]=F,R[s+D+1]=X,R[s+D+2]=B}if(s+=M*3,E(R,s,w(R,s-M*3-4,M*3+4)),s+=4,x.gotAlpha){E(R,s,M),s+=4,h(R,s,"tRNS"),s+=4;for(var l=0;l<M;l++)R[s+l]=x.plte[l]>>24&255;s+=M,E(R,s,w(R,s-M-4,M+4)),s+=4}}for(var L=0,H=0;H<x.frames.length;H++){var U=x.frames[H];k&&(E(R,s,26),s+=4,h(R,s,"fcTL"),s+=4,E(R,s,L++),s+=4,E(R,s,U.rect.width),s+=4,E(R,s,U.rect.height),s+=4,E(R,s,U.rect.x),s+=4,E(R,s,U.rect.y),s+=4,C(R,s,S[H]),s+=2,C(R,s,1e3),s+=2,R[s]=U.dispose,s++,R[s]=U.blend,s++,E(R,s,w(R,s-30,30)),s+=4);var Y=U.cimg,M=Y.length;E(R,s,M+(H==0?0:4)),s+=4;var W=s;h(R,s,H==0?"IDAT":"fdAT"),s+=4,H!=0&&(E(R,s,L++),s+=4);for(var l=0;l<M;l++)R[s+l]=Y[l];s+=M,E(R,s,w(R,W,s-W)),s+=4}return E(R,s,0),s+=4,h(R,s,"IEND"),s+=4,E(R,s,w(R,s-4,4)),s+=4,R.buffer.slice(0,s)},u.encode.compressPNG=function(f,g,_,p,S){for(var A=u.encode.compress(f,g,_,p,!1,S),R=0;R<f.length;R++){var z=A.frames[R];z.rect.width;var l=z.rect.height,s=z.bpl,v=z.bpp,w=new Uint8Array(l*s+l);z.cimg=u.encode._filterZero(z.img,l,v,s,w)}return A},u.encode.compress=function(f,g,_,p,S,A){A==null&&(A=!1);for(var R=6,z=8,l=4,s=255,v=0;v<f.length;v++)for(var w=new Uint8Array(f[v]),E=w.length,C=0;C<E;C+=4)s&=w[C+3];var h=s!=255,x={},k=[];if(f.length!=0&&(x[0]=0,k.push(0),p!=0&&p--),p!=0){var M=u.quantize(f,p,S);f=M.bufs;for(var C=0;C<M.plte.length;C++){var D=M.plte[C].est.rgba;x[D]==null&&(x[D]=k.length,k.push(D))}}else for(var v=0;v<f.length;v++)for(var P=new Uint32Array(f[v]),E=P.length,C=0;C<E;C++){var D=P[C];if((C<g||D!=P[C-1]&&D!=P[C-g])&&x[D]==null&&(x[D]=k.length,k.push(D),k.length>=300))break}var F=h?S:!1,X=k.length;X<=256&&A==!1&&(X<=2?z=1:X<=4?z=2:X<=16?z=4:z=8,S&&(z=8),h=!0);for(var B=[],v=0;v<f.length;v++){var L=new Uint8Array(f[v]),H=new Uint32Array(L.buffer),U=0,Y=0,W=g,q=_,G=0;if(v!=0&&!F){for(var $=S||v==1||B[B.length-2].dispose==2?1:2,Z=0,xe=1e9,ce=0;ce<$;ce++){for(var mt=new Uint8Array(f[v-1-ce]),Ne=new Uint32Array(f[v-1-ce]),Pe=g,De=_,Me=-1,Be=-1,ft=0;ft<_;ft++)for(var Ot=0;Ot<g;Ot++){var C=ft*g+Ot;H[C]!=Ne[C]&&(Ot<Pe&&(Pe=Ot),Ot>Me&&(Me=Ot),ft<De&&(De=ft),ft>Be&&(Be=ft))}var Gt=Me==-1?1:(Me-Pe+1)*(Be-De+1);Gt<xe&&(xe=Gt,Z=ce,Me==-1?(U=Y=0,W=q=1):(U=Pe,Y=De,W=Me-Pe+1,q=Be-De+1))}var mt=new Uint8Array(f[v-1-Z]);Z==1&&(B[B.length-1].dispose=2);var je=new Uint8Array(W*q*4);new Uint32Array(je.buffer),u._copyTile(mt,g,_,je,W,q,-U,-Y,0),u._copyTile(L,g,_,je,W,q,-U,-Y,3)?(u._copyTile(L,g,_,je,W,q,-U,-Y,2),G=1):(u._copyTile(L,g,_,je,W,q,-U,-Y,0),G=0),L=je,H=new Uint32Array(L.buffer)}var ht=4*W;if(X<=256&&A==!1){ht=Math.ceil(z*W/8);for(var je=new Uint8Array(ht*q),ft=0;ft<q;ft++){var C=ft*ht,Kt=ft*W;if(z==8)for(var Ot=0;Ot<W;Ot++)je[C+Ot]=x[H[Kt+Ot]];else if(z==4)for(var Ot=0;Ot<W;Ot++)je[C+(Ot>>1)]|=x[H[Kt+Ot]]<<4-(Ot&1)*4;else if(z==2)for(var Ot=0;Ot<W;Ot++)je[C+(Ot>>2)]|=x[H[Kt+Ot]]<<6-(Ot&3)*2;else if(z==1)for(var Ot=0;Ot<W;Ot++)je[C+(Ot>>3)]|=x[H[Kt+Ot]]<<7-(Ot&7)*1}L=je,R=3,l=1}else if(h==!1&&f.length==1){for(var je=new Uint8Array(W*q*3),Jt=W*q,C=0;C<Jt;C++){var Wt=C*3,Br=C*4;je[Wt]=L[Br],je[Wt+1]=L[Br+1],je[Wt+2]=L[Br+2]}L=je,R=2,l=3,ht=3*W}B.push({rect:{x:U,y:Y,width:W,height:q},img:L,bpl:ht,bpp:l,blend:G,dispose:F?1:0})}return{ctype:R,depth:z,plte:k,gotAlpha:h,frames:B}},u.encode._filterZero=function(f,g,_,p,S){for(var A=[],R=0;R<5;R++)if(!(g*p>5e5&&(R==2||R==3||R==4))){for(var z=0;z<g;z++)u.encode._filterLine(S,f,z,p,_,R);if(A.push(y.deflate(S)),_==1)break}for(var l,s=1e9,v=0;v<A.length;v++)A[v].length<s&&(l=v,s=A[v].length);return A[l]},u.encode._filterLine=function(f,g,_,p,S,A){var R=_*p,z=R+_,l=u.decode._paeth;if(f[z]=A,z++,A==0)for(var s=0;s<p;s++)f[z+s]=g[R+s];else if(A==1){for(var s=0;s<S;s++)f[z+s]=g[R+s];for(var s=S;s<p;s++)f[z+s]=g[R+s]-g[R+s-S]+256&255}else if(_==0){for(var s=0;s<S;s++)f[z+s]=g[R+s];if(A==2)for(var s=S;s<p;s++)f[z+s]=g[R+s];if(A==3)for(var s=S;s<p;s++)f[z+s]=g[R+s]-(g[R+s-S]>>1)+256&255;if(A==4)for(var s=S;s<p;s++)f[z+s]=g[R+s]-l(g[R+s-S],0,0)+256&255}else{if(A==2)for(var s=0;s<p;s++)f[z+s]=g[R+s]+256-g[R+s-p]&255;if(A==3){for(var s=0;s<S;s++)f[z+s]=g[R+s]+256-(g[R+s-p]>>1)&255;for(var s=S;s<p;s++)f[z+s]=g[R+s]+256-(g[R+s-p]+g[R+s-S]>>1)&255}if(A==4){for(var s=0;s<S;s++)f[z+s]=g[R+s]+256-l(0,g[R+s-p],0)&255;for(var s=S;s<p;s++)f[z+s]=g[R+s]+256-l(g[R+s-S],g[R+s-p],g[R+s-S-p])&255}}},u.crc={table:(function(){for(var f=new Uint32Array(256),g=0;g<256;g++){for(var _=g,p=0;p<8;p++)_&1?_=3988292384^_>>>1:_=_>>>1;f[g]=_}return f})(),update:function(f,g,_,p){for(var S=0;S<p;S++)f=u.crc.table[(f^g[_+S])&255]^f>>>8;return f},crc:function(f,g,_){return u.crc.update(4294967295,f,g,_)^4294967295}},u.quantize=function(f,g,_){for(var p=[],S=0,A=0;A<f.length;A++)p.push(u.encode.alphaMul(new Uint8Array(f[A]),_)),S+=f[A].byteLength;for(var R=new Uint8Array(S),z=new Uint32Array(R.buffer),l=0,A=0;A<p.length;A++){for(var s=p[A],v=s.length,w=0;w<v;w++)R[l+w]=s[w];l+=v}var E={i0:0,i1:R.length,bst:null,est:null,tdst:0,left:null,right:null};E.bst=u.quantize.stats(R,E.i0,E.i1),E.est=u.quantize.estats(E.bst);for(var C=[E];C.length<g;){for(var h=0,x=0,A=0;A<C.length;A++)C[A].est.L>h&&(h=C[A].est.L,x=A);if(h<.001)break;var k=C[x],M=u.quantize.splitPixels(R,z,k.i0,k.i1,k.est.e,k.est.eMq255),D={i0:k.i0,i1:M,bst:null,est:null,tdst:0,left:null,right:null};D.bst=u.quantize.stats(R,D.i0,D.i1),D.est=u.quantize.estats(D.bst);var P={i0:M,i1:k.i1,bst:null,est:null,tdst:0,left:null,right:null};P.bst={R:[],m:[],N:k.bst.N-D.bst.N};for(var A=0;A<16;A++)P.bst.R[A]=k.bst.R[A]-D.bst.R[A];for(var A=0;A<4;A++)P.bst.m[A]=k.bst.m[A]-D.bst.m[A];P.est=u.quantize.estats(P.bst),k.left=D,k.right=P,C[x]=D,C.push(P)}C.sort(function($,Z){return Z.bst.N-$.bst.N});for(var F=0;F<p.length;F++){for(var X=u.quantize.planeDst,B=new Uint8Array(p[F].buffer),L=new Uint32Array(p[F].buffer),H=B.length,A=0;A<H;A+=4){for(var U=B[A]*.00392156862745098,Y=B[A+1]*.00392156862745098,W=B[A+2]*.00392156862745098,q=B[A+3]*.00392156862745098,G=E;G.left;)G=X(G.est,U,Y,W,q)<=0?G.left:G.right;L[A>>2]=G.est.rgba}p[F]=L.buffer}return{bufs:p,plte:C}},u.quantize.getNearest=function(f,g,_,p,S){if(f.left==null)return f.tdst=u.quantize.dist(f.est.q,g,_,p,S),f;var A=u.quantize.planeDst(f.est,g,_,p,S),R=f.left,z=f.right;A>0&&(R=f.right,z=f.left);var l=u.quantize.getNearest(R,g,_,p,S);if(l.tdst<=A*A)return l;var s=u.quantize.getNearest(z,g,_,p,S);return s.tdst<l.tdst?s:l},u.quantize.planeDst=function(f,g,_,p,S){var A=f.e;return A[0]*g+A[1]*_+A[2]*p+A[3]*S-f.eMq},u.quantize.dist=function(f,g,_,p,S){var A=g-f[0],R=_-f[1],z=p-f[2],l=S-f[3];return A*A+R*R+z*z+l*l},u.quantize.splitPixels=function(f,g,_,p,S,A){var R=u.quantize.vecDot;for(p-=4;_<p;){for(;R(f,_,S)<=A;)_+=4;for(;R(f,p,S)>A;)p-=4;if(_>=p)break;var z=g[_>>2];g[_>>2]=g[p>>2],g[p>>2]=z,_+=4,p-=4}for(;R(f,_,S)>A;)_-=4;return _+4},u.quantize.vecDot=function(f,g,_){return f[g]*_[0]+f[g+1]*_[1]+f[g+2]*_[2]+f[g+3]*_[3]},u.quantize.stats=function(f,g,_){for(var p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],S=[0,0,0,0],A=_-g>>2,R=g;R<_;R+=4){var z=f[R]*.00392156862745098,l=f[R+1]*(1/255),s=f[R+2]*(1/255),v=f[R+3]*(1/255);S[0]+=z,S[1]+=l,S[2]+=s,S[3]+=v,p[0]+=z*z,p[1]+=z*l,p[2]+=z*s,p[3]+=z*v,p[5]+=l*l,p[6]+=l*s,p[7]+=l*v,p[10]+=s*s,p[11]+=s*v,p[15]+=v*v}return p[4]=p[1],p[8]=p[2],p[12]=p[3],p[9]=p[6],p[13]=p[7],p[14]=p[11],{R:p,m:S,N:A}},u.quantize.estats=function(f){var g=f.R,_=f.m,p=f.N,S=_[0],A=_[1],R=_[2],z=_[3],l=p==0?0:1/p,s=[g[0]-S*S*l,g[1]-S*A*l,g[2]-S*R*l,g[3]-S*z*l,g[4]-A*S*l,g[5]-A*A*l,g[6]-A*R*l,g[7]-A*z*l,g[8]-R*S*l,g[9]-R*A*l,g[10]-R*R*l,g[11]-R*z*l,g[12]-z*S*l,g[13]-z*A*l,g[14]-z*R*l,g[15]-z*z*l],v=s,w=u.M4,E=[.5,.5,.5,.5],C=0,h=0;if(p!=0)for(var x=0;x<10&&(E=w.multVec(v,E),h=Math.sqrt(w.dot(E,E)),E=w.sml(1/h,E),!(Math.abs(h-C)<1e-9));x++)C=h;var k=[S*l,A*l,R*l,z*l],M=w.dot(w.sml(255,k),E),D=k[3]<.001?0:1/k[3];return{Cov:s,q:k,e:E,L:C,eMq255:M,eMq:w.dot(E,k),rgba:(Math.round(255*k[3])<<24|Math.round(255*k[2]*D)<<16|Math.round(255*k[1]*D)<<8|Math.round(255*k[0]*D)<<0)>>>0}},u.M4={multVec:function(f,g){return[f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3],f[4]*g[0]+f[5]*g[1]+f[6]*g[2]+f[7]*g[3],f[8]*g[0]+f[9]*g[1]+f[10]*g[2]+f[11]*g[3],f[12]*g[0]+f[13]*g[1]+f[14]*g[2]+f[15]*g[3]]},dot:function(f,g){return f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3]},sml:function(f,g){return[f*g[0],f*g[1],f*g[2],f*g[3]]}},u.encode.alphaMul=function(f,g){for(var _=new Uint8Array(f.length),p=f.length>>2,S=0;S<p;S++){var A=S<<2,R=f[A+3];g&&(R=R<128?0:255);var z=R*(1/255);_[A+0]=f[A+0]*z,_[A+1]=f[A+1]*z,_[A+2]=f[A+2]*z,_[A+3]=R}return _}})(o,c)})()}),"./node_modules/upng-js/node_modules/pako/index.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js").assign,c=t("./node_modules/upng-js/node_modules/pako/lib/deflate.js"),u=t("./node_modules/upng-js/node_modules/pako/lib/inflate.js"),y=t("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),f={};o(f,c,u,y),e.exports=f}),"./node_modules/upng-js/node_modules/pako/lib/deflate.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),u=t("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),y=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),f=t("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),g=Object.prototype.toString,_=0,p=4,S=0,A=1,R=2,z=-1,l=0,s=8;function v(h){if(!(this instanceof v))return new v(h);this.options=c.assign({level:z,method:s,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},h||{});var x=this.options;x.raw&&x.windowBits>0?x.windowBits=-x.windowBits:x.gzip&&x.windowBits>0&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var k=o.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(k!==S)throw new Error(y[k]);if(x.header&&o.deflateSetHeader(this.strm,x.header),x.dictionary){var M;if(typeof x.dictionary=="string"?M=u.string2buf(x.dictionary):g.call(x.dictionary)==="[object ArrayBuffer]"?M=new Uint8Array(x.dictionary):M=x.dictionary,k=o.deflateSetDictionary(this.strm,M),k!==S)throw new Error(y[k]);this._dict_set=!0}}v.prototype.push=function(h,x){var k=this.strm,M=this.options.chunkSize,D,P;if(this.ended)return!1;P=x===~~x?x:x===!0?p:_,typeof h=="string"?k.input=u.string2buf(h):g.call(h)==="[object ArrayBuffer]"?k.input=new Uint8Array(h):k.input=h,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new c.Buf8(M),k.next_out=0,k.avail_out=M),D=o.deflate(k,P),D!==A&&D!==S)return this.onEnd(D),this.ended=!0,!1;(k.avail_out===0||k.avail_in===0&&(P===p||P===R))&&(this.options.to==="string"?this.onData(u.buf2binstring(c.shrinkBuf(k.output,k.next_out))):this.onData(c.shrinkBuf(k.output,k.next_out)))}while((k.avail_in>0||k.avail_out===0)&&D!==A);return P===p?(D=o.deflateEnd(this.strm),this.onEnd(D),this.ended=!0,D===S):(P===R&&(this.onEnd(S),k.avail_out=0),!0)},v.prototype.onData=function(h){this.chunks.push(h)},v.prototype.onEnd=function(h){h===S&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg};function w(h,x){var k=new v(x);if(k.push(h,!0),k.err)throw k.msg||y[k.err];return k.result}function E(h,x){return x=x||{},x.raw=!0,w(h,x)}function C(h,x){return x=x||{},x.gzip=!0,w(h,x)}r.Deflate=v,r.deflate=w,r.deflateRaw=E,r.gzip=C}),"./node_modules/upng-js/node_modules/pako/lib/inflate.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),u=t("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),y=t("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),f=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),g=t("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),_=t("./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js"),p=Object.prototype.toString;function S(z){if(!(this instanceof S))return new S(z);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},z||{});var l=this.options;l.raw&&l.windowBits>=0&&l.windowBits<16&&(l.windowBits=-l.windowBits,l.windowBits===0&&(l.windowBits=-15)),l.windowBits>=0&&l.windowBits<16&&!(z&&z.windowBits)&&(l.windowBits+=32),l.windowBits>15&&l.windowBits<48&&(l.windowBits&15||(l.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var s=o.inflateInit2(this.strm,l.windowBits);if(s!==y.Z_OK)throw new Error(f[s]);if(this.header=new _,o.inflateGetHeader(this.strm,this.header),l.dictionary&&(typeof l.dictionary=="string"?l.dictionary=u.string2buf(l.dictionary):p.call(l.dictionary)==="[object ArrayBuffer]"&&(l.dictionary=new Uint8Array(l.dictionary)),l.raw&&(s=o.inflateSetDictionary(this.strm,l.dictionary),s!==y.Z_OK)))throw new Error(f[s])}S.prototype.push=function(z,l){var s=this.strm,v=this.options.chunkSize,w=this.options.dictionary,E,C,h,x,k,M=!1;if(this.ended)return!1;C=l===~~l?l:l===!0?y.Z_FINISH:y.Z_NO_FLUSH,typeof z=="string"?s.input=u.binstring2buf(z):p.call(z)==="[object ArrayBuffer]"?s.input=new Uint8Array(z):s.input=z,s.next_in=0,s.avail_in=s.input.length;do{if(s.avail_out===0&&(s.output=new c.Buf8(v),s.next_out=0,s.avail_out=v),E=o.inflate(s,y.Z_NO_FLUSH),E===y.Z_NEED_DICT&&w&&(E=o.inflateSetDictionary(this.strm,w)),E===y.Z_BUF_ERROR&&M===!0&&(E=y.Z_OK,M=!1),E!==y.Z_STREAM_END&&E!==y.Z_OK)return this.onEnd(E),this.ended=!0,!1;s.next_out&&(s.avail_out===0||E===y.Z_STREAM_END||s.avail_in===0&&(C===y.Z_FINISH||C===y.Z_SYNC_FLUSH))&&(this.options.to==="string"?(h=u.utf8border(s.output,s.next_out),x=s.next_out-h,k=u.buf2string(s.output,h),s.next_out=x,s.avail_out=v-x,x&&c.arraySet(s.output,s.output,h,x,0),this.onData(k)):this.onData(c.shrinkBuf(s.output,s.next_out))),s.avail_in===0&&s.avail_out===0&&(M=!0)}while((s.avail_in>0||s.avail_out===0)&&E!==y.Z_STREAM_END);return E===y.Z_STREAM_END&&(C=y.Z_FINISH),C===y.Z_FINISH?(E=o.inflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===y.Z_OK):(C===y.Z_SYNC_FLUSH&&(this.onEnd(y.Z_OK),s.avail_out=0),!0)},S.prototype.onData=function(z){this.chunks.push(z)},S.prototype.onEnd=function(z){z===y.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=z,this.msg=this.strm.msg};function A(z,l){var s=new S(l);if(s.push(z,!0),s.err)throw s.msg||f[s.err];return s.result}function R(z,l){return l=l||{},l.raw=!0,A(z,l)}r.Inflate=S,r.inflate=A,r.inflateRaw=R,r.ungzip=A}),"./node_modules/upng-js/node_modules/pako/lib/utils/common.js":((e,r)=>{var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function o(y,f){return Object.prototype.hasOwnProperty.call(y,f)}r.assign=function(y){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var g=f.shift();if(g){if(typeof g!="object")throw new TypeError(g+"must be non-object");for(var _ in g)o(g,_)&&(y[_]=g[_])}}return y},r.shrinkBuf=function(y,f){return y.length===f?y:y.subarray?y.subarray(0,f):(y.length=f,y)};var c={arraySet:function(y,f,g,_,p){if(f.subarray&&y.subarray){y.set(f.subarray(g,g+_),p);return}for(var S=0;S<_;S++)y[p+S]=f[g+S]},flattenChunks:function(y){var f,g,_,p,S,A;for(_=0,f=0,g=y.length;f<g;f++)_+=y[f].length;for(A=new Uint8Array(_),p=0,f=0,g=y.length;f<g;f++)S=y[f],A.set(S,p),p+=S.length;return A}},u={arraySet:function(y,f,g,_,p){for(var S=0;S<_;S++)y[p+S]=f[g+S]},flattenChunks:function(y){return[].concat.apply([],y)}};r.setTyped=function(y){y?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,c)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,u))},r.setTyped(t)}),"./node_modules/upng-js/node_modules/pako/lib/utils/strings.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{c=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var y=new o.Buf8(256),f=0;f<256;f++)y[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;y[254]=y[254]=1,r.string2buf=function(_){var p,S,A,R,z,l=_.length,s=0;for(R=0;R<l;R++)S=_.charCodeAt(R),(S&64512)===55296&&R+1<l&&(A=_.charCodeAt(R+1),(A&64512)===56320&&(S=65536+(S-55296<<10)+(A-56320),R++)),s+=S<128?1:S<2048?2:S<65536?3:4;for(p=new o.Buf8(s),z=0,R=0;z<s;R++)S=_.charCodeAt(R),(S&64512)===55296&&R+1<l&&(A=_.charCodeAt(R+1),(A&64512)===56320&&(S=65536+(S-55296<<10)+(A-56320),R++)),S<128?p[z++]=S:S<2048?(p[z++]=192|S>>>6,p[z++]=128|S&63):S<65536?(p[z++]=224|S>>>12,p[z++]=128|S>>>6&63,p[z++]=128|S&63):(p[z++]=240|S>>>18,p[z++]=128|S>>>12&63,p[z++]=128|S>>>6&63,p[z++]=128|S&63);return p};function g(_,p){if(p<65534&&(_.subarray&&u||!_.subarray&&c))return String.fromCharCode.apply(null,o.shrinkBuf(_,p));for(var S="",A=0;A<p;A++)S+=String.fromCharCode(_[A]);return S}r.buf2binstring=function(_){return g(_,_.length)},r.binstring2buf=function(_){for(var p=new o.Buf8(_.length),S=0,A=p.length;S<A;S++)p[S]=_.charCodeAt(S);return p},r.buf2string=function(_,p){var S,A,R,z,l=p||_.length,s=new Array(l*2);for(A=0,S=0;S<l;){if(R=_[S++],R<128){s[A++]=R;continue}if(z=y[R],z>4){s[A++]=65533,S+=z-1;continue}for(R&=z===2?31:z===3?15:7;z>1&&S<l;)R=R<<6|_[S++]&63,z--;if(z>1){s[A++]=65533;continue}R<65536?s[A++]=R:(R-=65536,s[A++]=55296|R>>10&1023,s[A++]=56320|R&1023)}return g(s,A)},r.utf8border=function(_,p){var S;for(p=p||_.length,p>_.length&&(p=_.length),S=p-1;S>=0&&(_[S]&192)===128;)S--;return S<0||S===0?p:S+y[_[S]]>p?S:p}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js":(e=>{function r(t,o,c,u){for(var y=t&65535|0,f=t>>>16&65535|0,g=0;c!==0;){g=c>2e3?2e3:c,c-=g;do y=y+o[u++]|0,f=f+y|0;while(--g);y%=65521,f%=65521}return y|f<<16|0}e.exports=r}),"./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js":(e=>{e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js":(e=>{function r(){for(var c,u=[],y=0;y<256;y++){c=y;for(var f=0;f<8;f++)c=c&1?3988292384^c>>>1:c>>>1;u[y]=c}return u}var t=r();function o(c,u,y,f){var g=t,_=f+y;c^=-1;for(var p=f;p<_;p++)c=c>>>8^g[(c^u[p])&255];return c^-1}e.exports=o}),"./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js"),u=t("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),y=t("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),f=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),g=0,_=1,p=3,S=4,A=5,R=0,z=1,l=-2,s=-3,v=-5,w=-1,E=1,C=2,h=3,x=4,k=0,M=2,D=8,P=9,F=15,X=8,B=29,L=256,H=L+1+B,U=30,Y=19,W=2*H+1,q=15,G=3,$=258,Z=$+G+1,xe=32,ce=42,Ne=69,Pe=73,De=91,Me=103,Be=113,ft=666,Ot=1,Gt=2,mt=3,je=4,ht=3;function Kt(J,ut){return J.msg=f[ut],ut}function Jt(J){return(J<<1)-(J>4?9:0)}function Wt(J){for(var ut=J.length;--ut>=0;)J[ut]=0}function Br(J){var ut=J.state,at=ut.pending;at>J.avail_out&&(at=J.avail_out),at!==0&&(o.arraySet(J.output,ut.pending_buf,ut.pending_out,at,J.next_out),J.next_out+=at,ut.pending_out+=at,J.total_out+=at,J.avail_out-=at,ut.pending-=at,ut.pending===0&&(ut.pending_out=0))}function zr(J,ut){c._tr_flush_block(J,J.block_start>=0?J.block_start:-1,J.strstart-J.block_start,ut),J.block_start=J.strstart,Br(J.strm)}function cr(J,ut){J.pending_buf[J.pending++]=ut}function Nr(J,ut){J.pending_buf[J.pending++]=ut>>>8&255,J.pending_buf[J.pending++]=ut&255}function At(J,ut,at,me){var Ze=J.avail_in;return Ze>me&&(Ze=me),Ze===0?0:(J.avail_in-=Ze,o.arraySet(ut,J.input,J.next_in,Ze,at),J.state.wrap===1?J.adler=u(J.adler,ut,Ze,at):J.state.wrap===2&&(J.adler=y(J.adler,ut,Ze,at)),J.next_in+=Ze,J.total_in+=Ze,Ze)}function Mt(J,ut){var at=J.max_chain_length,me=J.strstart,Ze,vt,Qr=J.prev_length,Xr=J.nice_match,Zr=J.strstart>J.w_size-Z?J.strstart-(J.w_size-Z):0,xn=J.window,Ei=J.w_mask,zn=J.prev,Pn=J.strstart+$,Fn=xn[me+Qr-1],mi=xn[me+Qr];J.prev_length>=J.good_match&&(at>>=2),Xr>J.lookahead&&(Xr=J.lookahead);do if(Ze=ut,!(xn[Ze+Qr]!==mi||xn[Ze+Qr-1]!==Fn||xn[Ze]!==xn[me]||xn[++Ze]!==xn[me+1])){me+=2,Ze++;do;while(xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&me<Pn);if(vt=$-(Pn-me),me=Pn-$,vt>Qr){if(J.match_start=ut,Qr=vt,vt>=Xr)break;Fn=xn[me+Qr-1],mi=xn[me+Qr]}}while((ut=zn[ut&Ei])>Zr&&--at!==0);return Qr<=J.lookahead?Qr:J.lookahead}function Jr(J){var ut=J.w_size,at,me,Ze,vt,Qr;do{if(vt=J.window_size-J.lookahead-J.strstart,J.strstart>=ut+(ut-Z)){o.arraySet(J.window,J.window,ut,ut,0),J.match_start-=ut,J.strstart-=ut,J.block_start-=ut,me=J.hash_size,at=me;do Ze=J.head[--at],J.head[at]=Ze>=ut?Ze-ut:0;while(--me);me=ut,at=me;do Ze=J.prev[--at],J.prev[at]=Ze>=ut?Ze-ut:0;while(--me);vt+=ut}if(J.strm.avail_in===0)break;if(me=At(J.strm,J.window,J.strstart+J.lookahead,vt),J.lookahead+=me,J.lookahead+J.insert>=G)for(Qr=J.strstart-J.insert,J.ins_h=J.window[Qr],J.ins_h=(J.ins_h<<J.hash_shift^J.window[Qr+1])&J.hash_mask;J.insert&&(J.ins_h=(J.ins_h<<J.hash_shift^J.window[Qr+G-1])&J.hash_mask,J.prev[Qr&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=Qr,Qr++,J.insert--,!(J.lookahead+J.insert<G)););}while(J.lookahead<Z&&J.strm.avail_in!==0)}function Yr(J,ut){var at=65535;for(at>J.pending_buf_size-5&&(at=J.pending_buf_size-5);;){if(J.lookahead<=1){if(Jr(J),J.lookahead===0&&ut===g)return Ot;if(J.lookahead===0)break}J.strstart+=J.lookahead,J.lookahead=0;var me=J.block_start+at;if((J.strstart===0||J.strstart>=me)&&(J.lookahead=J.strstart-me,J.strstart=me,zr(J,!1),J.strm.avail_out===0)||J.strstart-J.block_start>=J.w_size-Z&&(zr(J,!1),J.strm.avail_out===0))return Ot}return J.insert=0,ut===S?(zr(J,!0),J.strm.avail_out===0?mt:je):(J.strstart>J.block_start&&(zr(J,!1),J.strm.avail_out),Ot)}function ie(J,ut){for(var at,me;;){if(J.lookahead<Z){if(Jr(J),J.lookahead<Z&&ut===g)return Ot;if(J.lookahead===0)break}if(at=0,J.lookahead>=G&&(J.ins_h=(J.ins_h<<J.hash_shift^J.window[J.strstart+G-1])&J.hash_mask,at=J.prev[J.strstart&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=J.strstart),at!==0&&J.strstart-at<=J.w_size-Z&&(J.match_length=Mt(J,at)),J.match_length>=G)if(me=c._tr_tally(J,J.strstart-J.match_start,J.match_length-G),J.lookahead-=J.match_length,J.match_length<=J.max_lazy_match&&J.lookahead>=G){J.match_length--;do J.strstart++,J.ins_h=(J.ins_h<<J.hash_shift^J.window[J.strstart+G-1])&J.hash_mask,at=J.prev[J.strstart&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=J.strstart;while(--J.match_length!==0);J.strstart++}else J.strstart+=J.match_length,J.match_length=0,J.ins_h=J.window[J.strstart],J.ins_h=(J.ins_h<<J.hash_shift^J.window[J.strstart+1])&J.hash_mask;else me=c._tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++;if(me&&(zr(J,!1),J.strm.avail_out===0))return Ot}return J.insert=J.strstart<G-1?J.strstart:G-1,ut===S?(zr(J,!0),J.strm.avail_out===0?mt:je):J.last_lit&&(zr(J,!1),J.strm.avail_out===0)?Ot:Gt}function ve(J,ut){for(var at,me,Ze;;){if(J.lookahead<Z){if(Jr(J),J.lookahead<Z&&ut===g)return Ot;if(J.lookahead===0)break}if(at=0,J.lookahead>=G&&(J.ins_h=(J.ins_h<<J.hash_shift^J.window[J.strstart+G-1])&J.hash_mask,at=J.prev[J.strstart&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=J.strstart),J.prev_length=J.match_length,J.prev_match=J.match_start,J.match_length=G-1,at!==0&&J.prev_length<J.max_lazy_match&&J.strstart-at<=J.w_size-Z&&(J.match_length=Mt(J,at),J.match_length<=5&&(J.strategy===E||J.match_length===G&&J.strstart-J.match_start>4096)&&(J.match_length=G-1)),J.prev_length>=G&&J.match_length<=J.prev_length){Ze=J.strstart+J.lookahead-G,me=c._tr_tally(J,J.strstart-1-J.prev_match,J.prev_length-G),J.lookahead-=J.prev_length-1,J.prev_length-=2;do++J.strstart<=Ze&&(J.ins_h=(J.ins_h<<J.hash_shift^J.window[J.strstart+G-1])&J.hash_mask,at=J.prev[J.strstart&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=J.strstart);while(--J.prev_length!==0);if(J.match_available=0,J.match_length=G-1,J.strstart++,me&&(zr(J,!1),J.strm.avail_out===0))return Ot}else if(J.match_available){if(me=c._tr_tally(J,0,J.window[J.strstart-1]),me&&zr(J,!1),J.strstart++,J.lookahead--,J.strm.avail_out===0)return Ot}else J.match_available=1,J.strstart++,J.lookahead--}return J.match_available&&(me=c._tr_tally(J,0,J.window[J.strstart-1]),J.match_available=0),J.insert=J.strstart<G-1?J.strstart:G-1,ut===S?(zr(J,!0),J.strm.avail_out===0?mt:je):J.last_lit&&(zr(J,!1),J.strm.avail_out===0)?Ot:Gt}function we(J,ut){for(var at,me,Ze,vt,Qr=J.window;;){if(J.lookahead<=$){if(Jr(J),J.lookahead<=$&&ut===g)return Ot;if(J.lookahead===0)break}if(J.match_length=0,J.lookahead>=G&&J.strstart>0&&(Ze=J.strstart-1,me=Qr[Ze],me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze])){vt=J.strstart+$;do;while(me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&Ze<vt);J.match_length=$-(vt-Ze),J.match_length>J.lookahead&&(J.match_length=J.lookahead)}if(J.match_length>=G?(at=c._tr_tally(J,1,J.match_length-G),J.lookahead-=J.match_length,J.strstart+=J.match_length,J.match_length=0):(at=c._tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++),at&&(zr(J,!1),J.strm.avail_out===0))return Ot}return J.insert=0,ut===S?(zr(J,!0),J.strm.avail_out===0?mt:je):J.last_lit&&(zr(J,!1),J.strm.avail_out===0)?Ot:Gt}function it(J,ut){for(var at;;){if(J.lookahead===0&&(Jr(J),J.lookahead===0)){if(ut===g)return Ot;break}if(J.match_length=0,at=c._tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++,at&&(zr(J,!1),J.strm.avail_out===0))return Ot}return J.insert=0,ut===S?(zr(J,!0),J.strm.avail_out===0?mt:je):J.last_lit&&(zr(J,!1),J.strm.avail_out===0)?Ot:Gt}function rt(J,ut,at,me,Ze){this.good_length=J,this.max_lazy=ut,this.nice_length=at,this.max_chain=me,this.func=Ze}var Yt;Yt=[new rt(0,0,0,0,Yr),new rt(4,4,8,4,ie),new rt(4,5,16,8,ie),new rt(4,6,32,32,ie),new rt(4,4,16,16,ve),new rt(8,16,32,32,ve),new rt(8,16,128,128,ve),new rt(8,32,128,256,ve),new rt(32,128,258,1024,ve),new rt(32,258,258,4096,ve)];function jt(J){J.window_size=2*J.w_size,Wt(J.head),J.max_lazy_match=Yt[J.level].max_lazy,J.good_match=Yt[J.level].good_length,J.nice_match=Yt[J.level].nice_length,J.max_chain_length=Yt[J.level].max_chain,J.strstart=0,J.block_start=0,J.lookahead=0,J.insert=0,J.match_length=J.prev_length=G-1,J.match_available=0,J.ins_h=0}function re(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=D,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(W*2),this.dyn_dtree=new o.Buf16((2*U+1)*2),this.bl_tree=new o.Buf16((2*Y+1)*2),Wt(this.dyn_ltree),Wt(this.dyn_dtree),Wt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(q+1),this.heap=new o.Buf16(2*H+1),Wt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*H+1),Wt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function tt(J){var ut;return!J||!J.state?Kt(J,l):(J.total_in=J.total_out=0,J.data_type=M,ut=J.state,ut.pending=0,ut.pending_out=0,ut.wrap<0&&(ut.wrap=-ut.wrap),ut.status=ut.wrap?ce:Be,J.adler=ut.wrap===2?0:1,ut.last_flush=g,c._tr_init(ut),R)}function lt(J){var ut=tt(J);return ut===R&&jt(J.state),ut}function ar(J,ut){return!J||!J.state||J.state.wrap!==2?l:(J.state.gzhead=ut,R)}function et(J,ut,at,me,Ze,vt){if(!J)return l;var Qr=1;if(ut===w&&(ut=6),me<0?(Qr=0,me=-me):me>15&&(Qr=2,me-=16),Ze<1||Ze>P||at!==D||me<8||me>15||ut<0||ut>9||vt<0||vt>x)return Kt(J,l);me===8&&(me=9);var Xr=new re;return J.state=Xr,Xr.strm=J,Xr.wrap=Qr,Xr.gzhead=null,Xr.w_bits=me,Xr.w_size=1<<Xr.w_bits,Xr.w_mask=Xr.w_size-1,Xr.hash_bits=Ze+7,Xr.hash_size=1<<Xr.hash_bits,Xr.hash_mask=Xr.hash_size-1,Xr.hash_shift=~~((Xr.hash_bits+G-1)/G),Xr.window=new o.Buf8(Xr.w_size*2),Xr.head=new o.Buf16(Xr.hash_size),Xr.prev=new o.Buf16(Xr.w_size),Xr.lit_bufsize=1<<Ze+6,Xr.pending_buf_size=Xr.lit_bufsize*4,Xr.pending_buf=new o.Buf8(Xr.pending_buf_size),Xr.d_buf=1*Xr.lit_bufsize,Xr.l_buf=3*Xr.lit_bufsize,Xr.level=ut,Xr.strategy=vt,Xr.method=at,lt(J)}function Ft(J,ut){return et(J,ut,D,F,X,k)}function se(J,ut){var at,me,Ze,vt;if(!J||!J.state||ut>A||ut<0)return J?Kt(J,l):l;if(me=J.state,!J.output||!J.input&&J.avail_in!==0||me.status===ft&&ut!==S)return Kt(J,J.avail_out===0?v:l);if(me.strm=J,at=me.last_flush,me.last_flush=ut,me.status===ce)if(me.wrap===2)J.adler=0,cr(me,31),cr(me,139),cr(me,8),me.gzhead?(cr(me,(me.gzhead.text?1:0)+(me.gzhead.hcrc?2:0)+(me.gzhead.extra?4:0)+(me.gzhead.name?8:0)+(me.gzhead.comment?16:0)),cr(me,me.gzhead.time&255),cr(me,me.gzhead.time>>8&255),cr(me,me.gzhead.time>>16&255),cr(me,me.gzhead.time>>24&255),cr(me,me.level===9?2:me.strategy>=C||me.level<2?4:0),cr(me,me.gzhead.os&255),me.gzhead.extra&&me.gzhead.extra.length&&(cr(me,me.gzhead.extra.length&255),cr(me,me.gzhead.extra.length>>8&255)),me.gzhead.hcrc&&(J.adler=y(J.adler,me.pending_buf,me.pending,0)),me.gzindex=0,me.status=Ne):(cr(me,0),cr(me,0),cr(me,0),cr(me,0),cr(me,0),cr(me,me.level===9?2:me.strategy>=C||me.level<2?4:0),cr(me,ht),me.status=Be);else{var Qr=D+(me.w_bits-8<<4)<<8,Xr=-1;me.strategy>=C||me.level<2?Xr=0:me.level<6?Xr=1:me.level===6?Xr=2:Xr=3,Qr|=Xr<<6,me.strstart!==0&&(Qr|=xe),Qr+=31-Qr%31,me.status=Be,Nr(me,Qr),me.strstart!==0&&(Nr(me,J.adler>>>16),Nr(me,J.adler&65535)),J.adler=1}if(me.status===Ne)if(me.gzhead.extra){for(Ze=me.pending;me.gzindex<(me.gzhead.extra.length&65535)&&!(me.pending===me.pending_buf_size&&(me.gzhead.hcrc&&me.pending>Ze&&(J.adler=y(J.adler,me.pending_buf,me.pending-Ze,Ze)),Br(J),Ze=me.pending,me.pending===me.pending_buf_size));)cr(me,me.gzhead.extra[me.gzindex]&255),me.gzindex++;me.gzhead.hcrc&&me.pending>Ze&&(J.adler=y(J.adler,me.pending_buf,me.pending-Ze,Ze)),me.gzindex===me.gzhead.extra.length&&(me.gzindex=0,me.status=Pe)}else me.status=Pe;if(me.status===Pe)if(me.gzhead.name){Ze=me.pending;do{if(me.pending===me.pending_buf_size&&(me.gzhead.hcrc&&me.pending>Ze&&(J.adler=y(J.adler,me.pending_buf,me.pending-Ze,Ze)),Br(J),Ze=me.pending,me.pending===me.pending_buf_size)){vt=1;break}me.gzindex<me.gzhead.name.length?vt=me.gzhead.name.charCodeAt(me.gzindex++)&255:vt=0,cr(me,vt)}while(vt!==0);me.gzhead.hcrc&&me.pending>Ze&&(J.adler=y(J.adler,me.pending_buf,me.pending-Ze,Ze)),vt===0&&(me.gzindex=0,me.status=De)}else me.status=De;if(me.status===De)if(me.gzhead.comment){Ze=me.pending;do{if(me.pending===me.pending_buf_size&&(me.gzhead.hcrc&&me.pending>Ze&&(J.adler=y(J.adler,me.pending_buf,me.pending-Ze,Ze)),Br(J),Ze=me.pending,me.pending===me.pending_buf_size)){vt=1;break}me.gzindex<me.gzhead.comment.length?vt=me.gzhead.comment.charCodeAt(me.gzindex++)&255:vt=0,cr(me,vt)}while(vt!==0);me.gzhead.hcrc&&me.pending>Ze&&(J.adler=y(J.adler,me.pending_buf,me.pending-Ze,Ze)),vt===0&&(me.status=Me)}else me.status=Me;if(me.status===Me&&(me.gzhead.hcrc?(me.pending+2>me.pending_buf_size&&Br(J),me.pending+2<=me.pending_buf_size&&(cr(me,J.adler&255),cr(me,J.adler>>8&255),J.adler=0,me.status=Be)):me.status=Be),me.pending!==0){if(Br(J),J.avail_out===0)return me.last_flush=-1,R}else if(J.avail_in===0&&Jt(ut)<=Jt(at)&&ut!==S)return Kt(J,v);if(me.status===ft&&J.avail_in!==0)return Kt(J,v);if(J.avail_in!==0||me.lookahead!==0||ut!==g&&me.status!==ft){var Zr=me.strategy===C?it(me,ut):me.strategy===h?we(me,ut):Yt[me.level].func(me,ut);if((Zr===mt||Zr===je)&&(me.status=ft),Zr===Ot||Zr===mt)return J.avail_out===0&&(me.last_flush=-1),R;if(Zr===Gt&&(ut===_?c._tr_align(me):ut!==A&&(c._tr_stored_block(me,0,0,!1),ut===p&&(Wt(me.head),me.lookahead===0&&(me.strstart=0,me.block_start=0,me.insert=0))),Br(J),J.avail_out===0))return me.last_flush=-1,R}return ut!==S?R:me.wrap<=0?z:(me.wrap===2?(cr(me,J.adler&255),cr(me,J.adler>>8&255),cr(me,J.adler>>16&255),cr(me,J.adler>>24&255),cr(me,J.total_in&255),cr(me,J.total_in>>8&255),cr(me,J.total_in>>16&255),cr(me,J.total_in>>24&255)):(Nr(me,J.adler>>>16),Nr(me,J.adler&65535)),Br(J),me.wrap>0&&(me.wrap=-me.wrap),me.pending!==0?R:z)}function xt(J){var ut;return!J||!J.state?l:(ut=J.state.status,ut!==ce&&ut!==Ne&&ut!==Pe&&ut!==De&&ut!==Me&&ut!==Be&&ut!==ft?Kt(J,l):(J.state=null,ut===Be?Kt(J,s):R))}function Vr(J,ut){var at=ut.length,me,Ze,vt,Qr,Xr,Zr,xn,Ei;if(!J||!J.state||(me=J.state,Qr=me.wrap,Qr===2||Qr===1&&me.status!==ce||me.lookahead))return l;for(Qr===1&&(J.adler=u(J.adler,ut,at,0)),me.wrap=0,at>=me.w_size&&(Qr===0&&(Wt(me.head),me.strstart=0,me.block_start=0,me.insert=0),Ei=new o.Buf8(me.w_size),o.arraySet(Ei,ut,at-me.w_size,me.w_size,0),ut=Ei,at=me.w_size),Xr=J.avail_in,Zr=J.next_in,xn=J.input,J.avail_in=at,J.next_in=0,J.input=ut,Jr(me);me.lookahead>=G;){Ze=me.strstart,vt=me.lookahead-(G-1);do me.ins_h=(me.ins_h<<me.hash_shift^me.window[Ze+G-1])&me.hash_mask,me.prev[Ze&me.w_mask]=me.head[me.ins_h],me.head[me.ins_h]=Ze,Ze++;while(--vt);me.strstart=Ze,me.lookahead=G-1,Jr(me)}return me.strstart+=me.lookahead,me.block_start=me.strstart,me.insert=me.lookahead,me.lookahead=0,me.match_length=me.prev_length=G-1,me.match_available=0,J.next_in=Zr,J.input=xn,J.avail_in=Xr,me.wrap=Qr,R}r.deflateInit=Ft,r.deflateInit2=et,r.deflateReset=lt,r.deflateResetKeep=tt,r.deflateSetHeader=ar,r.deflate=se,r.deflateEnd=xt,r.deflateSetDictionary=Vr,r.deflateInfo="pako deflate (from Nodeca project)"}),"./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js":(e=>{function r(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=r}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js":(e=>{var r=30,t=12;e.exports=function(o,c){var u,y,f,g,_,p,S,A,R,z,l,s,v,w,E,C,h,x,k,M,D,P,F,X,B;u=o.state,y=o.next_in,X=o.input,f=y+(o.avail_in-5),g=o.next_out,B=o.output,_=g-(c-o.avail_out),p=g+(o.avail_out-257),S=u.dmax,A=u.wsize,R=u.whave,z=u.wnext,l=u.window,s=u.hold,v=u.bits,w=u.lencode,E=u.distcode,C=(1<<u.lenbits)-1,h=(1<<u.distbits)-1;e:do{v<15&&(s+=X[y++]<<v,v+=8,s+=X[y++]<<v,v+=8),x=w[s&C];t:for(;;){if(k=x>>>24,s>>>=k,v-=k,k=x>>>16&255,k===0)B[g++]=x&65535;else if(k&16){M=x&65535,k&=15,k&&(v<k&&(s+=X[y++]<<v,v+=8),M+=s&(1<<k)-1,s>>>=k,v-=k),v<15&&(s+=X[y++]<<v,v+=8,s+=X[y++]<<v,v+=8),x=E[s&h];r:for(;;){if(k=x>>>24,s>>>=k,v-=k,k=x>>>16&255,k&16){if(D=x&65535,k&=15,v<k&&(s+=X[y++]<<v,v+=8,v<k&&(s+=X[y++]<<v,v+=8)),D+=s&(1<<k)-1,D>S){o.msg="invalid distance too far back",u.mode=r;break e}if(s>>>=k,v-=k,k=g-_,D>k){if(k=D-k,k>R&&u.sane){o.msg="invalid distance too far back",u.mode=r;break e}if(P=0,F=l,z===0){if(P+=A-k,k<M){M-=k;do B[g++]=l[P++];while(--k);P=g-D,F=B}}else if(z<k){if(P+=A+z-k,k-=z,k<M){M-=k;do B[g++]=l[P++];while(--k);if(P=0,z<M){k=z,M-=k;do B[g++]=l[P++];while(--k);P=g-D,F=B}}}else if(P+=z-k,k<M){M-=k;do B[g++]=l[P++];while(--k);P=g-D,F=B}for(;M>2;)B[g++]=F[P++],B[g++]=F[P++],B[g++]=F[P++],M-=3;M&&(B[g++]=F[P++],M>1&&(B[g++]=F[P++]))}else{P=g-D;do B[g++]=B[P++],B[g++]=B[P++],B[g++]=B[P++],M-=3;while(M>2);M&&(B[g++]=B[P++],M>1&&(B[g++]=B[P++]))}}else if(k&64){o.msg="invalid distance code",u.mode=r;break e}else{x=E[(x&65535)+(s&(1<<k)-1)];continue r}break}}else if(k&64)if(k&32){u.mode=t;break e}else{o.msg="invalid literal/length code",u.mode=r;break e}else{x=w[(x&65535)+(s&(1<<k)-1)];continue t}break}}while(y<f&&g<p);M=v>>3,y-=M,v-=M<<3,s&=(1<<v)-1,o.next_in=y,o.next_out=g,o.avail_in=y<f?5+(f-y):5-(y-f),o.avail_out=g<p?257+(p-g):257-(g-p),u.hold=s,u.bits=v}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),u=t("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),y=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js"),f=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js"),g=0,_=1,p=2,S=4,A=5,R=6,z=0,l=1,s=2,v=-2,w=-3,E=-4,C=-5,h=8,x=1,k=2,M=3,D=4,P=5,F=6,X=7,B=8,L=9,H=10,U=11,Y=12,W=13,q=14,G=15,$=16,Z=17,xe=18,ce=19,Ne=20,Pe=21,De=22,Me=23,Be=24,ft=25,Ot=26,Gt=27,mt=28,je=29,ht=30,Kt=31,Jt=32,Wt=852,Br=592,zr=15,cr=zr;function Nr(et){return(et>>>24&255)+(et>>>8&65280)+((et&65280)<<8)+((et&255)<<24)}function At(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Mt(et){var Ft;return!et||!et.state?v:(Ft=et.state,et.total_in=et.total_out=Ft.total=0,et.msg="",Ft.wrap&&(et.adler=Ft.wrap&1),Ft.mode=x,Ft.last=0,Ft.havedict=0,Ft.dmax=32768,Ft.head=null,Ft.hold=0,Ft.bits=0,Ft.lencode=Ft.lendyn=new o.Buf32(Wt),Ft.distcode=Ft.distdyn=new o.Buf32(Br),Ft.sane=1,Ft.back=-1,z)}function Jr(et){var Ft;return!et||!et.state?v:(Ft=et.state,Ft.wsize=0,Ft.whave=0,Ft.wnext=0,Mt(et))}function Yr(et,Ft){var se,xt;return!et||!et.state||(xt=et.state,Ft<0?(se=0,Ft=-Ft):(se=(Ft>>4)+1,Ft<48&&(Ft&=15)),Ft&&(Ft<8||Ft>15))?v:(xt.window!==null&&xt.wbits!==Ft&&(xt.window=null),xt.wrap=se,xt.wbits=Ft,Jr(et))}function ie(et,Ft){var se,xt;return et?(xt=new At,et.state=xt,xt.window=null,se=Yr(et,Ft),se!==z&&(et.state=null),se):v}function ve(et){return ie(et,cr)}var we=!0,it,rt;function Yt(et){if(we){var Ft;for(it=new o.Buf32(512),rt=new o.Buf32(32),Ft=0;Ft<144;)et.lens[Ft++]=8;for(;Ft<256;)et.lens[Ft++]=9;for(;Ft<280;)et.lens[Ft++]=7;for(;Ft<288;)et.lens[Ft++]=8;for(f(_,et.lens,0,288,it,0,et.work,{bits:9}),Ft=0;Ft<32;)et.lens[Ft++]=5;f(p,et.lens,0,32,rt,0,et.work,{bits:5}),we=!1}et.lencode=it,et.lenbits=9,et.distcode=rt,et.distbits=5}function jt(et,Ft,se,xt){var Vr,J=et.state;return J.window===null&&(J.wsize=1<<J.wbits,J.wnext=0,J.whave=0,J.window=new o.Buf8(J.wsize)),xt>=J.wsize?(o.arraySet(J.window,Ft,se-J.wsize,J.wsize,0),J.wnext=0,J.whave=J.wsize):(Vr=J.wsize-J.wnext,Vr>xt&&(Vr=xt),o.arraySet(J.window,Ft,se-xt,Vr,J.wnext),xt-=Vr,xt?(o.arraySet(J.window,Ft,se-xt,xt,0),J.wnext=xt,J.whave=J.wsize):(J.wnext+=Vr,J.wnext===J.wsize&&(J.wnext=0),J.whave<J.wsize&&(J.whave+=Vr))),0}function re(et,Ft){var se,xt,Vr,J,ut,at,me,Ze,vt,Qr,Xr,Zr,xn,Ei,zn=0,Pn,Fn,mi,xi,Ca,Ra,ei,ai,ci=new o.Buf8(4),Xs,Us,fa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!et||!et.state||!et.output||!et.input&&et.avail_in!==0)return v;se=et.state,se.mode===Y&&(se.mode=W),ut=et.next_out,Vr=et.output,me=et.avail_out,J=et.next_in,xt=et.input,at=et.avail_in,Ze=se.hold,vt=se.bits,Qr=at,Xr=me,ai=z;e:for(;;)switch(se.mode){case x:if(se.wrap===0){se.mode=W;break}for(;vt<16;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(se.wrap&2&&Ze===35615){se.check=0,ci[0]=Ze&255,ci[1]=Ze>>>8&255,se.check=u(se.check,ci,2,0),Ze=0,vt=0,se.mode=k;break}if(se.flags=0,se.head&&(se.head.done=!1),!(se.wrap&1)||(((Ze&255)<<8)+(Ze>>8))%31){et.msg="incorrect header check",se.mode=ht;break}if((Ze&15)!==h){et.msg="unknown compression method",se.mode=ht;break}if(Ze>>>=4,vt-=4,ei=(Ze&15)+8,se.wbits===0)se.wbits=ei;else if(ei>se.wbits){et.msg="invalid window size",se.mode=ht;break}se.dmax=1<<ei,et.adler=se.check=1,se.mode=Ze&512?H:Y,Ze=0,vt=0;break;case k:for(;vt<16;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(se.flags=Ze,(se.flags&255)!==h){et.msg="unknown compression method",se.mode=ht;break}if(se.flags&57344){et.msg="unknown header flags set",se.mode=ht;break}se.head&&(se.head.text=Ze>>8&1),se.flags&512&&(ci[0]=Ze&255,ci[1]=Ze>>>8&255,se.check=u(se.check,ci,2,0)),Ze=0,vt=0,se.mode=M;case M:for(;vt<32;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}se.head&&(se.head.time=Ze),se.flags&512&&(ci[0]=Ze&255,ci[1]=Ze>>>8&255,ci[2]=Ze>>>16&255,ci[3]=Ze>>>24&255,se.check=u(se.check,ci,4,0)),Ze=0,vt=0,se.mode=D;case D:for(;vt<16;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}se.head&&(se.head.xflags=Ze&255,se.head.os=Ze>>8),se.flags&512&&(ci[0]=Ze&255,ci[1]=Ze>>>8&255,se.check=u(se.check,ci,2,0)),Ze=0,vt=0,se.mode=P;case P:if(se.flags&1024){for(;vt<16;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}se.length=Ze,se.head&&(se.head.extra_len=Ze),se.flags&512&&(ci[0]=Ze&255,ci[1]=Ze>>>8&255,se.check=u(se.check,ci,2,0)),Ze=0,vt=0}else se.head&&(se.head.extra=null);se.mode=F;case F:if(se.flags&1024&&(Zr=se.length,Zr>at&&(Zr=at),Zr&&(se.head&&(ei=se.head.extra_len-se.length,se.head.extra||(se.head.extra=new Array(se.head.extra_len)),o.arraySet(se.head.extra,xt,J,Zr,ei)),se.flags&512&&(se.check=u(se.check,xt,Zr,J)),at-=Zr,J+=Zr,se.length-=Zr),se.length))break e;se.length=0,se.mode=X;case X:if(se.flags&2048){if(at===0)break e;Zr=0;do ei=xt[J+Zr++],se.head&&ei&&se.length<65536&&(se.head.name+=String.fromCharCode(ei));while(ei&&Zr<at);if(se.flags&512&&(se.check=u(se.check,xt,Zr,J)),at-=Zr,J+=Zr,ei)break e}else se.head&&(se.head.name=null);se.length=0,se.mode=B;case B:if(se.flags&4096){if(at===0)break e;Zr=0;do ei=xt[J+Zr++],se.head&&ei&&se.length<65536&&(se.head.comment+=String.fromCharCode(ei));while(ei&&Zr<at);if(se.flags&512&&(se.check=u(se.check,xt,Zr,J)),at-=Zr,J+=Zr,ei)break e}else se.head&&(se.head.comment=null);se.mode=L;case L:if(se.flags&512){for(;vt<16;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(Ze!==(se.check&65535)){et.msg="header crc mismatch",se.mode=ht;break}Ze=0,vt=0}se.head&&(se.head.hcrc=se.flags>>9&1,se.head.done=!0),et.adler=se.check=0,se.mode=Y;break;case H:for(;vt<32;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}et.adler=se.check=Nr(Ze),Ze=0,vt=0,se.mode=U;case U:if(se.havedict===0)return et.next_out=ut,et.avail_out=me,et.next_in=J,et.avail_in=at,se.hold=Ze,se.bits=vt,s;et.adler=se.check=1,se.mode=Y;case Y:if(Ft===A||Ft===R)break e;case W:if(se.last){Ze>>>=vt&7,vt-=vt&7,se.mode=Gt;break}for(;vt<3;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}switch(se.last=Ze&1,Ze>>>=1,vt-=1,Ze&3){case 0:se.mode=q;break;case 1:if(Yt(se),se.mode=Ne,Ft===R){Ze>>>=2,vt-=2;break e}break;case 2:se.mode=Z;break;case 3:et.msg="invalid block type",se.mode=ht}Ze>>>=2,vt-=2;break;case q:for(Ze>>>=vt&7,vt-=vt&7;vt<32;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if((Ze&65535)!==(Ze>>>16^65535)){et.msg="invalid stored block lengths",se.mode=ht;break}if(se.length=Ze&65535,Ze=0,vt=0,se.mode=G,Ft===R)break e;case G:se.mode=$;case $:if(Zr=se.length,Zr){if(Zr>at&&(Zr=at),Zr>me&&(Zr=me),Zr===0)break e;o.arraySet(Vr,xt,J,Zr,ut),at-=Zr,J+=Zr,me-=Zr,ut+=Zr,se.length-=Zr;break}se.mode=Y;break;case Z:for(;vt<14;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(se.nlen=(Ze&31)+257,Ze>>>=5,vt-=5,se.ndist=(Ze&31)+1,Ze>>>=5,vt-=5,se.ncode=(Ze&15)+4,Ze>>>=4,vt-=4,se.nlen>286||se.ndist>30){et.msg="too many length or distance symbols",se.mode=ht;break}se.have=0,se.mode=xe;case xe:for(;se.have<se.ncode;){for(;vt<3;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}se.lens[fa[se.have++]]=Ze&7,Ze>>>=3,vt-=3}for(;se.have<19;)se.lens[fa[se.have++]]=0;if(se.lencode=se.lendyn,se.lenbits=7,Xs={bits:se.lenbits},ai=f(g,se.lens,0,19,se.lencode,0,se.work,Xs),se.lenbits=Xs.bits,ai){et.msg="invalid code lengths set",se.mode=ht;break}se.have=0,se.mode=ce;case ce:for(;se.have<se.nlen+se.ndist;){for(;zn=se.lencode[Ze&(1<<se.lenbits)-1],Pn=zn>>>24,Fn=zn>>>16&255,mi=zn&65535,!(Pn<=vt);){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(mi<16)Ze>>>=Pn,vt-=Pn,se.lens[se.have++]=mi;else{if(mi===16){for(Us=Pn+2;vt<Us;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(Ze>>>=Pn,vt-=Pn,se.have===0){et.msg="invalid bit length repeat",se.mode=ht;break}ei=se.lens[se.have-1],Zr=3+(Ze&3),Ze>>>=2,vt-=2}else if(mi===17){for(Us=Pn+3;vt<Us;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}Ze>>>=Pn,vt-=Pn,ei=0,Zr=3+(Ze&7),Ze>>>=3,vt-=3}else{for(Us=Pn+7;vt<Us;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}Ze>>>=Pn,vt-=Pn,ei=0,Zr=11+(Ze&127),Ze>>>=7,vt-=7}if(se.have+Zr>se.nlen+se.ndist){et.msg="invalid bit length repeat",se.mode=ht;break}for(;Zr--;)se.lens[se.have++]=ei}}if(se.mode===ht)break;if(se.lens[256]===0){et.msg="invalid code -- missing end-of-block",se.mode=ht;break}if(se.lenbits=9,Xs={bits:se.lenbits},ai=f(_,se.lens,0,se.nlen,se.lencode,0,se.work,Xs),se.lenbits=Xs.bits,ai){et.msg="invalid literal/lengths set",se.mode=ht;break}if(se.distbits=6,se.distcode=se.distdyn,Xs={bits:se.distbits},ai=f(p,se.lens,se.nlen,se.ndist,se.distcode,0,se.work,Xs),se.distbits=Xs.bits,ai){et.msg="invalid distances set",se.mode=ht;break}if(se.mode=Ne,Ft===R)break e;case Ne:se.mode=Pe;case Pe:if(at>=6&&me>=258){et.next_out=ut,et.avail_out=me,et.next_in=J,et.avail_in=at,se.hold=Ze,se.bits=vt,y(et,Xr),ut=et.next_out,Vr=et.output,me=et.avail_out,J=et.next_in,xt=et.input,at=et.avail_in,Ze=se.hold,vt=se.bits,se.mode===Y&&(se.back=-1);break}for(se.back=0;zn=se.lencode[Ze&(1<<se.lenbits)-1],Pn=zn>>>24,Fn=zn>>>16&255,mi=zn&65535,!(Pn<=vt);){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(Fn&&!(Fn&240)){for(xi=Pn,Ca=Fn,Ra=mi;zn=se.lencode[Ra+((Ze&(1<<xi+Ca)-1)>>xi)],Pn=zn>>>24,Fn=zn>>>16&255,mi=zn&65535,!(xi+Pn<=vt);){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}Ze>>>=xi,vt-=xi,se.back+=xi}if(Ze>>>=Pn,vt-=Pn,se.back+=Pn,se.length=mi,Fn===0){se.mode=Ot;break}if(Fn&32){se.back=-1,se.mode=Y;break}if(Fn&64){et.msg="invalid literal/length code",se.mode=ht;break}se.extra=Fn&15,se.mode=De;case De:if(se.extra){for(Us=se.extra;vt<Us;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}se.length+=Ze&(1<<se.extra)-1,Ze>>>=se.extra,vt-=se.extra,se.back+=se.extra}se.was=se.length,se.mode=Me;case Me:for(;zn=se.distcode[Ze&(1<<se.distbits)-1],Pn=zn>>>24,Fn=zn>>>16&255,mi=zn&65535,!(Pn<=vt);){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(!(Fn&240)){for(xi=Pn,Ca=Fn,Ra=mi;zn=se.distcode[Ra+((Ze&(1<<xi+Ca)-1)>>xi)],Pn=zn>>>24,Fn=zn>>>16&255,mi=zn&65535,!(xi+Pn<=vt);){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}Ze>>>=xi,vt-=xi,se.back+=xi}if(Ze>>>=Pn,vt-=Pn,se.back+=Pn,Fn&64){et.msg="invalid distance code",se.mode=ht;break}se.offset=mi,se.extra=Fn&15,se.mode=Be;case Be:if(se.extra){for(Us=se.extra;vt<Us;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}se.offset+=Ze&(1<<se.extra)-1,Ze>>>=se.extra,vt-=se.extra,se.back+=se.extra}if(se.offset>se.dmax){et.msg="invalid distance too far back",se.mode=ht;break}se.mode=ft;case ft:if(me===0)break e;if(Zr=Xr-me,se.offset>Zr){if(Zr=se.offset-Zr,Zr>se.whave&&se.sane){et.msg="invalid distance too far back",se.mode=ht;break}Zr>se.wnext?(Zr-=se.wnext,xn=se.wsize-Zr):xn=se.wnext-Zr,Zr>se.length&&(Zr=se.length),Ei=se.window}else Ei=Vr,xn=ut-se.offset,Zr=se.length;Zr>me&&(Zr=me),me-=Zr,se.length-=Zr;do Vr[ut++]=Ei[xn++];while(--Zr);se.length===0&&(se.mode=Pe);break;case Ot:if(me===0)break e;Vr[ut++]=se.length,me--,se.mode=Pe;break;case Gt:if(se.wrap){for(;vt<32;){if(at===0)break e;at--,Ze|=xt[J++]<<vt,vt+=8}if(Xr-=me,et.total_out+=Xr,se.total+=Xr,Xr&&(et.adler=se.check=se.flags?u(se.check,Vr,Xr,ut-Xr):c(se.check,Vr,Xr,ut-Xr)),Xr=me,(se.flags?Ze:Nr(Ze))!==se.check){et.msg="incorrect data check",se.mode=ht;break}Ze=0,vt=0}se.mode=mt;case mt:if(se.wrap&&se.flags){for(;vt<32;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(Ze!==(se.total&4294967295)){et.msg="incorrect length check",se.mode=ht;break}Ze=0,vt=0}se.mode=je;case je:ai=l;break e;case ht:ai=w;break e;case Kt:return E;case Jt:default:return v}return et.next_out=ut,et.avail_out=me,et.next_in=J,et.avail_in=at,se.hold=Ze,se.bits=vt,(se.wsize||Xr!==et.avail_out&&se.mode<ht&&(se.mode<Gt||Ft!==S))&&jt(et,et.output,et.next_out,Xr-et.avail_out),Qr-=et.avail_in,Xr-=et.avail_out,et.total_in+=Qr,et.total_out+=Xr,se.total+=Xr,se.wrap&&Xr&&(et.adler=se.check=se.flags?u(se.check,Vr,Xr,et.next_out-Xr):c(se.check,Vr,Xr,et.next_out-Xr)),et.data_type=se.bits+(se.last?64:0)+(se.mode===Y?128:0)+(se.mode===Ne||se.mode===G?256:0),(Qr===0&&Xr===0||Ft===S)&&ai===z&&(ai=C),ai}function tt(et){if(!et||!et.state)return v;var Ft=et.state;return Ft.window&&(Ft.window=null),et.state=null,z}function lt(et,Ft){var se;return!et||!et.state||(se=et.state,!(se.wrap&2))?v:(se.head=Ft,Ft.done=!1,z)}function ar(et,Ft){var se=Ft.length,xt,Vr,J;return!et||!et.state||(xt=et.state,xt.wrap!==0&&xt.mode!==U)?v:xt.mode===U&&(Vr=1,Vr=c(Vr,Ft,se,0),Vr!==xt.check)?w:(J=jt(et,Ft,se,se),J?(xt.mode=Kt,E):(xt.havedict=1,z))}r.inflateReset=Jr,r.inflateReset2=Yr,r.inflateResetKeep=Mt,r.inflateInit=ve,r.inflateInit2=ie,r.inflate=re,r.inflateEnd=tt,r.inflateGetHeader=lt,r.inflateSetDictionary=ar,r.inflateInfo="pako inflate (from Nodeca project)"}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=15,u=852,y=592,f=0,g=1,_=2,p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],S=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],A=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],R=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(z,l,s,v,w,E,C,h){var x=h.bits,k=0,M=0,D=0,P=0,F=0,X=0,B=0,L=0,H=0,U=0,Y,W,q,G,$,Z=null,xe=0,ce,Ne=new o.Buf16(c+1),Pe=new o.Buf16(c+1),De=null,Me=0,Be,ft,Ot;for(k=0;k<=c;k++)Ne[k]=0;for(M=0;M<v;M++)Ne[l[s+M]]++;for(F=x,P=c;P>=1&&Ne[P]===0;P--);if(F>P&&(F=P),P===0)return w[E++]=20971520,w[E++]=20971520,h.bits=1,0;for(D=1;D<P&&Ne[D]===0;D++);for(F<D&&(F=D),L=1,k=1;k<=c;k++)if(L<<=1,L-=Ne[k],L<0)return-1;if(L>0&&(z===f||P!==1))return-1;for(Pe[1]=0,k=1;k<c;k++)Pe[k+1]=Pe[k]+Ne[k];for(M=0;M<v;M++)l[s+M]!==0&&(C[Pe[l[s+M]]++]=M);if(z===f?(Z=De=C,ce=19):z===g?(Z=p,xe-=257,De=S,Me-=257,ce=256):(Z=A,De=R,ce=-1),U=0,M=0,k=D,$=E,X=F,B=0,q=-1,H=1<<F,G=H-1,z===g&&H>u||z===_&&H>y)return 1;for(;;){Be=k-B,C[M]<ce?(ft=0,Ot=C[M]):C[M]>ce?(ft=De[Me+C[M]],Ot=Z[xe+C[M]]):(ft=96,Ot=0),Y=1<<k-B,W=1<<X,D=W;do W-=Y,w[$+(U>>B)+W]=Be<<24|ft<<16|Ot|0;while(W!==0);for(Y=1<<k-1;U&Y;)Y>>=1;if(Y!==0?(U&=Y-1,U+=Y):U=0,M++,--Ne[k]===0){if(k===P)break;k=l[s+C[M]]}if(k>F&&(U&G)!==q){for(B===0&&(B=F),$+=D,X=k-B,L=1<<X;X+B<P&&(L-=Ne[X+B],!(L<=0));)X++,L<<=1;if(H+=1<<X,z===g&&H>u||z===_&&H>y)return 1;q=U&G,w[q]=F<<24|X<<16|$-E|0}}return U!==0&&(w[$+U]=k-B<<24|4194304|0),h.bits=F,0}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js":(e=>{e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=4,u=0,y=1,f=2;function g(re){for(var tt=re.length;--tt>=0;)re[tt]=0}var _=0,p=1,S=2,A=3,R=258,z=29,l=256,s=l+1+z,v=30,w=19,E=2*s+1,C=15,h=16,x=7,k=256,M=16,D=17,P=18,F=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],X=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=512,U=new Array((s+2)*2);g(U);var Y=new Array(v*2);g(Y);var W=new Array(H);g(W);var q=new Array(R-A+1);g(q);var G=new Array(z);g(G);var $=new Array(v);g($);function Z(re,tt,lt,ar,et){this.static_tree=re,this.extra_bits=tt,this.extra_base=lt,this.elems=ar,this.max_length=et,this.has_stree=re&&re.length}var xe,ce,Ne;function Pe(re,tt){this.dyn_tree=re,this.max_code=0,this.stat_desc=tt}function De(re){return re<256?W[re]:W[256+(re>>>7)]}function Me(re,tt){re.pending_buf[re.pending++]=tt&255,re.pending_buf[re.pending++]=tt>>>8&255}function Be(re,tt,lt){re.bi_valid>h-lt?(re.bi_buf|=tt<<re.bi_valid&65535,Me(re,re.bi_buf),re.bi_buf=tt>>h-re.bi_valid,re.bi_valid+=lt-h):(re.bi_buf|=tt<<re.bi_valid&65535,re.bi_valid+=lt)}function ft(re,tt,lt){Be(re,lt[tt*2],lt[tt*2+1])}function Ot(re,tt){var lt=0;do lt|=re&1,re>>>=1,lt<<=1;while(--tt>0);return lt>>>1}function Gt(re){re.bi_valid===16?(Me(re,re.bi_buf),re.bi_buf=0,re.bi_valid=0):re.bi_valid>=8&&(re.pending_buf[re.pending++]=re.bi_buf&255,re.bi_buf>>=8,re.bi_valid-=8)}function mt(re,tt){var lt=tt.dyn_tree,ar=tt.max_code,et=tt.stat_desc.static_tree,Ft=tt.stat_desc.has_stree,se=tt.stat_desc.extra_bits,xt=tt.stat_desc.extra_base,Vr=tt.stat_desc.max_length,J,ut,at,me,Ze,vt,Qr=0;for(me=0;me<=C;me++)re.bl_count[me]=0;for(lt[re.heap[re.heap_max]*2+1]=0,J=re.heap_max+1;J<E;J++)ut=re.heap[J],me=lt[lt[ut*2+1]*2+1]+1,me>Vr&&(me=Vr,Qr++),lt[ut*2+1]=me,!(ut>ar)&&(re.bl_count[me]++,Ze=0,ut>=xt&&(Ze=se[ut-xt]),vt=lt[ut*2],re.opt_len+=vt*(me+Ze),Ft&&(re.static_len+=vt*(et[ut*2+1]+Ze)));if(Qr!==0){do{for(me=Vr-1;re.bl_count[me]===0;)me--;re.bl_count[me]--,re.bl_count[me+1]+=2,re.bl_count[Vr]--,Qr-=2}while(Qr>0);for(me=Vr;me!==0;me--)for(ut=re.bl_count[me];ut!==0;)at=re.heap[--J],!(at>ar)&&(lt[at*2+1]!==me&&(re.opt_len+=(me-lt[at*2+1])*lt[at*2],lt[at*2+1]=me),ut--)}}function je(re,tt,lt){var ar=new Array(C+1),et=0,Ft,se;for(Ft=1;Ft<=C;Ft++)ar[Ft]=et=et+lt[Ft-1]<<1;for(se=0;se<=tt;se++){var xt=re[se*2+1];xt!==0&&(re[se*2]=Ot(ar[xt]++,xt))}}function ht(){var re,tt,lt,ar,et,Ft=new Array(C+1);for(lt=0,ar=0;ar<z-1;ar++)for(G[ar]=lt,re=0;re<1<<F[ar];re++)q[lt++]=ar;for(q[lt-1]=ar,et=0,ar=0;ar<16;ar++)for($[ar]=et,re=0;re<1<<X[ar];re++)W[et++]=ar;for(et>>=7;ar<v;ar++)for($[ar]=et<<7,re=0;re<1<<X[ar]-7;re++)W[256+et++]=ar;for(tt=0;tt<=C;tt++)Ft[tt]=0;for(re=0;re<=143;)U[re*2+1]=8,re++,Ft[8]++;for(;re<=255;)U[re*2+1]=9,re++,Ft[9]++;for(;re<=279;)U[re*2+1]=7,re++,Ft[7]++;for(;re<=287;)U[re*2+1]=8,re++,Ft[8]++;for(je(U,s+1,Ft),re=0;re<v;re++)Y[re*2+1]=5,Y[re*2]=Ot(re,5);xe=new Z(U,F,l+1,s,C),ce=new Z(Y,X,0,v,C),Ne=new Z(new Array(0),B,0,w,x)}function Kt(re){var tt;for(tt=0;tt<s;tt++)re.dyn_ltree[tt*2]=0;for(tt=0;tt<v;tt++)re.dyn_dtree[tt*2]=0;for(tt=0;tt<w;tt++)re.bl_tree[tt*2]=0;re.dyn_ltree[k*2]=1,re.opt_len=re.static_len=0,re.last_lit=re.matches=0}function Jt(re){re.bi_valid>8?Me(re,re.bi_buf):re.bi_valid>0&&(re.pending_buf[re.pending++]=re.bi_buf),re.bi_buf=0,re.bi_valid=0}function Wt(re,tt,lt,ar){Jt(re),Me(re,lt),Me(re,~lt),o.arraySet(re.pending_buf,re.window,tt,lt,re.pending),re.pending+=lt}function Br(re,tt,lt,ar){var et=tt*2,Ft=lt*2;return re[et]<re[Ft]||re[et]===re[Ft]&&ar[tt]<=ar[lt]}function zr(re,tt,lt){for(var ar=re.heap[lt],et=lt<<1;et<=re.heap_len&&(et<re.heap_len&&Br(tt,re.heap[et+1],re.heap[et],re.depth)&&et++,!Br(tt,ar,re.heap[et],re.depth));)re.heap[lt]=re.heap[et],lt=et,et<<=1;re.heap[lt]=ar}function cr(re,tt,lt){var ar,et,Ft=0,se,xt;if(re.last_lit!==0)do ar=re.pending_buf[re.d_buf+Ft*2]<<8|re.pending_buf[re.d_buf+Ft*2+1],et=re.pending_buf[re.l_buf+Ft],Ft++,ar===0?ft(re,et,tt):(se=q[et],ft(re,se+l+1,tt),xt=F[se],xt!==0&&(et-=G[se],Be(re,et,xt)),ar--,se=De(ar),ft(re,se,lt),xt=X[se],xt!==0&&(ar-=$[se],Be(re,ar,xt)));while(Ft<re.last_lit);ft(re,k,tt)}function Nr(re,tt){var lt=tt.dyn_tree,ar=tt.stat_desc.static_tree,et=tt.stat_desc.has_stree,Ft=tt.stat_desc.elems,se,xt,Vr=-1,J;for(re.heap_len=0,re.heap_max=E,se=0;se<Ft;se++)lt[se*2]!==0?(re.heap[++re.heap_len]=Vr=se,re.depth[se]=0):lt[se*2+1]=0;for(;re.heap_len<2;)J=re.heap[++re.heap_len]=Vr<2?++Vr:0,lt[J*2]=1,re.depth[J]=0,re.opt_len--,et&&(re.static_len-=ar[J*2+1]);for(tt.max_code=Vr,se=re.heap_len>>1;se>=1;se--)zr(re,lt,se);J=Ft;do se=re.heap[1],re.heap[1]=re.heap[re.heap_len--],zr(re,lt,1),xt=re.heap[1],re.heap[--re.heap_max]=se,re.heap[--re.heap_max]=xt,lt[J*2]=lt[se*2]+lt[xt*2],re.depth[J]=(re.depth[se]>=re.depth[xt]?re.depth[se]:re.depth[xt])+1,lt[se*2+1]=lt[xt*2+1]=J,re.heap[1]=J++,zr(re,lt,1);while(re.heap_len>=2);re.heap[--re.heap_max]=re.heap[1],mt(re,tt),je(lt,Vr,re.bl_count)}function At(re,tt,lt){var ar,et=-1,Ft,se=tt[1],xt=0,Vr=7,J=4;for(se===0&&(Vr=138,J=3),tt[(lt+1)*2+1]=65535,ar=0;ar<=lt;ar++)Ft=se,se=tt[(ar+1)*2+1],!(++xt<Vr&&Ft===se)&&(xt<J?re.bl_tree[Ft*2]+=xt:Ft!==0?(Ft!==et&&re.bl_tree[Ft*2]++,re.bl_tree[M*2]++):xt<=10?re.bl_tree[D*2]++:re.bl_tree[P*2]++,xt=0,et=Ft,se===0?(Vr=138,J=3):Ft===se?(Vr=6,J=3):(Vr=7,J=4))}function Mt(re,tt,lt){var ar,et=-1,Ft,se=tt[1],xt=0,Vr=7,J=4;for(se===0&&(Vr=138,J=3),ar=0;ar<=lt;ar++)if(Ft=se,se=tt[(ar+1)*2+1],!(++xt<Vr&&Ft===se)){if(xt<J)do ft(re,Ft,re.bl_tree);while(--xt!==0);else Ft!==0?(Ft!==et&&(ft(re,Ft,re.bl_tree),xt--),ft(re,M,re.bl_tree),Be(re,xt-3,2)):xt<=10?(ft(re,D,re.bl_tree),Be(re,xt-3,3)):(ft(re,P,re.bl_tree),Be(re,xt-11,7));xt=0,et=Ft,se===0?(Vr=138,J=3):Ft===se?(Vr=6,J=3):(Vr=7,J=4)}}function Jr(re){var tt;for(At(re,re.dyn_ltree,re.l_desc.max_code),At(re,re.dyn_dtree,re.d_desc.max_code),Nr(re,re.bl_desc),tt=w-1;tt>=3&&re.bl_tree[L[tt]*2+1]===0;tt--);return re.opt_len+=3*(tt+1)+5+5+4,tt}function Yr(re,tt,lt,ar){var et;for(Be(re,tt-257,5),Be(re,lt-1,5),Be(re,ar-4,4),et=0;et<ar;et++)Be(re,re.bl_tree[L[et]*2+1],3);Mt(re,re.dyn_ltree,tt-1),Mt(re,re.dyn_dtree,lt-1)}function ie(re){var tt=4093624447,lt;for(lt=0;lt<=31;lt++,tt>>>=1)if(tt&1&&re.dyn_ltree[lt*2]!==0)return u;if(re.dyn_ltree[18]!==0||re.dyn_ltree[20]!==0||re.dyn_ltree[26]!==0)return y;for(lt=32;lt<l;lt++)if(re.dyn_ltree[lt*2]!==0)return y;return u}var ve=!1;function we(re){ve||(ht(),ve=!0),re.l_desc=new Pe(re.dyn_ltree,xe),re.d_desc=new Pe(re.dyn_dtree,ce),re.bl_desc=new Pe(re.bl_tree,Ne),re.bi_buf=0,re.bi_valid=0,Kt(re)}function it(re,tt,lt,ar){Be(re,(_<<1)+(ar?1:0),3),Wt(re,tt,lt)}function rt(re){Be(re,p<<1,3),ft(re,k,U),Gt(re)}function Yt(re,tt,lt,ar){var et,Ft,se=0;re.level>0?(re.strm.data_type===f&&(re.strm.data_type=ie(re)),Nr(re,re.l_desc),Nr(re,re.d_desc),se=Jr(re),et=re.opt_len+3+7>>>3,Ft=re.static_len+3+7>>>3,Ft<=et&&(et=Ft)):et=Ft=lt+5,lt+4<=et&&tt!==-1?it(re,tt,lt,ar):re.strategy===c||Ft===et?(Be(re,(p<<1)+(ar?1:0),3),cr(re,U,Y)):(Be(re,(S<<1)+(ar?1:0),3),Yr(re,re.l_desc.max_code+1,re.d_desc.max_code+1,se+1),cr(re,re.dyn_ltree,re.dyn_dtree)),Kt(re),ar&&Jt(re)}function jt(re,tt,lt){return re.pending_buf[re.d_buf+re.last_lit*2]=tt>>>8&255,re.pending_buf[re.d_buf+re.last_lit*2+1]=tt&255,re.pending_buf[re.l_buf+re.last_lit]=lt&255,re.last_lit++,tt===0?re.dyn_ltree[lt*2]++:(re.matches++,tt--,re.dyn_ltree[(q[lt]+l+1)*2]++,re.dyn_dtree[De(tt)*2]++),re.last_lit===re.lit_bufsize-1}r._tr_init=we,r._tr_stored_block=it,r._tr_flush_block=Yt,r._tr_tally=jt,r._tr_align=rt}),"./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js":(e=>{function r(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=r}),"./src/SurfaceWorker.js":(()=>{$3Dmol.workerString=(function(){self.onmessage=function(e){var r=e.data,t=r.type;if(t<0)self.atomData=r.atoms,self.volume=r.volume,self.ps=new ProteinSurface;else{var o=self.ps;o.initparm(r.expandedExtent,t!=1,self.volume),o.fillvoxels(self.atomData,r.extendedAtoms),o.buildboundary(),(t===4||t===2)&&(o.fastdistancemap(),o.boundingatom(!1),o.fillvoxelswaals(self.atomData,r.extendedAtoms)),o.marchingcube(t);var c=o.getFacesAndVertices(r.atomsToShow);self.postMessage(c)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0}),"./src/exporter.js":(e=>{typeof e.exports=="object"&&(e.exports=window.$3Dmol)}),"./src/vendor/mmtf.js":(function(e,r){(function(t,o){o(r)})(this,function(t){function o(ie,ve,we){for(var it=(ie.byteLength,0),rt=we.length;rt>it;it++){var Yt=we.charCodeAt(it);if(128>Yt)ie.setUint8(ve++,Yt>>>0&127|0);else if(2048>Yt)ie.setUint8(ve++,Yt>>>6&31|192),ie.setUint8(ve++,Yt>>>0&63|128);else if(65536>Yt)ie.setUint8(ve++,Yt>>>12&15|224),ie.setUint8(ve++,Yt>>>6&63|128),ie.setUint8(ve++,Yt>>>0&63|128);else{if(!(1114112>Yt))throw new Error("bad codepoint "+Yt);ie.setUint8(ve++,Yt>>>18&7|240),ie.setUint8(ve++,Yt>>>12&63|128),ie.setUint8(ve++,Yt>>>6&63|128),ie.setUint8(ve++,Yt>>>0&63|128)}}}function c(ie){for(var ve=0,we=0,it=ie.length;it>we;we++){var rt=ie.charCodeAt(we);if(128>rt)ve+=1;else if(2048>rt)ve+=2;else if(65536>rt)ve+=3;else{if(!(1114112>rt))throw new Error("bad codepoint "+rt);ve+=4}}return ve}function u(ie,ve,we){var it=typeof ie;if(it==="string"){var rt=c(ie);if(32>rt)return ve.setUint8(we,160|rt),o(ve,we+1,ie),1+rt;if(256>rt)return ve.setUint8(we,217),ve.setUint8(we+1,rt),o(ve,we+2,ie),2+rt;if(65536>rt)return ve.setUint8(we,218),ve.setUint16(we+1,rt),o(ve,we+3,ie),3+rt;if(4294967296>rt)return ve.setUint8(we,219),ve.setUint32(we+1,rt),o(ve,we+5,ie),5+rt}if(ie instanceof Uint8Array){var rt=ie.byteLength,Yt=new Uint8Array(ve.buffer);if(256>rt)return ve.setUint8(we,196),ve.setUint8(we+1,rt),Yt.set(ie,we+2),2+rt;if(65536>rt)return ve.setUint8(we,197),ve.setUint16(we+1,rt),Yt.set(ie,we+3),3+rt;if(4294967296>rt)return ve.setUint8(we,198),ve.setUint32(we+1,rt),Yt.set(ie,we+5),5+rt}if(it==="number"){if(!isFinite(ie))throw new Error("Number not finite: "+ie);if(Math.floor(ie)!==ie)return ve.setUint8(we,203),ve.setFloat64(we+1,ie),9;if(ie>=0){if(128>ie)return ve.setUint8(we,ie),1;if(256>ie)return ve.setUint8(we,204),ve.setUint8(we+1,ie),2;if(65536>ie)return ve.setUint8(we,205),ve.setUint16(we+1,ie),3;if(4294967296>ie)return ve.setUint8(we,206),ve.setUint32(we+1,ie),5;throw new Error("Number too big 0x"+ie.toString(16))}if(ie>=-32)return ve.setInt8(we,ie),1;if(ie>=-128)return ve.setUint8(we,208),ve.setInt8(we+1,ie),2;if(ie>=-32768)return ve.setUint8(we,209),ve.setInt16(we+1,ie),3;if(ie>=-2147483648)return ve.setUint8(we,210),ve.setInt32(we+1,ie),5;throw new Error("Number too small -0x"+(-ie).toString(16).substr(1))}if(ie===null)return ve.setUint8(we,192),1;if(it==="boolean")return ve.setUint8(we,ie?195:194),1;if(it==="object"){var rt,tt=0,jt=Array.isArray(ie);if(jt)rt=ie.length;else{var re=Object.keys(ie);rt=re.length}var tt;if(16>rt?(ve.setUint8(we,rt|(jt?144:128)),tt=1):65536>rt?(ve.setUint8(we,jt?220:222),ve.setUint16(we+1,rt),tt=3):4294967296>rt&&(ve.setUint8(we,jt?221:223),ve.setUint32(we+1,rt),tt=5),jt)for(var lt=0;rt>lt;lt++)tt+=u(ie[lt],ve,we+tt);else for(var lt=0;rt>lt;lt++){var ar=re[lt];tt+=u(ar,ve,we+tt),tt+=u(ie[ar],ve,we+tt)}return tt}throw new Error("Unknown type "+it)}function y(ie){var ve=typeof ie;if(ve==="string"){var we=c(ie);if(32>we)return 1+we;if(256>we)return 2+we;if(65536>we)return 3+we;if(4294967296>we)return 5+we}if(ie instanceof Uint8Array){var we=ie.byteLength;if(256>we)return 2+we;if(65536>we)return 3+we;if(4294967296>we)return 5+we}if(ve==="number"){if(Math.floor(ie)!==ie)return 9;if(ie>=0){if(128>ie)return 1;if(256>ie)return 2;if(65536>ie)return 3;if(4294967296>ie)return 5;throw new Error("Number too big 0x"+ie.toString(16))}if(ie>=-32)return 1;if(ie>=-128)return 2;if(ie>=-32768)return 3;if(ie>=-2147483648)return 5;throw new Error("Number too small -0x"+ie.toString(16).substr(1))}if(ve==="boolean"||ie===null)return 1;if(ve==="object"){var we,it=0;if(Array.isArray(ie)){we=ie.length;for(var rt=0;we>rt;rt++)it+=y(ie[rt])}else{var Yt=Object.keys(ie);we=Yt.length;for(var rt=0;we>rt;rt++){var jt=Yt[rt];it+=y(jt)+y(ie[jt])}}if(16>we)return 1+it;if(65536>we)return 3+it;if(4294967296>we)return 5+it;throw new Error("Array or object too long 0x"+we.toString(16))}throw new Error("Unknown type "+ve)}function f(ie){var ve=new ArrayBuffer(y(ie)),we=new DataView(ve);return u(ie,we,0),new Uint8Array(ve)}function g(ie,ve,we){return ve?new ie(ve.buffer,ve.byteOffset,ve.byteLength/(we||1)):void 0}function _(ie){return g(DataView,ie)}function p(ie){return g(Uint8Array,ie)}function S(ie){return g(Int8Array,ie)}function A(ie){return g(Int32Array,ie,4)}function R(ie){return g(Float32Array,ie,4)}function z(ie,ve){var we=ie.length/2;ve||(ve=new Int16Array(we));for(var it=0,rt=0;we>it;++it,rt+=2)ve[it]=ie[rt]<<8^ie[rt+1]<<0;return ve}function l(ie,ve){var we=ie.length;ve||(ve=new Uint8Array(2*we));for(var it=_(ve),rt=0;we>rt;++rt)it.setInt16(2*rt,ie[rt]);return p(ve)}function s(ie,ve){var we=ie.length/4;ve||(ve=new Int32Array(we));for(var it=0,rt=0;we>it;++it,rt+=4)ve[it]=ie[rt]<<24^ie[rt+1]<<16^ie[rt+2]<<8^ie[rt+3]<<0;return ve}function v(ie,ve){var we=ie.length;ve||(ve=new Uint8Array(4*we));for(var it=_(ve),rt=0;we>rt;++rt)it.setInt32(4*rt,ie[rt]);return p(ve)}function w(ie,ve){var we=ie.length;ve||(ve=new Float32Array(we/4));for(var it=_(ve),rt=_(ie),Yt=0,jt=0,re=we/4;re>Yt;++Yt,jt+=4)it.setFloat32(jt,rt.getFloat32(jt),!0);return ve}function E(ie,ve,we){var it=ie.length,rt=1/ve;we||(we=new Float32Array(it));for(var Yt=0;it>Yt;++Yt)we[Yt]=ie[Yt]*rt;return we}function C(ie,ve,we){var it=ie.length;we||(we=new Int32Array(it));for(var rt=0;it>rt;++rt)we[rt]=Math.round(ie[rt]*ve);return we}function h(ie,ve){var we,it;if(!ve){var rt=0;for(we=0,it=ie.length;it>we;we+=2)rt+=ie[we+1];ve=new ie.constructor(rt)}var Yt=0;for(we=0,it=ie.length;it>we;we+=2)for(var jt=ie[we],re=ie[we+1],tt=0;re>tt;++tt)ve[Yt]=jt,++Yt;return ve}function x(ie){if(ie.length===0)return new Int32Array;var ve,we,it=2;for(ve=1,we=ie.length;we>ve;++ve)ie[ve-1]!==ie[ve]&&(it+=2);var rt=new Int32Array(it),Yt=0,jt=1;for(ve=1,we=ie.length;we>ve;++ve)ie[ve-1]!==ie[ve]?(rt[Yt]=ie[ve-1],rt[Yt+1]=jt,jt=1,Yt+=2):++jt;return rt[Yt]=ie[ie.length-1],rt[Yt+1]=jt,rt}function k(ie,ve){var we=ie.length;ve||(ve=new ie.constructor(we)),we&&(ve[0]=ie[0]);for(var it=1;we>it;++it)ve[it]=ie[it]+ve[it-1];return ve}function M(ie,ve){var we=ie.length;ve||(ve=new ie.constructor(we)),ve[0]=ie[0];for(var it=1;we>it;++it)ve[it]=ie[it]-ie[it-1];return ve}function D(ie,ve){var we,it,rt=ie instanceof Int8Array?127:32767,Yt=-rt-1,jt=ie.length;if(!ve){var re=0;for(we=0;jt>we;++we)ie[we]<rt&&ie[we]>Yt&&++re;ve=new Int32Array(re)}for(we=0,it=0;jt>we;){for(var tt=0;ie[we]===rt||ie[we]===Yt;)tt+=ie[we],++we;tt+=ie[we],++we,ve[it]=tt,++it}return ve}function P(ie,ve){var we,it=32767,rt=-it-1,Yt=ie.length,jt=0;for(we=0;Yt>we;++we){var re=ie[we];re===0?++jt:re>0?(jt+=Math.ceil(re/it),re%it===0&&(jt+=1)):(jt+=Math.ceil(re/rt),re%rt===0&&(jt+=1))}var tt=new Int16Array(jt),lt=0;for(we=0;Yt>we;++we){var re=ie[we];if(re>=0)for(;re>=it;)tt[lt]=it,++lt,re-=it;else for(;rt>=re;)tt[lt]=rt,++lt,re-=rt;tt[lt]=re,++lt}return tt}function F(ie,ve){return k(h(ie),ve)}function X(ie){return x(M(ie))}function B(ie,ve,we){return E(h(ie,A(we)),ve,we)}function L(ie,ve){return x(C(ie,ve))}function H(ie,ve,we){return E(k(ie,A(we)),ve,we)}function U(ie,ve,we){return M(C(ie,ve),we)}function Y(ie,ve,we){return E(D(ie,A(we)),ve,we)}function W(ie,ve,we){var it=D(ie,A(we));return H(it,ve,R(it))}function q(ie,ve,we){return P(U(ie,ve))}function G(Yt){var ve=_(Yt),we=ve.getInt32(0),it=ve.getInt32(4),rt=Yt.subarray(8,12),Yt=Yt.subarray(12);return[we,Yt,it,rt]}function $(ie,ve,we,it){var rt=new ArrayBuffer(12+it.byteLength),Yt=new Uint8Array(rt),jt=new DataView(rt);return jt.setInt32(0,ie),jt.setInt32(4,ve),we&&Yt.set(we,8),Yt.set(it,12),Yt}function Z(ie){var ve=ie.length,we=p(ie);return $(2,ve,void 0,we)}function xe(ie){var ve=ie.length,we=v(ie);return $(4,ve,void 0,we)}function ce(ie,ve){var we=ie.length/ve,it=v([ve]),rt=p(ie);return $(5,we,it,rt)}function Ne(ie){var ve=ie.length,we=v(x(ie));return $(6,ve,void 0,we)}function Pe(ie){var ve=ie.length,we=v(X(ie));return $(8,ve,void 0,we)}function De(ie,ve){var we=ie.length,it=v([ve]),rt=v(L(ie,ve));return $(9,we,it,rt)}function Me(ie,ve){var we=ie.length,it=v([ve]),rt=l(q(ie,ve));return $(10,we,it,rt)}function Be(ie){var ve={};return zr.forEach(function(we){ie[we]!==void 0&&(ve[we]=ie[we])}),ie.bondAtomList&&(ve.bondAtomList=xe(ie.bondAtomList)),ie.bondOrderList&&(ve.bondOrderList=Z(ie.bondOrderList)),ve.xCoordList=Me(ie.xCoordList,1e3),ve.yCoordList=Me(ie.yCoordList,1e3),ve.zCoordList=Me(ie.zCoordList,1e3),ie.bFactorList&&(ve.bFactorList=Me(ie.bFactorList,100)),ie.atomIdList&&(ve.atomIdList=Pe(ie.atomIdList)),ie.altLocList&&(ve.altLocList=Ne(ie.altLocList)),ie.occupancyList&&(ve.occupancyList=De(ie.occupancyList,100)),ve.groupIdList=Pe(ie.groupIdList),ve.groupTypeList=xe(ie.groupTypeList),ie.secStructList&&(ve.secStructList=Z(ie.secStructList)),ie.insCodeList&&(ve.insCodeList=Ne(ie.insCodeList)),ie.sequenceIndexList&&(ve.sequenceIndexList=Pe(ie.sequenceIndexList)),ve.chainIdList=ce(ie.chainIdList,4),ie.chainNameList&&(ve.chainNameList=ce(ie.chainNameList,4)),ve}function ft(ie){function ve(tt){for(var lt={},ar=0;tt>ar;ar++){var et=Yt();lt[et]=Yt()}return lt}function we(tt){var lt=ie.subarray(jt,jt+tt);return jt+=tt,lt}function it(tt){var lt=ie.subarray(jt,jt+tt);jt+=tt;var ar=65535;if(tt>ar){for(var et=[],Ft=0;Ft<lt.length;Ft+=ar)et.push(String.fromCharCode.apply(null,lt.subarray(Ft,Ft+ar)));return et.join("")}return String.fromCharCode.apply(null,lt)}function rt(tt){for(var lt=new Array(tt),ar=0;tt>ar;ar++)lt[ar]=Yt();return lt}function Yt(){var tt,lt,ar=ie[jt];if(!(128&ar))return jt++,ar;if((240&ar)===128)return lt=15&ar,jt++,ve(lt);if((240&ar)===144)return lt=15&ar,jt++,rt(lt);if((224&ar)===160)return lt=31&ar,jt++,it(lt);if((224&ar)===224)return tt=re.getInt8(jt),jt++,tt;switch(ar){case 192:return jt++,null;case 194:return jt++,!1;case 195:return jt++,!0;case 196:return lt=re.getUint8(jt+1),jt+=2,we(lt);case 197:return lt=re.getUint16(jt+1),jt+=3,we(lt);case 198:return lt=re.getUint32(jt+1),jt+=5,we(lt);case 202:return tt=re.getFloat32(jt+1),jt+=5,tt;case 203:return tt=re.getFloat64(jt+1),jt+=9,tt;case 204:return tt=ie[jt+1],jt+=2,tt;case 205:return tt=re.getUint16(jt+1),jt+=3,tt;case 206:return tt=re.getUint32(jt+1),jt+=5,tt;case 208:return tt=re.getInt8(jt+1),jt+=2,tt;case 209:return tt=re.getInt16(jt+1),jt+=3,tt;case 210:return tt=re.getInt32(jt+1),jt+=5,tt;case 217:return lt=re.getUint8(jt+1),jt+=2,it(lt);case 218:return lt=re.getUint16(jt+1),jt+=3,it(lt);case 219:return lt=re.getUint32(jt+1),jt+=5,it(lt);case 220:return lt=re.getUint16(jt+1),jt+=3,rt(lt);case 221:return lt=re.getUint32(jt+1),jt+=5,rt(lt);case 222:return lt=re.getUint16(jt+1),jt+=3,ve(lt);case 223:return lt=re.getUint32(jt+1),jt+=5,ve(lt)}throw new Error("Unknown type 0x"+ar.toString(16))}var jt=0,re=new DataView(ie.buffer);return Yt()}function Ot(ie,ve,we,it){switch(ie){case 1:return w(ve);case 2:return S(ve);case 3:return z(ve);case 4:return s(ve);case 5:return p(ve);case 6:return h(s(ve),new Uint8Array(we));case 7:return h(s(ve));case 8:return F(s(ve));case 9:return B(s(ve),s(it)[0]);case 10:return W(z(ve),s(it)[0]);case 11:return E(z(ve),s(it)[0]);case 12:return Y(z(ve),s(it)[0]);case 13:return Y(S(ve),s(it)[0]);case 14:return D(z(ve));case 15:return D(S(ve))}}function Gt(ie,ve){ve=ve||{};var we=ve.ignoreFields,it={};return Nr.forEach(function(rt){var Yt=we?we.indexOf(rt)!==-1:!1,jt=ie[rt];Yt||jt===void 0||(jt instanceof Uint8Array?it[rt]=Ot.apply(null,G(jt)):it[rt]=jt)}),it}function mt(ie){return String.fromCharCode.apply(null,ie).replace(/\0/g,"")}function je(ie,ve,we){we=we||{};var it,rt,Yt,jt,re,tt,lt=we.firstModelOnly,ar=ve.onModel,et=ve.onChain,Ft=ve.onGroup,se=ve.onAtom,xt=ve.onBond,Vr=0,J=0,ut=0,at=0,me=0,Ze=-1,vt=ie.chainNameList,Qr=ie.secStructList,Xr=ie.insCodeList,Zr=ie.sequenceIndexList,xn=ie.atomIdList,Ei=ie.bFactorList,zn=ie.altLocList,Pn=ie.occupancyList,Fn=ie.bondAtomList,mi=ie.bondOrderList;for(it=0,rt=ie.chainsPerModel.length;rt>it&&!(lt&&Vr>0);++it){var xi=ie.chainsPerModel[Vr];for(ar&&ar({chainCount:xi,modelIndex:Vr}),Yt=0;xi>Yt;++Yt){var Ca=ie.groupsPerChain[J];if(et){var Ra=mt(ie.chainIdList.subarray(4*J,4*J+4)),ei=null;vt&&(ei=mt(vt.subarray(4*J,4*J+4))),et({groupCount:Ca,chainIndex:J,modelIndex:Vr,chainId:Ra,chainName:ei})}for(jt=0;Ca>jt;++jt){var ai=ie.groupList[ie.groupTypeList[ut]],ci=ai.atomNameList.length;if(Ft){var Xs=null;Qr&&(Xs=Qr[ut]);var Us=null;ie.insCodeList&&(Us=String.fromCharCode(Xr[ut]));var fa=null;Zr&&(fa=Zr[ut]),Ft({atomCount:ci,groupIndex:ut,chainIndex:J,modelIndex:Vr,groupId:ie.groupIdList[ut],groupType:ie.groupTypeList[ut],groupName:ai.groupName,singleLetterCode:ai.singleLetterCode,chemCompType:ai.chemCompType,secStruct:Xs,insCode:Us,sequenceIndex:fa})}for(re=0;ci>re;++re){if(se){var ll=null;xn&&(ll=xn[at]);var cl=null;Ei&&(cl=Ei[at]);var ul=null;zn&&(ul=String.fromCharCode(zn[at]));var Ya=null;Pn&&(Ya=Pn[at]),se({atomIndex:at,groupIndex:ut,chainIndex:J,modelIndex:Vr,atomId:ll,element:ai.elementList[re],atomName:ai.atomNameList[re],formalCharge:ai.formalChargeList[re],xCoord:ie.xCoordList[at],yCoord:ie.yCoordList[at],zCoord:ie.zCoordList[at],bFactor:cl,altLoc:ul,occupancy:Ya})}at+=1}if(xt){var hi=ai.bondAtomList;for(re=0,tt=ai.bondOrderList.length;tt>re;++re)xt({atomIndex1:at-ci+hi[2*re],atomIndex2:at-ci+hi[2*re+1],bondOrder:ai.bondOrderList[re]})}ut+=1}J+=1}if(me=Ze+1,Ze=at-1,xt&&Fn)for(re=0,tt=Fn.length;tt>re;re+=2){var dl=Fn[re],La=Fn[re+1];(dl>=me&&Ze>=dl||La>=me&&Ze>=La)&&xt({atomIndex1:dl,atomIndex2:La,bondOrder:mi?mi[re/2]:null})}Vr+=1}}function ht(ie){return f(Be(ie))}function Kt(ie,ve){ie instanceof ArrayBuffer&&(ie=new Uint8Array(ie));var we;return we=ie instanceof Uint8Array?ft(ie):ie,Gt(we,ve)}function Jt(ie,ve,we,it){function rt(){try{var jt=Kt(Yt.response);we(jt)}catch(re){it(re)}}var Yt=new XMLHttpRequest;Yt.addEventListener("load",rt,!0),Yt.addEventListener("error",it,!0),Yt.responseType="arraybuffer",Yt.open("GET",ve+ie.toUpperCase()),Yt.send()}function Wt(ie,ve,we){Jt(ie,Jr,ve,we)}function Br(ie,ve,we){Jt(ie,Yr,ve,we)}var zr=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],cr=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],Nr=zr.concat(cr),At="v1.0.1",Mt="//mmtf.rcsb.org/v1.0/",Jr=Mt+"full/",Yr=Mt+"reduced/";t.encode=ht,t.decode=Kt,t.traverse=je,t.fetch=Wt,t.fetchReduced=Br,t.version=At,t.fetchUrl=Jr,t.fetchReducedUrl=Yr,t.encodeMsgpack=f,t.encodeMmtf=Be,t.decodeMsgpack=ft,t.decodeMmtf=Gt})}),"./node_modules/pako/dist/pako.esm.mjs":((e,r,t)=>{t.r(r),t.d(r,{Deflate:()=>il,Inflate:()=>Xu,constants:()=>Pa,default:()=>ru,deflate:()=>Sl,deflateRaw:()=>na,gzip:()=>vc,inflate:()=>Ju,inflateRaw:()=>xc,ungzip:()=>Qu});/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const o=4,c=0,u=1,y=2;function f(I){let K=I.length;for(;--K>=0;)I[K]=0}const g=0,_=1,p=2,S=3,A=258,R=29,z=256,l=z+1+R,s=30,v=19,w=2*l+1,E=15,C=16,h=7,x=256,k=16,M=17,D=18,P=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),F=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),X=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),B=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),L=512,H=new Array((l+2)*2);f(H);const U=new Array(s*2);f(U);const Y=new Array(L);f(Y);const W=new Array(A-S+1);f(W);const q=new Array(R);f(q);const G=new Array(s);f(G);function $(I,K,O,be,Ee){this.static_tree=I,this.extra_bits=K,this.extra_base=O,this.elems=be,this.max_length=Ee,this.has_stree=I&&I.length}let Z,xe,ce;function Ne(I,K){this.dyn_tree=I,this.max_code=0,this.stat_desc=K}const Pe=I=>I<256?Y[I]:Y[256+(I>>>7)],De=(I,K)=>{I.pending_buf[I.pending++]=K&255,I.pending_buf[I.pending++]=K>>>8&255},Me=(I,K,O)=>{I.bi_valid>C-O?(I.bi_buf|=K<<I.bi_valid&65535,De(I,I.bi_buf),I.bi_buf=K>>C-I.bi_valid,I.bi_valid+=O-C):(I.bi_buf|=K<<I.bi_valid&65535,I.bi_valid+=O)},Be=(I,K,O)=>{Me(I,O[K*2],O[K*2+1])},ft=(I,K)=>{let O=0;do O|=I&1,I>>>=1,O<<=1;while(--K>0);return O>>>1},Ot=I=>{I.bi_valid===16?(De(I,I.bi_buf),I.bi_buf=0,I.bi_valid=0):I.bi_valid>=8&&(I.pending_buf[I.pending++]=I.bi_buf&255,I.bi_buf>>=8,I.bi_valid-=8)},Gt=(I,K)=>{const O=K.dyn_tree,be=K.max_code,Ee=K.stat_desc.static_tree,Fe=K.stat_desc.has_stree,St=K.stat_desc.extra_bits,ct=K.stat_desc.extra_base,Kr=K.stat_desc.max_length;let nt,_t,Ln,Hr,Lr,pi,vi=0;for(Hr=0;Hr<=E;Hr++)I.bl_count[Hr]=0;for(O[I.heap[I.heap_max]*2+1]=0,nt=I.heap_max+1;nt<w;nt++)_t=I.heap[nt],Hr=O[O[_t*2+1]*2+1]+1,Hr>Kr&&(Hr=Kr,vi++),O[_t*2+1]=Hr,!(_t>be)&&(I.bl_count[Hr]++,Lr=0,_t>=ct&&(Lr=St[_t-ct]),pi=O[_t*2],I.opt_len+=pi*(Hr+Lr),Fe&&(I.static_len+=pi*(Ee[_t*2+1]+Lr)));if(vi!==0){do{for(Hr=Kr-1;I.bl_count[Hr]===0;)Hr--;I.bl_count[Hr]--,I.bl_count[Hr+1]+=2,I.bl_count[Kr]--,vi-=2}while(vi>0);for(Hr=Kr;Hr!==0;Hr--)for(_t=I.bl_count[Hr];_t!==0;)Ln=I.heap[--nt],!(Ln>be)&&(O[Ln*2+1]!==Hr&&(I.opt_len+=(Hr-O[Ln*2+1])*O[Ln*2],O[Ln*2+1]=Hr),_t--)}},mt=(I,K,O)=>{const be=new Array(E+1);let Ee=0,Fe,St;for(Fe=1;Fe<=E;Fe++)Ee=Ee+O[Fe-1]<<1,be[Fe]=Ee;for(St=0;St<=K;St++){let ct=I[St*2+1];ct!==0&&(I[St*2]=ft(be[ct]++,ct))}},je=()=>{let I,K,O,be,Ee;const Fe=new Array(E+1);for(O=0,be=0;be<R-1;be++)for(q[be]=O,I=0;I<1<<P[be];I++)W[O++]=be;for(W[O-1]=be,Ee=0,be=0;be<16;be++)for(G[be]=Ee,I=0;I<1<<F[be];I++)Y[Ee++]=be;for(Ee>>=7;be<s;be++)for(G[be]=Ee<<7,I=0;I<1<<F[be]-7;I++)Y[256+Ee++]=be;for(K=0;K<=E;K++)Fe[K]=0;for(I=0;I<=143;)H[I*2+1]=8,I++,Fe[8]++;for(;I<=255;)H[I*2+1]=9,I++,Fe[9]++;for(;I<=279;)H[I*2+1]=7,I++,Fe[7]++;for(;I<=287;)H[I*2+1]=8,I++,Fe[8]++;for(mt(H,l+1,Fe),I=0;I<s;I++)U[I*2+1]=5,U[I*2]=ft(I,5);Z=new $(H,P,z+1,l,E),xe=new $(U,F,0,s,E),ce=new $(new Array(0),X,0,v,h)},ht=I=>{let K;for(K=0;K<l;K++)I.dyn_ltree[K*2]=0;for(K=0;K<s;K++)I.dyn_dtree[K*2]=0;for(K=0;K<v;K++)I.bl_tree[K*2]=0;I.dyn_ltree[x*2]=1,I.opt_len=I.static_len=0,I.sym_next=I.matches=0},Kt=I=>{I.bi_valid>8?De(I,I.bi_buf):I.bi_valid>0&&(I.pending_buf[I.pending++]=I.bi_buf),I.bi_buf=0,I.bi_valid=0},Jt=(I,K,O,be)=>{const Ee=K*2,Fe=O*2;return I[Ee]<I[Fe]||I[Ee]===I[Fe]&&be[K]<=be[O]},Wt=(I,K,O)=>{const be=I.heap[O];let Ee=O<<1;for(;Ee<=I.heap_len&&(Ee<I.heap_len&&Jt(K,I.heap[Ee+1],I.heap[Ee],I.depth)&&Ee++,!Jt(K,be,I.heap[Ee],I.depth));)I.heap[O]=I.heap[Ee],O=Ee,Ee<<=1;I.heap[O]=be},Br=(I,K,O)=>{let be,Ee,Fe=0,St,ct;if(I.sym_next!==0)do be=I.pending_buf[I.sym_buf+Fe++]&255,be+=(I.pending_buf[I.sym_buf+Fe++]&255)<<8,Ee=I.pending_buf[I.sym_buf+Fe++],be===0?Be(I,Ee,K):(St=W[Ee],Be(I,St+z+1,K),ct=P[St],ct!==0&&(Ee-=q[St],Me(I,Ee,ct)),be--,St=Pe(be),Be(I,St,O),ct=F[St],ct!==0&&(be-=G[St],Me(I,be,ct)));while(Fe<I.sym_next);Be(I,x,K)},zr=(I,K)=>{const O=K.dyn_tree,be=K.stat_desc.static_tree,Ee=K.stat_desc.has_stree,Fe=K.stat_desc.elems;let St,ct,Kr=-1,nt;for(I.heap_len=0,I.heap_max=w,St=0;St<Fe;St++)O[St*2]!==0?(I.heap[++I.heap_len]=Kr=St,I.depth[St]=0):O[St*2+1]=0;for(;I.heap_len<2;)nt=I.heap[++I.heap_len]=Kr<2?++Kr:0,O[nt*2]=1,I.depth[nt]=0,I.opt_len--,Ee&&(I.static_len-=be[nt*2+1]);for(K.max_code=Kr,St=I.heap_len>>1;St>=1;St--)Wt(I,O,St);nt=Fe;do St=I.heap[1],I.heap[1]=I.heap[I.heap_len--],Wt(I,O,1),ct=I.heap[1],I.heap[--I.heap_max]=St,I.heap[--I.heap_max]=ct,O[nt*2]=O[St*2]+O[ct*2],I.depth[nt]=(I.depth[St]>=I.depth[ct]?I.depth[St]:I.depth[ct])+1,O[St*2+1]=O[ct*2+1]=nt,I.heap[1]=nt++,Wt(I,O,1);while(I.heap_len>=2);I.heap[--I.heap_max]=I.heap[1],Gt(I,K),mt(O,Kr,I.bl_count)},cr=(I,K,O)=>{let be,Ee=-1,Fe,St=K[1],ct=0,Kr=7,nt=4;for(St===0&&(Kr=138,nt=3),K[(O+1)*2+1]=65535,be=0;be<=O;be++)Fe=St,St=K[(be+1)*2+1],!(++ct<Kr&&Fe===St)&&(ct<nt?I.bl_tree[Fe*2]+=ct:Fe!==0?(Fe!==Ee&&I.bl_tree[Fe*2]++,I.bl_tree[k*2]++):ct<=10?I.bl_tree[M*2]++:I.bl_tree[D*2]++,ct=0,Ee=Fe,St===0?(Kr=138,nt=3):Fe===St?(Kr=6,nt=3):(Kr=7,nt=4))},Nr=(I,K,O)=>{let be,Ee=-1,Fe,St=K[1],ct=0,Kr=7,nt=4;for(St===0&&(Kr=138,nt=3),be=0;be<=O;be++)if(Fe=St,St=K[(be+1)*2+1],!(++ct<Kr&&Fe===St)){if(ct<nt)do Be(I,Fe,I.bl_tree);while(--ct!==0);else Fe!==0?(Fe!==Ee&&(Be(I,Fe,I.bl_tree),ct--),Be(I,k,I.bl_tree),Me(I,ct-3,2)):ct<=10?(Be(I,M,I.bl_tree),Me(I,ct-3,3)):(Be(I,D,I.bl_tree),Me(I,ct-11,7));ct=0,Ee=Fe,St===0?(Kr=138,nt=3):Fe===St?(Kr=6,nt=3):(Kr=7,nt=4)}},At=I=>{let K;for(cr(I,I.dyn_ltree,I.l_desc.max_code),cr(I,I.dyn_dtree,I.d_desc.max_code),zr(I,I.bl_desc),K=v-1;K>=3&&I.bl_tree[B[K]*2+1]===0;K--);return I.opt_len+=3*(K+1)+5+5+4,K},Mt=(I,K,O,be)=>{let Ee;for(Me(I,K-257,5),Me(I,O-1,5),Me(I,be-4,4),Ee=0;Ee<be;Ee++)Me(I,I.bl_tree[B[Ee]*2+1],3);Nr(I,I.dyn_ltree,K-1),Nr(I,I.dyn_dtree,O-1)},Jr=I=>{let K=4093624447,O;for(O=0;O<=31;O++,K>>>=1)if(K&1&&I.dyn_ltree[O*2]!==0)return c;if(I.dyn_ltree[18]!==0||I.dyn_ltree[20]!==0||I.dyn_ltree[26]!==0)return u;for(O=32;O<z;O++)if(I.dyn_ltree[O*2]!==0)return u;return c};let Yr=!1;const ie=I=>{Yr||(je(),Yr=!0),I.l_desc=new Ne(I.dyn_ltree,Z),I.d_desc=new Ne(I.dyn_dtree,xe),I.bl_desc=new Ne(I.bl_tree,ce),I.bi_buf=0,I.bi_valid=0,ht(I)},ve=(I,K,O,be)=>{Me(I,(g<<1)+(be?1:0),3),Kt(I),De(I,O),De(I,~O),O&&I.pending_buf.set(I.window.subarray(K,K+O),I.pending),I.pending+=O},we=I=>{Me(I,_<<1,3),Be(I,x,H),Ot(I)},it=(I,K,O,be)=>{let Ee,Fe,St=0;I.level>0?(I.strm.data_type===y&&(I.strm.data_type=Jr(I)),zr(I,I.l_desc),zr(I,I.d_desc),St=At(I),Ee=I.opt_len+3+7>>>3,Fe=I.static_len+3+7>>>3,Fe<=Ee&&(Ee=Fe)):Ee=Fe=O+5,O+4<=Ee&&K!==-1?ve(I,K,O,be):I.strategy===o||Fe===Ee?(Me(I,(_<<1)+(be?1:0),3),Br(I,H,U)):(Me(I,(p<<1)+(be?1:0),3),Mt(I,I.l_desc.max_code+1,I.d_desc.max_code+1,St+1),Br(I,I.dyn_ltree,I.dyn_dtree)),ht(I),be&&Kt(I)},rt=(I,K,O)=>(I.pending_buf[I.sym_buf+I.sym_next++]=K,I.pending_buf[I.sym_buf+I.sym_next++]=K>>8,I.pending_buf[I.sym_buf+I.sym_next++]=O,K===0?I.dyn_ltree[O*2]++:(I.matches++,K--,I.dyn_ltree[(W[O]+z+1)*2]++,I.dyn_dtree[Pe(K)*2]++),I.sym_next===I.sym_end);var Yt=ie,jt=ve,re=it,tt=rt,lt=we,ar={_tr_init:Yt,_tr_stored_block:jt,_tr_flush_block:re,_tr_tally:tt,_tr_align:lt},et=(I,K,O,be)=>{let Ee=I&65535|0,Fe=I>>>16&65535|0,St=0;for(;O!==0;){St=O>2e3?2e3:O,O-=St;do Ee=Ee+K[be++]|0,Fe=Fe+Ee|0;while(--St);Ee%=65521,Fe%=65521}return Ee|Fe<<16|0};const Ft=()=>{let I,K=[];for(var O=0;O<256;O++){I=O;for(var be=0;be<8;be++)I=I&1?3988292384^I>>>1:I>>>1;K[O]=I}return K},se=new Uint32Array(Ft());var xt=(I,K,O,be)=>{const Ee=se,Fe=be+O;I^=-1;for(let St=be;St<Fe;St++)I=I>>>8^Ee[(I^K[St])&255];return I^-1},Vr={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},J={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ut,_tr_stored_block:at,_tr_flush_block:me,_tr_tally:Ze,_tr_align:vt}=ar,{Z_NO_FLUSH:Qr,Z_PARTIAL_FLUSH:Xr,Z_FULL_FLUSH:Zr,Z_FINISH:xn,Z_BLOCK:Ei,Z_OK:zn,Z_STREAM_END:Pn,Z_STREAM_ERROR:Fn,Z_DATA_ERROR:mi,Z_BUF_ERROR:xi,Z_DEFAULT_COMPRESSION:Ca,Z_FILTERED:Ra,Z_HUFFMAN_ONLY:ei,Z_RLE:ai,Z_FIXED:ci,Z_DEFAULT_STRATEGY:Xs,Z_UNKNOWN:Us,Z_DEFLATED:fa}=J,ll=9,cl=15,ul=8,Ya=286,hi=30,dl=19,La=2*Ya+1,kc=15,On=3,Aa=258,pa=Aa+On+1,Tl=32,$s=42,hl=57,ma=69,pu=73,mu=91,gu=103,Na=113,qa=666,Ns=1,Ba=2,fl=3,Ml=4,yu=3,Xa=(I,K)=>(I.msg=Vr[K],K),Tc=I=>I*2-(I>4?9:0),_a=I=>{let K=I.length;for(;--K>=0;)I[K]=0},bh=I=>{let K,O,be,Ee=I.w_size;K=I.hash_size,be=K;do O=I.head[--be],I.head[be]=O>=Ee?O-Ee:0;while(--K);K=Ee,be=K;do O=I.prev[--be],I.prev[be]=O>=Ee?O-Ee:0;while(--K)};let za=(I,K,O)=>(K<<I.hash_shift^O)&I.hash_mask;const Dn=I=>{const K=I.state;let O=K.pending;O>I.avail_out&&(O=I.avail_out),O!==0&&(I.output.set(K.pending_buf.subarray(K.pending_out,K.pending_out+O),I.next_out),I.next_out+=O,K.pending_out+=O,I.total_out+=O,I.avail_out-=O,K.pending-=O,K.pending===0&&(K.pending_out=0))},oa=(I,K)=>{me(I,I.block_start>=0?I.block_start:-1,I.strstart-I.block_start,K),I.block_start=I.strstart,Dn(I.strm)},ii=(I,K)=>{I.pending_buf[I.pending++]=K},pl=(I,K)=>{I.pending_buf[I.pending++]=K>>>8&255,I.pending_buf[I.pending++]=K&255},Mc=(I,K,O,be)=>{let Ee=I.avail_in;return Ee>be&&(Ee=be),Ee===0?0:(I.avail_in-=Ee,K.set(I.input.subarray(I.next_in,I.next_in+Ee),O),I.state.wrap===1?I.adler=et(I.adler,K,Ee,O):I.state.wrap===2&&(I.adler=xt(I.adler,K,Ee,O)),I.next_in+=Ee,I.total_in+=Ee,Ee)},vu=(I,K)=>{let O=I.max_chain_length,be=I.strstart,Ee,Fe,St=I.prev_length,ct=I.nice_match;const Kr=I.strstart>I.w_size-pa?I.strstart-(I.w_size-pa):0,nt=I.window,_t=I.w_mask,Ln=I.prev,Hr=I.strstart+Aa;let Lr=nt[be+St-1],pi=nt[be+St];I.prev_length>=I.good_match&&(O>>=2),ct>I.lookahead&&(ct=I.lookahead);do if(Ee=K,!(nt[Ee+St]!==pi||nt[Ee+St-1]!==Lr||nt[Ee]!==nt[be]||nt[++Ee]!==nt[be+1])){be+=2,Ee++;do;while(nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&be<Hr);if(Fe=Aa-(Hr-be),be=Hr-Aa,Fe>St){if(I.match_start=K,St=Fe,Fe>=ct)break;Lr=nt[be+St-1],pi=nt[be+St]}}while((K=Ln[K&_t])>Kr&&--O!==0);return St<=I.lookahead?St:I.lookahead},ml=I=>{const K=I.w_size;let O,be,Ee;do{if(be=I.window_size-I.lookahead-I.strstart,I.strstart>=K+(K-pa)&&(I.window.set(I.window.subarray(K,K+K-be),0),I.match_start-=K,I.strstart-=K,I.block_start-=K,I.insert>I.strstart&&(I.insert=I.strstart),bh(I),be+=K),I.strm.avail_in===0)break;if(O=Mc(I.strm,I.window,I.strstart+I.lookahead,be),I.lookahead+=O,I.lookahead+I.insert>=On)for(Ee=I.strstart-I.insert,I.ins_h=I.window[Ee],I.ins_h=za(I,I.ins_h,I.window[Ee+1]);I.insert&&(I.ins_h=za(I,I.ins_h,I.window[Ee+On-1]),I.prev[Ee&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=Ee,Ee++,I.insert--,!(I.lookahead+I.insert<On)););}while(I.lookahead<pa&&I.strm.avail_in!==0)},Nc=(I,K)=>{let O=I.pending_buf_size-5>I.w_size?I.w_size:I.pending_buf_size-5,be,Ee,Fe,St=0,ct=I.strm.avail_in;do{if(be=65535,Fe=I.bi_valid+42>>3,I.strm.avail_out<Fe||(Fe=I.strm.avail_out-Fe,Ee=I.strstart-I.block_start,be>Ee+I.strm.avail_in&&(be=Ee+I.strm.avail_in),be>Fe&&(be=Fe),be<O&&(be===0&&K!==xn||K===Qr||be!==Ee+I.strm.avail_in)))break;St=K===xn&&be===Ee+I.strm.avail_in?1:0,at(I,0,0,St),I.pending_buf[I.pending-4]=be,I.pending_buf[I.pending-3]=be>>8,I.pending_buf[I.pending-2]=~be,I.pending_buf[I.pending-1]=~be>>8,Dn(I.strm),Ee&&(Ee>be&&(Ee=be),I.strm.output.set(I.window.subarray(I.block_start,I.block_start+Ee),I.strm.next_out),I.strm.next_out+=Ee,I.strm.avail_out-=Ee,I.strm.total_out+=Ee,I.block_start+=Ee,be-=Ee),be&&(Mc(I.strm,I.strm.output,I.strm.next_out,be),I.strm.next_out+=be,I.strm.avail_out-=be,I.strm.total_out+=be)}while(St===0);return ct-=I.strm.avail_in,ct&&(ct>=I.w_size?(I.matches=2,I.window.set(I.strm.input.subarray(I.strm.next_in-I.w_size,I.strm.next_in),0),I.strstart=I.w_size,I.insert=I.strstart):(I.window_size-I.strstart<=ct&&(I.strstart-=I.w_size,I.window.set(I.window.subarray(I.w_size,I.w_size+I.strstart),0),I.matches<2&&I.matches++,I.insert>I.strstart&&(I.insert=I.strstart)),I.window.set(I.strm.input.subarray(I.strm.next_in-ct,I.strm.next_in),I.strstart),I.strstart+=ct,I.insert+=ct>I.w_size-I.insert?I.w_size-I.insert:ct),I.block_start=I.strstart),I.high_water<I.strstart&&(I.high_water=I.strstart),St?Ml:K!==Qr&&K!==xn&&I.strm.avail_in===0&&I.strstart===I.block_start?Ba:(Fe=I.window_size-I.strstart,I.strm.avail_in>Fe&&I.block_start>=I.w_size&&(I.block_start-=I.w_size,I.strstart-=I.w_size,I.window.set(I.window.subarray(I.w_size,I.w_size+I.strstart),0),I.matches<2&&I.matches++,Fe+=I.w_size,I.insert>I.strstart&&(I.insert=I.strstart)),Fe>I.strm.avail_in&&(Fe=I.strm.avail_in),Fe&&(Mc(I.strm,I.window,I.strstart,Fe),I.strstart+=Fe,I.insert+=Fe>I.w_size-I.insert?I.w_size-I.insert:Fe),I.high_water<I.strstart&&(I.high_water=I.strstart),Fe=I.bi_valid+42>>3,Fe=I.pending_buf_size-Fe>65535?65535:I.pending_buf_size-Fe,O=Fe>I.w_size?I.w_size:Fe,Ee=I.strstart-I.block_start,(Ee>=O||(Ee||K===xn)&&K!==Qr&&I.strm.avail_in===0&&Ee<=Fe)&&(be=Ee>Fe?Fe:Ee,St=K===xn&&I.strm.avail_in===0&&be===Ee?1:0,at(I,I.block_start,be,St),I.block_start+=be,Dn(I.strm)),St?fl:Ns)},Nl=(I,K)=>{let O,be;for(;;){if(I.lookahead<pa){if(ml(I),I.lookahead<pa&&K===Qr)return Ns;if(I.lookahead===0)break}if(O=0,I.lookahead>=On&&(I.ins_h=za(I,I.ins_h,I.window[I.strstart+On-1]),O=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart),O!==0&&I.strstart-O<=I.w_size-pa&&(I.match_length=vu(I,O)),I.match_length>=On)if(be=Ze(I,I.strstart-I.match_start,I.match_length-On),I.lookahead-=I.match_length,I.match_length<=I.max_lazy_match&&I.lookahead>=On){I.match_length--;do I.strstart++,I.ins_h=za(I,I.ins_h,I.window[I.strstart+On-1]),O=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart;while(--I.match_length!==0);I.strstart++}else I.strstart+=I.match_length,I.match_length=0,I.ins_h=I.window[I.strstart],I.ins_h=za(I,I.ins_h,I.window[I.strstart+1]);else be=Ze(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++;if(be&&(oa(I,!1),I.strm.avail_out===0))return Ns}return I.insert=I.strstart<On-1?I.strstart:On-1,K===xn?(oa(I,!0),I.strm.avail_out===0?fl:Ml):I.sym_next&&(oa(I,!1),I.strm.avail_out===0)?Ns:Ba},ga=(I,K)=>{let O,be,Ee;for(;;){if(I.lookahead<pa){if(ml(I),I.lookahead<pa&&K===Qr)return Ns;if(I.lookahead===0)break}if(O=0,I.lookahead>=On&&(I.ins_h=za(I,I.ins_h,I.window[I.strstart+On-1]),O=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart),I.prev_length=I.match_length,I.prev_match=I.match_start,I.match_length=On-1,O!==0&&I.prev_length<I.max_lazy_match&&I.strstart-O<=I.w_size-pa&&(I.match_length=vu(I,O),I.match_length<=5&&(I.strategy===Ra||I.match_length===On&&I.strstart-I.match_start>4096)&&(I.match_length=On-1)),I.prev_length>=On&&I.match_length<=I.prev_length){Ee=I.strstart+I.lookahead-On,be=Ze(I,I.strstart-1-I.prev_match,I.prev_length-On),I.lookahead-=I.prev_length-1,I.prev_length-=2;do++I.strstart<=Ee&&(I.ins_h=za(I,I.ins_h,I.window[I.strstart+On-1]),O=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart);while(--I.prev_length!==0);if(I.match_available=0,I.match_length=On-1,I.strstart++,be&&(oa(I,!1),I.strm.avail_out===0))return Ns}else if(I.match_available){if(be=Ze(I,0,I.window[I.strstart-1]),be&&oa(I,!1),I.strstart++,I.lookahead--,I.strm.avail_out===0)return Ns}else I.match_available=1,I.strstart++,I.lookahead--}return I.match_available&&(be=Ze(I,0,I.window[I.strstart-1]),I.match_available=0),I.insert=I.strstart<On-1?I.strstart:On-1,K===xn?(oa(I,!0),I.strm.avail_out===0?fl:Ml):I.sym_next&&(oa(I,!1),I.strm.avail_out===0)?Ns:Ba},Ja=(I,K)=>{let O,be,Ee,Fe;const St=I.window;for(;;){if(I.lookahead<=Aa){if(ml(I),I.lookahead<=Aa&&K===Qr)return Ns;if(I.lookahead===0)break}if(I.match_length=0,I.lookahead>=On&&I.strstart>0&&(Ee=I.strstart-1,be=St[Ee],be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee])){Fe=I.strstart+Aa;do;while(be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee]&&Ee<Fe);I.match_length=Aa-(Fe-Ee),I.match_length>I.lookahead&&(I.match_length=I.lookahead)}if(I.match_length>=On?(O=Ze(I,1,I.match_length-On),I.lookahead-=I.match_length,I.strstart+=I.match_length,I.match_length=0):(O=Ze(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++),O&&(oa(I,!1),I.strm.avail_out===0))return Ns}return I.insert=0,K===xn?(oa(I,!0),I.strm.avail_out===0?fl:Ml):I.sym_next&&(oa(I,!1),I.strm.avail_out===0)?Ns:Ba},Qa=(I,K)=>{let O;for(;;){if(I.lookahead===0&&(ml(I),I.lookahead===0)){if(K===Qr)return Ns;break}if(I.match_length=0,O=Ze(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++,O&&(oa(I,!1),I.strm.avail_out===0))return Ns}return I.insert=0,K===xn?(oa(I,!0),I.strm.avail_out===0?fl:Ml):I.sym_next&&(oa(I,!1),I.strm.avail_out===0)?Ns:Ba};function aa(I,K,O,be,Ee){this.good_length=I,this.max_lazy=K,this.nice_length=O,this.max_chain=be,this.func=Ee}const Ga=[new aa(0,0,0,0,Nc),new aa(4,4,8,4,Nl),new aa(4,5,16,8,Nl),new aa(4,6,32,32,Nl),new aa(4,4,16,16,ga),new aa(8,16,32,32,ga),new aa(8,16,128,128,ga),new aa(8,32,128,256,ga),new aa(32,128,258,1024,ga),new aa(32,258,258,4096,ga)],Za=I=>{I.window_size=2*I.w_size,_a(I.head),I.max_lazy_match=Ga[I.level].max_lazy,I.good_match=Ga[I.level].good_length,I.nice_match=Ga[I.level].nice_length,I.max_chain_length=Ga[I.level].max_chain,I.strstart=0,I.block_start=0,I.lookahead=0,I.insert=0,I.match_length=I.prev_length=On-1,I.match_available=0,I.ins_h=0};function wh(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=fa,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(La*2),this.dyn_dtree=new Uint16Array((2*hi+1)*2),this.bl_tree=new Uint16Array((2*dl+1)*2),_a(this.dyn_ltree),_a(this.dyn_dtree),_a(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(kc+1),this.heap=new Uint16Array(2*Ya+1),_a(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Ya+1),_a(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const zl=I=>{if(!I)return 1;const K=I.state;return!K||K.strm!==I||K.status!==$s&&K.status!==hl&&K.status!==ma&&K.status!==pu&&K.status!==mu&&K.status!==gu&&K.status!==Na&&K.status!==qa?1:0},Il=I=>{if(zl(I))return Xa(I,Fn);I.total_in=I.total_out=0,I.data_type=Us;const K=I.state;return K.pending=0,K.pending_out=0,K.wrap<0&&(K.wrap=-K.wrap),K.status=K.wrap===2?hl:K.wrap?$s:Na,I.adler=K.wrap===2?0:1,K.last_flush=-2,ut(K),zn},fd=I=>{const K=Il(I);return K===zn&&Za(I.state),K},pd=(I,K)=>zl(I)||I.state.wrap!==2?Fn:(I.state.gzhead=K,zn),rc=(I,K,O,be,Ee,Fe)=>{if(!I)return Fn;let St=1;if(K===Ca&&(K=6),be<0?(St=0,be=-be):be>15&&(St=2,be-=16),Ee<1||Ee>ll||O!==fa||be<8||be>15||K<0||K>9||Fe<0||Fe>ci||be===8&&St!==1)return Xa(I,Fn);be===8&&(be=9);const ct=new wh;return I.state=ct,ct.strm=I,ct.status=$s,ct.wrap=St,ct.gzhead=null,ct.w_bits=be,ct.w_size=1<<ct.w_bits,ct.w_mask=ct.w_size-1,ct.hash_bits=Ee+7,ct.hash_size=1<<ct.hash_bits,ct.hash_mask=ct.hash_size-1,ct.hash_shift=~~((ct.hash_bits+On-1)/On),ct.window=new Uint8Array(ct.w_size*2),ct.head=new Uint16Array(ct.hash_size),ct.prev=new Uint16Array(ct.w_size),ct.lit_bufsize=1<<Ee+6,ct.pending_buf_size=ct.lit_bufsize*4,ct.pending_buf=new Uint8Array(ct.pending_buf_size),ct.sym_buf=ct.lit_bufsize,ct.sym_end=(ct.lit_bufsize-1)*3,ct.level=K,ct.strategy=Fe,ct.method=O,fd(I)},md=(I,K)=>rc(I,K,fa,cl,ul,Xs),Eh=(I,K)=>{if(zl(I)||K>Ei||K<0)return I?Xa(I,Fn):Fn;const O=I.state;if(!I.output||I.avail_in!==0&&!I.input||O.status===qa&&K!==xn)return Xa(I,I.avail_out===0?xi:Fn);const be=O.last_flush;if(O.last_flush=K,O.pending!==0){if(Dn(I),I.avail_out===0)return O.last_flush=-1,zn}else if(I.avail_in===0&&Tc(K)<=Tc(be)&&K!==xn)return Xa(I,xi);if(O.status===qa&&I.avail_in!==0)return Xa(I,xi);if(O.status===$s&&O.wrap===0&&(O.status=Na),O.status===$s){let Ee=fa+(O.w_bits-8<<4)<<8,Fe=-1;if(O.strategy>=ei||O.level<2?Fe=0:O.level<6?Fe=1:O.level===6?Fe=2:Fe=3,Ee|=Fe<<6,O.strstart!==0&&(Ee|=Tl),Ee+=31-Ee%31,pl(O,Ee),O.strstart!==0&&(pl(O,I.adler>>>16),pl(O,I.adler&65535)),I.adler=1,O.status=Na,Dn(I),O.pending!==0)return O.last_flush=-1,zn}if(O.status===hl){if(I.adler=0,ii(O,31),ii(O,139),ii(O,8),O.gzhead)ii(O,(O.gzhead.text?1:0)+(O.gzhead.hcrc?2:0)+(O.gzhead.extra?4:0)+(O.gzhead.name?8:0)+(O.gzhead.comment?16:0)),ii(O,O.gzhead.time&255),ii(O,O.gzhead.time>>8&255),ii(O,O.gzhead.time>>16&255),ii(O,O.gzhead.time>>24&255),ii(O,O.level===9?2:O.strategy>=ei||O.level<2?4:0),ii(O,O.gzhead.os&255),O.gzhead.extra&&O.gzhead.extra.length&&(ii(O,O.gzhead.extra.length&255),ii(O,O.gzhead.extra.length>>8&255)),O.gzhead.hcrc&&(I.adler=xt(I.adler,O.pending_buf,O.pending,0)),O.gzindex=0,O.status=ma;else if(ii(O,0),ii(O,0),ii(O,0),ii(O,0),ii(O,0),ii(O,O.level===9?2:O.strategy>=ei||O.level<2?4:0),ii(O,yu),O.status=Na,Dn(I),O.pending!==0)return O.last_flush=-1,zn}if(O.status===ma){if(O.gzhead.extra){let Ee=O.pending,Fe=(O.gzhead.extra.length&65535)-O.gzindex;for(;O.pending+Fe>O.pending_buf_size;){let ct=O.pending_buf_size-O.pending;if(O.pending_buf.set(O.gzhead.extra.subarray(O.gzindex,O.gzindex+ct),O.pending),O.pending=O.pending_buf_size,O.gzhead.hcrc&&O.pending>Ee&&(I.adler=xt(I.adler,O.pending_buf,O.pending-Ee,Ee)),O.gzindex+=ct,Dn(I),O.pending!==0)return O.last_flush=-1,zn;Ee=0,Fe-=ct}let St=new Uint8Array(O.gzhead.extra);O.pending_buf.set(St.subarray(O.gzindex,O.gzindex+Fe),O.pending),O.pending+=Fe,O.gzhead.hcrc&&O.pending>Ee&&(I.adler=xt(I.adler,O.pending_buf,O.pending-Ee,Ee)),O.gzindex=0}O.status=pu}if(O.status===pu){if(O.gzhead.name){let Ee=O.pending,Fe;do{if(O.pending===O.pending_buf_size){if(O.gzhead.hcrc&&O.pending>Ee&&(I.adler=xt(I.adler,O.pending_buf,O.pending-Ee,Ee)),Dn(I),O.pending!==0)return O.last_flush=-1,zn;Ee=0}O.gzindex<O.gzhead.name.length?Fe=O.gzhead.name.charCodeAt(O.gzindex++)&255:Fe=0,ii(O,Fe)}while(Fe!==0);O.gzhead.hcrc&&O.pending>Ee&&(I.adler=xt(I.adler,O.pending_buf,O.pending-Ee,Ee)),O.gzindex=0}O.status=mu}if(O.status===mu){if(O.gzhead.comment){let Ee=O.pending,Fe;do{if(O.pending===O.pending_buf_size){if(O.gzhead.hcrc&&O.pending>Ee&&(I.adler=xt(I.adler,O.pending_buf,O.pending-Ee,Ee)),Dn(I),O.pending!==0)return O.last_flush=-1,zn;Ee=0}O.gzindex<O.gzhead.comment.length?Fe=O.gzhead.comment.charCodeAt(O.gzindex++)&255:Fe=0,ii(O,Fe)}while(Fe!==0);O.gzhead.hcrc&&O.pending>Ee&&(I.adler=xt(I.adler,O.pending_buf,O.pending-Ee,Ee))}O.status=gu}if(O.status===gu){if(O.gzhead.hcrc){if(O.pending+2>O.pending_buf_size&&(Dn(I),O.pending!==0))return O.last_flush=-1,zn;ii(O,I.adler&255),ii(O,I.adler>>8&255),I.adler=0}if(O.status=Na,Dn(I),O.pending!==0)return O.last_flush=-1,zn}if(I.avail_in!==0||O.lookahead!==0||K!==Qr&&O.status!==qa){let Ee=O.level===0?Nc(O,K):O.strategy===ei?Qa(O,K):O.strategy===ai?Ja(O,K):Ga[O.level].func(O,K);if((Ee===fl||Ee===Ml)&&(O.status=qa),Ee===Ns||Ee===fl)return I.avail_out===0&&(O.last_flush=-1),zn;if(Ee===Ba&&(K===Xr?vt(O):K!==Ei&&(at(O,0,0,!1),K===Zr&&(_a(O.head),O.lookahead===0&&(O.strstart=0,O.block_start=0,O.insert=0))),Dn(I),I.avail_out===0))return O.last_flush=-1,zn}return K!==xn?zn:O.wrap<=0?Pn:(O.wrap===2?(ii(O,I.adler&255),ii(O,I.adler>>8&255),ii(O,I.adler>>16&255),ii(O,I.adler>>24&255),ii(O,I.total_in&255),ii(O,I.total_in>>8&255),ii(O,I.total_in>>16&255),ii(O,I.total_in>>24&255)):(pl(O,I.adler>>>16),pl(O,I.adler&65535)),Dn(I),O.wrap>0&&(O.wrap=-O.wrap),O.pending!==0?zn:Pn)},nc=I=>{if(zl(I))return Fn;const K=I.state.status;return I.state=null,K===Na?Xa(I,mi):zn},ic=(I,K)=>{let O=K.length;if(zl(I))return Fn;const be=I.state,Ee=be.wrap;if(Ee===2||Ee===1&&be.status!==$s||be.lookahead)return Fn;if(Ee===1&&(I.adler=et(I.adler,K,O,0)),be.wrap=0,O>=be.w_size){Ee===0&&(_a(be.head),be.strstart=0,be.block_start=0,be.insert=0);let Kr=new Uint8Array(be.w_size);Kr.set(K.subarray(O-be.w_size,O),0),K=Kr,O=be.w_size}const Fe=I.avail_in,St=I.next_in,ct=I.input;for(I.avail_in=O,I.next_in=0,I.input=K,ml(be);be.lookahead>=On;){let Kr=be.strstart,nt=be.lookahead-(On-1);do be.ins_h=za(be,be.ins_h,be.window[Kr+On-1]),be.prev[Kr&be.w_mask]=be.head[be.ins_h],be.head[be.ins_h]=Kr,Kr++;while(--nt);be.strstart=Kr,be.lookahead=On-1,ml(be)}return be.strstart+=be.lookahead,be.block_start=be.strstart,be.insert=be.lookahead,be.lookahead=0,be.match_length=be.prev_length=On-1,be.match_available=0,I.next_in=St,I.input=ct,I.avail_in=Fe,be.wrap=Ee,zn};var Pl=md,zc=rc,Sh=fd,Ch=Il,xu=pd,Ic=Eh,_u=nc,gd=ic,Ka="pako deflate (from Nodeca project)",gl={deflateInit:Pl,deflateInit2:zc,deflateReset:Sh,deflateResetKeep:Ch,deflateSetHeader:xu,deflate:Ic,deflateEnd:_u,deflateSetDictionary:gd,deflateInfo:Ka};const Pc=(I,K)=>Object.prototype.hasOwnProperty.call(I,K);var yd=function(I){const K=Array.prototype.slice.call(arguments,1);for(;K.length;){const O=K.shift();if(O){if(typeof O!="object")throw new TypeError(O+"must be non-object");for(const be in O)Pc(O,be)&&(I[be]=O[be])}}return I},Dc=I=>{let K=0;for(let be=0,Ee=I.length;be<Ee;be++)K+=I[be].length;const O=new Uint8Array(K);for(let be=0,Ee=0,Fe=I.length;be<Fe;be++){let St=I[be];O.set(St,Ee),Ee+=St.length}return O},yl={assign:yd,flattenChunks:Dc};let bu=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{bu=!1}const Ws=new Uint8Array(256);for(let I=0;I<256;I++)Ws[I]=I>=252?6:I>=248?5:I>=240?4:I>=224?3:I>=192?2:1;Ws[254]=Ws[254]=1;var Dl=I=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(I);let K,O,be,Ee,Fe,St=I.length,ct=0;for(Ee=0;Ee<St;Ee++)O=I.charCodeAt(Ee),(O&64512)===55296&&Ee+1<St&&(be=I.charCodeAt(Ee+1),(be&64512)===56320&&(O=65536+(O-55296<<10)+(be-56320),Ee++)),ct+=O<128?1:O<2048?2:O<65536?3:4;for(K=new Uint8Array(ct),Fe=0,Ee=0;Fe<ct;Ee++)O=I.charCodeAt(Ee),(O&64512)===55296&&Ee+1<St&&(be=I.charCodeAt(Ee+1),(be&64512)===56320&&(O=65536+(O-55296<<10)+(be-56320),Ee++)),O<128?K[Fe++]=O:O<2048?(K[Fe++]=192|O>>>6,K[Fe++]=128|O&63):O<65536?(K[Fe++]=224|O>>>12,K[Fe++]=128|O>>>6&63,K[Fe++]=128|O&63):(K[Fe++]=240|O>>>18,K[Fe++]=128|O>>>12&63,K[Fe++]=128|O>>>6&63,K[Fe++]=128|O&63);return K};const wu=(I,K)=>{if(K<65534&&I.subarray&&bu)return String.fromCharCode.apply(null,I.length===K?I:I.subarray(0,K));let O="";for(let be=0;be<K;be++)O+=String.fromCharCode(I[be]);return O};var sc=(I,K)=>{const O=K||I.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(I.subarray(0,K));let be,Ee;const Fe=new Array(O*2);for(Ee=0,be=0;be<O;){let St=I[be++];if(St<128){Fe[Ee++]=St;continue}let ct=Ws[St];if(ct>4){Fe[Ee++]=65533,be+=ct-1;continue}for(St&=ct===2?31:ct===3?15:7;ct>1&&be<O;)St=St<<6|I[be++]&63,ct--;if(ct>1){Fe[Ee++]=65533;continue}St<65536?Fe[Ee++]=St:(St-=65536,Fe[Ee++]=55296|St>>10&1023,Fe[Ee++]=56320|St&1023)}return wu(Fe,Ee)},Rh=(I,K)=>{K=K||I.length,K>I.length&&(K=I.length);let O=K-1;for(;O>=0&&(I[O]&192)===128;)O--;return O<0||O===0?K:O+Ws[I[O]]>K?O:K},vl={string2buf:Dl,buf2string:sc,utf8border:Rh};function Eu(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var jl=Eu;const oc=Object.prototype.toString,{Z_NO_FLUSH:vd,Z_SYNC_FLUSH:Ah,Z_FULL_FLUSH:kh,Z_FINISH:Th,Z_OK:Fl,Z_STREAM_END:Mh,Z_DEFAULT_COMPRESSION:Nh,Z_DEFAULT_STRATEGY:zh,Z_DEFLATED:Ih}=J;function ac(I){this.options=yl.assign({level:Nh,method:Ih,chunkSize:16384,windowBits:15,memLevel:8,strategy:zh},I||{});let K=this.options;K.raw&&K.windowBits>0?K.windowBits=-K.windowBits:K.gzip&&K.windowBits>0&&K.windowBits<16&&(K.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new jl,this.strm.avail_out=0;let O=gl.deflateInit2(this.strm,K.level,K.method,K.windowBits,K.memLevel,K.strategy);if(O!==Fl)throw new Error(Vr[O]);if(K.header&&gl.deflateSetHeader(this.strm,K.header),K.dictionary){let be;if(typeof K.dictionary=="string"?be=vl.string2buf(K.dictionary):oc.call(K.dictionary)==="[object ArrayBuffer]"?be=new Uint8Array(K.dictionary):be=K.dictionary,O=gl.deflateSetDictionary(this.strm,be),O!==Fl)throw new Error(Vr[O]);this._dict_set=!0}}ac.prototype.push=function(I,K){const O=this.strm,be=this.options.chunkSize;let Ee,Fe;if(this.ended)return!1;for(K===~~K?Fe=K:Fe=K===!0?Th:vd,typeof I=="string"?O.input=vl.string2buf(I):oc.call(I)==="[object ArrayBuffer]"?O.input=new Uint8Array(I):O.input=I,O.next_in=0,O.avail_in=O.input.length;;){if(O.avail_out===0&&(O.output=new Uint8Array(be),O.next_out=0,O.avail_out=be),(Fe===Ah||Fe===kh)&&O.avail_out<=6){this.onData(O.output.subarray(0,O.next_out)),O.avail_out=0;continue}if(Ee=gl.deflate(O,Fe),Ee===Mh)return O.next_out>0&&this.onData(O.output.subarray(0,O.next_out)),Ee=gl.deflateEnd(this.strm),this.onEnd(Ee),this.ended=!0,Ee===Fl;if(O.avail_out===0){this.onData(O.output);continue}if(Fe>0&&O.next_out>0){this.onData(O.output.subarray(0,O.next_out)),O.avail_out=0;continue}if(O.avail_in===0)break}return!0},ac.prototype.onData=function(I){this.chunks.push(I)},ac.prototype.onEnd=function(I){I===Fl&&(this.result=yl.flattenChunks(this.chunks)),this.chunks=[],this.err=I,this.msg=this.strm.msg};function jc(I,K){const O=new ac(K);if(O.push(I,!0),O.err)throw O.msg||Vr[O.err];return O.result}function Ph(I,K){return K=K||{},K.raw=!0,jc(I,K)}function Dh(I,K){return K=K||{},K.gzip=!0,jc(I,K)}var jh=ac,Fh=jc,Su=Ph,Oh=Dh,Lh={Deflate:jh,deflate:Fh,deflateRaw:Su,gzip:Oh};const Fc=16209,xd=16191;var Bh=function(I,K){let O,be,Ee,Fe,St,ct,Kr,nt,_t,Ln,Hr,Lr,pi,vi,ti,Cn,En,$r,Rn,ks,ni,Bn,li,An;const jn=I.state;O=I.next_in,li=I.input,be=O+(I.avail_in-5),Ee=I.next_out,An=I.output,Fe=Ee-(K-I.avail_out),St=Ee+(I.avail_out-257),ct=jn.dmax,Kr=jn.wsize,nt=jn.whave,_t=jn.wnext,Ln=jn.window,Hr=jn.hold,Lr=jn.bits,pi=jn.lencode,vi=jn.distcode,ti=(1<<jn.lenbits)-1,Cn=(1<<jn.distbits)-1;e:do{Lr<15&&(Hr+=li[O++]<<Lr,Lr+=8,Hr+=li[O++]<<Lr,Lr+=8),En=pi[Hr&ti];t:for(;;){if($r=En>>>24,Hr>>>=$r,Lr-=$r,$r=En>>>16&255,$r===0)An[Ee++]=En&65535;else if($r&16){Rn=En&65535,$r&=15,$r&&(Lr<$r&&(Hr+=li[O++]<<Lr,Lr+=8),Rn+=Hr&(1<<$r)-1,Hr>>>=$r,Lr-=$r),Lr<15&&(Hr+=li[O++]<<Lr,Lr+=8,Hr+=li[O++]<<Lr,Lr+=8),En=vi[Hr&Cn];r:for(;;){if($r=En>>>24,Hr>>>=$r,Lr-=$r,$r=En>>>16&255,$r&16){if(ks=En&65535,$r&=15,Lr<$r&&(Hr+=li[O++]<<Lr,Lr+=8,Lr<$r&&(Hr+=li[O++]<<Lr,Lr+=8)),ks+=Hr&(1<<$r)-1,ks>ct){I.msg="invalid distance too far back",jn.mode=Fc;break e}if(Hr>>>=$r,Lr-=$r,$r=Ee-Fe,ks>$r){if($r=ks-$r,$r>nt&&jn.sane){I.msg="invalid distance too far back",jn.mode=Fc;break e}if(ni=0,Bn=Ln,_t===0){if(ni+=Kr-$r,$r<Rn){Rn-=$r;do An[Ee++]=Ln[ni++];while(--$r);ni=Ee-ks,Bn=An}}else if(_t<$r){if(ni+=Kr+_t-$r,$r-=_t,$r<Rn){Rn-=$r;do An[Ee++]=Ln[ni++];while(--$r);if(ni=0,_t<Rn){$r=_t,Rn-=$r;do An[Ee++]=Ln[ni++];while(--$r);ni=Ee-ks,Bn=An}}}else if(ni+=_t-$r,$r<Rn){Rn-=$r;do An[Ee++]=Ln[ni++];while(--$r);ni=Ee-ks,Bn=An}for(;Rn>2;)An[Ee++]=Bn[ni++],An[Ee++]=Bn[ni++],An[Ee++]=Bn[ni++],Rn-=3;Rn&&(An[Ee++]=Bn[ni++],Rn>1&&(An[Ee++]=Bn[ni++]))}else{ni=Ee-ks;do An[Ee++]=An[ni++],An[Ee++]=An[ni++],An[Ee++]=An[ni++],Rn-=3;while(Rn>2);Rn&&(An[Ee++]=An[ni++],Rn>1&&(An[Ee++]=An[ni++]))}}else if($r&64){I.msg="invalid distance code",jn.mode=Fc;break e}else{En=vi[(En&65535)+(Hr&(1<<$r)-1)];continue r}break}}else if($r&64)if($r&32){jn.mode=xd;break e}else{I.msg="invalid literal/length code",jn.mode=Fc;break e}else{En=pi[(En&65535)+(Hr&(1<<$r)-1)];continue t}break}}while(O<be&&Ee<St);Rn=Lr>>3,O-=Rn,Lr-=Rn<<3,Hr&=(1<<Lr)-1,I.next_in=O,I.next_out=Ee,I.avail_in=O<be?5+(be-O):5-(O-be),I.avail_out=Ee<St?257+(St-Ee):257-(Ee-St),jn.hold=Hr,jn.bits=Lr};const Ol=15,_d=852,bd=592,wd=0,Cu=1,Ed=2,Ru=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lc=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Gh=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Sd=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Ll=(I,K,O,be,Ee,Fe,St,ct)=>{const Kr=ct.bits;let nt=0,_t=0,Ln=0,Hr=0,Lr=0,pi=0,vi=0,ti=0,Cn=0,En=0,$r,Rn,ks,ni,Bn,li=null,An;const jn=new Uint16Array(Ol+1),Qs=new Uint16Array(Ol+1);let ba=null,nu,iu,ca;for(nt=0;nt<=Ol;nt++)jn[nt]=0;for(_t=0;_t<be;_t++)jn[K[O+_t]]++;for(Lr=Kr,Hr=Ol;Hr>=1&&jn[Hr]===0;Hr--);if(Lr>Hr&&(Lr=Hr),Hr===0)return Ee[Fe++]=1<<24|64<<16|0,Ee[Fe++]=1<<24|64<<16|0,ct.bits=1,0;for(Ln=1;Ln<Hr&&jn[Ln]===0;Ln++);for(Lr<Ln&&(Lr=Ln),ti=1,nt=1;nt<=Ol;nt++)if(ti<<=1,ti-=jn[nt],ti<0)return-1;if(ti>0&&(I===wd||Hr!==1))return-1;for(Qs[1]=0,nt=1;nt<Ol;nt++)Qs[nt+1]=Qs[nt]+jn[nt];for(_t=0;_t<be;_t++)K[O+_t]!==0&&(St[Qs[K[O+_t]]++]=_t);if(I===wd?(li=ba=St,An=20):I===Cu?(li=Ru,ba=lc,An=257):(li=Gh,ba=Sd,An=0),En=0,_t=0,nt=Ln,Bn=Fe,pi=Lr,vi=0,ks=-1,Cn=1<<Lr,ni=Cn-1,I===Cu&&Cn>_d||I===Ed&&Cn>bd)return 1;for(;;){nu=nt-vi,St[_t]+1<An?(iu=0,ca=St[_t]):St[_t]>=An?(iu=ba[St[_t]-An],ca=li[St[_t]-An]):(iu=96,ca=0),$r=1<<nt-vi,Rn=1<<pi,Ln=Rn;do Rn-=$r,Ee[Bn+(En>>vi)+Rn]=nu<<24|iu<<16|ca|0;while(Rn!==0);for($r=1<<nt-1;En&$r;)$r>>=1;if($r!==0?(En&=$r-1,En+=$r):En=0,_t++,--jn[nt]===0){if(nt===Hr)break;nt=K[O+St[_t]]}if(nt>Lr&&(En&ni)!==ks){for(vi===0&&(vi=Lr),Bn+=Ln,pi=nt-vi,ti=1<<pi;pi+vi<Hr&&(ti-=jn[pi+vi],!(ti<=0));)pi++,ti<<=1;if(Cn+=1<<pi,I===Cu&&Cn>_d||I===Ed&&Cn>bd)return 1;ks=En&ni,Ee[ks]=Lr<<24|pi<<16|Bn-Fe|0}}return En!==0&&(Ee[Bn+En]=nt-vi<<24|64<<16|0),ct.bits=Lr,0};const Cd=0,ku=1,Tu=2,{Z_FINISH:xl,Z_BLOCK:Uh,Z_TREES:Oc,Z_OK:_l,Z_STREAM_END:Rd,Z_NEED_DICT:Ad,Z_STREAM_ERROR:ra,Z_DATA_ERROR:Bl,Z_MEM_ERROR:kd,Z_BUF_ERROR:Lc,Z_DEFLATED:Td}=J,uc=16180,Bc=16181,Gc=16182,Mu=16183,Nu=16184,zu=16185,Md=16186,Nd=16187,zd=16188,Id=16189,Uc=16190,Ls=16191,bl=16192,Iu=16193,Vc=16194,Pu=16195,Du=16196,$c=16197,Pd=16198,Wc=16199,Ua=16200,Hc=16201,Gl=16202,Yc=16203,ju=16204,dc=16205,el=16206,qc=16207,Fu=16208,ui=16209,Ou=16210,Lu=16211,Dd=852,jd=592,Fd=15,Bu=I=>(I>>>24&255)+(I>>>8&65280)+((I&65280)<<8)+((I&255)<<24);function tl(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Va=I=>{if(!I)return 1;const K=I.state;return!K||K.strm!==I||K.mode<uc||K.mode>Lu?1:0},Xc=I=>{if(Va(I))return ra;const K=I.state;return I.total_in=I.total_out=K.total=0,I.msg="",K.wrap&&(I.adler=K.wrap&1),K.mode=uc,K.last=0,K.havedict=0,K.flags=-1,K.dmax=32768,K.head=null,K.hold=0,K.bits=0,K.lencode=K.lendyn=new Int32Array(Dd),K.distcode=K.distdyn=new Int32Array(jd),K.sane=1,K.back=-1,_l},Od=I=>{if(Va(I))return ra;const K=I.state;return K.wsize=0,K.whave=0,K.wnext=0,Xc(I)},Ld=(I,K)=>{let O;if(Va(I))return ra;const be=I.state;return K<0?(O=0,K=-K):(O=(K>>4)+5,K<48&&(K&=15)),K&&(K<8||K>15)?ra:(be.window!==null&&be.wbits!==K&&(be.window=null),be.wrap=O,be.wbits=K,Od(I))},Ul=(I,K)=>{if(!I)return ra;const O=new tl;I.state=O,O.strm=I,O.window=null,O.mode=uc;const be=Ld(I,K);return be!==_l&&(I.state=null),be},Vh=I=>Ul(I,Fd);let Gu=!0,Jc,di;const Uu=I=>{if(Gu){Jc=new Int32Array(512),di=new Int32Array(32);let K=0;for(;K<144;)I.lens[K++]=8;for(;K<256;)I.lens[K++]=9;for(;K<280;)I.lens[K++]=7;for(;K<288;)I.lens[K++]=8;for(Ll(ku,I.lens,0,288,Jc,0,I.work,{bits:9}),K=0;K<32;)I.lens[K++]=5;Ll(Tu,I.lens,0,32,di,0,I.work,{bits:5}),Gu=!1}I.lencode=Jc,I.lenbits=9,I.distcode=di,I.distbits=5},hc=(I,K,O,be)=>{let Ee;const Fe=I.state;return Fe.window===null&&(Fe.wsize=1<<Fe.wbits,Fe.wnext=0,Fe.whave=0,Fe.window=new Uint8Array(Fe.wsize)),be>=Fe.wsize?(Fe.window.set(K.subarray(O-Fe.wsize,O),0),Fe.wnext=0,Fe.whave=Fe.wsize):(Ee=Fe.wsize-Fe.wnext,Ee>be&&(Ee=be),Fe.window.set(K.subarray(O-be,O-be+Ee),Fe.wnext),be-=Ee,be?(Fe.window.set(K.subarray(O-be,O),0),Fe.wnext=be,Fe.whave=Fe.wsize):(Fe.wnext+=Ee,Fe.wnext===Fe.wsize&&(Fe.wnext=0),Fe.whave<Fe.wsize&&(Fe.whave+=Ee))),0},fc=(I,K)=>{let O,be,Ee,Fe,St,ct,Kr,nt,_t,Ln,Hr,Lr,pi,vi,ti=0,Cn,En,$r,Rn,ks,ni,Bn,li;const An=new Uint8Array(4);let jn,Qs;const ba=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Va(I)||!I.output||!I.input&&I.avail_in!==0)return ra;O=I.state,O.mode===Ls&&(O.mode=bl),St=I.next_out,Ee=I.output,Kr=I.avail_out,Fe=I.next_in,be=I.input,ct=I.avail_in,nt=O.hold,_t=O.bits,Ln=ct,Hr=Kr,li=_l;e:for(;;)switch(O.mode){case uc:if(O.wrap===0){O.mode=bl;break}for(;_t<16;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}if(O.wrap&2&&nt===35615){O.wbits===0&&(O.wbits=15),O.check=0,An[0]=nt&255,An[1]=nt>>>8&255,O.check=xt(O.check,An,2,0),nt=0,_t=0,O.mode=Bc;break}if(O.head&&(O.head.done=!1),!(O.wrap&1)||(((nt&255)<<8)+(nt>>8))%31){I.msg="incorrect header check",O.mode=ui;break}if((nt&15)!==Td){I.msg="unknown compression method",O.mode=ui;break}if(nt>>>=4,_t-=4,Bn=(nt&15)+8,O.wbits===0&&(O.wbits=Bn),Bn>15||Bn>O.wbits){I.msg="invalid window size",O.mode=ui;break}O.dmax=1<<O.wbits,O.flags=0,I.adler=O.check=1,O.mode=nt&512?Id:Ls,nt=0,_t=0;break;case Bc:for(;_t<16;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}if(O.flags=nt,(O.flags&255)!==Td){I.msg="unknown compression method",O.mode=ui;break}if(O.flags&57344){I.msg="unknown header flags set",O.mode=ui;break}O.head&&(O.head.text=nt>>8&1),O.flags&512&&O.wrap&4&&(An[0]=nt&255,An[1]=nt>>>8&255,O.check=xt(O.check,An,2,0)),nt=0,_t=0,O.mode=Gc;case Gc:for(;_t<32;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}O.head&&(O.head.time=nt),O.flags&512&&O.wrap&4&&(An[0]=nt&255,An[1]=nt>>>8&255,An[2]=nt>>>16&255,An[3]=nt>>>24&255,O.check=xt(O.check,An,4,0)),nt=0,_t=0,O.mode=Mu;case Mu:for(;_t<16;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}O.head&&(O.head.xflags=nt&255,O.head.os=nt>>8),O.flags&512&&O.wrap&4&&(An[0]=nt&255,An[1]=nt>>>8&255,O.check=xt(O.check,An,2,0)),nt=0,_t=0,O.mode=Nu;case Nu:if(O.flags&1024){for(;_t<16;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}O.length=nt,O.head&&(O.head.extra_len=nt),O.flags&512&&O.wrap&4&&(An[0]=nt&255,An[1]=nt>>>8&255,O.check=xt(O.check,An,2,0)),nt=0,_t=0}else O.head&&(O.head.extra=null);O.mode=zu;case zu:if(O.flags&1024&&(Lr=O.length,Lr>ct&&(Lr=ct),Lr&&(O.head&&(Bn=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Uint8Array(O.head.extra_len)),O.head.extra.set(be.subarray(Fe,Fe+Lr),Bn)),O.flags&512&&O.wrap&4&&(O.check=xt(O.check,be,Lr,Fe)),ct-=Lr,Fe+=Lr,O.length-=Lr),O.length))break e;O.length=0,O.mode=Md;case Md:if(O.flags&2048){if(ct===0)break e;Lr=0;do Bn=be[Fe+Lr++],O.head&&Bn&&O.length<65536&&(O.head.name+=String.fromCharCode(Bn));while(Bn&&Lr<ct);if(O.flags&512&&O.wrap&4&&(O.check=xt(O.check,be,Lr,Fe)),ct-=Lr,Fe+=Lr,Bn)break e}else O.head&&(O.head.name=null);O.length=0,O.mode=Nd;case Nd:if(O.flags&4096){if(ct===0)break e;Lr=0;do Bn=be[Fe+Lr++],O.head&&Bn&&O.length<65536&&(O.head.comment+=String.fromCharCode(Bn));while(Bn&&Lr<ct);if(O.flags&512&&O.wrap&4&&(O.check=xt(O.check,be,Lr,Fe)),ct-=Lr,Fe+=Lr,Bn)break e}else O.head&&(O.head.comment=null);O.mode=zd;case zd:if(O.flags&512){for(;_t<16;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}if(O.wrap&4&&nt!==(O.check&65535)){I.msg="header crc mismatch",O.mode=ui;break}nt=0,_t=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),I.adler=O.check=0,O.mode=Ls;break;case Id:for(;_t<32;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}I.adler=O.check=Bu(nt),nt=0,_t=0,O.mode=Uc;case Uc:if(O.havedict===0)return I.next_out=St,I.avail_out=Kr,I.next_in=Fe,I.avail_in=ct,O.hold=nt,O.bits=_t,Ad;I.adler=O.check=1,O.mode=Ls;case Ls:if(K===Uh||K===Oc)break e;case bl:if(O.last){nt>>>=_t&7,_t-=_t&7,O.mode=el;break}for(;_t<3;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}switch(O.last=nt&1,nt>>>=1,_t-=1,nt&3){case 0:O.mode=Iu;break;case 1:if(Uu(O),O.mode=Wc,K===Oc){nt>>>=2,_t-=2;break e}break;case 2:O.mode=Du;break;case 3:I.msg="invalid block type",O.mode=ui}nt>>>=2,_t-=2;break;case Iu:for(nt>>>=_t&7,_t-=_t&7;_t<32;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}if((nt&65535)!==(nt>>>16^65535)){I.msg="invalid stored block lengths",O.mode=ui;break}if(O.length=nt&65535,nt=0,_t=0,O.mode=Vc,K===Oc)break e;case Vc:O.mode=Pu;case Pu:if(Lr=O.length,Lr){if(Lr>ct&&(Lr=ct),Lr>Kr&&(Lr=Kr),Lr===0)break e;Ee.set(be.subarray(Fe,Fe+Lr),St),ct-=Lr,Fe+=Lr,Kr-=Lr,St+=Lr,O.length-=Lr;break}O.mode=Ls;break;case Du:for(;_t<14;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}if(O.nlen=(nt&31)+257,nt>>>=5,_t-=5,O.ndist=(nt&31)+1,nt>>>=5,_t-=5,O.ncode=(nt&15)+4,nt>>>=4,_t-=4,O.nlen>286||O.ndist>30){I.msg="too many length or distance symbols",O.mode=ui;break}O.have=0,O.mode=$c;case $c:for(;O.have<O.ncode;){for(;_t<3;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}O.lens[ba[O.have++]]=nt&7,nt>>>=3,_t-=3}for(;O.have<19;)O.lens[ba[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,jn={bits:O.lenbits},li=Ll(Cd,O.lens,0,19,O.lencode,0,O.work,jn),O.lenbits=jn.bits,li){I.msg="invalid code lengths set",O.mode=ui;break}O.have=0,O.mode=Pd;case Pd:for(;O.have<O.nlen+O.ndist;){for(;ti=O.lencode[nt&(1<<O.lenbits)-1],Cn=ti>>>24,En=ti>>>16&255,$r=ti&65535,!(Cn<=_t);){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}if($r<16)nt>>>=Cn,_t-=Cn,O.lens[O.have++]=$r;else{if($r===16){for(Qs=Cn+2;_t<Qs;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}if(nt>>>=Cn,_t-=Cn,O.have===0){I.msg="invalid bit length repeat",O.mode=ui;break}Bn=O.lens[O.have-1],Lr=3+(nt&3),nt>>>=2,_t-=2}else if($r===17){for(Qs=Cn+3;_t<Qs;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}nt>>>=Cn,_t-=Cn,Bn=0,Lr=3+(nt&7),nt>>>=3,_t-=3}else{for(Qs=Cn+7;_t<Qs;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}nt>>>=Cn,_t-=Cn,Bn=0,Lr=11+(nt&127),nt>>>=7,_t-=7}if(O.have+Lr>O.nlen+O.ndist){I.msg="invalid bit length repeat",O.mode=ui;break}for(;Lr--;)O.lens[O.have++]=Bn}}if(O.mode===ui)break;if(O.lens[256]===0){I.msg="invalid code -- missing end-of-block",O.mode=ui;break}if(O.lenbits=9,jn={bits:O.lenbits},li=Ll(ku,O.lens,0,O.nlen,O.lencode,0,O.work,jn),O.lenbits=jn.bits,li){I.msg="invalid literal/lengths set",O.mode=ui;break}if(O.distbits=6,O.distcode=O.distdyn,jn={bits:O.distbits},li=Ll(Tu,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,jn),O.distbits=jn.bits,li){I.msg="invalid distances set",O.mode=ui;break}if(O.mode=Wc,K===Oc)break e;case Wc:O.mode=Ua;case Ua:if(ct>=6&&Kr>=258){I.next_out=St,I.avail_out=Kr,I.next_in=Fe,I.avail_in=ct,O.hold=nt,O.bits=_t,Bh(I,Hr),St=I.next_out,Ee=I.output,Kr=I.avail_out,Fe=I.next_in,be=I.input,ct=I.avail_in,nt=O.hold,_t=O.bits,O.mode===Ls&&(O.back=-1);break}for(O.back=0;ti=O.lencode[nt&(1<<O.lenbits)-1],Cn=ti>>>24,En=ti>>>16&255,$r=ti&65535,!(Cn<=_t);){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}if(En&&!(En&240)){for(Rn=Cn,ks=En,ni=$r;ti=O.lencode[ni+((nt&(1<<Rn+ks)-1)>>Rn)],Cn=ti>>>24,En=ti>>>16&255,$r=ti&65535,!(Rn+Cn<=_t);){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}nt>>>=Rn,_t-=Rn,O.back+=Rn}if(nt>>>=Cn,_t-=Cn,O.back+=Cn,O.length=$r,En===0){O.mode=dc;break}if(En&32){O.back=-1,O.mode=Ls;break}if(En&64){I.msg="invalid literal/length code",O.mode=ui;break}O.extra=En&15,O.mode=Hc;case Hc:if(O.extra){for(Qs=O.extra;_t<Qs;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}O.length+=nt&(1<<O.extra)-1,nt>>>=O.extra,_t-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=Gl;case Gl:for(;ti=O.distcode[nt&(1<<O.distbits)-1],Cn=ti>>>24,En=ti>>>16&255,$r=ti&65535,!(Cn<=_t);){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}if(!(En&240)){for(Rn=Cn,ks=En,ni=$r;ti=O.distcode[ni+((nt&(1<<Rn+ks)-1)>>Rn)],Cn=ti>>>24,En=ti>>>16&255,$r=ti&65535,!(Rn+Cn<=_t);){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}nt>>>=Rn,_t-=Rn,O.back+=Rn}if(nt>>>=Cn,_t-=Cn,O.back+=Cn,En&64){I.msg="invalid distance code",O.mode=ui;break}O.offset=$r,O.extra=En&15,O.mode=Yc;case Yc:if(O.extra){for(Qs=O.extra;_t<Qs;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}O.offset+=nt&(1<<O.extra)-1,nt>>>=O.extra,_t-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){I.msg="invalid distance too far back",O.mode=ui;break}O.mode=ju;case ju:if(Kr===0)break e;if(Lr=Hr-Kr,O.offset>Lr){if(Lr=O.offset-Lr,Lr>O.whave&&O.sane){I.msg="invalid distance too far back",O.mode=ui;break}Lr>O.wnext?(Lr-=O.wnext,pi=O.wsize-Lr):pi=O.wnext-Lr,Lr>O.length&&(Lr=O.length),vi=O.window}else vi=Ee,pi=St-O.offset,Lr=O.length;Lr>Kr&&(Lr=Kr),Kr-=Lr,O.length-=Lr;do Ee[St++]=vi[pi++];while(--Lr);O.length===0&&(O.mode=Ua);break;case dc:if(Kr===0)break e;Ee[St++]=O.length,Kr--,O.mode=Ua;break;case el:if(O.wrap){for(;_t<32;){if(ct===0)break e;ct--,nt|=be[Fe++]<<_t,_t+=8}if(Hr-=Kr,I.total_out+=Hr,O.total+=Hr,O.wrap&4&&Hr&&(I.adler=O.check=O.flags?xt(O.check,Ee,Hr,St-Hr):et(O.check,Ee,Hr,St-Hr)),Hr=Kr,O.wrap&4&&(O.flags?nt:Bu(nt))!==O.check){I.msg="incorrect data check",O.mode=ui;break}nt=0,_t=0}O.mode=qc;case qc:if(O.wrap&&O.flags){for(;_t<32;){if(ct===0)break e;ct--,nt+=be[Fe++]<<_t,_t+=8}if(O.wrap&4&&nt!==(O.total&4294967295)){I.msg="incorrect length check",O.mode=ui;break}nt=0,_t=0}O.mode=Fu;case Fu:li=Rd;break e;case ui:li=Bl;break e;case Ou:return kd;case Lu:default:return ra}return I.next_out=St,I.avail_out=Kr,I.next_in=Fe,I.avail_in=ct,O.hold=nt,O.bits=_t,(O.wsize||Hr!==I.avail_out&&O.mode<ui&&(O.mode<el||K!==xl))&&hc(I,I.output,I.next_out,Hr-I.avail_out),Ln-=I.avail_in,Hr-=I.avail_out,I.total_in+=Ln,I.total_out+=Hr,O.total+=Hr,O.wrap&4&&Hr&&(I.adler=O.check=O.flags?xt(O.check,Ee,Hr,I.next_out-Hr):et(O.check,Ee,Hr,I.next_out-Hr)),I.data_type=O.bits+(O.last?64:0)+(O.mode===Ls?128:0)+(O.mode===Wc||O.mode===Vc?256:0),(Ln===0&&Hr===0||K===xl)&&li===_l&&(li=Lc),li},Bd=I=>{if(Va(I))return ra;let K=I.state;return K.window&&(K.window=null),I.state=null,_l},Vu=(I,K)=>{if(Va(I))return ra;const O=I.state;return O.wrap&2?(O.head=K,K.done=!1,_l):ra},pc=(I,K)=>{const O=K.length;let be,Ee,Fe;return Va(I)||(be=I.state,be.wrap!==0&&be.mode!==Uc)?ra:be.mode===Uc&&(Ee=1,Ee=et(Ee,K,O,0),Ee!==be.check)?Bl:(Fe=hc(I,K,O,O),Fe?(be.mode=Ou,kd):(be.havedict=1,_l))};var Qc=Od,Vl=Ld,Gd=Xc,$h=Vh,Wh=Ul,Ud=fc,Zc=Bd,Kc=Vu,$u=pc,Wu="pako inflate (from Nodeca project)",ka={inflateReset:Qc,inflateReset2:Vl,inflateResetKeep:Gd,inflateInit:$h,inflateInit2:Wh,inflate:Ud,inflateEnd:Zc,inflateGetHeader:Kc,inflateSetDictionary:$u,inflateInfo:Wu};function Hu(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Hh=Hu;const Yu=Object.prototype.toString,{Z_NO_FLUSH:Yh,Z_FINISH:qh,Z_OK:wl,Z_STREAM_END:Ia,Z_NEED_DICT:eu,Z_STREAM_ERROR:$l,Z_DATA_ERROR:Ta,Z_MEM_ERROR:mc}=J;function ya(I){this.options=yl.assign({chunkSize:65536,windowBits:15,to:""},I||{});const K=this.options;K.raw&&K.windowBits>=0&&K.windowBits<16&&(K.windowBits=-K.windowBits,K.windowBits===0&&(K.windowBits=-15)),K.windowBits>=0&&K.windowBits<16&&!(I&&I.windowBits)&&(K.windowBits+=32),K.windowBits>15&&K.windowBits<48&&(K.windowBits&15||(K.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new jl,this.strm.avail_out=0;let O=ka.inflateInit2(this.strm,K.windowBits);if(O!==wl)throw new Error(Vr[O]);if(this.header=new Hh,ka.inflateGetHeader(this.strm,this.header),K.dictionary&&(typeof K.dictionary=="string"?K.dictionary=vl.string2buf(K.dictionary):Yu.call(K.dictionary)==="[object ArrayBuffer]"&&(K.dictionary=new Uint8Array(K.dictionary)),K.raw&&(O=ka.inflateSetDictionary(this.strm,K.dictionary),O!==wl)))throw new Error(Vr[O])}ya.prototype.push=function(I,K){const O=this.strm,be=this.options.chunkSize,Ee=this.options.dictionary;let Fe,St,ct;if(this.ended)return!1;for(K===~~K?St=K:St=K===!0?qh:Yh,Yu.call(I)==="[object ArrayBuffer]"?O.input=new Uint8Array(I):O.input=I,O.next_in=0,O.avail_in=O.input.length;;){for(O.avail_out===0&&(O.output=new Uint8Array(be),O.next_out=0,O.avail_out=be),Fe=ka.inflate(O,St),Fe===eu&&Ee&&(Fe=ka.inflateSetDictionary(O,Ee),Fe===wl?Fe=ka.inflate(O,St):Fe===Ta&&(Fe=eu));O.avail_in>0&&Fe===Ia&&O.state.wrap>0&&I[O.next_in]!==0;)ka.inflateReset(O),Fe=ka.inflate(O,St);switch(Fe){case $l:case Ta:case eu:case mc:return this.onEnd(Fe),this.ended=!0,!1}if(ct=O.avail_out,O.next_out&&(O.avail_out===0||Fe===Ia))if(this.options.to==="string"){let Kr=vl.utf8border(O.output,O.next_out),nt=O.next_out-Kr,_t=vl.buf2string(O.output,Kr);O.next_out=nt,O.avail_out=be-nt,nt&&O.output.set(O.output.subarray(Kr,Kr+nt),0),this.onData(_t)}else this.onData(O.output.length===O.next_out?O.output:O.output.subarray(0,O.next_out));if(!(Fe===wl&&ct===0)){if(Fe===Ia)return Fe=ka.inflateEnd(this.strm),this.onEnd(Fe),this.ended=!0,!0;if(O.avail_in===0)break}}return!0},ya.prototype.onData=function(I){this.chunks.push(I)},ya.prototype.onEnd=function(I){I===wl&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=yl.flattenChunks(this.chunks)),this.chunks=[],this.err=I,this.msg=this.strm.msg};function gc(I,K){const O=new ya(K);if(O.push(I),O.err)throw O.msg||Vr[O.err];return O.result}function Xh(I,K){return K=K||{},K.raw=!0,gc(I,K)}var Jh=ya,El=gc,yc=Xh,Wl=gc,tu={Inflate:Jh,inflate:El,inflateRaw:yc,ungzip:Wl};const{Deflate:qu,deflate:Hl,deflateRaw:rl,gzip:gi}=Lh,{Inflate:fi,inflate:nl,inflateRaw:Js,ungzip:la}=tu;var il=qu,Sl=Hl,na=rl,vc=gi,Xu=fi,Ju=nl,xc=Js,Qu=la,Pa=J,ru={Deflate:il,deflate:Sl,deflateRaw:na,gzip:vc,Inflate:Xu,inflate:Ju,inflateRaw:xc,ungzip:Qu,constants:Pa}})},__webpack_module_cache__={};function __webpack_require__(e){var r=__webpack_module_cache__[e];if(r!==void 0)return r.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(t.exports,t,t.exports,__webpack_require__),t.exports}__webpack_require__.n=e=>{var r=e&&e.__esModule?(()=>e.default):(()=>e);return __webpack_require__.d(r,{a:r}),r},__webpack_require__.d=(e,r)=>{for(var t in r)__webpack_require__.o(r,t)&&!__webpack_require__.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},__webpack_require__.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),__webpack_require__.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__("./src/index.ts"),__webpack_require__("./src/SurfaceWorker.js");var __webpack_exports__=__webpack_require__("./src/exporter.js");return __webpack_exports__})())})(_3Dmol);var _3DmolExports=_3Dmol.exports;const covalentRadii={H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.61,Fe:1.52,Co:1.5,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,Pd:1.39,Ag:1.45,Cd:1.44,In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.75,Hf:1.87,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69};function mod(e,r){return(e%r+r)%r}function setCustomBondLengths(){function e(r,t){_3DmolExports.setBondLength(r,t)}Object.keys(covalentRadii).forEach(r=>{e(r,1.05*covalentRadii[r])})}class Visualizer3dmol extends React.Component{constructor(r){super(r),setCustomBondLengths(),this.viewer=null,this.model=null,this.divId="gldiv-"+(Math.random()+1).toString(36).substring(7)}componentDidMount(){let r={backgroundColor:"white",orthographic:!0};this.viewer=_3DmolExports.createViewer(this.divId,r),this.updateView()}componentDidUpdate(r){(r.viewerParams!=this.props.viewerParams||r.cifText!=this.props.cifText)&&this.updateView()}custom3dmolSetup(){if(this.model=this.viewer.addModel(),this.props.cifText){let r=_3DmolExports.Parsers.CIF(this.props.cifText),t=r[0],o=r.modelData[0].cryst;this.model.setCrystData(o.a,o.b,o.c,o.alpha,o.beta,o.gamma);let c=this.model.modelData.cryst.matrix,u=new _3DmolExports.Matrix3().getInverse3(c),y=[],f=[];t.forEach(p=>{let S=new _3DmolExports.Vector3(p.x,p.y,p.z);if(this.props.viewerParams.packedCell){let A=S.clone().applyMatrix3(u);S=new _3DmolExports.Vector3(mod(A.x,1),mod(A.y,1),mod(A.z,1)).applyMatrix3(c)}f.push({elem:p.elem,x:S.x,y:S.y,z:S.z})});let g=.03,_=this.props.viewerParams.supercell;for(let p=-1;p<_[0]+1;p++)for(let S=-1;S<_[1]+1;S++)for(let A=-1;A<_[2]+1;A++){let R=new _3DmolExports.Vector3(p,S,A);if(R.applyMatrix3(c),p==-1||p==_[0]||S==-1||S==_[1]||A==-1||A==_[2])if(this.props.viewerParams.packedCell)f.forEach(z=>{let l=new _3DmolExports.Vector3(z.x,z.y,z.z);l.add(R);let s=l.clone().applyMatrix3(u);s.x>-g&&s.x<_[0]+g&&s.y>-g&&s.y<_[1]+g&&s.z>-g&&s.z<_[2]+g&&y.push({elem:z.elem,x:l.x,y:l.y,z:l.z})});else continue;else f.forEach(z=>{y.push({elem:z.elem,x:z.x+R.x,y:z.y+R.y,z:z.z+R.z})})}this.model.addAtoms(y)}}updateView(){this.viewer.removeAllModels(),this.custom3dmolSetup();let r={sphere:{scale:.3,colorscheme:"Jmol"}};this.props.viewerParams.vdwRadius&&(r.sphere.scale=1),this.props.viewerParams.bonds&&(r.stick={radius:.15,colorscheme:"Jmol"}),this.viewer.setStyle(r),this.viewer.addUnitCell(this.model),this.model.assignBonds(),this.viewer.removeAllLabels(),this.props.viewerParams.atomLabels&&this.model.atoms.forEach(t=>{this.viewer.addLabel(t.elem,{position:{x:t.x,y:t.y,z:t.z},fontColor:"black",bold:!0,fontSize:18,showBackground:!1,backgroundOpacity:1,inFront:!0},null,!0)}),this.viewer.zoomTo(),this.viewer.zoom(1.4),this.viewer.render()}handleEvent(r,t){r=="camera"&&(t=="x"&&this.viewer.setView([0,0,0,0,-.5,-.5,-.5,.5]),t=="y"&&this.viewer.setView([0,0,0,0,.5,.5,.5,.5]),t=="z"&&this.viewer.setView([0,0,0,0,0,0,0,1]),this.viewer.zoomTo(),this.viewer.zoom(1.4))}render(){return jsxRuntimeExports.jsx("div",{id:this.divId,className:"gldiv",children:"No data!"})}}class StructureWindow extends React.Component{constructor(r){super(r)}render(){let r="structure-window";this.props.mouseEnabled||(r+=" disable-mouse");let t="Click to interact",o="mouse-disabled-note";return this.props.mouseEnabled&&(o="mouse-disabled-note on"),jsxRuntimeExports.jsxs("div",{className:"structure-window-outer",children:[jsxRuntimeExports.jsx("div",{className:"structure-window-click-handler",onClick:()=>this.props.setMouseEnabledState(!0),children:jsxRuntimeExports.jsx("div",{className:r,children:jsxRuntimeExports.jsx(Visualizer3dmol,{ref:this.props.visualizerRef,viewerParams:this.props.viewerParams,cifText:this.props.cifText})})}),jsxRuntimeExports.jsx("div",{className:o,onClick:()=>this.props.setMouseEnabledState(!this.props.mouseEnabled),children:t})]})}}const StructureVisualizer=e=>{const[r,t]=reactExports.useState({supercell:e.initSupercell||[2,2,2],bonds:!0,packedCell:!0,atomLabels:!1,vdwRadius:!1}),[o,c]=reactExports.useState(!1),u=reactExports.useRef(null),y=reactExports.useRef(null);reactExports.useEffect(()=>{const p=S=>{y&&!y.current.contains(S.target)&&c(!1)};return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)}},[]);const f=p=>{c(p)},g=(p,S)=>{t(A=>({...A,[p]:S}))},_=(p,S)=>{u.current.handleEvent(p,S)};return jsxRuntimeExports.jsxs("div",{ref:y,className:"structure-visualizer",children:[jsxRuntimeExports.jsx(StructureWindow,{visualizerRef:u,viewerParams:r,cifText:e.cifText,mouseEnabled:o,setMouseEnabledState:f}),jsxRuntimeExports.jsx(ControlBox,{viewerParams:r,onViewerParamChange:g,onViewerEvent:_})]})};function getVol(e,r=4){const t=(u,y)=>[u[1]*y[2]-u[2]*y[1],u[2]*y[0]-u[0]*y[2],u[0]*y[1]-u[1]*y[0]],o=e.attributes.cell,c=Math.abs(o[0].reduce((u,y,f)=>u+y*t(o[1],o[2])[f],0));return parseFloat(c.toFixed(r))}function formatLattice(e){const r=e.attributes.cell,t=Math.hypot(...r[0]),o=Math.hypot(...r[1]),c=Math.hypot(...r[2]);return{a:t,b:o,c}}function StructureVisualiser({nodeData:e,baseUrl:r}){const t=e.download.cifText,o=e.label==="CifData"?[{format:"cif",label:"CIF"}]:[{format:"cif",label:"CIF"},{format:"xsf",label:"XSF"},{format:"xyz",label:"XYZ"}],c=e.derived_properties&&Object.keys(e.derived_properties).length>0,u=e.attributes?.cell?formatLattice(e):null,y=c?e.derived_properties.dimensionality?.value:u?getVol(e):null,f=e.attributes?.sites?.length||0;return jsxRuntimeExports$1.jsxs("div",{className:"p-4",children:[c&&jsxRuntimeExports$1.jsxs("div",{className:"p grid grid-cols-2 gap-4",children:[jsxRuntimeExports$1.jsxs("div",{className:"bg-gray-100 px-2 py-2 rounded shadow-sm",children:[jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Cell Volume:"})," ",y?.toFixed(4)," Å³"]}),jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Formula:"})," ",e.derived_properties.formula]}),jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Dimensionality:"})," ",e.derived_properties.dimensionality?.description||"N/A"]})]}),u&&jsxRuntimeExports$1.jsxs("div",{className:"bg-gray-100 px-2 py-2 rounded shadow-sm",children:[jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Lattice a:"})," ",u.a.toFixed(4)," Å"]}),jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Lattice b:"})," ",u.b.toFixed(4)," Å"]}),jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Lattice c:"})," ",u.c.toFixed(4)," Å"]}),jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Number of Sites:"})," ",f]})]})]}),jsxRuntimeExports$1.jsxs("div",{className:"w-full h-[500px] pt-4 relative",children:[jsxRuntimeExports$1.jsx("div",{className:"absolute top-8 right-8 z-50",children:jsxRuntimeExports$1.jsx(Au,{aiida_rest_url:r,uuid:e.aiida.uuid,download_formats:o})}),jsxRuntimeExports$1.jsx("div",{className:"w-full h-full relative overflow-hidden",children:jsxRuntimeExports$1.jsx(StructureVisualizer,{cifText:t,initSupercell:[2,2,2]})})]})]})}function FormattedMetaData({nodeData:e,userData:r}){const t=r?.users||[],o=e?.aiida;if(!o)return jsxRuntimeExports$1.jsx("div",{className:"p-4 text-gray-500 italic",children:"No metadata available"});const c=Array.isArray(t)?t.find(u=>u.id===o.user_id):null;return jsxRuntimeExports$1.jsxs("div",{className:"",children:[jsxRuntimeExports$1.jsx("h2",{className:"text-lg font-semibold pb-2",children:e.label||""}),jsxRuntimeExports$1.jsxs("div",{className:"space-y-1 text-sm",children:[o.uuid&&jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("span",{className:"font-medium",children:"UUID:"})," ",o.uuid]}),o.ctime&&jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("span",{className:"font-medium",children:"Created:"})," ",o.ctime]}),o.mtime&&jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("span",{className:"font-medium",children:"Modified:"})," ",o.mtime]}),o.node_type&&jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("span",{className:"font-medium",children:"Node Type:"})," ",o.node_type]}),c&&jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("span",{className:"font-medium",children:"Owner:"})," ",c.first_name," ",c.last_name||"",c.institution&&jsxRuntimeExports$1.jsxs("span",{className:"text-gray-500",children:[" (",c.institution,")"]})]})]})]})}function VisualiserPane({baseUrl:e,selectedNode:r,userData:t}){const[o,c]=reactExports.useState("rich"),u=(()=>{if(!r)return null;const{label:f,aiida:g}=r.data;switch(f){case"StructureData":case"CifData":return jsxRuntimeExports$1.jsx(StructureVisualiser,{nodeData:r.data},g?.uuid);case"KpointsData":return jsxRuntimeExports$1.jsx(KpointsDataVisualiser,{nodeData:r.data},g?.uuid);case"UpfData":return jsxRuntimeExports$1.jsx(UpfDataVisualiser,{nodeData:r.data,baseUrl:e},g?.uuid);case"FolderData":return jsxRuntimeExports$1.jsx(FolderDataVisualiser,{nodeData:r.data},g?.uuid);case"CalcJobNode":return jsxRuntimeExports$1.jsx(CalcJobVisualiser,{nodeData:r.data},g?.uuid);default:return null}})();if(reactExports.useEffect(()=>{u||c("raw")},[u]),!r)return jsxRuntimeExports$1.jsx("div",{className:"w-full h-full p-4",children:jsxRuntimeExports$1.jsx("p",{children:"Click a node to see top level details. Double click to traverse the graph."})});const y=!u;return jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full flex flex-col overflow-hidden",children:[jsxRuntimeExports$1.jsx("div",{className:"p-4 border-b bg-slate-50",children:jsxRuntimeExports$1.jsx(FormattedMetaData,{nodeData:r.data,userData:t})}),jsxRuntimeExports$1.jsxs("div",{className:"flex border-b bg-gray-100",children:[jsxRuntimeExports$1.jsx("button",{disabled:y,className:`px-4 py-2 ${o==="rich"?"border-b-2 border-blue-500 font-semibold":y?"text-gray-400 cursor-not-allowed":""}`,onClick:()=>!y&&c("rich"),children:"Rich View"}),jsxRuntimeExports$1.jsx("button",{className:`px-4 py-2 ${o==="raw"?"border-b-2 border-blue-500 font-semibold":""}`,onClick:()=>c("raw"),children:"Raw View"})]}),jsxRuntimeExports$1.jsxs("div",{className:"flex-1 overflow-auto",children:[o==="rich"&&u,o==="raw"&&jsxRuntimeExports$1.jsx(RawDataVisualiser,{nodeData:r.data})]})]})}function Breadcrumbs({trail:e,onClick:r,maxItems:t=10}){const o=e.slice(-t);return jsxRuntimeExports$1.jsxs("div",{className:"w-full border-t border-gray-300 p-2 flex gap-2 flex-wrap overflow-x-auto items-center",children:[jsxRuntimeExports$1.jsx("span",{className:"",children:"History:"}),o.map((c,u)=>jsxRuntimeExports$1.jsxs(React.Fragment,{children:[jsxRuntimeExports$1.jsxs("button",{className:"bg-gray-200 hover:bg-gray-300 text-sm px-2 py-1 rounded",onClick:()=>r(c,u),children:[c.data.label," (",c.data.aiida.uuid.split("-")[0],")"]}),u<o.length-1&&jsxRuntimeExports$1.jsx("span",{className:"mx-1",children:"→"})]},`${c.id}-${u}`))]})}function Explorer({baseUrl:e="",startingNode:r="",debugMode:t=!0}){const o=reactExports.useRef(null),[c,u]=reactExports.useState(!1),[y,f]=reactExports.useState(null),[g,_]=reactExports.useState(null);reactExports.useEffect(()=>{let U=!0;return fetchUsers(e).then(Y=>{U&&(f(Y),t&&console.log("users",Y))}),()=>{U=!1}},[e]),reactExports.useEffect(()=>{let U=!0;return fetchDownloadFormats(e).then(Y=>{U&&(_(Y),t&&console.log("downloadFormats",Y))}),()=>{U=!1}},[e]);const[p,S]=reactExports.useState([]),[A,R]=reactExports.useState([]),[z,l]=reactExports.useState([]),s=10,[v,w]=useSearchParams(),E=v.get("rootNode")||r,[C,h]=reactExports.useState(E),[x,k]=reactExports.useState(null),[M,D]=reactExports.useState({}),[P,F]=reactExports.useState(()=>E===""?"groupsview":null);reactExports.useEffect(()=>{let U=!0;async function Y(){const{nodes:W,edges:q}=await fetchGraphByNodeId(e,C,c);if(!U)return;const G=W.map($=>{const{pos:Z,...xe}=M[$.id]||{};return{...$,data:{...$.data,...xe}}});S(G),R(q),S(G),requestAnimationFrame(()=>{const $=o.current;if(!$)return;$.fitView({padding:1.5});const Z=G.find(xe=>xe.id===C);Z?.position&&setTimeout(()=>{$.setCenter(Z.position.x+50,Z.position.y,{zoom:1.22,duration:1e3})},150)})}return Y(),()=>{U=!1}},[C]);const X=async U=>{const Y=await smartFetchData(e,U,M);return D(W=>({...W,[U.id]:{...W[U.id]||{},...Y.data}})),Y},B=async U=>{const Y=await X(U);k(Y),S(W=>W.map(q=>q.id===U.id?{...q,data:{...q.data,...Y.data}}:q))},L=async U=>{z[z.length-1]?.id!==U.id&&l(W=>[...W,U].slice(-s)),h(U.id),w({rootNode:U.id});const Y=await X(U);k(Y)},H=async(U,Y)=>{l(q=>q.slice(0,Y+1)),h(U.id),w({rootNode:U.id});const W=await X(U);k(W)};return jsxRuntimeExports$1.jsxs("div",{className:"flex flex-col h-screen relative",children:[jsxRuntimeExports$1.jsx("div",{className:`fixed inset-0 z-40 flex items-center justify-center bg-black/30
      transition-all duration-500 ease-in-out
      ${P?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>F(null),children:jsxRuntimeExports$1.jsxs("div",{className:`bg-white w-full mx-4 h-5/6 rounded-xl shadow-xl overflow-auto relative
        transform transition-all duration-500 ease-in-out
        ${P?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:U=>U.stopPropagation(),children:[jsxRuntimeExports$1.jsx("button",{className:"absolute top-3 right-3 p-2",onClick:()=>F(null),children:jsxRuntimeExports$1.jsx(XIcon,{size:24,className:"text-slate-800 hover:text-red-800 transition-colors duration-400"})}),P==="groupsview"&&jsxRuntimeExports$1.jsx(GroupsViewer2,{baseUrl:e}),P==="typesview"&&jsxRuntimeExports$1.jsx(GridViewer,{baseUrl:e}),P==="helpview"&&jsxRuntimeExports$1.jsx(HelpViewer,{})]})}),jsxRuntimeExports$1.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex-1 w-1/2 border-r border-gray-300 h-full relative flex flex-col",children:[!P&&jsxRuntimeExports$1.jsxs("div",{className:"absolute top-4 left-4 right-4 z-50 flex justify-between items-center pointer-events-auto",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports$1.jsxs("button",{className:"group px-3 py-2 rounded-md bg-opacity-70 bg-white shadow-md text-blue-600 text-md flex items-center gap-1 hover:text-blue-800",onClick:()=>F("groupsview"),children:[jsxRuntimeExports$1.jsx(GroupIcon,{size:24,className:"text-blue-600 group-hover:text-blue-800 transition-colors"}),jsxRuntimeExports$1.jsx("span",{className:"transition-colors",children:"Query database"})]}),jsxRuntimeExports$1.jsxs("button",{className:"group px-3 py-2 rounded-md bg-opacity-70 bg-white shadow-md text-blue-600 text-md flex items-center gap-1 hover:text-blue-800",onClick:async()=>{if(!(!p||p.length===0))if(c===!0){const U=await fetchLinkCountsFirstPage(e,p);S(U)}else{const U=await fetchLinkCounts(e,p);S(U)}},children:[jsxRuntimeExports$1.jsx(LinksIcon,{size:18,className:"text-blue-600 group-hover:text-blue-800 transition-colors"}),jsxRuntimeExports$1.jsx("span",{className:"transition-colors",children:"Get link counts"})]})]}),jsxRuntimeExports$1.jsxs("button",{className:"group px-3 py-2 rounded-md bg-white shadow-md text-blue-600 text-md flex items-center gap-1 hover:text-blue-800",onClick:()=>F("helpview"),children:[jsxRuntimeExports$1.jsx(QuestionIcon,{size:18,className:"text-blue-600 group-hover:text-blue-800 transition-colors"}),jsxRuntimeExports$1.jsx("span",{className:"transition-colors",children:"Help"})]})]}),jsxRuntimeExports$1.jsx(FlowChart,{className:"flex-1",nodes:p,edges:A,setNodes:S,setEdges:R,selectedNode:x,onNodeSelect:B,onNodeDoubleSelect:L,onInit:U=>{o.current=U}})]}),jsxRuntimeExports$1.jsxs("div",{className:"w-1/2 flex flex-col h-full",children:[t&&jsxRuntimeExports$1.jsx("div",{className:"flex h-1/4 border-b border-gray-300 overflow-y-auto",children:jsxRuntimeExports$1.jsx(DebugPane,{selectedNode:x})}),jsxRuntimeExports$1.jsx("div",{className:"flex-1 overflow-y-auto",children:jsxRuntimeExports$1.jsx(VisualiserPane,{baseUrl:e,selectedNode:x,userData:y})})]})]}),jsxRuntimeExports$1.jsx("div",{className:"flex-none h-12 border-t border-gray-300",children:jsxRuntimeExports$1.jsx(Breadcrumbs,{trail:z,onClick:H,maxItems:s})})]})}function App(){return jsxRuntimeExports$1.jsx(Explorer,{baseUrl:"https://aiida.materialscloud.org/mc3d-pbe-v1/api/v4"})}ReactDOM$1.createRoot(document.getElementById("root")).render(jsxRuntimeExports$1.jsx(React.StrictMode,{children:jsxRuntimeExports$1.jsx(BrowserRouter,{children:jsxRuntimeExports$1.jsx(App,{})})}));
