(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const h of c)if(h.type==="childList")for(const v of h.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&o(v)}).observe(document,{childList:!0,subtree:!0});function t(c){const h={};return c.integrity&&(h.integrity=c.integrity),c.referrerPolicy&&(h.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?h.credentials="include":c.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(c){if(c.ep)return;c.ep=!0;const h=t(c);fetch(c.href,h)}})();function getDefaultExportFromCjs(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var jsxRuntime$1={exports:{}},reactJsxRuntime_production_min$1={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),h=Symbol.for("react.provider"),v=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),b=Symbol.iterator;function C(O){return O===null||typeof O!="object"?null:(O=b&&O[b]||O["@@iterator"],typeof O=="function"?O:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,l={};function s(O,j,J){this.props=O,this.context=j,this.refs=l,this.updater=J||S}s.prototype.isReactComponent={},s.prototype.setState=function(O,j){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,j,"setState")},s.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function y(){}y.prototype=s.prototype;function A(O,j,J){this.props=O,this.context=j,this.refs=l,this.updater=J||S}var E=A.prototype=new y;E.constructor=A,k(E,s.prototype),E.isPureReactComponent=!0;var T=Array.isArray,u=Object.prototype.hasOwnProperty,_={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function R(O,j,J){var oe,ie={},he=null,de=null;if(j!=null)for(oe in j.ref!==void 0&&(de=j.ref),j.key!==void 0&&(he=""+j.key),j)u.call(j,oe)&&!M.hasOwnProperty(oe)&&(ie[oe]=j[oe]);var fe=arguments.length-2;if(fe===1)ie.children=J;else if(1<fe){for(var ue=Array(fe),ye=0;ye<fe;ye++)ue[ye]=arguments[ye+2];ie.children=ue}if(O&&O.defaultProps)for(oe in fe=O.defaultProps,fe)ie[oe]===void 0&&(ie[oe]=fe[oe]);return{$$typeof:r,type:O,key:he,ref:de,props:ie,_owner:_.current}}function N(O,j){return{$$typeof:r,type:O.type,key:j,ref:O.ref,props:O.props,_owner:O._owner}}function I(O){return typeof O=="object"&&O!==null&&O.$$typeof===r}function L(O){var j={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(J){return j[J]})}var Y=/\/+/g;function B(O,j){return typeof O=="object"&&O!==null&&O.key!=null?L(""+O.key):j.toString(36)}function D(O,j,J,oe,ie){var he=typeof O;(he==="undefined"||he==="boolean")&&(O=null);var de=!1;if(O===null)de=!0;else switch(he){case"string":case"number":de=!0;break;case"object":switch(O.$$typeof){case r:case e:de=!0}}if(de)return de=O,ie=ie(de),O=oe===""?"."+B(de,0):oe,T(ie)?(J="",O!=null&&(J=O.replace(Y,"$&/")+"/"),D(ie,j,J,"",function(ye){return ye})):ie!=null&&(I(ie)&&(ie=N(ie,J+(!ie.key||de&&de.key===ie.key?"":(""+ie.key).replace(Y,"$&/")+"/")+O)),j.push(ie)),1;if(de=0,oe=oe===""?".":oe+":",T(O))for(var fe=0;fe<O.length;fe++){he=O[fe];var ue=oe+B(he,fe);de+=D(he,j,J,ue,ie)}else if(ue=C(O),typeof ue=="function")for(O=ue.call(O),fe=0;!(he=O.next()).done;)he=he.value,ue=oe+B(he,fe++),de+=D(he,j,J,ue,ie);else if(he==="object")throw j=String(O),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.");return de}function H(O,j,J){if(O==null)return O;var oe=[],ie=0;return D(O,oe,"","",function(he){return j.call(J,he,ie++)}),oe}function W(O){if(O._status===-1){var j=O._result;j=j(),j.then(function(J){(O._status===0||O._status===-1)&&(O._status=1,O._result=J)},function(J){(O._status===0||O._status===-1)&&(O._status=2,O._result=J)}),O._status===-1&&(O._status=0,O._result=j)}if(O._status===1)return O._result.default;throw O._result}var q={current:null},V={transition:null},$={ReactCurrentDispatcher:q,ReactCurrentBatchConfig:V,ReactCurrentOwner:_};return react_production_min.Children={map:H,forEach:function(O,j,J){H(O,function(){j.apply(this,arguments)},J)},count:function(O){var j=0;return H(O,function(){j++}),j},toArray:function(O){return H(O,function(j){return j})||[]},only:function(O){if(!I(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},react_production_min.Component=s,react_production_min.Fragment=t,react_production_min.Profiler=c,react_production_min.PureComponent=A,react_production_min.StrictMode=o,react_production_min.Suspense=g,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$,react_production_min.cloneElement=function(O,j,J){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var oe=k({},O.props),ie=O.key,he=O.ref,de=O._owner;if(j!=null){if(j.ref!==void 0&&(he=j.ref,de=_.current),j.key!==void 0&&(ie=""+j.key),O.type&&O.type.defaultProps)var fe=O.type.defaultProps;for(ue in j)u.call(j,ue)&&!M.hasOwnProperty(ue)&&(oe[ue]=j[ue]===void 0&&fe!==void 0?fe[ue]:j[ue])}var ue=arguments.length-2;if(ue===1)oe.children=J;else if(1<ue){fe=Array(ue);for(var ye=0;ye<ue;ye++)fe[ye]=arguments[ye+2];oe.children=fe}return{$$typeof:r,type:O.type,key:ie,ref:he,props:oe,_owner:de}},react_production_min.createContext=function(O){return O={$$typeof:v,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:h,_context:O},O.Consumer=O},react_production_min.createElement=R,react_production_min.createFactory=function(O){var j=R.bind(null,O);return j.type=O,j},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(O){return{$$typeof:p,render:O}},react_production_min.isValidElement=I,react_production_min.lazy=function(O){return{$$typeof:f,_payload:{_status:-1,_result:O},_init:W}},react_production_min.memo=function(O,j){return{$$typeof:x,type:O,compare:j===void 0?null:j}},react_production_min.startTransition=function(O){var j=V.transition;V.transition={};try{O()}finally{V.transition=j}},react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},react_production_min.useCallback=function(O,j){return q.current.useCallback(O,j)},react_production_min.useContext=function(O){return q.current.useContext(O)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(O){return q.current.useDeferredValue(O)},react_production_min.useEffect=function(O,j){return q.current.useEffect(O,j)},react_production_min.useId=function(){return q.current.useId()},react_production_min.useImperativeHandle=function(O,j,J){return q.current.useImperativeHandle(O,j,J)},react_production_min.useInsertionEffect=function(O,j){return q.current.useInsertionEffect(O,j)},react_production_min.useLayoutEffect=function(O,j){return q.current.useLayoutEffect(O,j)},react_production_min.useMemo=function(O,j){return q.current.useMemo(O,j)},react_production_min.useReducer=function(O,j,J){return q.current.useReducer(O,j,J)},react_production_min.useRef=function(O){return q.current.useRef(O)},react_production_min.useState=function(O){return q.current.useState(O)},react_production_min.useSyncExternalStore=function(O,j,J){return q.current.useSyncExternalStore(O,j,J)},react_production_min.useTransition=function(){return q.current.useTransition()},react_production_min.version="18.2.0",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min$1;function requireReactJsxRuntime_production_min$1(){if(hasRequiredReactJsxRuntime_production_min$1)return reactJsxRuntime_production_min$1;hasRequiredReactJsxRuntime_production_min$1=1;var r=requireReact(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h={key:!0,ref:!0,__self:!0,__source:!0};function v(p,g,x){var f,b={},C=null,S=null;x!==void 0&&(C=""+x),g.key!==void 0&&(C=""+g.key),g.ref!==void 0&&(S=g.ref);for(f in g)o.call(g,f)&&!h.hasOwnProperty(f)&&(b[f]=g[f]);if(p&&p.defaultProps)for(f in g=p.defaultProps,g)b[f]===void 0&&(b[f]=g[f]);return{$$typeof:e,type:p,key:C,ref:S,props:b,_owner:c.current}}return reactJsxRuntime_production_min$1.Fragment=t,reactJsxRuntime_production_min$1.jsx=v,reactJsxRuntime_production_min$1.jsxs=v,reactJsxRuntime_production_min$1}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime$1.exports=requireReactJsxRuntime_production_min$1()),jsxRuntime$1.exports}var jsxRuntimeExports$1=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(r){function e(V,$){var O=V.length;V.push($);e:for(;0<O;){var j=O-1>>>1,J=V[j];if(0<c(J,$))V[j]=$,V[O]=J,O=j;else break e}}function t(V){return V.length===0?null:V[0]}function o(V){if(V.length===0)return null;var $=V[0],O=V.pop();if(O!==$){V[0]=O;e:for(var j=0,J=V.length,oe=J>>>1;j<oe;){var ie=2*(j+1)-1,he=V[ie],de=ie+1,fe=V[de];if(0>c(he,O))de<J&&0>c(fe,he)?(V[j]=fe,V[de]=O,j=de):(V[j]=he,V[ie]=O,j=ie);else if(de<J&&0>c(fe,O))V[j]=fe,V[de]=O,j=de;else break e}}return $}function c(V,$){var O=V.sortIndex-$.sortIndex;return O!==0?O:V.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;r.unstable_now=function(){return h.now()}}else{var v=Date,p=v.now();r.unstable_now=function(){return v.now()-p}}var g=[],x=[],f=1,b=null,C=3,S=!1,k=!1,l=!1,s=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(V){for(var $=t(x);$!==null;){if($.callback===null)o(x);else if($.startTime<=V)o(x),$.sortIndex=$.expirationTime,e(g,$);else break;$=t(x)}}function T(V){if(l=!1,E(V),!k)if(t(g)!==null)k=!0,W(u);else{var $=t(x);$!==null&&q(T,$.startTime-V)}}function u(V,$){k=!1,l&&(l=!1,y(R),R=-1),S=!0;var O=C;try{for(E($),b=t(g);b!==null&&(!(b.expirationTime>$)||V&&!L());){var j=b.callback;if(typeof j=="function"){b.callback=null,C=b.priorityLevel;var J=j(b.expirationTime<=$);$=r.unstable_now(),typeof J=="function"?b.callback=J:b===t(g)&&o(g),E($)}else o(g);b=t(g)}if(b!==null)var oe=!0;else{var ie=t(x);ie!==null&&q(T,ie.startTime-$),oe=!1}return oe}finally{b=null,C=O,S=!1}}var _=!1,M=null,R=-1,N=5,I=-1;function L(){return!(r.unstable_now()-I<N)}function Y(){if(M!==null){var V=r.unstable_now();I=V;var $=!0;try{$=M(!0,V)}finally{$?B():(_=!1,M=null)}}else _=!1}var B;if(typeof A=="function")B=function(){A(Y)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,H=D.port2;D.port1.onmessage=Y,B=function(){H.postMessage(null)}}else B=function(){s(Y,0)};function W(V){M=V,_||(_=!0,B())}function q(V,$){R=s(function(){V(r.unstable_now())},$)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(V){V.callback=null},r.unstable_continueExecution=function(){k||S||(k=!0,W(u))},r.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<V?Math.floor(1e3/V):5},r.unstable_getCurrentPriorityLevel=function(){return C},r.unstable_getFirstCallbackNode=function(){return t(g)},r.unstable_next=function(V){switch(C){case 1:case 2:case 3:var $=3;break;default:$=C}var O=C;C=$;try{return V()}finally{C=O}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(V,$){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var O=C;C=V;try{return $()}finally{C=O}},r.unstable_scheduleCallback=function(V,$,O){var j=r.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?j+O:j):O=j,V){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=O+J,V={id:f++,callback:$,priorityLevel:V,startTime:O,expirationTime:J,sortIndex:-1},O>j?(V.sortIndex=O,e(x,V),t(g)===null&&V===t(x)&&(l?(y(R),R=-1):l=!0,q(T,O-j))):(V.sortIndex=J,e(g,V),k||S||(k=!0,W(u))),V},r.unstable_shouldYield=L,r.unstable_wrapCallback=function(V){var $=C;return function(){var O=C;C=$;try{return V.apply(this,arguments)}finally{C=O}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var r=requireReact(),e=requireScheduler();function t(n){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+n,w=1;w<arguments.length;w++)a+="&args[]="+encodeURIComponent(arguments[w]);return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,c={};function h(n,a){v(n,a),v(n+"Capture",a)}function v(n,a){for(c[n]=a,n=0;n<a.length;n++)o.add(a[n])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),g=Object.prototype.hasOwnProperty,x=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},b={};function C(n){return g.call(b,n)?!0:g.call(f,n)?!1:x.test(n)?b[n]=!0:(f[n]=!0,!1)}function S(n,a,w,P){if(w!==null&&w.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return P?!1:w!==null?!w.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function k(n,a,w,P){if(a===null||typeof a>"u"||S(n,a,w,P))return!0;if(P)return!1;if(w!==null)switch(w.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function l(n,a,w,P,G,Z,re){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=P,this.attributeNamespace=G,this.mustUseProperty=w,this.propertyName=n,this.type=a,this.sanitizeURL=Z,this.removeEmptyString=re}var s={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){s[n]=new l(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var a=n[0];s[a]=new l(a,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){s[n]=new l(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){s[n]=new l(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){s[n]=new l(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){s[n]=new l(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){s[n]=new l(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){s[n]=new l(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){s[n]=new l(n,5,!1,n.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function A(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var a=n.replace(y,A);s[a]=new l(a,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var a=n.replace(y,A);s[a]=new l(a,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var a=n.replace(y,A);s[a]=new l(a,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){s[n]=new l(n,1,!1,n.toLowerCase(),null,!1,!1)}),s.xlinkHref=new l("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){s[n]=new l(n,1,!1,n.toLowerCase(),null,!0,!0)});function E(n,a,w,P){var G=s.hasOwnProperty(a)?s[a]:null;(G!==null?G.type!==0:P||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(k(a,w,G,P)&&(w=null),P||G===null?C(a)&&(w===null?n.removeAttribute(a):n.setAttribute(a,""+w)):G.mustUseProperty?n[G.propertyName]=w===null?G.type===3?!1:"":w:(a=G.attributeName,P=G.attributeNamespace,w===null?n.removeAttribute(a):(G=G.type,w=G===3||G===4&&w===!0?"":""+w,P?n.setAttributeNS(P,a,w):n.setAttribute(a,w))))}var T=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),_=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),L=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),q=Symbol.for("react.offscreen"),V=Symbol.iterator;function $(n){return n===null||typeof n!="object"?null:(n=V&&n[V]||n["@@iterator"],typeof n=="function"?n:null)}var O=Object.assign,j;function J(n){if(j===void 0)try{throw Error()}catch(w){var a=w.stack.trim().match(/\n( *(at )?)/);j=a&&a[1]||""}return`
`+j+n}var oe=!1;function ie(n,a){if(!n||oe)return"";oe=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(qe){var P=qe}Reflect.construct(n,[],a)}else{try{a.call()}catch(qe){P=qe}n.call(a.prototype)}else{try{throw Error()}catch(qe){P=qe}n()}}catch(qe){if(qe&&P&&typeof qe.stack=="string"){for(var G=qe.stack.split(`
`),Z=P.stack.split(`
`),re=G.length-1,ge=Z.length-1;1<=re&&0<=ge&&G[re]!==Z[ge];)ge--;for(;1<=re&&0<=ge;re--,ge--)if(G[re]!==Z[ge]){if(re!==1||ge!==1)do if(re--,ge--,0>ge||G[re]!==Z[ge]){var Ce=`
`+G[re].replace(" at new "," at ");return n.displayName&&Ce.includes("<anonymous>")&&(Ce=Ce.replace("<anonymous>",n.displayName)),Ce}while(1<=re&&0<=ge);break}}}finally{oe=!1,Error.prepareStackTrace=w}return(n=n?n.displayName||n.name:"")?J(n):""}function he(n){switch(n.tag){case 5:return J(n.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 2:case 15:return n=ie(n.type,!1),n;case 11:return n=ie(n.type.render,!1),n;case 1:return n=ie(n.type,!0),n;default:return""}}function de(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case M:return"Fragment";case _:return"Portal";case N:return"Profiler";case R:return"StrictMode";case B:return"Suspense";case D:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case L:return(n.displayName||"Context")+".Consumer";case I:return(n._context.displayName||"Context")+".Provider";case Y:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case H:return a=n.displayName||null,a!==null?a:de(n.type)||"Memo";case W:a=n._payload,n=n._init;try{return de(n(a))}catch{}}return null}function fe(n){var a=n.type;switch(n.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=a.render,n=n.displayName||n.name||"",a.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return de(a);case 8:return a===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function ue(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function ye(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function ze(n){var a=ye(n)?"checked":"value",w=Object.getOwnPropertyDescriptor(n.constructor.prototype,a),P=""+n[a];if(!n.hasOwnProperty(a)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var G=w.get,Z=w.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return G.call(this)},set:function(re){P=""+re,Z.call(this,re)}}),Object.defineProperty(n,a,{enumerable:w.enumerable}),{getValue:function(){return P},setValue:function(re){P=""+re},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function $e(n){n._valueTracker||(n._valueTracker=ze(n))}function We(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var w=a.getValue(),P="";return n&&(P=ye(n)?n.checked?"true":"false":n.value),n=P,n!==w?(a.setValue(n),!0):!1}function Fe(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function me(n,a){var w=a.checked;return O({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:w??n._wrapperState.initialChecked})}function ke(n,a){var w=a.defaultValue==null?"":a.defaultValue,P=a.checked!=null?a.checked:a.defaultChecked;w=ue(a.value!=null?a.value:w),n._wrapperState={initialChecked:P,initialValue:w,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function Qe(n,a){a=a.checked,a!=null&&E(n,"checked",a,!1)}function Je(n,a){Qe(n,a);var w=ue(a.value),P=a.type;if(w!=null)P==="number"?(w===0&&n.value===""||n.value!=w)&&(n.value=""+w):n.value!==""+w&&(n.value=""+w);else if(P==="submit"||P==="reset"){n.removeAttribute("value");return}a.hasOwnProperty("value")?nt(n,a.type,w):a.hasOwnProperty("defaultValue")&&nt(n,a.type,ue(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(n.defaultChecked=!!a.defaultChecked)}function Ye(n,a,w){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var P=a.type;if(!(P!=="submit"&&P!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+n._wrapperState.initialValue,w||a===n.value||(n.value=a),n.defaultValue=a}w=n.name,w!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,w!==""&&(n.name=w)}function nt(n,a,w){(a!=="number"||Fe(n.ownerDocument)!==n)&&(w==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+w&&(n.defaultValue=""+w))}var rt=Array.isArray;function et(n,a,w,P){if(n=n.options,a){a={};for(var G=0;G<w.length;G++)a["$"+w[G]]=!0;for(w=0;w<n.length;w++)G=a.hasOwnProperty("$"+n[w].value),n[w].selected!==G&&(n[w].selected=G),G&&P&&(n[w].defaultSelected=!0)}else{for(w=""+ue(w),a=null,G=0;G<n.length;G++){if(n[G].value===w){n[G].selected=!0,P&&(n[G].defaultSelected=!0);return}a!==null||n[G].disabled||(a=n[G])}a!==null&&(a.selected=!0)}}function Ke(n,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return O({},a,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Ue(n,a){var w=a.value;if(w==null){if(w=a.children,a=a.defaultValue,w!=null){if(a!=null)throw Error(t(92));if(rt(w)){if(1<w.length)throw Error(t(93));w=w[0]}a=w}a==null&&(a=""),w=a}n._wrapperState={initialValue:ue(w)}}function He(n,a){var w=ue(a.value),P=ue(a.defaultValue);w!=null&&(w=""+w,w!==n.value&&(n.value=w),a.defaultValue==null&&n.defaultValue!==w&&(n.defaultValue=w)),P!=null&&(n.defaultValue=""+P)}function mt(n){var a=n.textContent;a===n._wrapperState.initialValue&&a!==""&&a!==null&&(n.value=a)}function ht(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function te(n,a){return n==null||n==="http://www.w3.org/1999/xhtml"?ht(a):n==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var se,le=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,w,P,G){MSApp.execUnsafeLocalFunction(function(){return n(a,w,P,G)})}:n})(function(n,a){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=a;else{for(se=se||document.createElement("div"),se.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=se.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;a.firstChild;)n.appendChild(a.firstChild)}});function Se(n,a){if(a){var w=n.firstChild;if(w&&w===n.lastChild&&w.nodeType===3){w.nodeValue=a;return}}n.textContent=a}var we={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xe=["Webkit","ms","Moz","O"];Object.keys(we).forEach(function(n){Xe.forEach(function(a){a=a+n.charAt(0).toUpperCase()+n.substring(1),we[a]=we[n]})});function je(n,a,w){return a==null||typeof a=="boolean"||a===""?"":w||typeof a!="number"||a===0||we.hasOwnProperty(n)&&we[n]?(""+a).trim():a+"px"}function K(n,a){n=n.style;for(var w in a)if(a.hasOwnProperty(w)){var P=w.indexOf("--")===0,G=je(w,a[w],P);w==="float"&&(w="cssFloat"),P?n.setProperty(w,G):n[w]=G}}var xe=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Me(n,a){if(a){if(xe[n]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,n));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function Ze(n,a){if(n.indexOf("-")===-1)return typeof a.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function Ve(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var ee=null,Pe=null,at=null;function X(n){if(n=Fs(n)){if(typeof ee!="function")throw Error(t(280));var a=n.stateNode;a&&(a=Ro(a),ee(n.stateNode,n.type,a))}}function Re(n){Pe?at?at.push(n):at=[n]:Pe=n}function Ae(){if(Pe){var n=Pe,a=at;if(at=Pe=null,X(n),a)for(n=0;n<a.length;n++)X(a[n])}}function ne(n,a){return n(a)}function ve(){}var Ne=!1;function gt(n,a,w){if(Ne)return n(a,w);Ne=!0;try{return ne(n,a,w)}finally{Ne=!1,(Pe!==null||at!==null)&&(ve(),Ae())}}function ft(n,a){var w=n.stateNode;if(w===null)return null;var P=Ro(w);if(P===null)return null;w=P[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(P=!P.disabled)||(n=n.type,P=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!P;break e;default:n=!1}if(n)return null;if(w&&typeof w!="function")throw Error(t(231,a,typeof w));return w}var vt=!1;if(p)try{var Tt={};Object.defineProperty(Tt,"passive",{get:function(){vt=!0}}),window.addEventListener("test",Tt,Tt),window.removeEventListener("test",Tt,Tt)}catch{vt=!1}function xr(n,a,w,P,G,Z,re,ge,Ce){var qe=Array.prototype.slice.call(arguments,3);try{a.apply(w,qe)}catch(ot){this.onError(ot)}}var Bt=!1,jt=null,qt=!1,mr=null,_r={onError:function(n){Bt=!0,jt=n}};function En(n,a,w,P,G,Z,re,ge,Ce){Bt=!1,jt=null,xr.apply(_r,arguments)}function Mn(n,a,w,P,G,Z,re,ge,Ce){if(En.apply(this,arguments),Bt){if(Bt){var qe=jt;Bt=!1,jt=null}else throw Error(t(198));qt||(qt=!0,mr=qe)}}function Kt(n){var a=n,w=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(w=a.return),n=a.return;while(n)}return a.tag===3?w:null}function ar(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function cr(n){if(Kt(n)!==n)throw Error(t(188))}function Gr(n){var a=n.alternate;if(!a){if(a=Kt(n),a===null)throw Error(t(188));return a!==n?null:n}for(var w=n,P=a;;){var G=w.return;if(G===null)break;var Z=G.alternate;if(Z===null){if(P=G.return,P!==null){w=P;continue}break}if(G.child===Z.child){for(Z=G.child;Z;){if(Z===w)return cr(G),n;if(Z===P)return cr(G),a;Z=Z.sibling}throw Error(t(188))}if(w.return!==P.return)w=G,P=Z;else{for(var re=!1,ge=G.child;ge;){if(ge===w){re=!0,w=G,P=Z;break}if(ge===P){re=!0,P=G,w=Z;break}ge=ge.sibling}if(!re){for(ge=Z.child;ge;){if(ge===w){re=!0,w=Z,P=G;break}if(ge===P){re=!0,P=Z,w=G;break}ge=ge.sibling}if(!re)throw Error(t(189))}}if(w.alternate!==P)throw Error(t(190))}if(w.tag!==3)throw Error(t(188));return w.stateNode.current===w?n:a}function zr(n){return n=Gr(n),n!==null?dn(n):null}function dn(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var a=dn(n);if(a!==null)return a;n=n.sibling}return null}var _i=e.unstable_scheduleCallback,xi=e.unstable_cancelCallback,wi=e.unstable_shouldYield,ei=e.unstable_requestPaint,dr=e.unstable_now,bi=e.unstable_getCurrentPriorityLevel,$n=e.unstable_ImmediatePriority,$s=e.unstable_UserBlockingPriority,Yt=e.unstable_NormalPriority,Tn=e.unstable_LowPriority,fn=e.unstable_IdlePriority,Wi=null,Ir=null;function Si(n){if(Ir&&typeof Ir.onCommitFiberRoot=="function")try{Ir.onCommitFiberRoot(Wi,n,void 0,(n.current.flags&128)===128)}catch{}}var pn=Math.clz32?Math.clz32:Wo,jo=Math.log,Vo=Math.LN2;function Wo(n){return n>>>=0,n===0?32:31-(jo(n)/Vo|0)|0}var Dn=64,ri=4194304;function Tr(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function qn(n,a){var w=n.pendingLanes;if(w===0)return 0;var P=0,G=n.suspendedLanes,Z=n.pingedLanes,re=w&268435455;if(re!==0){var ge=re&~G;ge!==0?P=Tr(ge):(Z&=re,Z!==0&&(P=Tr(Z)))}else re=w&~G,re!==0?P=Tr(re):Z!==0&&(P=Tr(Z));if(P===0)return 0;if(a!==0&&a!==P&&(a&G)===0&&(G=P&-P,Z=a&-a,G>=Z||G===16&&(Z&4194240)!==0))return a;if((P&4)!==0&&(P|=w&16),a=n.entangledLanes,a!==0)for(n=n.entanglements,a&=P;0<a;)w=31-pn(a),G=1<<w,P|=n[w],a&=~G;return P}function Ei(n,a){switch(n){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Hi(n,a){for(var w=n.suspendedLanes,P=n.pingedLanes,G=n.expirationTimes,Z=n.pendingLanes;0<Z;){var re=31-pn(Z),ge=1<<re,Ce=G[re];Ce===-1?((ge&w)===0||(ge&P)!==0)&&(G[re]=Ei(ge,a)):Ce<=a&&(n.expiredLanes|=ge),Z&=~ge}}function Ho(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function ni(){var n=Dn;return Dn<<=1,(Dn&4194240)===0&&(Dn=64),n}function qs(n){for(var a=[],w=0;31>w;w++)a.push(n);return a}function _n(n,a,w){n.pendingLanes|=a,a!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,a=31-pn(a),n[a]=w}function nc(n,a){var w=n.pendingLanes&~a;n.pendingLanes=a,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=a,n.mutableReadLanes&=a,n.entangledLanes&=a,a=n.entanglements;var P=n.eventTimes;for(n=n.expirationTimes;0<w;){var G=31-pn(w),Z=1<<G;a[G]=0,P[G]=-1,n[G]=-1,w&=~Z}}function On(n,a){var w=n.entangledLanes|=a;for(n=n.entanglements;w;){var P=31-pn(w),G=1<<P;G&a|n[P]&a&&(n[P]|=a),w&=~G}}var Vt=0;function Qr(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var rr,Ai,Xs,$o,Mi,Js=!1,$i=[],mn=null,ii=null,ai=null,Kr=new Map,Yn=new Map,li=[],ic="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qi(n,a){switch(n){case"focusin":case"focusout":mn=null;break;case"dragenter":case"dragleave":ii=null;break;case"mouseover":case"mouseout":ai=null;break;case"pointerover":case"pointerout":Kr.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yn.delete(a.pointerId)}}function Yi(n,a,w,P,G,Z){return n===null||n.nativeEvent!==Z?(n={blockedOn:a,domEventName:w,eventSystemFlags:P,nativeEvent:Z,targetContainers:[G]},a!==null&&(a=Fs(a),a!==null&&Ai(a)),n):(n.eventSystemFlags|=P,a=n.targetContainers,G!==null&&a.indexOf(G)===-1&&a.push(G),n)}function $a(n,a,w,P,G){switch(a){case"focusin":return mn=Yi(mn,n,a,w,P,G),!0;case"dragenter":return ii=Yi(ii,n,a,w,P,G),!0;case"mouseover":return ai=Yi(ai,n,a,w,P,G),!0;case"pointerover":var Z=G.pointerId;return Kr.set(Z,Yi(Kr.get(Z)||null,n,a,w,P,G)),!0;case"gotpointercapture":return Z=G.pointerId,Yn.set(Z,Yi(Yn.get(Z)||null,n,a,w,P,G)),!0}return!1}function qa(n){var a=Oi(n.target);if(a!==null){var w=Kt(a);if(w!==null){if(a=w.tag,a===13){if(a=ar(w),a!==null){n.blockedOn=a,Mi(n.priority,function(){Xs(w)});return}}else if(a===3&&w.stateNode.current.memoizedState.isDehydrated){n.blockedOn=w.tag===3?w.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ws(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var w=Yo(n.domEventName,n.eventSystemFlags,a[0],n.nativeEvent);if(w===null){w=n.nativeEvent;var P=new w.constructor(w.type,w);_e=P,w.target.dispatchEvent(P),_e=null}else return a=Fs(w),a!==null&&Ai(a),n.blockedOn=w,!1;a.shift()}return!0}function Ya(n,a,w){ws(n)&&w.delete(a)}function hc(){Js=!1,mn!==null&&ws(mn)&&(mn=null),ii!==null&&ws(ii)&&(ii=null),ai!==null&&ws(ai)&&(ai=null),Kr.forEach(Ya),Yn.forEach(Ya)}function bs(n,a){n.blockedOn===a&&(n.blockedOn=null,Js||(Js=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,hc)))}function Ss(n){function a(G){return bs(G,n)}if(0<$i.length){bs($i[0],n);for(var w=1;w<$i.length;w++){var P=$i[w];P.blockedOn===n&&(P.blockedOn=null)}}for(mn!==null&&bs(mn,n),ii!==null&&bs(ii,n),ai!==null&&bs(ai,n),Kr.forEach(a),Yn.forEach(a),w=0;w<li.length;w++)P=li[w],P.blockedOn===n&&(P.blockedOn=null);for(;0<li.length&&(w=li[0],w.blockedOn===null);)qa(w),w.blockedOn===null&&li.shift()}var Xi=T.ReactCurrentBatchConfig,Qs=!0;function dc(n,a,w,P){var G=Vt,Z=Xi.transition;Xi.transition=null;try{Vt=1,qo(n,a,w,P)}finally{Vt=G,Xi.transition=Z}}function fc(n,a,w,P){var G=Vt,Z=Xi.transition;Xi.transition=null;try{Vt=4,qo(n,a,w,P)}finally{Vt=G,Xi.transition=Z}}function qo(n,a,w,P){if(Qs){var G=Yo(n,a,w,P);if(G===null)Sa(n,a,P,Ks,w),qi(n,P);else if($a(G,n,a,w,P))P.stopPropagation();else if(qi(n,P),a&4&&-1<ic.indexOf(n)){for(;G!==null;){var Z=Fs(G);if(Z!==null&&rr(Z),Z=Yo(n,a,w,P),Z===null&&Sa(n,a,P,Ks,w),Z===G)break;G=Z}G!==null&&P.stopPropagation()}else Sa(n,a,P,null,w)}}var Ks=null;function Yo(n,a,w,P){if(Ks=null,n=Ve(P),n=Oi(n),n!==null)if(a=Kt(n),a===null)n=null;else if(w=a.tag,w===13){if(n=ar(a),n!==null)return n;n=null}else if(w===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null);return Ks=n,null}function Xa(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bi()){case $n:return 1;case $s:return 4;case Yt:case Tn:return 16;case fn:return 536870912;default:return 16}default:return 16}}var ci=null,Ti=null,eo=null;function Za(){if(eo)return eo;var n,a=Ti,w=a.length,P,G="value"in ci?ci.value:ci.textContent,Z=G.length;for(n=0;n<w&&a[n]===G[n];n++);var re=w-n;for(P=1;P<=re&&a[w-P]===G[Z-P];P++);return eo=G.slice(n,1<P?1-P:void 0)}function ro(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function ki(){return!0}function Xo(){return!1}function Fr(n){function a(w,P,G,Z,re){this._reactName=w,this._targetInst=G,this.type=P,this.nativeEvent=Z,this.target=re,this.currentTarget=null;for(var ge in n)n.hasOwnProperty(ge)&&(w=n[ge],this[ge]=w?w(Z):Z[ge]);return this.isDefaultPrevented=(Z.defaultPrevented!=null?Z.defaultPrevented:Z.returnValue===!1)?ki:Xo,this.isPropagationStopped=Xo,this}return O(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var w=this.nativeEvent;w&&(w.preventDefault?w.preventDefault():typeof w.returnValue!="unknown"&&(w.returnValue=!1),this.isDefaultPrevented=ki)},stopPropagation:function(){var w=this.nativeEvent;w&&(w.stopPropagation?w.stopPropagation():typeof w.cancelBubble!="unknown"&&(w.cancelBubble=!0),this.isPropagationStopped=ki)},persist:function(){},isPersistent:ki}),a}var Zi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zo=Fr(Zi),Cs=O({},Zi,{view:0,detail:0}),pc=Fr(Cs),zi,Jo,Ji,Es=O({},Cs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qo,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ji&&(Ji&&n.type==="mousemove"?(zi=n.screenX-Ji.screenX,Jo=n.screenY-Ji.screenY):Jo=zi=0,Ji=n),zi)},movementY:function(n){return"movementY"in n?n.movementY:Jo}}),Ja=Fr(Es),mc=O({},Es,{dataTransfer:0}),gc=Fr(mc),yc=O({},Cs,{relatedTarget:0}),Qi=Fr(yc),vc=O({},Zi,{animationName:0,elapsedTime:0,pseudoElement:0}),_c=Fr(vc),xc=O({},Zi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),wc=Fr(xc),As=O({},Zi,{data:0}),no=Fr(As),bc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ec={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ac(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=Ec[n])?!!a[n]:!1}function Qo(){return Ac}var Tc=O({},Cs,{key:function(n){if(n.key){var a=bc[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=ro(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Cc[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qo,charCode:function(n){return n.type==="keypress"?ro(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ro(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Rc=Fr(Tc),io=O({},Es,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qa=Fr(io),kc=O({},Cs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qo}),Ki=Fr(kc),Ka=O({},Zi,{propertyName:0,elapsedTime:0,pseudoElement:0}),el=Fr(Ka),tl=O({},Es,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ko=Fr(tl),rl=[9,13,27,32],ea=p&&"CompositionEvent"in window,Ms=null;p&&"documentMode"in document&&(Ms=document.documentMode);var zc=p&&"TextEvent"in window&&!Ms,nl=p&&(!ea||Ms&&8<Ms&&11>=Ms),es=" ",il=!1;function ta(n,a){switch(n){case"keyup":return rl.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ra(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Ni=!1;function Nc(n,a){switch(n){case"compositionend":return ra(a);case"keypress":return a.which!==32?null:(il=!0,es);case"textInput":return n=a.data,n===es&&il?null:n;default:return null}}function so(n,a){if(Ni)return n==="compositionend"||!ea&&ta(n,a)?(n=Za(),eo=Ti=ci=null,Ni=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return nl&&a.locale!=="ko"?null:a.data;default:return null}}var Ii={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sl(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!Ii[n.type]:a==="textarea"}function ol(n,a,w,P){Re(P),a=So(a,"onChange"),0<a.length&&(w=new Zo("onChange","change",null,w,P),n.push({event:w,listeners:a}))}var Yr=null,ts=null;function al(n){bo(n,0)}function oo(n){var a=cs(n);if(We(a))return n}function ll(n,a){if(n==="change")return a}var Ts=!1;if(p){var ao;if(p){var lo="oninput"in document;if(!lo){var na=document.createElement("div");na.setAttribute("oninput","return;"),lo=typeof na.oninput=="function"}ao=lo}else ao=!1;Ts=ao&&(!document.documentMode||9<document.documentMode)}function ia(){Yr&&(Yr.detachEvent("onpropertychange",da),ts=Yr=null)}function da(n){if(n.propertyName==="value"&&oo(ts)){var a=[];ol(a,ts,n,Ve(n)),gt(al,a)}}function cl(n,a,w){n==="focusin"?(ia(),Yr=a,ts=w,Yr.attachEvent("onpropertychange",da)):n==="focusout"&&ia()}function ul(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return oo(ts)}function hl(n,a){if(n==="click")return oo(a)}function dl(n,a){if(n==="input"||n==="change")return oo(a)}function uo(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var Rr=typeof Object.is=="function"?Object.is:uo;function Fi(n,a){if(Rr(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var w=Object.keys(n),P=Object.keys(a);if(w.length!==P.length)return!1;for(P=0;P<w.length;P++){var G=w[P];if(!g.call(a,G)||!Rr(n[G],a[G]))return!1}return!0}function fa(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function po(n,a){var w=fa(n);n=0;for(var P;w;){if(w.nodeType===3){if(P=n+w.textContent.length,n<=a&&P>=a)return{node:w,offset:a-n};n=P}e:{for(;w;){if(w.nextSibling){w=w.nextSibling;break e}w=w.parentNode}w=void 0}w=fa(w)}}function pa(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?pa(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function ma(){for(var n=window,a=Fe();a instanceof n.HTMLIFrameElement;){try{var w=typeof a.contentWindow.location.href=="string"}catch{w=!1}if(w)n=a.contentWindow;else break;a=Fe(n.document)}return a}function go(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}function fl(n){var a=ma(),w=n.focusedElem,P=n.selectionRange;if(a!==w&&w&&w.ownerDocument&&pa(w.ownerDocument.documentElement,w)){if(P!==null&&go(w)){if(a=P.start,n=P.end,n===void 0&&(n=a),"selectionStart"in w)w.selectionStart=a,w.selectionEnd=Math.min(n,w.value.length);else if(n=(a=w.ownerDocument||document)&&a.defaultView||window,n.getSelection){n=n.getSelection();var G=w.textContent.length,Z=Math.min(P.start,G);P=P.end===void 0?Z:Math.min(P.end,G),!n.extend&&Z>P&&(G=P,P=Z,Z=G),G=po(w,Z);var re=po(w,P);G&&re&&(n.rangeCount!==1||n.anchorNode!==G.node||n.anchorOffset!==G.offset||n.focusNode!==re.node||n.focusOffset!==re.offset)&&(a=a.createRange(),a.setStart(G.node,G.offset),n.removeAllRanges(),Z>P?(n.addRange(a),n.extend(re.node,re.offset)):(a.setEnd(re.node,re.offset),n.addRange(a)))}}for(a=[],n=w;n=n.parentNode;)n.nodeType===1&&a.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<a.length;w++)n=a[w],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var yo=p&&"documentMode"in document&&11>=document.documentMode,Xn=null,vo=null,rs=null,_o=!1;function ga(n,a,w){var P=w.window===w?w.document:w.nodeType===9?w:w.ownerDocument;_o||Xn==null||Xn!==Fe(P)||(P=Xn,"selectionStart"in P&&go(P)?P={start:P.selectionStart,end:P.selectionEnd}:(P=(P.ownerDocument&&P.ownerDocument.defaultView||window).getSelection(),P={anchorNode:P.anchorNode,anchorOffset:P.anchorOffset,focusNode:P.focusNode,focusOffset:P.focusOffset}),rs&&Fi(rs,P)||(rs=P,P=So(vo,"onSelect"),0<P.length&&(a=new Zo("onSelect","select",null,a,w),n.push({event:a,listeners:P}),a.target=Xn)))}function Rs(n,a){var w={};return w[n.toLowerCase()]=a.toLowerCase(),w["Webkit"+n]="webkit"+a,w["Moz"+n]="moz"+a,w}var ui={animationend:Rs("Animation","AnimationEnd"),animationiteration:Rs("Animation","AnimationIteration"),animationstart:Rs("Animation","AnimationStart"),transitionend:Rs("Transition","TransitionEnd")},xo={},ya={};p&&(ya=document.createElement("div").style,"AnimationEvent"in window||(delete ui.animationend.animation,delete ui.animationiteration.animation,delete ui.animationstart.animation),"TransitionEvent"in window||delete ui.transitionend.transition);function ur(n){if(xo[n])return xo[n];if(!ui[n])return n;var a=ui[n],w;for(w in a)if(a.hasOwnProperty(w)&&w in ya)return xo[n]=a[w];return n}var va=ur("animationend"),_a=ur("animationiteration"),pl=ur("animationstart"),ml=ur("transitionend"),gl=new Map,xa="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function hi(n,a){gl.set(n,a),h(a,[n])}for(var Zn=0;Zn<xa.length;Zn++){var wo=xa[Zn],yl=wo.toLowerCase(),vl=wo[0].toUpperCase()+wo.slice(1);hi(yl,"on"+vl)}hi(va,"onAnimationEnd"),hi(_a,"onAnimationIteration"),hi(pl,"onAnimationStart"),hi("dblclick","onDoubleClick"),hi("focusin","onFocus"),hi("focusout","onBlur"),hi(ml,"onTransitionEnd"),v("onMouseEnter",["mouseout","mouseover"]),v("onMouseLeave",["mouseout","mouseover"]),v("onPointerEnter",["pointerout","pointerover"]),v("onPointerLeave",["pointerout","pointerover"]),h("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),h("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),h("onBeforeInput",["compositionend","keypress","textInput","paste"]),h("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),h("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),h("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ss="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pc=new Set("cancel close invalid load scroll toggle".split(" ").concat(ss));function wa(n,a,w){var P=n.type||"unknown-event";n.currentTarget=w,Mn(P,a,void 0,n),n.currentTarget=null}function bo(n,a){a=(a&4)!==0;for(var w=0;w<n.length;w++){var P=n[w],G=P.event;P=P.listeners;e:{var Z=void 0;if(a)for(var re=P.length-1;0<=re;re--){var ge=P[re],Ce=ge.instance,qe=ge.currentTarget;if(ge=ge.listener,Ce!==Z&&G.isPropagationStopped())break e;wa(G,ge,qe),Z=Ce}else for(re=0;re<P.length;re++){if(ge=P[re],Ce=ge.instance,qe=ge.currentTarget,ge=ge.listener,Ce!==Z&&G.isPropagationStopped())break e;wa(G,ge,qe),Z=Ce}}}if(qt)throw n=mr,qt=!1,mr=null,n}function hr(n,a){var w=a[Is];w===void 0&&(w=a[Is]=new Set);var P=n+"__bubble";w.has(P)||(_l(a,n,2,!1),w.add(P))}function ba(n,a,w){var P=0;a&&(P|=4),_l(w,n,P,a)}var ks="_reactListening"+Math.random().toString(36).slice(2);function zs(n){if(!n[ks]){n[ks]=!0,o.forEach(function(w){w!=="selectionchange"&&(Pc.has(w)||ba(w,!1,n),ba(w,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[ks]||(a[ks]=!0,ba("selectionchange",!1,a))}}function _l(n,a,w,P){switch(Xa(a)){case 1:var G=dc;break;case 4:G=fc;break;default:G=qo}w=G.bind(null,a,w,n),G=void 0,!vt||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(G=!0),P?G!==void 0?n.addEventListener(a,w,{capture:!0,passive:G}):n.addEventListener(a,w,!0):G!==void 0?n.addEventListener(a,w,{passive:G}):n.addEventListener(a,w,!1)}function Sa(n,a,w,P,G){var Z=P;if((a&1)===0&&(a&2)===0&&P!==null)e:for(;;){if(P===null)return;var re=P.tag;if(re===3||re===4){var ge=P.stateNode.containerInfo;if(ge===G||ge.nodeType===8&&ge.parentNode===G)break;if(re===4)for(re=P.return;re!==null;){var Ce=re.tag;if((Ce===3||Ce===4)&&(Ce=re.stateNode.containerInfo,Ce===G||Ce.nodeType===8&&Ce.parentNode===G))return;re=re.return}for(;ge!==null;){if(re=Oi(ge),re===null)return;if(Ce=re.tag,Ce===5||Ce===6){P=Z=re;continue e}ge=ge.parentNode}}P=P.return}gt(function(){var qe=Z,ot=Ve(w),ct=[];e:{var it=gl.get(n);if(it!==void 0){var bt=Zo,Et=n;switch(n){case"keypress":if(ro(w)===0)break e;case"keydown":case"keyup":bt=Rc;break;case"focusin":Et="focus",bt=Qi;break;case"focusout":Et="blur",bt=Qi;break;case"beforeblur":case"afterblur":bt=Qi;break;case"click":if(w.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":bt=Ja;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":bt=gc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":bt=Ki;break;case va:case _a:case pl:bt=_c;break;case ml:bt=el;break;case"scroll":bt=pc;break;case"wheel":bt=Ko;break;case"copy":case"cut":case"paste":bt=wc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":bt=Qa}var Rt=(a&4)!==0,kr=!Rt&&n==="scroll",De=Rt?it!==null?it+"Capture":null:it;Rt=[];for(var Ee=qe,Be;Ee!==null;){Be=Ee;var dt=Be.stateNode;if(Be.tag===5&&dt!==null&&(Be=dt,De!==null&&(dt=ft(Ee,De),dt!=null&&Rt.push(Ns(Ee,dt,Be)))),kr)break;Ee=Ee.return}0<Rt.length&&(it=new bt(it,Et,null,w,ot),ct.push({event:it,listeners:Rt}))}}if((a&7)===0){e:{if(it=n==="mouseover"||n==="pointerover",bt=n==="mouseout"||n==="pointerout",it&&w!==_e&&(Et=w.relatedTarget||w.fromElement)&&(Oi(Et)||Et[gn]))break e;if((bt||it)&&(it=ot.window===ot?ot:(it=ot.ownerDocument)?it.defaultView||it.parentWindow:window,bt?(Et=w.relatedTarget||w.toElement,bt=qe,Et=Et?Oi(Et):null,Et!==null&&(kr=Kt(Et),Et!==kr||Et.tag!==5&&Et.tag!==6)&&(Et=null)):(bt=null,Et=qe),bt!==Et)){if(Rt=Ja,dt="onMouseLeave",De="onMouseEnter",Ee="mouse",(n==="pointerout"||n==="pointerover")&&(Rt=Qa,dt="onPointerLeave",De="onPointerEnter",Ee="pointer"),kr=bt==null?it:cs(bt),Be=Et==null?it:cs(Et),it=new Rt(dt,Ee+"leave",bt,w,ot),it.target=kr,it.relatedTarget=Be,dt=null,Oi(ot)===qe&&(Rt=new Rt(De,Ee+"enter",Et,w,ot),Rt.target=Be,Rt.relatedTarget=kr,dt=Rt),kr=dt,bt&&Et)t:{for(Rt=bt,De=Et,Ee=0,Be=Rt;Be;Be=as(Be))Ee++;for(Be=0,dt=De;dt;dt=as(dt))Be++;for(;0<Ee-Be;)Rt=as(Rt),Ee--;for(;0<Be-Ee;)De=as(De),Be--;for(;Ee--;){if(Rt===De||De!==null&&Rt===De.alternate)break t;Rt=as(Rt),De=as(De)}Rt=null}else Rt=null;bt!==null&&xl(ct,it,bt,Rt,!1),Et!==null&&kr!==null&&xl(ct,kr,Et,Rt,!0)}}e:{if(it=qe?cs(qe):window,bt=it.nodeName&&it.nodeName.toLowerCase(),bt==="select"||bt==="input"&&it.type==="file")var kt=ll;else if(sl(it))if(Ts)kt=dl;else{kt=ul;var Dt=cl}else(bt=it.nodeName)&&bt.toLowerCase()==="input"&&(it.type==="checkbox"||it.type==="radio")&&(kt=hl);if(kt&&(kt=kt(n,qe))){ol(ct,kt,w,ot);break e}Dt&&Dt(n,it,qe),n==="focusout"&&(Dt=it._wrapperState)&&Dt.controlled&&it.type==="number"&&nt(it,"number",it.value)}switch(Dt=qe?cs(qe):window,n){case"focusin":(sl(Dt)||Dt.contentEditable==="true")&&(Xn=Dt,vo=qe,rs=null);break;case"focusout":rs=vo=Xn=null;break;case"mousedown":_o=!0;break;case"contextmenu":case"mouseup":case"dragend":_o=!1,ga(ct,w,ot);break;case"selectionchange":if(yo)break;case"keydown":case"keyup":ga(ct,w,ot)}var Ot;if(ea)e:{switch(n){case"compositionstart":var Gt="onCompositionStart";break e;case"compositionend":Gt="onCompositionEnd";break e;case"compositionupdate":Gt="onCompositionUpdate";break e}Gt=void 0}else Ni?ta(n,w)&&(Gt="onCompositionEnd"):n==="keydown"&&w.keyCode===229&&(Gt="onCompositionStart");Gt&&(nl&&w.locale!=="ko"&&(Ni||Gt!=="onCompositionStart"?Gt==="onCompositionEnd"&&Ni&&(Ot=Za()):(ci=ot,Ti="value"in ci?ci.value:ci.textContent,Ni=!0)),Dt=So(qe,Gt),0<Dt.length&&(Gt=new no(Gt,n,null,w,ot),ct.push({event:Gt,listeners:Dt}),Ot?Gt.data=Ot:(Ot=ra(w),Ot!==null&&(Gt.data=Ot)))),(Ot=zc?Nc(n,w):so(n,w))&&(qe=So(qe,"onBeforeInput"),0<qe.length&&(ot=new no("onBeforeInput","beforeinput",null,w,ot),ct.push({event:ot,listeners:qe}),ot.data=Ot))}bo(ct,a)})}function Ns(n,a,w){return{instance:n,listener:a,currentTarget:w}}function So(n,a){for(var w=a+"Capture",P=[];n!==null;){var G=n,Z=G.stateNode;G.tag===5&&Z!==null&&(G=Z,Z=ft(n,w),Z!=null&&P.unshift(Ns(n,Z,G)),Z=ft(n,a),Z!=null&&P.push(Ns(n,Z,G))),n=n.return}return P}function as(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function xl(n,a,w,P,G){for(var Z=a._reactName,re=[];w!==null&&w!==P;){var ge=w,Ce=ge.alternate,qe=ge.stateNode;if(Ce!==null&&Ce===P)break;ge.tag===5&&qe!==null&&(ge=qe,G?(Ce=ft(w,Z),Ce!=null&&re.unshift(Ns(w,Ce,ge))):G||(Ce=ft(w,Z),Ce!=null&&re.push(Ns(w,Ce,ge)))),w=w.return}re.length!==0&&n.push({event:a,listeners:re})}var Ic=/\r\n?/g,Fc=/\u0000|\uFFFD/g;function wl(n){return(typeof n=="string"?n:""+n).replace(Ic,`
`).replace(Fc,"")}function Co(n,a,w){if(a=wl(a),wl(n)!==a&&w)throw Error(t(425))}function Eo(){}var Ca=null,Ea=null;function kn(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Aa=typeof setTimeout=="function"?setTimeout:void 0,Lc=typeof clearTimeout=="function"?clearTimeout:void 0,Ma=typeof Promise=="function"?Promise:void 0,Dc=typeof queueMicrotask=="function"?queueMicrotask:typeof Ma<"u"?function(n){return Ma.resolve(null).then(n).catch(Oc)}:Aa;function Oc(n){setTimeout(function(){throw n})}function Di(n,a){var w=a,P=0;do{var G=w.nextSibling;if(n.removeChild(w),G&&G.nodeType===8)if(w=G.data,w==="/$"){if(P===0){n.removeChild(G),Ss(a);return}P--}else w!=="$"&&w!=="$?"&&w!=="$!"||P++;w=G}while(w);Ss(a)}function Bn(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return n}function Mo(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var w=n.data;if(w==="$"||w==="$!"||w==="$?"){if(a===0)return n;a--}else w==="/$"&&a++}n=n.previousSibling}return null}var ls=Math.random().toString(36).slice(2),In="__reactFiber$"+ls,Ps="__reactProps$"+ls,gn="__reactContainer$"+ls,Is="__reactEvents$"+ls,Bc="__reactListeners$"+ls,Uc="__reactHandles$"+ls;function Oi(n){var a=n[In];if(a)return a;for(var w=n.parentNode;w;){if(a=w[gn]||w[In]){if(w=a.alternate,a.child!==null||w!==null&&w.child!==null)for(n=Mo(n);n!==null;){if(w=n[In])return w;n=Mo(n)}return a}n=w,w=n.parentNode}return null}function Fs(n){return n=n[In]||n[gn],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function cs(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(t(33))}function Ro(n){return n[Ps]||null}var Ta=[],us=-1;function fi(n){return{current:n}}function gr(n){0>us||(n.current=Ta[us],Ta[us]=null,us--)}function fr(n,a){us++,Ta[us]=n.current,n.current=a}var pi={},jr=fi(pi),rn=fi(!1),mi=pi;function Bi(n,a){var w=n.type.contextTypes;if(!w)return pi;var P=n.stateNode;if(P&&P.__reactInternalMemoizedUnmaskedChildContext===a)return P.__reactInternalMemoizedMaskedChildContext;var G={},Z;for(Z in w)G[Z]=a[Z];return P&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=a,n.__reactInternalMemoizedMaskedChildContext=G),G}function Xr(n){return n=n.childContextTypes,n!=null}function Ls(){gr(rn),gr(jr)}function Ra(n,a,w){if(jr.current!==pi)throw Error(t(168));fr(jr,a),fr(rn,w)}function ka(n,a,w){var P=n.stateNode;if(a=a.childContextTypes,typeof P.getChildContext!="function")return w;P=P.getChildContext();for(var G in P)if(!(G in a))throw Error(t(108,fe(n)||"Unknown",G));return O({},w,P)}function Ds(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||pi,mi=jr.current,fr(jr,n),fr(rn,rn.current),!0}function za(n,a,w){var P=n.stateNode;if(!P)throw Error(t(169));w?(n=ka(n,a,mi),P.__reactInternalMemoizedMergedChildContext=n,gr(rn),gr(jr),fr(jr,n)):gr(rn),fr(rn,w)}var Un=null,ko=!1,z=!1;function Q(n){Un===null?Un=[n]:Un.push(n)}function F(n){ko=!0,Q(n)}function ae(){if(!z&&Un!==null){z=!0;var n=0,a=Vt;try{var w=Un;for(Vt=1;n<w.length;n++){var P=w[n];do P=P(!0);while(P!==null)}Un=null,ko=!1}catch(G){throw Un!==null&&(Un=Un.slice(n+1)),_i($n,ae),G}finally{Vt=a,z=!1}}return null}var ce=[],pe=0,Oe=null,Te=0,wt=[],be=0,Le=null,Jt=1,ut="";function tt(n,a){ce[pe++]=Te,ce[pe++]=Oe,Oe=n,Te=a}function pr(n,a,w){wt[be++]=Jt,wt[be++]=ut,wt[be++]=Le,Le=n;var P=Jt;n=ut;var G=32-pn(P)-1;P&=~(1<<G),w+=1;var Z=32-pn(a)+G;if(30<Z){var re=G-G%5;Z=(P&(1<<re)-1).toString(32),P>>=re,G-=re,Jt=1<<32-pn(a)+G|w<<G|P,ut=Z+n}else Jt=1<<Z|w<<G|P,ut=n}function vr(n){n.return!==null&&(tt(n,1),pr(n,1,0))}function er(n){for(;n===Oe;)Oe=ce[--pe],ce[pe]=null,Te=ce[--pe],ce[pe]=null;for(;n===Le;)Le=wt[--be],wt[be]=null,ut=wt[--be],wt[be]=null,Jt=wt[--be],wt[be]=null}var Pt=null,zt=null,lt=!1,It=null;function Er(n,a){var w=Hn(5,null,null,0);w.elementType="DELETED",w.stateNode=a,w.return=n,a=n.deletions,a===null?(n.deletions=[w],n.flags|=16):a.push(w)}function tr(n,a){switch(n.tag){case 5:var w=n.type;return a=a.nodeType!==1||w.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(n.stateNode=a,Pt=n,zt=Bn(a.firstChild),!0):!1;case 6:return a=n.pendingProps===""||a.nodeType!==3?null:a,a!==null?(n.stateNode=a,Pt=n,zt=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(w=Le!==null?{id:Jt,overflow:ut}:null,n.memoizedState={dehydrated:a,treeContext:w,retryLane:1073741824},w=Hn(18,null,null,0),w.stateNode=a,w.return=n,n.child=w,Pt=n,zt=null,!0):!1;default:return!1}}function Qt(n){return(n.mode&1)!==0&&(n.flags&128)===0}function lr(n){if(lt){var a=zt;if(a){var w=a;if(!tr(n,a)){if(Qt(n))throw Error(t(418));a=Bn(w.nextSibling);var P=Pt;a&&tr(n,a)?Er(P,w):(n.flags=n.flags&-4097|2,lt=!1,Pt=n)}}else{if(Qt(n))throw Error(t(418));n.flags=n.flags&-4097|2,lt=!1,Pt=n}}}function Lt(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Pt=n}function Ht(n){if(n!==Pt)return!1;if(!lt)return Lt(n),lt=!0,!1;var a;if((a=n.tag!==3)&&!(a=n.tag!==5)&&(a=n.type,a=a!=="head"&&a!=="body"&&!kn(n.type,n.memoizedProps)),a&&(a=zt)){if(Qt(n))throw Vr(),Error(t(418));for(;a;)Er(n,a),a=Bn(a.nextSibling)}if(Lt(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(t(317));e:{for(n=n.nextSibling,a=0;n;){if(n.nodeType===8){var w=n.data;if(w==="/$"){if(a===0){zt=Bn(n.nextSibling);break e}a--}else w!=="$"&&w!=="$!"&&w!=="$?"||a++}n=n.nextSibling}zt=null}}else zt=Pt?Bn(n.stateNode.nextSibling):null;return!0}function Vr(){for(var n=zt;n;)n=Bn(n.nextSibling)}function xn(){zt=Pt=null,lt=!1}function zo(n){It===null?It=[n]:It.push(n)}var No=T.ReactCurrentBatchConfig;function nn(n,a){if(n&&n.defaultProps){a=O({},a),n=n.defaultProps;for(var w in n)a[w]===void 0&&(a[w]=n[w]);return a}return a}var bl=fi(null),Sl=null,Po=null,Gc=null;function jc(){Gc=Po=Sl=null}function Vc(n){var a=bl.current;gr(bl),n._currentValue=a}function Wc(n,a,w){for(;n!==null;){var P=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,P!==null&&(P.childLanes|=a)):P!==null&&(P.childLanes&a)!==a&&(P.childLanes|=a),n===w)break;n=n.return}}function Io(n,a){Sl=n,Gc=Po=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&a)!==0&&(bn=!0),n.firstContext=null)}function jn(n){var a=n._currentValue;if(Gc!==n)if(n={context:n,memoizedValue:a,next:null},Po===null){if(Sl===null)throw Error(t(308));Po=n,Sl.dependencies={lanes:0,firstContext:n}}else Po=Po.next=n;return a}var Os=null;function Hc(n){Os===null?Os=[n]:Os.push(n)}function Du(n,a,w,P){var G=a.interleaved;return G===null?(w.next=w,Hc(a)):(w.next=G.next,G.next=w),a.interleaved=w,Ui(n,P)}function Ui(n,a){n.lanes|=a;var w=n.alternate;for(w!==null&&(w.lanes|=a),w=n,n=n.return;n!==null;)n.childLanes|=a,w=n.alternate,w!==null&&(w.childLanes|=a),w=n,n=n.return;return w.tag===3?w.stateNode:null}var ds=!1;function $c(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ou(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Gi(n,a){return{eventTime:n,lane:a,tag:0,payload:null,callback:null,next:null}}function fs(n,a,w){var P=n.updateQueue;if(P===null)return null;if(P=P.shared,(nr&2)!==0){var G=P.pending;return G===null?a.next=a:(a.next=G.next,G.next=a),P.pending=a,Ui(n,w)}return G=P.interleaved,G===null?(a.next=a,Hc(P)):(a.next=G.next,G.next=a),P.interleaved=a,Ui(n,w)}function Cl(n,a,w){if(a=a.updateQueue,a!==null&&(a=a.shared,(w&4194240)!==0)){var P=a.lanes;P&=n.pendingLanes,w|=P,a.lanes=w,On(n,w)}}function Bu(n,a){var w=n.updateQueue,P=n.alternate;if(P!==null&&(P=P.updateQueue,w===P)){var G=null,Z=null;if(w=w.firstBaseUpdate,w!==null){do{var re={eventTime:w.eventTime,lane:w.lane,tag:w.tag,payload:w.payload,callback:w.callback,next:null};Z===null?G=Z=re:Z=Z.next=re,w=w.next}while(w!==null);Z===null?G=Z=a:Z=Z.next=a}else G=Z=a;w={baseState:P.baseState,firstBaseUpdate:G,lastBaseUpdate:Z,shared:P.shared,effects:P.effects},n.updateQueue=w;return}n=w.lastBaseUpdate,n===null?w.firstBaseUpdate=a:n.next=a,w.lastBaseUpdate=a}function El(n,a,w,P){var G=n.updateQueue;ds=!1;var Z=G.firstBaseUpdate,re=G.lastBaseUpdate,ge=G.shared.pending;if(ge!==null){G.shared.pending=null;var Ce=ge,qe=Ce.next;Ce.next=null,re===null?Z=qe:re.next=qe,re=Ce;var ot=n.alternate;ot!==null&&(ot=ot.updateQueue,ge=ot.lastBaseUpdate,ge!==re&&(ge===null?ot.firstBaseUpdate=qe:ge.next=qe,ot.lastBaseUpdate=Ce))}if(Z!==null){var ct=G.baseState;re=0,ot=qe=Ce=null,ge=Z;do{var it=ge.lane,bt=ge.eventTime;if((P&it)===it){ot!==null&&(ot=ot.next={eventTime:bt,lane:0,tag:ge.tag,payload:ge.payload,callback:ge.callback,next:null});e:{var Et=n,Rt=ge;switch(it=a,bt=w,Rt.tag){case 1:if(Et=Rt.payload,typeof Et=="function"){ct=Et.call(bt,ct,it);break e}ct=Et;break e;case 3:Et.flags=Et.flags&-65537|128;case 0:if(Et=Rt.payload,it=typeof Et=="function"?Et.call(bt,ct,it):Et,it==null)break e;ct=O({},ct,it);break e;case 2:ds=!0}}ge.callback!==null&&ge.lane!==0&&(n.flags|=64,it=G.effects,it===null?G.effects=[ge]:it.push(ge))}else bt={eventTime:bt,lane:it,tag:ge.tag,payload:ge.payload,callback:ge.callback,next:null},ot===null?(qe=ot=bt,Ce=ct):ot=ot.next=bt,re|=it;if(ge=ge.next,ge===null){if(ge=G.shared.pending,ge===null)break;it=ge,ge=it.next,it.next=null,G.lastBaseUpdate=it,G.shared.pending=null}}while(!0);if(ot===null&&(Ce=ct),G.baseState=Ce,G.firstBaseUpdate=qe,G.lastBaseUpdate=ot,a=G.shared.interleaved,a!==null){G=a;do re|=G.lane,G=G.next;while(G!==a)}else Z===null&&(G.shared.lanes=0);Gs|=re,n.lanes=re,n.memoizedState=ct}}function Uu(n,a,w){if(n=a.effects,a.effects=null,n!==null)for(a=0;a<n.length;a++){var P=n[a],G=P.callback;if(G!==null){if(P.callback=null,P=w,typeof G!="function")throw Error(t(191,G));G.call(P)}}}var Gu=new r.Component().refs;function qc(n,a,w,P){a=n.memoizedState,w=w(P,a),w=w==null?a:O({},a,w),n.memoizedState=w,n.lanes===0&&(n.updateQueue.baseState=w)}var Al={isMounted:function(n){return(n=n._reactInternals)?Kt(n)===n:!1},enqueueSetState:function(n,a,w){n=n._reactInternals;var P=vn(),G=ys(n),Z=Gi(P,G);Z.payload=a,w!=null&&(Z.callback=w),a=fs(n,Z,G),a!==null&&(Kn(a,n,G,P),Cl(a,n,G))},enqueueReplaceState:function(n,a,w){n=n._reactInternals;var P=vn(),G=ys(n),Z=Gi(P,G);Z.tag=1,Z.payload=a,w!=null&&(Z.callback=w),a=fs(n,Z,G),a!==null&&(Kn(a,n,G,P),Cl(a,n,G))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var w=vn(),P=ys(n),G=Gi(w,P);G.tag=2,a!=null&&(G.callback=a),a=fs(n,G,P),a!==null&&(Kn(a,n,P,w),Cl(a,n,P))}};function ju(n,a,w,P,G,Z,re){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(P,Z,re):a.prototype&&a.prototype.isPureReactComponent?!Fi(w,P)||!Fi(G,Z):!0}function Vu(n,a,w){var P=!1,G=pi,Z=a.contextType;return typeof Z=="object"&&Z!==null?Z=jn(Z):(G=Xr(a)?mi:jr.current,P=a.contextTypes,Z=(P=P!=null)?Bi(n,G):pi),a=new a(w,Z),n.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Al,n.stateNode=a,a._reactInternals=n,P&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=G,n.__reactInternalMemoizedMaskedChildContext=Z),a}function Wu(n,a,w,P){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(w,P),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(w,P),a.state!==n&&Al.enqueueReplaceState(a,a.state,null)}function Yc(n,a,w,P){var G=n.stateNode;G.props=w,G.state=n.memoizedState,G.refs=Gu,$c(n);var Z=a.contextType;typeof Z=="object"&&Z!==null?G.context=jn(Z):(Z=Xr(a)?mi:jr.current,G.context=Bi(n,Z)),G.state=n.memoizedState,Z=a.getDerivedStateFromProps,typeof Z=="function"&&(qc(n,a,Z,w),G.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof G.getSnapshotBeforeUpdate=="function"||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(a=G.state,typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount(),a!==G.state&&Al.enqueueReplaceState(G,G.state,null),El(n,w,G,P),G.state=n.memoizedState),typeof G.componentDidMount=="function"&&(n.flags|=4194308)}function Na(n,a,w){if(n=w.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(w._owner){if(w=w._owner,w){if(w.tag!==1)throw Error(t(309));var P=w.stateNode}if(!P)throw Error(t(147,n));var G=P,Z=""+n;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===Z?a.ref:(a=function(re){var ge=G.refs;ge===Gu&&(ge=G.refs={}),re===null?delete ge[Z]:ge[Z]=re},a._stringRef=Z,a)}if(typeof n!="string")throw Error(t(284));if(!w._owner)throw Error(t(290,n))}return n}function Ml(n,a){throw n=Object.prototype.toString.call(a),Error(t(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n))}function Hu(n){var a=n._init;return a(n._payload)}function $u(n){function a(De,Ee){if(n){var Be=De.deletions;Be===null?(De.deletions=[Ee],De.flags|=16):Be.push(Ee)}}function w(De,Ee){if(!n)return null;for(;Ee!==null;)a(De,Ee),Ee=Ee.sibling;return null}function P(De,Ee){for(De=new Map;Ee!==null;)Ee.key!==null?De.set(Ee.key,Ee):De.set(Ee.index,Ee),Ee=Ee.sibling;return De}function G(De,Ee){return De=_s(De,Ee),De.index=0,De.sibling=null,De}function Z(De,Ee,Be){return De.index=Be,n?(Be=De.alternate,Be!==null?(Be=Be.index,Be<Ee?(De.flags|=2,Ee):Be):(De.flags|=2,Ee)):(De.flags|=1048576,Ee)}function re(De){return n&&De.alternate===null&&(De.flags|=2),De}function ge(De,Ee,Be,dt){return Ee===null||Ee.tag!==6?(Ee=zu(Be,De.mode,dt),Ee.return=De,Ee):(Ee=G(Ee,Be),Ee.return=De,Ee)}function Ce(De,Ee,Be,dt){var kt=Be.type;return kt===M?ot(De,Ee,Be.props.children,dt,Be.key):Ee!==null&&(Ee.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===W&&Hu(kt)===Ee.type)?(dt=G(Ee,Be.props),dt.ref=Na(De,Ee,Be),dt.return=De,dt):(dt=$l(Be.type,Be.key,Be.props,null,De.mode,dt),dt.ref=Na(De,Ee,Be),dt.return=De,dt)}function qe(De,Ee,Be,dt){return Ee===null||Ee.tag!==4||Ee.stateNode.containerInfo!==Be.containerInfo||Ee.stateNode.implementation!==Be.implementation?(Ee=Nu(Be,De.mode,dt),Ee.return=De,Ee):(Ee=G(Ee,Be.children||[]),Ee.return=De,Ee)}function ot(De,Ee,Be,dt,kt){return Ee===null||Ee.tag!==7?(Ee=Hs(Be,De.mode,dt,kt),Ee.return=De,Ee):(Ee=G(Ee,Be),Ee.return=De,Ee)}function ct(De,Ee,Be){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return Ee=zu(""+Ee,De.mode,Be),Ee.return=De,Ee;if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case u:return Be=$l(Ee.type,Ee.key,Ee.props,null,De.mode,Be),Be.ref=Na(De,null,Ee),Be.return=De,Be;case _:return Ee=Nu(Ee,De.mode,Be),Ee.return=De,Ee;case W:var dt=Ee._init;return ct(De,dt(Ee._payload),Be)}if(rt(Ee)||$(Ee))return Ee=Hs(Ee,De.mode,Be,null),Ee.return=De,Ee;Ml(De,Ee)}return null}function it(De,Ee,Be,dt){var kt=Ee!==null?Ee.key:null;if(typeof Be=="string"&&Be!==""||typeof Be=="number")return kt!==null?null:ge(De,Ee,""+Be,dt);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case u:return Be.key===kt?Ce(De,Ee,Be,dt):null;case _:return Be.key===kt?qe(De,Ee,Be,dt):null;case W:return kt=Be._init,it(De,Ee,kt(Be._payload),dt)}if(rt(Be)||$(Be))return kt!==null?null:ot(De,Ee,Be,dt,null);Ml(De,Be)}return null}function bt(De,Ee,Be,dt,kt){if(typeof dt=="string"&&dt!==""||typeof dt=="number")return De=De.get(Be)||null,ge(Ee,De,""+dt,kt);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case u:return De=De.get(dt.key===null?Be:dt.key)||null,Ce(Ee,De,dt,kt);case _:return De=De.get(dt.key===null?Be:dt.key)||null,qe(Ee,De,dt,kt);case W:var Dt=dt._init;return bt(De,Ee,Be,Dt(dt._payload),kt)}if(rt(dt)||$(dt))return De=De.get(Be)||null,ot(Ee,De,dt,kt,null);Ml(Ee,dt)}return null}function Et(De,Ee,Be,dt){for(var kt=null,Dt=null,Ot=Ee,Gt=Ee=0,qr=null;Ot!==null&&Gt<Be.length;Gt++){Ot.index>Gt?(qr=Ot,Ot=null):qr=Ot.sibling;var or=it(De,Ot,Be[Gt],dt);if(or===null){Ot===null&&(Ot=qr);break}n&&Ot&&or.alternate===null&&a(De,Ot),Ee=Z(or,Ee,Gt),Dt===null?kt=or:Dt.sibling=or,Dt=or,Ot=qr}if(Gt===Be.length)return w(De,Ot),lt&&tt(De,Gt),kt;if(Ot===null){for(;Gt<Be.length;Gt++)Ot=ct(De,Be[Gt],dt),Ot!==null&&(Ee=Z(Ot,Ee,Gt),Dt===null?kt=Ot:Dt.sibling=Ot,Dt=Ot);return lt&&tt(De,Gt),kt}for(Ot=P(De,Ot);Gt<Be.length;Gt++)qr=bt(Ot,De,Gt,Be[Gt],dt),qr!==null&&(n&&qr.alternate!==null&&Ot.delete(qr.key===null?Gt:qr.key),Ee=Z(qr,Ee,Gt),Dt===null?kt=qr:Dt.sibling=qr,Dt=qr);return n&&Ot.forEach(function(xs){return a(De,xs)}),lt&&tt(De,Gt),kt}function Rt(De,Ee,Be,dt){var kt=$(Be);if(typeof kt!="function")throw Error(t(150));if(Be=kt.call(Be),Be==null)throw Error(t(151));for(var Dt=kt=null,Ot=Ee,Gt=Ee=0,qr=null,or=Be.next();Ot!==null&&!or.done;Gt++,or=Be.next()){Ot.index>Gt?(qr=Ot,Ot=null):qr=Ot.sibling;var xs=it(De,Ot,or.value,dt);if(xs===null){Ot===null&&(Ot=qr);break}n&&Ot&&xs.alternate===null&&a(De,Ot),Ee=Z(xs,Ee,Gt),Dt===null?kt=xs:Dt.sibling=xs,Dt=xs,Ot=qr}if(or.done)return w(De,Ot),lt&&tt(De,Gt),kt;if(Ot===null){for(;!or.done;Gt++,or=Be.next())or=ct(De,or.value,dt),or!==null&&(Ee=Z(or,Ee,Gt),Dt===null?kt=or:Dt.sibling=or,Dt=or);return lt&&tt(De,Gt),kt}for(Ot=P(De,Ot);!or.done;Gt++,or=Be.next())or=bt(Ot,De,Gt,or.value,dt),or!==null&&(n&&or.alternate!==null&&Ot.delete(or.key===null?Gt:or.key),Ee=Z(or,Ee,Gt),Dt===null?kt=or:Dt.sibling=or,Dt=or);return n&&Ot.forEach(function(Ud){return a(De,Ud)}),lt&&tt(De,Gt),kt}function kr(De,Ee,Be,dt){if(typeof Be=="object"&&Be!==null&&Be.type===M&&Be.key===null&&(Be=Be.props.children),typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case u:e:{for(var kt=Be.key,Dt=Ee;Dt!==null;){if(Dt.key===kt){if(kt=Be.type,kt===M){if(Dt.tag===7){w(De,Dt.sibling),Ee=G(Dt,Be.props.children),Ee.return=De,De=Ee;break e}}else if(Dt.elementType===kt||typeof kt=="object"&&kt!==null&&kt.$$typeof===W&&Hu(kt)===Dt.type){w(De,Dt.sibling),Ee=G(Dt,Be.props),Ee.ref=Na(De,Dt,Be),Ee.return=De,De=Ee;break e}w(De,Dt);break}else a(De,Dt);Dt=Dt.sibling}Be.type===M?(Ee=Hs(Be.props.children,De.mode,dt,Be.key),Ee.return=De,De=Ee):(dt=$l(Be.type,Be.key,Be.props,null,De.mode,dt),dt.ref=Na(De,Ee,Be),dt.return=De,De=dt)}return re(De);case _:e:{for(Dt=Be.key;Ee!==null;){if(Ee.key===Dt)if(Ee.tag===4&&Ee.stateNode.containerInfo===Be.containerInfo&&Ee.stateNode.implementation===Be.implementation){w(De,Ee.sibling),Ee=G(Ee,Be.children||[]),Ee.return=De,De=Ee;break e}else{w(De,Ee);break}else a(De,Ee);Ee=Ee.sibling}Ee=Nu(Be,De.mode,dt),Ee.return=De,De=Ee}return re(De);case W:return Dt=Be._init,kr(De,Ee,Dt(Be._payload),dt)}if(rt(Be))return Et(De,Ee,Be,dt);if($(Be))return Rt(De,Ee,Be,dt);Ml(De,Be)}return typeof Be=="string"&&Be!==""||typeof Be=="number"?(Be=""+Be,Ee!==null&&Ee.tag===6?(w(De,Ee.sibling),Ee=G(Ee,Be),Ee.return=De,De=Ee):(w(De,Ee),Ee=zu(Be,De.mode,dt),Ee.return=De,De=Ee),re(De)):w(De,Ee)}return kr}var Fo=$u(!0),qu=$u(!1),Pa={},gi=fi(Pa),Ia=fi(Pa),Fa=fi(Pa);function Bs(n){if(n===Pa)throw Error(t(174));return n}function Xc(n,a){switch(fr(Fa,a),fr(Ia,n),fr(gi,Pa),n=a.nodeType,n){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:te(null,"");break;default:n=n===8?a.parentNode:a,a=n.namespaceURI||null,n=n.tagName,a=te(a,n)}gr(gi),fr(gi,a)}function Lo(){gr(gi),gr(Ia),gr(Fa)}function Yu(n){Bs(Fa.current);var a=Bs(gi.current),w=te(a,n.type);a!==w&&(fr(Ia,n),fr(gi,w))}function Zc(n){Ia.current===n&&(gr(gi),gr(Ia))}var wr=fi(0);function Tl(n){for(var a=n;a!==null;){if(a.tag===13){var w=a.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||w.data==="$?"||w.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Jc=[];function Qc(){for(var n=0;n<Jc.length;n++)Jc[n]._workInProgressVersionPrimary=null;Jc.length=0}var Rl=T.ReactCurrentDispatcher,Kc=T.ReactCurrentBatchConfig,Us=0,Sr=null,Or=null,Wr=null,kl=!1,La=!1,Da=0,ld=0;function ln(){throw Error(t(321))}function eu(n,a){if(a===null)return!1;for(var w=0;w<a.length&&w<n.length;w++)if(!Rr(n[w],a[w]))return!1;return!0}function tu(n,a,w,P,G,Z){if(Us=Z,Sr=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Rl.current=n===null||n.memoizedState===null?dd:fd,n=w(P,G),La){Z=0;do{if(La=!1,Da=0,25<=Z)throw Error(t(301));Z+=1,Wr=Or=null,a.updateQueue=null,Rl.current=pd,n=w(P,G)}while(La)}if(Rl.current=Pl,a=Or!==null&&Or.next!==null,Us=0,Wr=Or=Sr=null,kl=!1,a)throw Error(t(300));return n}function ru(){var n=Da!==0;return Da=0,n}function yi(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wr===null?Sr.memoizedState=Wr=n:Wr=Wr.next=n,Wr}function Vn(){if(Or===null){var n=Sr.alternate;n=n!==null?n.memoizedState:null}else n=Or.next;var a=Wr===null?Sr.memoizedState:Wr.next;if(a!==null)Wr=a,Or=n;else{if(n===null)throw Error(t(310));Or=n,n={memoizedState:Or.memoizedState,baseState:Or.baseState,baseQueue:Or.baseQueue,queue:Or.queue,next:null},Wr===null?Sr.memoizedState=Wr=n:Wr=Wr.next=n}return Wr}function Oa(n,a){return typeof a=="function"?a(n):a}function nu(n){var a=Vn(),w=a.queue;if(w===null)throw Error(t(311));w.lastRenderedReducer=n;var P=Or,G=P.baseQueue,Z=w.pending;if(Z!==null){if(G!==null){var re=G.next;G.next=Z.next,Z.next=re}P.baseQueue=G=Z,w.pending=null}if(G!==null){Z=G.next,P=P.baseState;var ge=re=null,Ce=null,qe=Z;do{var ot=qe.lane;if((Us&ot)===ot)Ce!==null&&(Ce=Ce.next={lane:0,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null}),P=qe.hasEagerState?qe.eagerState:n(P,qe.action);else{var ct={lane:ot,action:qe.action,hasEagerState:qe.hasEagerState,eagerState:qe.eagerState,next:null};Ce===null?(ge=Ce=ct,re=P):Ce=Ce.next=ct,Sr.lanes|=ot,Gs|=ot}qe=qe.next}while(qe!==null&&qe!==Z);Ce===null?re=P:Ce.next=ge,Rr(P,a.memoizedState)||(bn=!0),a.memoizedState=P,a.baseState=re,a.baseQueue=Ce,w.lastRenderedState=P}if(n=w.interleaved,n!==null){G=n;do Z=G.lane,Sr.lanes|=Z,Gs|=Z,G=G.next;while(G!==n)}else G===null&&(w.lanes=0);return[a.memoizedState,w.dispatch]}function iu(n){var a=Vn(),w=a.queue;if(w===null)throw Error(t(311));w.lastRenderedReducer=n;var P=w.dispatch,G=w.pending,Z=a.memoizedState;if(G!==null){w.pending=null;var re=G=G.next;do Z=n(Z,re.action),re=re.next;while(re!==G);Rr(Z,a.memoizedState)||(bn=!0),a.memoizedState=Z,a.baseQueue===null&&(a.baseState=Z),w.lastRenderedState=Z}return[Z,P]}function Xu(){}function Zu(n,a){var w=Sr,P=Vn(),G=a(),Z=!Rr(P.memoizedState,G);if(Z&&(P.memoizedState=G,bn=!0),P=P.queue,su(Ku.bind(null,w,P,n),[n]),P.getSnapshot!==a||Z||Wr!==null&&Wr.memoizedState.tag&1){if(w.flags|=2048,Ba(9,Qu.bind(null,w,P,G,a),void 0,null),$r===null)throw Error(t(349));(Us&30)!==0||Ju(w,a,G)}return G}function Ju(n,a,w){n.flags|=16384,n={getSnapshot:a,value:w},a=Sr.updateQueue,a===null?(a={lastEffect:null,stores:null},Sr.updateQueue=a,a.stores=[n]):(w=a.stores,w===null?a.stores=[n]:w.push(n))}function Qu(n,a,w,P){a.value=w,a.getSnapshot=P,eh(a)&&th(n)}function Ku(n,a,w){return w(function(){eh(a)&&th(n)})}function eh(n){var a=n.getSnapshot;n=n.value;try{var w=a();return!Rr(n,w)}catch{return!0}}function th(n){var a=Ui(n,1);a!==null&&Kn(a,n,1,-1)}function rh(n){var a=yi();return typeof n=="function"&&(n=n()),a.memoizedState=a.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oa,lastRenderedState:n},a.queue=n,n=n.dispatch=hd.bind(null,Sr,n),[a.memoizedState,n]}function Ba(n,a,w,P){return n={tag:n,create:a,destroy:w,deps:P,next:null},a=Sr.updateQueue,a===null?(a={lastEffect:null,stores:null},Sr.updateQueue=a,a.lastEffect=n.next=n):(w=a.lastEffect,w===null?a.lastEffect=n.next=n:(P=w.next,w.next=n,n.next=P,a.lastEffect=n)),n}function nh(){return Vn().memoizedState}function zl(n,a,w,P){var G=yi();Sr.flags|=n,G.memoizedState=Ba(1|a,w,void 0,P===void 0?null:P)}function Nl(n,a,w,P){var G=Vn();P=P===void 0?null:P;var Z=void 0;if(Or!==null){var re=Or.memoizedState;if(Z=re.destroy,P!==null&&eu(P,re.deps)){G.memoizedState=Ba(a,w,Z,P);return}}Sr.flags|=n,G.memoizedState=Ba(1|a,w,Z,P)}function ih(n,a){return zl(8390656,8,n,a)}function su(n,a){return Nl(2048,8,n,a)}function sh(n,a){return Nl(4,2,n,a)}function oh(n,a){return Nl(4,4,n,a)}function ah(n,a){if(typeof a=="function")return n=n(),a(n),function(){a(null)};if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function lh(n,a,w){return w=w!=null?w.concat([n]):null,Nl(4,4,ah.bind(null,a,n),w)}function ou(){}function ch(n,a){var w=Vn();a=a===void 0?null:a;var P=w.memoizedState;return P!==null&&a!==null&&eu(a,P[1])?P[0]:(w.memoizedState=[n,a],n)}function uh(n,a){var w=Vn();a=a===void 0?null:a;var P=w.memoizedState;return P!==null&&a!==null&&eu(a,P[1])?P[0]:(n=n(),w.memoizedState=[n,a],n)}function hh(n,a,w){return(Us&21)===0?(n.baseState&&(n.baseState=!1,bn=!0),n.memoizedState=w):(Rr(w,a)||(w=ni(),Sr.lanes|=w,Gs|=w,n.baseState=!0),a)}function cd(n,a){var w=Vt;Vt=w!==0&&4>w?w:4,n(!0);var P=Kc.transition;Kc.transition={};try{n(!1),a()}finally{Vt=w,Kc.transition=P}}function dh(){return Vn().memoizedState}function ud(n,a,w){var P=ys(n);if(w={lane:P,action:w,hasEagerState:!1,eagerState:null,next:null},fh(n))ph(a,w);else if(w=Du(n,a,w,P),w!==null){var G=vn();Kn(w,n,P,G),mh(w,a,P)}}function hd(n,a,w){var P=ys(n),G={lane:P,action:w,hasEagerState:!1,eagerState:null,next:null};if(fh(n))ph(a,G);else{var Z=n.alternate;if(n.lanes===0&&(Z===null||Z.lanes===0)&&(Z=a.lastRenderedReducer,Z!==null))try{var re=a.lastRenderedState,ge=Z(re,w);if(G.hasEagerState=!0,G.eagerState=ge,Rr(ge,re)){var Ce=a.interleaved;Ce===null?(G.next=G,Hc(a)):(G.next=Ce.next,Ce.next=G),a.interleaved=G;return}}catch{}finally{}w=Du(n,a,G,P),w!==null&&(G=vn(),Kn(w,n,P,G),mh(w,a,P))}}function fh(n){var a=n.alternate;return n===Sr||a!==null&&a===Sr}function ph(n,a){La=kl=!0;var w=n.pending;w===null?a.next=a:(a.next=w.next,w.next=a),n.pending=a}function mh(n,a,w){if((w&4194240)!==0){var P=a.lanes;P&=n.pendingLanes,w|=P,a.lanes=w,On(n,w)}}var Pl={readContext:jn,useCallback:ln,useContext:ln,useEffect:ln,useImperativeHandle:ln,useInsertionEffect:ln,useLayoutEffect:ln,useMemo:ln,useReducer:ln,useRef:ln,useState:ln,useDebugValue:ln,useDeferredValue:ln,useTransition:ln,useMutableSource:ln,useSyncExternalStore:ln,useId:ln,unstable_isNewReconciler:!1},dd={readContext:jn,useCallback:function(n,a){return yi().memoizedState=[n,a===void 0?null:a],n},useContext:jn,useEffect:ih,useImperativeHandle:function(n,a,w){return w=w!=null?w.concat([n]):null,zl(4194308,4,ah.bind(null,a,n),w)},useLayoutEffect:function(n,a){return zl(4194308,4,n,a)},useInsertionEffect:function(n,a){return zl(4,2,n,a)},useMemo:function(n,a){var w=yi();return a=a===void 0?null:a,n=n(),w.memoizedState=[n,a],n},useReducer:function(n,a,w){var P=yi();return a=w!==void 0?w(a):a,P.memoizedState=P.baseState=a,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:a},P.queue=n,n=n.dispatch=ud.bind(null,Sr,n),[P.memoizedState,n]},useRef:function(n){var a=yi();return n={current:n},a.memoizedState=n},useState:rh,useDebugValue:ou,useDeferredValue:function(n){return yi().memoizedState=n},useTransition:function(){var n=rh(!1),a=n[0];return n=cd.bind(null,n[1]),yi().memoizedState=n,[a,n]},useMutableSource:function(){},useSyncExternalStore:function(n,a,w){var P=Sr,G=yi();if(lt){if(w===void 0)throw Error(t(407));w=w()}else{if(w=a(),$r===null)throw Error(t(349));(Us&30)!==0||Ju(P,a,w)}G.memoizedState=w;var Z={value:w,getSnapshot:a};return G.queue=Z,ih(Ku.bind(null,P,Z,n),[n]),P.flags|=2048,Ba(9,Qu.bind(null,P,Z,w,a),void 0,null),w},useId:function(){var n=yi(),a=$r.identifierPrefix;if(lt){var w=ut,P=Jt;w=(P&~(1<<32-pn(P)-1)).toString(32)+w,a=":"+a+"R"+w,w=Da++,0<w&&(a+="H"+w.toString(32)),a+=":"}else w=ld++,a=":"+a+"r"+w.toString(32)+":";return n.memoizedState=a},unstable_isNewReconciler:!1},fd={readContext:jn,useCallback:ch,useContext:jn,useEffect:su,useImperativeHandle:lh,useInsertionEffect:sh,useLayoutEffect:oh,useMemo:uh,useReducer:nu,useRef:nh,useState:function(){return nu(Oa)},useDebugValue:ou,useDeferredValue:function(n){var a=Vn();return hh(a,Or.memoizedState,n)},useTransition:function(){var n=nu(Oa)[0],a=Vn().memoizedState;return[n,a]},useMutableSource:Xu,useSyncExternalStore:Zu,useId:dh,unstable_isNewReconciler:!1},pd={readContext:jn,useCallback:ch,useContext:jn,useEffect:su,useImperativeHandle:lh,useInsertionEffect:sh,useLayoutEffect:oh,useMemo:uh,useReducer:iu,useRef:nh,useState:function(){return iu(Oa)},useDebugValue:ou,useDeferredValue:function(n){var a=Vn();return Or===null?a.memoizedState=n:hh(a,Or.memoizedState,n)},useTransition:function(){var n=iu(Oa)[0],a=Vn().memoizedState;return[n,a]},useMutableSource:Xu,useSyncExternalStore:Zu,useId:dh,unstable_isNewReconciler:!1};function Do(n,a){try{var w="",P=a;do w+=he(P),P=P.return;while(P);var G=w}catch(Z){G=`
Error generating stack: `+Z.message+`
`+Z.stack}return{value:n,source:a,stack:G,digest:null}}function au(n,a,w){return{value:n,source:null,stack:w??null,digest:a??null}}function lu(n,a){try{console.error(a.value)}catch(w){setTimeout(function(){throw w})}}var md=typeof WeakMap=="function"?WeakMap:Map;function gh(n,a,w){w=Gi(-1,w),w.tag=3,w.payload={element:null};var P=a.value;return w.callback=function(){Ul||(Ul=!0,Su=P),lu(n,a)},w}function yh(n,a,w){w=Gi(-1,w),w.tag=3;var P=n.type.getDerivedStateFromError;if(typeof P=="function"){var G=a.value;w.payload=function(){return P(G)},w.callback=function(){lu(n,a)}}var Z=n.stateNode;return Z!==null&&typeof Z.componentDidCatch=="function"&&(w.callback=function(){lu(n,a),typeof P!="function"&&(ms===null?ms=new Set([this]):ms.add(this));var re=a.stack;this.componentDidCatch(a.value,{componentStack:re!==null?re:""})}),w}function vh(n,a,w){var P=n.pingCache;if(P===null){P=n.pingCache=new md;var G=new Set;P.set(a,G)}else G=P.get(a),G===void 0&&(G=new Set,P.set(a,G));G.has(w)||(G.add(w),n=Rd.bind(null,n,a,w),a.then(n,n))}function _h(n){do{var a;if((a=n.tag===13)&&(a=n.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return n;n=n.return}while(n!==null);return null}function xh(n,a,w,P,G){return(n.mode&1)===0?(n===a?n.flags|=65536:(n.flags|=128,w.flags|=131072,w.flags&=-52805,w.tag===1&&(w.alternate===null?w.tag=17:(a=Gi(-1,1),a.tag=2,fs(w,a,1))),w.lanes|=1),n):(n.flags|=65536,n.lanes=G,n)}var gd=T.ReactCurrentOwner,bn=!1;function yn(n,a,w,P){a.child=n===null?qu(a,null,w,P):Fo(a,n.child,w,P)}function wh(n,a,w,P,G){w=w.render;var Z=a.ref;return Io(a,G),P=tu(n,a,w,P,Z,G),w=ru(),n!==null&&!bn?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~G,ji(n,a,G)):(lt&&w&&vr(a),a.flags|=1,yn(n,a,P,G),a.child)}function bh(n,a,w,P,G){if(n===null){var Z=w.type;return typeof Z=="function"&&!ku(Z)&&Z.defaultProps===void 0&&w.compare===null&&w.defaultProps===void 0?(a.tag=15,a.type=Z,Sh(n,a,Z,P,G)):(n=$l(w.type,null,P,a,a.mode,G),n.ref=a.ref,n.return=a,a.child=n)}if(Z=n.child,(n.lanes&G)===0){var re=Z.memoizedProps;if(w=w.compare,w=w!==null?w:Fi,w(re,P)&&n.ref===a.ref)return ji(n,a,G)}return a.flags|=1,n=_s(Z,P),n.ref=a.ref,n.return=a,a.child=n}function Sh(n,a,w,P,G){if(n!==null){var Z=n.memoizedProps;if(Fi(Z,P)&&n.ref===a.ref)if(bn=!1,a.pendingProps=P=Z,(n.lanes&G)!==0)(n.flags&131072)!==0&&(bn=!0);else return a.lanes=n.lanes,ji(n,a,G)}return cu(n,a,w,P,G)}function Ch(n,a,w){var P=a.pendingProps,G=P.children,Z=n!==null?n.memoizedState:null;if(P.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},fr(Bo,Fn),Fn|=w;else{if((w&1073741824)===0)return n=Z!==null?Z.baseLanes|w:w,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:n,cachePool:null,transitions:null},a.updateQueue=null,fr(Bo,Fn),Fn|=n,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},P=Z!==null?Z.baseLanes:w,fr(Bo,Fn),Fn|=P}else Z!==null?(P=Z.baseLanes|w,a.memoizedState=null):P=w,fr(Bo,Fn),Fn|=P;return yn(n,a,G,w),a.child}function Eh(n,a){var w=a.ref;(n===null&&w!==null||n!==null&&n.ref!==w)&&(a.flags|=512,a.flags|=2097152)}function cu(n,a,w,P,G){var Z=Xr(w)?mi:jr.current;return Z=Bi(a,Z),Io(a,G),w=tu(n,a,w,P,Z,G),P=ru(),n!==null&&!bn?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~G,ji(n,a,G)):(lt&&P&&vr(a),a.flags|=1,yn(n,a,w,G),a.child)}function Ah(n,a,w,P,G){if(Xr(w)){var Z=!0;Ds(a)}else Z=!1;if(Io(a,G),a.stateNode===null)Fl(n,a),Vu(a,w,P),Yc(a,w,P,G),P=!0;else if(n===null){var re=a.stateNode,ge=a.memoizedProps;re.props=ge;var Ce=re.context,qe=w.contextType;typeof qe=="object"&&qe!==null?qe=jn(qe):(qe=Xr(w)?mi:jr.current,qe=Bi(a,qe));var ot=w.getDerivedStateFromProps,ct=typeof ot=="function"||typeof re.getSnapshotBeforeUpdate=="function";ct||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(ge!==P||Ce!==qe)&&Wu(a,re,P,qe),ds=!1;var it=a.memoizedState;re.state=it,El(a,P,re,G),Ce=a.memoizedState,ge!==P||it!==Ce||rn.current||ds?(typeof ot=="function"&&(qc(a,w,ot,P),Ce=a.memoizedState),(ge=ds||ju(a,w,ge,P,it,Ce,qe))?(ct||typeof re.UNSAFE_componentWillMount!="function"&&typeof re.componentWillMount!="function"||(typeof re.componentWillMount=="function"&&re.componentWillMount(),typeof re.UNSAFE_componentWillMount=="function"&&re.UNSAFE_componentWillMount()),typeof re.componentDidMount=="function"&&(a.flags|=4194308)):(typeof re.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=P,a.memoizedState=Ce),re.props=P,re.state=Ce,re.context=qe,P=ge):(typeof re.componentDidMount=="function"&&(a.flags|=4194308),P=!1)}else{re=a.stateNode,Ou(n,a),ge=a.memoizedProps,qe=a.type===a.elementType?ge:nn(a.type,ge),re.props=qe,ct=a.pendingProps,it=re.context,Ce=w.contextType,typeof Ce=="object"&&Ce!==null?Ce=jn(Ce):(Ce=Xr(w)?mi:jr.current,Ce=Bi(a,Ce));var bt=w.getDerivedStateFromProps;(ot=typeof bt=="function"||typeof re.getSnapshotBeforeUpdate=="function")||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(ge!==ct||it!==Ce)&&Wu(a,re,P,Ce),ds=!1,it=a.memoizedState,re.state=it,El(a,P,re,G);var Et=a.memoizedState;ge!==ct||it!==Et||rn.current||ds?(typeof bt=="function"&&(qc(a,w,bt,P),Et=a.memoizedState),(qe=ds||ju(a,w,qe,P,it,Et,Ce)||!1)?(ot||typeof re.UNSAFE_componentWillUpdate!="function"&&typeof re.componentWillUpdate!="function"||(typeof re.componentWillUpdate=="function"&&re.componentWillUpdate(P,Et,Ce),typeof re.UNSAFE_componentWillUpdate=="function"&&re.UNSAFE_componentWillUpdate(P,Et,Ce)),typeof re.componentDidUpdate=="function"&&(a.flags|=4),typeof re.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof re.componentDidUpdate!="function"||ge===n.memoizedProps&&it===n.memoizedState||(a.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||ge===n.memoizedProps&&it===n.memoizedState||(a.flags|=1024),a.memoizedProps=P,a.memoizedState=Et),re.props=P,re.state=Et,re.context=Ce,P=qe):(typeof re.componentDidUpdate!="function"||ge===n.memoizedProps&&it===n.memoizedState||(a.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||ge===n.memoizedProps&&it===n.memoizedState||(a.flags|=1024),P=!1)}return uu(n,a,w,P,Z,G)}function uu(n,a,w,P,G,Z){Eh(n,a);var re=(a.flags&128)!==0;if(!P&&!re)return G&&za(a,w,!1),ji(n,a,Z);P=a.stateNode,gd.current=a;var ge=re&&typeof w.getDerivedStateFromError!="function"?null:P.render();return a.flags|=1,n!==null&&re?(a.child=Fo(a,n.child,null,Z),a.child=Fo(a,null,ge,Z)):yn(n,a,ge,Z),a.memoizedState=P.state,G&&za(a,w,!0),a.child}function Mh(n){var a=n.stateNode;a.pendingContext?Ra(n,a.pendingContext,a.pendingContext!==a.context):a.context&&Ra(n,a.context,!1),Xc(n,a.containerInfo)}function Th(n,a,w,P,G){return xn(),zo(G),a.flags|=256,yn(n,a,w,P),a.child}var hu={dehydrated:null,treeContext:null,retryLane:0};function du(n){return{baseLanes:n,cachePool:null,transitions:null}}function Rh(n,a,w){var P=a.pendingProps,G=wr.current,Z=!1,re=(a.flags&128)!==0,ge;if((ge=re)||(ge=n!==null&&n.memoizedState===null?!1:(G&2)!==0),ge?(Z=!0,a.flags&=-129):(n===null||n.memoizedState!==null)&&(G|=1),fr(wr,G&1),n===null)return lr(a),n=a.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((a.mode&1)===0?a.lanes=1:n.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(re=P.children,n=P.fallback,Z?(P=a.mode,Z=a.child,re={mode:"hidden",children:re},(P&1)===0&&Z!==null?(Z.childLanes=0,Z.pendingProps=re):Z=ql(re,P,0,null),n=Hs(n,P,w,null),Z.return=a,n.return=a,Z.sibling=n,a.child=Z,a.child.memoizedState=du(w),a.memoizedState=hu,n):fu(a,re));if(G=n.memoizedState,G!==null&&(ge=G.dehydrated,ge!==null))return yd(n,a,re,P,ge,G,w);if(Z){Z=P.fallback,re=a.mode,G=n.child,ge=G.sibling;var Ce={mode:"hidden",children:P.children};return(re&1)===0&&a.child!==G?(P=a.child,P.childLanes=0,P.pendingProps=Ce,a.deletions=null):(P=_s(G,Ce),P.subtreeFlags=G.subtreeFlags&14680064),ge!==null?Z=_s(ge,Z):(Z=Hs(Z,re,w,null),Z.flags|=2),Z.return=a,P.return=a,P.sibling=Z,a.child=P,P=Z,Z=a.child,re=n.child.memoizedState,re=re===null?du(w):{baseLanes:re.baseLanes|w,cachePool:null,transitions:re.transitions},Z.memoizedState=re,Z.childLanes=n.childLanes&~w,a.memoizedState=hu,P}return Z=n.child,n=Z.sibling,P=_s(Z,{mode:"visible",children:P.children}),(a.mode&1)===0&&(P.lanes=w),P.return=a,P.sibling=null,n!==null&&(w=a.deletions,w===null?(a.deletions=[n],a.flags|=16):w.push(n)),a.child=P,a.memoizedState=null,P}function fu(n,a){return a=ql({mode:"visible",children:a},n.mode,0,null),a.return=n,n.child=a}function Il(n,a,w,P){return P!==null&&zo(P),Fo(a,n.child,null,w),n=fu(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function yd(n,a,w,P,G,Z,re){if(w)return a.flags&256?(a.flags&=-257,P=au(Error(t(422))),Il(n,a,re,P)):a.memoizedState!==null?(a.child=n.child,a.flags|=128,null):(Z=P.fallback,G=a.mode,P=ql({mode:"visible",children:P.children},G,0,null),Z=Hs(Z,G,re,null),Z.flags|=2,P.return=a,Z.return=a,P.sibling=Z,a.child=P,(a.mode&1)!==0&&Fo(a,n.child,null,re),a.child.memoizedState=du(re),a.memoizedState=hu,Z);if((a.mode&1)===0)return Il(n,a,re,null);if(G.data==="$!"){if(P=G.nextSibling&&G.nextSibling.dataset,P)var ge=P.dgst;return P=ge,Z=Error(t(419)),P=au(Z,P,void 0),Il(n,a,re,P)}if(ge=(re&n.childLanes)!==0,bn||ge){if(P=$r,P!==null){switch(re&-re){case 4:G=2;break;case 16:G=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:G=32;break;case 536870912:G=268435456;break;default:G=0}G=(G&(P.suspendedLanes|re))!==0?0:G,G!==0&&G!==Z.retryLane&&(Z.retryLane=G,Ui(n,G),Kn(P,n,G,-1))}return Ru(),P=au(Error(t(421))),Il(n,a,re,P)}return G.data==="$?"?(a.flags|=128,a.child=n.child,a=kd.bind(null,n),G._reactRetry=a,null):(n=Z.treeContext,zt=Bn(G.nextSibling),Pt=a,lt=!0,It=null,n!==null&&(wt[be++]=Jt,wt[be++]=ut,wt[be++]=Le,Jt=n.id,ut=n.overflow,Le=a),a=fu(a,P.children),a.flags|=4096,a)}function kh(n,a,w){n.lanes|=a;var P=n.alternate;P!==null&&(P.lanes|=a),Wc(n.return,a,w)}function pu(n,a,w,P,G){var Z=n.memoizedState;Z===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:P,tail:w,tailMode:G}:(Z.isBackwards=a,Z.rendering=null,Z.renderingStartTime=0,Z.last=P,Z.tail=w,Z.tailMode=G)}function zh(n,a,w){var P=a.pendingProps,G=P.revealOrder,Z=P.tail;if(yn(n,a,P.children,w),P=wr.current,(P&2)!==0)P=P&1|2,a.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&kh(n,w,a);else if(n.tag===19)kh(n,w,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}P&=1}if(fr(wr,P),(a.mode&1)===0)a.memoizedState=null;else switch(G){case"forwards":for(w=a.child,G=null;w!==null;)n=w.alternate,n!==null&&Tl(n)===null&&(G=w),w=w.sibling;w=G,w===null?(G=a.child,a.child=null):(G=w.sibling,w.sibling=null),pu(a,!1,G,w,Z);break;case"backwards":for(w=null,G=a.child,a.child=null;G!==null;){if(n=G.alternate,n!==null&&Tl(n)===null){a.child=G;break}n=G.sibling,G.sibling=w,w=G,G=n}pu(a,!0,w,null,Z);break;case"together":pu(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Fl(n,a){(a.mode&1)===0&&n!==null&&(n.alternate=null,a.alternate=null,a.flags|=2)}function ji(n,a,w){if(n!==null&&(a.dependencies=n.dependencies),Gs|=a.lanes,(w&a.childLanes)===0)return null;if(n!==null&&a.child!==n.child)throw Error(t(153));if(a.child!==null){for(n=a.child,w=_s(n,n.pendingProps),a.child=w,w.return=a;n.sibling!==null;)n=n.sibling,w=w.sibling=_s(n,n.pendingProps),w.return=a;w.sibling=null}return a.child}function vd(n,a,w){switch(a.tag){case 3:Mh(a),xn();break;case 5:Yu(a);break;case 1:Xr(a.type)&&Ds(a);break;case 4:Xc(a,a.stateNode.containerInfo);break;case 10:var P=a.type._context,G=a.memoizedProps.value;fr(bl,P._currentValue),P._currentValue=G;break;case 13:if(P=a.memoizedState,P!==null)return P.dehydrated!==null?(fr(wr,wr.current&1),a.flags|=128,null):(w&a.child.childLanes)!==0?Rh(n,a,w):(fr(wr,wr.current&1),n=ji(n,a,w),n!==null?n.sibling:null);fr(wr,wr.current&1);break;case 19:if(P=(w&a.childLanes)!==0,(n.flags&128)!==0){if(P)return zh(n,a,w);a.flags|=128}if(G=a.memoizedState,G!==null&&(G.rendering=null,G.tail=null,G.lastEffect=null),fr(wr,wr.current),P)break;return null;case 22:case 23:return a.lanes=0,Ch(n,a,w)}return ji(n,a,w)}var Nh,mu,Ph,Ih;Nh=function(n,a){for(var w=a.child;w!==null;){if(w.tag===5||w.tag===6)n.appendChild(w.stateNode);else if(w.tag!==4&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break;for(;w.sibling===null;){if(w.return===null||w.return===a)return;w=w.return}w.sibling.return=w.return,w=w.sibling}},mu=function(){},Ph=function(n,a,w,P){var G=n.memoizedProps;if(G!==P){n=a.stateNode,Bs(gi.current);var Z=null;switch(w){case"input":G=me(n,G),P=me(n,P),Z=[];break;case"select":G=O({},G,{value:void 0}),P=O({},P,{value:void 0}),Z=[];break;case"textarea":G=Ke(n,G),P=Ke(n,P),Z=[];break;default:typeof G.onClick!="function"&&typeof P.onClick=="function"&&(n.onclick=Eo)}Me(w,P);var re;w=null;for(qe in G)if(!P.hasOwnProperty(qe)&&G.hasOwnProperty(qe)&&G[qe]!=null)if(qe==="style"){var ge=G[qe];for(re in ge)ge.hasOwnProperty(re)&&(w||(w={}),w[re]="")}else qe!=="dangerouslySetInnerHTML"&&qe!=="children"&&qe!=="suppressContentEditableWarning"&&qe!=="suppressHydrationWarning"&&qe!=="autoFocus"&&(c.hasOwnProperty(qe)?Z||(Z=[]):(Z=Z||[]).push(qe,null));for(qe in P){var Ce=P[qe];if(ge=G?.[qe],P.hasOwnProperty(qe)&&Ce!==ge&&(Ce!=null||ge!=null))if(qe==="style")if(ge){for(re in ge)!ge.hasOwnProperty(re)||Ce&&Ce.hasOwnProperty(re)||(w||(w={}),w[re]="");for(re in Ce)Ce.hasOwnProperty(re)&&ge[re]!==Ce[re]&&(w||(w={}),w[re]=Ce[re])}else w||(Z||(Z=[]),Z.push(qe,w)),w=Ce;else qe==="dangerouslySetInnerHTML"?(Ce=Ce?Ce.__html:void 0,ge=ge?ge.__html:void 0,Ce!=null&&ge!==Ce&&(Z=Z||[]).push(qe,Ce)):qe==="children"?typeof Ce!="string"&&typeof Ce!="number"||(Z=Z||[]).push(qe,""+Ce):qe!=="suppressContentEditableWarning"&&qe!=="suppressHydrationWarning"&&(c.hasOwnProperty(qe)?(Ce!=null&&qe==="onScroll"&&hr("scroll",n),Z||ge===Ce||(Z=[])):(Z=Z||[]).push(qe,Ce))}w&&(Z=Z||[]).push("style",w);var qe=Z;(a.updateQueue=qe)&&(a.flags|=4)}},Ih=function(n,a,w,P){w!==P&&(a.flags|=4)};function Ua(n,a){if(!lt)switch(n.tailMode){case"hidden":a=n.tail;for(var w=null;a!==null;)a.alternate!==null&&(w=a),a=a.sibling;w===null?n.tail=null:w.sibling=null;break;case"collapsed":w=n.tail;for(var P=null;w!==null;)w.alternate!==null&&(P=w),w=w.sibling;P===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:P.sibling=null}}function cn(n){var a=n.alternate!==null&&n.alternate.child===n.child,w=0,P=0;if(a)for(var G=n.child;G!==null;)w|=G.lanes|G.childLanes,P|=G.subtreeFlags&14680064,P|=G.flags&14680064,G.return=n,G=G.sibling;else for(G=n.child;G!==null;)w|=G.lanes|G.childLanes,P|=G.subtreeFlags,P|=G.flags,G.return=n,G=G.sibling;return n.subtreeFlags|=P,n.childLanes=w,a}function _d(n,a,w){var P=a.pendingProps;switch(er(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cn(a),null;case 1:return Xr(a.type)&&Ls(),cn(a),null;case 3:return P=a.stateNode,Lo(),gr(rn),gr(jr),Qc(),P.pendingContext&&(P.context=P.pendingContext,P.pendingContext=null),(n===null||n.child===null)&&(Ht(a)?a.flags|=4:n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,It!==null&&(Au(It),It=null))),mu(n,a),cn(a),null;case 5:Zc(a);var G=Bs(Fa.current);if(w=a.type,n!==null&&a.stateNode!=null)Ph(n,a,w,P,G),n.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!P){if(a.stateNode===null)throw Error(t(166));return cn(a),null}if(n=Bs(gi.current),Ht(a)){P=a.stateNode,w=a.type;var Z=a.memoizedProps;switch(P[In]=a,P[Ps]=Z,n=(a.mode&1)!==0,w){case"dialog":hr("cancel",P),hr("close",P);break;case"iframe":case"object":case"embed":hr("load",P);break;case"video":case"audio":for(G=0;G<ss.length;G++)hr(ss[G],P);break;case"source":hr("error",P);break;case"img":case"image":case"link":hr("error",P),hr("load",P);break;case"details":hr("toggle",P);break;case"input":ke(P,Z),hr("invalid",P);break;case"select":P._wrapperState={wasMultiple:!!Z.multiple},hr("invalid",P);break;case"textarea":Ue(P,Z),hr("invalid",P)}Me(w,Z),G=null;for(var re in Z)if(Z.hasOwnProperty(re)){var ge=Z[re];re==="children"?typeof ge=="string"?P.textContent!==ge&&(Z.suppressHydrationWarning!==!0&&Co(P.textContent,ge,n),G=["children",ge]):typeof ge=="number"&&P.textContent!==""+ge&&(Z.suppressHydrationWarning!==!0&&Co(P.textContent,ge,n),G=["children",""+ge]):c.hasOwnProperty(re)&&ge!=null&&re==="onScroll"&&hr("scroll",P)}switch(w){case"input":$e(P),Ye(P,Z,!0);break;case"textarea":$e(P),mt(P);break;case"select":case"option":break;default:typeof Z.onClick=="function"&&(P.onclick=Eo)}P=G,a.updateQueue=P,P!==null&&(a.flags|=4)}else{re=G.nodeType===9?G:G.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=ht(w)),n==="http://www.w3.org/1999/xhtml"?w==="script"?(n=re.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof P.is=="string"?n=re.createElement(w,{is:P.is}):(n=re.createElement(w),w==="select"&&(re=n,P.multiple?re.multiple=!0:P.size&&(re.size=P.size))):n=re.createElementNS(n,w),n[In]=a,n[Ps]=P,Nh(n,a,!1,!1),a.stateNode=n;e:{switch(re=Ze(w,P),w){case"dialog":hr("cancel",n),hr("close",n),G=P;break;case"iframe":case"object":case"embed":hr("load",n),G=P;break;case"video":case"audio":for(G=0;G<ss.length;G++)hr(ss[G],n);G=P;break;case"source":hr("error",n),G=P;break;case"img":case"image":case"link":hr("error",n),hr("load",n),G=P;break;case"details":hr("toggle",n),G=P;break;case"input":ke(n,P),G=me(n,P),hr("invalid",n);break;case"option":G=P;break;case"select":n._wrapperState={wasMultiple:!!P.multiple},G=O({},P,{value:void 0}),hr("invalid",n);break;case"textarea":Ue(n,P),G=Ke(n,P),hr("invalid",n);break;default:G=P}Me(w,G),ge=G;for(Z in ge)if(ge.hasOwnProperty(Z)){var Ce=ge[Z];Z==="style"?K(n,Ce):Z==="dangerouslySetInnerHTML"?(Ce=Ce?Ce.__html:void 0,Ce!=null&&le(n,Ce)):Z==="children"?typeof Ce=="string"?(w!=="textarea"||Ce!=="")&&Se(n,Ce):typeof Ce=="number"&&Se(n,""+Ce):Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&Z!=="autoFocus"&&(c.hasOwnProperty(Z)?Ce!=null&&Z==="onScroll"&&hr("scroll",n):Ce!=null&&E(n,Z,Ce,re))}switch(w){case"input":$e(n),Ye(n,P,!1);break;case"textarea":$e(n),mt(n);break;case"option":P.value!=null&&n.setAttribute("value",""+ue(P.value));break;case"select":n.multiple=!!P.multiple,Z=P.value,Z!=null?et(n,!!P.multiple,Z,!1):P.defaultValue!=null&&et(n,!!P.multiple,P.defaultValue,!0);break;default:typeof G.onClick=="function"&&(n.onclick=Eo)}switch(w){case"button":case"input":case"select":case"textarea":P=!!P.autoFocus;break e;case"img":P=!0;break e;default:P=!1}}P&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return cn(a),null;case 6:if(n&&a.stateNode!=null)Ih(n,a,n.memoizedProps,P);else{if(typeof P!="string"&&a.stateNode===null)throw Error(t(166));if(w=Bs(Fa.current),Bs(gi.current),Ht(a)){if(P=a.stateNode,w=a.memoizedProps,P[In]=a,(Z=P.nodeValue!==w)&&(n=Pt,n!==null))switch(n.tag){case 3:Co(P.nodeValue,w,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Co(P.nodeValue,w,(n.mode&1)!==0)}Z&&(a.flags|=4)}else P=(w.nodeType===9?w:w.ownerDocument).createTextNode(P),P[In]=a,a.stateNode=P}return cn(a),null;case 13:if(gr(wr),P=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(lt&&zt!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Vr(),xn(),a.flags|=98560,Z=!1;else if(Z=Ht(a),P!==null&&P.dehydrated!==null){if(n===null){if(!Z)throw Error(t(318));if(Z=a.memoizedState,Z=Z!==null?Z.dehydrated:null,!Z)throw Error(t(317));Z[In]=a}else xn(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;cn(a),Z=!1}else It!==null&&(Au(It),It=null),Z=!0;if(!Z)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=w,a):(P=P!==null,P!==(n!==null&&n.memoizedState!==null)&&P&&(a.child.flags|=8192,(a.mode&1)!==0&&(n===null||(wr.current&1)!==0?Br===0&&(Br=3):Ru())),a.updateQueue!==null&&(a.flags|=4),cn(a),null);case 4:return Lo(),mu(n,a),n===null&&zs(a.stateNode.containerInfo),cn(a),null;case 10:return Vc(a.type._context),cn(a),null;case 17:return Xr(a.type)&&Ls(),cn(a),null;case 19:if(gr(wr),Z=a.memoizedState,Z===null)return cn(a),null;if(P=(a.flags&128)!==0,re=Z.rendering,re===null)if(P)Ua(Z,!1);else{if(Br!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(re=Tl(n),re!==null){for(a.flags|=128,Ua(Z,!1),P=re.updateQueue,P!==null&&(a.updateQueue=P,a.flags|=4),a.subtreeFlags=0,P=w,w=a.child;w!==null;)Z=w,n=P,Z.flags&=14680066,re=Z.alternate,re===null?(Z.childLanes=0,Z.lanes=n,Z.child=null,Z.subtreeFlags=0,Z.memoizedProps=null,Z.memoizedState=null,Z.updateQueue=null,Z.dependencies=null,Z.stateNode=null):(Z.childLanes=re.childLanes,Z.lanes=re.lanes,Z.child=re.child,Z.subtreeFlags=0,Z.deletions=null,Z.memoizedProps=re.memoizedProps,Z.memoizedState=re.memoizedState,Z.updateQueue=re.updateQueue,Z.type=re.type,n=re.dependencies,Z.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),w=w.sibling;return fr(wr,wr.current&1|2),a.child}n=n.sibling}Z.tail!==null&&dr()>Uo&&(a.flags|=128,P=!0,Ua(Z,!1),a.lanes=4194304)}else{if(!P)if(n=Tl(re),n!==null){if(a.flags|=128,P=!0,w=n.updateQueue,w!==null&&(a.updateQueue=w,a.flags|=4),Ua(Z,!0),Z.tail===null&&Z.tailMode==="hidden"&&!re.alternate&&!lt)return cn(a),null}else 2*dr()-Z.renderingStartTime>Uo&&w!==1073741824&&(a.flags|=128,P=!0,Ua(Z,!1),a.lanes=4194304);Z.isBackwards?(re.sibling=a.child,a.child=re):(w=Z.last,w!==null?w.sibling=re:a.child=re,Z.last=re)}return Z.tail!==null?(a=Z.tail,Z.rendering=a,Z.tail=a.sibling,Z.renderingStartTime=dr(),a.sibling=null,w=wr.current,fr(wr,P?w&1|2:w&1),a):(cn(a),null);case 22:case 23:return Tu(),P=a.memoizedState!==null,n!==null&&n.memoizedState!==null!==P&&(a.flags|=8192),P&&(a.mode&1)!==0?(Fn&1073741824)!==0&&(cn(a),a.subtreeFlags&6&&(a.flags|=8192)):cn(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function xd(n,a){switch(er(a),a.tag){case 1:return Xr(a.type)&&Ls(),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return Lo(),gr(rn),gr(jr),Qc(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 5:return Zc(a),null;case 13:if(gr(wr),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(t(340));xn()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return gr(wr),null;case 4:return Lo(),null;case 10:return Vc(a.type._context),null;case 22:case 23:return Tu(),null;case 24:return null;default:return null}}var Ll=!1,hn=!1,wd=typeof WeakSet=="function"?WeakSet:Set,Ct=null;function Oo(n,a){var w=n.ref;if(w!==null)if(typeof w=="function")try{w(null)}catch(P){Mr(n,a,P)}else w.current=null}function gu(n,a,w){try{w()}catch(P){Mr(n,a,P)}}var Fh=!1;function bd(n,a){if(Ca=Qs,n=ma(),go(n)){if("selectionStart"in n)var w={start:n.selectionStart,end:n.selectionEnd};else e:{w=(w=n.ownerDocument)&&w.defaultView||window;var P=w.getSelection&&w.getSelection();if(P&&P.rangeCount!==0){w=P.anchorNode;var G=P.anchorOffset,Z=P.focusNode;P=P.focusOffset;try{w.nodeType,Z.nodeType}catch{w=null;break e}var re=0,ge=-1,Ce=-1,qe=0,ot=0,ct=n,it=null;t:for(;;){for(var bt;ct!==w||G!==0&&ct.nodeType!==3||(ge=re+G),ct!==Z||P!==0&&ct.nodeType!==3||(Ce=re+P),ct.nodeType===3&&(re+=ct.nodeValue.length),(bt=ct.firstChild)!==null;)it=ct,ct=bt;for(;;){if(ct===n)break t;if(it===w&&++qe===G&&(ge=re),it===Z&&++ot===P&&(Ce=re),(bt=ct.nextSibling)!==null)break;ct=it,it=ct.parentNode}ct=bt}w=ge===-1||Ce===-1?null:{start:ge,end:Ce}}else w=null}w=w||{start:0,end:0}}else w=null;for(Ea={focusedElem:n,selectionRange:w},Qs=!1,Ct=a;Ct!==null;)if(a=Ct,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,Ct=n;else for(;Ct!==null;){a=Ct;try{var Et=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(Et!==null){var Rt=Et.memoizedProps,kr=Et.memoizedState,De=a.stateNode,Ee=De.getSnapshotBeforeUpdate(a.elementType===a.type?Rt:nn(a.type,Rt),kr);De.__reactInternalSnapshotBeforeUpdate=Ee}break;case 3:var Be=a.stateNode.containerInfo;Be.nodeType===1?Be.textContent="":Be.nodeType===9&&Be.documentElement&&Be.removeChild(Be.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(dt){Mr(a,a.return,dt)}if(n=a.sibling,n!==null){n.return=a.return,Ct=n;break}Ct=a.return}return Et=Fh,Fh=!1,Et}function Ga(n,a,w){var P=a.updateQueue;if(P=P!==null?P.lastEffect:null,P!==null){var G=P=P.next;do{if((G.tag&n)===n){var Z=G.destroy;G.destroy=void 0,Z!==void 0&&gu(a,w,Z)}G=G.next}while(G!==P)}}function Dl(n,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var w=a=a.next;do{if((w.tag&n)===n){var P=w.create;w.destroy=P()}w=w.next}while(w!==a)}}function yu(n){var a=n.ref;if(a!==null){var w=n.stateNode;switch(n.tag){case 5:n=w;break;default:n=w}typeof a=="function"?a(n):a.current=n}}function Lh(n){var a=n.alternate;a!==null&&(n.alternate=null,Lh(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&(delete a[In],delete a[Ps],delete a[Is],delete a[Bc],delete a[Uc])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Dh(n){return n.tag===5||n.tag===3||n.tag===4}function Oh(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Dh(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function vu(n,a,w){var P=n.tag;if(P===5||P===6)n=n.stateNode,a?w.nodeType===8?w.parentNode.insertBefore(n,a):w.insertBefore(n,a):(w.nodeType===8?(a=w.parentNode,a.insertBefore(n,w)):(a=w,a.appendChild(n)),w=w._reactRootContainer,w!=null||a.onclick!==null||(a.onclick=Eo));else if(P!==4&&(n=n.child,n!==null))for(vu(n,a,w),n=n.sibling;n!==null;)vu(n,a,w),n=n.sibling}function _u(n,a,w){var P=n.tag;if(P===5||P===6)n=n.stateNode,a?w.insertBefore(n,a):w.appendChild(n);else if(P!==4&&(n=n.child,n!==null))for(_u(n,a,w),n=n.sibling;n!==null;)_u(n,a,w),n=n.sibling}var Zr=null,Jn=!1;function ps(n,a,w){for(w=w.child;w!==null;)Bh(n,a,w),w=w.sibling}function Bh(n,a,w){if(Ir&&typeof Ir.onCommitFiberUnmount=="function")try{Ir.onCommitFiberUnmount(Wi,w)}catch{}switch(w.tag){case 5:hn||Oo(w,a);case 6:var P=Zr,G=Jn;Zr=null,ps(n,a,w),Zr=P,Jn=G,Zr!==null&&(Jn?(n=Zr,w=w.stateNode,n.nodeType===8?n.parentNode.removeChild(w):n.removeChild(w)):Zr.removeChild(w.stateNode));break;case 18:Zr!==null&&(Jn?(n=Zr,w=w.stateNode,n.nodeType===8?Di(n.parentNode,w):n.nodeType===1&&Di(n,w),Ss(n)):Di(Zr,w.stateNode));break;case 4:P=Zr,G=Jn,Zr=w.stateNode.containerInfo,Jn=!0,ps(n,a,w),Zr=P,Jn=G;break;case 0:case 11:case 14:case 15:if(!hn&&(P=w.updateQueue,P!==null&&(P=P.lastEffect,P!==null))){G=P=P.next;do{var Z=G,re=Z.destroy;Z=Z.tag,re!==void 0&&((Z&2)!==0||(Z&4)!==0)&&gu(w,a,re),G=G.next}while(G!==P)}ps(n,a,w);break;case 1:if(!hn&&(Oo(w,a),P=w.stateNode,typeof P.componentWillUnmount=="function"))try{P.props=w.memoizedProps,P.state=w.memoizedState,P.componentWillUnmount()}catch(ge){Mr(w,a,ge)}ps(n,a,w);break;case 21:ps(n,a,w);break;case 22:w.mode&1?(hn=(P=hn)||w.memoizedState!==null,ps(n,a,w),hn=P):ps(n,a,w);break;default:ps(n,a,w)}}function Uh(n){var a=n.updateQueue;if(a!==null){n.updateQueue=null;var w=n.stateNode;w===null&&(w=n.stateNode=new wd),a.forEach(function(P){var G=zd.bind(null,n,P);w.has(P)||(w.add(P),P.then(G,G))})}}function Qn(n,a){var w=a.deletions;if(w!==null)for(var P=0;P<w.length;P++){var G=w[P];try{var Z=n,re=a,ge=re;e:for(;ge!==null;){switch(ge.tag){case 5:Zr=ge.stateNode,Jn=!1;break e;case 3:Zr=ge.stateNode.containerInfo,Jn=!0;break e;case 4:Zr=ge.stateNode.containerInfo,Jn=!0;break e}ge=ge.return}if(Zr===null)throw Error(t(160));Bh(Z,re,G),Zr=null,Jn=!1;var Ce=G.alternate;Ce!==null&&(Ce.return=null),G.return=null}catch(qe){Mr(G,a,qe)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)Gh(a,n),a=a.sibling}function Gh(n,a){var w=n.alternate,P=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Qn(a,n),vi(n),P&4){try{Ga(3,n,n.return),Dl(3,n)}catch(Rt){Mr(n,n.return,Rt)}try{Ga(5,n,n.return)}catch(Rt){Mr(n,n.return,Rt)}}break;case 1:Qn(a,n),vi(n),P&512&&w!==null&&Oo(w,w.return);break;case 5:if(Qn(a,n),vi(n),P&512&&w!==null&&Oo(w,w.return),n.flags&32){var G=n.stateNode;try{Se(G,"")}catch(Rt){Mr(n,n.return,Rt)}}if(P&4&&(G=n.stateNode,G!=null)){var Z=n.memoizedProps,re=w!==null?w.memoizedProps:Z,ge=n.type,Ce=n.updateQueue;if(n.updateQueue=null,Ce!==null)try{ge==="input"&&Z.type==="radio"&&Z.name!=null&&Qe(G,Z),Ze(ge,re);var qe=Ze(ge,Z);for(re=0;re<Ce.length;re+=2){var ot=Ce[re],ct=Ce[re+1];ot==="style"?K(G,ct):ot==="dangerouslySetInnerHTML"?le(G,ct):ot==="children"?Se(G,ct):E(G,ot,ct,qe)}switch(ge){case"input":Je(G,Z);break;case"textarea":He(G,Z);break;case"select":var it=G._wrapperState.wasMultiple;G._wrapperState.wasMultiple=!!Z.multiple;var bt=Z.value;bt!=null?et(G,!!Z.multiple,bt,!1):it!==!!Z.multiple&&(Z.defaultValue!=null?et(G,!!Z.multiple,Z.defaultValue,!0):et(G,!!Z.multiple,Z.multiple?[]:"",!1))}G[Ps]=Z}catch(Rt){Mr(n,n.return,Rt)}}break;case 6:if(Qn(a,n),vi(n),P&4){if(n.stateNode===null)throw Error(t(162));G=n.stateNode,Z=n.memoizedProps;try{G.nodeValue=Z}catch(Rt){Mr(n,n.return,Rt)}}break;case 3:if(Qn(a,n),vi(n),P&4&&w!==null&&w.memoizedState.isDehydrated)try{Ss(a.containerInfo)}catch(Rt){Mr(n,n.return,Rt)}break;case 4:Qn(a,n),vi(n);break;case 13:Qn(a,n),vi(n),G=n.child,G.flags&8192&&(Z=G.memoizedState!==null,G.stateNode.isHidden=Z,!Z||G.alternate!==null&&G.alternate.memoizedState!==null||(bu=dr())),P&4&&Uh(n);break;case 22:if(ot=w!==null&&w.memoizedState!==null,n.mode&1?(hn=(qe=hn)||ot,Qn(a,n),hn=qe):Qn(a,n),vi(n),P&8192){if(qe=n.memoizedState!==null,(n.stateNode.isHidden=qe)&&!ot&&(n.mode&1)!==0)for(Ct=n,ot=n.child;ot!==null;){for(ct=Ct=ot;Ct!==null;){switch(it=Ct,bt=it.child,it.tag){case 0:case 11:case 14:case 15:Ga(4,it,it.return);break;case 1:Oo(it,it.return);var Et=it.stateNode;if(typeof Et.componentWillUnmount=="function"){P=it,w=it.return;try{a=P,Et.props=a.memoizedProps,Et.state=a.memoizedState,Et.componentWillUnmount()}catch(Rt){Mr(P,w,Rt)}}break;case 5:Oo(it,it.return);break;case 22:if(it.memoizedState!==null){Wh(ct);continue}}bt!==null?(bt.return=it,Ct=bt):Wh(ct)}ot=ot.sibling}e:for(ot=null,ct=n;;){if(ct.tag===5){if(ot===null){ot=ct;try{G=ct.stateNode,qe?(Z=G.style,typeof Z.setProperty=="function"?Z.setProperty("display","none","important"):Z.display="none"):(ge=ct.stateNode,Ce=ct.memoizedProps.style,re=Ce!=null&&Ce.hasOwnProperty("display")?Ce.display:null,ge.style.display=je("display",re))}catch(Rt){Mr(n,n.return,Rt)}}}else if(ct.tag===6){if(ot===null)try{ct.stateNode.nodeValue=qe?"":ct.memoizedProps}catch(Rt){Mr(n,n.return,Rt)}}else if((ct.tag!==22&&ct.tag!==23||ct.memoizedState===null||ct===n)&&ct.child!==null){ct.child.return=ct,ct=ct.child;continue}if(ct===n)break e;for(;ct.sibling===null;){if(ct.return===null||ct.return===n)break e;ot===ct&&(ot=null),ct=ct.return}ot===ct&&(ot=null),ct.sibling.return=ct.return,ct=ct.sibling}}break;case 19:Qn(a,n),vi(n),P&4&&Uh(n);break;case 21:break;default:Qn(a,n),vi(n)}}function vi(n){var a=n.flags;if(a&2){try{e:{for(var w=n.return;w!==null;){if(Dh(w)){var P=w;break e}w=w.return}throw Error(t(160))}switch(P.tag){case 5:var G=P.stateNode;P.flags&32&&(Se(G,""),P.flags&=-33);var Z=Oh(n);_u(n,Z,G);break;case 3:case 4:var re=P.stateNode.containerInfo,ge=Oh(n);vu(n,ge,re);break;default:throw Error(t(161))}}catch(Ce){Mr(n,n.return,Ce)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function Sd(n,a,w){Ct=n,jh(n)}function jh(n,a,w){for(var P=(n.mode&1)!==0;Ct!==null;){var G=Ct,Z=G.child;if(G.tag===22&&P){var re=G.memoizedState!==null||Ll;if(!re){var ge=G.alternate,Ce=ge!==null&&ge.memoizedState!==null||hn;ge=Ll;var qe=hn;if(Ll=re,(hn=Ce)&&!qe)for(Ct=G;Ct!==null;)re=Ct,Ce=re.child,re.tag===22&&re.memoizedState!==null?Hh(G):Ce!==null?(Ce.return=re,Ct=Ce):Hh(G);for(;Z!==null;)Ct=Z,jh(Z),Z=Z.sibling;Ct=G,Ll=ge,hn=qe}Vh(n)}else(G.subtreeFlags&8772)!==0&&Z!==null?(Z.return=G,Ct=Z):Vh(n)}}function Vh(n){for(;Ct!==null;){var a=Ct;if((a.flags&8772)!==0){var w=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:hn||Dl(5,a);break;case 1:var P=a.stateNode;if(a.flags&4&&!hn)if(w===null)P.componentDidMount();else{var G=a.elementType===a.type?w.memoizedProps:nn(a.type,w.memoizedProps);P.componentDidUpdate(G,w.memoizedState,P.__reactInternalSnapshotBeforeUpdate)}var Z=a.updateQueue;Z!==null&&Uu(a,Z,P);break;case 3:var re=a.updateQueue;if(re!==null){if(w=null,a.child!==null)switch(a.child.tag){case 5:w=a.child.stateNode;break;case 1:w=a.child.stateNode}Uu(a,re,w)}break;case 5:var ge=a.stateNode;if(w===null&&a.flags&4){w=ge;var Ce=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":Ce.autoFocus&&w.focus();break;case"img":Ce.src&&(w.src=Ce.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var qe=a.alternate;if(qe!==null){var ot=qe.memoizedState;if(ot!==null){var ct=ot.dehydrated;ct!==null&&Ss(ct)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}hn||a.flags&512&&yu(a)}catch(it){Mr(a,a.return,it)}}if(a===n){Ct=null;break}if(w=a.sibling,w!==null){w.return=a.return,Ct=w;break}Ct=a.return}}function Wh(n){for(;Ct!==null;){var a=Ct;if(a===n){Ct=null;break}var w=a.sibling;if(w!==null){w.return=a.return,Ct=w;break}Ct=a.return}}function Hh(n){for(;Ct!==null;){var a=Ct;try{switch(a.tag){case 0:case 11:case 15:var w=a.return;try{Dl(4,a)}catch(Ce){Mr(a,w,Ce)}break;case 1:var P=a.stateNode;if(typeof P.componentDidMount=="function"){var G=a.return;try{P.componentDidMount()}catch(Ce){Mr(a,G,Ce)}}var Z=a.return;try{yu(a)}catch(Ce){Mr(a,Z,Ce)}break;case 5:var re=a.return;try{yu(a)}catch(Ce){Mr(a,re,Ce)}}}catch(Ce){Mr(a,a.return,Ce)}if(a===n){Ct=null;break}var ge=a.sibling;if(ge!==null){ge.return=a.return,Ct=ge;break}Ct=a.return}}var Cd=Math.ceil,Ol=T.ReactCurrentDispatcher,xu=T.ReactCurrentOwner,Wn=T.ReactCurrentBatchConfig,nr=0,$r=null,Nr=null,Jr=0,Fn=0,Bo=fi(0),Br=0,ja=null,Gs=0,Bl=0,wu=0,Va=null,Sn=null,bu=0,Uo=1/0,Vi=null,Ul=!1,Su=null,ms=null,Gl=!1,gs=null,jl=0,Wa=0,Cu=null,Vl=-1,Wl=0;function vn(){return(nr&6)!==0?dr():Vl!==-1?Vl:Vl=dr()}function ys(n){return(n.mode&1)===0?1:(nr&2)!==0&&Jr!==0?Jr&-Jr:No.transition!==null?(Wl===0&&(Wl=ni()),Wl):(n=Vt,n!==0||(n=window.event,n=n===void 0?16:Xa(n.type)),n)}function Kn(n,a,w,P){if(50<Wa)throw Wa=0,Cu=null,Error(t(185));_n(n,w,P),((nr&2)===0||n!==$r)&&(n===$r&&((nr&2)===0&&(Bl|=w),Br===4&&vs(n,Jr)),Cn(n,P),w===1&&nr===0&&(a.mode&1)===0&&(Uo=dr()+500,ko&&ae()))}function Cn(n,a){var w=n.callbackNode;Hi(n,a);var P=qn(n,n===$r?Jr:0);if(P===0)w!==null&&xi(w),n.callbackNode=null,n.callbackPriority=0;else if(a=P&-P,n.callbackPriority!==a){if(w!=null&&xi(w),a===1)n.tag===0?F(qh.bind(null,n)):Q(qh.bind(null,n)),Dc(function(){(nr&6)===0&&ae()}),w=null;else{switch(Qr(P)){case 1:w=$n;break;case 4:w=$s;break;case 16:w=Yt;break;case 536870912:w=fn;break;default:w=Yt}w=td(w,$h.bind(null,n))}n.callbackPriority=a,n.callbackNode=w}}function $h(n,a){if(Vl=-1,Wl=0,(nr&6)!==0)throw Error(t(327));var w=n.callbackNode;if(Go()&&n.callbackNode!==w)return null;var P=qn(n,n===$r?Jr:0);if(P===0)return null;if((P&30)!==0||(P&n.expiredLanes)!==0||a)a=Hl(n,P);else{a=P;var G=nr;nr|=2;var Z=Xh();($r!==n||Jr!==a)&&(Vi=null,Uo=dr()+500,Vs(n,a));do try{Md();break}catch(ge){Yh(n,ge)}while(!0);jc(),Ol.current=Z,nr=G,Nr!==null?a=0:($r=null,Jr=0,a=Br)}if(a!==0){if(a===2&&(G=Ho(n),G!==0&&(P=G,a=Eu(n,G))),a===1)throw w=ja,Vs(n,0),vs(n,P),Cn(n,dr()),w;if(a===6)vs(n,P);else{if(G=n.current.alternate,(P&30)===0&&!Ed(G)&&(a=Hl(n,P),a===2&&(Z=Ho(n),Z!==0&&(P=Z,a=Eu(n,Z))),a===1))throw w=ja,Vs(n,0),vs(n,P),Cn(n,dr()),w;switch(n.finishedWork=G,n.finishedLanes=P,a){case 0:case 1:throw Error(t(345));case 2:Ws(n,Sn,Vi);break;case 3:if(vs(n,P),(P&130023424)===P&&(a=bu+500-dr(),10<a)){if(qn(n,0)!==0)break;if(G=n.suspendedLanes,(G&P)!==P){vn(),n.pingedLanes|=n.suspendedLanes&G;break}n.timeoutHandle=Aa(Ws.bind(null,n,Sn,Vi),a);break}Ws(n,Sn,Vi);break;case 4:if(vs(n,P),(P&4194240)===P)break;for(a=n.eventTimes,G=-1;0<P;){var re=31-pn(P);Z=1<<re,re=a[re],re>G&&(G=re),P&=~Z}if(P=G,P=dr()-P,P=(120>P?120:480>P?480:1080>P?1080:1920>P?1920:3e3>P?3e3:4320>P?4320:1960*Cd(P/1960))-P,10<P){n.timeoutHandle=Aa(Ws.bind(null,n,Sn,Vi),P);break}Ws(n,Sn,Vi);break;case 5:Ws(n,Sn,Vi);break;default:throw Error(t(329))}}}return Cn(n,dr()),n.callbackNode===w?$h.bind(null,n):null}function Eu(n,a){var w=Va;return n.current.memoizedState.isDehydrated&&(Vs(n,a).flags|=256),n=Hl(n,a),n!==2&&(a=Sn,Sn=w,a!==null&&Au(a)),n}function Au(n){Sn===null?Sn=n:Sn.push.apply(Sn,n)}function Ed(n){for(var a=n;;){if(a.flags&16384){var w=a.updateQueue;if(w!==null&&(w=w.stores,w!==null))for(var P=0;P<w.length;P++){var G=w[P],Z=G.getSnapshot;G=G.value;try{if(!Rr(Z(),G))return!1}catch{return!1}}}if(w=a.child,a.subtreeFlags&16384&&w!==null)w.return=a,a=w;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function vs(n,a){for(a&=~wu,a&=~Bl,n.suspendedLanes|=a,n.pingedLanes&=~a,n=n.expirationTimes;0<a;){var w=31-pn(a),P=1<<w;n[w]=-1,a&=~P}}function qh(n){if((nr&6)!==0)throw Error(t(327));Go();var a=qn(n,0);if((a&1)===0)return Cn(n,dr()),null;var w=Hl(n,a);if(n.tag!==0&&w===2){var P=Ho(n);P!==0&&(a=P,w=Eu(n,P))}if(w===1)throw w=ja,Vs(n,0),vs(n,a),Cn(n,dr()),w;if(w===6)throw Error(t(345));return n.finishedWork=n.current.alternate,n.finishedLanes=a,Ws(n,Sn,Vi),Cn(n,dr()),null}function Mu(n,a){var w=nr;nr|=1;try{return n(a)}finally{nr=w,nr===0&&(Uo=dr()+500,ko&&ae())}}function js(n){gs!==null&&gs.tag===0&&(nr&6)===0&&Go();var a=nr;nr|=1;var w=Wn.transition,P=Vt;try{if(Wn.transition=null,Vt=1,n)return n()}finally{Vt=P,Wn.transition=w,nr=a,(nr&6)===0&&ae()}}function Tu(){Fn=Bo.current,gr(Bo)}function Vs(n,a){n.finishedWork=null,n.finishedLanes=0;var w=n.timeoutHandle;if(w!==-1&&(n.timeoutHandle=-1,Lc(w)),Nr!==null)for(w=Nr.return;w!==null;){var P=w;switch(er(P),P.tag){case 1:P=P.type.childContextTypes,P!=null&&Ls();break;case 3:Lo(),gr(rn),gr(jr),Qc();break;case 5:Zc(P);break;case 4:Lo();break;case 13:gr(wr);break;case 19:gr(wr);break;case 10:Vc(P.type._context);break;case 22:case 23:Tu()}w=w.return}if($r=n,Nr=n=_s(n.current,null),Jr=Fn=a,Br=0,ja=null,wu=Bl=Gs=0,Sn=Va=null,Os!==null){for(a=0;a<Os.length;a++)if(w=Os[a],P=w.interleaved,P!==null){w.interleaved=null;var G=P.next,Z=w.pending;if(Z!==null){var re=Z.next;Z.next=G,P.next=re}w.pending=P}Os=null}return n}function Yh(n,a){do{var w=Nr;try{if(jc(),Rl.current=Pl,kl){for(var P=Sr.memoizedState;P!==null;){var G=P.queue;G!==null&&(G.pending=null),P=P.next}kl=!1}if(Us=0,Wr=Or=Sr=null,La=!1,Da=0,xu.current=null,w===null||w.return===null){Br=1,ja=a,Nr=null;break}e:{var Z=n,re=w.return,ge=w,Ce=a;if(a=Jr,ge.flags|=32768,Ce!==null&&typeof Ce=="object"&&typeof Ce.then=="function"){var qe=Ce,ot=ge,ct=ot.tag;if((ot.mode&1)===0&&(ct===0||ct===11||ct===15)){var it=ot.alternate;it?(ot.updateQueue=it.updateQueue,ot.memoizedState=it.memoizedState,ot.lanes=it.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var bt=_h(re);if(bt!==null){bt.flags&=-257,xh(bt,re,ge,Z,a),bt.mode&1&&vh(Z,qe,a),a=bt,Ce=qe;var Et=a.updateQueue;if(Et===null){var Rt=new Set;Rt.add(Ce),a.updateQueue=Rt}else Et.add(Ce);break e}else{if((a&1)===0){vh(Z,qe,a),Ru();break e}Ce=Error(t(426))}}else if(lt&&ge.mode&1){var kr=_h(re);if(kr!==null){(kr.flags&65536)===0&&(kr.flags|=256),xh(kr,re,ge,Z,a),zo(Do(Ce,ge));break e}}Z=Ce=Do(Ce,ge),Br!==4&&(Br=2),Va===null?Va=[Z]:Va.push(Z),Z=re;do{switch(Z.tag){case 3:Z.flags|=65536,a&=-a,Z.lanes|=a;var De=gh(Z,Ce,a);Bu(Z,De);break e;case 1:ge=Ce;var Ee=Z.type,Be=Z.stateNode;if((Z.flags&128)===0&&(typeof Ee.getDerivedStateFromError=="function"||Be!==null&&typeof Be.componentDidCatch=="function"&&(ms===null||!ms.has(Be)))){Z.flags|=65536,a&=-a,Z.lanes|=a;var dt=yh(Z,ge,a);Bu(Z,dt);break e}}Z=Z.return}while(Z!==null)}Jh(w)}catch(kt){a=kt,Nr===w&&w!==null&&(Nr=w=w.return);continue}break}while(!0)}function Xh(){var n=Ol.current;return Ol.current=Pl,n===null?Pl:n}function Ru(){(Br===0||Br===3||Br===2)&&(Br=4),$r===null||(Gs&268435455)===0&&(Bl&268435455)===0||vs($r,Jr)}function Hl(n,a){var w=nr;nr|=2;var P=Xh();($r!==n||Jr!==a)&&(Vi=null,Vs(n,a));do try{Ad();break}catch(G){Yh(n,G)}while(!0);if(jc(),nr=w,Ol.current=P,Nr!==null)throw Error(t(261));return $r=null,Jr=0,Br}function Ad(){for(;Nr!==null;)Zh(Nr)}function Md(){for(;Nr!==null&&!wi();)Zh(Nr)}function Zh(n){var a=ed(n.alternate,n,Fn);n.memoizedProps=n.pendingProps,a===null?Jh(n):Nr=a,xu.current=null}function Jh(n){var a=n;do{var w=a.alternate;if(n=a.return,(a.flags&32768)===0){if(w=_d(w,a,Fn),w!==null){Nr=w;return}}else{if(w=xd(w,a),w!==null){w.flags&=32767,Nr=w;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Br=6,Nr=null;return}}if(a=a.sibling,a!==null){Nr=a;return}Nr=a=n}while(a!==null);Br===0&&(Br=5)}function Ws(n,a,w){var P=Vt,G=Wn.transition;try{Wn.transition=null,Vt=1,Td(n,a,w,P)}finally{Wn.transition=G,Vt=P}return null}function Td(n,a,w,P){do Go();while(gs!==null);if((nr&6)!==0)throw Error(t(327));w=n.finishedWork;var G=n.finishedLanes;if(w===null)return null;if(n.finishedWork=null,n.finishedLanes=0,w===n.current)throw Error(t(177));n.callbackNode=null,n.callbackPriority=0;var Z=w.lanes|w.childLanes;if(nc(n,Z),n===$r&&(Nr=$r=null,Jr=0),(w.subtreeFlags&2064)===0&&(w.flags&2064)===0||Gl||(Gl=!0,td(Yt,function(){return Go(),null})),Z=(w.flags&15990)!==0,(w.subtreeFlags&15990)!==0||Z){Z=Wn.transition,Wn.transition=null;var re=Vt;Vt=1;var ge=nr;nr|=4,xu.current=null,bd(n,w),Gh(w,n),fl(Ea),Qs=!!Ca,Ea=Ca=null,n.current=w,Sd(w),ei(),nr=ge,Vt=re,Wn.transition=Z}else n.current=w;if(Gl&&(Gl=!1,gs=n,jl=G),Z=n.pendingLanes,Z===0&&(ms=null),Si(w.stateNode),Cn(n,dr()),a!==null)for(P=n.onRecoverableError,w=0;w<a.length;w++)G=a[w],P(G.value,{componentStack:G.stack,digest:G.digest});if(Ul)throw Ul=!1,n=Su,Su=null,n;return(jl&1)!==0&&n.tag!==0&&Go(),Z=n.pendingLanes,(Z&1)!==0?n===Cu?Wa++:(Wa=0,Cu=n):Wa=0,ae(),null}function Go(){if(gs!==null){var n=Qr(jl),a=Wn.transition,w=Vt;try{if(Wn.transition=null,Vt=16>n?16:n,gs===null)var P=!1;else{if(n=gs,gs=null,jl=0,(nr&6)!==0)throw Error(t(331));var G=nr;for(nr|=4,Ct=n.current;Ct!==null;){var Z=Ct,re=Z.child;if((Ct.flags&16)!==0){var ge=Z.deletions;if(ge!==null){for(var Ce=0;Ce<ge.length;Ce++){var qe=ge[Ce];for(Ct=qe;Ct!==null;){var ot=Ct;switch(ot.tag){case 0:case 11:case 15:Ga(8,ot,Z)}var ct=ot.child;if(ct!==null)ct.return=ot,Ct=ct;else for(;Ct!==null;){ot=Ct;var it=ot.sibling,bt=ot.return;if(Lh(ot),ot===qe){Ct=null;break}if(it!==null){it.return=bt,Ct=it;break}Ct=bt}}}var Et=Z.alternate;if(Et!==null){var Rt=Et.child;if(Rt!==null){Et.child=null;do{var kr=Rt.sibling;Rt.sibling=null,Rt=kr}while(Rt!==null)}}Ct=Z}}if((Z.subtreeFlags&2064)!==0&&re!==null)re.return=Z,Ct=re;else e:for(;Ct!==null;){if(Z=Ct,(Z.flags&2048)!==0)switch(Z.tag){case 0:case 11:case 15:Ga(9,Z,Z.return)}var De=Z.sibling;if(De!==null){De.return=Z.return,Ct=De;break e}Ct=Z.return}}var Ee=n.current;for(Ct=Ee;Ct!==null;){re=Ct;var Be=re.child;if((re.subtreeFlags&2064)!==0&&Be!==null)Be.return=re,Ct=Be;else e:for(re=Ee;Ct!==null;){if(ge=Ct,(ge.flags&2048)!==0)try{switch(ge.tag){case 0:case 11:case 15:Dl(9,ge)}}catch(kt){Mr(ge,ge.return,kt)}if(ge===re){Ct=null;break e}var dt=ge.sibling;if(dt!==null){dt.return=ge.return,Ct=dt;break e}Ct=ge.return}}if(nr=G,ae(),Ir&&typeof Ir.onPostCommitFiberRoot=="function")try{Ir.onPostCommitFiberRoot(Wi,n)}catch{}P=!0}return P}finally{Vt=w,Wn.transition=a}}return!1}function Qh(n,a,w){a=Do(w,a),a=gh(n,a,1),n=fs(n,a,1),a=vn(),n!==null&&(_n(n,1,a),Cn(n,a))}function Mr(n,a,w){if(n.tag===3)Qh(n,n,w);else for(;a!==null;){if(a.tag===3){Qh(a,n,w);break}else if(a.tag===1){var P=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof P.componentDidCatch=="function"&&(ms===null||!ms.has(P))){n=Do(w,n),n=yh(a,n,1),a=fs(a,n,1),n=vn(),a!==null&&(_n(a,1,n),Cn(a,n));break}}a=a.return}}function Rd(n,a,w){var P=n.pingCache;P!==null&&P.delete(a),a=vn(),n.pingedLanes|=n.suspendedLanes&w,$r===n&&(Jr&w)===w&&(Br===4||Br===3&&(Jr&130023424)===Jr&&500>dr()-bu?Vs(n,0):wu|=w),Cn(n,a)}function Kh(n,a){a===0&&((n.mode&1)===0?a=1:(a=ri,ri<<=1,(ri&130023424)===0&&(ri=4194304)));var w=vn();n=Ui(n,a),n!==null&&(_n(n,a,w),Cn(n,w))}function kd(n){var a=n.memoizedState,w=0;a!==null&&(w=a.retryLane),Kh(n,w)}function zd(n,a){var w=0;switch(n.tag){case 13:var P=n.stateNode,G=n.memoizedState;G!==null&&(w=G.retryLane);break;case 19:P=n.stateNode;break;default:throw Error(t(314))}P!==null&&P.delete(a),Kh(n,w)}var ed;ed=function(n,a,w){if(n!==null)if(n.memoizedProps!==a.pendingProps||rn.current)bn=!0;else{if((n.lanes&w)===0&&(a.flags&128)===0)return bn=!1,vd(n,a,w);bn=(n.flags&131072)!==0}else bn=!1,lt&&(a.flags&1048576)!==0&&pr(a,Te,a.index);switch(a.lanes=0,a.tag){case 2:var P=a.type;Fl(n,a),n=a.pendingProps;var G=Bi(a,jr.current);Io(a,w),G=tu(null,a,P,n,G,w);var Z=ru();return a.flags|=1,typeof G=="object"&&G!==null&&typeof G.render=="function"&&G.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Xr(P)?(Z=!0,Ds(a)):Z=!1,a.memoizedState=G.state!==null&&G.state!==void 0?G.state:null,$c(a),G.updater=Al,a.stateNode=G,G._reactInternals=a,Yc(a,P,n,w),a=uu(null,a,P,!0,Z,w)):(a.tag=0,lt&&Z&&vr(a),yn(null,a,G,w),a=a.child),a;case 16:P=a.elementType;e:{switch(Fl(n,a),n=a.pendingProps,G=P._init,P=G(P._payload),a.type=P,G=a.tag=Pd(P),n=nn(P,n),G){case 0:a=cu(null,a,P,n,w);break e;case 1:a=Ah(null,a,P,n,w);break e;case 11:a=wh(null,a,P,n,w);break e;case 14:a=bh(null,a,P,nn(P.type,n),w);break e}throw Error(t(306,P,""))}return a;case 0:return P=a.type,G=a.pendingProps,G=a.elementType===P?G:nn(P,G),cu(n,a,P,G,w);case 1:return P=a.type,G=a.pendingProps,G=a.elementType===P?G:nn(P,G),Ah(n,a,P,G,w);case 3:e:{if(Mh(a),n===null)throw Error(t(387));P=a.pendingProps,Z=a.memoizedState,G=Z.element,Ou(n,a),El(a,P,null,w);var re=a.memoizedState;if(P=re.element,Z.isDehydrated)if(Z={element:P,isDehydrated:!1,cache:re.cache,pendingSuspenseBoundaries:re.pendingSuspenseBoundaries,transitions:re.transitions},a.updateQueue.baseState=Z,a.memoizedState=Z,a.flags&256){G=Do(Error(t(423)),a),a=Th(n,a,P,w,G);break e}else if(P!==G){G=Do(Error(t(424)),a),a=Th(n,a,P,w,G);break e}else for(zt=Bn(a.stateNode.containerInfo.firstChild),Pt=a,lt=!0,It=null,w=qu(a,null,P,w),a.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if(xn(),P===G){a=ji(n,a,w);break e}yn(n,a,P,w)}a=a.child}return a;case 5:return Yu(a),n===null&&lr(a),P=a.type,G=a.pendingProps,Z=n!==null?n.memoizedProps:null,re=G.children,kn(P,G)?re=null:Z!==null&&kn(P,Z)&&(a.flags|=32),Eh(n,a),yn(n,a,re,w),a.child;case 6:return n===null&&lr(a),null;case 13:return Rh(n,a,w);case 4:return Xc(a,a.stateNode.containerInfo),P=a.pendingProps,n===null?a.child=Fo(a,null,P,w):yn(n,a,P,w),a.child;case 11:return P=a.type,G=a.pendingProps,G=a.elementType===P?G:nn(P,G),wh(n,a,P,G,w);case 7:return yn(n,a,a.pendingProps,w),a.child;case 8:return yn(n,a,a.pendingProps.children,w),a.child;case 12:return yn(n,a,a.pendingProps.children,w),a.child;case 10:e:{if(P=a.type._context,G=a.pendingProps,Z=a.memoizedProps,re=G.value,fr(bl,P._currentValue),P._currentValue=re,Z!==null)if(Rr(Z.value,re)){if(Z.children===G.children&&!rn.current){a=ji(n,a,w);break e}}else for(Z=a.child,Z!==null&&(Z.return=a);Z!==null;){var ge=Z.dependencies;if(ge!==null){re=Z.child;for(var Ce=ge.firstContext;Ce!==null;){if(Ce.context===P){if(Z.tag===1){Ce=Gi(-1,w&-w),Ce.tag=2;var qe=Z.updateQueue;if(qe!==null){qe=qe.shared;var ot=qe.pending;ot===null?Ce.next=Ce:(Ce.next=ot.next,ot.next=Ce),qe.pending=Ce}}Z.lanes|=w,Ce=Z.alternate,Ce!==null&&(Ce.lanes|=w),Wc(Z.return,w,a),ge.lanes|=w;break}Ce=Ce.next}}else if(Z.tag===10)re=Z.type===a.type?null:Z.child;else if(Z.tag===18){if(re=Z.return,re===null)throw Error(t(341));re.lanes|=w,ge=re.alternate,ge!==null&&(ge.lanes|=w),Wc(re,w,a),re=Z.sibling}else re=Z.child;if(re!==null)re.return=Z;else for(re=Z;re!==null;){if(re===a){re=null;break}if(Z=re.sibling,Z!==null){Z.return=re.return,re=Z;break}re=re.return}Z=re}yn(n,a,G.children,w),a=a.child}return a;case 9:return G=a.type,P=a.pendingProps.children,Io(a,w),G=jn(G),P=P(G),a.flags|=1,yn(n,a,P,w),a.child;case 14:return P=a.type,G=nn(P,a.pendingProps),G=nn(P.type,G),bh(n,a,P,G,w);case 15:return Sh(n,a,a.type,a.pendingProps,w);case 17:return P=a.type,G=a.pendingProps,G=a.elementType===P?G:nn(P,G),Fl(n,a),a.tag=1,Xr(P)?(n=!0,Ds(a)):n=!1,Io(a,w),Vu(a,P,G),Yc(a,P,G,w),uu(null,a,P,!0,n,w);case 19:return zh(n,a,w);case 22:return Ch(n,a,w)}throw Error(t(156,a.tag))};function td(n,a){return _i(n,a)}function Nd(n,a,w,P){this.tag=n,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=P,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hn(n,a,w,P){return new Nd(n,a,w,P)}function ku(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Pd(n){if(typeof n=="function")return ku(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Y)return 11;if(n===H)return 14}return 2}function _s(n,a){var w=n.alternate;return w===null?(w=Hn(n.tag,a,n.key,n.mode),w.elementType=n.elementType,w.type=n.type,w.stateNode=n.stateNode,w.alternate=n,n.alternate=w):(w.pendingProps=a,w.type=n.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=n.flags&14680064,w.childLanes=n.childLanes,w.lanes=n.lanes,w.child=n.child,w.memoizedProps=n.memoizedProps,w.memoizedState=n.memoizedState,w.updateQueue=n.updateQueue,a=n.dependencies,w.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},w.sibling=n.sibling,w.index=n.index,w.ref=n.ref,w}function $l(n,a,w,P,G,Z){var re=2;if(P=n,typeof n=="function")ku(n)&&(re=1);else if(typeof n=="string")re=5;else e:switch(n){case M:return Hs(w.children,G,Z,a);case R:re=8,G|=8;break;case N:return n=Hn(12,w,a,G|2),n.elementType=N,n.lanes=Z,n;case B:return n=Hn(13,w,a,G),n.elementType=B,n.lanes=Z,n;case D:return n=Hn(19,w,a,G),n.elementType=D,n.lanes=Z,n;case q:return ql(w,G,Z,a);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case I:re=10;break e;case L:re=9;break e;case Y:re=11;break e;case H:re=14;break e;case W:re=16,P=null;break e}throw Error(t(130,n==null?n:typeof n,""))}return a=Hn(re,w,a,G),a.elementType=n,a.type=P,a.lanes=Z,a}function Hs(n,a,w,P){return n=Hn(7,n,P,a),n.lanes=w,n}function ql(n,a,w,P){return n=Hn(22,n,P,a),n.elementType=q,n.lanes=w,n.stateNode={isHidden:!1},n}function zu(n,a,w){return n=Hn(6,n,null,a),n.lanes=w,n}function Nu(n,a,w){return a=Hn(4,n.children!==null?n.children:[],n.key,a),a.lanes=w,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}function Id(n,a,w,P,G){this.tag=a,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qs(0),this.expirationTimes=qs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qs(0),this.identifierPrefix=P,this.onRecoverableError=G,this.mutableSourceEagerHydrationData=null}function Pu(n,a,w,P,G,Z,re,ge,Ce){return n=new Id(n,a,w,ge,Ce),a===1?(a=1,Z===!0&&(a|=8)):a=0,Z=Hn(3,null,null,a),n.current=Z,Z.stateNode=n,Z.memoizedState={element:P,isDehydrated:w,cache:null,transitions:null,pendingSuspenseBoundaries:null},$c(Z),n}function Fd(n,a,w){var P=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_,key:P==null?null:""+P,children:n,containerInfo:a,implementation:w}}function rd(n){if(!n)return pi;n=n._reactInternals;e:{if(Kt(n)!==n||n.tag!==1)throw Error(t(170));var a=n;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Xr(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(n.tag===1){var w=n.type;if(Xr(w))return ka(n,w,a)}return a}function nd(n,a,w,P,G,Z,re,ge,Ce){return n=Pu(w,P,!0,n,G,Z,re,ge,Ce),n.context=rd(null),w=n.current,P=vn(),G=ys(w),Z=Gi(P,G),Z.callback=a??null,fs(w,Z,G),n.current.lanes=G,_n(n,G,P),Cn(n,P),n}function Yl(n,a,w,P){var G=a.current,Z=vn(),re=ys(G);return w=rd(w),a.context===null?a.context=w:a.pendingContext=w,a=Gi(Z,re),a.payload={element:n},P=P===void 0?null:P,P!==null&&(a.callback=P),n=fs(G,a,re),n!==null&&(Kn(n,G,re,Z),Cl(n,G,re)),re}function Xl(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function sd(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var w=n.retryLane;n.retryLane=w!==0&&w<a?w:a}}function Iu(n,a){sd(n,a),(n=n.alternate)&&sd(n,a)}function Ld(){return null}var od=typeof reportError=="function"?reportError:function(n){console.error(n)};function Fu(n){this._internalRoot=n}Zl.prototype.render=Fu.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(t(409));Yl(n,a,null,null)},Zl.prototype.unmount=Fu.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;js(function(){Yl(null,n,null,null)}),a[gn]=null}};function Zl(n){this._internalRoot=n}Zl.prototype.unstable_scheduleHydration=function(n){if(n){var a=$o();n={blockedOn:null,target:n,priority:a};for(var w=0;w<li.length&&a!==0&&a<li[w].priority;w++);li.splice(w,0,n),w===0&&qa(n)}};function Lu(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Jl(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function ad(){}function Dd(n,a,w,P,G){if(G){if(typeof P=="function"){var Z=P;P=function(){var qe=Xl(re);Z.call(qe)}}var re=nd(a,P,n,0,null,!1,!1,"",ad);return n._reactRootContainer=re,n[gn]=re.current,zs(n.nodeType===8?n.parentNode:n),js(),re}for(;G=n.lastChild;)n.removeChild(G);if(typeof P=="function"){var ge=P;P=function(){var qe=Xl(Ce);ge.call(qe)}}var Ce=Pu(n,0,!1,null,null,!1,!1,"",ad);return n._reactRootContainer=Ce,n[gn]=Ce.current,zs(n.nodeType===8?n.parentNode:n),js(function(){Yl(a,Ce,w,P)}),Ce}function Kl(n,a,w,P,G){var Z=w._reactRootContainer;if(Z){var re=Z;if(typeof G=="function"){var ge=G;G=function(){var Ce=Xl(re);ge.call(Ce)}}Yl(a,re,n,G)}else re=Dd(w,a,n,G,P);return Xl(re)}rr=function(n){switch(n.tag){case 3:var a=n.stateNode;if(a.current.memoizedState.isDehydrated){var w=Tr(a.pendingLanes);w!==0&&(On(a,w|1),Cn(a,dr()),(nr&6)===0&&(Uo=dr()+500,ae()))}break;case 13:js(function(){var P=Ui(n,1);if(P!==null){var G=vn();Kn(P,n,1,G)}}),Iu(n,1)}},Ai=function(n){if(n.tag===13){var a=Ui(n,134217728);if(a!==null){var w=vn();Kn(a,n,134217728,w)}Iu(n,134217728)}},Xs=function(n){if(n.tag===13){var a=ys(n),w=Ui(n,a);if(w!==null){var P=vn();Kn(w,n,a,P)}Iu(n,a)}},$o=function(){return Vt},Mi=function(n,a){var w=Vt;try{return Vt=n,a()}finally{Vt=w}},ee=function(n,a,w){switch(a){case"input":if(Je(n,w),a=w.name,w.type==="radio"&&a!=null){for(w=n;w.parentNode;)w=w.parentNode;for(w=w.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<w.length;a++){var P=w[a];if(P!==n&&P.form===n.form){var G=Ro(P);if(!G)throw Error(t(90));We(P),Je(P,G)}}}break;case"textarea":He(n,w);break;case"select":a=w.value,a!=null&&et(n,!!w.multiple,a,!1)}},ne=Mu,ve=js;var Od={usingClientEntryPoint:!1,Events:[Fs,cs,Ro,Re,Ae,Mu]},Ha={findFiberByHostInstance:Oi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Bd={bundleType:Ha.bundleType,version:Ha.version,rendererPackageName:Ha.rendererPackageName,rendererConfig:Ha.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:T.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=zr(n),n===null?null:n.stateNode},findFiberByHostInstance:Ha.findFiberByHostInstance||Ld,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tc.isDisabled&&tc.supportsFiber)try{Wi=tc.inject(Bd),Ir=tc}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Od,reactDom_production_min.createPortal=function(n,a){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lu(a))throw Error(t(200));return Fd(n,a,null,w)},reactDom_production_min.createRoot=function(n,a){if(!Lu(n))throw Error(t(299));var w=!1,P="",G=od;return a!=null&&(a.unstable_strictMode===!0&&(w=!0),a.identifierPrefix!==void 0&&(P=a.identifierPrefix),a.onRecoverableError!==void 0&&(G=a.onRecoverableError)),a=Pu(n,1,!1,null,null,w,!1,P,G),n[gn]=a.current,zs(n.nodeType===8?n.parentNode:n),new Fu(a)},reactDom_production_min.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(t(188)):(n=Object.keys(n).join(","),Error(t(268,n)));return n=zr(a),n=n===null?null:n.stateNode,n},reactDom_production_min.flushSync=function(n){return js(n)},reactDom_production_min.hydrate=function(n,a,w){if(!Jl(a))throw Error(t(200));return Kl(null,n,a,!0,w)},reactDom_production_min.hydrateRoot=function(n,a,w){if(!Lu(n))throw Error(t(405));var P=w!=null&&w.hydratedSources||null,G=!1,Z="",re=od;if(w!=null&&(w.unstable_strictMode===!0&&(G=!0),w.identifierPrefix!==void 0&&(Z=w.identifierPrefix),w.onRecoverableError!==void 0&&(re=w.onRecoverableError)),a=nd(a,null,n,1,w??null,G,!1,Z,re),n[gn]=a.current,zs(n),P)for(n=0;n<P.length;n++)w=P[n],G=w._getVersion,G=G(w._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[w,G]:a.mutableSourceEagerHydrationData.push(w,G);return new Zl(a)},reactDom_production_min.render=function(n,a,w){if(!Jl(a))throw Error(t(200));return Kl(null,n,a,!1,w)},reactDom_production_min.unmountComponentAtNode=function(n){if(!Jl(n))throw Error(t(40));return n._reactRootContainer?(js(function(){Kl(null,null,n,!1,function(){n._reactRootContainer=null,n[gn]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=Mu,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(n,a,w,P){if(!Jl(w))throw Error(t(200));if(n==null||n._reactInternals===void 0)throw Error(t(38));return Kl(n,a,w,!1,P)},reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var r=requireReactDom();return client.createRoot=r.createRoot,client.hydrateRoot=r.hydrateRoot,client}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs(clientExports);/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createBrowserHistory(r={}){function e(o,c){let{pathname:h,search:v,hash:p}=o.location;return createLocation("",{pathname:h,search:v,hash:p},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function t(o,c){return typeof c=="string"?c:createPath(c)}return getUrlBasedHistory(e,t,null,r)}function invariant(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function warning(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(r,e){return{usr:r.state,key:r.key,idx:e}}function createLocation(r,e,t=null,o){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?parsePath(e):e,state:t,key:e&&e.key||o||createKey()}}function createPath({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function parsePath(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let o=r.indexOf("?");o>=0&&(e.search=r.substring(o),r=r.substring(0,o)),r&&(e.pathname=r)}return e}function getUrlBasedHistory(r,e,t,o={}){let{window:c=document.defaultView,v5Compat:h=!1}=o,v=c.history,p="POP",g=null,x=f();x==null&&(x=0,v.replaceState({...v.state,idx:x},""));function f(){return(v.state||{idx:null}).idx}function b(){p="POP";let s=f(),y=s==null?null:s-x;x=s,g&&g({action:p,location:l.location,delta:y})}function C(s,y){p="PUSH";let A=createLocation(l.location,s,y);x=f()+1;let E=getHistoryState(A,x),T=l.createHref(A);try{v.pushState(E,"",T)}catch(u){if(u instanceof DOMException&&u.name==="DataCloneError")throw u;c.location.assign(T)}h&&g&&g({action:p,location:l.location,delta:1})}function S(s,y){p="REPLACE";let A=createLocation(l.location,s,y);x=f();let E=getHistoryState(A,x),T=l.createHref(A);v.replaceState(E,"",T),h&&g&&g({action:p,location:l.location,delta:0})}function k(s){return createBrowserURLImpl(s)}let l={get action(){return p},get location(){return r(c,v)},listen(s){if(g)throw new Error("A history only accepts one active listener");return c.addEventListener(PopStateEventType,b),g=s,()=>{c.removeEventListener(PopStateEventType,b),g=null}},createHref(s){return e(c,s)},createURL:k,encodeLocation(s){let y=k(s);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:C,replace:S,go(s){return v.go(s)}};return l}function createBrowserURLImpl(r,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),invariant(t,"No window.location.(origin|href) available to create URL");let o=typeof r=="string"?r:createPath(r);return o=o.replace(/ $/,"%20"),!e&&o.startsWith("//")&&(o=t+o),new URL(o,t)}function matchRoutes(r,e,t="/"){return matchRoutesImpl(r,e,t,!1)}function matchRoutesImpl(r,e,t,o){let c=typeof e=="string"?parsePath(e):e,h=stripBasename(c.pathname||"/",t);if(h==null)return null;let v=flattenRoutes(r);rankRouteBranches(v);let p=null;for(let g=0;p==null&&g<v.length;++g){let x=decodePath(h);p=matchRouteBranch(v[g],x,o)}return p}function flattenRoutes(r,e=[],t=[],o="",c=!1){let h=(v,p,g=c,x)=>{let f={relativePath:x===void 0?v.path||"":x,caseSensitive:v.caseSensitive===!0,childrenIndex:p,route:v};if(f.relativePath.startsWith("/")){if(!f.relativePath.startsWith(o)&&g)return;invariant(f.relativePath.startsWith(o),`Absolute route path "${f.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(o.length)}let b=joinPaths([o,f.relativePath]),C=t.concat(f);v.children&&v.children.length>0&&(invariant(v.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${b}".`),flattenRoutes(v.children,e,C,b,g)),!(v.path==null&&!v.index)&&e.push({path:b,score:computeScore(b,v.index),routesMeta:C})};return r.forEach((v,p)=>{if(v.path===""||!v.path?.includes("?"))h(v,p);else for(let g of explodeOptionalSegments(v.path))h(v,p,!0,g)}),e}function explodeOptionalSegments(r){let e=r.split("/");if(e.length===0)return[];let[t,...o]=e,c=t.endsWith("?"),h=t.replace(/\?$/,"");if(o.length===0)return c?[h,""]:[h];let v=explodeOptionalSegments(o.join("/")),p=[];return p.push(...v.map(g=>g===""?h:[h,g].join("/"))),c&&p.push(...v),p.map(g=>r.startsWith("/")&&g===""?"/":g)}function rankRouteBranches(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:compareIndexes(e.routesMeta.map(o=>o.childrenIndex),t.routesMeta.map(o=>o.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=r=>r==="*";function computeScore(r,e){let t=r.split("/"),o=t.length;return t.some(isSplat)&&(o+=splatPenalty),e&&(o+=indexRouteValue),t.filter(c=>!isSplat(c)).reduce((c,h)=>c+(paramRe.test(h)?dynamicSegmentValue:h===""?emptySegmentValue:staticSegmentValue),o)}function compareIndexes(r,e){return r.length===e.length&&r.slice(0,-1).every((o,c)=>o===e[c])?r[r.length-1]-e[e.length-1]:0}function matchRouteBranch(r,e,t=!1){let{routesMeta:o}=r,c={},h="/",v=[];for(let p=0;p<o.length;++p){let g=o[p],x=p===o.length-1,f=h==="/"?e:e.slice(h.length)||"/",b=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:x},f),C=g.route;if(!b&&x&&t&&!o[o.length-1].route.index&&(b=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},f)),!b)return null;Object.assign(c,b.params),v.push({params:c,pathname:joinPaths([h,b.pathname]),pathnameBase:normalizePathname(joinPaths([h,b.pathnameBase])),route:C}),b.pathnameBase!=="/"&&(h=joinPaths([h,b.pathnameBase]))}return v}function matchPath(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,o]=compilePath(r.path,r.caseSensitive,r.end),c=e.match(t);if(!c)return null;let h=c[0],v=h.replace(/(.)\/+$/,"$1"),p=c.slice(1);return{params:o.reduce((x,{paramName:f,isOptional:b},C)=>{if(f==="*"){let k=p[C]||"";v=h.slice(0,h.length-k.length).replace(/(.)\/+$/,"$1")}const S=p[C];return b&&!S?x[f]=void 0:x[f]=(S||"").replace(/%2F/g,"/"),x},{}),pathname:h,pathnameBase:v,pattern:r}}function compilePath(r,e=!1,t=!0){warning(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let o=[],c="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(v,p,g)=>(o.push({paramName:p,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(o.push({paramName:"*"}),c+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?c+="\\/*$":r!==""&&r!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,e?void 0:"i"),o]}function decodePath(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return warning(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function stripBasename(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,o=r.charAt(t);return o&&o!=="/"?null:r.slice(t)||"/"}function resolvePath(r,e="/"){let{pathname:t,search:o="",hash:c=""}=typeof r=="string"?parsePath(r):r;return{pathname:t?t.startsWith("/")?t:resolvePathname(t,e):e,search:normalizeSearch(o),hash:normalizeHash(c)}}function resolvePathname(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(c=>{c===".."?t.length>1&&t.pop():c!=="."&&t.push(c)}),t.length>1?t.join("/"):"/"}function getInvalidPathError(r,e,t,o){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function getResolveToMatches(r){let e=getPathContributingMatches(r);return e.map((t,o)=>o===e.length-1?t.pathname:t.pathnameBase)}function resolveTo(r,e,t,o=!1){let c;typeof r=="string"?c=parsePath(r):(c={...r},invariant(!c.pathname||!c.pathname.includes("?"),getInvalidPathError("?","pathname","search",c)),invariant(!c.pathname||!c.pathname.includes("#"),getInvalidPathError("#","pathname","hash",c)),invariant(!c.search||!c.search.includes("#"),getInvalidPathError("#","search","hash",c)));let h=r===""||c.pathname==="",v=h?"/":c.pathname,p;if(v==null)p=t;else{let b=e.length-1;if(!o&&v.startsWith("..")){let C=v.split("/");for(;C[0]==="..";)C.shift(),b-=1;c.pathname=C.join("/")}p=b>=0?e[b]:"/"}let g=resolvePath(c,p),x=v&&v!=="/"&&v.endsWith("/"),f=(h||v===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(x||f)&&(g.pathname+="/"),g}var joinPaths=r=>r.join("/").replace(/\/\/+/g,"/"),normalizePathname=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,normalizeHash=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function isRouteErrorResponse(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";reactExports.createContext(!1);var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(r,{relative:e}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:o}=reactExports.useContext(NavigationContext),{hash:c,pathname:h,search:v}=useResolvedPath(r,{relative:e}),p=h;return t!=="/"&&(p=h==="/"?t:joinPaths([t,h])),o.createHref({pathname:p,search:v,hash:c})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(r){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(r)}function useNavigate(){let{isDataRoute:r}=reactExports.useContext(RouteContext);return r?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let r=reactExports.useContext(DataRouterContext),{basename:e,navigator:t}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),h=JSON.stringify(getResolveToMatches(o)),v=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{v.current=!0}),reactExports.useCallback((g,x={})=>{if(warning(v.current,navigateEffectWarning),!v.current)return;if(typeof g=="number"){t.go(g);return}let f=resolveTo(g,JSON.parse(h),c,x.relative==="path");r==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:joinPaths([e,f.pathname])),(x.replace?t.replace:t.push)(f,x.state,x)},[e,t,h,c,r])}reactExports.createContext(null);function useResolvedPath(r,{relative:e}={}){let{matches:t}=reactExports.useContext(RouteContext),{pathname:o}=useLocation(),c=JSON.stringify(getResolveToMatches(t));return reactExports.useMemo(()=>resolveTo(r,JSON.parse(c),o,e==="path"),[r,c,o,e])}function useRoutesImpl(r,e,t,o,c){invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:h}=reactExports.useContext(NavigationContext),{matches:v}=reactExports.useContext(RouteContext),p=v[v.length-1],g=p?p.params:{},x=p?p.pathname:"/",f=p?p.pathnameBase:"/",b=p&&p.route;{let A=b&&b.path||"";warningOnce(x,!b||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${x}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let C=useLocation(),S;S=C;let k=S.pathname||"/",l=k;if(f!=="/"){let A=f.replace(/^\//,"").split("/");l="/"+k.replace(/^\//,"").split("/").slice(A.length).join("/")}let s=matchRoutes(r,{pathname:l});return warning(b||s!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),warning(s==null||s[s.length-1].route.element!==void 0||s[s.length-1].route.Component!==void 0||s[s.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),_renderMatches(s&&s.map(A=>Object.assign({},A,{params:Object.assign({},g,A.params),pathname:joinPaths([f,h.encodeLocation?h.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?f:joinPaths([f,h.encodeLocation?h.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),v,t,o,c)}function DefaultErrorComponent(){let r=useRouteError(),e=isRouteErrorResponse(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,o="rgba(200,200,200, 0.5)",c={padding:"0.5rem",backgroundColor:o},h={padding:"2px 4px",backgroundColor:o},v=null;return console.error("Error handled by React Router default ErrorBoundary:",r),v=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null,"💿 Hey developer 👋"),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:h},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:h},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),t?reactExports.createElement("pre",{style:c},t):null,v)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){this.props.unstable_onError?this.props.unstable_onError(r,e):console.error("React Router caught the following error during render",r)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:r,match:e,children:t}){let o=reactExports.useContext(DataRouterContext);return o&&o.static&&o.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=e.route.id),reactExports.createElement(RouteContext.Provider,{value:r},t)}function _renderMatches(r,e=[],t=null,o=null,c=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let h=r,v=t?.errors;if(v!=null){let x=h.findIndex(f=>f.route.id&&v?.[f.route.id]!==void 0);invariant(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(v).join(",")}`),h=h.slice(0,Math.min(h.length,x+1))}let p=!1,g=-1;if(t)for(let x=0;x<h.length;x++){let f=h[x];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(g=x),f.route.id){let{loaderData:b,errors:C}=t,S=f.route.loader&&!b.hasOwnProperty(f.route.id)&&(!C||C[f.route.id]===void 0);if(f.route.lazy||S){p=!0,g>=0?h=h.slice(0,g+1):h=[h[0]];break}}}return h.reduceRight((x,f,b)=>{let C,S=!1,k=null,l=null;t&&(C=v&&f.route.id?v[f.route.id]:void 0,k=f.route.errorElement||defaultErrorElement,p&&(g<0&&b===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,l=null):g===b&&(S=!0,l=f.route.hydrateFallbackElement||null)));let s=e.concat(h.slice(0,b+1)),y=()=>{let A;return C?A=k:S?A=l:f.route.Component?A=reactExports.createElement(f.route.Component,null):f.route.element?A=f.route.element:A=x,reactExports.createElement(RenderedRoute,{match:f,routeContext:{outlet:x,matches:s,isDataRoute:t!=null},children:A})};return t&&(f.route.ErrorBoundary||f.route.errorElement||b===0)?reactExports.createElement(RenderErrorBoundary,{location:t.location,revalidation:t.revalidation,component:k,error:C,children:y(),routeContext:{outlet:null,matches:s,isDataRoute:!0},unstable_onError:o}):y()},null)}function getDataRouterConsoleError(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(r){let e=reactExports.useContext(DataRouterContext);return invariant(e,getDataRouterConsoleError(r)),e}function useDataRouterState(r){let e=reactExports.useContext(DataRouterStateContext);return invariant(e,getDataRouterConsoleError(r)),e}function useRouteContext(r){let e=reactExports.useContext(RouteContext);return invariant(e,getDataRouterConsoleError(r)),e}function useCurrentRouteId(r){let e=useRouteContext(r),t=e.matches[e.matches.length-1];return invariant(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){let r=reactExports.useContext(RouteErrorContext),e=useDataRouterState("useRouteError"),t=useCurrentRouteId("useRouteError");return r!==void 0?r:e.errors?.[t]}function useNavigateStable(){let{router:r}=useDataRouterContext("useNavigate"),e=useCurrentRouteId("useNavigate"),t=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{t.current=!0}),reactExports.useCallback(async(c,h={})=>{warning(t.current,navigateEffectWarning),t.current&&(typeof c=="number"?r.navigate(c):await r.navigate(c,{fromRouteId:e,...h}))},[r,e])}var alreadyWarned={};function warningOnce(r,e,t){!e&&!alreadyWarned[r]&&(alreadyWarned[r]=!0,warning(!1,t))}reactExports.memo(DataRoutes);function DataRoutes({routes:r,future:e,state:t,unstable_onError:o}){return useRoutesImpl(r,void 0,t,o,e)}function Router({basename:r="/",children:e=null,location:t,navigationType:o="POP",navigator:c,static:h=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let v=r.replace(/^\/*/,"/"),p=reactExports.useMemo(()=>({basename:v,navigator:c,static:h,future:{}}),[v,c,h]);typeof t=="string"&&(t=parsePath(t));let{pathname:g="/",search:x="",hash:f="",state:b=null,key:C="default"}=t,S=reactExports.useMemo(()=>{let k=stripBasename(g,v);return k==null?null:{location:{pathname:k,search:x,hash:f,state:b,key:C},navigationType:o}},[v,g,x,f,b,C,o]);return warning(S!=null,`<Router basename="${v}"> is not able to match the URL "${g}${x}${f}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:reactExports.createElement(NavigationContext.Provider,{value:p},reactExports.createElement(LocationContext.Provider,{children:e,value:S}))}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(r){return r!=null&&typeof r.tagName=="string"}function isButtonElement(r){return isHtmlElement(r)&&r.tagName.toLowerCase()==="button"}function isFormElement(r){return isHtmlElement(r)&&r.tagName.toLowerCase()==="form"}function isInputElement(r){return isHtmlElement(r)&&r.tagName.toLowerCase()==="input"}function isModifiedEvent(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function shouldProcessLinkClick(r,e){return r.button===0&&(!e||e==="_self")&&!isModifiedEvent(r)}function createSearchParams(r=""){return new URLSearchParams(typeof r=="string"||Array.isArray(r)||r instanceof URLSearchParams?r:Object.keys(r).reduce((e,t)=>{let o=r[t];return e.concat(Array.isArray(o)?o.map(c=>[t,c]):[[t,o]])},[]))}function getSearchParamsForLocation(r,e){let t=createSearchParams(r);return e&&e.forEach((o,c)=>{t.has(c)||e.getAll(c).forEach(h=>{t.append(c,h)})}),t}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(r){return r!=null&&!supportedFormEncTypes.has(r)?(warning(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):r}function getFormSubmissionInfo(r,e){let t,o,c,h,v;if(isFormElement(r)){let p=r.getAttribute("action");o=p?stripBasename(p,e):null,t=r.getAttribute("method")||defaultMethod,c=getFormEncType(r.getAttribute("enctype"))||defaultEncType,h=new FormData(r)}else if(isButtonElement(r)||isInputElement(r)&&(r.type==="submit"||r.type==="image")){let p=r.form;if(p==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=r.getAttribute("formaction")||p.getAttribute("action");if(o=g?stripBasename(g,e):null,t=r.getAttribute("formmethod")||p.getAttribute("method")||defaultMethod,c=getFormEncType(r.getAttribute("formenctype"))||getFormEncType(p.getAttribute("enctype"))||defaultEncType,h=new FormData(p,r),!isFormDataSubmitterSupported()){let{name:x,type:f,value:b}=r;if(f==="image"){let C=x?`${x}.`:"";h.append(`${C}x`,"0"),h.append(`${C}y`,"0")}else x&&h.append(x,b)}}else{if(isHtmlElement(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=defaultMethod,o=null,c=defaultEncType,v=r}return h&&c==="text/plain"&&(v=h,h=void 0),{action:o,method:t.toLowerCase(),encType:c,formData:h,body:v}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function invariant2(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function singleFetchUrl(r,e,t){let o=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return o.pathname==="/"?o.pathname=`_root.${t}`:e&&stripBasename(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${t}`,o}async function loadRouteModule(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function getKeyedPrefetchLinks(r,e,t){let o=await Promise.all(r.map(async c=>{let h=e.routes[c.route.id];if(h){let v=await loadRouteModule(h,t);return v.links?v.links():[]}return[]}));return dedupeLinkDescriptors(o.flat(1).filter(isHtmlLinkDescriptor).filter(c=>c.rel==="stylesheet"||c.rel==="preload").map(c=>c.rel==="stylesheet"?{...c,rel:"prefetch",as:"style"}:{...c,rel:"prefetch"}))}function getNewMatchesForLinks(r,e,t,o,c,h){let v=(g,x)=>t[x]?g.route.id!==t[x].route.id:!0,p=(g,x)=>t[x].pathname!==g.pathname||t[x].route.path?.endsWith("*")&&t[x].params["*"]!==g.params["*"];return h==="assets"?e.filter((g,x)=>v(g,x)||p(g,x)):h==="data"?e.filter((g,x)=>{let f=o.routes[g.route.id];if(!f||!f.hasLoader)return!1;if(v(g,x)||p(g,x))return!0;if(g.route.shouldRevalidate){let b=g.route.shouldRevalidate({currentUrl:new URL(c.pathname+c.search+c.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function getModuleLinkHrefs(r,e,{includeHydrateFallback:t}={}){return dedupeHrefs(r.map(o=>{let c=e.routes[o.route.id];if(!c)return[];let h=[c.module];return c.clientActionModule&&(h=h.concat(c.clientActionModule)),c.clientLoaderModule&&(h=h.concat(c.clientLoaderModule)),t&&c.hydrateFallbackModule&&(h=h.concat(c.hydrateFallbackModule)),c.imports&&(h=h.concat(c.imports)),h}).flat(1))}function dedupeHrefs(r){return[...new Set(r)]}function sortKeys(r){let e={},t=Object.keys(r).sort();for(let o of t)e[o]=r[o];return e}function dedupeLinkDescriptors(r,e){let t=new Set;return new Set(e),r.reduce((o,c)=>{let h=JSON.stringify(sortKeys(c));return t.has(h)||(t.add(h),o.push({key:h,link:c})),o},[])}function useDataRouterContext2(){let r=reactExports.useContext(DataRouterContext);return invariant2(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function useDataRouterStateContext(){let r=reactExports.useContext(DataRouterStateContext);return invariant2(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let r=reactExports.useContext(FrameworkContext);return invariant2(r,"You must render this element inside a <HydratedRouter> element"),r}function usePrefetchBehavior(r,e){let t=reactExports.useContext(FrameworkContext),[o,c]=reactExports.useState(!1),[h,v]=reactExports.useState(!1),{onFocus:p,onBlur:g,onMouseEnter:x,onMouseLeave:f,onTouchStart:b}=e,C=reactExports.useRef(null);reactExports.useEffect(()=>{if(r==="render"&&v(!0),r==="viewport"){let l=y=>{y.forEach(A=>{v(A.isIntersecting)})},s=new IntersectionObserver(l,{threshold:.5});return C.current&&s.observe(C.current),()=>{s.disconnect()}}},[r]),reactExports.useEffect(()=>{if(o){let l=setTimeout(()=>{v(!0)},100);return()=>{clearTimeout(l)}}},[o]);let S=()=>{c(!0)},k=()=>{c(!1),v(!1)};return t?r!=="intent"?[h,C,{}]:[h,C,{onFocus:composeEventHandlers(p,S),onBlur:composeEventHandlers(g,k),onMouseEnter:composeEventHandlers(x,S),onMouseLeave:composeEventHandlers(f,k),onTouchStart:composeEventHandlers(b,S)}]:[!1,C,{}]}function composeEventHandlers(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function PrefetchPageLinks({page:r,...e}){let{router:t}=useDataRouterContext2(),o=reactExports.useMemo(()=>matchRoutes(t.routes,r,t.basename),[t.routes,r,t.basename]);return o?reactExports.createElement(PrefetchPageLinksImpl,{page:r,matches:o,...e}):null}function useKeyedPrefetchLinks(r){let{manifest:e,routeModules:t}=useFrameworkContext(),[o,c]=reactExports.useState([]);return reactExports.useEffect(()=>{let h=!1;return getKeyedPrefetchLinks(r,e,t).then(v=>{h||c(v)}),()=>{h=!0}},[r,e,t]),o}function PrefetchPageLinksImpl({page:r,matches:e,...t}){let o=useLocation(),{manifest:c,routeModules:h}=useFrameworkContext(),{basename:v}=useDataRouterContext2(),{loaderData:p,matches:g}=useDataRouterStateContext(),x=reactExports.useMemo(()=>getNewMatchesForLinks(r,e,g,c,o,"data"),[r,e,g,c,o]),f=reactExports.useMemo(()=>getNewMatchesForLinks(r,e,g,c,o,"assets"),[r,e,g,c,o]),b=reactExports.useMemo(()=>{if(r===o.pathname+o.search+o.hash)return[];let k=new Set,l=!1;if(e.forEach(y=>{let A=c.routes[y.route.id];!A||!A.hasLoader||(!x.some(E=>E.route.id===y.route.id)&&y.route.id in p&&h[y.route.id]?.shouldRevalidate||A.hasClientLoader?l=!0:k.add(y.route.id))}),k.size===0)return[];let s=singleFetchUrl(r,v,"data");return l&&k.size>0&&s.searchParams.set("_routes",e.filter(y=>k.has(y.route.id)).map(y=>y.route.id).join(",")),[s.pathname+s.search]},[v,p,o,c,x,e,r,h]),C=reactExports.useMemo(()=>getModuleLinkHrefs(f,c),[f,c]),S=useKeyedPrefetchLinks(f);return reactExports.createElement(reactExports.Fragment,null,b.map(k=>reactExports.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...t})),C.map(k=>reactExports.createElement("link",{key:k,rel:"modulepreload",href:k,...t})),S.map(({key:k,link:l})=>reactExports.createElement("link",{key:k,nonce:t.nonce,...l})))}function mergeRefs(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser&&(window.__reactRouterVersion="7.8.2")}catch{}function BrowserRouter({basename:r,children:e,window:t}){let o=reactExports.useRef();o.current==null&&(o.current=createBrowserHistory({window:t,v5Compat:!0}));let c=o.current,[h,v]=reactExports.useState({action:c.action,location:c.location}),p=reactExports.useCallback(g=>{reactExports.startTransition(()=>v(g))},[v]);return reactExports.useLayoutEffect(()=>c.listen(p),[c,p]),reactExports.createElement(Router,{basename:r,children:e,location:h.location,navigationType:h.action,navigator:c})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:e,discover:t="render",prefetch:o="none",relative:c,reloadDocument:h,replace:v,state:p,target:g,to:x,preventScrollReset:f,viewTransition:b,...C},S){let{basename:k}=reactExports.useContext(NavigationContext),l=typeof x=="string"&&ABSOLUTE_URL_REGEX2.test(x),s,y=!1;if(typeof x=="string"&&l&&(s=x,isBrowser))try{let N=new URL(window.location.href),I=x.startsWith("//")?new URL(N.protocol+x):new URL(x),L=stripBasename(I.pathname,k);I.origin===N.origin&&L!=null?x=L+I.search+I.hash:y=!0}catch{warning(!1,`<Link to="${x}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let A=useHref(x,{relative:c}),[E,T,u]=usePrefetchBehavior(o,C),_=useLinkClickHandler(x,{replace:v,state:p,target:g,preventScrollReset:f,relative:c,viewTransition:b});function M(N){e&&e(N),N.defaultPrevented||_(N)}let R=reactExports.createElement("a",{...C,...u,href:s||A,onClick:y||h?e:M,ref:mergeRefs(S,T),target:g,"data-discover":!l&&t==="render"?"true":void 0});return E&&!l?reactExports.createElement(reactExports.Fragment,null,R,reactExports.createElement(PrefetchPageLinks,{page:A})):R});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:o="",end:c=!1,style:h,to:v,viewTransition:p,children:g,...x},f){let b=useResolvedPath(v,{relative:x.relative}),C=useLocation(),S=reactExports.useContext(DataRouterStateContext),{navigator:k,basename:l}=reactExports.useContext(NavigationContext),s=S!=null&&useViewTransitionState(b)&&p===!0,y=k.encodeLocation?k.encodeLocation(b).pathname:b.pathname,A=C.pathname,E=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(A=A.toLowerCase(),E=E?E.toLowerCase():null,y=y.toLowerCase()),E&&l&&(E=stripBasename(E,l)||E);const T=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let u=A===y||!c&&A.startsWith(y)&&A.charAt(T)==="/",_=E!=null&&(E===y||!c&&E.startsWith(y)&&E.charAt(y.length)==="/"),M={isActive:u,isPending:_,isTransitioning:s},R=u?e:void 0,N;typeof o=="function"?N=o(M):N=[o,u?"active":null,_?"pending":null,s?"transitioning":null].filter(Boolean).join(" ");let I=typeof h=="function"?h(M):h;return reactExports.createElement(Link,{...x,"aria-current":R,className:N,ref:f,style:I,to:v,viewTransition:p},typeof g=="function"?g(M):g)});NavLink.displayName="NavLink";var Form$2=reactExports.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:o,replace:c,state:h,method:v=defaultMethod,action:p,onSubmit:g,relative:x,preventScrollReset:f,viewTransition:b,...C},S)=>{let k=useSubmit(),l=useFormAction(p,{relative:x}),s=v.toLowerCase()==="get"?"get":"post",y=typeof p=="string"&&ABSOLUTE_URL_REGEX2.test(p),A=E=>{if(g&&g(E),E.defaultPrevented)return;E.preventDefault();let T=E.nativeEvent.submitter,u=T?.getAttribute("formmethod")||v;k(T||E.currentTarget,{fetcherKey:e,method:u,navigate:t,replace:c,state:h,relative:x,preventScrollReset:f,viewTransition:b})};return reactExports.createElement("form",{ref:S,method:s,action:l,onSubmit:o?g:A,...C,"data-discover":!y&&r==="render"?"true":void 0})});Form$2.displayName="Form";function getDataRouterConsoleError2(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(r){let e=reactExports.useContext(DataRouterContext);return invariant(e,getDataRouterConsoleError2(r)),e}function useLinkClickHandler(r,{target:e,replace:t,state:o,preventScrollReset:c,relative:h,viewTransition:v}={}){let p=useNavigate(),g=useLocation(),x=useResolvedPath(r,{relative:h});return reactExports.useCallback(f=>{if(shouldProcessLinkClick(f,e)){f.preventDefault();let b=t!==void 0?t:createPath(g)===createPath(x);p(r,{replace:b,state:o,preventScrollReset:c,relative:h,viewTransition:v})}},[g,p,x,t,o,e,r,c,h,v])}function useSearchParams(r){warning(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=reactExports.useRef(createSearchParams(r)),t=reactExports.useRef(!1),o=useLocation(),c=reactExports.useMemo(()=>getSearchParamsForLocation(o.search,t.current?null:e.current),[o.search]),h=useNavigate(),v=reactExports.useCallback((p,g)=>{const x=createSearchParams(typeof p=="function"?p(new URLSearchParams(c)):p);t.current=!0,h("?"+x,g)},[h,c]);return[c,v]}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:r}=useDataRouterContext3("useSubmit"),{basename:e}=reactExports.useContext(NavigationContext),t=useRouteId();return reactExports.useCallback(async(o,c={})=>{let{action:h,method:v,encType:p,formData:g,body:x}=getFormSubmissionInfo(o,e);if(c.navigate===!1){let f=c.fetcherKey||getUniqueFetcherId();await r.fetch(f,t,c.action||h,{preventScrollReset:c.preventScrollReset,formData:g,body:x,formMethod:c.method||v,formEncType:c.encType||p,flushSync:c.flushSync})}else await r.navigate(c.action||h,{preventScrollReset:c.preventScrollReset,formData:g,body:x,formMethod:c.method||v,formEncType:c.encType||p,replace:c.replace,state:c.state,fromRouteId:t,flushSync:c.flushSync,viewTransition:c.viewTransition})},[r,e,t])}function useFormAction(r,{relative:e}={}){let{basename:t}=reactExports.useContext(NavigationContext),o=reactExports.useContext(RouteContext);invariant(o,"useFormAction must be used inside a RouteContext");let[c]=o.matches.slice(-1),h={...useResolvedPath(r||".",{relative:e})},v=useLocation();if(r==null){h.search=v.search;let p=new URLSearchParams(h.search),g=p.getAll("index");if(g.some(f=>f==="")){p.delete("index"),g.filter(b=>b).forEach(b=>p.append("index",b));let f=p.toString();h.search=f?`?${f}`:""}}return(!r||r===".")&&c.route.index&&(h.search=h.search?h.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(h.pathname=h.pathname==="/"?t:joinPaths([t,h.pathname])),createPath(h)}function useViewTransitionState(r,{relative:e}={}){let t=reactExports.useContext(ViewTransitionContext);invariant(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=useDataRouterContext3("useViewTransitionState"),c=useResolvedPath(r,{relative:e});if(!t.isTransitioning)return!1;let h=stripBasename(t.currentLocation.pathname,o)||t.currentLocation.pathname,v=stripBasename(t.nextLocation.pathname,o)||t.nextLocation.pathname;return matchPath(c.pathname,v)!=null||matchPath(c.pathname,h)!=null}requireReactDom();function cc$1(r){if(typeof r=="string"||typeof r=="number")return""+r;let e="";if(Array.isArray(r))for(let t=0,o;t<r.length;t++)(o=cc$1(r[t]))!==""&&(e+=(e&&" ")+o);else for(let t in r)r[t]&&(e+=(e&&" ")+t);return e}var withSelector={exports:{}},withSelector_production={},shim={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredUseSyncExternalStoreShim_production;function requireUseSyncExternalStoreShim_production(){if(hasRequiredUseSyncExternalStoreShim_production)return useSyncExternalStoreShim_production;hasRequiredUseSyncExternalStoreShim_production=1;var r=requireReact();function e(b,C){return b===C&&(b!==0||1/b===1/C)||b!==b&&C!==C}var t=typeof Object.is=="function"?Object.is:e,o=r.useState,c=r.useEffect,h=r.useLayoutEffect,v=r.useDebugValue;function p(b,C){var S=C(),k=o({inst:{value:S,getSnapshot:C}}),l=k[0].inst,s=k[1];return h(function(){l.value=S,l.getSnapshot=C,g(l)&&s({inst:l})},[b,S,C]),c(function(){return g(l)&&s({inst:l}),b(function(){g(l)&&s({inst:l})})},[b]),v(S),S}function g(b){var C=b.getSnapshot;b=b.value;try{var S=C();return!t(b,S)}catch{return!0}}function x(b,C){return C()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?x:p;return useSyncExternalStoreShim_production.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:f,useSyncExternalStoreShim_production}var hasRequiredShim;function requireShim(){return hasRequiredShim||(hasRequiredShim=1,shim.exports=requireUseSyncExternalStoreShim_production()),shim.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredWithSelector_production;function requireWithSelector_production(){if(hasRequiredWithSelector_production)return withSelector_production;hasRequiredWithSelector_production=1;var r=requireReact(),e=requireShim();function t(x,f){return x===f&&(x!==0||1/x===1/f)||x!==x&&f!==f}var o=typeof Object.is=="function"?Object.is:t,c=e.useSyncExternalStore,h=r.useRef,v=r.useEffect,p=r.useMemo,g=r.useDebugValue;return withSelector_production.useSyncExternalStoreWithSelector=function(x,f,b,C,S){var k=h(null);if(k.current===null){var l={hasValue:!1,value:null};k.current=l}else l=k.current;k=p(function(){function y(_){if(!A){if(A=!0,E=_,_=C(_),S!==void 0&&l.hasValue){var M=l.value;if(S(M,_))return T=M}return T=_}if(M=T,o(E,_))return M;var R=C(_);return S!==void 0&&S(M,R)?(E=_,M):(E=_,T=R)}var A=!1,E,T,u=b===void 0?null:b;return[function(){return y(f())},u===null?void 0:function(){return y(u())}]},[f,b,C,S]);var s=c(x,k[0],k[1]);return v(function(){l.hasValue=!0,l.value=s},[s]),g(s),s},withSelector_production}var hasRequiredWithSelector;function requireWithSelector(){return hasRequiredWithSelector||(hasRequiredWithSelector=1,withSelector.exports=requireWithSelector_production()),withSelector.exports}var withSelectorExports=requireWithSelector();const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports),__vite_import_meta_env__={},createStoreImpl=r=>{let e;const t=new Set,o=(f,b)=>{const C=typeof f=="function"?f(e):f;if(!Object.is(C,e)){const S=e;e=b??(typeof C!="object"||C===null)?C:Object.assign({},e,C),t.forEach(k=>k(e,S))}},c=()=>e,g={setState:o,getState:c,getInitialState:()=>x,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(__vite_import_meta_env__?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},x=e=r(o,c,g);return g},createStore=r=>r?createStoreImpl(r):createStoreImpl,{useDebugValue}=React,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports,identity$2=r=>r;function useStoreWithEqualityFn(r,e=identity$2,t){const o=useSyncExternalStoreWithSelector(r.subscribe,r.getState,r.getServerState||r.getInitialState,e,t);return useDebugValue(o),o}const createWithEqualityFnImpl=(r,e)=>{const t=createStore(r),o=(c,h=e)=>useStoreWithEqualityFn(t,c,h);return Object.assign(o,t),o},createWithEqualityFn=(r,e)=>r?createWithEqualityFnImpl(r,e):createWithEqualityFnImpl;function shallow$1(r,e){if(Object.is(r,e))return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;if(r instanceof Map&&e instanceof Map){if(r.size!==e.size)return!1;for(const[o,c]of r)if(!Object.is(c,e.get(o)))return!1;return!0}if(r instanceof Set&&e instanceof Set){if(r.size!==e.size)return!1;for(const o of r)if(!e.has(o))return!1;return!0}const t=Object.keys(r);if(t.length!==Object.keys(e).length)return!1;for(const o of t)if(!Object.prototype.hasOwnProperty.call(e,o)||!Object.is(r[o],e[o]))return!1;return!0}var noop$1={value:()=>{}};function dispatch(){for(var r=0,e=arguments.length,t={},o;r<e;++r){if(!(o=arguments[r]+"")||o in t||/[\s.]/.test(o))throw new Error("illegal type: "+o);t[o]=[]}return new Dispatch(t)}function Dispatch(r){this._=r}function parseTypenames$1(r,e){return r.trim().split(/^|\s+/).map(function(t){var o="",c=t.indexOf(".");if(c>=0&&(o=t.slice(c+1),t=t.slice(0,c)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:o}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(r,e){var t=this._,o=parseTypenames$1(r+"",t),c,h=-1,v=o.length;if(arguments.length<2){for(;++h<v;)if((c=(r=o[h]).type)&&(c=get$1(t[c],r.name)))return c;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++h<v;)if(c=(r=o[h]).type)t[c]=set$1(t[c],r.name,e);else if(e==null)for(c in t)t[c]=set$1(t[c],r.name,null);return this},copy:function(){var r={},e=this._;for(var t in e)r[t]=e[t].slice();return new Dispatch(r)},call:function(r,e){if((c=arguments.length-2)>0)for(var t=new Array(c),o=0,c,h;o<c;++o)t[o]=arguments[o+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(h=this._[r],o=0,c=h.length;o<c;++o)h[o].value.apply(e,t)},apply:function(r,e,t){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var o=this._[r],c=0,h=o.length;c<h;++c)o[c].value.apply(e,t)}};function get$1(r,e){for(var t=0,o=r.length,c;t<o;++t)if((c=r[t]).name===e)return c.value}function set$1(r,e,t){for(var o=0,c=r.length;o<c;++o)if(r[o].name===e){r[o]=noop$1,r=r.slice(0,o).concat(r.slice(o+1));break}return t!=null&&r.push({name:e,value:t}),r}var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(r){var e=r+="",t=e.indexOf(":");return t>=0&&(e=r.slice(0,t))!=="xmlns"&&(r=r.slice(t+1)),namespaces.hasOwnProperty(e)?{space:namespaces[e],local:r}:r}function creatorInherit(r){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===xhtml&&e.documentElement.namespaceURI===xhtml?e.createElement(r):e.createElementNS(t,r)}}function creatorFixed(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function creator(r){var e=namespace(r);return(e.local?creatorFixed:creatorInherit)(e)}function none(){}function selector$h(r){return r==null?none:function(){return this.querySelector(r)}}function selection_select(r){typeof r!="function"&&(r=selector$h(r));for(var e=this._groups,t=e.length,o=new Array(t),c=0;c<t;++c)for(var h=e[c],v=h.length,p=o[c]=new Array(v),g,x,f=0;f<v;++f)(g=h[f])&&(x=r.call(g,g.__data__,f,h))&&("__data__"in g&&(x.__data__=g.__data__),p[f]=x);return new Selection$1(o,this._parents)}function array(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function empty(){return[]}function selectorAll(r){return r==null?empty:function(){return this.querySelectorAll(r)}}function arrayAll(r){return function(){return array(r.apply(this,arguments))}}function selection_selectAll(r){typeof r=="function"?r=arrayAll(r):r=selectorAll(r);for(var e=this._groups,t=e.length,o=[],c=[],h=0;h<t;++h)for(var v=e[h],p=v.length,g,x=0;x<p;++x)(g=v[x])&&(o.push(r.call(g,g.__data__,x,v)),c.push(g));return new Selection$1(o,c)}function matcher(r){return function(){return this.matches(r)}}function childMatcher(r){return function(e){return e.matches(r)}}var find=Array.prototype.find;function childFind(r){return function(){return find.call(this.children,r)}}function childFirst(){return this.firstElementChild}function selection_selectChild(r){return this.select(r==null?childFirst:childFind(typeof r=="function"?r:childMatcher(r)))}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(r){return function(){return filter.call(this.children,r)}}function selection_selectChildren(r){return this.selectAll(r==null?children:childrenFilter(typeof r=="function"?r:childMatcher(r)))}function selection_filter(r){typeof r!="function"&&(r=matcher(r));for(var e=this._groups,t=e.length,o=new Array(t),c=0;c<t;++c)for(var h=e[c],v=h.length,p=o[c]=[],g,x=0;x<v;++x)(g=h[x])&&r.call(g,g.__data__,x,h)&&p.push(g);return new Selection$1(o,this._parents)}function sparse(r){return new Array(r.length)}function selection_enter(){return new Selection$1(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(r,e){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=e}EnterNode.prototype={constructor:EnterNode,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,e){return this._parent.insertBefore(r,e)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function constant$3(r){return function(){return r}}function bindIndex(r,e,t,o,c,h){for(var v=0,p,g=e.length,x=h.length;v<x;++v)(p=e[v])?(p.__data__=h[v],o[v]=p):t[v]=new EnterNode(r,h[v]);for(;v<g;++v)(p=e[v])&&(c[v]=p)}function bindKey(r,e,t,o,c,h,v){var p,g,x=new Map,f=e.length,b=h.length,C=new Array(f),S;for(p=0;p<f;++p)(g=e[p])&&(C[p]=S=v.call(g,g.__data__,p,e)+"",x.has(S)?c[p]=g:x.set(S,g));for(p=0;p<b;++p)S=v.call(r,h[p],p,h)+"",(g=x.get(S))?(o[p]=g,g.__data__=h[p],x.delete(S)):t[p]=new EnterNode(r,h[p]);for(p=0;p<f;++p)(g=e[p])&&x.get(C[p])===g&&(c[p]=g)}function datum(r){return r.__data__}function selection_data(r,e){if(!arguments.length)return Array.from(this,datum);var t=e?bindKey:bindIndex,o=this._parents,c=this._groups;typeof r!="function"&&(r=constant$3(r));for(var h=c.length,v=new Array(h),p=new Array(h),g=new Array(h),x=0;x<h;++x){var f=o[x],b=c[x],C=b.length,S=arraylike(r.call(f,f&&f.__data__,x,o)),k=S.length,l=p[x]=new Array(k),s=v[x]=new Array(k),y=g[x]=new Array(C);t(f,b,l,s,y,S,e);for(var A=0,E=0,T,u;A<k;++A)if(T=l[A]){for(A>=E&&(E=A+1);!(u=s[E])&&++E<k;);T._next=u||null}}return v=new Selection$1(v,o),v._enter=p,v._exit=g,v}function arraylike(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function selection_exit(){return new Selection$1(this._exit||this._groups.map(sparse),this._parents)}function selection_join(r,e,t){var o=this.enter(),c=this,h=this.exit();return typeof r=="function"?(o=r(o),o&&(o=o.selection())):o=o.append(r+""),e!=null&&(c=e(c),c&&(c=c.selection())),t==null?h.remove():t(h),o&&c?o.merge(c).order():c}function selection_merge(r){for(var e=r.selection?r.selection():r,t=this._groups,o=e._groups,c=t.length,h=o.length,v=Math.min(c,h),p=new Array(c),g=0;g<v;++g)for(var x=t[g],f=o[g],b=x.length,C=p[g]=new Array(b),S,k=0;k<b;++k)(S=x[k]||f[k])&&(C[k]=S);for(;g<c;++g)p[g]=t[g];return new Selection$1(p,this._parents)}function selection_order(){for(var r=this._groups,e=-1,t=r.length;++e<t;)for(var o=r[e],c=o.length-1,h=o[c],v;--c>=0;)(v=o[c])&&(h&&v.compareDocumentPosition(h)^4&&h.parentNode.insertBefore(v,h),h=v);return this}function selection_sort(r){r||(r=ascending);function e(b,C){return b&&C?r(b.__data__,C.__data__):!b-!C}for(var t=this._groups,o=t.length,c=new Array(o),h=0;h<o;++h){for(var v=t[h],p=v.length,g=c[h]=new Array(p),x,f=0;f<p;++f)(x=v[f])&&(g[f]=x);g.sort(e)}return new Selection$1(c,this._parents).order()}function ascending(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function selection_call(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var o=r[e],c=0,h=o.length;c<h;++c){var v=o[c];if(v)return v}return null}function selection_size(){let r=0;for(const e of this)++r;return r}function selection_empty(){return!this.node()}function selection_each(r){for(var e=this._groups,t=0,o=e.length;t<o;++t)for(var c=e[t],h=0,v=c.length,p;h<v;++h)(p=c[h])&&r.call(p,p.__data__,h,c);return this}function attrRemove$1(r){return function(){this.removeAttribute(r)}}function attrRemoveNS$1(r){return function(){this.removeAttributeNS(r.space,r.local)}}function attrConstant$1(r,e){return function(){this.setAttribute(r,e)}}function attrConstantNS$1(r,e){return function(){this.setAttributeNS(r.space,r.local,e)}}function attrFunction$1(r,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(r):this.setAttribute(r,t)}}function attrFunctionNS$1(r,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,t)}}function selection_attr(r,e){var t=namespace(r);if(arguments.length<2){var o=this.node();return t.local?o.getAttributeNS(t.space,t.local):o.getAttribute(t)}return this.each((e==null?t.local?attrRemoveNS$1:attrRemove$1:typeof e=="function"?t.local?attrFunctionNS$1:attrFunction$1:t.local?attrConstantNS$1:attrConstant$1)(t,e))}function defaultView(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function styleRemove$1(r){return function(){this.style.removeProperty(r)}}function styleConstant$1(r,e,t){return function(){this.style.setProperty(r,e,t)}}function styleFunction$1(r,e,t){return function(){var o=e.apply(this,arguments);o==null?this.style.removeProperty(r):this.style.setProperty(r,o,t)}}function selection_style(r,e,t){return arguments.length>1?this.each((e==null?styleRemove$1:typeof e=="function"?styleFunction$1:styleConstant$1)(r,e,t??"")):styleValue(this.node(),r)}function styleValue(r,e){return r.style.getPropertyValue(e)||defaultView(r).getComputedStyle(r,null).getPropertyValue(e)}function propertyRemove(r){return function(){delete this[r]}}function propertyConstant(r,e){return function(){this[r]=e}}function propertyFunction(r,e){return function(){var t=e.apply(this,arguments);t==null?delete this[r]:this[r]=t}}function selection_property(r,e){return arguments.length>1?this.each((e==null?propertyRemove:typeof e=="function"?propertyFunction:propertyConstant)(r,e)):this.node()[r]}function classArray(r){return r.trim().split(/^|\s+/)}function classList(r){return r.classList||new ClassList(r)}function ClassList(r){this._node=r,this._names=classArray(r.getAttribute("class")||"")}ClassList.prototype={add:function(r){var e=this._names.indexOf(r);e<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var e=this._names.indexOf(r);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function classedAdd(r,e){for(var t=classList(r),o=-1,c=e.length;++o<c;)t.add(e[o])}function classedRemove(r,e){for(var t=classList(r),o=-1,c=e.length;++o<c;)t.remove(e[o])}function classedTrue(r){return function(){classedAdd(this,r)}}function classedFalse(r){return function(){classedRemove(this,r)}}function classedFunction(r,e){return function(){(e.apply(this,arguments)?classedAdd:classedRemove)(this,r)}}function selection_classed(r,e){var t=classArray(r+"");if(arguments.length<2){for(var o=classList(this.node()),c=-1,h=t.length;++c<h;)if(!o.contains(t[c]))return!1;return!0}return this.each((typeof e=="function"?classedFunction:e?classedTrue:classedFalse)(t,e))}function textRemove(){this.textContent=""}function textConstant$1(r){return function(){this.textContent=r}}function textFunction$1(r){return function(){var e=r.apply(this,arguments);this.textContent=e??""}}function selection_text(r){return arguments.length?this.each(r==null?textRemove:(typeof r=="function"?textFunction$1:textConstant$1)(r)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(r){return function(){this.innerHTML=r}}function htmlFunction(r){return function(){var e=r.apply(this,arguments);this.innerHTML=e??""}}function selection_html(r){return arguments.length?this.each(r==null?htmlRemove:(typeof r=="function"?htmlFunction:htmlConstant)(r)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(r){var e=typeof r=="function"?r:creator(r);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function constantNull(){return null}function selection_insert(r,e){var t=typeof r=="function"?r:creator(r),o=e==null?constantNull:typeof e=="function"?e:selector$h(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),o.apply(this,arguments)||null)})}function remove(){var r=this.parentNode;r&&r.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var r=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function selection_cloneDeep(){var r=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function selection_clone(r){return this.select(r?selection_cloneDeep:selection_cloneShallow)}function selection_datum(r){return arguments.length?this.property("__data__",r):this.node().__data__}function contextListener(r){return function(e){r.call(this,e,this.__data__)}}function parseTypenames(r){return r.trim().split(/^|\s+/).map(function(e){var t="",o=e.indexOf(".");return o>=0&&(t=e.slice(o+1),e=e.slice(0,o)),{type:e,name:t}})}function onRemove(r){return function(){var e=this.__on;if(e){for(var t=0,o=-1,c=e.length,h;t<c;++t)h=e[t],(!r.type||h.type===r.type)&&h.name===r.name?this.removeEventListener(h.type,h.listener,h.options):e[++o]=h;++o?e.length=o:delete this.__on}}}function onAdd(r,e,t){return function(){var o=this.__on,c,h=contextListener(e);if(o){for(var v=0,p=o.length;v<p;++v)if((c=o[v]).type===r.type&&c.name===r.name){this.removeEventListener(c.type,c.listener,c.options),this.addEventListener(c.type,c.listener=h,c.options=t),c.value=e;return}}this.addEventListener(r.type,h,t),c={type:r.type,name:r.name,value:e,listener:h,options:t},o?o.push(c):this.__on=[c]}}function selection_on(r,e,t){var o=parseTypenames(r+""),c,h=o.length,v;if(arguments.length<2){var p=this.node().__on;if(p){for(var g=0,x=p.length,f;g<x;++g)for(c=0,f=p[g];c<h;++c)if((v=o[c]).type===f.type&&v.name===f.name)return f.value}return}for(p=e?onAdd:onRemove,c=0;c<h;++c)this.each(p(o[c],e,t));return this}function dispatchEvent(r,e,t){var o=defaultView(r),c=o.CustomEvent;typeof c=="function"?c=new c(e,t):(c=o.document.createEvent("Event"),t?(c.initEvent(e,t.bubbles,t.cancelable),c.detail=t.detail):c.initEvent(e,!1,!1)),r.dispatchEvent(c)}function dispatchConstant(r,e){return function(){return dispatchEvent(this,r,e)}}function dispatchFunction(r,e){return function(){return dispatchEvent(this,r,e.apply(this,arguments))}}function selection_dispatch(r,e){return this.each((typeof e=="function"?dispatchFunction:dispatchConstant)(r,e))}function*selection_iterator(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var o=r[e],c=0,h=o.length,v;c<h;++c)(v=o[c])&&(yield v)}var root=[null];function Selection$1(r,e){this._groups=r,this._parents=e}function selection(){return new Selection$1([[document.documentElement]],root)}function selection_selection(){return this}Selection$1.prototype=selection.prototype={constructor:Selection$1,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};function select(r){return typeof r=="string"?new Selection$1([[document.querySelector(r)]],[document.documentElement]):new Selection$1([[r]],root)}function sourceEvent(r){let e;for(;e=r.sourceEvent;)r=e;return r}function pointer(r,e){if(r=sourceEvent(r),e===void 0&&(e=r.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var o=t.createSVGPoint();return o.x=r.clientX,o.y=r.clientY,o=o.matrixTransform(e.getScreenCTM().inverse()),[o.x,o.y]}if(e.getBoundingClientRect){var c=e.getBoundingClientRect();return[r.clientX-c.left-e.clientLeft,r.clientY-c.top-e.clientTop]}}return[r.pageX,r.pageY]}const nonpassive={passive:!1},nonpassivecapture={capture:!0,passive:!1};function nopropagation$1(r){r.stopImmediatePropagation()}function noevent$1(r){r.preventDefault(),r.stopImmediatePropagation()}function dragDisable(r){var e=r.document.documentElement,t=select(r).on("dragstart.drag",noevent$1,nonpassivecapture);"onselectstart"in e?t.on("selectstart.drag",noevent$1,nonpassivecapture):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function yesdrag(r,e){var t=r.document.documentElement,o=select(r).on("dragstart.drag",null);e&&(o.on("click.drag",noevent$1,nonpassivecapture),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in t?o.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const constant$2=r=>()=>r;function DragEvent(r,{sourceEvent:e,subject:t,target:o,identifier:c,active:h,x:v,y:p,dx:g,dy:x,dispatch:f}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:c,enumerable:!0,configurable:!0},active:{value:h,enumerable:!0,configurable:!0},x:{value:v,enumerable:!0,configurable:!0},y:{value:p,enumerable:!0,configurable:!0},dx:{value:g,enumerable:!0,configurable:!0},dy:{value:x,enumerable:!0,configurable:!0},_:{value:f}})}DragEvent.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function defaultFilter$1(r){return!r.ctrlKey&&!r.button}function defaultContainer(){return this.parentNode}function defaultSubject(r,e){return e??{x:r.x,y:r.y}}function defaultTouchable$1(){return navigator.maxTouchPoints||"ontouchstart"in this}function drag(){var r=defaultFilter$1,e=defaultContainer,t=defaultSubject,o=defaultTouchable$1,c={},h=dispatch("start","drag","end"),v=0,p,g,x,f,b=0;function C(T){T.on("mousedown.drag",S).filter(o).on("touchstart.drag",s).on("touchmove.drag",y,nonpassive).on("touchend.drag touchcancel.drag",A).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function S(T,u){if(!(f||!r.call(this,T,u))){var _=E(this,e.call(this,T,u),T,u,"mouse");_&&(select(T.view).on("mousemove.drag",k,nonpassivecapture).on("mouseup.drag",l,nonpassivecapture),dragDisable(T.view),nopropagation$1(T),x=!1,p=T.clientX,g=T.clientY,_("start",T))}}function k(T){if(noevent$1(T),!x){var u=T.clientX-p,_=T.clientY-g;x=u*u+_*_>b}c.mouse("drag",T)}function l(T){select(T.view).on("mousemove.drag mouseup.drag",null),yesdrag(T.view,x),noevent$1(T),c.mouse("end",T)}function s(T,u){if(r.call(this,T,u)){var _=T.changedTouches,M=e.call(this,T,u),R=_.length,N,I;for(N=0;N<R;++N)(I=E(this,M,T,u,_[N].identifier,_[N]))&&(nopropagation$1(T),I("start",T,_[N]))}}function y(T){var u=T.changedTouches,_=u.length,M,R;for(M=0;M<_;++M)(R=c[u[M].identifier])&&(noevent$1(T),R("drag",T,u[M]))}function A(T){var u=T.changedTouches,_=u.length,M,R;for(f&&clearTimeout(f),f=setTimeout(function(){f=null},500),M=0;M<_;++M)(R=c[u[M].identifier])&&(nopropagation$1(T),R("end",T,u[M]))}function E(T,u,_,M,R,N){var I=h.copy(),L=pointer(N||_,u),Y,B,D;if((D=t.call(T,new DragEvent("beforestart",{sourceEvent:_,target:C,identifier:R,active:v,x:L[0],y:L[1],dx:0,dy:0,dispatch:I}),M))!=null)return Y=D.x-L[0]||0,B=D.y-L[1]||0,function H(W,q,V){var $=L,O;switch(W){case"start":c[R]=H,O=v++;break;case"end":delete c[R],--v;case"drag":L=pointer(V||q,u),O=v;break}I.call(W,T,new DragEvent(W,{sourceEvent:q,subject:D,target:C,identifier:R,active:O,x:L[0]+Y,y:L[1]+B,dx:L[0]-$[0],dy:L[1]-$[1],dispatch:I}),M)}}return C.filter=function(T){return arguments.length?(r=typeof T=="function"?T:constant$2(!!T),C):r},C.container=function(T){return arguments.length?(e=typeof T=="function"?T:constant$2(T),C):e},C.subject=function(T){return arguments.length?(t=typeof T=="function"?T:constant$2(T),C):t},C.touchable=function(T){return arguments.length?(o=typeof T=="function"?T:constant$2(!!T),C):o},C.on=function(){var T=h.on.apply(h,arguments);return T===h?C:T},C.clickDistance=function(T){return arguments.length?(b=(T=+T)*T,C):Math.sqrt(b)},C}function define(r,e,t){r.prototype=e.prototype=t,t.constructor=r}function extend(r,e){var t=Object.create(r.prototype);for(var o in e)t[o]=e[o];return t}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(r){var e,t;return r=(r+"").trim().toLowerCase(),(e=reHex.exec(r))?(t=e[1].length,e=parseInt(e[1],16),t===6?rgbn(e):t===3?new Rgb(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?rgba(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?rgba(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=reRgbInteger.exec(r))?new Rgb(e[1],e[2],e[3],1):(e=reRgbPercent.exec(r))?new Rgb(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=reRgbaInteger.exec(r))?rgba(e[1],e[2],e[3],e[4]):(e=reRgbaPercent.exec(r))?rgba(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=reHslPercent.exec(r))?hsla(e[1],e[2]/100,e[3]/100,1):(e=reHslaPercent.exec(r))?hsla(e[1],e[2]/100,e[3]/100,e[4]):named.hasOwnProperty(r)?rgbn(named[r]):r==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(r){return new Rgb(r>>16&255,r>>8&255,r&255,1)}function rgba(r,e,t,o){return o<=0&&(r=e=t=NaN),new Rgb(r,e,t,o)}function rgbConvert(r){return r instanceof Color||(r=color(r)),r?(r=r.rgb(),new Rgb(r.r,r.g,r.b,r.opacity)):new Rgb}function rgb(r,e,t,o){return arguments.length===1?rgbConvert(r):new Rgb(r,e,t,o??1)}function Rgb(r,e,t,o){this.r=+r,this.g=+e,this.b=+t,this.opacity=+o}define(Rgb,rgb,extend(Color,{brighter(r){return r=r==null?brighter:Math.pow(brighter,r),new Rgb(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?darker:Math.pow(darker,r),new Rgb(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const r=clampa(this.opacity);return`${r===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${r===1?")":`, ${r})`}`}function clampa(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function clampi(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function hex(r){return r=clampi(r),(r<16?"0":"")+r.toString(16)}function hsla(r,e,t,o){return o<=0?r=e=t=NaN:t<=0||t>=1?r=e=NaN:e<=0&&(r=NaN),new Hsl(r,e,t,o)}function hslConvert(r){if(r instanceof Hsl)return new Hsl(r.h,r.s,r.l,r.opacity);if(r instanceof Color||(r=color(r)),!r)return new Hsl;if(r instanceof Hsl)return r;r=r.rgb();var e=r.r/255,t=r.g/255,o=r.b/255,c=Math.min(e,t,o),h=Math.max(e,t,o),v=NaN,p=h-c,g=(h+c)/2;return p?(e===h?v=(t-o)/p+(t<o)*6:t===h?v=(o-e)/p+2:v=(e-t)/p+4,p/=g<.5?h+c:2-h-c,v*=60):p=g>0&&g<1?0:v,new Hsl(v,p,g,r.opacity)}function hsl(r,e,t,o){return arguments.length===1?hslConvert(r):new Hsl(r,e,t,o??1)}function Hsl(r,e,t,o){this.h=+r,this.s=+e,this.l=+t,this.opacity=+o}define(Hsl,hsl,extend(Color,{brighter(r){return r=r==null?brighter:Math.pow(brighter,r),new Hsl(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?darker:Math.pow(darker,r),new Hsl(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,t=this.l,o=t+(t<.5?t:1-t)*e,c=2*t-o;return new Rgb(hsl2rgb(r>=240?r-240:r+120,c,o),hsl2rgb(r,c,o),hsl2rgb(r<120?r+240:r-120,c,o),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=clampa(this.opacity);return`${r===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${r===1?")":`, ${r})`}`}}));function clamph(r){return r=(r||0)%360,r<0?r+360:r}function clampt(r){return Math.max(0,Math.min(1,r||0))}function hsl2rgb(r,e,t){return(r<60?e+(t-e)*r/60:r<180?t:r<240?e+(t-e)*(240-r)/60:e)*255}const constant$1=r=>()=>r;function linear(r,e){return function(t){return r+t*e}}function exponential(r,e,t){return r=Math.pow(r,t),e=Math.pow(e,t)-r,t=1/t,function(o){return Math.pow(r+o*e,t)}}function gamma(r){return(r=+r)==1?nogamma:function(e,t){return t-e?exponential(e,t,r):constant$1(isNaN(e)?t:e)}}function nogamma(r,e){var t=e-r;return t?linear(r,t):constant$1(isNaN(r)?e:r)}const interpolateRgb=(function r(e){var t=gamma(e);function o(c,h){var v=t((c=rgb(c)).r,(h=rgb(h)).r),p=t(c.g,h.g),g=t(c.b,h.b),x=nogamma(c.opacity,h.opacity);return function(f){return c.r=v(f),c.g=p(f),c.b=g(f),c.opacity=x(f),c+""}}return o.gamma=r,o})(1);function interpolateNumber(r,e){return r=+r,e=+e,function(t){return r*(1-t)+e*t}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(r){return function(){return r}}function one(r){return function(e){return r(e)+""}}function interpolateString(r,e){var t=reA.lastIndex=reB.lastIndex=0,o,c,h,v=-1,p=[],g=[];for(r=r+"",e=e+"";(o=reA.exec(r))&&(c=reB.exec(e));)(h=c.index)>t&&(h=e.slice(t,h),p[v]?p[v]+=h:p[++v]=h),(o=o[0])===(c=c[0])?p[v]?p[v]+=c:p[++v]=c:(p[++v]=null,g.push({i:v,x:interpolateNumber(o,c)})),t=reB.lastIndex;return t<e.length&&(h=e.slice(t),p[v]?p[v]+=h:p[++v]=h),p.length<2?g[0]?one(g[0].x):zero(e):(e=g.length,function(x){for(var f=0,b;f<e;++f)p[(b=g[f]).i]=b.x(x);return p.join("")})}var degrees=180/Math.PI,identity$1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(r,e,t,o,c,h){var v,p,g;return(v=Math.sqrt(r*r+e*e))&&(r/=v,e/=v),(g=r*t+e*o)&&(t-=r*g,o-=e*g),(p=Math.sqrt(t*t+o*o))&&(t/=p,o/=p,g/=p),r*o<e*t&&(r=-r,e=-e,g=-g,v=-v),{translateX:c,translateY:h,rotate:Math.atan2(e,r)*degrees,skewX:Math.atan(g)*degrees,scaleX:v,scaleY:p}}var svgNode;function parseCss(r){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return e.isIdentity?identity$1:decompose(e.a,e.b,e.c,e.d,e.e,e.f)}function parseSvg(r){return r==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",r),!(r=svgNode.transform.baseVal.consolidate()))?identity$1:(r=r.matrix,decompose(r.a,r.b,r.c,r.d,r.e,r.f))}function interpolateTransform(r,e,t,o){function c(x){return x.length?x.pop()+" ":""}function h(x,f,b,C,S,k){if(x!==b||f!==C){var l=S.push("translate(",null,e,null,t);k.push({i:l-4,x:interpolateNumber(x,b)},{i:l-2,x:interpolateNumber(f,C)})}else(b||C)&&S.push("translate("+b+e+C+t)}function v(x,f,b,C){x!==f?(x-f>180?f+=360:f-x>180&&(x+=360),C.push({i:b.push(c(b)+"rotate(",null,o)-2,x:interpolateNumber(x,f)})):f&&b.push(c(b)+"rotate("+f+o)}function p(x,f,b,C){x!==f?C.push({i:b.push(c(b)+"skewX(",null,o)-2,x:interpolateNumber(x,f)}):f&&b.push(c(b)+"skewX("+f+o)}function g(x,f,b,C,S,k){if(x!==b||f!==C){var l=S.push(c(S)+"scale(",null,",",null,")");k.push({i:l-4,x:interpolateNumber(x,b)},{i:l-2,x:interpolateNumber(f,C)})}else(b!==1||C!==1)&&S.push(c(S)+"scale("+b+","+C+")")}return function(x,f){var b=[],C=[];return x=r(x),f=r(f),h(x.translateX,x.translateY,f.translateX,f.translateY,b,C),v(x.rotate,f.rotate,b,C),p(x.skewX,f.skewX,b,C),g(x.scaleX,x.scaleY,f.scaleX,f.scaleY,b,C),x=f=null,function(S){for(var k=-1,l=C.length,s;++k<l;)b[(s=C[k]).i]=s.x(S);return b.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),epsilon2=1e-12;function cosh(r){return((r=Math.exp(r))+1/r)/2}function sinh(r){return((r=Math.exp(r))-1/r)/2}function tanh(r){return((r=Math.exp(2*r))-1)/(r+1)}const interpolateZoom=(function r(e,t,o){function c(h,v){var p=h[0],g=h[1],x=h[2],f=v[0],b=v[1],C=v[2],S=f-p,k=b-g,l=S*S+k*k,s,y;if(l<epsilon2)y=Math.log(C/x)/e,s=function(M){return[p+M*S,g+M*k,x*Math.exp(e*M*y)]};else{var A=Math.sqrt(l),E=(C*C-x*x+o*l)/(2*x*t*A),T=(C*C-x*x-o*l)/(2*C*t*A),u=Math.log(Math.sqrt(E*E+1)-E),_=Math.log(Math.sqrt(T*T+1)-T);y=(_-u)/e,s=function(M){var R=M*y,N=cosh(u),I=x/(t*A)*(N*tanh(e*R+u)-sinh(u));return[p+I*S,g+I*k,x*N/cosh(e*R+u)]}}return s.duration=y*1e3*e/Math.SQRT2,s}return c.rho=function(h){var v=Math.max(.001,+h),p=v*v,g=p*p;return r(v,p,g)},c})(Math.SQRT2,2,4);var frame=0,timeout$1=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(r,e,t){if(typeof r!="function")throw new TypeError("callback is not a function");t=(t==null?now():+t)+(e==null?0:+e),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=r,this._time=t,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(r,e,t){var o=new Timer;return o.restart(r,e,t),o}function timerFlush(){now(),++frame;for(var r=taskHead,e;r;)(e=clockNow-r._time)>=0&&r._call.call(void 0,e),r=r._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var r=clock.now(),e=r-clockLast;e>pokeDelay&&(clockSkew-=e,clockLast=r)}function nap(){for(var r,e=taskHead,t,o=1/0;e;)e._call?(o>e._time&&(o=e._time),r=e,e=e._next):(t=e._next,e._next=null,e=r?r._next=t:taskHead=t);taskTail=r,sleep(o)}function sleep(r){if(!frame){timeout$1&&(timeout$1=clearTimeout(timeout$1));var e=r-clockNow;e>24?(r<1/0&&(timeout$1=setTimeout(wake,r-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout(r,e,t){var o=new Timer;return e=e==null?0:+e,o.restart(c=>{o.stop(),r(c+e)},e,t),o}var emptyOn=dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(r,e,t,o,c,h){var v=r.__transition;if(!v)r.__transition={};else if(t in v)return;create(r,t,{name:e,index:o,group:c,on:emptyOn,tween:emptyTween,time:h.time,delay:h.delay,duration:h.duration,ease:h.ease,timer:null,state:CREATED})}function init(r,e){var t=get(r,e);if(t.state>CREATED)throw new Error("too late; already scheduled");return t}function set(r,e){var t=get(r,e);if(t.state>STARTED)throw new Error("too late; already running");return t}function get(r,e){var t=r.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function create(r,e,t){var o=r.__transition,c;o[e]=t,t.timer=timer(h,0,t.time);function h(x){t.state=SCHEDULED,t.timer.restart(v,t.delay,t.time),t.delay<=x&&v(x-t.delay)}function v(x){var f,b,C,S;if(t.state!==SCHEDULED)return g();for(f in o)if(S=o[f],S.name===t.name){if(S.state===STARTED)return timeout(v);S.state===RUNNING?(S.state=ENDED,S.timer.stop(),S.on.call("interrupt",r,r.__data__,S.index,S.group),delete o[f]):+f<e&&(S.state=ENDED,S.timer.stop(),S.on.call("cancel",r,r.__data__,S.index,S.group),delete o[f])}if(timeout(function(){t.state===STARTED&&(t.state=RUNNING,t.timer.restart(p,t.delay,t.time),p(x))}),t.state=STARTING,t.on.call("start",r,r.__data__,t.index,t.group),t.state===STARTING){for(t.state=STARTED,c=new Array(C=t.tween.length),f=0,b=-1;f<C;++f)(S=t.tween[f].value.call(r,r.__data__,t.index,t.group))&&(c[++b]=S);c.length=b+1}}function p(x){for(var f=x<t.duration?t.ease.call(null,x/t.duration):(t.timer.restart(g),t.state=ENDING,1),b=-1,C=c.length;++b<C;)c[b].call(r,f);t.state===ENDING&&(t.on.call("end",r,r.__data__,t.index,t.group),g())}function g(){t.state=ENDED,t.timer.stop(),delete o[e];for(var x in o)return;delete r.__transition}}function interrupt(r,e){var t=r.__transition,o,c,h=!0,v;if(t){e=e==null?null:e+"";for(v in t){if((o=t[v]).name!==e){h=!1;continue}c=o.state>STARTING&&o.state<ENDING,o.state=ENDED,o.timer.stop(),o.on.call(c?"interrupt":"cancel",r,r.__data__,o.index,o.group),delete t[v]}h&&delete r.__transition}}function selection_interrupt(r){return this.each(function(){interrupt(this,r)})}function tweenRemove(r,e){var t,o;return function(){var c=set(this,r),h=c.tween;if(h!==t){o=t=h;for(var v=0,p=o.length;v<p;++v)if(o[v].name===e){o=o.slice(),o.splice(v,1);break}}c.tween=o}}function tweenFunction(r,e,t){var o,c;if(typeof t!="function")throw new Error;return function(){var h=set(this,r),v=h.tween;if(v!==o){c=(o=v).slice();for(var p={name:e,value:t},g=0,x=c.length;g<x;++g)if(c[g].name===e){c[g]=p;break}g===x&&c.push(p)}h.tween=c}}function transition_tween(r,e){var t=this._id;if(r+="",arguments.length<2){for(var o=get(this.node(),t).tween,c=0,h=o.length,v;c<h;++c)if((v=o[c]).name===r)return v.value;return null}return this.each((e==null?tweenRemove:tweenFunction)(t,r,e))}function tweenValue(r,e,t){var o=r._id;return r.each(function(){var c=set(this,o);(c.value||(c.value={}))[e]=t.apply(this,arguments)}),function(c){return get(c,o).value[e]}}function interpolate(r,e){var t;return(typeof e=="number"?interpolateNumber:e instanceof color?interpolateRgb:(t=color(e))?(e=t,interpolateRgb):interpolateString)(r,e)}function attrRemove(r){return function(){this.removeAttribute(r)}}function attrRemoveNS(r){return function(){this.removeAttributeNS(r.space,r.local)}}function attrConstant(r,e,t){var o,c=t+"",h;return function(){var v=this.getAttribute(r);return v===c?null:v===o?h:h=e(o=v,t)}}function attrConstantNS(r,e,t){var o,c=t+"",h;return function(){var v=this.getAttributeNS(r.space,r.local);return v===c?null:v===o?h:h=e(o=v,t)}}function attrFunction(r,e,t){var o,c,h;return function(){var v,p=t(this),g;return p==null?void this.removeAttribute(r):(v=this.getAttribute(r),g=p+"",v===g?null:v===o&&g===c?h:(c=g,h=e(o=v,p)))}}function attrFunctionNS(r,e,t){var o,c,h;return function(){var v,p=t(this),g;return p==null?void this.removeAttributeNS(r.space,r.local):(v=this.getAttributeNS(r.space,r.local),g=p+"",v===g?null:v===o&&g===c?h:(c=g,h=e(o=v,p)))}}function transition_attr(r,e){var t=namespace(r),o=t==="transform"?interpolateTransformSvg:interpolate;return this.attrTween(r,typeof e=="function"?(t.local?attrFunctionNS:attrFunction)(t,o,tweenValue(this,"attr."+r,e)):e==null?(t.local?attrRemoveNS:attrRemove)(t):(t.local?attrConstantNS:attrConstant)(t,o,e))}function attrInterpolate(r,e){return function(t){this.setAttribute(r,e.call(this,t))}}function attrInterpolateNS(r,e){return function(t){this.setAttributeNS(r.space,r.local,e.call(this,t))}}function attrTweenNS(r,e){var t,o;function c(){var h=e.apply(this,arguments);return h!==o&&(t=(o=h)&&attrInterpolateNS(r,h)),t}return c._value=e,c}function attrTween(r,e){var t,o;function c(){var h=e.apply(this,arguments);return h!==o&&(t=(o=h)&&attrInterpolate(r,h)),t}return c._value=e,c}function transition_attrTween(r,e){var t="attr."+r;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;var o=namespace(r);return this.tween(t,(o.local?attrTweenNS:attrTween)(o,e))}function delayFunction(r,e){return function(){init(this,r).delay=+e.apply(this,arguments)}}function delayConstant(r,e){return e=+e,function(){init(this,r).delay=e}}function transition_delay(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?delayFunction:delayConstant)(e,r)):get(this.node(),e).delay}function durationFunction(r,e){return function(){set(this,r).duration=+e.apply(this,arguments)}}function durationConstant(r,e){return e=+e,function(){set(this,r).duration=e}}function transition_duration(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?durationFunction:durationConstant)(e,r)):get(this.node(),e).duration}function easeConstant(r,e){if(typeof e!="function")throw new Error;return function(){set(this,r).ease=e}}function transition_ease(r){var e=this._id;return arguments.length?this.each(easeConstant(e,r)):get(this.node(),e).ease}function easeVarying(r,e){return function(){var t=e.apply(this,arguments);if(typeof t!="function")throw new Error;set(this,r).ease=t}}function transition_easeVarying(r){if(typeof r!="function")throw new Error;return this.each(easeVarying(this._id,r))}function transition_filter(r){typeof r!="function"&&(r=matcher(r));for(var e=this._groups,t=e.length,o=new Array(t),c=0;c<t;++c)for(var h=e[c],v=h.length,p=o[c]=[],g,x=0;x<v;++x)(g=h[x])&&r.call(g,g.__data__,x,h)&&p.push(g);return new Transition(o,this._parents,this._name,this._id)}function transition_merge(r){if(r._id!==this._id)throw new Error;for(var e=this._groups,t=r._groups,o=e.length,c=t.length,h=Math.min(o,c),v=new Array(o),p=0;p<h;++p)for(var g=e[p],x=t[p],f=g.length,b=v[p]=new Array(f),C,S=0;S<f;++S)(C=g[S]||x[S])&&(b[S]=C);for(;p<o;++p)v[p]=e[p];return new Transition(v,this._parents,this._name,this._id)}function start(r){return(r+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||e==="start"})}function onFunction(r,e,t){var o,c,h=start(e)?init:set;return function(){var v=h(this,r),p=v.on;p!==o&&(c=(o=p).copy()).on(e,t),v.on=c}}function transition_on(r,e){var t=this._id;return arguments.length<2?get(this.node(),t).on.on(r):this.each(onFunction(t,r,e))}function removeFunction(r){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==r)return;e&&e.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(r){var e=this._name,t=this._id;typeof r!="function"&&(r=selector$h(r));for(var o=this._groups,c=o.length,h=new Array(c),v=0;v<c;++v)for(var p=o[v],g=p.length,x=h[v]=new Array(g),f,b,C=0;C<g;++C)(f=p[C])&&(b=r.call(f,f.__data__,C,p))&&("__data__"in f&&(b.__data__=f.__data__),x[C]=b,schedule(x[C],e,t,C,x,get(f,t)));return new Transition(h,this._parents,e,t)}function transition_selectAll(r){var e=this._name,t=this._id;typeof r!="function"&&(r=selectorAll(r));for(var o=this._groups,c=o.length,h=[],v=[],p=0;p<c;++p)for(var g=o[p],x=g.length,f,b=0;b<x;++b)if(f=g[b]){for(var C=r.call(f,f.__data__,b,g),S,k=get(f,t),l=0,s=C.length;l<s;++l)(S=C[l])&&schedule(S,e,t,l,C,k);h.push(C),v.push(f)}return new Transition(h,v,e,t)}var Selection=selection.prototype.constructor;function transition_selection(){return new Selection(this._groups,this._parents)}function styleNull(r,e){var t,o,c;return function(){var h=styleValue(this,r),v=(this.style.removeProperty(r),styleValue(this,r));return h===v?null:h===t&&v===o?c:c=e(t=h,o=v)}}function styleRemove(r){return function(){this.style.removeProperty(r)}}function styleConstant(r,e,t){var o,c=t+"",h;return function(){var v=styleValue(this,r);return v===c?null:v===o?h:h=e(o=v,t)}}function styleFunction(r,e,t){var o,c,h;return function(){var v=styleValue(this,r),p=t(this),g=p+"";return p==null&&(g=p=(this.style.removeProperty(r),styleValue(this,r))),v===g?null:v===o&&g===c?h:(c=g,h=e(o=v,p))}}function styleMaybeRemove(r,e){var t,o,c,h="style."+e,v="end."+h,p;return function(){var g=set(this,r),x=g.on,f=g.value[h]==null?p||(p=styleRemove(e)):void 0;(x!==t||c!==f)&&(o=(t=x).copy()).on(v,c=f),g.on=o}}function transition_style(r,e,t){var o=(r+="")=="transform"?interpolateTransformCss:interpolate;return e==null?this.styleTween(r,styleNull(r,o)).on("end.style."+r,styleRemove(r)):typeof e=="function"?this.styleTween(r,styleFunction(r,o,tweenValue(this,"style."+r,e))).each(styleMaybeRemove(this._id,r)):this.styleTween(r,styleConstant(r,o,e),t).on("end.style."+r,null)}function styleInterpolate(r,e,t){return function(o){this.style.setProperty(r,e.call(this,o),t)}}function styleTween(r,e,t){var o,c;function h(){var v=e.apply(this,arguments);return v!==c&&(o=(c=v)&&styleInterpolate(r,v,t)),o}return h._value=e,h}function transition_styleTween(r,e,t){var o="style."+(r+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(e==null)return this.tween(o,null);if(typeof e!="function")throw new Error;return this.tween(o,styleTween(r,e,t??""))}function textConstant(r){return function(){this.textContent=r}}function textFunction(r){return function(){var e=r(this);this.textContent=e??""}}function transition_text(r){return this.tween("text",typeof r=="function"?textFunction(tweenValue(this,"text",r)):textConstant(r==null?"":r+""))}function textInterpolate(r){return function(e){this.textContent=r.call(this,e)}}function textTween(r){var e,t;function o(){var c=r.apply(this,arguments);return c!==t&&(e=(t=c)&&textInterpolate(c)),e}return o._value=r,o}function transition_textTween(r){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(r==null)return this.tween(e,null);if(typeof r!="function")throw new Error;return this.tween(e,textTween(r))}function transition_transition(){for(var r=this._name,e=this._id,t=newId(),o=this._groups,c=o.length,h=0;h<c;++h)for(var v=o[h],p=v.length,g,x=0;x<p;++x)if(g=v[x]){var f=get(g,e);schedule(g,r,t,x,v,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Transition(o,this._parents,r,t)}function transition_end(){var r,e,t=this,o=t._id,c=t.size();return new Promise(function(h,v){var p={value:v},g={value:function(){--c===0&&h()}};t.each(function(){var x=set(this,o),f=x.on;f!==r&&(e=(r=f).copy(),e._.cancel.push(p),e._.interrupt.push(p),e._.end.push(g)),x.on=e}),c===0&&h()})}var id=0;function Transition(r,e,t,o){this._groups=r,this._parents=e,this._name=t,this._id=o}function newId(){return++id}var selection_prototype=selection.prototype;Transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,easeVarying:transition_easeVarying,end:transition_end,[Symbol.iterator]:selection_prototype[Symbol.iterator]};function cubicInOut(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(r,e){for(var t;!(t=r.__transition)||!(t=t[e]);)if(!(r=r.parentNode))throw new Error(`transition ${e} not found`);return t}function selection_transition(r){var e,t;r instanceof Transition?(e=r._id,r=r._name):(e=newId(),(t=defaultTiming).time=now(),r=r==null?null:r+"");for(var o=this._groups,c=o.length,h=0;h<c;++h)for(var v=o[h],p=v.length,g,x=0;x<p;++x)(g=v[x])&&schedule(g,r,e,x,v,t||inherit(g,e));return new Transition(o,this._parents,r,e)}selection.prototype.interrupt=selection_interrupt;selection.prototype.transition=selection_transition;const constant=r=>()=>r;function ZoomEvent(r,{sourceEvent:e,target:t,transform:o,dispatch:c}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:c}})}function Transform(r,e,t){this.k=r,this.x=e,this.y=t}Transform.prototype={constructor:Transform,scale:function(r){return r===1?this:new Transform(this.k*r,this.x,this.y)},translate:function(r,e){return r===0&e===0?this:new Transform(this.k,this.x+this.k*r,this.y+this.k*e)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity=new Transform(1,0,0);Transform.prototype;function nopropagation(r){r.stopImmediatePropagation()}function noevent(r){r.preventDefault(),r.stopImmediatePropagation()}function defaultFilter(r){return(!r.ctrlKey||r.type==="wheel")&&!r.button}function defaultExtent(){var r=this;return r instanceof SVGElement?(r=r.ownerSVGElement||r,r.hasAttribute("viewBox")?(r=r.viewBox.baseVal,[[r.x,r.y],[r.x+r.width,r.y+r.height]]):[[0,0],[r.width.baseVal.value,r.height.baseVal.value]]):[[0,0],[r.clientWidth,r.clientHeight]]}function defaultTransform(){return this.__zoom||identity}function defaultWheelDelta(r){return-r.deltaY*(r.deltaMode===1?.05:r.deltaMode?1:.002)*(r.ctrlKey?10:1)}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function defaultConstrain(r,e,t){var o=r.invertX(e[0][0])-t[0][0],c=r.invertX(e[1][0])-t[1][0],h=r.invertY(e[0][1])-t[0][1],v=r.invertY(e[1][1])-t[1][1];return r.translate(c>o?(o+c)/2:Math.min(0,o)||Math.max(0,c),v>h?(h+v)/2:Math.min(0,h)||Math.max(0,v))}function zoom(){var r=defaultFilter,e=defaultExtent,t=defaultConstrain,o=defaultWheelDelta,c=defaultTouchable,h=[0,1/0],v=[[-1/0,-1/0],[1/0,1/0]],p=250,g=interpolateZoom,x=dispatch("start","zoom","end"),f,b,C,S=500,k=150,l=0,s=10;function y(D){D.property("__zoom",defaultTransform).on("wheel.zoom",R,{passive:!1}).on("mousedown.zoom",N).on("dblclick.zoom",I).filter(c).on("touchstart.zoom",L).on("touchmove.zoom",Y).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(D,H,W,q){var V=D.selection?D.selection():D;V.property("__zoom",defaultTransform),D!==V?u(D,H,W,q):V.interrupt().each(function(){_(this,arguments).event(q).start().zoom(null,typeof H=="function"?H.apply(this,arguments):H).end()})},y.scaleBy=function(D,H,W,q){y.scaleTo(D,function(){var V=this.__zoom.k,$=typeof H=="function"?H.apply(this,arguments):H;return V*$},W,q)},y.scaleTo=function(D,H,W,q){y.transform(D,function(){var V=e.apply(this,arguments),$=this.__zoom,O=W==null?T(V):typeof W=="function"?W.apply(this,arguments):W,j=$.invert(O),J=typeof H=="function"?H.apply(this,arguments):H;return t(E(A($,J),O,j),V,v)},W,q)},y.translateBy=function(D,H,W,q){y.transform(D,function(){return t(this.__zoom.translate(typeof H=="function"?H.apply(this,arguments):H,typeof W=="function"?W.apply(this,arguments):W),e.apply(this,arguments),v)},null,q)},y.translateTo=function(D,H,W,q,V){y.transform(D,function(){var $=e.apply(this,arguments),O=this.__zoom,j=q==null?T($):typeof q=="function"?q.apply(this,arguments):q;return t(identity.translate(j[0],j[1]).scale(O.k).translate(typeof H=="function"?-H.apply(this,arguments):-H,typeof W=="function"?-W.apply(this,arguments):-W),$,v)},q,V)};function A(D,H){return H=Math.max(h[0],Math.min(h[1],H)),H===D.k?D:new Transform(H,D.x,D.y)}function E(D,H,W){var q=H[0]-W[0]*D.k,V=H[1]-W[1]*D.k;return q===D.x&&V===D.y?D:new Transform(D.k,q,V)}function T(D){return[(+D[0][0]+ +D[1][0])/2,(+D[0][1]+ +D[1][1])/2]}function u(D,H,W,q){D.on("start.zoom",function(){_(this,arguments).event(q).start()}).on("interrupt.zoom end.zoom",function(){_(this,arguments).event(q).end()}).tween("zoom",function(){var V=this,$=arguments,O=_(V,$).event(q),j=e.apply(V,$),J=W==null?T(j):typeof W=="function"?W.apply(V,$):W,oe=Math.max(j[1][0]-j[0][0],j[1][1]-j[0][1]),ie=V.__zoom,he=typeof H=="function"?H.apply(V,$):H,de=g(ie.invert(J).concat(oe/ie.k),he.invert(J).concat(oe/he.k));return function(fe){if(fe===1)fe=he;else{var ue=de(fe),ye=oe/ue[2];fe=new Transform(ye,J[0]-ue[0]*ye,J[1]-ue[1]*ye)}O.zoom(null,fe)}})}function _(D,H,W){return!W&&D.__zooming||new M(D,H)}function M(D,H){this.that=D,this.args=H,this.active=0,this.sourceEvent=null,this.extent=e.apply(D,H),this.taps=0}M.prototype={event:function(D){return D&&(this.sourceEvent=D),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(D,H){return this.mouse&&D!=="mouse"&&(this.mouse[1]=H.invert(this.mouse[0])),this.touch0&&D!=="touch"&&(this.touch0[1]=H.invert(this.touch0[0])),this.touch1&&D!=="touch"&&(this.touch1[1]=H.invert(this.touch1[0])),this.that.__zoom=H,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(D){var H=select(this.that).datum();x.call(D,this.that,new ZoomEvent(D,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:x}),H)}};function R(D,...H){if(!r.apply(this,arguments))return;var W=_(this,H).event(D),q=this.__zoom,V=Math.max(h[0],Math.min(h[1],q.k*Math.pow(2,o.apply(this,arguments)))),$=pointer(D);if(W.wheel)(W.mouse[0][0]!==$[0]||W.mouse[0][1]!==$[1])&&(W.mouse[1]=q.invert(W.mouse[0]=$)),clearTimeout(W.wheel);else{if(q.k===V)return;W.mouse=[$,q.invert($)],interrupt(this),W.start()}noevent(D),W.wheel=setTimeout(O,k),W.zoom("mouse",t(E(A(q,V),W.mouse[0],W.mouse[1]),W.extent,v));function O(){W.wheel=null,W.end()}}function N(D,...H){if(C||!r.apply(this,arguments))return;var W=D.currentTarget,q=_(this,H,!0).event(D),V=select(D.view).on("mousemove.zoom",J,!0).on("mouseup.zoom",oe,!0),$=pointer(D,W),O=D.clientX,j=D.clientY;dragDisable(D.view),nopropagation(D),q.mouse=[$,this.__zoom.invert($)],interrupt(this),q.start();function J(ie){if(noevent(ie),!q.moved){var he=ie.clientX-O,de=ie.clientY-j;q.moved=he*he+de*de>l}q.event(ie).zoom("mouse",t(E(q.that.__zoom,q.mouse[0]=pointer(ie,W),q.mouse[1]),q.extent,v))}function oe(ie){V.on("mousemove.zoom mouseup.zoom",null),yesdrag(ie.view,q.moved),noevent(ie),q.event(ie).end()}}function I(D,...H){if(r.apply(this,arguments)){var W=this.__zoom,q=pointer(D.changedTouches?D.changedTouches[0]:D,this),V=W.invert(q),$=W.k*(D.shiftKey?.5:2),O=t(E(A(W,$),q,V),e.apply(this,H),v);noevent(D),p>0?select(this).transition().duration(p).call(u,O,q,D):select(this).call(y.transform,O,q,D)}}function L(D,...H){if(r.apply(this,arguments)){var W=D.touches,q=W.length,V=_(this,H,D.changedTouches.length===q).event(D),$,O,j,J;for(nopropagation(D),O=0;O<q;++O)j=W[O],J=pointer(j,this),J=[J,this.__zoom.invert(J),j.identifier],V.touch0?!V.touch1&&V.touch0[2]!==J[2]&&(V.touch1=J,V.taps=0):(V.touch0=J,$=!0,V.taps=1+!!f);f&&(f=clearTimeout(f)),$&&(V.taps<2&&(b=J[0],f=setTimeout(function(){f=null},S)),interrupt(this),V.start())}}function Y(D,...H){if(this.__zooming){var W=_(this,H).event(D),q=D.changedTouches,V=q.length,$,O,j,J;for(noevent(D),$=0;$<V;++$)O=q[$],j=pointer(O,this),W.touch0&&W.touch0[2]===O.identifier?W.touch0[0]=j:W.touch1&&W.touch1[2]===O.identifier&&(W.touch1[0]=j);if(O=W.that.__zoom,W.touch1){var oe=W.touch0[0],ie=W.touch0[1],he=W.touch1[0],de=W.touch1[1],fe=(fe=he[0]-oe[0])*fe+(fe=he[1]-oe[1])*fe,ue=(ue=de[0]-ie[0])*ue+(ue=de[1]-ie[1])*ue;O=A(O,Math.sqrt(fe/ue)),j=[(oe[0]+he[0])/2,(oe[1]+he[1])/2],J=[(ie[0]+de[0])/2,(ie[1]+de[1])/2]}else if(W.touch0)j=W.touch0[0],J=W.touch0[1];else return;W.zoom("touch",t(E(O,j,J),W.extent,v))}}function B(D,...H){if(this.__zooming){var W=_(this,H).event(D),q=D.changedTouches,V=q.length,$,O;for(nopropagation(D),C&&clearTimeout(C),C=setTimeout(function(){C=null},S),$=0;$<V;++$)O=q[$],W.touch0&&W.touch0[2]===O.identifier?delete W.touch0:W.touch1&&W.touch1[2]===O.identifier&&delete W.touch1;if(W.touch1&&!W.touch0&&(W.touch0=W.touch1,delete W.touch1),W.touch0)W.touch0[1]=this.__zoom.invert(W.touch0[0]);else if(W.end(),W.taps===2&&(O=pointer(O,this),Math.hypot(b[0]-O[0],b[1]-O[1])<s)){var j=select(this).on("dblclick.zoom");j&&j.apply(this,arguments)}}}return y.wheelDelta=function(D){return arguments.length?(o=typeof D=="function"?D:constant(+D),y):o},y.filter=function(D){return arguments.length?(r=typeof D=="function"?D:constant(!!D),y):r},y.touchable=function(D){return arguments.length?(c=typeof D=="function"?D:constant(!!D),y):c},y.extent=function(D){return arguments.length?(e=typeof D=="function"?D:constant([[+D[0][0],+D[0][1]],[+D[1][0],+D[1][1]]]),y):e},y.scaleExtent=function(D){return arguments.length?(h[0]=+D[0],h[1]=+D[1],y):[h[0],h[1]]},y.translateExtent=function(D){return arguments.length?(v[0][0]=+D[0][0],v[1][0]=+D[1][0],v[0][1]=+D[0][1],v[1][1]=+D[1][1],y):[[v[0][0],v[0][1]],[v[1][0],v[1][1]]]},y.constrain=function(D){return arguments.length?(t=D,y):t},y.duration=function(D){return arguments.length?(p=+D,y):p},y.interpolate=function(D){return arguments.length?(g=D,y):g},y.on=function(){var D=x.on.apply(x,arguments);return D===x?y:D},y.clickDistance=function(D){return arguments.length?(l=(D=+D)*D,y):Math.sqrt(l)},y.tapDistance=function(D){return arguments.length?(s=+D,y):s},y}const StoreContext=reactExports.createContext(null),Provider$1=StoreContext.Provider,errorMessages={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:r=>`Node type "${r}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:r=>`The old edge with id=${r} does not exist.`,error009:r=>`Marker type "${r}" doesn't exist.`,error008:(r,e)=>`Couldn't create edge for ${r?"target":"source"} handle id: "${r?e.targetHandle:e.sourceHandle}", edge id: ${e.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:r=>`Edge type "${r}" not found. Using fallback type "default".`,error012:r=>`Node with id "${r}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},zustandErrorMessage=errorMessages.error001();function useStore(r,e){const t=reactExports.useContext(StoreContext);if(t===null)throw new Error(zustandErrorMessage);return useStoreWithEqualityFn(t,r,e)}const useStoreApi=()=>{const r=reactExports.useContext(StoreContext);if(r===null)throw new Error(zustandErrorMessage);return reactExports.useMemo(()=>({getState:r.getState,setState:r.setState,subscribe:r.subscribe,destroy:r.destroy}),[r])},selector$g=r=>r.userSelectionActive?"none":"all";function Panel({position:r,children:e,className:t,style:o,...c}){const h=useStore(selector$g),v=`${r}`.split("-");return React.createElement("div",{className:cc$1(["react-flow__panel",t,...v]),style:{...o,pointerEvents:h},...c},e)}function Attribution({proOptions:r,position:e="bottom-right"}){return r?.hideAttribution?null:React.createElement(Panel,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},React.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const EdgeText=({x:r,y:e,label:t,labelStyle:o={},labelShowBg:c=!0,labelBgStyle:h={},labelBgPadding:v=[2,4],labelBgBorderRadius:p=2,children:g,className:x,...f})=>{const b=reactExports.useRef(null),[C,S]=reactExports.useState({x:0,y:0,width:0,height:0}),k=cc$1(["react-flow__edge-textwrapper",x]);return reactExports.useEffect(()=>{if(b.current){const l=b.current.getBBox();S({x:l.x,y:l.y,width:l.width,height:l.height})}},[t]),typeof t>"u"||!t?null:React.createElement("g",{transform:`translate(${r-C.width/2} ${e-C.height/2})`,className:k,visibility:C.width?"visible":"hidden",...f},c&&React.createElement("rect",{width:C.width+2*v[0],x:-v[0],y:-v[1],height:C.height+2*v[1],className:"react-flow__edge-textbg",style:h,rx:p,ry:p}),React.createElement("text",{className:"react-flow__edge-text",y:C.height/2,dy:"0.3em",ref:b,style:o},t),g)};var EdgeText$1=reactExports.memo(EdgeText);const getDimensions=r=>({width:r.offsetWidth,height:r.offsetHeight}),clamp=(r,e=0,t=1)=>Math.min(Math.max(r,e),t),clampPosition=(r={x:0,y:0},e)=>({x:clamp(r.x,e[0][0],e[1][0]),y:clamp(r.y,e[0][1],e[1][1])}),calcAutoPanVelocity=(r,e,t)=>r<e?clamp(Math.abs(r-e),1,50)/50:r>t?-clamp(Math.abs(r-t),1,50)/50:0,calcAutoPan=(r,e)=>{const t=calcAutoPanVelocity(r.x,35,e.width-35)*20,o=calcAutoPanVelocity(r.y,35,e.height-35)*20;return[t,o]},getHostForElement=r=>r.getRootNode?.()||window?.document,getBoundsOfBoxes=(r,e)=>({x:Math.min(r.x,e.x),y:Math.min(r.y,e.y),x2:Math.max(r.x2,e.x2),y2:Math.max(r.y2,e.y2)}),rectToBox=({x:r,y:e,width:t,height:o})=>({x:r,y:e,x2:r+t,y2:e+o}),boxToRect=({x:r,y:e,x2:t,y2:o})=>({x:r,y:e,width:t-r,height:o-e}),nodeToRect=r=>({...r.positionAbsolute||{x:0,y:0},width:r.width||0,height:r.height||0}),getOverlappingArea=(r,e)=>{const t=Math.max(0,Math.min(r.x+r.width,e.x+e.width)-Math.max(r.x,e.x)),o=Math.max(0,Math.min(r.y+r.height,e.y+e.height)-Math.max(r.y,e.y));return Math.ceil(t*o)},isRectObject=r=>isNumeric(r.width)&&isNumeric(r.height)&&isNumeric(r.x)&&isNumeric(r.y),isNumeric=r=>!isNaN(r)&&isFinite(r),internalsSymbol=Symbol.for("internals"),elementSelectionKeys=["Enter"," ","Escape"],devWarn=(r,e)=>{},isReactKeyboardEvent=r=>"nativeEvent"in r;function isInputDOMNode(r){const t=(isReactKeyboardEvent(r)?r.nativeEvent:r).composedPath?.()?.[0]||r.target;return["INPUT","SELECT","TEXTAREA"].includes(t?.nodeName)||t?.hasAttribute("contenteditable")||!!t?.closest(".nokey")}const isMouseEvent=r=>"clientX"in r,getEventPosition=(r,e)=>{const t=isMouseEvent(r),o=t?r.clientX:r.touches?.[0].clientX,c=t?r.clientY:r.touches?.[0].clientY;return{x:o-(e?.left??0),y:c-(e?.top??0)}},isMacOs=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,BaseEdge=({id:r,path:e,labelX:t,labelY:o,label:c,labelStyle:h,labelShowBg:v,labelBgStyle:p,labelBgPadding:g,labelBgBorderRadius:x,style:f,markerEnd:b,markerStart:C,interactionWidth:S=20})=>React.createElement(React.Fragment,null,React.createElement("path",{id:r,style:f,d:e,fill:"none",className:"react-flow__edge-path",markerEnd:b,markerStart:C}),S&&React.createElement("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:S,className:"react-flow__edge-interaction"}),c&&isNumeric(t)&&isNumeric(o)?React.createElement(EdgeText$1,{x:t,y:o,label:c,labelStyle:h,labelShowBg:v,labelBgStyle:p,labelBgPadding:g,labelBgBorderRadius:x}):null);BaseEdge.displayName="BaseEdge";function getMouseHandler$1(r,e,t){return t===void 0?t:o=>{const c=e().edges.find(h=>h.id===r);c&&t(o,{...c})}}function getEdgeCenter({sourceX:r,sourceY:e,targetX:t,targetY:o}){const c=Math.abs(t-r)/2,h=t<r?t+c:t-c,v=Math.abs(o-e)/2,p=o<e?o+v:o-v;return[h,p,c,v]}function getBezierEdgeCenter({sourceX:r,sourceY:e,targetX:t,targetY:o,sourceControlX:c,sourceControlY:h,targetControlX:v,targetControlY:p}){const g=r*.125+c*.375+v*.375+t*.125,x=e*.125+h*.375+p*.375+o*.125,f=Math.abs(g-r),b=Math.abs(x-e);return[g,x,f,b]}var ConnectionMode;(function(r){r.Strict="strict",r.Loose="loose"})(ConnectionMode||(ConnectionMode={}));var PanOnScrollMode;(function(r){r.Free="free",r.Vertical="vertical",r.Horizontal="horizontal"})(PanOnScrollMode||(PanOnScrollMode={}));var SelectionMode;(function(r){r.Partial="partial",r.Full="full"})(SelectionMode||(SelectionMode={}));var ConnectionLineType;(function(r){r.Bezier="default",r.Straight="straight",r.Step="step",r.SmoothStep="smoothstep",r.SimpleBezier="simplebezier"})(ConnectionLineType||(ConnectionLineType={}));var MarkerType;(function(r){r.Arrow="arrow",r.ArrowClosed="arrowclosed"})(MarkerType||(MarkerType={}));var Position;(function(r){r.Left="left",r.Top="top",r.Right="right",r.Bottom="bottom"})(Position||(Position={}));function getControl({pos:r,x1:e,y1:t,x2:o,y2:c}){return r===Position.Left||r===Position.Right?[.5*(e+o),t]:[e,.5*(t+c)]}function getSimpleBezierPath({sourceX:r,sourceY:e,sourcePosition:t=Position.Bottom,targetX:o,targetY:c,targetPosition:h=Position.Top}){const[v,p]=getControl({pos:t,x1:r,y1:e,x2:o,y2:c}),[g,x]=getControl({pos:h,x1:o,y1:c,x2:r,y2:e}),[f,b,C,S]=getBezierEdgeCenter({sourceX:r,sourceY:e,targetX:o,targetY:c,sourceControlX:v,sourceControlY:p,targetControlX:g,targetControlY:x});return[`M${r},${e} C${v},${p} ${g},${x} ${o},${c}`,f,b,C,S]}const SimpleBezierEdge=reactExports.memo(({sourceX:r,sourceY:e,targetX:t,targetY:o,sourcePosition:c=Position.Bottom,targetPosition:h=Position.Top,label:v,labelStyle:p,labelShowBg:g,labelBgStyle:x,labelBgPadding:f,labelBgBorderRadius:b,style:C,markerEnd:S,markerStart:k,interactionWidth:l})=>{const[s,y,A]=getSimpleBezierPath({sourceX:r,sourceY:e,sourcePosition:c,targetX:t,targetY:o,targetPosition:h});return React.createElement(BaseEdge,{path:s,labelX:y,labelY:A,label:v,labelStyle:p,labelShowBg:g,labelBgStyle:x,labelBgPadding:f,labelBgBorderRadius:b,style:C,markerEnd:S,markerStart:k,interactionWidth:l})});SimpleBezierEdge.displayName="SimpleBezierEdge";const handleDirections={[Position.Left]:{x:-1,y:0},[Position.Right]:{x:1,y:0},[Position.Top]:{x:0,y:-1},[Position.Bottom]:{x:0,y:1}},getDirection=({source:r,sourcePosition:e=Position.Bottom,target:t})=>e===Position.Left||e===Position.Right?r.x<t.x?{x:1,y:0}:{x:-1,y:0}:r.y<t.y?{x:0,y:1}:{x:0,y:-1},distance=(r,e)=>Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2));function getPoints({source:r,sourcePosition:e=Position.Bottom,target:t,targetPosition:o=Position.Top,center:c,offset:h}){const v=handleDirections[e],p=handleDirections[o],g={x:r.x+v.x*h,y:r.y+v.y*h},x={x:t.x+p.x*h,y:t.y+p.y*h},f=getDirection({source:g,sourcePosition:e,target:x}),b=f.x!==0?"x":"y",C=f[b];let S=[],k,l;const s={x:0,y:0},y={x:0,y:0},[A,E,T,u]=getEdgeCenter({sourceX:r.x,sourceY:r.y,targetX:t.x,targetY:t.y});if(v[b]*p[b]===-1){k=c.x??A,l=c.y??E;const M=[{x:k,y:g.y},{x:k,y:x.y}],R=[{x:g.x,y:l},{x:x.x,y:l}];v[b]===C?S=b==="x"?M:R:S=b==="x"?R:M}else{const M=[{x:g.x,y:x.y}],R=[{x:x.x,y:g.y}];if(b==="x"?S=v.x===C?R:M:S=v.y===C?M:R,e===o){const B=Math.abs(r[b]-t[b]);if(B<=h){const D=Math.min(h-1,h-B);v[b]===C?s[b]=(g[b]>r[b]?-1:1)*D:y[b]=(x[b]>t[b]?-1:1)*D}}if(e!==o){const B=b==="x"?"y":"x",D=v[b]===p[B],H=g[B]>x[B],W=g[B]<x[B];(v[b]===1&&(!D&&H||D&&W)||v[b]!==1&&(!D&&W||D&&H))&&(S=b==="x"?M:R)}const N={x:g.x+s.x,y:g.y+s.y},I={x:x.x+y.x,y:x.y+y.y},L=Math.max(Math.abs(N.x-S[0].x),Math.abs(I.x-S[0].x)),Y=Math.max(Math.abs(N.y-S[0].y),Math.abs(I.y-S[0].y));L>=Y?(k=(N.x+I.x)/2,l=S[0].y):(k=S[0].x,l=(N.y+I.y)/2)}return[[r,{x:g.x+s.x,y:g.y+s.y},...S,{x:x.x+y.x,y:x.y+y.y},t],k,l,T,u]}function getBend(r,e,t,o){const c=Math.min(distance(r,e)/2,distance(e,t)/2,o),{x:h,y:v}=e;if(r.x===h&&h===t.x||r.y===v&&v===t.y)return`L${h} ${v}`;if(r.y===v){const x=r.x<t.x?-1:1,f=r.y<t.y?1:-1;return`L ${h+c*x},${v}Q ${h},${v} ${h},${v+c*f}`}const p=r.x<t.x?1:-1,g=r.y<t.y?-1:1;return`L ${h},${v+c*g}Q ${h},${v} ${h+c*p},${v}`}function getSmoothStepPath({sourceX:r,sourceY:e,sourcePosition:t=Position.Bottom,targetX:o,targetY:c,targetPosition:h=Position.Top,borderRadius:v=5,centerX:p,centerY:g,offset:x=20}){const[f,b,C,S,k]=getPoints({source:{x:r,y:e},sourcePosition:t,target:{x:o,y:c},targetPosition:h,center:{x:p,y:g},offset:x});return[f.reduce((s,y,A)=>{let E="";return A>0&&A<f.length-1?E=getBend(f[A-1],y,f[A+1],v):E=`${A===0?"M":"L"}${y.x} ${y.y}`,s+=E,s},""),b,C,S,k]}const SmoothStepEdge=reactExports.memo(({sourceX:r,sourceY:e,targetX:t,targetY:o,label:c,labelStyle:h,labelShowBg:v,labelBgStyle:p,labelBgPadding:g,labelBgBorderRadius:x,style:f,sourcePosition:b=Position.Bottom,targetPosition:C=Position.Top,markerEnd:S,markerStart:k,pathOptions:l,interactionWidth:s})=>{const[y,A,E]=getSmoothStepPath({sourceX:r,sourceY:e,sourcePosition:b,targetX:t,targetY:o,targetPosition:C,borderRadius:l?.borderRadius,offset:l?.offset});return React.createElement(BaseEdge,{path:y,labelX:A,labelY:E,label:c,labelStyle:h,labelShowBg:v,labelBgStyle:p,labelBgPadding:g,labelBgBorderRadius:x,style:f,markerEnd:S,markerStart:k,interactionWidth:s})});SmoothStepEdge.displayName="SmoothStepEdge";const StepEdge=reactExports.memo(r=>React.createElement(SmoothStepEdge,{...r,pathOptions:reactExports.useMemo(()=>({borderRadius:0,offset:r.pathOptions?.offset}),[r.pathOptions?.offset])}));StepEdge.displayName="StepEdge";function getStraightPath({sourceX:r,sourceY:e,targetX:t,targetY:o}){const[c,h,v,p]=getEdgeCenter({sourceX:r,sourceY:e,targetX:t,targetY:o});return[`M ${r},${e}L ${t},${o}`,c,h,v,p]}const StraightEdge=reactExports.memo(({sourceX:r,sourceY:e,targetX:t,targetY:o,label:c,labelStyle:h,labelShowBg:v,labelBgStyle:p,labelBgPadding:g,labelBgBorderRadius:x,style:f,markerEnd:b,markerStart:C,interactionWidth:S})=>{const[k,l,s]=getStraightPath({sourceX:r,sourceY:e,targetX:t,targetY:o});return React.createElement(BaseEdge,{path:k,labelX:l,labelY:s,label:c,labelStyle:h,labelShowBg:v,labelBgStyle:p,labelBgPadding:g,labelBgBorderRadius:x,style:f,markerEnd:b,markerStart:C,interactionWidth:S})});StraightEdge.displayName="StraightEdge";function calculateControlOffset(r,e){return r>=0?.5*r:e*25*Math.sqrt(-r)}function getControlWithCurvature({pos:r,x1:e,y1:t,x2:o,y2:c,c:h}){switch(r){case Position.Left:return[e-calculateControlOffset(e-o,h),t];case Position.Right:return[e+calculateControlOffset(o-e,h),t];case Position.Top:return[e,t-calculateControlOffset(t-c,h)];case Position.Bottom:return[e,t+calculateControlOffset(c-t,h)]}}function getBezierPath({sourceX:r,sourceY:e,sourcePosition:t=Position.Bottom,targetX:o,targetY:c,targetPosition:h=Position.Top,curvature:v=.25}){const[p,g]=getControlWithCurvature({pos:t,x1:r,y1:e,x2:o,y2:c,c:v}),[x,f]=getControlWithCurvature({pos:h,x1:o,y1:c,x2:r,y2:e,c:v}),[b,C,S,k]=getBezierEdgeCenter({sourceX:r,sourceY:e,targetX:o,targetY:c,sourceControlX:p,sourceControlY:g,targetControlX:x,targetControlY:f});return[`M${r},${e} C${p},${g} ${x},${f} ${o},${c}`,b,C,S,k]}const BezierEdge=reactExports.memo(({sourceX:r,sourceY:e,targetX:t,targetY:o,sourcePosition:c=Position.Bottom,targetPosition:h=Position.Top,label:v,labelStyle:p,labelShowBg:g,labelBgStyle:x,labelBgPadding:f,labelBgBorderRadius:b,style:C,markerEnd:S,markerStart:k,pathOptions:l,interactionWidth:s})=>{const[y,A,E]=getBezierPath({sourceX:r,sourceY:e,sourcePosition:c,targetX:t,targetY:o,targetPosition:h,curvature:l?.curvature});return React.createElement(BaseEdge,{path:y,labelX:A,labelY:E,label:v,labelStyle:p,labelShowBg:g,labelBgStyle:x,labelBgPadding:f,labelBgBorderRadius:b,style:C,markerEnd:S,markerStart:k,interactionWidth:s})});BezierEdge.displayName="BezierEdge";const NodeIdContext=reactExports.createContext(null),Provider$2=NodeIdContext.Provider;NodeIdContext.Consumer;const useNodeId=()=>reactExports.useContext(NodeIdContext),isEdge=r=>"id"in r&&"source"in r&&"target"in r,getEdgeId=({source:r,sourceHandle:e,target:t,targetHandle:o})=>`reactflow__edge-${r}${e||""}-${t}${o||""}`,getMarkerId=(r,e)=>typeof r>"u"?"":typeof r=="string"?r:`${e?`${e}__`:""}${Object.keys(r).sort().map(o=>`${o}=${r[o]}`).join("&")}`,connectionExists=(r,e)=>e.some(t=>t.source===r.source&&t.target===r.target&&(t.sourceHandle===r.sourceHandle||!t.sourceHandle&&!r.sourceHandle)&&(t.targetHandle===r.targetHandle||!t.targetHandle&&!r.targetHandle)),addEdge=(r,e)=>{if(!r.source||!r.target)return e;let t;return isEdge(r)?t={...r}:t={...r,id:getEdgeId(r)},connectionExists(t,e)?e:e.concat(t)},pointToRendererPoint=({x:r,y:e},[t,o,c],h,[v,p])=>{const g={x:(r-t)/c,y:(e-o)/c};return h?{x:v*Math.round(g.x/v),y:p*Math.round(g.y/p)}:g},rendererPointToPoint=({x:r,y:e},[t,o,c])=>({x:r*c+t,y:e*c+o}),getNodePositionWithOrigin=(r,e=[0,0])=>{if(!r)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const t=(r.width??0)*e[0],o=(r.height??0)*e[1],c={x:r.position.x-t,y:r.position.y-o};return{...c,positionAbsolute:r.positionAbsolute?{x:r.positionAbsolute.x-t,y:r.positionAbsolute.y-o}:c}},getNodesBounds=(r,e=[0,0])=>{if(r.length===0)return{x:0,y:0,width:0,height:0};const t=r.reduce((o,c)=>{const{x:h,y:v}=getNodePositionWithOrigin(c,e).positionAbsolute;return getBoundsOfBoxes(o,rectToBox({x:h,y:v,width:c.width||0,height:c.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return boxToRect(t)},getNodesInside=(r,e,[t,o,c]=[0,0,1],h=!1,v=!1,p=[0,0])=>{const g={x:(e.x-t)/c,y:(e.y-o)/c,width:e.width/c,height:e.height/c},x=[];return r.forEach(f=>{const{width:b,height:C,selectable:S=!0,hidden:k=!1}=f;if(v&&!S||k)return!1;const{positionAbsolute:l}=getNodePositionWithOrigin(f,p),s={x:l.x,y:l.y,width:b||0,height:C||0},y=getOverlappingArea(g,s),A=typeof b>"u"||typeof C>"u"||b===null||C===null,E=h&&y>0,T=(b||0)*(C||0);(A||E||y>=T||f.dragging)&&x.push(f)}),x},getConnectedEdges=(r,e)=>{const t=r.map(o=>o.id);return e.filter(o=>t.includes(o.source)||t.includes(o.target))},getViewportForBounds=(r,e,t,o,c,h=.1)=>{const v=e/(r.width*(1+h)),p=t/(r.height*(1+h)),g=Math.min(v,p),x=clamp(g,o,c),f=r.x+r.width/2,b=r.y+r.height/2,C=e/2-f*x,S=t/2-b*x;return{x:C,y:S,zoom:x}},getD3Transition=(r,e=0)=>r.transition().duration(e);function getHandles(r,e,t,o){return(e[t]||[]).reduce((c,h)=>(`${r.id}-${h.id}-${t}`!==o&&c.push({id:h.id||null,type:t,nodeId:r.id,x:(r.positionAbsolute?.x??0)+h.x+h.width/2,y:(r.positionAbsolute?.y??0)+h.y+h.height/2}),c),[])}function getClosestHandle(r,e,t,o,c,h){const{x:v,y:p}=getEventPosition(r),x=e.elementsFromPoint(v,p).find(k=>k.classList.contains("react-flow__handle"));if(x){const k=x.getAttribute("data-nodeid");if(k){const l=getHandleType(void 0,x),s=x.getAttribute("data-handleid"),y=h({nodeId:k,id:s,type:l});if(y){const A=c.find(E=>E.nodeId===k&&E.type===l&&E.id===s);return{handle:{id:s,type:l,nodeId:k,x:A?.x||t.x,y:A?.y||t.y},validHandleResult:y}}}}let f=[],b=1/0;if(c.forEach(k=>{const l=Math.sqrt((k.x-t.x)**2+(k.y-t.y)**2);if(l<=o){const s=h(k);l<=b&&(l<b?f=[{handle:k,validHandleResult:s}]:l===b&&f.push({handle:k,validHandleResult:s}),b=l)}}),!f.length)return{handle:null,validHandleResult:defaultResult()};if(f.length===1)return f[0];const C=f.some(({validHandleResult:k})=>k.isValid),S=f.some(({handle:k})=>k.type==="target");return f.find(({handle:k,validHandleResult:l})=>S?k.type==="target":C?l.isValid:!0)||f[0]}const nullConnection={source:null,target:null,sourceHandle:null,targetHandle:null},defaultResult=()=>({handleDomNode:null,isValid:!1,connection:nullConnection,endHandle:null});function isValidHandle(r,e,t,o,c,h,v){const p=c==="target",g=v.querySelector(`.react-flow__handle[data-id="${r?.nodeId}-${r?.id}-${r?.type}"]`),x={...defaultResult(),handleDomNode:g};if(g){const f=getHandleType(void 0,g),b=g.getAttribute("data-nodeid"),C=g.getAttribute("data-handleid"),S=g.classList.contains("connectable"),k=g.classList.contains("connectableend"),l={source:p?b:t,sourceHandle:p?C:o,target:p?t:b,targetHandle:p?o:C};x.connection=l,S&&k&&(e===ConnectionMode.Strict?p&&f==="source"||!p&&f==="target":b!==t||C!==o)&&(x.endHandle={nodeId:b,handleId:C,type:f},x.isValid=h(l))}return x}function getHandleLookup({nodes:r,nodeId:e,handleId:t,handleType:o}){return r.reduce((c,h)=>{if(h[internalsSymbol]){const{handleBounds:v}=h[internalsSymbol];let p=[],g=[];v&&(p=getHandles(h,v,"source",`${e}-${t}-${o}`),g=getHandles(h,v,"target",`${e}-${t}-${o}`)),c.push(...p,...g)}return c},[])}function getHandleType(r,e){return r||(e?.classList.contains("target")?"target":e?.classList.contains("source")?"source":null)}function resetRecentHandle(r){r?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function getConnectionStatus(r,e){let t=null;return e?t="valid":r&&!e&&(t="invalid"),t}function handlePointerDown({event:r,handleId:e,nodeId:t,onConnect:o,isTarget:c,getState:h,setState:v,isValidConnection:p,edgeUpdaterType:g,onReconnectEnd:x}){const f=getHostForElement(r.target),{connectionMode:b,domNode:C,autoPanOnConnect:S,connectionRadius:k,onConnectStart:l,panBy:s,getNodes:y,cancelConnection:A}=h();let E=0,T;const{x:u,y:_}=getEventPosition(r),M=f?.elementFromPoint(u,_),R=getHandleType(g,M),N=C?.getBoundingClientRect();if(!N||!R)return;let I,L=getEventPosition(r,N),Y=!1,B=null,D=!1,H=null;const W=getHandleLookup({nodes:y(),nodeId:t,handleId:e,handleType:R}),q=()=>{if(!S)return;const[O,j]=calcAutoPan(L,N);s({x:O,y:j}),E=requestAnimationFrame(q)};v({connectionPosition:L,connectionStatus:null,connectionNodeId:t,connectionHandleId:e,connectionHandleType:R,connectionStartHandle:{nodeId:t,handleId:e,type:R},connectionEndHandle:null}),l?.(r,{nodeId:t,handleId:e,handleType:R});function V(O){const{transform:j}=h();L=getEventPosition(O,N);const{handle:J,validHandleResult:oe}=getClosestHandle(O,f,pointToRendererPoint(L,j,!1,[1,1]),k,W,ie=>isValidHandle(ie,b,t,e,c?"target":"source",p,f));if(T=J,Y||(q(),Y=!0),H=oe.handleDomNode,B=oe.connection,D=oe.isValid,v({connectionPosition:T&&D?rendererPointToPoint({x:T.x,y:T.y},j):L,connectionStatus:getConnectionStatus(!!T,D),connectionEndHandle:oe.endHandle}),!T&&!D&&!H)return resetRecentHandle(I);B.source!==B.target&&H&&(resetRecentHandle(I),I=H,H.classList.add("connecting","react-flow__handle-connecting"),H.classList.toggle("valid",D),H.classList.toggle("react-flow__handle-valid",D))}function $(O){(T||H)&&B&&D&&o?.(B),h().onConnectEnd?.(O),g&&x?.(O),resetRecentHandle(I),A(),cancelAnimationFrame(E),Y=!1,D=!1,B=null,H=null,f.removeEventListener("mousemove",V),f.removeEventListener("mouseup",$),f.removeEventListener("touchmove",V),f.removeEventListener("touchend",$)}f.addEventListener("mousemove",V),f.addEventListener("mouseup",$),f.addEventListener("touchmove",V),f.addEventListener("touchend",$)}const alwaysValid=()=>!0,selector$f=r=>({connectionStartHandle:r.connectionStartHandle,connectOnClick:r.connectOnClick,noPanClassName:r.noPanClassName}),connectingSelector=(r,e,t)=>o=>{const{connectionStartHandle:c,connectionEndHandle:h,connectionClickStartHandle:v}=o;return{connecting:c?.nodeId===r&&c?.handleId===e&&c?.type===t||h?.nodeId===r&&h?.handleId===e&&h?.type===t,clickConnecting:v?.nodeId===r&&v?.handleId===e&&v?.type===t}},Handle=reactExports.forwardRef(({type:r="source",position:e=Position.Top,isValidConnection:t,isConnectable:o=!0,isConnectableStart:c=!0,isConnectableEnd:h=!0,id:v,onConnect:p,children:g,className:x,onMouseDown:f,onTouchStart:b,...C},S)=>{const k=v||null,l=r==="target",s=useStoreApi(),y=useNodeId(),{connectOnClick:A,noPanClassName:E}=useStore(selector$f,shallow$1),{connecting:T,clickConnecting:u}=useStore(connectingSelector(y,k,r),shallow$1);y||s.getState().onError?.("010",errorMessages.error010());const _=N=>{const{defaultEdgeOptions:I,onConnect:L,hasDefaultEdges:Y}=s.getState(),B={...I,...N};if(Y){const{edges:D,setEdges:H}=s.getState();H(addEdge(B,D))}L?.(B),p?.(B)},M=N=>{if(!y)return;const I=isMouseEvent(N);c&&(I&&N.button===0||!I)&&handlePointerDown({event:N,handleId:k,nodeId:y,onConnect:_,isTarget:l,getState:s.getState,setState:s.setState,isValidConnection:t||s.getState().isValidConnection||alwaysValid}),I?f?.(N):b?.(N)},R=N=>{const{onClickConnectStart:I,onClickConnectEnd:L,connectionClickStartHandle:Y,connectionMode:B,isValidConnection:D}=s.getState();if(!y||!Y&&!c)return;if(!Y){I?.(N,{nodeId:y,handleId:k,handleType:r}),s.setState({connectionClickStartHandle:{nodeId:y,type:r,handleId:k}});return}const H=getHostForElement(N.target),W=t||D||alwaysValid,{connection:q,isValid:V}=isValidHandle({nodeId:y,id:k,type:r},B,Y.nodeId,Y.handleId||null,Y.type,W,H);V&&_(q),L?.(N),s.setState({connectionClickStartHandle:null})};return React.createElement("div",{"data-handleid":k,"data-nodeid":y,"data-handlepos":e,"data-id":`${y}-${k}-${r}`,className:cc$1(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",E,x,{source:!l,target:l,connectable:o,connectablestart:c,connectableend:h,connecting:u,connectionindicator:o&&(c&&!T||h&&T)}]),onMouseDown:M,onTouchStart:M,onClick:A?R:void 0,ref:S,...C},g)});Handle.displayName="Handle";var Handle$1=reactExports.memo(Handle);const DefaultNode=({data:r,isConnectable:e,targetPosition:t=Position.Top,sourcePosition:o=Position.Bottom})=>React.createElement(React.Fragment,null,React.createElement(Handle$1,{type:"target",position:t,isConnectable:e}),r?.label,React.createElement(Handle$1,{type:"source",position:o,isConnectable:e}));DefaultNode.displayName="DefaultNode";var DefaultNode$1=reactExports.memo(DefaultNode);const InputNode=({data:r,isConnectable:e,sourcePosition:t=Position.Bottom})=>React.createElement(React.Fragment,null,r?.label,React.createElement(Handle$1,{type:"source",position:t,isConnectable:e}));InputNode.displayName="InputNode";var InputNode$1=reactExports.memo(InputNode);const OutputNode=({data:r,isConnectable:e,targetPosition:t=Position.Top})=>React.createElement(React.Fragment,null,React.createElement(Handle$1,{type:"target",position:t,isConnectable:e}),r?.label);OutputNode.displayName="OutputNode";var OutputNode$1=reactExports.memo(OutputNode);const GroupNode=()=>null;GroupNode.displayName="GroupNode";const selector$e=r=>({selectedNodes:r.getNodes().filter(e=>e.selected),selectedEdges:r.edges.filter(e=>e.selected).map(e=>({...e}))}),selectId=r=>r.id;function areEqual(r,e){return shallow$1(r.selectedNodes.map(selectId),e.selectedNodes.map(selectId))&&shallow$1(r.selectedEdges.map(selectId),e.selectedEdges.map(selectId))}const SelectionListener=reactExports.memo(({onSelectionChange:r})=>{const e=useStoreApi(),{selectedNodes:t,selectedEdges:o}=useStore(selector$e,areEqual);return reactExports.useEffect(()=>{const c={nodes:t,edges:o};r?.(c),e.getState().onSelectionChange.forEach(h=>h(c))},[t,o,r]),null});SelectionListener.displayName="SelectionListener";const changeSelector=r=>!!r.onSelectionChange;function Wrapper$1({onSelectionChange:r}){const e=useStore(changeSelector);return r||e?React.createElement(SelectionListener,{onSelectionChange:r}):null}const selector$d=r=>({setNodes:r.setNodes,setEdges:r.setEdges,setDefaultNodesAndEdges:r.setDefaultNodesAndEdges,setMinZoom:r.setMinZoom,setMaxZoom:r.setMaxZoom,setTranslateExtent:r.setTranslateExtent,setNodeExtent:r.setNodeExtent,reset:r.reset});function useStoreUpdater(r,e){reactExports.useEffect(()=>{typeof r<"u"&&e(r)},[r])}function useDirectStoreUpdater(r,e,t){reactExports.useEffect(()=>{typeof e<"u"&&t({[r]:e})},[e])}const StoreUpdater=({nodes:r,edges:e,defaultNodes:t,defaultEdges:o,onConnect:c,onConnectStart:h,onConnectEnd:v,onClickConnectStart:p,onClickConnectEnd:g,nodesDraggable:x,nodesConnectable:f,nodesFocusable:b,edgesFocusable:C,edgesUpdatable:S,elevateNodesOnSelect:k,minZoom:l,maxZoom:s,nodeExtent:y,onNodesChange:A,onEdgesChange:E,elementsSelectable:T,connectionMode:u,snapGrid:_,snapToGrid:M,translateExtent:R,connectOnClick:N,defaultEdgeOptions:I,fitView:L,fitViewOptions:Y,onNodesDelete:B,onEdgesDelete:D,onNodeDrag:H,onNodeDragStart:W,onNodeDragStop:q,onSelectionDrag:V,onSelectionDragStart:$,onSelectionDragStop:O,noPanClassName:j,nodeOrigin:J,rfId:oe,autoPanOnConnect:ie,autoPanOnNodeDrag:he,onError:de,connectionRadius:fe,isValidConnection:ue,nodeDragThreshold:ye})=>{const{setNodes:ze,setEdges:$e,setDefaultNodesAndEdges:We,setMinZoom:Fe,setMaxZoom:me,setTranslateExtent:ke,setNodeExtent:Qe,reset:Je}=useStore(selector$d,shallow$1),Ye=useStoreApi();return reactExports.useEffect(()=>{const nt=o?.map(rt=>({...rt,...I}));return We(t,nt),()=>{Je()}},[]),useDirectStoreUpdater("defaultEdgeOptions",I,Ye.setState),useDirectStoreUpdater("connectionMode",u,Ye.setState),useDirectStoreUpdater("onConnect",c,Ye.setState),useDirectStoreUpdater("onConnectStart",h,Ye.setState),useDirectStoreUpdater("onConnectEnd",v,Ye.setState),useDirectStoreUpdater("onClickConnectStart",p,Ye.setState),useDirectStoreUpdater("onClickConnectEnd",g,Ye.setState),useDirectStoreUpdater("nodesDraggable",x,Ye.setState),useDirectStoreUpdater("nodesConnectable",f,Ye.setState),useDirectStoreUpdater("nodesFocusable",b,Ye.setState),useDirectStoreUpdater("edgesFocusable",C,Ye.setState),useDirectStoreUpdater("edgesUpdatable",S,Ye.setState),useDirectStoreUpdater("elementsSelectable",T,Ye.setState),useDirectStoreUpdater("elevateNodesOnSelect",k,Ye.setState),useDirectStoreUpdater("snapToGrid",M,Ye.setState),useDirectStoreUpdater("snapGrid",_,Ye.setState),useDirectStoreUpdater("onNodesChange",A,Ye.setState),useDirectStoreUpdater("onEdgesChange",E,Ye.setState),useDirectStoreUpdater("connectOnClick",N,Ye.setState),useDirectStoreUpdater("fitViewOnInit",L,Ye.setState),useDirectStoreUpdater("fitViewOnInitOptions",Y,Ye.setState),useDirectStoreUpdater("onNodesDelete",B,Ye.setState),useDirectStoreUpdater("onEdgesDelete",D,Ye.setState),useDirectStoreUpdater("onNodeDrag",H,Ye.setState),useDirectStoreUpdater("onNodeDragStart",W,Ye.setState),useDirectStoreUpdater("onNodeDragStop",q,Ye.setState),useDirectStoreUpdater("onSelectionDrag",V,Ye.setState),useDirectStoreUpdater("onSelectionDragStart",$,Ye.setState),useDirectStoreUpdater("onSelectionDragStop",O,Ye.setState),useDirectStoreUpdater("noPanClassName",j,Ye.setState),useDirectStoreUpdater("nodeOrigin",J,Ye.setState),useDirectStoreUpdater("rfId",oe,Ye.setState),useDirectStoreUpdater("autoPanOnConnect",ie,Ye.setState),useDirectStoreUpdater("autoPanOnNodeDrag",he,Ye.setState),useDirectStoreUpdater("onError",de,Ye.setState),useDirectStoreUpdater("connectionRadius",fe,Ye.setState),useDirectStoreUpdater("isValidConnection",ue,Ye.setState),useDirectStoreUpdater("nodeDragThreshold",ye,Ye.setState),useStoreUpdater(r,ze),useStoreUpdater(e,$e),useStoreUpdater(l,Fe),useStoreUpdater(s,me),useStoreUpdater(R,ke),useStoreUpdater(y,Qe),null},style={display:"none"},ariaLiveStyle={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ARIA_NODE_DESC_KEY="react-flow__node-desc",ARIA_EDGE_DESC_KEY="react-flow__edge-desc",ARIA_LIVE_MESSAGE="react-flow__aria-live",selector$c=r=>r.ariaLiveMessage;function AriaLiveMessage({rfId:r}){const e=useStore(selector$c);return React.createElement("div",{id:`${ARIA_LIVE_MESSAGE}-${r}`,"aria-live":"assertive","aria-atomic":"true",style:ariaLiveStyle},e)}function A11yDescriptions({rfId:r,disableKeyboardA11y:e}){return React.createElement(React.Fragment,null,React.createElement("div",{id:`${ARIA_NODE_DESC_KEY}-${r}`,style},"Press enter or space to select a node.",!e&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),React.createElement("div",{id:`${ARIA_EDGE_DESC_KEY}-${r}`,style},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!e&&React.createElement(AriaLiveMessage,{rfId:r}))}var useKeyPress=(r=null,e={actInsideInputWithModifier:!0})=>{const[t,o]=reactExports.useState(!1),c=reactExports.useRef(!1),h=reactExports.useRef(new Set([])),[v,p]=reactExports.useMemo(()=>{if(r!==null){const x=(Array.isArray(r)?r:[r]).filter(b=>typeof b=="string").map(b=>b.split("+")),f=x.reduce((b,C)=>b.concat(...C),[]);return[x,f]}return[[],[]]},[r]);return reactExports.useEffect(()=>{const g=typeof document<"u"?document:null,x=e?.target||g;if(r!==null){const f=S=>{if(c.current=S.ctrlKey||S.metaKey||S.shiftKey,(!c.current||c.current&&!e.actInsideInputWithModifier)&&isInputDOMNode(S))return!1;const l=useKeyOrCode(S.code,p);h.current.add(S[l]),isMatchingKey(v,h.current,!1)&&(S.preventDefault(),o(!0))},b=S=>{if((!c.current||c.current&&!e.actInsideInputWithModifier)&&isInputDOMNode(S))return!1;const l=useKeyOrCode(S.code,p);isMatchingKey(v,h.current,!0)?(o(!1),h.current.clear()):h.current.delete(S[l]),S.key==="Meta"&&h.current.clear(),c.current=!1},C=()=>{h.current.clear(),o(!1)};return x?.addEventListener("keydown",f),x?.addEventListener("keyup",b),window.addEventListener("blur",C),()=>{x?.removeEventListener("keydown",f),x?.removeEventListener("keyup",b),window.removeEventListener("blur",C)}}},[r,o]),t};function isMatchingKey(r,e,t){return r.filter(o=>t||o.length===e.size).some(o=>o.every(c=>e.has(c)))}function useKeyOrCode(r,e){return e.includes(r)?"code":"key"}function calculateXYZPosition(r,e,t,o){const c=r.parentNode||r.parentId;if(!c)return t;const h=e.get(c),v=getNodePositionWithOrigin(h,o);return calculateXYZPosition(h,e,{x:(t.x??0)+v.x,y:(t.y??0)+v.y,z:(h[internalsSymbol]?.z??0)>(t.z??0)?h[internalsSymbol]?.z??0:t.z??0},o)}function updateAbsoluteNodePositions(r,e,t){r.forEach(o=>{const c=o.parentNode||o.parentId;if(c&&!r.has(c))throw new Error(`Parent node ${c} not found`);if(c||t?.[o.id]){const{x:h,y:v,z:p}=calculateXYZPosition(o,r,{...o.position,z:o[internalsSymbol]?.z??0},e);o.positionAbsolute={x:h,y:v},o[internalsSymbol].z=p,t?.[o.id]&&(o[internalsSymbol].isParent=!0)}})}function createNodeInternals(r,e,t,o){const c=new Map,h={},v=o?1e3:0;return r.forEach(p=>{const g=(isNumeric(p.zIndex)?p.zIndex:0)+(p.selected?v:0),x=e.get(p.id),f={...p,positionAbsolute:{x:p.position.x,y:p.position.y}},b=p.parentNode||p.parentId;b&&(h[b]=!0);const C=x?.type&&x?.type!==p.type;Object.defineProperty(f,internalsSymbol,{enumerable:!1,value:{handleBounds:C?void 0:x?.[internalsSymbol]?.handleBounds,z:g}}),c.set(p.id,f)}),updateAbsoluteNodePositions(c,t,h),c}function fitView(r,e={}){const{getNodes:t,width:o,height:c,minZoom:h,maxZoom:v,d3Zoom:p,d3Selection:g,fitViewOnInitDone:x,fitViewOnInit:f,nodeOrigin:b}=r(),C=e.initial&&!x&&f;if(p&&g&&(C||!e.initial)){const k=t().filter(s=>{const y=e.includeHiddenNodes?s.width&&s.height:!s.hidden;return e.nodes?.length?y&&e.nodes.some(A=>A.id===s.id):y}),l=k.every(s=>s.width&&s.height);if(k.length>0&&l){const s=getNodesBounds(k,b),{x:y,y:A,zoom:E}=getViewportForBounds(s,o,c,e.minZoom??h,e.maxZoom??v,e.padding??.1),T=identity.translate(y,A).scale(E);return typeof e.duration=="number"&&e.duration>0?p.transform(getD3Transition(g,e.duration),T):p.transform(g,T),!0}}return!1}function handleControlledNodeSelectionChange(r,e){return r.forEach(t=>{const o=e.get(t.id);o&&e.set(o.id,{...o,[internalsSymbol]:o[internalsSymbol],selected:t.selected})}),new Map(e)}function handleControlledEdgeSelectionChange(r,e){return e.map(t=>{const o=r.find(c=>c.id===t.id);return o&&(t.selected=o.selected),t})}function updateNodesAndEdgesSelections({changedNodes:r,changedEdges:e,get:t,set:o}){const{nodeInternals:c,edges:h,onNodesChange:v,onEdgesChange:p,hasDefaultNodes:g,hasDefaultEdges:x}=t();r?.length&&(g&&o({nodeInternals:handleControlledNodeSelectionChange(r,c)}),v?.(r)),e?.length&&(x&&o({edges:handleControlledEdgeSelectionChange(e,h)}),p?.(e))}const noop=()=>{},initialViewportHelper={zoomIn:noop,zoomOut:noop,zoomTo:noop,getZoom:()=>1,setViewport:noop,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:noop,fitBounds:noop,project:r=>r,screenToFlowPosition:r=>r,flowToScreenPosition:r=>r,viewportInitialized:!1},selector$b=r=>({d3Zoom:r.d3Zoom,d3Selection:r.d3Selection}),useViewportHelper=()=>{const r=useStoreApi(),{d3Zoom:e,d3Selection:t}=useStore(selector$b,shallow$1);return reactExports.useMemo(()=>t&&e?{zoomIn:c=>e.scaleBy(getD3Transition(t,c?.duration),1.2),zoomOut:c=>e.scaleBy(getD3Transition(t,c?.duration),1/1.2),zoomTo:(c,h)=>e.scaleTo(getD3Transition(t,h?.duration),c),getZoom:()=>r.getState().transform[2],setViewport:(c,h)=>{const[v,p,g]=r.getState().transform,x=identity.translate(c.x??v,c.y??p).scale(c.zoom??g);e.transform(getD3Transition(t,h?.duration),x)},getViewport:()=>{const[c,h,v]=r.getState().transform;return{x:c,y:h,zoom:v}},fitView:c=>fitView(r.getState,c),setCenter:(c,h,v)=>{const{width:p,height:g,maxZoom:x}=r.getState(),f=typeof v?.zoom<"u"?v.zoom:x,b=p/2-c*f,C=g/2-h*f,S=identity.translate(b,C).scale(f);e.transform(getD3Transition(t,v?.duration),S)},fitBounds:(c,h)=>{const{width:v,height:p,minZoom:g,maxZoom:x}=r.getState(),{x:f,y:b,zoom:C}=getViewportForBounds(c,v,p,g,x,h?.padding??.1),S=identity.translate(f,b).scale(C);e.transform(getD3Transition(t,h?.duration),S)},project:c=>{const{transform:h,snapToGrid:v,snapGrid:p}=r.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),pointToRendererPoint(c,h,v,p)},screenToFlowPosition:c=>{const{transform:h,snapToGrid:v,snapGrid:p,domNode:g}=r.getState();if(!g)return c;const{x,y:f}=g.getBoundingClientRect(),b={x:c.x-x,y:c.y-f};return pointToRendererPoint(b,h,v,p)},flowToScreenPosition:c=>{const{transform:h,domNode:v}=r.getState();if(!v)return c;const{x:p,y:g}=v.getBoundingClientRect(),x=rendererPointToPoint(c,h);return{x:x.x+p,y:x.y+g}},viewportInitialized:!0}:initialViewportHelper,[e,t])};function useReactFlow(){const r=useViewportHelper(),e=useStoreApi(),t=reactExports.useCallback(()=>e.getState().getNodes().map(l=>({...l})),[]),o=reactExports.useCallback(l=>e.getState().nodeInternals.get(l),[]),c=reactExports.useCallback(()=>{const{edges:l=[]}=e.getState();return l.map(s=>({...s}))},[]),h=reactExports.useCallback(l=>{const{edges:s=[]}=e.getState();return s.find(y=>y.id===l)},[]),v=reactExports.useCallback(l=>{const{getNodes:s,setNodes:y,hasDefaultNodes:A,onNodesChange:E}=e.getState(),T=s(),u=typeof l=="function"?l(T):l;if(A)y(u);else if(E){const _=u.length===0?T.map(M=>({type:"remove",id:M.id})):u.map(M=>({item:M,type:"reset"}));E(_)}},[]),p=reactExports.useCallback(l=>{const{edges:s=[],setEdges:y,hasDefaultEdges:A,onEdgesChange:E}=e.getState(),T=typeof l=="function"?l(s):l;if(A)y(T);else if(E){const u=T.length===0?s.map(_=>({type:"remove",id:_.id})):T.map(_=>({item:_,type:"reset"}));E(u)}},[]),g=reactExports.useCallback(l=>{const s=Array.isArray(l)?l:[l],{getNodes:y,setNodes:A,hasDefaultNodes:E,onNodesChange:T}=e.getState();if(E){const _=[...y(),...s];A(_)}else if(T){const u=s.map(_=>({item:_,type:"add"}));T(u)}},[]),x=reactExports.useCallback(l=>{const s=Array.isArray(l)?l:[l],{edges:y=[],setEdges:A,hasDefaultEdges:E,onEdgesChange:T}=e.getState();if(E)A([...y,...s]);else if(T){const u=s.map(_=>({item:_,type:"add"}));T(u)}},[]),f=reactExports.useCallback(()=>{const{getNodes:l,edges:s=[],transform:y}=e.getState(),[A,E,T]=y;return{nodes:l().map(u=>({...u})),edges:s.map(u=>({...u})),viewport:{x:A,y:E,zoom:T}}},[]),b=reactExports.useCallback(({nodes:l,edges:s})=>{const{nodeInternals:y,getNodes:A,edges:E,hasDefaultNodes:T,hasDefaultEdges:u,onNodesDelete:_,onEdgesDelete:M,onNodesChange:R,onEdgesChange:N}=e.getState(),I=(l||[]).map(H=>H.id),L=(s||[]).map(H=>H.id),Y=A().reduce((H,W)=>{const q=W.parentNode||W.parentId,V=!I.includes(W.id)&&q&&H.find(O=>O.id===q);return(typeof W.deletable=="boolean"?W.deletable:!0)&&(I.includes(W.id)||V)&&H.push(W),H},[]),B=E.filter(H=>typeof H.deletable=="boolean"?H.deletable:!0),D=B.filter(H=>L.includes(H.id));if(Y||D){const H=getConnectedEdges(Y,B),W=[...D,...H],q=W.reduce((V,$)=>(V.includes($.id)||V.push($.id),V),[]);if((u||T)&&(u&&e.setState({edges:E.filter(V=>!q.includes(V.id))}),T&&(Y.forEach(V=>{y.delete(V.id)}),e.setState({nodeInternals:new Map(y)}))),q.length>0&&(M?.(W),N&&N(q.map(V=>({id:V,type:"remove"})))),Y.length>0&&(_?.(Y),R)){const V=Y.map($=>({id:$.id,type:"remove"}));R(V)}}},[]),C=reactExports.useCallback(l=>{const s=isRectObject(l),y=s?null:e.getState().nodeInternals.get(l.id);return!s&&!y?[null,null,s]:[s?l:nodeToRect(y),y,s]},[]),S=reactExports.useCallback((l,s=!0,y)=>{const[A,E,T]=C(l);return A?(y||e.getState().getNodes()).filter(u=>{if(!T&&(u.id===E.id||!u.positionAbsolute))return!1;const _=nodeToRect(u),M=getOverlappingArea(_,A);return s&&M>0||M>=A.width*A.height}):[]},[]),k=reactExports.useCallback((l,s,y=!0)=>{const[A]=C(l);if(!A)return!1;const E=getOverlappingArea(A,s);return y&&E>0||E>=A.width*A.height},[]);return reactExports.useMemo(()=>({...r,getNodes:t,getNode:o,getEdges:c,getEdge:h,setNodes:v,setEdges:p,addNodes:g,addEdges:x,toObject:f,deleteElements:b,getIntersectingNodes:S,isNodeIntersecting:k}),[r,t,o,c,h,v,p,g,x,f,b,S,k])}const deleteKeyOptions={actInsideInputWithModifier:!1};var useGlobalKeyHandler=({deleteKeyCode:r,multiSelectionKeyCode:e})=>{const t=useStoreApi(),{deleteElements:o}=useReactFlow(),c=useKeyPress(r,deleteKeyOptions),h=useKeyPress(e);reactExports.useEffect(()=>{if(c){const{edges:v,getNodes:p}=t.getState(),g=p().filter(f=>f.selected),x=v.filter(f=>f.selected);o({nodes:g,edges:x}),t.setState({nodesSelectionActive:!1})}},[c]),reactExports.useEffect(()=>{t.setState({multiSelectionActive:h})},[h])};function useResizeHandler(r){const e=useStoreApi();reactExports.useEffect(()=>{let t;const o=()=>{if(!r.current)return;const c=getDimensions(r.current);(c.height===0||c.width===0)&&e.getState().onError?.("004",errorMessages.error004()),e.setState({width:c.width||500,height:c.height||500})};return o(),window.addEventListener("resize",o),r.current&&(t=new ResizeObserver(()=>o()),t.observe(r.current)),()=>{window.removeEventListener("resize",o),t&&r.current&&t.unobserve(r.current)}},[])}const containerStyle={position:"absolute",width:"100%",height:"100%",top:0,left:0},viewChanged=(r,e)=>r.x!==e.x||r.y!==e.y||r.zoom!==e.k,eventToFlowTransform=r=>({x:r.x,y:r.y,zoom:r.k}),isWrappedWithClass=(r,e)=>r.target.closest(`.${e}`),isRightClickPan=(r,e)=>e===2&&Array.isArray(r)&&r.includes(2),wheelDelta=r=>{const e=r.ctrlKey&&isMacOs()?10:1;return-r.deltaY*(r.deltaMode===1?.05:r.deltaMode?1:.002)*e},selector$a=r=>({d3Zoom:r.d3Zoom,d3Selection:r.d3Selection,d3ZoomHandler:r.d3ZoomHandler,userSelectionActive:r.userSelectionActive}),ZoomPane=({onMove:r,onMoveStart:e,onMoveEnd:t,onPaneContextMenu:o,zoomOnScroll:c=!0,zoomOnPinch:h=!0,panOnScroll:v=!1,panOnScrollSpeed:p=.5,panOnScrollMode:g=PanOnScrollMode.Free,zoomOnDoubleClick:x=!0,elementsSelectable:f,panOnDrag:b=!0,defaultViewport:C,translateExtent:S,minZoom:k,maxZoom:l,zoomActivationKeyCode:s,preventScrolling:y=!0,children:A,noWheelClassName:E,noPanClassName:T})=>{const u=reactExports.useRef(),_=useStoreApi(),M=reactExports.useRef(!1),R=reactExports.useRef(!1),N=reactExports.useRef(null),I=reactExports.useRef({x:0,y:0,zoom:0}),{d3Zoom:L,d3Selection:Y,d3ZoomHandler:B,userSelectionActive:D}=useStore(selector$a,shallow$1),H=useKeyPress(s),W=reactExports.useRef(0),q=reactExports.useRef(!1),V=reactExports.useRef();return useResizeHandler(N),reactExports.useEffect(()=>{if(N.current){const $=N.current.getBoundingClientRect(),O=zoom().scaleExtent([k,l]).translateExtent(S),j=select(N.current).call(O),J=identity.translate(C.x,C.y).scale(clamp(C.zoom,k,l)),oe=[[0,0],[$.width,$.height]],ie=O.constrain()(J,oe,S);O.transform(j,ie),O.wheelDelta(wheelDelta),_.setState({d3Zoom:O,d3Selection:j,d3ZoomHandler:j.on("wheel.zoom"),transform:[ie.x,ie.y,ie.k],domNode:N.current.closest(".react-flow")})}},[]),reactExports.useEffect(()=>{Y&&L&&(v&&!H&&!D?Y.on("wheel.zoom",$=>{if(isWrappedWithClass($,E))return!1;$.preventDefault(),$.stopImmediatePropagation();const O=Y.property("__zoom").k||1;if($.ctrlKey&&h){const ue=pointer($),ye=wheelDelta($),ze=O*Math.pow(2,ye);L.scaleTo(Y,ze,ue,$);return}const j=$.deltaMode===1?20:1;let J=g===PanOnScrollMode.Vertical?0:$.deltaX*j,oe=g===PanOnScrollMode.Horizontal?0:$.deltaY*j;!isMacOs()&&$.shiftKey&&g!==PanOnScrollMode.Vertical&&(J=$.deltaY*j,oe=0),L.translateBy(Y,-(J/O)*p,-(oe/O)*p,{internal:!0});const ie=eventToFlowTransform(Y.property("__zoom")),{onViewportChangeStart:he,onViewportChange:de,onViewportChangeEnd:fe}=_.getState();clearTimeout(V.current),q.current||(q.current=!0,e?.($,ie),he?.(ie)),q.current&&(r?.($,ie),de?.(ie),V.current=setTimeout(()=>{t?.($,ie),fe?.(ie),q.current=!1},150))},{passive:!1}):typeof B<"u"&&Y.on("wheel.zoom",function($,O){if(!y&&$.type==="wheel"&&!$.ctrlKey||isWrappedWithClass($,E))return null;$.preventDefault(),B.call(this,$,O)},{passive:!1}))},[D,v,g,Y,L,B,H,h,y,E,e,r,t]),reactExports.useEffect(()=>{L&&L.on("start",$=>{if(!$.sourceEvent||$.sourceEvent.internal)return null;W.current=$.sourceEvent?.button;const{onViewportChangeStart:O}=_.getState(),j=eventToFlowTransform($.transform);M.current=!0,I.current=j,$.sourceEvent?.type==="mousedown"&&_.setState({paneDragging:!0}),O?.(j),e?.($.sourceEvent,j)})},[L,e]),reactExports.useEffect(()=>{L&&(D&&!M.current?L.on("zoom",null):D||L.on("zoom",$=>{const{onViewportChange:O}=_.getState();if(_.setState({transform:[$.transform.x,$.transform.y,$.transform.k]}),R.current=!!(o&&isRightClickPan(b,W.current??0)),(r||O)&&!$.sourceEvent?.internal){const j=eventToFlowTransform($.transform);O?.(j),r?.($.sourceEvent,j)}}))},[D,L,r,b,o]),reactExports.useEffect(()=>{L&&L.on("end",$=>{if(!$.sourceEvent||$.sourceEvent.internal)return null;const{onViewportChangeEnd:O}=_.getState();if(M.current=!1,_.setState({paneDragging:!1}),o&&isRightClickPan(b,W.current??0)&&!R.current&&o($.sourceEvent),R.current=!1,(t||O)&&viewChanged(I.current,$.transform)){const j=eventToFlowTransform($.transform);I.current=j,clearTimeout(u.current),u.current=setTimeout(()=>{O?.(j),t?.($.sourceEvent,j)},v?150:0)}})},[L,v,b,t,o]),reactExports.useEffect(()=>{L&&L.filter($=>{const O=H||c,j=h&&$.ctrlKey;if((b===!0||Array.isArray(b)&&b.includes(1))&&$.button===1&&$.type==="mousedown"&&(isWrappedWithClass($,"react-flow__node")||isWrappedWithClass($,"react-flow__edge")))return!0;if(!b&&!O&&!v&&!x&&!h||D||!x&&$.type==="dblclick"||isWrappedWithClass($,E)&&$.type==="wheel"||isWrappedWithClass($,T)&&($.type!=="wheel"||v&&$.type==="wheel"&&!H)||!h&&$.ctrlKey&&$.type==="wheel"||!O&&!v&&!j&&$.type==="wheel"||!b&&($.type==="mousedown"||$.type==="touchstart")||Array.isArray(b)&&!b.includes($.button)&&$.type==="mousedown")return!1;const J=Array.isArray(b)&&b.includes($.button)||!$.button||$.button<=1;return(!$.ctrlKey||$.type==="wheel")&&J})},[D,L,c,h,v,x,b,f,H]),React.createElement("div",{className:"react-flow__renderer",ref:N,style:containerStyle},A)},selector$9=r=>({userSelectionActive:r.userSelectionActive,userSelectionRect:r.userSelectionRect});function UserSelection(){const{userSelectionActive:r,userSelectionRect:e}=useStore(selector$9,shallow$1);return r&&e?React.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}function handleParentExpand(r,e){const t=e.parentNode||e.parentId,o=r.find(c=>c.id===t);if(o){const c=e.position.x+e.width-o.width,h=e.position.y+e.height-o.height;if(c>0||h>0||e.position.x<0||e.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,c>0&&(o.style.width+=c),h>0&&(o.style.height+=h),e.position.x<0){const v=Math.abs(e.position.x);o.position.x=o.position.x-v,o.style.width+=v,e.position.x=0}if(e.position.y<0){const v=Math.abs(e.position.y);o.position.y=o.position.y-v,o.style.height+=v,e.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function applyChanges(r,e){if(r.some(o=>o.type==="reset"))return r.filter(o=>o.type==="reset").map(o=>o.item);const t=r.filter(o=>o.type==="add").map(o=>o.item);return e.reduce((o,c)=>{const h=r.filter(p=>p.id===c.id);if(h.length===0)return o.push(c),o;const v={...c};for(const p of h)if(p)switch(p.type){case"select":{v.selected=p.selected;break}case"position":{typeof p.position<"u"&&(v.position=p.position),typeof p.positionAbsolute<"u"&&(v.positionAbsolute=p.positionAbsolute),typeof p.dragging<"u"&&(v.dragging=p.dragging),v.expandParent&&handleParentExpand(o,v);break}case"dimensions":{typeof p.dimensions<"u"&&(v.width=p.dimensions.width,v.height=p.dimensions.height),typeof p.updateStyle<"u"&&(v.style={...v.style||{},...p.dimensions}),typeof p.resizing=="boolean"&&(v.resizing=p.resizing),v.expandParent&&handleParentExpand(o,v);break}case"remove":return o}return o.push(v),o},t)}function applyNodeChanges(r,e){return applyChanges(r,e)}function applyEdgeChanges(r,e){return applyChanges(r,e)}const createSelectionChange=(r,e)=>({id:r,type:"select",selected:e});function getSelectionChanges(r,e){return r.reduce((t,o)=>{const c=e.includes(o.id);return!o.selected&&c?(o.selected=!0,t.push(createSelectionChange(o.id,!0))):o.selected&&!c&&(o.selected=!1,t.push(createSelectionChange(o.id,!1))),t},[])}const wrapHandler=(r,e)=>t=>{t.target===e.current&&r?.(t)},selector$8=r=>({userSelectionActive:r.userSelectionActive,elementsSelectable:r.elementsSelectable,dragging:r.paneDragging}),Pane=reactExports.memo(({isSelecting:r,selectionMode:e=SelectionMode.Full,panOnDrag:t,onSelectionStart:o,onSelectionEnd:c,onPaneClick:h,onPaneContextMenu:v,onPaneScroll:p,onPaneMouseEnter:g,onPaneMouseMove:x,onPaneMouseLeave:f,children:b})=>{const C=reactExports.useRef(null),S=useStoreApi(),k=reactExports.useRef(0),l=reactExports.useRef(0),s=reactExports.useRef(),{userSelectionActive:y,elementsSelectable:A,dragging:E}=useStore(selector$8,shallow$1),T=()=>{S.setState({userSelectionActive:!1,userSelectionRect:null}),k.current=0,l.current=0},u=B=>{h?.(B),S.getState().resetSelectedElements(),S.setState({nodesSelectionActive:!1})},_=B=>{if(Array.isArray(t)&&t?.includes(2)){B.preventDefault();return}v?.(B)},M=p?B=>p(B):void 0,R=B=>{const{resetSelectedElements:D,domNode:H}=S.getState();if(s.current=H?.getBoundingClientRect(),!A||!r||B.button!==0||B.target!==C.current||!s.current)return;const{x:W,y:q}=getEventPosition(B,s.current);D(),S.setState({userSelectionRect:{width:0,height:0,startX:W,startY:q,x:W,y:q}}),o?.(B)},N=B=>{const{userSelectionRect:D,nodeInternals:H,edges:W,transform:q,onNodesChange:V,onEdgesChange:$,nodeOrigin:O,getNodes:j}=S.getState();if(!r||!s.current||!D)return;S.setState({userSelectionActive:!0,nodesSelectionActive:!1});const J=getEventPosition(B,s.current),oe=D.startX??0,ie=D.startY??0,he={...D,x:J.x<oe?J.x:oe,y:J.y<ie?J.y:ie,width:Math.abs(J.x-oe),height:Math.abs(J.y-ie)},de=j(),fe=getNodesInside(H,he,q,e===SelectionMode.Partial,!0,O),ue=getConnectedEdges(fe,W).map(ze=>ze.id),ye=fe.map(ze=>ze.id);if(k.current!==ye.length){k.current=ye.length;const ze=getSelectionChanges(de,ye);ze.length&&V?.(ze)}if(l.current!==ue.length){l.current=ue.length;const ze=getSelectionChanges(W,ue);ze.length&&$?.(ze)}S.setState({userSelectionRect:he})},I=B=>{if(B.button!==0)return;const{userSelectionRect:D}=S.getState();!y&&D&&B.target===C.current&&u?.(B),S.setState({nodesSelectionActive:k.current>0}),T(),c?.(B)},L=B=>{y&&(S.setState({nodesSelectionActive:k.current>0}),c?.(B)),T()},Y=A&&(r||y);return React.createElement("div",{className:cc$1(["react-flow__pane",{dragging:E,selection:r}]),onClick:Y?void 0:wrapHandler(u,C),onContextMenu:wrapHandler(_,C),onWheel:wrapHandler(M,C),onMouseEnter:Y?void 0:g,onMouseDown:Y?R:void 0,onMouseMove:Y?N:x,onMouseUp:Y?I:void 0,onMouseLeave:Y?L:f,ref:C,style:containerStyle},b,React.createElement(UserSelection,null))});Pane.displayName="Pane";function isParentSelected(r,e){const t=r.parentNode||r.parentId;if(!t)return!1;const o=e.get(t);return o?o.selected?!0:isParentSelected(o,e):!1}function hasSelector(r,e,t){let o=r;do{if(o?.matches(e))return!0;if(o===t.current)return!1;o=o.parentElement}while(o);return!1}function getDragItems(r,e,t,o){return Array.from(r.values()).filter(c=>(c.selected||c.id===o)&&(!c.parentNode||c.parentId||!isParentSelected(c,r))&&(c.draggable||e&&typeof c.draggable>"u")).map(c=>({id:c.id,position:c.position||{x:0,y:0},positionAbsolute:c.positionAbsolute||{x:0,y:0},distance:{x:t.x-(c.positionAbsolute?.x??0),y:t.y-(c.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:c.extent,parentNode:c.parentNode||c.parentId,parentId:c.parentNode||c.parentId,width:c.width,height:c.height,expandParent:c.expandParent}))}function clampNodeExtent(r,e){return!e||e==="parent"?e:[e[0],[e[1][0]-(r.width||0),e[1][1]-(r.height||0)]]}function calcNextPosition(r,e,t,o,c=[0,0],h){const v=clampNodeExtent(r,r.extent||o);let p=v;const g=r.parentNode||r.parentId;if(r.extent==="parent"&&!r.expandParent)if(g&&r.width&&r.height){const b=t.get(g),{x:C,y:S}=getNodePositionWithOrigin(b,c).positionAbsolute;p=b&&isNumeric(C)&&isNumeric(S)&&isNumeric(b.width)&&isNumeric(b.height)?[[C+r.width*c[0],S+r.height*c[1]],[C+b.width-r.width+r.width*c[0],S+b.height-r.height+r.height*c[1]]]:p}else h?.("005",errorMessages.error005()),p=v;else if(r.extent&&g&&r.extent!=="parent"){const b=t.get(g),{x:C,y:S}=getNodePositionWithOrigin(b,c).positionAbsolute;p=[[r.extent[0][0]+C,r.extent[0][1]+S],[r.extent[1][0]+C,r.extent[1][1]+S]]}let x={x:0,y:0};if(g){const b=t.get(g);x=getNodePositionWithOrigin(b,c).positionAbsolute}const f=p&&p!=="parent"?clampPosition(e,p):e;return{position:{x:f.x-x.x,y:f.y-x.y},positionAbsolute:f}}function getEventHandlerParams({nodeId:r,dragItems:e,nodeInternals:t}){const o=e.map(c=>({...t.get(c.id),position:c.position,positionAbsolute:c.positionAbsolute}));return[r?o.find(c=>c.id===r):o[0],o]}const getHandleBounds=(r,e,t,o)=>{const c=e.querySelectorAll(r);if(!c||!c.length)return null;const h=Array.from(c),v=e.getBoundingClientRect(),p={x:v.width*o[0],y:v.height*o[1]};return h.map(g=>{const x=g.getBoundingClientRect();return{id:g.getAttribute("data-handleid"),position:g.getAttribute("data-handlepos"),x:(x.left-v.left-p.x)/t,y:(x.top-v.top-p.y)/t,...getDimensions(g)}})};function getMouseHandler(r,e,t){return t===void 0?t:o=>{const c=e().nodeInternals.get(r);c&&t(o,{...c})}}function handleNodeClick({id:r,store:e,unselect:t=!1,nodeRef:o}){const{addSelectedNodes:c,unselectNodesAndEdges:h,multiSelectionActive:v,nodeInternals:p,onError:g}=e.getState(),x=p.get(r);if(!x){g?.("012",errorMessages.error012(r));return}e.setState({nodesSelectionActive:!1}),x.selected?(t||x.selected&&v)&&(h({nodes:[x],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):c([r])}function useGetPointerPosition(){const r=useStoreApi();return reactExports.useCallback(({sourceEvent:t})=>{const{transform:o,snapGrid:c,snapToGrid:h}=r.getState(),v=t.touches?t.touches[0].clientX:t.clientX,p=t.touches?t.touches[0].clientY:t.clientY,g={x:(v-o[0])/o[2],y:(p-o[1])/o[2]};return{xSnapped:h?c[0]*Math.round(g.x/c[0]):g.x,ySnapped:h?c[1]*Math.round(g.y/c[1]):g.y,...g}},[])}function wrapSelectionDragFunc(r){return(e,t,o)=>r?.(e,o)}function useDrag({nodeRef:r,disabled:e=!1,noDragClassName:t,handleSelector:o,nodeId:c,isSelectable:h,selectNodesOnDrag:v}){const p=useStoreApi(),[g,x]=reactExports.useState(!1),f=reactExports.useRef([]),b=reactExports.useRef({x:null,y:null}),C=reactExports.useRef(0),S=reactExports.useRef(null),k=reactExports.useRef({x:0,y:0}),l=reactExports.useRef(null),s=reactExports.useRef(!1),y=reactExports.useRef(!1),A=reactExports.useRef(!1),E=useGetPointerPosition();return reactExports.useEffect(()=>{if(r?.current){const T=select(r.current),u=({x:R,y:N})=>{const{nodeInternals:I,onNodeDrag:L,onSelectionDrag:Y,updateNodePositions:B,nodeExtent:D,snapGrid:H,snapToGrid:W,nodeOrigin:q,onError:V}=p.getState();b.current={x:R,y:N};let $=!1,O={x:0,y:0,x2:0,y2:0};if(f.current.length>1&&D){const J=getNodesBounds(f.current,q);O=rectToBox(J)}if(f.current=f.current.map(J=>{const oe={x:R-J.distance.x,y:N-J.distance.y};W&&(oe.x=H[0]*Math.round(oe.x/H[0]),oe.y=H[1]*Math.round(oe.y/H[1]));const ie=[[D[0][0],D[0][1]],[D[1][0],D[1][1]]];f.current.length>1&&D&&!J.extent&&(ie[0][0]=J.positionAbsolute.x-O.x+D[0][0],ie[1][0]=J.positionAbsolute.x+(J.width??0)-O.x2+D[1][0],ie[0][1]=J.positionAbsolute.y-O.y+D[0][1],ie[1][1]=J.positionAbsolute.y+(J.height??0)-O.y2+D[1][1]);const he=calcNextPosition(J,oe,I,ie,q,V);return $=$||J.position.x!==he.position.x||J.position.y!==he.position.y,J.position=he.position,J.positionAbsolute=he.positionAbsolute,J}),!$)return;B(f.current,!0,!0),x(!0);const j=c?L:wrapSelectionDragFunc(Y);if(j&&l.current){const[J,oe]=getEventHandlerParams({nodeId:c,dragItems:f.current,nodeInternals:I});j(l.current,J,oe)}},_=()=>{if(!S.current)return;const[R,N]=calcAutoPan(k.current,S.current);if(R!==0||N!==0){const{transform:I,panBy:L}=p.getState();b.current.x=(b.current.x??0)-R/I[2],b.current.y=(b.current.y??0)-N/I[2],L({x:R,y:N})&&u(b.current)}C.current=requestAnimationFrame(_)},M=R=>{const{nodeInternals:N,multiSelectionActive:I,nodesDraggable:L,unselectNodesAndEdges:Y,onNodeDragStart:B,onSelectionDragStart:D}=p.getState();y.current=!0;const H=c?B:wrapSelectionDragFunc(D);(!v||!h)&&!I&&c&&(N.get(c)?.selected||Y()),c&&h&&v&&handleNodeClick({id:c,store:p,nodeRef:r});const W=E(R);if(b.current=W,f.current=getDragItems(N,L,W,c),H&&f.current){const[q,V]=getEventHandlerParams({nodeId:c,dragItems:f.current,nodeInternals:N});H(R.sourceEvent,q,V)}};if(e)T.on(".drag",null);else{const R=drag().on("start",N=>{const{domNode:I,nodeDragThreshold:L}=p.getState();L===0&&M(N),A.current=!1;const Y=E(N);b.current=Y,S.current=I?.getBoundingClientRect()||null,k.current=getEventPosition(N.sourceEvent,S.current)}).on("drag",N=>{const I=E(N),{autoPanOnNodeDrag:L,nodeDragThreshold:Y}=p.getState();if(N.sourceEvent.type==="touchmove"&&N.sourceEvent.touches.length>1&&(A.current=!0),!A.current){if(!s.current&&y.current&&L&&(s.current=!0,_()),!y.current){const B=I.xSnapped-(b?.current?.x??0),D=I.ySnapped-(b?.current?.y??0);Math.sqrt(B*B+D*D)>Y&&M(N)}(b.current.x!==I.xSnapped||b.current.y!==I.ySnapped)&&f.current&&y.current&&(l.current=N.sourceEvent,k.current=getEventPosition(N.sourceEvent,S.current),u(I))}}).on("end",N=>{if(!(!y.current||A.current)&&(x(!1),s.current=!1,y.current=!1,cancelAnimationFrame(C.current),f.current)){const{updateNodePositions:I,nodeInternals:L,onNodeDragStop:Y,onSelectionDragStop:B}=p.getState(),D=c?Y:wrapSelectionDragFunc(B);if(I(f.current,!1,!1),D){const[H,W]=getEventHandlerParams({nodeId:c,dragItems:f.current,nodeInternals:L});D(N.sourceEvent,H,W)}}}).filter(N=>{const I=N.target;return!N.button&&(!t||!hasSelector(I,`.${t}`,r))&&(!o||hasSelector(I,o,r))});return T.call(R),()=>{T.on(".drag",null)}}}},[r,e,t,o,h,p,c,v,E]),g}function useUpdateNodePositions(){const r=useStoreApi();return reactExports.useCallback(t=>{const{nodeInternals:o,nodeExtent:c,updateNodePositions:h,getNodes:v,snapToGrid:p,snapGrid:g,onError:x,nodesDraggable:f}=r.getState(),b=v().filter(A=>A.selected&&(A.draggable||f&&typeof A.draggable>"u")),C=p?g[0]:5,S=p?g[1]:5,k=t.isShiftPressed?4:1,l=t.x*C*k,s=t.y*S*k,y=b.map(A=>{if(A.positionAbsolute){const E={x:A.positionAbsolute.x+l,y:A.positionAbsolute.y+s};p&&(E.x=g[0]*Math.round(E.x/g[0]),E.y=g[1]*Math.round(E.y/g[1]));const{positionAbsolute:T,position:u}=calcNextPosition(A,E,o,c,void 0,x);A.position=u,A.positionAbsolute=T}return A});h(y,!0,!1)},[])}const arrowKeyDiffs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var wrapNode=r=>{const e=({id:t,type:o,data:c,xPos:h,yPos:v,xPosOrigin:p,yPosOrigin:g,selected:x,onClick:f,onMouseEnter:b,onMouseMove:C,onMouseLeave:S,onContextMenu:k,onDoubleClick:l,style:s,className:y,isDraggable:A,isSelectable:E,isConnectable:T,isFocusable:u,selectNodesOnDrag:_,sourcePosition:M,targetPosition:R,hidden:N,resizeObserver:I,dragHandle:L,zIndex:Y,isParent:B,noDragClassName:D,noPanClassName:H,initialized:W,disableKeyboardA11y:q,ariaLabel:V,rfId:$,hasHandleBounds:O})=>{const j=useStoreApi(),J=reactExports.useRef(null),oe=reactExports.useRef(null),ie=reactExports.useRef(M),he=reactExports.useRef(R),de=reactExports.useRef(o),fe=E||A||f||b||C||S,ue=useUpdateNodePositions(),ye=getMouseHandler(t,j.getState,b),ze=getMouseHandler(t,j.getState,C),$e=getMouseHandler(t,j.getState,S),We=getMouseHandler(t,j.getState,k),Fe=getMouseHandler(t,j.getState,l),me=Je=>{const{nodeDragThreshold:Ye}=j.getState();if(E&&(!_||!A||Ye>0)&&handleNodeClick({id:t,store:j,nodeRef:J}),f){const nt=j.getState().nodeInternals.get(t);nt&&f(Je,{...nt})}},ke=Je=>{if(!isInputDOMNode(Je)&&!q)if(elementSelectionKeys.includes(Je.key)&&E){const Ye=Je.key==="Escape";handleNodeClick({id:t,store:j,unselect:Ye,nodeRef:J})}else A&&x&&Object.prototype.hasOwnProperty.call(arrowKeyDiffs,Je.key)&&(j.setState({ariaLiveMessage:`Moved selected node ${Je.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~h}, y: ${~~v}`}),ue({x:arrowKeyDiffs[Je.key].x,y:arrowKeyDiffs[Je.key].y,isShiftPressed:Je.shiftKey}))};reactExports.useEffect(()=>()=>{oe.current&&(I?.unobserve(oe.current),oe.current=null)},[]),reactExports.useEffect(()=>{if(J.current&&!N){const Je=J.current;(!W||!O||oe.current!==Je)&&(oe.current&&I?.unobserve(oe.current),I?.observe(Je),oe.current=Je)}},[N,W,O]),reactExports.useEffect(()=>{const Je=de.current!==o,Ye=ie.current!==M,nt=he.current!==R;J.current&&(Je||Ye||nt)&&(Je&&(de.current=o),Ye&&(ie.current=M),nt&&(he.current=R),j.getState().updateNodeDimensions([{id:t,nodeElement:J.current,forceUpdate:!0}]))},[t,o,M,R]);const Qe=useDrag({nodeRef:J,disabled:N||!A,noDragClassName:D,handleSelector:L,nodeId:t,isSelectable:E,selectNodesOnDrag:_});return N?null:React.createElement("div",{className:cc$1(["react-flow__node",`react-flow__node-${o}`,{[H]:A},y,{selected:x,selectable:E,parent:B,dragging:Qe}]),ref:J,style:{zIndex:Y,transform:`translate(${p}px,${g}px)`,pointerEvents:fe?"all":"none",visibility:W?"visible":"hidden",...s},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:ye,onMouseMove:ze,onMouseLeave:$e,onContextMenu:We,onClick:me,onDoubleClick:Fe,onKeyDown:u?ke:void 0,tabIndex:u?0:void 0,role:u?"button":void 0,"aria-describedby":q?void 0:`${ARIA_NODE_DESC_KEY}-${$}`,"aria-label":V},React.createElement(Provider$2,{value:t},React.createElement(r,{id:t,data:c,type:o,xPos:h,yPos:v,selected:x,isConnectable:T,sourcePosition:M,targetPosition:R,dragging:Qe,dragHandle:L,zIndex:Y})))};return e.displayName="NodeWrapper",reactExports.memo(e)};const selector$7=r=>{const e=r.getNodes().filter(t=>t.selected);return{...getNodesBounds(e,r.nodeOrigin),transformString:`translate(${r.transform[0]}px,${r.transform[1]}px) scale(${r.transform[2]})`,userSelectionActive:r.userSelectionActive}};function NodesSelection({onSelectionContextMenu:r,noPanClassName:e,disableKeyboardA11y:t}){const o=useStoreApi(),{width:c,height:h,x:v,y:p,transformString:g,userSelectionActive:x}=useStore(selector$7,shallow$1),f=useUpdateNodePositions(),b=reactExports.useRef(null);if(reactExports.useEffect(()=>{t||b.current?.focus({preventScroll:!0})},[t]),useDrag({nodeRef:b}),x||!c||!h)return null;const C=r?k=>{const l=o.getState().getNodes().filter(s=>s.selected);r(k,l)}:void 0,S=k=>{Object.prototype.hasOwnProperty.call(arrowKeyDiffs,k.key)&&f({x:arrowKeyDiffs[k.key].x,y:arrowKeyDiffs[k.key].y,isShiftPressed:k.shiftKey})};return React.createElement("div",{className:cc$1(["react-flow__nodesselection","react-flow__container",e]),style:{transform:g}},React.createElement("div",{ref:b,className:"react-flow__nodesselection-rect",onContextMenu:C,tabIndex:t?void 0:-1,onKeyDown:t?void 0:S,style:{width:c,height:h,top:p,left:v}}))}var NodesSelection$1=reactExports.memo(NodesSelection);const selector$6=r=>r.nodesSelectionActive,FlowRenderer=({children:r,onPaneClick:e,onPaneMouseEnter:t,onPaneMouseMove:o,onPaneMouseLeave:c,onPaneContextMenu:h,onPaneScroll:v,deleteKeyCode:p,onMove:g,onMoveStart:x,onMoveEnd:f,selectionKeyCode:b,selectionOnDrag:C,selectionMode:S,onSelectionStart:k,onSelectionEnd:l,multiSelectionKeyCode:s,panActivationKeyCode:y,zoomActivationKeyCode:A,elementsSelectable:E,zoomOnScroll:T,zoomOnPinch:u,panOnScroll:_,panOnScrollSpeed:M,panOnScrollMode:R,zoomOnDoubleClick:N,panOnDrag:I,defaultViewport:L,translateExtent:Y,minZoom:B,maxZoom:D,preventScrolling:H,onSelectionContextMenu:W,noWheelClassName:q,noPanClassName:V,disableKeyboardA11y:$})=>{const O=useStore(selector$6),j=useKeyPress(b),J=useKeyPress(y),oe=J||I,ie=J||_,he=j||C&&oe!==!0;return useGlobalKeyHandler({deleteKeyCode:p,multiSelectionKeyCode:s}),React.createElement(ZoomPane,{onMove:g,onMoveStart:x,onMoveEnd:f,onPaneContextMenu:h,elementsSelectable:E,zoomOnScroll:T,zoomOnPinch:u,panOnScroll:ie,panOnScrollSpeed:M,panOnScrollMode:R,zoomOnDoubleClick:N,panOnDrag:!j&&oe,defaultViewport:L,translateExtent:Y,minZoom:B,maxZoom:D,zoomActivationKeyCode:A,preventScrolling:H,noWheelClassName:q,noPanClassName:V},React.createElement(Pane,{onSelectionStart:k,onSelectionEnd:l,onPaneClick:e,onPaneMouseEnter:t,onPaneMouseMove:o,onPaneMouseLeave:c,onPaneContextMenu:h,onPaneScroll:v,panOnDrag:oe,isSelecting:!!he,selectionMode:S},r,O&&React.createElement(NodesSelection$1,{onSelectionContextMenu:W,noPanClassName:V,disableKeyboardA11y:$})))};FlowRenderer.displayName="FlowRenderer";var FlowRenderer$1=reactExports.memo(FlowRenderer);function useVisibleNodes(r){return useStore(reactExports.useCallback(t=>r?getNodesInside(t.nodeInternals,{x:0,y:0,width:t.width,height:t.height},t.transform,!0):t.getNodes(),[r]))}function createNodeTypes(r){const e={input:wrapNode(r.input||InputNode$1),default:wrapNode(r.default||DefaultNode$1),output:wrapNode(r.output||OutputNode$1),group:wrapNode(r.group||GroupNode)},t={},o=Object.keys(r).filter(c=>!["input","default","output","group"].includes(c)).reduce((c,h)=>(c[h]=wrapNode(r[h]||DefaultNode$1),c),t);return{...e,...o}}const getPositionWithOrigin=({x:r,y:e,width:t,height:o,origin:c})=>!t||!o?{x:r,y:e}:c[0]<0||c[1]<0||c[0]>1||c[1]>1?{x:r,y:e}:{x:r-t*c[0],y:e-o*c[1]},selector$5=r=>({nodesDraggable:r.nodesDraggable,nodesConnectable:r.nodesConnectable,nodesFocusable:r.nodesFocusable,elementsSelectable:r.elementsSelectable,updateNodeDimensions:r.updateNodeDimensions,onError:r.onError}),NodeRenderer=r=>{const{nodesDraggable:e,nodesConnectable:t,nodesFocusable:o,elementsSelectable:c,updateNodeDimensions:h,onError:v}=useStore(selector$5,shallow$1),p=useVisibleNodes(r.onlyRenderVisibleElements),g=reactExports.useRef(),x=reactExports.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const f=new ResizeObserver(b=>{const C=b.map(S=>({id:S.target.getAttribute("data-id"),nodeElement:S.target,forceUpdate:!0}));h(C)});return g.current=f,f},[]);return reactExports.useEffect(()=>()=>{g?.current?.disconnect()},[]),React.createElement("div",{className:"react-flow__nodes",style:containerStyle},p.map(f=>{let b=f.type||"default";r.nodeTypes[b]||(v?.("003",errorMessages.error003(b)),b="default");const C=r.nodeTypes[b]||r.nodeTypes.default,S=!!(f.draggable||e&&typeof f.draggable>"u"),k=!!(f.selectable||c&&typeof f.selectable>"u"),l=!!(f.connectable||t&&typeof f.connectable>"u"),s=!!(f.focusable||o&&typeof f.focusable>"u"),y=r.nodeExtent?clampPosition(f.positionAbsolute,r.nodeExtent):f.positionAbsolute,A=y?.x??0,E=y?.y??0,T=getPositionWithOrigin({x:A,y:E,width:f.width??0,height:f.height??0,origin:r.nodeOrigin});return React.createElement(C,{key:f.id,id:f.id,className:f.className,style:f.style,type:b,data:f.data,sourcePosition:f.sourcePosition||Position.Bottom,targetPosition:f.targetPosition||Position.Top,hidden:f.hidden,xPos:A,yPos:E,xPosOrigin:T.x,yPosOrigin:T.y,selectNodesOnDrag:r.selectNodesOnDrag,onClick:r.onNodeClick,onMouseEnter:r.onNodeMouseEnter,onMouseMove:r.onNodeMouseMove,onMouseLeave:r.onNodeMouseLeave,onContextMenu:r.onNodeContextMenu,onDoubleClick:r.onNodeDoubleClick,selected:!!f.selected,isDraggable:S,isSelectable:k,isConnectable:l,isFocusable:s,resizeObserver:x,dragHandle:f.dragHandle,zIndex:f[internalsSymbol]?.z??0,isParent:!!f[internalsSymbol]?.isParent,noDragClassName:r.noDragClassName,noPanClassName:r.noPanClassName,initialized:!!f.width&&!!f.height,rfId:r.rfId,disableKeyboardA11y:r.disableKeyboardA11y,ariaLabel:f.ariaLabel,hasHandleBounds:!!f[internalsSymbol]?.handleBounds})}))};NodeRenderer.displayName="NodeRenderer";var NodeRenderer$1=reactExports.memo(NodeRenderer);const shiftX=(r,e,t)=>t===Position.Left?r-e:t===Position.Right?r+e:r,shiftY=(r,e,t)=>t===Position.Top?r-e:t===Position.Bottom?r+e:r,EdgeUpdaterClassName="react-flow__edgeupdater",EdgeAnchor=({position:r,centerX:e,centerY:t,radius:o=10,onMouseDown:c,onMouseEnter:h,onMouseOut:v,type:p})=>React.createElement("circle",{onMouseDown:c,onMouseEnter:h,onMouseOut:v,className:cc$1([EdgeUpdaterClassName,`${EdgeUpdaterClassName}-${p}`]),cx:shiftX(e,o,r),cy:shiftY(t,o,r),r:o,stroke:"transparent",fill:"transparent"}),alwaysValidConnection=()=>!0;var wrapEdge=r=>{const e=({id:t,className:o,type:c,data:h,onClick:v,onEdgeDoubleClick:p,selected:g,animated:x,label:f,labelStyle:b,labelShowBg:C,labelBgStyle:S,labelBgPadding:k,labelBgBorderRadius:l,style:s,source:y,target:A,sourceX:E,sourceY:T,targetX:u,targetY:_,sourcePosition:M,targetPosition:R,elementsSelectable:N,hidden:I,sourceHandleId:L,targetHandleId:Y,onContextMenu:B,onMouseEnter:D,onMouseMove:H,onMouseLeave:W,reconnectRadius:q,onReconnect:V,onReconnectStart:$,onReconnectEnd:O,markerEnd:j,markerStart:J,rfId:oe,ariaLabel:ie,isFocusable:he,isReconnectable:de,pathOptions:fe,interactionWidth:ue,disableKeyboardA11y:ye})=>{const ze=reactExports.useRef(null),[$e,We]=reactExports.useState(!1),[Fe,me]=reactExports.useState(!1),ke=useStoreApi(),Qe=reactExports.useMemo(()=>`url('#${getMarkerId(J,oe)}')`,[J,oe]),Je=reactExports.useMemo(()=>`url('#${getMarkerId(j,oe)}')`,[j,oe]);if(I)return null;const Ye=we=>{const{edges:Xe,addSelectedEdges:je,unselectNodesAndEdges:K,multiSelectionActive:xe}=ke.getState(),Me=Xe.find(Ze=>Ze.id===t);Me&&(N&&(ke.setState({nodesSelectionActive:!1}),Me.selected&&xe?(K({nodes:[],edges:[Me]}),ze.current?.blur()):je([t])),v&&v(we,Me))},nt=getMouseHandler$1(t,ke.getState,p),rt=getMouseHandler$1(t,ke.getState,B),et=getMouseHandler$1(t,ke.getState,D),Ke=getMouseHandler$1(t,ke.getState,H),Ue=getMouseHandler$1(t,ke.getState,W),He=(we,Xe)=>{if(we.button!==0)return;const{edges:je,isValidConnection:K}=ke.getState(),xe=Xe?A:y,Me=(Xe?Y:L)||null,Ze=Xe?"target":"source",_e=K||alwaysValidConnection,Ve=Xe,ee=je.find(X=>X.id===t);me(!0),$?.(we,ee,Ze);const Pe=X=>{me(!1),O?.(X,ee,Ze)};handlePointerDown({event:we,handleId:Me,nodeId:xe,onConnect:X=>V?.(ee,X),isTarget:Ve,getState:ke.getState,setState:ke.setState,isValidConnection:_e,edgeUpdaterType:Ze,onReconnectEnd:Pe})},mt=we=>He(we,!0),ht=we=>He(we,!1),te=()=>We(!0),se=()=>We(!1),le=!N&&!v,Se=we=>{if(!ye&&elementSelectionKeys.includes(we.key)&&N){const{unselectNodesAndEdges:Xe,addSelectedEdges:je,edges:K}=ke.getState();we.key==="Escape"?(ze.current?.blur(),Xe({edges:[K.find(Me=>Me.id===t)]})):je([t])}};return React.createElement("g",{className:cc$1(["react-flow__edge",`react-flow__edge-${c}`,o,{selected:g,animated:x,inactive:le,updating:$e}]),onClick:Ye,onDoubleClick:nt,onContextMenu:rt,onMouseEnter:et,onMouseMove:Ke,onMouseLeave:Ue,onKeyDown:he?Se:void 0,tabIndex:he?0:void 0,role:he?"button":"img","data-testid":`rf__edge-${t}`,"aria-label":ie===null?void 0:ie||`Edge from ${y} to ${A}`,"aria-describedby":he?`${ARIA_EDGE_DESC_KEY}-${oe}`:void 0,ref:ze},!Fe&&React.createElement(r,{id:t,source:y,target:A,selected:g,animated:x,label:f,labelStyle:b,labelShowBg:C,labelBgStyle:S,labelBgPadding:k,labelBgBorderRadius:l,data:h,style:s,sourceX:E,sourceY:T,targetX:u,targetY:_,sourcePosition:M,targetPosition:R,sourceHandleId:L,targetHandleId:Y,markerStart:Qe,markerEnd:Je,pathOptions:fe,interactionWidth:ue}),de&&React.createElement(React.Fragment,null,(de==="source"||de===!0)&&React.createElement(EdgeAnchor,{position:M,centerX:E,centerY:T,radius:q,onMouseDown:mt,onMouseEnter:te,onMouseOut:se,type:"source"}),(de==="target"||de===!0)&&React.createElement(EdgeAnchor,{position:R,centerX:u,centerY:_,radius:q,onMouseDown:ht,onMouseEnter:te,onMouseOut:se,type:"target"})))};return e.displayName="EdgeWrapper",reactExports.memo(e)};function createEdgeTypes(r){const e={default:wrapEdge(r.default||BezierEdge),straight:wrapEdge(r.bezier||StraightEdge),step:wrapEdge(r.step||StepEdge),smoothstep:wrapEdge(r.step||SmoothStepEdge),simplebezier:wrapEdge(r.simplebezier||SimpleBezierEdge)},t={},o=Object.keys(r).filter(c=>!["default","bezier"].includes(c)).reduce((c,h)=>(c[h]=wrapEdge(r[h]||BezierEdge),c),t);return{...e,...o}}function getHandlePosition(r,e,t=null){const o=(t?.x||0)+e.x,c=(t?.y||0)+e.y,h=t?.width||e.width,v=t?.height||e.height;switch(r){case Position.Top:return{x:o+h/2,y:c};case Position.Right:return{x:o+h,y:c+v/2};case Position.Bottom:return{x:o+h/2,y:c+v};case Position.Left:return{x:o,y:c+v/2}}}function getHandle(r,e){return r?r.length===1||!e?r[0]:e&&r.find(t=>t.id===e)||null:null}const getEdgePositions=(r,e,t,o,c,h)=>{const v=getHandlePosition(t,r,e),p=getHandlePosition(h,o,c);return{sourceX:v.x,sourceY:v.y,targetX:p.x,targetY:p.y}};function isEdgeVisible({sourcePos:r,targetPos:e,sourceWidth:t,sourceHeight:o,targetWidth:c,targetHeight:h,width:v,height:p,transform:g}){const x={x:Math.min(r.x,e.x),y:Math.min(r.y,e.y),x2:Math.max(r.x+t,e.x+c),y2:Math.max(r.y+o,e.y+h)};x.x===x.x2&&(x.x2+=1),x.y===x.y2&&(x.y2+=1);const f=rectToBox({x:(0-g[0])/g[2],y:(0-g[1])/g[2],width:v/g[2],height:p/g[2]}),b=Math.max(0,Math.min(f.x2,x.x2)-Math.max(f.x,x.x)),C=Math.max(0,Math.min(f.y2,x.y2)-Math.max(f.y,x.y));return Math.ceil(b*C)>0}function getNodeData(r){const e=r?.[internalsSymbol]?.handleBounds||null,t=e&&r?.width&&r?.height&&typeof r?.positionAbsolute?.x<"u"&&typeof r?.positionAbsolute?.y<"u";return[{x:r?.positionAbsolute?.x||0,y:r?.positionAbsolute?.y||0,width:r?.width||0,height:r?.height||0},e,!!t]}const defaultEdgeTree=[{level:0,isMaxLevel:!0,edges:[]}];function groupEdgesByZLevel(r,e,t=!1){let o=-1;const c=r.reduce((v,p)=>{const g=isNumeric(p.zIndex);let x=g?p.zIndex:0;if(t){const f=e.get(p.target),b=e.get(p.source),C=p.selected||f?.selected||b?.selected,S=Math.max(b?.[internalsSymbol]?.z||0,f?.[internalsSymbol]?.z||0,1e3);x=(g?p.zIndex:0)+(C?S:0)}return v[x]?v[x].push(p):v[x]=[p],o=x>o?x:o,v},{}),h=Object.entries(c).map(([v,p])=>{const g=+v;return{edges:p,level:g,isMaxLevel:g===o}});return h.length===0?defaultEdgeTree:h}function useVisibleEdges(r,e,t){const o=useStore(reactExports.useCallback(c=>r?c.edges.filter(h=>{const v=e.get(h.source),p=e.get(h.target);return v?.width&&v?.height&&p?.width&&p?.height&&isEdgeVisible({sourcePos:v.positionAbsolute||{x:0,y:0},targetPos:p.positionAbsolute||{x:0,y:0},sourceWidth:v.width,sourceHeight:v.height,targetWidth:p.width,targetHeight:p.height,width:c.width,height:c.height,transform:c.transform})}):c.edges,[r,e]));return groupEdgesByZLevel(o,e,t)}const ArrowSymbol=({color:r="none",strokeWidth:e=1})=>React.createElement("polyline",{style:{stroke:r,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),ArrowClosedSymbol=({color:r="none",strokeWidth:e=1})=>React.createElement("polyline",{style:{stroke:r,fill:r,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),MarkerSymbols={[MarkerType.Arrow]:ArrowSymbol,[MarkerType.ArrowClosed]:ArrowClosedSymbol};function useMarkerSymbol(r){const e=useStoreApi();return reactExports.useMemo(()=>Object.prototype.hasOwnProperty.call(MarkerSymbols,r)?MarkerSymbols[r]:(e.getState().onError?.("009",errorMessages.error009(r)),null),[r])}const Marker=({id:r,type:e,color:t,width:o=12.5,height:c=12.5,markerUnits:h="strokeWidth",strokeWidth:v,orient:p="auto-start-reverse"})=>{const g=useMarkerSymbol(e);return g?React.createElement("marker",{className:"react-flow__arrowhead",id:r,markerWidth:`${o}`,markerHeight:`${c}`,viewBox:"-10 -10 20 20",markerUnits:h,orient:p,refX:"0",refY:"0"},React.createElement(g,{color:t,strokeWidth:v})):null},markerSelector=({defaultColor:r,rfId:e})=>t=>{const o=[];return t.edges.reduce((c,h)=>([h.markerStart,h.markerEnd].forEach(v=>{if(v&&typeof v=="object"){const p=getMarkerId(v,e);o.includes(p)||(c.push({id:p,color:v.color||r,...v}),o.push(p))}}),c),[]).sort((c,h)=>c.id.localeCompare(h.id))},MarkerDefinitions=({defaultColor:r,rfId:e})=>{const t=useStore(reactExports.useCallback(markerSelector({defaultColor:r,rfId:e}),[r,e]),(o,c)=>!(o.length!==c.length||o.some((h,v)=>h.id!==c[v].id)));return React.createElement("defs",null,t.map(o=>React.createElement(Marker,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};MarkerDefinitions.displayName="MarkerDefinitions";var MarkerDefinitions$1=reactExports.memo(MarkerDefinitions);const selector$4=r=>({nodesConnectable:r.nodesConnectable,edgesFocusable:r.edgesFocusable,edgesUpdatable:r.edgesUpdatable,elementsSelectable:r.elementsSelectable,width:r.width,height:r.height,connectionMode:r.connectionMode,nodeInternals:r.nodeInternals,onError:r.onError}),EdgeRenderer=({defaultMarkerColor:r,onlyRenderVisibleElements:e,elevateEdgesOnSelect:t,rfId:o,edgeTypes:c,noPanClassName:h,onEdgeContextMenu:v,onEdgeMouseEnter:p,onEdgeMouseMove:g,onEdgeMouseLeave:x,onEdgeClick:f,onEdgeDoubleClick:b,onReconnect:C,onReconnectStart:S,onReconnectEnd:k,reconnectRadius:l,children:s,disableKeyboardA11y:y})=>{const{edgesFocusable:A,edgesUpdatable:E,elementsSelectable:T,width:u,height:_,connectionMode:M,nodeInternals:R,onError:N}=useStore(selector$4,shallow$1),I=useVisibleEdges(e,R,t);return u?React.createElement(React.Fragment,null,I.map(({level:L,edges:Y,isMaxLevel:B})=>React.createElement("svg",{key:L,style:{zIndex:L},width:u,height:_,className:"react-flow__edges react-flow__container"},B&&React.createElement(MarkerDefinitions$1,{defaultColor:r,rfId:o}),React.createElement("g",null,Y.map(D=>{const[H,W,q]=getNodeData(R.get(D.source)),[V,$,O]=getNodeData(R.get(D.target));if(!q||!O)return null;let j=D.type||"default";c[j]||(N?.("011",errorMessages.error011(j)),j="default");const J=c[j]||c.default,oe=M===ConnectionMode.Strict?$.target:($.target??[]).concat($.source??[]),ie=getHandle(W.source,D.sourceHandle),he=getHandle(oe,D.targetHandle),de=ie?.position||Position.Bottom,fe=he?.position||Position.Top,ue=!!(D.focusable||A&&typeof D.focusable>"u"),ye=D.reconnectable||D.updatable,ze=typeof C<"u"&&(ye||E&&typeof ye>"u");if(!ie||!he)return N?.("008",errorMessages.error008(ie,D)),null;const{sourceX:$e,sourceY:We,targetX:Fe,targetY:me}=getEdgePositions(H,ie,de,V,he,fe);return React.createElement(J,{key:D.id,id:D.id,className:cc$1([D.className,h]),type:j,data:D.data,selected:!!D.selected,animated:!!D.animated,hidden:!!D.hidden,label:D.label,labelStyle:D.labelStyle,labelShowBg:D.labelShowBg,labelBgStyle:D.labelBgStyle,labelBgPadding:D.labelBgPadding,labelBgBorderRadius:D.labelBgBorderRadius,style:D.style,source:D.source,target:D.target,sourceHandleId:D.sourceHandle,targetHandleId:D.targetHandle,markerEnd:D.markerEnd,markerStart:D.markerStart,sourceX:$e,sourceY:We,targetX:Fe,targetY:me,sourcePosition:de,targetPosition:fe,elementsSelectable:T,onContextMenu:v,onMouseEnter:p,onMouseMove:g,onMouseLeave:x,onClick:f,onEdgeDoubleClick:b,onReconnect:C,onReconnectStart:S,onReconnectEnd:k,reconnectRadius:l,rfId:o,ariaLabel:D.ariaLabel,isFocusable:ue,isReconnectable:ze,pathOptions:"pathOptions"in D?D.pathOptions:void 0,interactionWidth:D.interactionWidth,disableKeyboardA11y:y})})))),s):null};EdgeRenderer.displayName="EdgeRenderer";var EdgeRenderer$1=reactExports.memo(EdgeRenderer);const selector$3=r=>`translate(${r.transform[0]}px,${r.transform[1]}px) scale(${r.transform[2]})`;function Viewport({children:r}){const e=useStore(selector$3);return React.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:e}},r)}function useOnInitHandler(r){const e=useReactFlow(),t=reactExports.useRef(!1);reactExports.useEffect(()=>{!t.current&&e.viewportInitialized&&r&&(setTimeout(()=>r(e),1),t.current=!0)},[r,e.viewportInitialized])}const oppositePosition={[Position.Left]:Position.Right,[Position.Right]:Position.Left,[Position.Top]:Position.Bottom,[Position.Bottom]:Position.Top},ConnectionLine=({nodeId:r,handleType:e,style:t,type:o=ConnectionLineType.Bezier,CustomComponent:c,connectionStatus:h})=>{const{fromNode:v,handleId:p,toX:g,toY:x,connectionMode:f}=useStore(reactExports.useCallback(_=>({fromNode:_.nodeInternals.get(r),handleId:_.connectionHandleId,toX:(_.connectionPosition.x-_.transform[0])/_.transform[2],toY:(_.connectionPosition.y-_.transform[1])/_.transform[2],connectionMode:_.connectionMode}),[r]),shallow$1),b=v?.[internalsSymbol]?.handleBounds;let C=b?.[e];if(f===ConnectionMode.Loose&&(C=C||b?.[e==="source"?"target":"source"]),!v||!C)return null;const S=p?C.find(_=>_.id===p):C[0],k=S?S.x+S.width/2:(v.width??0)/2,l=S?S.y+S.height/2:v.height??0,s=(v.positionAbsolute?.x??0)+k,y=(v.positionAbsolute?.y??0)+l,A=S?.position,E=A?oppositePosition[A]:null;if(!A||!E)return null;if(c)return React.createElement(c,{connectionLineType:o,connectionLineStyle:t,fromNode:v,fromHandle:S,fromX:s,fromY:y,toX:g,toY:x,fromPosition:A,toPosition:E,connectionStatus:h});let T="";const u={sourceX:s,sourceY:y,sourcePosition:A,targetX:g,targetY:x,targetPosition:E};return o===ConnectionLineType.Bezier?[T]=getBezierPath(u):o===ConnectionLineType.Step?[T]=getSmoothStepPath({...u,borderRadius:0}):o===ConnectionLineType.SmoothStep?[T]=getSmoothStepPath(u):o===ConnectionLineType.SimpleBezier?[T]=getSimpleBezierPath(u):T=`M${s},${y} ${g},${x}`,React.createElement("path",{d:T,fill:"none",className:"react-flow__connection-path",style:t})};ConnectionLine.displayName="ConnectionLine";const selector$2=r=>({nodeId:r.connectionNodeId,handleType:r.connectionHandleType,nodesConnectable:r.nodesConnectable,connectionStatus:r.connectionStatus,width:r.width,height:r.height});function ConnectionLineWrapper({containerStyle:r,style:e,type:t,component:o}){const{nodeId:c,handleType:h,nodesConnectable:v,width:p,height:g,connectionStatus:x}=useStore(selector$2,shallow$1);return!(c&&h&&p&&v)?null:React.createElement("svg",{style:r,width:p,height:g,className:"react-flow__edges react-flow__connectionline react-flow__container"},React.createElement("g",{className:cc$1(["react-flow__connection",x])},React.createElement(ConnectionLine,{nodeId:c,handleType:h,style:e,type:t,CustomComponent:o,connectionStatus:x})))}function useNodeOrEdgeTypes(r,e){return reactExports.useRef(null),useStoreApi(),reactExports.useMemo(()=>e(r),[r])}const GraphView=({nodeTypes:r,edgeTypes:e,onMove:t,onMoveStart:o,onMoveEnd:c,onInit:h,onNodeClick:v,onEdgeClick:p,onNodeDoubleClick:g,onEdgeDoubleClick:x,onNodeMouseEnter:f,onNodeMouseMove:b,onNodeMouseLeave:C,onNodeContextMenu:S,onSelectionContextMenu:k,onSelectionStart:l,onSelectionEnd:s,connectionLineType:y,connectionLineStyle:A,connectionLineComponent:E,connectionLineContainerStyle:T,selectionKeyCode:u,selectionOnDrag:_,selectionMode:M,multiSelectionKeyCode:R,panActivationKeyCode:N,zoomActivationKeyCode:I,deleteKeyCode:L,onlyRenderVisibleElements:Y,elementsSelectable:B,selectNodesOnDrag:D,defaultViewport:H,translateExtent:W,minZoom:q,maxZoom:V,preventScrolling:$,defaultMarkerColor:O,zoomOnScroll:j,zoomOnPinch:J,panOnScroll:oe,panOnScrollSpeed:ie,panOnScrollMode:he,zoomOnDoubleClick:de,panOnDrag:fe,onPaneClick:ue,onPaneMouseEnter:ye,onPaneMouseMove:ze,onPaneMouseLeave:$e,onPaneScroll:We,onPaneContextMenu:Fe,onEdgeContextMenu:me,onEdgeMouseEnter:ke,onEdgeMouseMove:Qe,onEdgeMouseLeave:Je,onReconnect:Ye,onReconnectStart:nt,onReconnectEnd:rt,reconnectRadius:et,noDragClassName:Ke,noWheelClassName:Ue,noPanClassName:He,elevateEdgesOnSelect:mt,disableKeyboardA11y:ht,nodeOrigin:te,nodeExtent:se,rfId:le})=>{const Se=useNodeOrEdgeTypes(r,createNodeTypes),we=useNodeOrEdgeTypes(e,createEdgeTypes);return useOnInitHandler(h),React.createElement(FlowRenderer$1,{onPaneClick:ue,onPaneMouseEnter:ye,onPaneMouseMove:ze,onPaneMouseLeave:$e,onPaneContextMenu:Fe,onPaneScroll:We,deleteKeyCode:L,selectionKeyCode:u,selectionOnDrag:_,selectionMode:M,onSelectionStart:l,onSelectionEnd:s,multiSelectionKeyCode:R,panActivationKeyCode:N,zoomActivationKeyCode:I,elementsSelectable:B,onMove:t,onMoveStart:o,onMoveEnd:c,zoomOnScroll:j,zoomOnPinch:J,zoomOnDoubleClick:de,panOnScroll:oe,panOnScrollSpeed:ie,panOnScrollMode:he,panOnDrag:fe,defaultViewport:H,translateExtent:W,minZoom:q,maxZoom:V,onSelectionContextMenu:k,preventScrolling:$,noDragClassName:Ke,noWheelClassName:Ue,noPanClassName:He,disableKeyboardA11y:ht},React.createElement(Viewport,null,React.createElement(EdgeRenderer$1,{edgeTypes:we,onEdgeClick:p,onEdgeDoubleClick:x,onlyRenderVisibleElements:Y,onEdgeContextMenu:me,onEdgeMouseEnter:ke,onEdgeMouseMove:Qe,onEdgeMouseLeave:Je,onReconnect:Ye,onReconnectStart:nt,onReconnectEnd:rt,reconnectRadius:et,defaultMarkerColor:O,noPanClassName:He,elevateEdgesOnSelect:!!mt,disableKeyboardA11y:ht,rfId:le},React.createElement(ConnectionLineWrapper,{style:A,type:y,component:E,containerStyle:T})),React.createElement("div",{className:"react-flow__edgelabel-renderer"}),React.createElement(NodeRenderer$1,{nodeTypes:Se,onNodeClick:v,onNodeDoubleClick:g,onNodeMouseEnter:f,onNodeMouseMove:b,onNodeMouseLeave:C,onNodeContextMenu:S,selectNodesOnDrag:D,onlyRenderVisibleElements:Y,noPanClassName:He,noDragClassName:Ke,disableKeyboardA11y:ht,nodeOrigin:te,nodeExtent:se,rfId:le})))};GraphView.displayName="GraphView";var GraphView$1=reactExports.memo(GraphView);const infiniteExtent=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],initialState={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:infiniteExtent,nodeExtent:infiniteExtent,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:ConnectionMode.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:devWarn,isValidConnection:void 0},createRFStore=()=>createWithEqualityFn((r,e)=>({...initialState,setNodes:t=>{const{nodeInternals:o,nodeOrigin:c,elevateNodesOnSelect:h}=e();r({nodeInternals:createNodeInternals(t,o,c,h)})},getNodes:()=>Array.from(e().nodeInternals.values()),setEdges:t=>{const{defaultEdgeOptions:o={}}=e();r({edges:t.map(c=>({...o,...c}))})},setDefaultNodesAndEdges:(t,o)=>{const c=typeof t<"u",h=typeof o<"u",v=c?createNodeInternals(t,new Map,e().nodeOrigin,e().elevateNodesOnSelect):new Map;r({nodeInternals:v,edges:h?o:[],hasDefaultNodes:c,hasDefaultEdges:h})},updateNodeDimensions:t=>{const{onNodesChange:o,nodeInternals:c,fitViewOnInit:h,fitViewOnInitDone:v,fitViewOnInitOptions:p,domNode:g,nodeOrigin:x}=e(),f=g?.querySelector(".react-flow__viewport");if(!f)return;const b=window.getComputedStyle(f),{m22:C}=new window.DOMMatrixReadOnly(b.transform),S=t.reduce((l,s)=>{const y=c.get(s.id);if(y?.hidden)c.set(y.id,{...y,[internalsSymbol]:{...y[internalsSymbol],handleBounds:void 0}});else if(y){const A=getDimensions(s.nodeElement);!!(A.width&&A.height&&(y.width!==A.width||y.height!==A.height||s.forceUpdate))&&(c.set(y.id,{...y,[internalsSymbol]:{...y[internalsSymbol],handleBounds:{source:getHandleBounds(".source",s.nodeElement,C,x),target:getHandleBounds(".target",s.nodeElement,C,x)}},...A}),l.push({id:y.id,type:"dimensions",dimensions:A}))}return l},[]);updateAbsoluteNodePositions(c,x);const k=v||h&&!v&&fitView(e,{initial:!0,...p});r({nodeInternals:new Map(c),fitViewOnInitDone:k}),S?.length>0&&o?.(S)},updateNodePositions:(t,o=!0,c=!1)=>{const{triggerNodeChanges:h}=e(),v=t.map(p=>{const g={id:p.id,type:"position",dragging:c};return o&&(g.positionAbsolute=p.positionAbsolute,g.position=p.position),g});h(v)},triggerNodeChanges:t=>{const{onNodesChange:o,nodeInternals:c,hasDefaultNodes:h,nodeOrigin:v,getNodes:p,elevateNodesOnSelect:g}=e();if(t?.length){if(h){const x=applyNodeChanges(t,p()),f=createNodeInternals(x,c,v,g);r({nodeInternals:f})}o?.(t)}},addSelectedNodes:t=>{const{multiSelectionActive:o,edges:c,getNodes:h}=e();let v,p=null;o?v=t.map(g=>createSelectionChange(g,!0)):(v=getSelectionChanges(h(),t),p=getSelectionChanges(c,[])),updateNodesAndEdgesSelections({changedNodes:v,changedEdges:p,get:e,set:r})},addSelectedEdges:t=>{const{multiSelectionActive:o,edges:c,getNodes:h}=e();let v,p=null;o?v=t.map(g=>createSelectionChange(g,!0)):(v=getSelectionChanges(c,t),p=getSelectionChanges(h(),[])),updateNodesAndEdgesSelections({changedNodes:p,changedEdges:v,get:e,set:r})},unselectNodesAndEdges:({nodes:t,edges:o}={})=>{const{edges:c,getNodes:h}=e(),v=t||h(),p=o||c,g=v.map(f=>(f.selected=!1,createSelectionChange(f.id,!1))),x=p.map(f=>createSelectionChange(f.id,!1));updateNodesAndEdgesSelections({changedNodes:g,changedEdges:x,get:e,set:r})},setMinZoom:t=>{const{d3Zoom:o,maxZoom:c}=e();o?.scaleExtent([t,c]),r({minZoom:t})},setMaxZoom:t=>{const{d3Zoom:o,minZoom:c}=e();o?.scaleExtent([c,t]),r({maxZoom:t})},setTranslateExtent:t=>{e().d3Zoom?.translateExtent(t),r({translateExtent:t})},resetSelectedElements:()=>{const{edges:t,getNodes:o}=e(),h=o().filter(p=>p.selected).map(p=>createSelectionChange(p.id,!1)),v=t.filter(p=>p.selected).map(p=>createSelectionChange(p.id,!1));updateNodesAndEdgesSelections({changedNodes:h,changedEdges:v,get:e,set:r})},setNodeExtent:t=>{const{nodeInternals:o}=e();o.forEach(c=>{c.positionAbsolute=clampPosition(c.position,t)}),r({nodeExtent:t,nodeInternals:new Map(o)})},panBy:t=>{const{transform:o,width:c,height:h,d3Zoom:v,d3Selection:p,translateExtent:g}=e();if(!v||!p||!t.x&&!t.y)return!1;const x=identity.translate(o[0]+t.x,o[1]+t.y).scale(o[2]),f=[[0,0],[c,h]],b=v?.constrain()(x,f,g);return v.transform(p,b),o[0]!==b.x||o[1]!==b.y||o[2]!==b.k},cancelConnection:()=>r({connectionNodeId:initialState.connectionNodeId,connectionHandleId:initialState.connectionHandleId,connectionHandleType:initialState.connectionHandleType,connectionStatus:initialState.connectionStatus,connectionStartHandle:initialState.connectionStartHandle,connectionEndHandle:initialState.connectionEndHandle}),reset:()=>r({...initialState})}),Object.is),ReactFlowProvider=({children:r})=>{const e=reactExports.useRef(null);return e.current||(e.current=createRFStore()),React.createElement(Provider$1,{value:e.current},r)};ReactFlowProvider.displayName="ReactFlowProvider";const Wrapper=({children:r})=>reactExports.useContext(StoreContext)?React.createElement(React.Fragment,null,r):React.createElement(ReactFlowProvider,null,r);Wrapper.displayName="ReactFlowWrapper";const defaultNodeTypes={input:InputNode$1,default:DefaultNode$1,output:OutputNode$1,group:GroupNode},defaultEdgeTypes={default:BezierEdge,straight:StraightEdge,step:StepEdge,smoothstep:SmoothStepEdge,simplebezier:SimpleBezierEdge},initNodeOrigin=[0,0],initSnapGrid=[15,15],initDefaultViewport={x:0,y:0,zoom:1},wrapperStyle={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ReactFlow=reactExports.forwardRef(({nodes:r,edges:e,defaultNodes:t,defaultEdges:o,className:c,nodeTypes:h=defaultNodeTypes,edgeTypes:v=defaultEdgeTypes,onNodeClick:p,onEdgeClick:g,onInit:x,onMove:f,onMoveStart:b,onMoveEnd:C,onConnect:S,onConnectStart:k,onConnectEnd:l,onClickConnectStart:s,onClickConnectEnd:y,onNodeMouseEnter:A,onNodeMouseMove:E,onNodeMouseLeave:T,onNodeContextMenu:u,onNodeDoubleClick:_,onNodeDragStart:M,onNodeDrag:R,onNodeDragStop:N,onNodesDelete:I,onEdgesDelete:L,onSelectionChange:Y,onSelectionDragStart:B,onSelectionDrag:D,onSelectionDragStop:H,onSelectionContextMenu:W,onSelectionStart:q,onSelectionEnd:V,connectionMode:$=ConnectionMode.Strict,connectionLineType:O=ConnectionLineType.Bezier,connectionLineStyle:j,connectionLineComponent:J,connectionLineContainerStyle:oe,deleteKeyCode:ie="Backspace",selectionKeyCode:he="Shift",selectionOnDrag:de=!1,selectionMode:fe=SelectionMode.Full,panActivationKeyCode:ue="Space",multiSelectionKeyCode:ye=isMacOs()?"Meta":"Control",zoomActivationKeyCode:ze=isMacOs()?"Meta":"Control",snapToGrid:$e=!1,snapGrid:We=initSnapGrid,onlyRenderVisibleElements:Fe=!1,selectNodesOnDrag:me=!0,nodesDraggable:ke,nodesConnectable:Qe,nodesFocusable:Je,nodeOrigin:Ye=initNodeOrigin,edgesFocusable:nt,edgesUpdatable:rt,elementsSelectable:et,defaultViewport:Ke=initDefaultViewport,minZoom:Ue=.5,maxZoom:He=2,translateExtent:mt=infiniteExtent,preventScrolling:ht=!0,nodeExtent:te,defaultMarkerColor:se="#b1b1b7",zoomOnScroll:le=!0,zoomOnPinch:Se=!0,panOnScroll:we=!1,panOnScrollSpeed:Xe=.5,panOnScrollMode:je=PanOnScrollMode.Free,zoomOnDoubleClick:K=!0,panOnDrag:xe=!0,onPaneClick:Me,onPaneMouseEnter:Ze,onPaneMouseMove:_e,onPaneMouseLeave:Ve,onPaneScroll:ee,onPaneContextMenu:Pe,children:at,onEdgeContextMenu:X,onEdgeDoubleClick:Re,onEdgeMouseEnter:Ae,onEdgeMouseMove:ne,onEdgeMouseLeave:ve,onEdgeUpdate:Ne,onEdgeUpdateStart:gt,onEdgeUpdateEnd:ft,onReconnect:vt,onReconnectStart:Tt,onReconnectEnd:xr,reconnectRadius:Bt=10,edgeUpdaterRadius:jt=10,onNodesChange:qt,onEdgesChange:mr,noDragClassName:_r="nodrag",noWheelClassName:En="nowheel",noPanClassName:Mn="nopan",fitView:Kt=!1,fitViewOptions:ar,connectOnClick:cr=!0,attributionPosition:Gr,proOptions:zr,defaultEdgeOptions:dn,elevateNodesOnSelect:_i=!0,elevateEdgesOnSelect:xi=!1,disableKeyboardA11y:wi=!1,autoPanOnConnect:ei=!0,autoPanOnNodeDrag:dr=!0,connectionRadius:bi=20,isValidConnection:$n,onError:$s,style:Yt,id:Tn,nodeDragThreshold:fn,...Wi},Ir)=>{const Si=Tn||"1";return React.createElement("div",{...Wi,style:{...Yt,...wrapperStyle},ref:Ir,className:cc$1(["react-flow",c]),"data-testid":"rf__wrapper",id:Tn},React.createElement(Wrapper,null,React.createElement(GraphView$1,{onInit:x,onMove:f,onMoveStart:b,onMoveEnd:C,onNodeClick:p,onEdgeClick:g,onNodeMouseEnter:A,onNodeMouseMove:E,onNodeMouseLeave:T,onNodeContextMenu:u,onNodeDoubleClick:_,nodeTypes:h,edgeTypes:v,connectionLineType:O,connectionLineStyle:j,connectionLineComponent:J,connectionLineContainerStyle:oe,selectionKeyCode:he,selectionOnDrag:de,selectionMode:fe,deleteKeyCode:ie,multiSelectionKeyCode:ye,panActivationKeyCode:ue,zoomActivationKeyCode:ze,onlyRenderVisibleElements:Fe,selectNodesOnDrag:me,defaultViewport:Ke,translateExtent:mt,minZoom:Ue,maxZoom:He,preventScrolling:ht,zoomOnScroll:le,zoomOnPinch:Se,zoomOnDoubleClick:K,panOnScroll:we,panOnScrollSpeed:Xe,panOnScrollMode:je,panOnDrag:xe,onPaneClick:Me,onPaneMouseEnter:Ze,onPaneMouseMove:_e,onPaneMouseLeave:Ve,onPaneScroll:ee,onPaneContextMenu:Pe,onSelectionContextMenu:W,onSelectionStart:q,onSelectionEnd:V,onEdgeContextMenu:X,onEdgeDoubleClick:Re,onEdgeMouseEnter:Ae,onEdgeMouseMove:ne,onEdgeMouseLeave:ve,onReconnect:vt??Ne,onReconnectStart:Tt??gt,onReconnectEnd:xr??ft,reconnectRadius:Bt??jt,defaultMarkerColor:se,noDragClassName:_r,noWheelClassName:En,noPanClassName:Mn,elevateEdgesOnSelect:xi,rfId:Si,disableKeyboardA11y:wi,nodeOrigin:Ye,nodeExtent:te}),React.createElement(StoreUpdater,{nodes:r,edges:e,defaultNodes:t,defaultEdges:o,onConnect:S,onConnectStart:k,onConnectEnd:l,onClickConnectStart:s,onClickConnectEnd:y,nodesDraggable:ke,nodesConnectable:Qe,nodesFocusable:Je,edgesFocusable:nt,edgesUpdatable:rt,elementsSelectable:et,elevateNodesOnSelect:_i,minZoom:Ue,maxZoom:He,nodeExtent:te,onNodesChange:qt,onEdgesChange:mr,snapToGrid:$e,snapGrid:We,connectionMode:$,translateExtent:mt,connectOnClick:cr,defaultEdgeOptions:dn,fitView:Kt,fitViewOptions:ar,onNodesDelete:I,onEdgesDelete:L,onNodeDragStart:M,onNodeDrag:R,onNodeDragStop:N,onSelectionDrag:D,onSelectionDragStart:B,onSelectionDragStop:H,noPanClassName:Mn,nodeOrigin:Ye,rfId:Si,autoPanOnConnect:ei,autoPanOnNodeDrag:dr,onError:$s,connectionRadius:bi,isValidConnection:$n,nodeDragThreshold:fn}),React.createElement(Wrapper$1,{onSelectionChange:Y}),at,React.createElement(Attribution,{proOptions:zr,position:Gr}),React.createElement(A11yDescriptions,{rfId:Si,disableKeyboardA11y:wi})))});ReactFlow.displayName="ReactFlow";function PlusIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},React.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function MinusIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},React.createElement("path",{d:"M0 0h32v4.2H0z"}))}function FitViewIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},React.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function LockIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},React.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function UnlockIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},React.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const ControlButton=({children:r,className:e,...t})=>React.createElement("button",{type:"button",className:cc$1(["react-flow__controls-button",e]),...t},r);ControlButton.displayName="ControlButton";const selector$1=r=>({isInteractive:r.nodesDraggable||r.nodesConnectable||r.elementsSelectable,minZoomReached:r.transform[2]<=r.minZoom,maxZoomReached:r.transform[2]>=r.maxZoom}),Controls=({style:r,showZoom:e=!0,showFitView:t=!0,showInteractive:o=!0,fitViewOptions:c,onZoomIn:h,onZoomOut:v,onFitView:p,onInteractiveChange:g,className:x,children:f,position:b="bottom-left"})=>{const C=useStoreApi(),[S,k]=reactExports.useState(!1),{isInteractive:l,minZoomReached:s,maxZoomReached:y}=useStore(selector$1,shallow$1),{zoomIn:A,zoomOut:E,fitView:T}=useReactFlow();if(reactExports.useEffect(()=>{k(!0)},[]),!S)return null;const u=()=>{A(),h?.()},_=()=>{E(),v?.()},M=()=>{T(c),p?.()},R=()=>{C.setState({nodesDraggable:!l,nodesConnectable:!l,elementsSelectable:!l}),g?.(!l)};return React.createElement(Panel,{className:cc$1(["react-flow__controls",x]),position:b,style:r,"data-testid":"rf__controls"},e&&React.createElement(React.Fragment,null,React.createElement(ControlButton,{onClick:u,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:y},React.createElement(PlusIcon,null)),React.createElement(ControlButton,{onClick:_,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:s},React.createElement(MinusIcon,null))),t&&React.createElement(ControlButton,{className:"react-flow__controls-fitview",onClick:M,title:"fit view","aria-label":"fit view"},React.createElement(FitViewIcon,null)),o&&React.createElement(ControlButton,{className:"react-flow__controls-interactive",onClick:R,title:"toggle interactivity","aria-label":"toggle interactivity"},l?React.createElement(UnlockIcon,null):React.createElement(LockIcon,null)),f)};Controls.displayName="Controls";var Controls$1=reactExports.memo(Controls),BackgroundVariant;(function(r){r.Lines="lines",r.Dots="dots",r.Cross="cross"})(BackgroundVariant||(BackgroundVariant={}));function LinePattern({color:r,dimensions:e,lineWidth:t}){return React.createElement("path",{stroke:r,strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})}function DotPattern({color:r,radius:e}){return React.createElement("circle",{cx:e,cy:e,r:e,fill:r})}const defaultColor={[BackgroundVariant.Dots]:"#91919a",[BackgroundVariant.Lines]:"#eee",[BackgroundVariant.Cross]:"#e2e2e2"},defaultSize={[BackgroundVariant.Dots]:1,[BackgroundVariant.Lines]:1,[BackgroundVariant.Cross]:6},selector=r=>({transform:r.transform,patternId:`pattern-${r.rfId}`});function Background({id:r,variant:e=BackgroundVariant.Dots,gap:t=20,size:o,lineWidth:c=1,offset:h=2,color:v,style:p,className:g}){const x=reactExports.useRef(null),{transform:f,patternId:b}=useStore(selector,shallow$1),C=v||defaultColor[e],S=o||defaultSize[e],k=e===BackgroundVariant.Dots,l=e===BackgroundVariant.Cross,s=Array.isArray(t)?t:[t,t],y=[s[0]*f[2]||1,s[1]*f[2]||1],A=S*f[2],E=l?[A,A]:y,T=k?[A/h,A/h]:[E[0]/h,E[1]/h];return React.createElement("svg",{className:cc$1(["react-flow__background",g]),style:{...p,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:x,"data-testid":"rf__background"},React.createElement("pattern",{id:b+r,x:f[0]%y[0],y:f[1]%y[1],width:y[0],height:y[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${T[0]},-${T[1]})`},k?React.createElement(DotPattern,{color:C,radius:A/h}):React.createElement(LinePattern,{dimensions:E,color:C,lineWidth:c})),React.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${b+r})`}))}Background.displayName="Background";var Background$1=reactExports.memo(Background);function darkenColorWithAlpha(r,e){let t=parseInt(r.slice(1,3),16),o=parseInt(r.slice(3,5),16),c=parseInt(r.slice(5,7),16),h=r.length===9?parseInt(r.slice(7,9),16)/255:1;return t=Math.max(0,t-t*e),o=Math.max(0,o-o*e),c=Math.max(0,c-c*e),`rgba(${t|0}, ${o|0}, ${c|0}, ${h})`}function getColors(r){return r?.startsWith("process")?{background:"#fc5e5eff",color:"#000"}:r?.startsWith("data")?{background:"#9aff86ff",color:"#000"}:{background:"#ccc",color:"#000"}}function HorizontalNode({data:r,selected:e}){const t=getColors(r.node_type),o=e?"#000":r.pos==="center"?darkenColorWithAlpha(t.background,.3):"transparent";return jsxRuntimeExports$1.jsxs("div",{style:{...t,border:`3px solid ${o}`,minWidth:100,textAlign:"center",padding:10,borderRadius:5},children:[jsxRuntimeExports$1.jsx(Handle$1,{type:"target",position:Position.Left}),jsxRuntimeExports$1.jsx("div",{children:r.label}),jsxRuntimeExports$1.jsx(Handle$1,{type:"source",position:Position.Right})]})}const nodeTypes={custom:HorizontalNode};function FlowChart({nodes:r,edges:e,setNodes:t,setEdges:o,selectedNode:c,onNodeSelect:h,onNodeDoubleSelect:v}){const p=reactExports.useCallback((f,b)=>{h&&h(b)},[h]),g=reactExports.useCallback((f,b)=>{v&&v(b)},[v]),x=r.map(f=>({...f,type:"custom",selected:c?.id===f.id}));return jsxRuntimeExports$1.jsx("div",{className:"w-full h-full",children:jsxRuntimeExports$1.jsxs(ReactFlow,{nodes:x,edges:e,nodeTypes,onNodesChange:f=>t(b=>applyNodeChanges(f,b)),onEdgesChange:f=>o(b=>applyEdgeChanges(f,b)),onNodeClick:p,onNodeDoubleClick:g,fitView:!0,nodesDraggable:!0,nodesConnectable:!1,children:[jsxRuntimeExports$1.jsx(Controls$1,{}),jsxRuntimeExports$1.jsx(Background$1,{variant:"dots",gap:12,size:1})]})})}function SidePane({selectedNode:r}){return jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4",children:[jsxRuntimeExports$1.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Node Info"}),r?jsxRuntimeExports$1.jsxs("pre",{className:"bg-gray-100 p-2 rounded overflow-x-auto",children:[" ",JSON.stringify(r.data,null,2)]}):jsxRuntimeExports$1.jsx("p",{children:"Click a node to see top level details. Double click fetch the node and get all the details."})]})}var classnames={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var hasRequiredClassnames;function requireClassnames(){return hasRequiredClassnames||(hasRequiredClassnames=1,(function(r){(function(){var e={}.hasOwnProperty;function t(){for(var h="",v=0;v<arguments.length;v++){var p=arguments[v];p&&(h=c(h,o(p)))}return h}function o(h){if(typeof h=="string"||typeof h=="number")return h;if(typeof h!="object")return"";if(Array.isArray(h))return t.apply(null,h);if(h.toString!==Object.prototype.toString&&!h.toString.toString().includes("[native code]"))return h.toString();var v="";for(var p in h)e.call(h,p)&&h[p]&&(v=c(v,p));return v}function c(h,v){return v?h?h+" "+v:h+v:h}r.exports?(t.default=t,r.exports=t):window.classNames=t})()})(classnames)),classnames.exports}var classnamesExports=requireClassnames();const classNames=getDefaultExportFromCjs(classnamesExports),DEFAULT_BREAKPOINTS=["xxl","xl","lg","md","sm","xs"],DEFAULT_MIN_BREAKPOINT="xs",ThemeContext=reactExports.createContext({prefixes:{},breakpoints:DEFAULT_BREAKPOINTS,minBreakpoint:DEFAULT_MIN_BREAKPOINT}),{Consumer,Provider}=ThemeContext;function useBootstrapPrefix(r,e){const{prefixes:t}=reactExports.useContext(ThemeContext);return r||t[e]||e}function useBootstrapBreakpoints(){const{breakpoints:r}=reactExports.useContext(ThemeContext);return r}function useBootstrapMinBreakpoint(){const{minBreakpoint:r}=reactExports.useContext(ThemeContext);return r}var propTypes$2={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=r,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var r=requireReactPropTypesSecret();function e(){}function t(){}return t.resetWarningCache=e,factoryWithThrowingShims=function(){function o(v,p,g,x,f,b){if(b!==r){var C=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw C.name="Invariant Violation",C}}o.isRequired=o;function c(){return o}var h={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:c,element:o,elementType:o,instanceOf:c,node:o,objectOf:c,oneOf:c,oneOfType:c,shape:c,exact:c,checkPropTypes:t,resetWarningCache:e};return h.PropTypes=h,h},factoryWithThrowingShims}var hasRequiredPropTypes;function requirePropTypes(){return hasRequiredPropTypes||(hasRequiredPropTypes=1,propTypes$2.exports=requireFactoryWithThrowingShims()()),propTypes$2.exports}var propTypesExports=requirePropTypes();const PropTypes=getDefaultExportFromCjs(propTypesExports),_excluded=["as","disabled"];function _objectWithoutPropertiesLoose(r,e){if(r==null)return{};var t={};for(var o in r)if({}.hasOwnProperty.call(r,o)){if(e.indexOf(o)>=0)continue;t[o]=r[o]}return t}function isTrivialHref(r){return!r||r.trim()==="#"}function useButtonProps({tagName:r,disabled:e,href:t,target:o,rel:c,role:h,onClick:v,tabIndex:p=0,type:g}){r||(t!=null||o!=null||c!=null?r="a":r="button");const x={tagName:r};if(r==="button")return[{type:g||"button",disabled:e},x];const f=C=>{if((e||r==="a"&&isTrivialHref(t))&&C.preventDefault(),e){C.stopPropagation();return}v?.(C)},b=C=>{C.key===" "&&(C.preventDefault(),f(C))};return r==="a"&&(t||(t="#"),e&&(t=void 0)),[{role:h??"button",disabled:void 0,tabIndex:e?void 0:p,href:t,target:r==="a"?o:void 0,"aria-disabled":e||void 0,rel:r==="a"?c:void 0,onClick:f,onKeyDown:b},x]}const Button$1=reactExports.forwardRef((r,e)=>{let{as:t,disabled:o}=r,c=_objectWithoutPropertiesLoose(r,_excluded);const[h,{tagName:v}]=useButtonProps(Object.assign({tagName:t,disabled:o},c));return jsxRuntimeExports$1.jsx(v,Object.assign({},c,h,{ref:e}))});Button$1.displayName="Button";const Button=reactExports.forwardRef(({as:r,bsPrefix:e,variant:t="primary",size:o,active:c=!1,disabled:h=!1,className:v,...p},g)=>{const x=useBootstrapPrefix(e,"btn"),[f,{tagName:b}]=useButtonProps({tagName:r,disabled:h,...p}),C=b;return jsxRuntimeExports$1.jsx(C,{...f,...p,ref:g,disabled:h,className:classNames(v,x,c&&"active",t&&`${x}-${t}`,o&&`${x}-${o}`,p.href&&h&&"disabled")})});Button.displayName="Button";function hasChildOfType(r,e){return reactExports.Children.toArray(r).some(t=>reactExports.isValidElement(t)&&t.type===e)}function useCol({as:r,bsPrefix:e,className:t,...o}){e=useBootstrapPrefix(e,"col");const c=useBootstrapBreakpoints(),h=useBootstrapMinBreakpoint(),v=[],p=[];return c.forEach(g=>{const x=o[g];delete o[g];let f,b,C;typeof x=="object"&&x!=null?{span:f,offset:b,order:C}=x:f=x;const S=g!==h?`-${g}`:"";f&&v.push(f===!0?`${e}${S}`:`${e}${S}-${f}`),C!=null&&p.push(`order${S}-${C}`),b!=null&&p.push(`offset${S}-${b}`)}),[{...o,className:classNames(t,...v,...p)},{as:r,bsPrefix:e,spans:v}]}const Col=reactExports.forwardRef((r,e)=>{const[{className:t,...o},{as:c="div",bsPrefix:h,spans:v}]=useCol(r);return jsxRuntimeExports$1.jsx(c,{...o,ref:e,className:classNames(t,!v.length&&h)})});Col.displayName="Col";const propTypes$1={type:PropTypes.string,tooltip:PropTypes.bool,as:PropTypes.elementType},Feedback=reactExports.forwardRef(({as:r="div",className:e,type:t="valid",tooltip:o=!1,...c},h)=>jsxRuntimeExports$1.jsx(r,{...c,ref:h,className:classNames(e,`${t}-${o?"tooltip":"feedback"}`)}));Feedback.displayName="Feedback";Feedback.propTypes=propTypes$1;const FormContext=reactExports.createContext({}),FormCheckInput=reactExports.forwardRef(({id:r,bsPrefix:e,className:t,type:o="checkbox",isValid:c=!1,isInvalid:h=!1,as:v="input",...p},g)=>{const{controlId:x}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-check-input"),jsxRuntimeExports$1.jsx(v,{...p,ref:g,type:o,id:r||x,className:classNames(t,e,c&&"is-valid",h&&"is-invalid")})});FormCheckInput.displayName="FormCheckInput";const FormCheckLabel=reactExports.forwardRef(({bsPrefix:r,className:e,htmlFor:t,...o},c)=>{const{controlId:h}=reactExports.useContext(FormContext);return r=useBootstrapPrefix(r,"form-check-label"),jsxRuntimeExports$1.jsx("label",{...o,ref:c,htmlFor:t||h,className:classNames(e,r)})});FormCheckLabel.displayName="FormCheckLabel";const FormCheck=reactExports.forwardRef(({id:r,bsPrefix:e,bsSwitchPrefix:t,inline:o=!1,reverse:c=!1,disabled:h=!1,isValid:v=!1,isInvalid:p=!1,feedbackTooltip:g=!1,feedback:x,feedbackType:f,className:b,style:C,title:S="",type:k="checkbox",label:l,children:s,as:y="input",...A},E)=>{e=useBootstrapPrefix(e,"form-check"),t=useBootstrapPrefix(t,"form-switch");const{controlId:T}=reactExports.useContext(FormContext),u=reactExports.useMemo(()=>({controlId:r||T}),[T,r]),_=!s&&l!=null&&l!==!1||hasChildOfType(s,FormCheckLabel),M=jsxRuntimeExports$1.jsx(FormCheckInput,{...A,type:k==="switch"?"checkbox":k,ref:E,isValid:v,isInvalid:p,disabled:h,as:y});return jsxRuntimeExports$1.jsx(FormContext.Provider,{value:u,children:jsxRuntimeExports$1.jsx("div",{style:C,className:classNames(b,_&&e,o&&`${e}-inline`,c&&`${e}-reverse`,k==="switch"&&t),children:s||jsxRuntimeExports$1.jsxs(jsxRuntimeExports$1.Fragment,{children:[M,_&&jsxRuntimeExports$1.jsx(FormCheckLabel,{title:S,children:l}),x&&jsxRuntimeExports$1.jsx(Feedback,{type:f,tooltip:g,children:x})]})})})});FormCheck.displayName="FormCheck";const FormCheck$1=Object.assign(FormCheck,{Input:FormCheckInput,Label:FormCheckLabel}),FormControl=reactExports.forwardRef(({bsPrefix:r,type:e,size:t,htmlSize:o,id:c,className:h,isValid:v=!1,isInvalid:p=!1,plaintext:g,readOnly:x,as:f="input",...b},C)=>{const{controlId:S}=reactExports.useContext(FormContext);return r=useBootstrapPrefix(r,"form-control"),jsxRuntimeExports$1.jsx(f,{...b,type:e,size:o,ref:C,readOnly:x,id:c||S,className:classNames(h,g?`${r}-plaintext`:r,t&&`${r}-${t}`,e==="color"&&`${r}-color`,v&&"is-valid",p&&"is-invalid")})});FormControl.displayName="FormControl";const FormControl$1=Object.assign(FormControl,{Feedback}),FormFloating=reactExports.forwardRef(({className:r,bsPrefix:e,as:t="div",...o},c)=>(e=useBootstrapPrefix(e,"form-floating"),jsxRuntimeExports$1.jsx(t,{ref:c,className:classNames(r,e),...o})));FormFloating.displayName="FormFloating";const FormGroup=reactExports.forwardRef(({controlId:r,as:e="div",...t},o)=>{const c=reactExports.useMemo(()=>({controlId:r}),[r]);return jsxRuntimeExports$1.jsx(FormContext.Provider,{value:c,children:jsxRuntimeExports$1.jsx(e,{...t,ref:o})})});FormGroup.displayName="FormGroup";const FormLabel=reactExports.forwardRef(({as:r="label",bsPrefix:e,column:t=!1,visuallyHidden:o=!1,className:c,htmlFor:h,...v},p)=>{const{controlId:g}=reactExports.useContext(FormContext);e=useBootstrapPrefix(e,"form-label");let x="col-form-label";typeof t=="string"&&(x=`${x} ${x}-${t}`);const f=classNames(c,e,o&&"visually-hidden",t&&x);return h=h||g,t?jsxRuntimeExports$1.jsx(Col,{ref:p,as:"label",className:f,htmlFor:h,...v}):jsxRuntimeExports$1.jsx(r,{ref:p,className:f,htmlFor:h,...v})});FormLabel.displayName="FormLabel";const FormRange=reactExports.forwardRef(({bsPrefix:r,className:e,id:t,...o},c)=>{const{controlId:h}=reactExports.useContext(FormContext);return r=useBootstrapPrefix(r,"form-range"),jsxRuntimeExports$1.jsx("input",{...o,type:"range",ref:c,className:classNames(e,r),id:t||h})});FormRange.displayName="FormRange";const FormSelect=reactExports.forwardRef(({bsPrefix:r,size:e,htmlSize:t,className:o,isValid:c=!1,isInvalid:h=!1,id:v,...p},g)=>{const{controlId:x}=reactExports.useContext(FormContext);return r=useBootstrapPrefix(r,"form-select"),jsxRuntimeExports$1.jsx("select",{...p,size:t,ref:g,className:classNames(o,r,e&&`${r}-${e}`,c&&"is-valid",h&&"is-invalid"),id:v||x})});FormSelect.displayName="FormSelect";const FormText=reactExports.forwardRef(({bsPrefix:r,className:e,as:t="small",muted:o,...c},h)=>(r=useBootstrapPrefix(r,"form-text"),jsxRuntimeExports$1.jsx(t,{...c,ref:h,className:classNames(e,r,o&&"text-muted")})));FormText.displayName="FormText";const Switch=reactExports.forwardRef((r,e)=>jsxRuntimeExports$1.jsx(FormCheck$1,{...r,ref:e,type:"switch"}));Switch.displayName="Switch";const Switch$1=Object.assign(Switch,{Input:FormCheck$1.Input,Label:FormCheck$1.Label}),FloatingLabel=reactExports.forwardRef(({bsPrefix:r,className:e,children:t,controlId:o,label:c,...h},v)=>(r=useBootstrapPrefix(r,"form-floating"),jsxRuntimeExports$1.jsxs(FormGroup,{ref:v,className:classNames(e,r),controlId:o,...h,children:[t,jsxRuntimeExports$1.jsx("label",{htmlFor:o,children:c})]})));FloatingLabel.displayName="FloatingLabel";const propTypes={_ref:PropTypes.any,validated:PropTypes.bool,as:PropTypes.elementType},Form=reactExports.forwardRef(({className:r,validated:e,as:t="form",...o},c)=>jsxRuntimeExports$1.jsx(t,{...o,ref:c,className:classNames(r,e&&"was-validated")}));Form.displayName="Form";Form.propTypes=propTypes;const Form$1=Object.assign(Form,{Group:FormGroup,Control:FormControl$1,Floating:FormFloating,Check:FormCheck$1,Switch:Switch$1,Label:FormLabel,Text:FormText,Range:FormRange,Select:FormSelect,FloatingLabel});var Zs=Object.defineProperty,Ys=(r,e,t)=>e in r?Zs(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ci$1=(r,e,t)=>(Ys(r,typeof e!="symbol"?e+"":e,t),t),commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},jsxRuntime={exports:{}},reactJsxRuntime_production_min={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var r=React,e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h={key:!0,ref:!0,__self:!0,__source:!0};function v(p,g,x){var f,b={},C=null,S=null;x!==void 0&&(C=""+x),g.key!==void 0&&(C=""+g.key),g.ref!==void 0&&(S=g.ref);for(f in g)o.call(g,f)&&!h.hasOwnProperty(f)&&(b[f]=g[f]);if(p&&p.defaultProps)for(f in g=p.defaultProps,g)b[f]===void 0&&(b[f]=g[f]);return{$$typeof:e,type:p,key:C,ref:S,props:b,_owner:c.current}}return reactJsxRuntime_production_min.Fragment=t,reactJsxRuntime_production_min.jsx=v,reactJsxRuntime_production_min.jsxs=v,reactJsxRuntime_production_min}jsxRuntime.exports=requireReactJsxRuntime_production_min();var jsxRuntimeExports=jsxRuntime.exports;class ControlBox extends React.Component{constructor(){super(...arguments),Ci$1(this,"handleSupercellChange",(e,t)=>{let o=this.props.viewerParams.supercell;o[e]=parseInt(t),this.props.onViewerParamChange("supercell",o)}),Ci$1(this,"handleOptionChange",e=>{this.props.onViewerParamChange(e,!this.props.viewerParams[e])}),Ci$1(this,"handleCameraEvent",e=>{this.props.onViewerEvent("camera",e)})}render(){return jsxRuntimeExports.jsxs("div",{className:"control-box",children:[jsxRuntimeExports.jsxs("div",{className:"control-box-row",children:[jsxRuntimeExports.jsxs("div",{className:"supercell-container",children:[jsxRuntimeExports.jsx(Form$1.Label,{children:"Supercell: "}),jsxRuntimeExports.jsx("div",{style:{display:"flex"},children:[0,1,2].map(e=>jsxRuntimeExports.jsx(Form$1.Control,{className:"supercell-input",type:"number",min:"1",max:"99",value:this.props.viewerParams.supercell[e],onChange:t=>this.handleSupercellChange(e,t.target.value)},e))})]}),jsxRuntimeExports.jsxs("div",{className:"camera-controls",children:[jsxRuntimeExports.jsx(Form$1.Label,{children:"Camera: "}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("x"),children:"x"}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("y"),children:"y"}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("z"),children:"z"})]})]}),jsxRuntimeExports.jsxs("div",{className:"control-box-row",style:{display:"flex"},children:[jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.bonds,onChange:()=>this.handleOptionChange("bonds"),label:"Bonds"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.packedCell,onChange:()=>this.handleOptionChange("packedCell"),label:"Packed cell"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.atomLabels,onChange:()=>this.handleOptionChange("atomLabels"),label:"Atom labels"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.spaceFilling,onChange:()=>this.handleOptionChange("vdwRadius"),label:"vdW radius"})]})]})}}var _3Dmol={exports:{}};/*!
 * 3dmol v2.3.0
 * JavaScript/TypeScript molecular visualization library
 * Author: David Koes and contributors
 */(function(module,exports){(function(r,e){module.exports=e()})(commonjsGlobal,()=>(()=>{var __webpack_modules__={"./node_modules/iobuffer/lib-esm/IOBuffer.js":((r,e,t)=>{t.r(e),t.d(e,{IOBuffer:()=>p});var o=t("./node_modules/iobuffer/lib-esm/text.browser.js");const c=1024*8,h=(()=>{const g=new Uint8Array(4),x=new Uint32Array(g.buffer);return!((x[0]=1)&g[0])})(),v={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class p{constructor(x=c,f={}){let b=!1;typeof x=="number"?x=new ArrayBuffer(x):(b=!0,this.lastWrittenByte=x.byteLength);const C=f.offset?f.offset>>>0:0,S=x.byteLength-C;let k=C;(ArrayBuffer.isView(x)||x instanceof p)&&(x.byteLength!==x.buffer.byteLength&&(k=x.byteOffset+C),x=x.buffer),b?this.lastWrittenByte=S:this.lastWrittenByte=0,this.buffer=x,this.length=S,this.byteLength=S,this.byteOffset=k,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,k,S),this._mark=0,this._marks=[]}available(x=1){return this.offset+x<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(x=1){return this.offset+=x,this}back(x=1){return this.offset-=x,this}seek(x){return this.offset=x,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const x=this._marks.pop();if(x===void 0)throw new Error("Mark stack empty");return this.seek(x),this}rewind(){return this.offset=0,this}ensureAvailable(x=1){if(!this.available(x)){const f=(this.offset+x)*2,b=new Uint8Array(f);b.set(new Uint8Array(this.buffer)),this.buffer=b.buffer,this.length=this.byteLength=f,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(x=1){return this.readArray(x,"uint8")}readArray(x,f){const b=v[f].BYTES_PER_ELEMENT*x,C=this.byteOffset+this.offset,S=this.buffer.slice(C,C+b);if(this.littleEndian===h&&f!=="uint8"&&f!=="int8"){const l=new Uint8Array(this.buffer.slice(C,C+b));l.reverse();const s=new v[f](l.buffer);return this.offset+=b,s.reverse(),s}const k=new v[f](S);return this.offset+=b,k}readInt16(){const x=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,x}readUint16(){const x=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,x}readInt32(){const x=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,x}readUint32(){const x=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,x}readFloat32(){const x=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,x}readFloat64(){const x=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,x}readBigInt64(){const x=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,x}readBigUint64(){const x=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,x}readChar(){return String.fromCharCode(this.readInt8())}readChars(x=1){let f="";for(let b=0;b<x;b++)f+=this.readChar();return f}readUtf8(x=1){return(0,o.decode)(this.readBytes(x))}decodeText(x=1,f="utf-8"){return(0,o.decode)(this.readBytes(x),f)}writeBoolean(x){return this.writeUint8(x?255:0),this}writeInt8(x){return this.ensureAvailable(1),this._data.setInt8(this.offset++,x),this._updateLastWrittenByte(),this}writeUint8(x){return this.ensureAvailable(1),this._data.setUint8(this.offset++,x),this._updateLastWrittenByte(),this}writeByte(x){return this.writeUint8(x)}writeBytes(x){this.ensureAvailable(x.length);for(let f=0;f<x.length;f++)this._data.setUint8(this.offset++,x[f]);return this._updateLastWrittenByte(),this}writeInt16(x){return this.ensureAvailable(2),this._data.setInt16(this.offset,x,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(x){return this.ensureAvailable(2),this._data.setUint16(this.offset,x,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(x){return this.ensureAvailable(4),this._data.setInt32(this.offset,x,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(x){return this.ensureAvailable(4),this._data.setUint32(this.offset,x,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(x){return this.ensureAvailable(4),this._data.setFloat32(this.offset,x,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(x){return this.ensureAvailable(8),this._data.setFloat64(this.offset,x,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(x){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,x,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(x){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,x,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(x){return this.writeUint8(x.charCodeAt(0))}writeChars(x){for(let f=0;f<x.length;f++)this.writeUint8(x.charCodeAt(f));return this}writeUtf8(x){return this.writeBytes((0,o.encode)(x))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}}),"./node_modules/iobuffer/lib-esm/text-encoding-polyfill.js":(function(){(function(r){if(r.TextEncoder&&r.TextDecoder)return!1;function e(o="utf-8"){if(o!=="utf-8")throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${o}') is invalid.`)}Object.defineProperty(e.prototype,"encoding",{value:"utf-8"}),e.prototype.encode=function(o,c={stream:!1}){if(c.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let h=0;const v=o.length;let p=0,g=Math.max(32,v+(v>>1)+7),x=new Uint8Array(g>>3<<3);for(;h<v;){let f=o.charCodeAt(h++);if(f>=55296&&f<=56319){if(h<v){const b=o.charCodeAt(h);(b&64512)===56320&&(++h,f=((f&1023)<<10)+(b&1023)+65536)}if(f>=55296&&f<=56319)continue}if(p+4>x.length){g+=8,g*=1+h/o.length*2,g=g>>3<<3;const b=new Uint8Array(g);b.set(x),x=b}if(f&4294967168)if(!(f&4294965248))x[p++]=f>>6&31|192;else if(!(f&4294901760))x[p++]=f>>12&15|224,x[p++]=f>>6&63|128;else if(!(f&4292870144))x[p++]=f>>18&7|240,x[p++]=f>>12&63|128,x[p++]=f>>6&63|128;else continue;else{x[p++]=f;continue}x[p++]=f&63|128}return x.slice(0,p)};function t(o="utf-8",c={fatal:!1}){if(o!=="utf-8")throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${o}') is invalid.`);if(c.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(t.prototype,"fatal",{value:!1}),Object.defineProperty(t.prototype,"ignoreBOM",{value:!1}),t.prototype.decode=function(o,c={stream:!1}){if(c.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const h=new Uint8Array(o);let v=0;const p=h.length,g=[];for(;v<p;){const x=h[v++];if(x===0)break;if(!(x&128))g.push(x);else if((x&224)===192){const f=h[v++]&63;g.push((x&31)<<6|f)}else if((x&240)===224){const f=h[v++]&63,b=h[v++]&63;g.push((x&31)<<12|f<<6|b)}else if((x&248)===240){const f=h[v++]&63,b=h[v++]&63,C=h[v++]&63;let S=(x&7)<<18|f<<12|b<<6|C;S>65535&&(S-=65536,g.push(S>>>10&1023|55296),S=56320|S&1023),g.push(S)}}return String.fromCharCode.apply(null,g)},r.TextEncoder=e,r.TextDecoder=t})(typeof window<"u"?window:typeof self<"u"?self:this)}),"./node_modules/iobuffer/lib-esm/text.browser.js":((r,e,t)=>{t.r(e),t.d(e,{decode:()=>o,encode:()=>h}),t("./node_modules/iobuffer/lib-esm/text-encoding-polyfill.js");function o(v,p="utf8"){return new TextDecoder(p).decode(v)}const c=new TextEncoder;function h(v){return c.encode(v)}}),"./node_modules/netcdfjs/lib-esm/data.js":((r,e,t)=>{t.r(e),t.d(e,{nonRecord:()=>c,record:()=>h});var o=t("./node_modules/netcdfjs/lib-esm/types.js");function c(v,p){const g=(0,o.str2num)(p.type),x=p.size/(0,o.num2bytes)(g),f=new Array(x);for(let b=0;b<x;b++)f[b]=(0,o.readType)(v,g,1);return f}function h(v,p,g){const x=(0,o.str2num)(p.type),f=p.size?p.size/(0,o.num2bytes)(x):1,b=g.length,C=new Array(b),S=g.recordStep;if(S)for(let k=0;k<b;k++){const l=v.offset;C[k]=(0,o.readType)(v,x,f),v.seek(l+S)}else throw new Error("recordDimension.recordStep is undefined");return C}}),"./node_modules/netcdfjs/lib-esm/header.js":((r,e,t)=>{t.r(e),t.d(e,{header:()=>f});var o=t("./node_modules/netcdfjs/lib-esm/types.js"),c=t("./node_modules/netcdfjs/lib-esm/utils.js");const h=0,v=10,p=11,g=12,x=0;function f(k,l){const s={version:l},y={length:k.readUint32()},A=b(k);Array.isArray(A)||(y.id=A.recordId,y.name=A.recordName,s.dimensions=A.dimensions),s.globalAttributes=C(k);const E=S(k,y?.id,l);return Array.isArray(E)||(s.variables=E.variables,y.recordStep=E.recordStep),s.recordDimension=y,s}function b(k){const l={};let s,y;const A=k.readUint32();let E;if(A===h)return(0,c.notNetcdf)(k.readUint32()!==h,"wrong empty tag for list of dimensions"),[];{(0,c.notNetcdf)(A!==v,"wrong tag for list of dimensions");const T=k.readUint32();E=new Array(T);for(let u=0;u<T;u++){const _=(0,c.readName)(k),M=k.readUint32();M===x&&(s=u,y=_),E[u]={name:_,size:M}}}return s!==void 0&&(l.recordId=s),y!==void 0&&(l.recordName=y),l.dimensions=E,l}function C(k){const l=k.readUint32();let s;if(l===h)return(0,c.notNetcdf)(k.readUint32()!==h,"wrong empty tag for list of attributes"),[];{(0,c.notNetcdf)(l!==g,"wrong tag for list of attributes");const y=k.readUint32();s=new Array(y);for(let A=0;A<y;A++){const E=(0,c.readName)(k),T=k.readUint32();(0,c.notNetcdf)(T<1||T>6,`non valid type ${T}`);const u=k.readUint32(),_=(0,o.readType)(k,T,u);(0,c.padding)(k),s[A]={name:E,type:(0,o.num2str)(T),value:_}}}return s}function S(k,l,s){const y=k.readUint32();let A=0,E;if(y===h)return(0,c.notNetcdf)(k.readUint32()!==h,"wrong empty tag for list of variables"),[];{(0,c.notNetcdf)(y!==p,"wrong tag for list of variables");const T=k.readUint32();E=new Array(T);for(let u=0;u<T;u++){const _=(0,c.readName)(k),M=k.readUint32(),R=new Array(M);for(let D=0;D<M;D++)R[D]=k.readUint32();const N=C(k),I=k.readUint32();(0,c.notNetcdf)(I<1&&I>6,`non valid type ${I}`);const L=k.readUint32();let Y=k.readUint32();s===2&&((0,c.notNetcdf)(Y>0,"offsets larger than 4GB not supported"),Y=k.readUint32());let B=!1;typeof l<"u"&&R[0]===l&&(A+=L,B=!0),E[u]={name:_,dimensions:R,attributes:N,type:(0,o.num2str)(I),size:L,offset:Y,record:B}}}return{variables:E,recordStep:A}}}),"./node_modules/netcdfjs/lib-esm/index.js":((r,e,t)=>{t.r(e),t.d(e,{NetCDFReader:()=>o.NetCDFReader});var o=t("./node_modules/netcdfjs/lib-esm/parser.js")}),"./node_modules/netcdfjs/lib-esm/parser.js":((r,e,t)=>{t.r(e),t.d(e,{NetCDFReader:()=>g});var o=t("./node_modules/iobuffer/lib-esm/IOBuffer.js"),c=t("./node_modules/netcdfjs/lib-esm/data.js"),h=t("./node_modules/netcdfjs/lib-esm/header.js"),v=t("./node_modules/netcdfjs/lib-esm/toString.js"),p=t("./node_modules/netcdfjs/lib-esm/utils.js");class g{constructor(f){this.toString=v.toString;const b=new o.IOBuffer(f);b.setBigEndian(),(0,p.notNetcdf)(b.readChars(3)!=="CDF","should start with CDF");const C=b.readByte();(0,p.notNetcdf)(C>2,"unknown version"),this.header=(0,h.header)(b,C),this.buffer=b}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(f){const b=this.globalAttributes.find(C=>C.name===f);return b?b.value:null}getDataVariableAsString(f){const b=this.getDataVariable(f);return b?b.join(""):null}get variables(){return this.header.variables}getDataVariable(f){let b;if(typeof f=="string"?b=this.header.variables.find(C=>C.name===f):b=f,b===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(b.offset),b.record?(0,c.record)(this.buffer,b,this.header.recordDimension):(0,c.nonRecord)(this.buffer,b)}dataVariableExists(f){return this.header.variables.find(b=>b.name===f)!==void 0}attributeExists(f){return this.globalAttributes.find(b=>b.name===f)!==void 0}}}),"./node_modules/netcdfjs/lib-esm/toString.js":((r,e,t)=>{t.r(e),t.d(e,{toString:()=>o});function o(){const c=[];c.push("DIMENSIONS");for(const v of this.dimensions)c.push(`  ${v.name.padEnd(30)} = size: ${v.size}`);c.push(""),c.push("GLOBAL ATTRIBUTES");for(const v of this.globalAttributes)c.push(`  ${v.name.padEnd(30)} = ${v.value}`);const h=JSON.parse(JSON.stringify(this.variables));c.push(""),c.push("VARIABLES:");for(const v of h){v.value=this.getDataVariable(v);let p=JSON.stringify(v.value);p.length>50&&(p=p.substring(0,50)),isNaN(v.value.length)||(p+=` (length: ${v.value.length})`),c.push(`  ${v.name.padEnd(30)} = ${p}`)}return c.join(`
`)}}),"./node_modules/netcdfjs/lib-esm/types.js":((r,e,t)=>{t.r(e),t.d(e,{num2bytes:()=>h,num2str:()=>c,readType:()=>g,str2num:()=>v});const o={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function c(f){switch(Number(f)){case o.BYTE:return"byte";case o.CHAR:return"char";case o.SHORT:return"short";case o.INT:return"int";case o.FLOAT:return"float";case o.DOUBLE:return"double";default:return"undefined"}}function h(f){switch(Number(f)){case o.BYTE:return 1;case o.CHAR:return 1;case o.SHORT:return 2;case o.INT:return 4;case o.FLOAT:return 4;case o.DOUBLE:return 8;default:return-1}}function v(f){switch(String(f)){case"byte":return o.BYTE;case"char":return o.CHAR;case"short":return o.SHORT;case"int":return o.INT;case"float":return o.FLOAT;case"double":return o.DOUBLE;default:return-1}}function p(f,b){if(f!==1){const C=new Array(f);for(let S=0;S<f;S++)C[S]=b();return C}else return b()}function g(f,b,C){switch(b){case o.BYTE:return Array.from(f.readBytes(C));case o.CHAR:return x(f.readChars(C));case o.SHORT:return p(C,f.readInt16.bind(f));case o.INT:return p(C,f.readInt32.bind(f));case o.FLOAT:return p(C,f.readFloat32.bind(f));case o.DOUBLE:return p(C,f.readFloat64.bind(f));default:throw new Error(`non valid type ${b}`)}}function x(f){return f.charCodeAt(f.length-1)===0?f.substring(0,f.length-1):f}}),"./node_modules/netcdfjs/lib-esm/utils.js":((r,e,t)=>{t.r(e),t.d(e,{notNetcdf:()=>o,padding:()=>c,readName:()=>h});function o(v,p){if(v)throw new TypeError(`Not a valid NetCDF v3.x file: ${p}`)}function c(v){v.offset%4!==0&&v.skip(4-v.offset%4)}function h(v){const p=v.readUint32(),g=v.readChars(p);return c(v),g}}),"./src/WebGL/shaders/lib/basic/basic.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;
    float fogFactor = smoothstep( fogNear, fogFar, depth );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
}`}),"./src/WebGL/shaders/lib/basic/basic.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`}),"./src/WebGL/shaders/lib/blur/blur.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`}),"./src/WebGL/shaders/lib/blur/blur.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/instanced/instanced.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`}),"./src/WebGL/shaders/lib/instanced/instanced.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`}),"./src/WebGL/shaders/lib/lambert/lambert.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}`}),"./src/WebGL/shaders/lib/lambert/lambert.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`}),"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`}),"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`}),"./src/WebGL/shaders/lib/outline/outline.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );
}


`}),"./src/WebGL/shaders/lib/outline/outline.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    gl_Position = projectionMatrix * mvPosition;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`}),"./src/WebGL/shaders/lib/screen/screen.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `}),"./src/WebGL/shaders/lib/screen/screen.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/screenaa/screenaa.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec3 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP).xyz;
    vec3 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP).xyz;
    vec3 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP).xyz;
    vec3 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP).xyz;
    vec3 rgbM  = texture2D(tex, fragCoord  * inverseVP).xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)).xyz +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5).xyz +
        texture2D(tex, fragCoord  + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, 1.0);
    else
        color = vec4(rgbB, 1.0);
    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        `}),"./src/WebGL/shaders/lib/screenaa/screenaa.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    float fogFactor = smoothstep( fogNear, fogFar, gl_FragDepthEXT/gl_FragCoord.w );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );


}

`}),"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`}),"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );
}


`}),"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);
    vec4 adjust = projectionMatrix* vec4(norm,normal.z,0.0); adjust.z = 0.0; adjust.w = 0.0;
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+adjust;
}

`}),"./src/WebGL/shaders/lib/sprite/sprite.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform int fogType;
uniform vec3 fogColor;
uniform float fogDensity;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogType > 0) {

        float depth = gl_FragCoord.z / gl_FragCoord.w;
        float fogFactor = 0.0;

        if (fogType == 1) {
            fogFactor = smoothstep(fogNear, fogFar, depth);
        }

        else {
            const float LOG2 = 1.442695;
            float fogFactor = exp2(- fogDensity * fogDensity * depth * depth * LOG2);
            fogFactor = 1.0 - clamp(fogFactor, 0.0, 1.0);
        }

        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);

    }
}

`}),"./src/WebGL/shaders/lib/sprite/sprite.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`}),"./src/WebGL/shaders/lib/ssao/ssao.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`}),"./src/WebGL/shaders/lib/ssao/ssao.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    float fogFactor = smoothstep( fogNear, fogFar, depth );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
}`}),"./src/WebGL/shaders/lib/stickimposter/stickimposter.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(projectionMatrix[3][3] == 0.0) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(projectionMatrix[3][3] == 0.0) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }
    vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
    mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`}),"./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`}),"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    to.xyz += normalize(to.xyz)*outlinePushback;
    pt.xyz += normalize(pt.xyz)*outlinePushback;

    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }
    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`}),"./src/WebGL/shaders/lib/volumetric/volumetric.frag":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `}),"./src/WebGL/shaders/lib/volumetric/volumetric.vert":((r,e,t)=>{t.r(e),t.d(e,{default:()=>o});const o=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`}),"./src/GLDraw.ts":((r,e,t)=>{t.r(e),t.d(e,{CAP:()=>c,GLDraw:()=>h});var o=t("./src/WebGL/math/index.ts"),c;(function(v){v[v.NONE=0]="NONE",v[v.FLAT=1]="FLAT",v[v.ROUND=2]="ROUND"})(c||(c={}));var h;(function(v){function p(l,s,y){var A=Math.hypot(l,s),E,T,u,_,M;A<1e-4?(T=0,u=1):(T=-l/A,u=s/A),s=-T*l+u*s,E=Math.hypot(s,y),E<1e-4?(_=0,M=1):(_=y/E,M=s/E);var R=new Float32Array(9);return R[0]=u,R[1]=T,R[2]=0,R[3]=-T*M,R[4]=u*M,R[5]=_,R[6]=T*_,R[7]=-u*_,R[8]=M,R}class g{constructor(){this.cache={};let s=[],y=4,A=Math.pow(2,y),E=2,T=Math.pow(2,E),u=A/T,_;for(s[0]=new o.Vector3(-1,0,0),s[u]=new o.Vector3(0,0,1),s[u*2]=new o.Vector3(1,0,0),s[u*3]=new o.Vector3(0,0,-1),E=3;E<=y;E++){for(T=Math.pow(2,E-1),u=A/T,_=0;_<T-1;_++)s[u/2+_*u]=s[_*u].clone().add(s[(_+1)*u]).normalize();_=T-1,s[u/2+_*u]=s[_*u].clone().add(s[0]).normalize()}this.basisVectors=s}getVerticesForRadius(s,y,A){if(typeof this.cache<"u"&&this.cache[s]!==void 0&&this.cache[s][y+A]!==void 0)return this.cache[s][y+A];for(var E=this.basisVectors.length,T=[],u=[],_,M=0;M<E;M++)T.push(this.basisVectors[M].clone().multiplyScalar(s)),T.push(this.basisVectors[M].clone().multiplyScalar(s)),_=this.basisVectors[M].clone().normalize(),u.push(_),u.push(_);var R=[],N=10,I=E,L=0,Y=Math.PI*2,B=0,D=Math.PI,H,W,q=!1,V=!1;for(W=0;W<=N;W++){q=W===0||W===N,V=W===N/2;var $=[],O=[];for(H=0;H<=I;H++){if(V){var j=H<I?2*H:0;O.push(j+1),$.push(j);continue}var J=H/I,oe=W/N;if(!q||H===0)if(H<I){var ie=new o.Vector3;ie.x=-s*Math.cos(L+J*Y)*Math.sin(B+oe*D),y==1?ie.y=0:ie.y=s*Math.cos(B+oe*D),ie.z=s*Math.sin(L+J*Y)*Math.sin(B+oe*D),Math.abs(ie.x)<1e-5&&(ie.x=0),Math.abs(ie.y)<1e-5&&(ie.y=0),Math.abs(ie.z)<1e-5&&(ie.z=0),y==c.FLAT?(_=new o.Vector3(0,Math.cos(B+oe*D),0),_.normalize()):(_=new o.Vector3(ie.x,ie.y,ie.z),_.normalize()),T.push(ie),u.push(_),$.push(T.length-1)}else $.push(T.length-I);else q&&$.push(T.length-1)}V&&R.push(O),R.push($)}var he={vertices:T,normals:u,verticesRows:R,w:I,h:N};return s in this.cache||(this.cache[s]={}),this.cache[s][y+A]=he,he}}var x=new g;function f(l,s,y,A,E,T=0,u=0){if(!s||!y)return;let _=function(Ne){if(typeof Ne=="string"){let gt=Ne;return gt.toLowerCase()=="flat"?c.FLAT:gt.toLowerCase()=="round"?c.ROUND:c.NONE}else return Ne};T=_(T),u=_(u);var M=u||T;E=E||{r:0,g:0,b:0};var R=p(y.x-s.x,y.y-s.y,y.z-s.z),N=x.getVerticesForRadius(A,u,"to"),I=N.w,L=N.h,Y=M?L*I+2:2*I,B=l.updateGeoGroup(Y),D=N.vertices,H=N.normals,W=N.verticesRows,q=W[L/2],V=W[L/2+1],$=B.vertices,O,j,J,oe,ie,he,de=B.vertexArray,fe=B.normalArray,ue=B.colorArray,ye=B.faceArray;for(J=0;J<I;++J){var ze=2*J;oe=R[0]*D[ze].x+R[3]*D[ze].y+R[6]*D[ze].z,ie=R[1]*D[ze].x+R[4]*D[ze].y+R[7]*D[ze].z,he=R[5]*D[ze].y+R[8]*D[ze].z,O=3*($+ze),j=B.faceidx,de[O]=oe+s.x,de[O+1]=ie+s.y,de[O+2]=he+s.z,de[O+3]=oe+y.x,de[O+4]=ie+y.y,de[O+5]=he+y.z,fe[O]=oe,fe[O+3]=oe,fe[O+1]=ie,fe[O+4]=ie,fe[O+2]=he,fe[O+5]=he,ue[O]=E.r,ue[O+3]=E.r,ue[O+1]=E.g,ue[O+4]=E.g,ue[O+2]=E.b,ue[O+5]=E.b,ye[j]=V[J]+$,ye[j+1]=V[J+1]+$,ye[j+2]=q[J]+$,ye[j+3]=q[J]+$,ye[j+4]=V[J+1]+$,ye[j+5]=q[J+1]+$,B.faceidx+=6}if(M){var $e=u?0:L/2,We=T?L+1:L/2+1,Fe,me,ke,Qe,Je,Ye,nt,rt,et,Ke,Ue,He,mt,ht,te,se,le,Se,we,Xe,je,K,xe,Me,Ze,_e,Ve,ee,Pe,at,X,Re;for(ie=$e;ie<We;ie++)if(ie!==L/2){var Ae=ie<=L/2?y:s,ne=x.getVerticesForRadius(A,u,"to"),ve=x.getVerticesForRadius(A,T,"from");for(Ae===y?(D=ne.vertices,H=ne.normals,W=ne.verticesRows):Ae==s&&(D=ve.vertices,H=ve.normals,W=ve.verticesRows),oe=0;oe<I;oe++)j=B.faceidx,Fe=W[ie][oe+1],Pe=(Fe+$)*3,me=W[ie][oe],at=(me+$)*3,ke=W[ie+1][oe],X=(ke+$)*3,Qe=W[ie+1][oe+1],Re=(Qe+$)*3,Je=R[0]*D[Fe].x+R[3]*D[Fe].y+R[6]*D[Fe].z,Ye=R[0]*D[me].x+R[3]*D[me].y+R[6]*D[me].z,nt=R[0]*D[ke].x+R[3]*D[ke].y+R[6]*D[ke].z,rt=R[0]*D[Qe].x+R[3]*D[Qe].y+R[6]*D[Qe].z,et=R[1]*D[Fe].x+R[4]*D[Fe].y+R[7]*D[Fe].z,Ke=R[1]*D[me].x+R[4]*D[me].y+R[7]*D[me].z,Ue=R[1]*D[ke].x+R[4]*D[ke].y+R[7]*D[ke].z,He=R[1]*D[Qe].x+R[4]*D[Qe].y+R[7]*D[Qe].z,mt=R[5]*D[Fe].y+R[8]*D[Fe].z,ht=R[5]*D[me].y+R[8]*D[me].z,te=R[5]*D[ke].y+R[8]*D[ke].z,se=R[5]*D[Qe].y+R[8]*D[Qe].z,de[Pe]=Je+Ae.x,de[at]=Ye+Ae.x,de[X]=nt+Ae.x,de[Re]=rt+Ae.x,de[Pe+1]=et+Ae.y,de[at+1]=Ke+Ae.y,de[X+1]=Ue+Ae.y,de[Re+1]=He+Ae.y,de[Pe+2]=mt+Ae.z,de[at+2]=ht+Ae.z,de[X+2]=te+Ae.z,de[Re+2]=se+Ae.z,ue[Pe]=E.r,ue[at]=E.r,ue[X]=E.r,ue[Re]=E.r,ue[Pe+1]=E.g,ue[at+1]=E.g,ue[X+1]=E.g,ue[Re+1]=E.g,ue[Pe+2]=E.b,ue[at+2]=E.b,ue[X+2]=E.b,ue[Re+2]=E.b,le=R[0]*H[Fe].x+R[3]*H[Fe].y+R[6]*H[Fe].z,Se=R[0]*H[me].x+R[3]*H[me].y+R[6]*H[me].z,we=R[0]*H[ke].x+R[3]*H[ke].y+R[6]*H[ke].z,Xe=R[0]*H[Qe].x+R[3]*H[Qe].y+R[6]*H[Qe].z,je=R[1]*H[Fe].x+R[4]*H[Fe].y+R[7]*H[Fe].z,K=R[1]*H[me].x+R[4]*H[me].y+R[7]*H[me].z,xe=R[1]*H[ke].x+R[4]*H[ke].y+R[7]*H[ke].z,Me=R[1]*H[Qe].x+R[4]*H[Qe].y+R[7]*H[Qe].z,Ze=R[5]*H[Fe].y+R[8]*H[Fe].z,_e=R[5]*H[me].y+R[8]*H[me].z,Ve=R[5]*H[ke].y+R[8]*H[ke].z,ee=R[5]*H[Qe].y+R[8]*H[Qe].z,ie===0?(fe[Pe]=le,fe[X]=we,fe[Re]=Xe,fe[Pe+1]=je,fe[X+1]=xe,fe[Re+1]=Me,fe[Pe+2]=Ze,fe[X+2]=Ve,fe[Re+2]=ee,ye[j]=Fe+$,ye[j+1]=ke+$,ye[j+2]=Qe+$,B.faceidx+=3):ie===We-1?(fe[Pe]=le,fe[at]=Se,fe[X]=we,fe[Pe+1]=je,fe[at+1]=K,fe[X+1]=xe,fe[Pe+2]=Ze,fe[at+2]=_e,fe[X+2]=Ve,ye[j]=Fe+$,ye[j+1]=me+$,ye[j+2]=ke+$,B.faceidx+=3):(fe[Pe]=le,fe[at]=Se,fe[Re]=Xe,fe[Pe+1]=je,fe[at+1]=K,fe[Re+1]=Me,fe[Pe+2]=Ze,fe[at+2]=_e,fe[Re+2]=ee,fe[at]=Se,fe[X]=we,fe[Re]=Xe,fe[at+1]=K,fe[X+1]=xe,fe[Re+1]=Me,fe[at+2]=_e,fe[X+2]=Ve,fe[Re+2]=ee,ye[j]=Fe+$,ye[j+1]=me+$,ye[j+2]=Qe+$,ye[j+3]=me+$,ye[j+4]=ke+$,ye[j+5]=Qe+$,B.faceidx+=6)}}B.vertices+=Y}v.drawCylinder=f;function b(l,s,y,A,E){if(!s||!y)return;E=E||{r:0,g:0,b:0};let T=new o.Vector3(y.x-s.x,y.y-s.y,y.z-s.z);var u=p(T.x,T.y,T.z);T=T.normalize();var _=x.basisVectors.length,M=x.basisVectors,R=_+2,N=l.updateGeoGroup(R),I=N.vertices,L,Y,B,D,H,W,q=N.vertexArray,V=N.normalArray,$=N.colorArray,O=N.faceArray;for(L=I*3,q[L]=s.x,q[L+1]=s.y,q[L+2]=s.z,V[L]=-T.x,V[L+1]=-T.y,V[L+2]=-T.z,$[L]=E.r,$[L+1]=E.g,$[L+2]=E.b,q[L+3]=y.x,q[L+4]=y.y,q[L+5]=y.z,V[L+3]=T.x,V[L+4]=T.y,V[L+5]=T.z,$[L+3]=E.r,$[L+4]=E.g,$[L+5]=E.b,L+=6,B=0;B<_;++B){var j=M[B].clone();j.multiplyScalar(A),D=u[0]*j.x+u[3]*j.y+u[6]*j.z,H=u[1]*j.x+u[4]*j.y+u[7]*j.z,W=u[5]*j.y+u[8]*j.z,q[L]=D+s.x,q[L+1]=H+s.y,q[L+2]=W+s.z,V[L]=D,V[L+1]=H,V[L+2]=W,$[L]=E.r,$[L+1]=E.g,$[L+2]=E.b,L+=3}for(N.vertices+=_+2,Y=N.faceidx,B=0;B<_;B++){var J=I+2+B,oe=I+2+(B+1)%_;O[Y]=J,O[Y+1]=oe,O[Y+2]=I,Y+=3,O[Y]=J,O[Y+1]=oe,O[Y+2]=I+1,Y+=3}N.faceidx+=6*_}v.drawCone=b;class C{constructor(){this.cache=new Map}getVerticesForRadius(s,y){y=y||2,this.cache.has(y)||this.cache.set(y,new Map);let A=this.cache.get(y);if(A.has(s))return A.get(s);var E={vertices:[],verticesRows:[],normals:[]},T=16*y,u=10*y;s<1&&(T=10*y,u=8*y);var _=0,M=Math.PI*2,R=0,N=Math.PI,I,L;for(L=0;L<=u;L++){let B=[];for(I=0;I<=T;I++){let D=I/T,H=L/u,W=-s*Math.cos(_+D*M)*Math.sin(R+H*N),q=s*Math.cos(R+H*N),V=s*Math.sin(_+D*M)*Math.sin(R+H*N);var Y=new o.Vector3(W,q,V);Y.normalize(),E.vertices.push({x:W,y:q,z:V}),E.normals.push(Y),B.push(E.vertices.length-1)}E.verticesRows.push(B)}return A.set(s,E),E}}var S=new C;function k(l,s,y,A,E){var T=S.getVerticesForRadius(y,E),u=T.vertices,_=T.normals,M=l.updateGeoGroup(u.length),R=M.vertices,N=M.vertexArray,I=M.colorArray,L=M.faceArray,Y=M.lineArray,B=M.normalArray;for(let W=0,q=u.length;W<q;++W){let V=3*(R+W),$=u[W];N[V]=$.x+s.x,N[V+1]=$.y+s.y,N[V+2]=$.z+s.z,I[V]=A.r,I[V+1]=A.g,I[V+2]=A.b}M.vertices+=u.length;let D=T.verticesRows,H=D.length-1;for(let W=0;W<H;W++){let q=D[W].length-1;for(let V=0;V<q;V++){let $=M.faceidx,O=M.lineidx,j=D[W][V+1]+R,J=j*3,oe=D[W][V]+R,ie=oe*3,he=D[W+1][V]+R,de=he*3,fe=D[W+1][V+1]+R,ue=fe*3,ye=_[j-R],ze=_[oe-R],$e=_[he-R],We=_[fe-R];Math.abs(u[j-R].y)===y?(B[J]=ye.x,B[de]=$e.x,B[ue]=We.x,B[J+1]=ye.y,B[de+1]=$e.y,B[ue+1]=We.y,B[J+2]=ye.z,B[de+2]=$e.z,B[ue+2]=We.z,L[$]=j,L[$+1]=he,L[$+2]=fe,Y[O]=j,Y[O+1]=he,Y[O+2]=j,Y[O+3]=fe,Y[O+4]=he,Y[O+5]=fe,M.faceidx+=3,M.lineidx+=6):Math.abs(u[he-R].y)===y?(B[J]=ye.x,B[ie]=ze.x,B[de]=$e.x,B[J+1]=ye.y,B[ie+1]=ze.y,B[de+1]=$e.y,B[J+2]=ye.z,B[ie+2]=ze.z,B[de+2]=$e.z,L[$]=j,L[$+1]=oe,L[$+2]=he,Y[O]=j,Y[O+1]=oe,Y[O+2]=j,Y[O+3]=he,Y[O+4]=oe,Y[O+5]=he,M.faceidx+=3,M.lineidx+=6):(B[J]=ye.x,B[ie]=ze.x,B[ue]=We.x,B[J+1]=ye.y,B[ie+1]=ze.y,B[ue+1]=We.y,B[J+2]=ye.z,B[ie+2]=ze.z,B[ue+2]=We.z,B[ie]=ze.x,B[de]=$e.x,B[ue]=We.x,B[ie+1]=ze.y,B[de+1]=$e.y,B[ue+1]=We.y,B[ie+2]=ze.z,B[de+2]=$e.z,B[ue+2]=We.z,L[$]=j,L[$+1]=oe,L[$+2]=fe,L[$+3]=oe,L[$+4]=he,L[$+5]=fe,Y[O]=j,Y[O+1]=oe,Y[O+2]=j,Y[O+3]=fe,Y[O+4]=oe,Y[O+5]=he,Y[O+6]=he,Y[O+7]=fe,M.faceidx+=6,M.lineidx+=8)}}}v.drawSphere=k})(h||(h={}))}),"./src/GLModel.ts":((r,e,t)=>{t.r(e),t.d(e,{GLModel:()=>k});var o=t("./src/WebGL/index.ts"),c=t("./src/WebGL/shapes/index.ts"),h=t("./src/WebGL/math/index.ts"),v=t("./src/colors.ts"),p=t("./src/GLDraw.ts"),g=t("./src/glcartoon.ts"),x=t("./src/utilities.ts"),f=t("./src/Gradient.ts"),b=t("./src/parsers/index.ts"),C=t("./node_modules/netcdfjs/lib-esm/index.js"),S=t("./src/parsers/utils/assignBonds.ts");class k{static sameObj(s,y){return s&&y?JSON.stringify(s)==JSON.stringify(y):s==y}constructor(s,y){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new h.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=v.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=y||{},this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:v.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=s}getRadiusFromStyle(s,y){var A=this.defaultSphereRadius;if(typeof y.radius<"u")A=y.radius;else if(k.vdwRadii[s.elem])A=k.vdwRadii[s.elem];else if(s.elem.length>1){let E=s.elem;E=E[0].toUpperCase()+E[1].toLowerCase(),k.vdwRadii[E]&&(A=k.vdwRadii[E])}return typeof y.scale<"u"&&(A*=y.scale),A}drawAtomCross(s,y){if(s.style.cross){var A=s.style.cross;if(!A.hidden){var E=A.linewidth||k.defaultlineWidth;y[E]||(y[E]=new o.Geometry);var T=y[E].updateGeoGroup(6),u=this.getRadiusFromStyle(s,A),_=[[u,0,0],[-u,0,0],[0,u,0],[0,-u,0],[0,0,u],[0,0,-u]],M=s.clickable||s.hoverable;M&&s.intersectionShape===void 0&&(s.intersectionShape={sphere:[],cylinder:[],line:[]});for(var R=(0,x.getColorFromStyle)(s,A),N=T.vertexArray,I=T.colorArray,L=0;L<6;L++){var Y=T.vertices*3;if(T.vertices++,N[Y]=s.x+_[L][0],N[Y+1]=s.y+_[L][1],N[Y+2]=s.z+_[L][2],I[Y]=R.r,I[Y+1]=R.g,I[Y+2]=R.b,M){var B=new h.Vector3(_[L][0],_[L][1],_[L][2]);B.multiplyScalar(.1),B.set(B.x+s.x,B.y+s.y,B.z+s.z),s.intersectionShape.line.push(B)}}}}}getGoodCross(s,y,A,E){for(var T=null,u=-1,_=0,M=s.bonds.length;_<M;_++)if(s.bonds[_]!=y.index){let N=s.bonds[_],I=this.atoms[N],L=new h.Vector3(I.x,I.y,I.z).clone();L.sub(A);let Y=L.clone();Y.cross(E);var R=Y.lengthSq();if(R>u&&(u=R,T=Y,u>.1))return T}return T}getSideBondV(s,y,A){var E,T,u,_,M,R=new h.Vector3(s.x,s.y,s.z),N=new h.Vector3(y.x,y.y,y.z),I=N.clone(),L=null;if(I.sub(R),s.bonds.length===1)y.bonds.length===1?(L=I.clone(),Math.abs(L.x)>1e-4?L.y+=1:L.x+=1):(E=(A+1)%y.bonds.length,T=y.bonds[E],u=this.atoms[T],u.index==s.index&&(E=(E+1)%y.bonds.length,T=y.bonds[E],u=this.atoms[T]),_=new h.Vector3(u.x,u.y,u.z),M=_.clone(),M.sub(R),L=M.clone(),L.cross(I));else if(L=this.getGoodCross(s,y,R,I),L.lengthSq()<.01){var Y=this.getGoodCross(y,s,R,I);Y!=null&&(L=Y)}return L.lengthSq()<.01&&(L=I.clone(),Math.abs(L.x)>1e-4?L.y+=1:L.x+=1),L.cross(I),L.normalize(),L}addLine(s,y,A,E,T,u){s[A]=E.x,s[A+1]=E.y,s[A+2]=E.z,y[A]=u.r,y[A+1]=u.g,y[A+2]=u.b,s[A+3]=T.x,s[A+4]=T.y,s[A+5]=T.z,y[A+3]=u.r,y[A+4]=u.g,y[A+5]=u.b}drawBondLines(s,y,A){if(s.style.line){var E=s.style.line;if(!E.hidden){var T,u,_,M,R=E.linewidth||k.defaultlineWidth;A[R]||(A[R]=new o.Geometry);for(var N=A[R].updateGeoGroup(6*s.bonds.length),I=N.vertexArray,L=N.colorArray,Y=0;Y<s.bonds.length;Y++){var B=s.bonds[Y],D=y[B];if(D.style.line&&!(s.index>=D.index)){var H=new h.Vector3(s.x,s.y,s.z),W=new h.Vector3(D.x,D.y,D.z),q=H.clone().add(W).multiplyScalar(.5),V=!1,$=s.clickable||s.hoverable,O=D.clickable||D.hoverable;($||O)&&($&&(s.intersectionShape===void 0&&(s.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),s.intersectionShape.line.push(H),s.intersectionShape.line.push(q)),O&&(D.intersectionShape===void 0&&(D.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),D.intersectionShape.line.push(q),D.intersectionShape.line.push(W)));var j=(0,x.getColorFromStyle)(s,s.style.line),J=(0,x.getColorFromStyle)(D,D.style.line);if(s.bondStyles&&s.bondStyles[Y]){var oe=s.bondStyles[Y];if(!oe.iswire)continue;oe.singleBond&&(V=!0),typeof oe.color1<"u"&&(j=v.CC.color(oe.color1)),typeof oe.color2<"u"&&(J=v.CC.color(oe.color2))}var ie=N.vertices*3,he,de;if(s.bondOrder[Y]>1&&s.bondOrder[Y]<4&&!V){var fe=this.getSideBondV(s,D,Y),ue=W.clone();ue.sub(H),s.bondOrder[Y]==2?(fe.multiplyScalar(.1),T=H.clone(),T.add(fe),u=H.clone(),u.sub(fe),_=T.clone(),_.add(ue),M=u.clone(),M.add(ue),j==J?(N.vertices+=4,this.addLine(I,L,ie,T,_,j),this.addLine(I,L,ie+6,u,M,j)):(N.vertices+=8,ue.multiplyScalar(.5),he=T.clone(),he.add(ue),de=u.clone(),de.add(ue),this.addLine(I,L,ie,T,he,j),this.addLine(I,L,ie+6,he,_,J),this.addLine(I,L,ie+12,u,de,j),this.addLine(I,L,ie+18,de,M,J))):s.bondOrder[Y]==3&&(fe.multiplyScalar(.1),T=H.clone(),T.add(fe),u=H.clone(),u.sub(fe),_=T.clone(),_.add(ue),M=u.clone(),M.add(ue),j==J?(N.vertices+=6,this.addLine(I,L,ie,H,W,j),this.addLine(I,L,ie+6,T,_,j),this.addLine(I,L,ie+12,u,M,j)):(N.vertices+=12,ue.multiplyScalar(.5),he=T.clone(),he.add(ue),de=u.clone(),de.add(ue),this.addLine(I,L,ie,H,q,j),this.addLine(I,L,ie+6,q,W,J),this.addLine(I,L,ie+12,T,he,j),this.addLine(I,L,ie+18,he,_,J),this.addLine(I,L,ie+24,u,de,j),this.addLine(I,L,ie+30,de,M,J)))}else j==J?(N.vertices+=2,this.addLine(I,L,ie,H,W,j)):(N.vertices+=4,this.addLine(I,L,ie,H,q,j),this.addLine(I,L,ie+6,q,W,J))}}}}}drawAtomSphere(s,y){if(s.style.sphere){var A=s.style.sphere;if(!A.hidden){var E=(0,x.getColorFromStyle)(s,A),T=this.getRadiusFromStyle(s,A);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var u=new h.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(u,T))}p.GLDraw.drawSphere(y,s,T,E)}}}drawAtomClickSphere(s){if(s.style.clicksphere){var y=s.style.clicksphere;if(!y.hidden){var A=this.getRadiusFromStyle(s,y);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var E=new h.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(E,A))}}}}drawAtomInstanced(s,y){if(s.style.sphere){var A=s.style.sphere;if(!A.hidden){var E=this.getRadiusFromStyle(s,A),T=(0,x.getColorFromStyle)(s,A),u=y.updateGeoGroup(1),_=u.vertices,M=_*3,R=u.vertexArray,N=u.colorArray,I=u.radiusArray;if(R[M]=s.x,R[M+1]=s.y,R[M+2]=s.z,N[M]=T.r,N[M+1]=T.g,N[M+2]=T.b,I[_]=E,(s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var L=new h.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(L,E))}u.vertices+=1}}}drawSphereImposter(s,y,A,E){var T=s.updateGeoGroup(4),u,_=T.vertices,M=_*3,R=T.vertexArray,N=T.colorArray;for(u=0;u<4;u++)R[M+3*u]=y.x,R[M+3*u+1]=y.y,R[M+3*u+2]=y.z;var I=T.normalArray;for(u=0;u<4;u++)N[M+3*u]=E.r,N[M+3*u+1]=E.g,N[M+3*u+2]=E.b;I[M+0]=-A,I[M+1]=A,I[M+2]=0,I[M+3]=-A,I[M+4]=-A,I[M+5]=0,I[M+6]=A,I[M+7]=-A,I[M+8]=0,I[M+9]=A,I[M+10]=A,I[M+11]=0,T.vertices+=4;var L=T.faceArray,Y=T.faceidx;L[Y+0]=_,L[Y+1]=_+1,L[Y+2]=_+2,L[Y+3]=_+2,L[Y+4]=_+3,L[Y+5]=_,T.faceidx+=6}drawAtomImposter(s,y){if(s.style.sphere){var A=s.style.sphere;if(!A.hidden){var E=this.getRadiusFromStyle(s,A),T=(0,x.getColorFromStyle)(s,A);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var u=new h.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(u,E))}this.drawSphereImposter(y,s,E,T)}}}calculateDashes(s,y,A,E,T){var u=Math.sqrt(Math.pow(s.x-y.x,2)+Math.pow(s.y-y.y,2)+Math.pow(s.z-y.z,2));A=Math.max(A,0),T=Math.max(T,0)+2*A,E=Math.max(E,.001),E+T>u&&(E=u,T=0);var _=Math.floor((u-E)/(E+T))+1,M=_*E;T=(u-M)/_;for(var R,N=new h.Vector3(s.x,s.y,s.z),I=new h.Vector3((y.x-s.x)/(u/T),(y.y-s.y)/(u/T),(y.z-s.z)/(u/T)),L=new h.Vector3((y.x-s.x)/(u/E),(y.y-s.y)/(u/E),(y.z-s.z)/(u/E)),Y=[],B=0;B<_;B++)R=new h.Vector3(N.x+L.x,N.y+L.y,N.z+L.z),Y.push({from:N,to:R}),N=new h.Vector3(R.x+I.x,R.y+I.y,R.z+I.z);return Y}static drawStickImposter(s,y,A,E,T,u=0,_=0){for(var M=s.updateGeoGroup(4),R=M.vertices,N=R*3,I=M.vertexArray,L=M.colorArray,Y=M.radiusArray,B=M.normalArray,D=T.r,H=T.g,W=T.b,q=function(J){var oe=-J;return oe==0&&(oe=-1e-4),oe},V=N,$=0;$<4;$++)I[V]=y.x,B[V]=A.x,L[V]=D,V++,I[V]=y.y,B[V]=A.y,L[V]=H,V++,I[V]=y.z,B[V]=A.z,$<2?L[V]=W:L[V]=q(W),V++;M.vertices+=4,Y[R]=-E,Y[R+1]=E,Y[R+2]=-E,Y[R+3]=E;var O=M.faceArray,j=M.faceidx;O[j+0]=R,O[j+1]=R+1,O[j+2]=R+2,O[j+3]=R+2,O[j+4]=R+3,O[j+5]=R,M.faceidx+=6}drawBondSticks(s,y,A){var E,T;if(s.style.stick){var u=s.style.stick;if(!u.hidden){var _=u.radius||this.defaultStickRadius,M=u.doubleBondScaling||.4,R=u.tripleBondScaling||.25,N=((E=u.dashedBondConfig)===null||E===void 0?void 0:E.dashLength)||.1,I=((T=u.dashedBondConfig)===null||T===void 0?void 0:T.gapLength)||.25,L=_,Y=u.singleBonds||!1,B=u.dashedBonds||!1,D=0,H=0,W,q,V,$,O,j,J,oe,ie,he,de,fe=(0,x.getColorFromStyle)(s,u),ue,ye,ze;!s.capDrawn&&s.bonds.length<4&&(D=2);var $e=xe=>{var Me=A.imposter?k.drawStickImposter:p.GLDraw.drawCylinder;return!B&&xe>=1?Me:(Ze,_e,Ve,ee,Pe,at=0,X=0,Re=.1,Ae=.25)=>{var ne=this.calculateDashes(_e,Ve,ee,Re,Ae);ne.forEach(ve=>{Me(Ze,ve.from,ve.to,ee,Pe,at,X)})}};for(V=0;V<s.bonds.length;V++){var We=$e(s.bondOrder[V]),Fe=s.bonds[V],me=y[Fe];if(ue=ye=ze=null,s.index<me.index){var ke=me.style;if(!ke.stick||ke.stick.hidden)continue;var Qe=(0,x.getColorFromStyle)(me,ke.stick);if(L=_,$=Y,s.bondStyles&&s.bondStyles[V]){if(O=s.bondStyles[V],O.iswire)continue;O.radius&&(L=O.radius),O.singleBond&&($=!0),typeof O.color1<"u"&&(fe=v.CC.color(O.color1)),typeof O.color2<"u"&&(Qe=v.CC.color(O.color2))}var Je=new h.Vector3(s.x,s.y,s.z),Ye=new h.Vector3(me.x,me.y,me.z);if(s.bondOrder[V]<=1||$||s.bondOrder[V]>3){if(s.bondOrder[V]<1&&(L*=s.bondOrder[V]),!me.capDrawn&&me.bonds.length<4&&(H=2),fe!=Qe?(ue=new h.Vector3().addVectors(Je,Ye).multiplyScalar(.5),We(A,Je,ue,L,fe,D,0,N,I),We(A,ue,Ye,L,Qe,0,H,N,I)):We(A,Je,Ye,L,fe,D,H,N,I),W=s.clickable||s.hoverable,q=me.clickable||me.hoverable,W||q){if(ue||(ue=new h.Vector3().addVectors(Je,Ye).multiplyScalar(.5)),W){var nt=new c.Cylinder(Je,ue,L),rt=new c.Sphere(Je,L);s.intersectionShape.cylinder.push(nt),s.intersectionShape.sphere.push(rt)}if(q){var et=new c.Cylinder(Ye,ue,L),Ke=new c.Sphere(Ye,L);me.intersectionShape.cylinder.push(et),me.intersectionShape.sphere.push(Ke)}}}else if(s.bondOrder[V]>1){var Ue=0,He=0;L!=_&&(Ue=2,He=2);var mt=Ye.clone(),ht=null;mt.sub(Je);var te,se,le,Se,we;ht=this.getSideBondV(s,me,V),s.bondOrder[V]==2?(te=L*M,ht.multiplyScalar(te*1.5),se=Je.clone(),se.add(ht),le=Je.clone(),le.sub(ht),Se=se.clone(),Se.add(mt),we=le.clone(),we.add(mt),fe!=Qe?(ue=new h.Vector3().addVectors(se,Se).multiplyScalar(.5),ye=new h.Vector3().addVectors(le,we).multiplyScalar(.5),We(A,se,ue,te,fe,Ue,0),We(A,ue,Se,te,Qe,0,He),We(A,le,ye,te,fe,Ue,0),We(A,ye,we,te,Qe,0,He)):(We(A,se,Se,te,fe,Ue,He),We(A,le,we,te,fe,Ue,He)),W=s.clickable||s.hoverable,q=me.clickable||me.hoverable,(W||q)&&(ue||(ue=new h.Vector3().addVectors(se,Se).multiplyScalar(.5)),ye||(ye=new h.Vector3().addVectors(le,we).multiplyScalar(.5)),W&&(j=new c.Cylinder(se,ue,te),J=new c.Cylinder(le,ye,te),s.intersectionShape.cylinder.push(j),s.intersectionShape.cylinder.push(J)),q&&(ie=new c.Cylinder(Se,ue,te),he=new c.Cylinder(we,ye,te),me.intersectionShape.cylinder.push(ie),me.intersectionShape.cylinder.push(he)))):s.bondOrder[V]==3&&(te=L*R,ht.cross(mt),ht.normalize(),ht.multiplyScalar(te*3),se=Je.clone(),se.add(ht),le=Je.clone(),le.sub(ht),Se=se.clone(),Se.add(mt),we=le.clone(),we.add(mt),fe!=Qe?(ue=new h.Vector3().addVectors(se,Se).multiplyScalar(.5),ye=new h.Vector3().addVectors(le,we).multiplyScalar(.5),ze=new h.Vector3().addVectors(Je,Ye).multiplyScalar(.5),We(A,se,ue,te,fe,Ue,0),We(A,ue,Se,te,Qe,0,He),We(A,Je,ze,te,fe,D,0),We(A,ze,Ye,te,Qe,0,H),We(A,le,ye,te,fe,Ue,0),We(A,ye,we,te,Qe,0,He)):(We(A,se,Se,te,fe,Ue,He),We(A,Je,Ye,te,fe,D,H),We(A,le,we,te,fe,Ue,He)),W=s.clickable||s.hoverable,q=me.clickable||me.hoverable,(W||q)&&(ue||(ue=new h.Vector3().addVectors(se,Se).multiplyScalar(.5)),ye||(ye=new h.Vector3().addVectors(le,we).multiplyScalar(.5)),ze||(ze=new h.Vector3().addVectors(Je,Ye).multiplyScalar(.5)),W&&(j=new c.Cylinder(se.clone(),ue.clone(),te),J=new c.Cylinder(le.clone(),ye.clone(),te),oe=new c.Cylinder(Je.clone(),ze.clone(),te),s.intersectionShape.cylinder.push(j),s.intersectionShape.cylinder.push(J),s.intersectionShape.cylinder.push(oe)),q&&(ie=new c.Cylinder(Se.clone(),ue.clone(),te),he=new c.Cylinder(we.clone(),ye.clone(),te),de=new c.Cylinder(Ye.clone(),ze.clone(),te),me.intersectionShape.cylinder.push(ie),me.intersectionShape.cylinder.push(he),me.intersectionShape.cylinder.push(de))))}}}var Xe=!1,je=0,K=!1;for(V=0;V<s.bonds.length;V++)$=Y,s.bondStyles&&s.bondStyles[V]&&(O=s.bondStyles[V],O.singleBond&&($=!0),O.radius&&O.radius!=_&&(K=!0)),($||s.bondOrder[V]==1)&&je++;K?je>0&&(Xe=!0):je==0&&(s.bonds.length>0||u.showNonBonded)&&(Xe=!0),Xe&&(L=_,A.imposter?this.drawSphereImposter(A.sphereGeometry,s,L,fe):p.GLDraw.drawSphere(A,s,L,fe))}}}createMolObj(s,y){y=y||{};var A=new o.Object3D,E=[],T={},u={},_=this.drawAtomSphere,M=null,R=null;y.supportsImposters?(_=this.drawAtomImposter,M=new o.Geometry(!0),M.imposter=!0,R=new o.Geometry(!0,!0),R.imposter=!0,R.sphereGeometry=new o.Geometry(!0),R.sphereGeometry.imposter=!0,R.drawnCaps={}):y.supportsAIA?(_=this.drawAtomInstanced,M=new o.Geometry(!1,!0,!0),M.instanced=!0,R=new o.Geometry(!0)):(M=new o.Geometry(!0),R=new o.Geometry(!0));var N,I,L,Y,B={},D=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(N=0,L=s.length;N<L;N++){var H=s[N];if(H&&H.style){(H.clickable||H.hoverable)&&H.intersectionShape===void 0&&(H.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),Y={line:void 0,cross:void 0,stick:void 0,sphere:void 0};for(I in Y)H.style[I]?H.style[I].opacity?Y[I]=parseFloat(H.style[I].opacity):Y[I]=1:Y[I]=void 0,B[I]?Y[I]!=null&&B[I]!=Y[I]&&(console.log("Warning: "+I+" opacity is ambiguous"),B[I]=1):B[I]=Y[I];_.call(this,H,M),this.drawAtomClickSphere(H),this.drawAtomCross(H,u),this.drawBondLines(H,s,T),this.drawBondSticks(H,s,R),typeof H.style.cartoon<"u"&&!H.style.cartoon.hidden&&(H.style.cartoon.color==="spectrum"&&typeof H.resi=="number"&&!H.hetflag&&(H.resi<D[0]&&(D[0]=H.resi),H.resi>D[1]&&(D[1]=H.resi)),E.push(H))}}if(E.length>0&&(0,g.drawCartoon)(A,E,D,this.defaultCartoonQuality),M&&M.vertices>0){M.initTypedArrays();var W=null,q=null;M.imposter?W=new o.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):M.instanced?(q=new o.Geometry(!0),p.GLDraw.drawSphere(q,{x:0,y:0,z:0},1,new v.Color(.5,.5,.5)),q.initTypedArrays(),W=new o.InstancedMaterial({sphereMaterial:new o.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:q})):W=new o.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),B.sphere<1&&B.sphere>=0&&(W.transparent=!0,W.opacity=B.sphere),q=new o.Mesh(M,W),A.add(q)}if(R.vertices>0){var V=null,$=null,O=R.sphereGeometry;(!O||typeof O.vertices>"u"||O.vertices==0)&&(O=null),R.initTypedArrays(),O&&O.initTypedArrays();var j={ambient:0,vertexColors:!0,reflectivity:0};R.imposter?(V=new o.StickImposterMaterial(j),$=new o.SphereImposterMaterial(j)):(V=new o.MeshLambertMaterial(j),$=new o.MeshLambertMaterial(j),V.wireframe&&(R.setUpWireframe(),O&&O.setUpWireframe())),B.stick<1&&B.stick>=0&&(V.transparent=!0,V.opacity=B.stick,$.transparent=!0,$.opacity=B.stick);var J=new o.Mesh(R,V);if(A.add(J),O){var oe=new o.Mesh(O,$);A.add(oe)}}var ie;for(N in T)if(T.hasOwnProperty(N)){ie=N;var he=new o.LineBasicMaterial({linewidth:ie,vertexColors:!0});B.line<1&&B.line>=0&&(he.transparent=!0,he.opacity=B.line),T[N].initTypedArrays();var de=new o.Line(T[N],he,o.LineStyle.LinePieces);A.add(de)}for(N in u)if(u.hasOwnProperty(N)){ie=N;var fe=new o.LineBasicMaterial({linewidth:ie,vertexColors:!0});B.cross<1&&B.cross>=0&&(fe.transparent=!0,fe.opacity=B.cross),u[N].initTypedArrays();var ue=new o.Line(u[N],fe,o.LineStyle.LinePieces);A.add(ue)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var ye=new o.Object3D,ze;for(ze=0;ze<this.modelData.symmetries.length;ze++){var $e=new o.Object3D;$e=A.clone(),$e.matrix.copy(this.modelData.symmetries[ze]),$e.matrixAutoUpdate=!1,ye.add($e)}return ye}return A}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(s){this.atoms=s.atoms,this.frames=s.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const s=this.modelData.cryst;this.modelData.cryst.matrix=(0,h.conversionMatrix3)(s.a,s.b,s.c,s.alpha,s.beta,s.gamma)}return this.modelData.cryst}else return null}setCrystData(s,y,A,E,T,u){s=s||1,y=y||1,A=A||1,E=E||90,T=T||90,u=u||90;const _=(0,h.conversionMatrix3)(s,y,A,E,T,u);this.modelData.cryst={a:s,b:y,c:A,alpha:E,beta:T,gamma:u,matrix:_}}setCrystMatrix(s){s=s||new h.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:s}}getSymmetries(){return typeof this.modelData.symmetries>"u"&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(s){typeof s>"u"?this.modelData.symmetries=[this.idMatrix]:this.modelData.symmetries=s}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(s,y,A,E){var T=y-s;return T<-A?y+E:T>A?y-E:y}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var s=this.box[0],y=this.box[1],A=this.box[2],E=s*.9,T=y*.9,u=A*.9,_=0;_<this.atomdfs.length;_++)for(var M=this.atomdfs[_],R=1;R<M.length;R++){var N=this.atoms[M[R][0]],I=this.atoms[M[R][1]];N.x=this.adjustCoord(I.x,N.x,E,s),N.y=this.adjustCoord(I.y,N.y,T,y),N.z=this.adjustCoord(I.z,N.z,u,A)}}setFrame(s,y){var A=this.getNumFrames();let E=this;return new Promise(function(T,u){if(A==0&&T(),(s<0||s>=A)&&(s=A-1),E.frames.url!=null){var _=E.frames.url;(0,x.getbin)(_+"/traj/frame/"+s+"/"+E.frames.path,void 0,"POST",void 0).then(function(M){for(var R=new Float32Array(M,44),N=0,I=0;I<E.atoms.length;I++)E.atoms[I].x=R[N++],E.atoms[I].y=R[N++],E.atoms[I].z=R[N++];E.box&&E.atomdfs&&E.adjustCoordinatesToBox(),T()}).catch(u)}else E.atoms=E.frames[s],T();E.molObj=null,E.modelDatas&&s<E.modelDatas.length&&(E.modelData=E.modelDatas[s],E.unitCellObjects&&y&&(y.removeUnitCell(E),y.addUnitCell(E)))})}addFrame(s){this.frames.push(s)}vibrate(s=10,y=1,A=!1,E,T){var u=0,_=s;A&&(u=-s,_=s),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),u<_&&(this.frames=[]),A&&(this.frames.origIndex=s);for(var M=u;M<_;M++){var R=[],N=this.frames.length;if(M==0&&!T){this.frames.push(this.atoms);continue}for(var I=0;I<this.atoms.length;I++){var L=(0,x.getAtomProperty)(this.atoms[I],"dx"),Y=(0,x.getAtomProperty)(this.atoms[I],"dy"),B=(0,x.getAtomProperty)(this.atoms[I],"dz"),D=new h.Vector3(L,Y,B),H=new h.Vector3(this.atoms[I].x,this.atoms[I].y,this.atoms[I].z),W=M*y/s;D.multiplyScalar(W),H.add(D);var q={};for(var V in this.atoms[I])q[V]=this.atoms[I][V];if(q.x=H.x,q.y=H.y,q.z=H.z,R.push(q),E&&T){var $=(0,x.extend)({},T),O=new h.Vector3(L,Y,B);if(O.multiplyScalar(y),O.add(H),$.start=H,$.end=O,$.frame=N,!$.color){var j=q.style.sphere;j||(j=q.style.stick),j||(j=q.style.line),$.color=(0,x.getColorFromStyle)(q,j)}E.addArrow($)}}this.frames.push(R)}}setAtomDefaults(s){for(let y=0;y<s.length;y++){let A=s[y];A&&(A.style=A.style||(0,x.deepCopy)(k.defaultAtomStyle),A.color=A.color||this.ElementColors[A.elem]||this.defaultColor,A.model=this.id,(A.clickable||A.hoverable)&&(A.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(s,y,A={}){var E=k.parseMolData(s,y,A);this.dontDuplicateAtoms=!A.duplicateAssemblyAtoms;var T=E.modelData;if(T&&(Array.isArray(T)?(this.modelData=T[0],A.frames&&(this.modelDatas=T)):this.modelData=T),E.box?this.box=E.box:this.box=null,this.frames.length==0){for(let _=0;_<E.length;_++)E[_].length!=0&&this.frames.push(E[_]);this.frames[0]&&(this.atoms=this.frames[0])}else if(A.frames)for(let _=0;_<E.length;_++)this.frames.push(E[_]);else for(var u=0;u<E.length;u++)this.addAtoms(E[u]);for(let _=0;_<this.frames.length;_++)this.setAtomDefaults(this.frames[_]);A.vibrate&&A.vibrate.frames&&A.vibrate.amplitude&&this.vibrate(A.vibrate.frames,A.vibrate.amplitude),A.style&&this.setStyle({},A.style)}setDontDuplicateAtoms(s){this.dontDuplicateAtoms=s}setModelData(s){this.modelData=s}propertyMatches(s,y){if(s==y)return!0;if(typeof y=="string"&&typeof s=="number"){var A=y.match(/(-?\d+)\s*-\s*(-?\d+)/);if(A){var E=parseInt(A[1]),T=parseInt(A[2]);if(A&&s>=E&&s<=T)return!0}}return!1}static deepCopyAndCache(s,y){if(typeof s!="object"||s==null||s.__cache_created)return s;const A={};for(const E in s){const T=s[E];if(Array.isArray(T)){A[E]=[];for(let u=0;u<T.length;u++)A[E].push(k.deepCopyAndCache(T[u],y))}else typeof T=="object"&&E!="properties"&&E!="model"?A[E]=k.deepCopyAndCache(T,y):A[E]=T;if(E=="and"||E=="or"){const u=[];for(const _ of A[E]){const M=new Set;for(const R of y.selectedAtoms(_))M.add(R.index);u.push(M)}if(E=="and"){const _=function(R,N){const I=new Set;for(const L of N)R.has(L)&&I.add(L);return I};let M=new Set(u[0]);for(const R of u.splice(1))M=_(M,R);A[E].__cached_results=M}else if(E=="or"){const _=new Set;for(const M of u)for(const R of M)_.add(R);A[E].__cached_results=_}}}return A.__cache_created=!0,A}atomIsSelected(s,y){if(typeof y>"u")return!0;var A=!!y.invert,E=!0;for(var T in y)if(T=="and"||T=="or"||T=="not"){if(T=="not"){if(this.atomIsSelected(s,y[T])){E=!1;break}}else if(y[T].__cached_results===void 0&&(y=k.deepCopyAndCache(y,this)),E=y[T].__cached_results.has(s.index),!E)break}else if(T==="predicate"){if(!y.predicate(s)){E=!1;break}}else if(T=="properties"&&s[T]){for(var u in y.properties)if(!u.startsWith("__cache")){if(typeof s.properties[u]>"u"){E=!1;break}if(s.properties[u]!=y.properties[u]){E=!1;break}}}else if(y.hasOwnProperty(T)&&!k.ignoredKeys.has(T)&&!T.startsWith("__cache")){if(typeof s[T]>"u"){E=!1;break}var _=!1;if(T==="bonds"){var M=y[T];if(M!=s.bonds.length){E=!1;break}}else if(Array.isArray(y[T])){var R=y[T],N=s[T];for(let I=0;I<R.length;I++)if(this.propertyMatches(N,R[I])){_=!0;break}if(!_){E=!1;break}}else{let I=y[T];if(!this.propertyMatches(s[T],I)){E=!1;break}}}return A?!E:E}static squaredDistance(s,y){var A=y.x-s.x,E=y.y-s.y,T=y.z-s.z;return A*A+E*E+T*T}expandAtomList(s,y){if(y<=0)return s;for(var A=(0,x.getExtent)(s,void 0),E=[[],[],[]],T=0;T<3;T++)E[0][T]=A[0][T]-y,E[1][T]=A[1][T]+y,E[2][T]=A[2][T];var u=[];for(let N=0;N<this.atoms.length;N++){var _=this.atoms[N].x,M=this.atoms[N].y,R=this.atoms[N].z;_>=E[0][0]&&_<=E[1][0]&&M>=E[0][1]&&M<=E[1][1]&&R>=E[0][2]&&R<=E[1][2]&&(_>=A[0][0]&&_<=A[1][0]&&M>=A[0][1]&&M<=A[1][1]&&R>=A[0][2]&&R<=A[1][2]||u.push(this.atoms[N]))}return u}static getFloat(s){return typeof s=="number"?s:parseFloat(s)}selectedAtoms(s,y){var A=[];s=k.deepCopyAndCache(s||{},this),y||(y=this.atoms);for(var E=y.length,T=0;T<E;T++){var u=y[T];u&&this.atomIsSelected(u,s)&&A.push(u)}if(s.hasOwnProperty("expand")){const q=k.getFloat(s.expand);let V=this.expandAtomList(A,q),$=A.length;const O=q*q;for(let j=0;j<V.length;j++)for(let J=0;J<$;J++){var _=k.squaredDistance(V[j],A[J]);_<O&&_>0&&A.push(V[j])}}if(s.hasOwnProperty("within")&&s.within.hasOwnProperty("sel")&&s.within.hasOwnProperty("distance")){var M=this.selectedAtoms(s.within.sel,this.atoms),R={};const q=k.getFloat(s.within.distance),V=q*q;for(let $=0;$<M.length;$++)for(let O=0;O<A.length;O++){let j=k.squaredDistance(M[$],A[O]);j<V&&j>0&&(R[O]=1)}var N=[];if(s.within.invert)for(let $=0;$<A.length;$++)R[$]||N.push(A[$]);else for(let $ in R)N.push(A[$]);A=N}if(s.hasOwnProperty("byres")){var I={},L=[],Y=[];for(let q=0;q<A.length;q++){let V=A[q];var B=V.chain,D=V.resi;if(I[B]===void 0&&(I[B]={}),V.hasOwnProperty("resi")&&I[B][D]===void 0){for(I[B][D]=!0,Y.push(V);Y.length>0;)if(V=Y.pop(),B=V.chain,D=V.resi,L[V.index]===void 0){L[V.index]=!0;for(var H=0;H<V.bonds.length;H++){var W=this.atoms[V.bonds[H]];L[W.index]===void 0&&W.hasOwnProperty("resi")&&W.chain==B&&W.resi==D&&(Y.push(W),A.push(W))}}}}}return A}addAtoms(s){this.molObj=null;var y=this.atoms.length,A=[],E;for(E=0;E<s.length;E++)typeof s[E].index>"u"&&(s[E].index=E),typeof s[E].serial>"u"&&(s[E].serial=E),A[s[E].index]=y+E;for(E=0;E<s.length;E++){var T=s[E],u=A[T.index],_=(0,x.extend)({},T);_.index=u,_.bonds=[],_.bondOrder=[],_.model=this.id,_.style=_.style||(0,x.deepCopy)(k.defaultAtomStyle),typeof _.color>"u"&&(_.color=this.ElementColors[_.elem]||this.defaultColor);for(var M=T.bonds?T.bonds.length:0,R=0;R<M;R++){var N=A[T.bonds[R]];typeof N<"u"&&(_.bonds.push(N),_.bondOrder.push(T.bondOrder?T.bondOrder[R]:1))}this.atoms.push(_)}}assignBonds(){(0,S.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(s){this.molObj=null;var y=[],A;for(A=0;A<s.length;A++)y[s[A].index]=!0;var E=[];for(A=0;A<this.atoms.length;A++){var T=this.atoms[A];y[T.index]||E.push(T)}this.atoms=[],this.addAtoms(E)}setStyle(s,y,A){typeof y>"u"&&typeof A>"u"&&(y=s,s={}),s=s,typeof y=="string"&&(y=(0,x.specStringToObject)(y));var E=!1,T=this,u=function(M){var R=T.selectedAtoms(s,M);for(let N=0;N<M.length;N++)M[N]&&(M[N].capDrawn=!1);for(let N=0;N<R.length;N++){E=!0,(R[N].clickable||R[N].hoverable)&&(R[N].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),A||(R[N].style={});for(let I in y)y.hasOwnProperty(I)&&(R[N].style[I]=R[N].style[I]||{},Object.assign(R[N].style[I],y[I]))}};if(s.frame!==void 0&&s.frame<this.frames.length){let M=s.frame;M<0&&(M=this.frames.length+M),u(this.frames[M])}else{u(this.atoms);for(var _=0;_<this.frames.length;_++)this.frames[_]!==this.atoms&&u(this.frames[_])}E&&(this.molObj=null)}setClickable(s,y,A){if(y=!!y,A=(0,x.makeFunction)(A),A===null){console.log("Callback is not a function");return}var E=this.selectedAtoms(s,this.atoms),T=E.length;for(let u=0;u<T;u++)E[u].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},E[u].clickable=y,A&&(E[u].callback=A);T>0&&(this.molObj=null)}setHoverable(s,y,A,E){if(y=!!y,A=(0,x.makeFunction)(A),E=(0,x.makeFunction)(E),A===null){console.log("Hover_callback is not a function");return}if(E===null){console.log("Unhover_callback is not a function");return}var T=this.selectedAtoms(s,this.atoms),u=T.length;for(let _=0;_<u;_++)T[_].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},T[_].hoverable=y,A&&(T[_].hover_callback=A),E&&(T[_].unhover_callback=E);u>0&&(this.molObj=null)}enableContextMenu(s,y){y=!!y;var A,E=this.selectedAtoms(s,this.atoms),T=E.length;for(A=0;A<T;A++)E[A].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},E[A].contextMenuEnabled=y;T>0&&(this.molObj=null)}setColorByElement(s,y){if(!(this.molObj!==null&&k.sameObj(y,this.lastColors))){this.lastColors=y;var A=this.selectedAtoms(s,A);A.length>0&&(this.molObj=null);for(var E=0;E<A.length;E++){var T=A[E];typeof y[T.elem]<"u"&&(T.color=y[T.elem])}}}setColorByProperty(s,y,A,E){var T,u,_=this.selectedAtoms(s,_);for(this.lastColors=null,_.length>0&&(this.molObj=null),typeof A=="string"&&typeof f.Gradient.builtinGradients[A]<"u"&&(A=new f.Gradient.builtinGradients[A]),A=A,E||(E=A.range()),E||(E=(0,x.getPropertyRange)(_,y)),T=0;T<_.length;T++){u=_[T];var M=(0,x.getAtomProperty)(u,y);M!=null&&(u.color=A.valueToHex(parseFloat(u.properties[y]),E))}}setColorByFunction(s,y){var A=this.selectedAtoms(s,A);if(typeof y=="function"){this.lastColors=null,A.length>0&&(this.molObj=null);for(let E=0;E<A.length;E++){let T=A[E];T.color=y(T)}}}toCDObject(s=!1){var y={a:[],b:[]};s&&(y.s=[]);for(let E=0;E<this.atoms.length;E++){let T={},u=this.atoms[E];if(T.x=u.x,T.y=u.y,T.z=u.z,u.elem!="C"&&(T.l=u.elem),s){for(var A=0;A<y.s.length&&JSON.stringify(u.style)!==JSON.stringify(y.s[A]);)A++;A===y.s.length&&y.s.push(u.style),A!==0&&(T.s=A)}y.a.push(T);for(let _=0;_<u.bonds.length;_++){let M=E,R=u.bonds[_];if(M>=R)continue;let N={b:M,e:R},I=u.bondOrder[_];I!=1&&(N.o=I),y.b.push(N)}}return y}globj(s,y){(this.molObj===null||y.regen)&&(this.molObj=this.createMolObj(this.atoms,y),this.renderedMolObj&&(s.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),s.add(this.renderedMolObj))}exportVRML(){var s=this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1});return s.vrml()}removegl(s){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),s.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(s,y,A,E){for(var T=this.selectedAtoms(y,T),u=(0,x.deepCopy)(E),_=0;_<T.length;_++){var M=T[_],R=null;typeof M[s]<"u"?R=String(M[s]):typeof M.properties[s]<"u"&&(R=String(M.properties[s])),R!=null&&(u.position=M,A.addLabel(R,u))}}addResLabels(s,y,A,E=!1){var T=[],u=function(M,R){for(var N=M.selectedAtoms(s,N),I={},L=0;L<N.length;L++){var Y=N[L],B=Y.chain,D=Y.resn,H=Y.resi,W=D+""+H;I[B]||(I[B]={}),I[B][W]||(I[B][W]=[]),I[B][W].push(Y)}var q=(0,x.deepCopy)(A);for(let $ in I)if(I.hasOwnProperty($)){var V=I[$];for(let O in V)if(V.hasOwnProperty(O)){let j=V[O],J=new h.Vector3(0,0,0);for(let ie=0;ie<j.length;ie++){let he=j[ie];J.x+=he.x,J.y+=he.y,J.z+=he.z}J.divideScalar(j.length),q.position=J,q.frame=R;let oe=y.addLabel(O,q,void 0,!0);T.push(oe)}}};if(E){var _=this.getNumFrames();let M=this.atoms;for(let R=0;R<_;R++)this.frames[R]&&(this.atoms=this.frames[R],u(this,R));this.atoms=M}else u(this);return T}setupDFS(){this.atomdfs=[];var s=this,y=new Int8Array(this.atoms.length);y.fill(0);for(var A=function(_,M,R){R.push([_,M]);var N=s.atoms[_];y[_]=1;for(var I=0;I<N.bonds.length;I++){var L=N.bonds[I];s.atoms[L]&&!y[L]&&A(L,_,R)}},E=0;E<this.atoms.length;E++){var T=this.atoms[E];if(T&&!y[E]){var u=[];A(E,-1,u),this.atomdfs.push(u)}}}setCoordinatesFromURL(s,y){this.frames=[];var A=this;return this.box&&this.setupDFS(),s.startsWith("http")||(s="http://"+s),(0,x.get)(s+"/traj/numframes/"+y,function(E){if(!isNaN(parseInt(E)))return A.frames.push(A.atoms),A.frames.numFrames=E,A.frames.url=s,A.frames.path=y,A.setFrame(0)})}setCoordinates(s,y){if(y=y||"",!s)return[];if(/\.gz$/.test(y)){y=y.replace(/\.gz$/,"");try{s=(0,x.inflateString)(s)}catch(I){console.log(I)}}var A={mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""};if(A.hasOwnProperty(y)){this.frames=[];for(var E=this.atoms.length,T=k.parseCrd(s,y),u=0;u<T.length;){for(var _=[],M=0;M<E;M++){var R={};for(var N in this.atoms[M])R[N]=this.atoms[M][N];_[M]=R,_[M].x=T[u++],_[M].y=T[u++],_[M].z=T[u++]}this.frames.push(_)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(s){}static parseCrd(s,y){var A=[],E=0;if(y=="pdb")for(var T=s.indexOf(`
ATOM`);T!=-1;){for(;s.slice(T,T+5)==`
ATOM`||s.slice(T,T+7)==`
HETATM`;)A[E++]=parseFloat(s.slice(T+31,T+39)),A[E++]=parseFloat(s.slice(T+39,T+47)),A[E++]=parseFloat(s.slice(T+47,T+55)),T=s.indexOf(`
`,T+54),s.slice(T,T+4)==`
TER`&&(T=s.indexOf(`
`,T+5));T=s.indexOf(`
ATOM`,T)}else if(y=="netcdf"){var u=new C.NetCDFReader(s);A=[].concat.apply([],u.getDataVariable("coordinates"))}else{if(y=="array"||Array.isArray(s))return s.flat(2);{let _=s.indexOf(`
`);y=="inpcrd"&&(_=s.indexOf(`
`,_+1)),s=s.slice(_+1),A=s.match(/\S+/g).map(parseFloat)}}return A}static parseMolData(s,y="",A){if(!s)return[];if(/\.gz$/.test(y)){y=y.replace(/\.gz$/,"");try{y.match(/bcif/i)?s=(0,x.inflateString)(s,!1):s=(0,x.inflateString)(s)}catch(u){console.log(u)}}typeof b.Parsers[y]>"u"&&(y=y.split(".").pop(),typeof b.Parsers[y]>"u"&&(console.log("Unknown format: "+y),s instanceof Uint8Array?y="bcif":s.match(/^@<TRIPOS>MOLECULE/gm)?y="mol2":s.match(/^data_/gm)&&s.match(/^loop_/gm)?y="cif":s.match(/^HETATM/gm)||s.match(/^ATOM/gm)?y="pdb":s.match(/ITEM: TIMESTEP/gm)?y="lammpstrj":s.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?y="sdf":s.match(/^%VERSION\s+VERSION_STAMP/gm)?y="prmtop":y="xyz",console.log("Best guess: "+y)));var E=b.Parsers[y],T=E(s,A);return T}}k.defaultAtomStyle={line:{}},k.defaultlineWidth=1,k.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},k.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"])}),"./src/GLShape.ts":((r,e,t)=>{t.r(e),t.d(e,{GLShape:()=>C,splitMesh:()=>S});var o=t("./src/WebGL/index.ts"),c=t("./src/WebGL/shapes/index.ts"),h=t("./src/WebGL/math/index.ts"),v=t("./src/colors.ts"),p=t("./src/ProteinSurface4.ts"),g=t("./src/VolumeData.ts"),x=t("./src/GLDraw.ts"),f=t("./src/glcartoon.ts"),b=t("./src/utilities.ts");class C{static finalizeGeo(l){var s=l.updateGeoGroup(0);s.vertices>0&&s.truncateArrayBuffers(!0,!0)}static updateColor(l,s){s=s||v.CC.color(s),l.colorsNeedUpdate=!0;var y,A,E;s.constructor!==Array&&(y=s.r,A=s.g,E=s.b);for(let T in l.geometryGroups){let u=l.geometryGroups[T],_=u.colorArray;for(let M=0,R=u.vertices;M<R;++M){if(s.constructor===Array){let N=s[M];y=N.r,A=N.g,E=N.b}_[M*3]=y,_[M*3+1]=A,_[M*3+2]=E}}}static drawArrow(l,s,y){var A=y.start,E=y.end,T=y.radius,u=y.radiusRatio,_=y.mid,M=y.midpos;if(!(A&&E))return;var R=s.updateGeoGroup(51),N=new h.Vector3(E.x,E.y,E.z).sub(A);if(M){let _e=N.length();M>0?_=M/_e:_=(_e+M)/_e}N.multiplyScalar(_);var I=new h.Vector3(A.x,A.y,A.z).add(N),L=N.clone().negate();let Y=new h.Vector3(A.x,A.y,A.z);l.intersectionShape.cylinder.push(new c.Cylinder(Y,I.clone(),T)),l.intersectionShape.sphere.push(new c.Sphere(Y,T));var B=[];B[0]=N.clone(),Math.abs(B[0].x)>1e-4?B[0].y+=1:B[0].x+=1,B[0].cross(N),B[0].normalize(),B[4]=B[0].clone(),B[4].crossVectors(B[0],N),B[4].normalize(),B[8]=B[0].clone().negate(),B[12]=B[4].clone().negate(),B[2]=B[0].clone().add(B[4]).normalize(),B[6]=B[4].clone().add(B[8]).normalize(),B[10]=B[8].clone().add(B[12]).normalize(),B[14]=B[12].clone().add(B[0]).normalize(),B[1]=B[0].clone().add(B[2]).normalize(),B[3]=B[2].clone().add(B[4]).normalize(),B[5]=B[4].clone().add(B[6]).normalize(),B[7]=B[6].clone().add(B[8]).normalize(),B[9]=B[8].clone().add(B[10]).normalize(),B[11]=B[10].clone().add(B[12]).normalize(),B[13]=B[12].clone().add(B[14]).normalize(),B[15]=B[14].clone().add(B[0]).normalize();var D=R.vertices,H=R.vertexArray,W=R.faceArray,q=R.normalArray,V=R.lineArray,$,O,j;for(O=0,j=B.length;O<j;++O){$=3*(D+3*O);var J=B[O].clone().multiplyScalar(T).add(A),oe=B[O].clone().multiplyScalar(T).add(I),ie=B[O].clone().multiplyScalar(T*u).add(I);if(H[$]=J.x,H[$+1]=J.y,H[$+2]=J.z,H[$+3]=oe.x,H[$+4]=oe.y,H[$+5]=oe.z,H[$+6]=ie.x,H[$+7]=ie.y,H[$+8]=ie.z,O>0){var he=H[$-3],de=H[$-2],fe=H[$-1],ue=new h.Vector3(he,de,fe),ye=new h.Vector3(E.x,E.y,E.z),ze=I.clone(),$e=new h.Vector3(ie.x,ie.y,ie.z);l.intersectionShape.triangle.push(new c.Triangle($e,ye,ue)),l.intersectionShape.triangle.push(new c.Triangle(ue.clone(),ze,$e.clone()))}}R.vertices+=48,$=R.vertices*3,H[$]=A.x,H[$+1]=A.y,H[$+2]=A.z,H[$+3]=I.x,H[$+4]=I.y,H[$+5]=I.z,H[$+6]=E.x,H[$+7]=E.y,H[$+8]=E.z,R.vertices+=3;var We,Fe,me,ke,Qe,Je,Ye,nt,rt,et,Ke,Ue,He,mt,ht,te,se,le,Se,we=R.vertices-3,Xe=R.vertices-2,je=R.vertices-1,K=we*3,xe=Xe*3,Me=je*3;for(O=0,j=B.length-1;O<j;++O){var Ze=D+3*O;$=Ze*3,Fe=R.faceidx,me=R.lineidx,ke=Ze,et=ke*3,Qe=Ze+1,Ke=Qe*3,Je=Ze+2,Ue=Je*3,Ye=Ze+4,He=Ye*3,nt=Ze+5,mt=nt*3,rt=Ze+3,ht=rt*3,te=se=B[O],le=Se=B[O+1],q[et]=te.x,q[Ke]=se.x,q[ht]=Se.x,q[et+1]=te.y,q[Ke+1]=se.y,q[ht+1]=Se.y,q[et+2]=te.z,q[Ke+2]=se.z,q[ht+2]=Se.z,q[Ke]=se.x,q[He]=le.x,q[ht]=Se.x,q[Ke+1]=se.y,q[He+1]=le.y,q[ht+1]=Se.y,q[Ke+2]=se.z,q[He+2]=le.z,q[ht+2]=Se.z,q[Ue]=se.x,q[mt]=le.x,q[Ue+1]=se.y,q[mt+1]=le.y,q[Ue+2]=se.z,q[mt+2]=le.z,W[Fe]=ke,W[Fe+1]=Qe,W[Fe+2]=rt,W[Fe+3]=Qe,W[Fe+4]=Ye,W[Fe+5]=rt,W[Fe+6]=ke,W[Fe+7]=rt,W[Fe+8]=we,W[Fe+9]=Je,W[Fe+10]=Xe,W[Fe+11]=nt,W[Fe+12]=Je,W[Fe+13]=je,W[Fe+14]=nt,V[me]=ke,V[me+1]=Qe,V[me+2]=ke,V[me+3]=rt,V[me+4]=Ye,V[me+5]=rt,V[me+6]=ke,V[me+7]=rt,V[me+8]=Je,V[me+9]=Qe,V[me+10]=Je,V[me+11]=nt,V[me+12]=Ye,V[me+13]=nt,V[me+14]=Je,V[me+15]=je,V[me+16]=Je,V[me+17]=nt,V[me+18]=je,V[me+19]=nt,R.faceidx+=15,R.lineidx+=20}We=[D+45,D+46,D+1,D,D+47,D+2],Fe=R.faceidx,me=R.lineidx,ke=We[0],et=ke*3,Qe=We[1],Ke=Qe*3,Je=We[4],Ue=Je*3,Ye=We[2],He=Ye*3,nt=We[5],mt=nt*3,rt=We[3],ht=rt*3,te=se=B[15],le=Se=B[0],q[et]=te.x,q[Ke]=se.x,q[ht]=Se.x,q[et+1]=te.y,q[Ke+1]=se.y,q[ht+1]=Se.y,q[et+2]=te.z,q[Ke+2]=se.z,q[ht+2]=Se.z,q[Ke]=se.x,q[He]=le.x,q[ht]=Se.x,q[Ke+1]=se.y,q[He+1]=le.y,q[ht+1]=Se.y,q[Ke+2]=se.z,q[He+2]=le.z,q[ht+2]=Se.z,q[Ue]=se.x,q[mt]=le.x,q[Ue+1]=se.y,q[mt+1]=le.y,q[Ue+2]=se.z,q[mt+2]=le.z,N.normalize(),L.normalize(),q[K]=L.x,q[xe]=q[Me]=N.x,q[K+1]=L.y,q[xe+1]=q[Me+1]=N.y,q[K+2]=L.z,q[xe+2]=q[Me+2]=N.z,W[Fe]=ke,W[Fe+1]=Qe,W[Fe+2]=rt,W[Fe+3]=Qe,W[Fe+4]=Ye,W[Fe+5]=rt,W[Fe+6]=ke,W[Fe+7]=rt,W[Fe+8]=we,W[Fe+9]=Je,W[Fe+10]=Xe,W[Fe+11]=nt,W[Fe+12]=Je,W[Fe+13]=je,W[Fe+14]=nt,V[me]=ke,V[me+1]=Qe,V[me+2]=ke,V[me+3]=rt,V[me+4]=Ye,V[me+5]=rt,V[me+6]=ke,V[me+7]=rt,V[me+8]=Je,V[me+9]=Qe,V[me+10]=Je,V[me+11]=nt,V[me+12]=Ye,V[me+13]=nt,V[me+14]=Je,V[me+15]=je,V[me+16]=Je,V[me+17]=nt,V[me+18]=je,V[me+19]=nt,R.faceidx+=15,R.lineidx+=20}static updateBoundingFromPoints(l,s,y,A){l.center.set(0,0,0);let E=1/0,T=1/0,u=1/0,_=-1/0,M=-1/0,R=-1/0;l.box&&(E=l.box.min.x,_=l.box.max.x,T=l.box.min.y,M=l.box.max.y,u=l.box.min.z,R=l.box.max.z);for(let Y=0,B=A;Y<B;Y++){var N=y[Y*3],I=y[Y*3+1],L=y[Y*3+2];N<E&&(E=N),I<T&&(T=I),L<u&&(u=L),N>_&&(_=N),I>M&&(M=I),L>R&&(R=L)}l.center.set((_+E)/2,(M+T)/2,(R+u)/2),l.radius=l.center.distanceTo({x:_,y:M,z:R}),l.box={min:{x:E,y:T,z:u},max:{x:_,y:M,z:R}}}static addCustomGeo(l,s,y,A,E){var T=s.addGeoGroup(),u=y.vertexArr,_=y.normalArr,M=y.faceArr;T.vertices=u.length,T.faceidx=M.length;var R,N,I,L,Y,B,D,H,W,q=T.vertexArray,V=T.colorArray;for(A.constructor!==Array&&(H=A.r,W=A.g,L=A.b),B=0,D=T.vertices;B<D;++B)R=B*3,N=u[B],q[R]=N.x,q[R+1]=N.y,q[R+2]=N.z,A.constructor===Array&&(Y=A[B],H=Y.r,W=Y.g,L=Y.b),V[R]=H,V[R+1]=W,V[R+2]=L;if(E)for(B=0,D=T.faceidx/3;B<D;++B){R=B*3,I=M[R],L=M[R+1],Y=M[R+2];var $=new h.Vector3,O=new h.Vector3,j=new h.Vector3;l.intersectionShape.triangle.push(new c.Triangle($.copy(u[I]),O.copy(u[L]),j.copy(u[Y])))}if(E){var J=new h.Vector3(0,0,0),oe=0;for(let de=0;de<s.geometryGroups.length;de++)J.add(s.geometryGroups[de].getCentroid()),oe++;J.divideScalar(oe),C.updateBoundingFromPoints(l.boundingSphere,{centroid:J},q,T.vertices)}if(T.faceArray=new Uint16Array(M),T.truncateArrayBuffers(!0,!0),_.length<T.vertices)T.setNormals();else{var ie=T.normalArray=new Float32Array(T.vertices*3),he;for(B=0,D=T.vertices;B<D;++B)R=B*3,he=_[B],ie[R]=he.x,ie[R+1]=he.y,ie[R+2]=he.z}T.setLineIndices(),T.lineidx=T.lineArray.length}static updateFromStyle(l,s){typeof s.color<"u"?(l.color=s.color||new v.Color,s.color instanceof v.Color||(l.color=v.CC.color(s.color))):l.color=v.CC.color(0),l.wireframe=!!s.wireframe,l.opacity=s.alpha?(0,h.clamp)(s.alpha,0,1):1,typeof s.opacity<"u"&&(l.opacity=(0,h.clamp)(s.opacity,0,1)),l.side=s.side!==void 0?s.side:o.DoubleSide,l.linewidth=typeof s.linewidth>"u"?1:s.linewidth,l.clickable=!!s.clickable,l.callback=(0,b.makeFunction)(s.callback),l.hoverable=!!s.hoverable,l.hover_callback=(0,b.makeFunction)(s.hover_callback),l.unhover_callback=(0,b.makeFunction)(s.unhover_callback),l.contextMenuEnabled=!!s.contextMenuEnabled,l.hidden=s.hidden,l.frame=s.frame}constructor(l){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=o.DoubleSide,this.stylespec=l||{},this.boundingSphere=new c.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},C.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new o.Geometry(!0),this.linegeo=new o.Geometry(!0)}updateStyle(l){for(var s in l)this.stylespec[s]=l[s];if(C.updateFromStyle(this,this.stylespec),l.voldata&&l.volscheme){(0,b.adjustVolumeStyle)(l);const y=l.volscheme,A=l.voldata,E=v.CC,T=y.range()||[-1,1];this.geo.setColors(function(u,_,M){let R=A.getVal(u,_,M);return E.color(y.valueToHex(R,T))}),delete this.color}}addCustom(l){l.vertexArr=l.vertexArr||[],l.faceArr=l.faceArr||[],l.normalArr=l.normalArr||[],C.drawCustom(this,this.geo,l)}addSphere(l){l.center||(l.center=new h.Vector3(0,0,0)),l.radius=l.radius?(0,h.clamp)(l.radius,0,1/0):1.5,l.color=v.CC.color(l.color),this.intersectionShape.sphere.push(new c.Sphere(l.center,l.radius)),x.GLDraw.drawSphere(this.geo,l.center,l.radius,l.color,l.quality),this.components.push({centroid:new h.Vector3(l.center.x,l.center.y,l.center.z)});var s=this.geo.updateGeoGroup(0);C.updateBoundingFromPoints(this.boundingSphere,this.components,s.vertexArray,s.vertices)}addBox(l){var s=l.dimensions||{w:1,h:1,d:1},y;typeof s.w=="number"?y={x:s.w,y:0,z:0}:y=s.w;var A;typeof s.h=="number"?A={x:0,y:s.h,z:0}:A=s.h;var E;typeof s.d=="number"?E={x:0,y:0,z:s.d}:E=s.d;var T=l.corner;T==null&&(l.center!==void 0?T={x:l.center.x-.5*(y.x+A.x+E.x),y:l.center.y-.5*(y.y+A.y+E.y),z:l.center.z-.5*(y.z+A.z+E.z)}:T={x:0,y:0,z:0});var u=[{x:T.x,y:T.y,z:T.z},{x:T.x+y.x,y:T.y+y.y,z:T.z+y.z},{x:T.x+A.x,y:T.y+A.y,z:T.z+A.z},{x:T.x+y.x+A.x,y:T.y+y.y+A.y,z:T.z+y.z+A.z},{x:T.x+E.x,y:T.y+E.y,z:T.z+E.z},{x:T.x+y.x+E.x,y:T.y+y.y+E.y,z:T.z+y.z+E.z},{x:T.x+A.x+E.x,y:T.y+A.y+E.y,z:T.z+A.z+E.z},{x:T.x+y.x+A.x+E.x,y:T.y+y.y+A.y+E.y,z:T.z+y.z+A.z+E.z}],_=[],M=[];_.splice(_.length,0,u[0],u[1],u[2],u[3]),M.splice(M.length,0,0,2,1,1,2,3);var R=4;_.splice(_.length,0,u[2],u[3],u[6],u[7]),M.splice(M.length,0,R+0,R+2,R+1,R+1,R+2,R+3),R+=4,_.splice(_.length,0,u[4],u[5],u[0],u[1]),M.splice(M.length,0,R+0,R+2,R+1,R+1,R+2,R+3),R+=4,_.splice(_.length,0,u[6],u[7],u[4],u[5]),M.splice(M.length,0,R+0,R+2,R+1,R+1,R+2,R+3),R+=4,_.splice(_.length,0,u[3],u[1],u[7],u[5]),M.splice(M.length,0,R+0,R+2,R+1,R+1,R+2,R+3),R+=4,_.splice(_.length,0,u[2],u[6],u[0],u[4]),M.splice(M.length,0,R+0,R+2,R+1,R+1,R+2,R+3),R+=4;var N=(0,b.extend)({},l);N.vertexArr=_,N.faceArr=M,N.normalArr=[],C.drawCustom(this,this.geo,N);var I=new h.Vector3;this.components.push({centroid:I.addVectors(u[0],u[7]).multiplyScalar(.5)});var L=this.geo.updateGeoGroup(0);C.updateBoundingFromPoints(this.boundingSphere,this.components,L.vertexArray,L.vertices)}addCylinder(l){var s,y;l.start?s=new h.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):s=new h.Vector3(0,0,0),l.end?(y=new h.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof y.x>"u"&&(y.x=3)):y=new h.Vector3(0,0,0);var A=l.radius||.1,E=v.CC.color(l.color);this.intersectionShape.cylinder.push(new c.Cylinder(s,y,A)),x.GLDraw.drawCylinder(this.geo,s,y,A,E,l.fromCap,l.toCap);var T=new h.Vector3;this.components.push({centroid:T.addVectors(s,y).multiplyScalar(.5)});var u=this.geo.updateGeoGroup(0);C.updateBoundingFromPoints(this.boundingSphere,this.components,u.vertexArray,u.vertices)}addDashedCylinder(l){l.dashLength=l.dashLength||.25,l.gapLength=l.gapLength||.25;var s;l.start?s=new h.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):s=new h.Vector3(0,0,0);var y;l.end?(y=new h.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof y.x>"u"&&(y.x=3)):y=new h.Vector3(3,0,0);for(var A=l.radius||.1,E=v.CC.color(l.color),T=Math.sqrt(Math.pow(s.x-y.x,2)+Math.pow(s.y-y.y,2)+Math.pow(s.z-y.z,2)),u=T/(l.gapLength+l.dashLength),_=new h.Vector3(l.start.x||0,l.start.y||0,l.start.z||0),M=new h.Vector3(l.end.x,l.end.y||0,l.end.z||0),R=new h.Vector3((y.x-s.x)/(T/l.gapLength),(y.y-s.y)/(T/l.gapLength),(y.z-s.z)/(T/l.gapLength)),N=new h.Vector3((y.x-s.x)/(T/l.dashLength),(y.y-s.y)/(T/l.dashLength),(y.z-s.z)/(T/l.dashLength)),I=0;I<u;I++)M=new h.Vector3(_.x+N.x,_.y+N.y,_.z+N.z),this.intersectionShape.cylinder.push(new c.Cylinder(_,M,A)),x.GLDraw.drawCylinder(this.geo,_,M,A,E,l.fromCap,l.toCap),_=new h.Vector3(M.x+R.x,M.y+R.y,M.z+R.z);var L=new h.Vector3;this.components.push({centroid:L.addVectors(s,y).multiplyScalar(.5)});var Y=this.geo.updateGeoGroup(0);C.updateBoundingFromPoints(this.boundingSphere,this.components,Y.vertexArray,Y.vertices)}addCurve(l){l.points=l.points||[],l.smooth=l.smooth||10,typeof l.fromCap>"u"&&(l.fromCap=2),typeof l.toCap>"u"&&(l.toCap=2);var s=(0,f.subdivide_spline)(l.points,l.smooth);if(s.length<3){console.log("Too few points in addCurve");return}var y=l.radius||.1,A=v.CC.color(l.color),E=0,T=s.length-1,u=s[0].distanceTo(s[1]),_=Math.ceil(2*y/u);if(l.toArrow){T-=_;let I={start:s[T],end:s[s.length-1],radius:y,color:A,mid:1e-4};this.addArrow(I)}if(l.fromArrow){E+=_;let I={start:s[E],end:s[0],radius:y,color:A,mid:1e-4};this.addArrow(I)}for(var M=Math.ceil(s.length/2),R={radius:y,color:A,fromCap:2,toCap:2},N=E;N<T;N++)R.start=s[N],R.end=s[N+1],R.fromCap=2,R.toCap=2,N<M?(R.fromCap=2,R.toCap=0):N>M?(R.fromCap=0,R.toCap=2):(R.fromCap=2,R.toCap=2),this.addCylinder(R)}addLine(l){var s,y;l.start?s=new h.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):s=new h.Vector3(0,0,0),l.end?(y=new h.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof y.x>"u"&&(y.x=3)):y=new h.Vector3(3,0,0);var A=this.geo.updateGeoGroup(2),E=A.vertices,T=E*3,u=A.vertexArray;u[T]=s.x,u[T+1]=s.y,u[T+2]=s.z,u[T+3]=y.x,u[T+4]=y.y,u[T+5]=y.z,A.vertices+=2;var _=A.lineArray,M=A.lineidx;_[M]=E,_[M+1]=E+1,A.lineidx+=2;var R=new h.Vector3;this.components.push({centroid:R.addVectors(s,y).multiplyScalar(.5)}),A=this.geo.updateGeoGroup(0),C.updateBoundingFromPoints(this.boundingSphere,this.components,A.vertexArray,A.vertices)}addArrow(l){if(l.start?l.start=new h.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):l.start=new h.Vector3(0,0,0),l.dir instanceof h.Vector3&&typeof l.length=="number"){var s=l.dir.clone().multiplyScalar(l.length).add(l.start);l.end=s}else l.end?(l.end=new h.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof l.end.x>"u"&&(l.end.x=3)):l.end=new h.Vector3(3,0,0);l.radius=l.radius||.1,l.radiusRatio=l.radiusRatio||1.618034,l.mid=0<l.mid&&l.mid<1?l.mid:.618034,C.drawArrow(this,this.geo,l);var y=new h.Vector3;this.components.push({centroid:y.addVectors(l.start,l.end).multiplyScalar(.5)});var A=this.geo.updateGeoGroup(0);C.updateBoundingFromPoints(this.boundingSphere,this.components,A.vertexArray,A.vertices)}static distance_from(l,s){return Math.sqrt(Math.pow(l.x-s.x,2)+Math.pow(l.y-s.y,2)+Math.pow(l.z-s.z,2))}static inSelectedRegion(l,s,y){for(var A=0;A<s.length;A++)if(C.distance_from(s[A],l)<=y)return!0;return!1}addIsosurface(l,s,y,A){var E=s.isoval!==void 0&&typeof s.isoval=="number"?s.isoval:0,T=!!s.voxel,u=s.smoothness===void 0?1:s.smoothness,_=l.size.x,M=l.size.y,R=l.size.z,N=new Int16Array(_*M*R),I=l.data,L,Y;for(L=0,Y=N.length;L<Y;++L)N[L]=-1;var B=new Uint8Array(_*M*R);for(L=0,Y=I.length;L<Y;++L){var D=E>=0?I[L]-E:E-I[L];D>0&&(B[L]|=C.ISDONE)}var H=[],W=[];p.MarchingCube.march(B,H,W,{fulltable:!0,voxel:T,unitCube:l.unit,origin:l.origin,matrix:l.matrix,nX:_,nY:M,nZ:R}),!T&&u>0&&p.MarchingCube.laplacianSmooth(u,H,W);var q=[],V=[],$=[];if(s.selectedRegion&&s.coords===void 0&&(s.coords=s.selectedRegion),s.coords===void 0&&s.selection!==void 0&&(A?s.coords=A.selectedAtoms(s.selection):console.log("addIsosurface needs viewer is selection provided.")),s.coords!==void 0){var O=s.coords[0].x,j=s.coords[0].y,J=s.coords[0].z,oe=s.coords[0].x,ie=s.coords[0].y,he=s.coords[0].z;for(let me=0;me<s.coords.length;me++)s.coords[me].x>O?O=s.coords[me].x:s.coords[me].x<oe&&(oe=s.coords[me].x),s.coords[me].y>j?j=s.coords[me].y:s.coords[me].y<ie&&(ie=s.coords[me].y),s.coords[me].z>J?J=s.coords[me].z:s.coords[me].z<he&&(he=s.coords[me].z);var de=2;s.radius!==void 0&&(de=s.radius),s.selectedOffset!==void 0&&(de=s.selectedOffset),s.seldist!==void 0&&(de=s.seldist),oe-=de,O+=de,ie-=de,j+=de,he-=de,J+=de;for(let me=0;me<H.length;me++)H[me].x>oe&&H[me].x<O&&H[me].y>ie&&H[me].y<j&&H[me].z>he&&H[me].z<J&&C.inSelectedRegion(H[me],s.coords,de)?(q.push(V.length),V.push(H[me])):q.push(-1);for(let me=0;me+2<W.length;me+=3)q[W[me]]!==-1&&q[W[me+1]]!==-1&&q[W[me+2]]!==-1&&($.push(W[me]-(W[me]-q[W[me]])),$.push(W[me+1]-(W[me+1]-q[W[me+1]])),$.push(W[me+2]-(W[me+2]-q[W[me+2]])));H=V,W=$}C.drawCustom(this,this.geo,{vertexArr:H,faceArr:W,normalArr:[],clickable:s.clickable,hoverable:s.hoverable}),this.updateStyle(s);var fe=new h.Vector3(l.origin.x,l.origin.y,l.origin.z),ue=new h.Vector3(l.size.x*l.unit.x,l.size.y*l.unit.y,l.size.z*l.unit.z),ye=new h.Vector3(0,0,0),ze=fe.clone(),$e=fe.clone().add(ue);for(let me=0;me<H.length;me++)ye.add(H[me]),ze.max(H[me]),$e.min(H[me]);ye.divideScalar(H.length);var We=ye.distanceTo($e),Fe=ye.distanceTo(ze);this.boundingSphere.center=ye,this.boundingSphere.radius=Math.max(We,Fe),typeof y=="function"&&y()}addVolumetricData(l,s,y){l=new g.VolumeData(l,s),this.addIsosurface(l,y)}finalize(){return C.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj(l){if(this.renderedShapeObj&&(l.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){C.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),typeof this.color<"u"&&C.updateColor(this.geo,this.color),this.shapeObj=new o.Object3D;var s=null;this.side==o.DoubleSide?s=new o.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:o.Coloring.VertexColors}):s=new o.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:o.Coloring.VertexColors});var y=new o.Mesh(this.geo,s);if(this.shapeObj.add(y),this.linegeo&&this.linegeo.vertices>0){var A=new o.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),E=new o.Line(this.linegeo,A,o.LineStyle.LinePieces);this.shapeObj.add(E)}this.renderedShapeObj=this.shapeObj.clone(),l.add(this.renderedShapeObj)}}removegl(l){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),l.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}C.ISDONE=2,C.drawCustom=function(k,l,s){var y=s,A=y.vertexArr,E=y.faceArr;(A.length===0||E.length===0)&&console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var T=s.color;typeof T>"u"&&(T=k.color),T=v.CC.color(T);for(var u=S(y),_=0,M=u.length;_<M;_++)C.addCustomGeo(k,l,u[_],u[_].colorArr?u[_].colorArr:T,s.clickable)};function S(k){var l=64e3;if(k.vertexArr.length<l)return[k];var s=[{vertexArr:[],normalArr:[],faceArr:[]}];k.colorArr&&(s.colorArr=[]);var y=[],A=[],E=0,T=k.faceArr;for(let _=0,M=T.length;_<M;_+=3){let R=s[E];for(let N=0;N<3;N++){var u=T[_+N];y[u]!==E&&(y[u]=E,A[u]=R.vertexArr.length,R.vertexArr.push(k.vertexArr[u]),k.normalArr&&k.normalArr[u]&&R.normalArr.push(k.normalArr[u]),k.colorArr&&k.colorArr[u]&&R.colorArr.push(k.colorArr[u])),R.faceArr.push(A[u])}R.vertexArr.length>=l&&(s.push({vertexArr:[],normalArr:[],faceArr:[]}),k.colorArr&&(s.colorArr=[]),E++)}return s}}),"./src/GLViewer.ts":((r,e,t)=>{t.r(e),t.d(e,{CONTEXTS_PER_VIEWPORT:()=>l,GLViewer:()=>s,createStereoViewer:()=>E,createViewer:()=>y,createViewerGrid:()=>A});var o=t("./src/WebGL/index.ts"),c=t("./src/WebGL/math/index.ts"),h=t("./src/colors.ts"),v=t("./src/utilities.ts"),p=t("./src/Gradient.ts"),g=t("./src/GLModel.ts"),x=t("./src/Label.ts"),f=t("./src/GLShape.ts"),b=t("./src/VolumeData.ts"),C=t("./src/ProteinSurface4.ts"),S=t("./src/VolumetricRender.ts"),k=t("./node_modules/upng-js/UPNG.js");const l=16;class s{getWidth(){let u=this.container,_=u.offsetWidth;if(_==0&&u.style.display==="none"){let M=u.style.position,R=u.style.visibility;u.style.display="block",u.style.visibility="hidden",u.style.position="absolute",_=u.offsetWidth,u.style.display="none",u.style.visibility=R,u.style.position=M}return _}getHeight(){let u=this.container,_=u.offsetHeight;if(_==0&&u.style.display==="none"){let M=u.style.position,R=u.style.visibility;u.style.display="block",u.style.visibility="hidden",u.style.position="absolute",_=u.offsetHeight,u.style.display="none",u.style.visibility=R,u.style.position=M}return _}setupRenderer(){this.renderer=new o.Renderer({antialias:this.config.antialias,preserveDrawingBuffer:!0,premultipliedAlpha:!1,id:this.config.id,row:this.config.row,col:this.config.col,rows:this.config.rows,cols:this.config.cols,canvas:this.config.canvas,containerWidth:this.WIDTH,containerHeight:this.HEIGHT,ambientOcclusion:this.config.ambientOcclusion,outline:this.config.outline}),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new o.Scene,this.scene.fog=new o.Fog(this.bgColor,100,200),this.modelGroup=new o.Object3D,this.rotationGroup=new o.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new c.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var u=new o.Light(16777215);u.position=new c.Vector3(.2,.2,1).normalize(),u.intensity=1,this.scene.add(u)}_handleLostContext(u){const _=function(M){const R=M.getBoundingClientRect();return!(R.right<0||R.bottom<0||R.top>(window.innerHeight||document.documentElement.clientHeight)||R.left>(window.innerWidth||document.documentElement.clientWidth))};if(_(this.container)){let M=0;for(let R of document.getElementsByTagName("canvas"))if(_(R)&&R._3dmol_viewer!=null&&(R._3dmol_viewer.resize(),M+=1,M>=l))break}}initContainer(u){this.container=u,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var u=0;for(let M in this.surfaces)if(this.surfaces.hasOwnProperty(M)){var _=parseInt(M);isNaN(_)||_>u&&(u=_)}return u+1}setSlabAndFog(){let u=this.camera.position.z-this.rotationGroup.position.z;u<1&&(u=1),this.camera.near=u+this.slabNear,this.camera.near<1&&(this.camera.near=1),this.camera.far=u+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=u*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.far,this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(u){if(this.renderer.setViewport(),!!this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!u&&this.linkedViewers.length>0))for(var _=this._viewer.getView(),M=0;M<this.linkedViewers.length;M++){var R=this.linkedViewers[M];R.setView(_,!0)}}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let u=0,_=this.models.length;u<_;u++){let M=this.models[u];if(M){let R=M.selectedAtoms({clickable:!0}),N=M.selectedAtoms({hoverable:!0}),I=M.selectedAtoms({contextMenuEnabled:!0});for(let L=0;L<N.length;L++)this.hoverables.push(N[L]);for(let L=0;L<R.length;L++)this.clickables.push(R[L]);for(let L=0;L<I.length;L++)this.contextMenuEnabledObjects.push(I[L])}}for(let u=0,_=this.shapes.length;u<_;u++){let M=this.shapes[u];M&&M.clickable&&this.clickables.push(M),M&&M.hoverable&&this.hoverables.push(M),M&&M.contextMenuEnabled&&this.contextMenuEnabledObjects.push(M)}}handleClickSelection(u,_,M){let R=this.targetedObjects(u,_,this.clickables);if(R.length){var N=R[0].clickable;N.callback!==void 0&&(typeof N.callback!="function"&&(N.callback=(0,v.makeFunction)(N.callback)),typeof N.callback=="function"&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(N)&&this.userContextMenuHandler||N.callback(N,this._viewer,M,this.container,R)))}}canvasOffset(){let u=this.glDOM,_=u.getBoundingClientRect(),M=u.ownerDocument,R=M.documentElement,N=M.defaultView;return{top:_.top+N.pageYOffset-R.clientTop,left:_.left+N.pageXOffset-R.clientLeft}}setHover(u,_,M){this.current_hover!=u&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,v.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,_,this.container,M)),this.current_hover=u,u&&u.hover_callback!==void 0&&(typeof u.hover_callback!="function"&&(u.hover_callback=(0,v.makeFunction)(u.hover_callback)),typeof u.hover_callback=="function"&&u.hover_callback(u,this._viewer,_,this.container,M)))}handleHoverSelection(u,_,M){if(this.hoverables.length==0)return;let R=this.targetedObjects(u,_,this.hoverables);if(R.length){var N=R[0].clickable;this.setHover(N,M,R),this.current_hover=N}else this.setHover(null)}handleHoverContinue(u,_){let M=this.targetedObjects(u,_,this.hoverables);(M.length==0||M[0]===void 0)&&this.setHover(null),M[0]!==void 0&&M[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(u,{allowTolerance:_=u.targetTouches,tolerance:M=5}={}){const R=this.getX(u),N=this.getY(u);if(_){const I=Math.abs(R-this.mouseStartX),L=Math.abs(N-this.mouseStartY);return I<=M&&L<=M}else return R===this.mouseStartX&&N===this.mouseStartY}calcTouchDistance(u){var _=u.targetTouches[0].pageX-u.targetTouches[1].pageX,M=u.targetTouches[0].pageY-u.targetTouches[1].pageY;return Math.hypot(_,M)}getX(u){var _=u.pageX;return _==null&&(_=u.pageX),u.targetTouches&&u.targetTouches[0]?_=u.targetTouches[0].pageX:u.changedTouches&&u.changedTouches[0]&&(_=u.changedTouches[0].pageX),_}getY(u){var _=u.pageY;return _==null&&(_=u.pageY),u.targetTouches&&u.targetTouches[0]?_=u.targetTouches[0].pageY:u.changedTouches&&u.changedTouches[0]&&(_=u.changedTouches[0].pageY),_}isInViewer(u,_){if(this.viewers!=null){var M=this.WIDTH/this.cols,R=this.HEIGHT/this.rows,N=this.canvasOffset(),I=u-N.left,L=_-N.top,Y=this.rows-Math.floor(L/R)-1,B=Math.floor(I/M);if(Y!=this.row||B!=this.col)return!1}return!0}adjustZoomToLimits(u){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let _=this.CAMERA_Z-this.config.lowerZoomLimit;u>_&&(u=_)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let _=this.CAMERA_Z-this.config.upperZoomLimit;u<_&&(u=_)}return u>this.CAMERA_Z-1&&(u=this.CAMERA_Z-1),u}static slerp(u,_,M){if(M==1)return _.clone();if(M==0)return u.clone();let R=u.x*_.x+u.y*_.y+u.z*_.z+u.w*_.w;if(R>.9995){let H=new c.Quaternion(u.x+M*(_.x-u.x),u.y+M*(_.y-u.y),u.z+M*(_.z-u.z),u.w+M*(_.w-u.w));return H.normalize(),H}R<0&&(_=_.clone().multiplyScalar(-1),R=-R),R>1?R=1:R<-1&&(R=-1);var N=Math.acos(R),I=N*M,L=_.clone();L.sub(u.clone().multiplyScalar(R)),L.normalize();var Y=Math.cos(I),B=Math.sin(I),D=new c.Quaternion(u.x*Y+L.x*B,u.y*Y+L.y*B,u.z*Y+L.z*B,u.w*Y+L.w*B);return D.normalize(),D}constructor(u,_={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.slabNear=-50,this.slabFar=50,this.cq=new c.Quaternion(0,0,0,1),this.dq=new c.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=_,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=h.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",typeof this.config.backgroundColor<"u"&&(this.bgColor=h.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,typeof this.config.camerax<"u"&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=u,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new o.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new c.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new c.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new o.Raycaster(new c.Vector3(0,0,0),new c.Vector3(0,0,0)),this.projector=new o.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=h.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),typeof window.ResizeObserver<"u"&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),typeof window.IntersectionObserver<"u"){let M=(R,N)=>{R.forEach(I=>{I.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(M),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(M){console.log("error with glviewer callback: "+M)}}targetedObjects(u,_,M){var R={x:u,y:_,z:-1};return Array.isArray(M)||(M=this.selectedAtoms(M)),M.length==0?[]:(this.raycaster.setFromCamera(R,this.camera),this.raycaster.intersectObjects(this.modelGroup,M))}modelToScreen(u){let _=!1;Array.isArray(u)||(u=[u],_=!0);let M=this.renderer.getXRatio(),R=this.renderer.getYRatio(),N=this.col,I=this.row,L=N*(this.WIDTH/M),Y=(R-I-1)*(this.HEIGHT/R),B=[],D=this.canvasOffset();return u.forEach(H=>{let W=new c.Vector3(H.x,H.y,H.z);W.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector(W,this.camera);let q=this.WIDTH/M*(W.x+1)/2+D.left+L,V=-(this.HEIGHT/R)*(W.y-1)/2+D.top+Y;B.push({x:q,y:V})}),_&&(B=B[0]),B}screenOffsetToModel(u,_,M){var R=u/this.WIDTH,N=_/this.HEIGHT,I=M===void 0?this.rotationGroup.position.z:M,L=this.rotationGroup.quaternion,Y=new c.Vector3(0,0,I);return this.projector.projectVector(Y,this.camera),Y.x+=R*2,Y.y-=N*2,this.projector.unprojectVector(Y,this.camera),Y.z=0,Y.applyQuaternion(L),Y}screenToModelDistance(u,_){let M=this.canvasOffset(),R=new c.Vector3(_.x,_.y,_.z);R.applyMatrix4(this.modelGroup.matrixWorld);let N=R.clone();this.projector.projectVector(R,this.camera);let I=new c.Vector3((u.x-M.left)*2/this.WIDTH-1,(u.y-M.top)*2/-this.HEIGHT+1,R.z);return this.projector.unprojectVector(I,this.camera),I.distanceTo(N)}setViewChangeCallback(u){(typeof u=="function"||u==null)&&(this.viewChangeCallback=u)}setStateChangeCallback(u){(typeof u=="function"||u==null)&&(this.stateChangeCallback=u)}getConfig(){return this.config}setConfig(u){this.config=u,u.ambientOcclusion&&this.renderer.enableAmbientOcclusion(u.ambientOcclusion)}getInternalState(){var u={models:[],surfaces:[],shapes:[],labels:[]};for(let _=0;_<this.models.length;_++)this.models[_]&&(u.models[_]=this.models[_].getInternalState());return u}setInternalState(u){this.clear();var _=u.models;for(let M=0;M<_.length;M++)_[M]&&(this.models[M]=new g.GLModel(M),this.models[M].setInternalState(_[M]));this.render()}setZoomLimits(u,_){typeof u<"u"&&(this.config.lowerZoomLimit=u),_&&(this.config.upperZoomLimit=_),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(u){u.fov!==void 0&&(this.fov=u.fov,this.camera.fov=this.fov),u.z!==void 0&&(this.CAMERA_Z=u.z,this.camera.z=this.CAMERA_Z),u.orthographic!==void 0&&(this.camera.ortho=u.orthographic)}_handleMouseDown(u){if(u.preventDefault(),!this.scene)return;var _=this.getX(u),M=this.getY(u);if(_===void 0)return;this.isDragging=!0,this.mouseButton=u.which,this.mouseStartX=_,this.mouseStartY=M,this.touchHold=!0,this.touchDistanceStart=0,u.targetTouches&&u.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(u)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let R=this;u.targetTouches&&u.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(R.touchHold==!0){R.glDOM=R.renderer.domElement;const N=u.targetTouches[0],I=new PointerEvent("contextmenu",Object.assign(Object.assign({},u),{pageX:N.pageX,pageY:N.pageY,screenX:N.screenX,screenY:N.screenY,clientX:N.clientX,clientY:N.clientY}));R.glDOM.dispatchEvent(I)}},this.longTouchDuration))}_handleMouseUp(u){if(this.touchHold=!1,this.isDragging&&this.scene){var _=this.getX(u),M=this.getY(u);if(this.closeEnoughForClick(u)&&this.isInViewer(_,M)){let R=this.mouseXY(_,M);this.handleClickSelection(R.x,R.y,u)}}this.isDragging=!1}_handleMouseScroll(u){if(u.preventDefault(),!!this.scene){var _=this.getX(u),M=this.getY(u);if(_!==void 0&&!(!this.control_all&&!this.isInViewer(_,M))){var R=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,N=1;if(u.ctrlKey&&(N=-1),u.detail)this.rotationGroup.position.z+=N*R*u.detail/10;else if(u.wheelDelta){let I=u.wheelDelta*600/(u.wheelDelta+600);this.rotationGroup.position.z-=N*R*I/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(u){let _=this;return u=u||1,new Promise(function(M){let R=0,N=_.viewChangeCallback,I=[],L=[],Y=Date.now();_.viewChangeCallback=function(){L.push(Date.now()-Y),Y=Date.now(),I.push(new Promise(B=>{_.getCanvas().toBlob(function(D){D.arrayBuffer().then(B)},"image/png")})),R+=1,R==u&&(_.viewChangeCallback=N,Promise.all(I).then(B=>{let D=[];for(let O=0;O<B.length;O++){let j=(0,k.decode)(B[O]);D.push((0,k.toRGBA8)(j)[0])}let H=_.getCanvas().width,W=_.getCanvas().height,q=(0,k.encode)(D,H,W,0,L),V=new Blob([q],{type:"image/png"}),$=new FileReader;$.onload=function(O){M(O.target.result)},$.readAsDataURL(V)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(u){this.hoverDuration=u}mouseXY(u,_){let M=this.canvasOffset(),R=this.renderer.getXRatio(),N=this.renderer.getYRatio(),I=this.col,L=this.row,Y=I*(this.WIDTH/R),B=(N-L-1)*(this.HEIGHT/N),D=(u-M.left-Y)/(this.WIDTH/R)*2-1,H=-((_-M.top-B)/(this.HEIGHT/N))*2+1;return{x:D,y:H}}_handleMouseMove(u){clearTimeout(this.hoverTimeout),u.preventDefault();let _=this.getX(u),M=this.getY(u);if(_===void 0)return;let R=this.renderer.getXRatio(),N=this.renderer.getYRatio(),I=this.mouseXY(_,M),L=this;this.current_hover!==null&&this.handleHoverContinue(I.x,I.y);var Y=0;if(!(!this.control_all&&!this.isInViewer(_,M))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){L.handleHoverSelection(I.x,I.y,u)},this.hoverDuration)),!!this.isDragging)){u.targetTouches&&(u.targetTouches.length>1||u.targetTouches.length===1&&!this.closeEnoughForClick(u))&&clearTimeout(this.longTouchTimeout);var B=(_-this.mouseStartX)/this.WIDTH,D=(M-this.mouseStartY)/this.HEIGHT;if(this.touchDistanceStart!=0&&u.targetTouches&&u.targetTouches.length==2){var H=this.calcTouchDistance(u);Y=2,D=(H-this.touchDistanceStart)*2/(this.WIDTH+this.HEIGHT)}else u.targetTouches&&u.targetTouches.length==3&&(Y=1);B*=R,D*=N;var W=Math.hypot(B,D),q;if(Y==3||this.mouseButton==3&&u.ctrlKey)this.slabNear=this.cslabNear+B*100,this.slabFar=this.cslabFar-D*100;else if(Y==2||this.mouseButton==3||u.shiftKey)q=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,q<80&&(q=80),this.rotationGroup.position.z=this.cz+D*q,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(Y==1||this.mouseButton==2||u.ctrlKey){var V=this.screenOffsetToModel(R*(_-this.mouseStartX),N*(M-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,V)}else if((Y===0||this.mouseButton==1)&&W!==0){var $=Math.sin(W*Math.PI)/W;this.dq.x=Math.cos(W*Math.PI),this.dq.y=0,this.dq.z=$*B,this.dq.w=-$*D,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(u){if(u.preventDefault(),this.closeEnoughForClick(u)){var R=this.mouseStartX,N=this.mouseStartY,M=this.canvasOffset();let I=this.mouseXY(R,N),L=I.x,Y=I.y,B=this.targetedObjects(L,Y,this.contextMenuEnabledObjects);var _=null;B.length&&(_=B[0].clickable);var M=this.canvasOffset(),R=this.mouseStartX-M.left,N=this.mouseStartY-M.top;this.userContextMenuHandler&&(this.userContextMenuHandler(_,R,N,B,u),this.isDragging=!1)}}setContainer(u){let _=(0,v.getElement)(u)||this.container;return this.initContainer(_),this}setBackgroundColor(u,_){(typeof _>"u"||_<0||_>1)&&(_=1);var M=h.CC.color(u);return this.scene.fog.color=M,this.bgColor=M.getHex(),this.renderer.setClearColorHex(M.getHex(),_),this.show(),this}setProjection(u){this.camera.ortho=u==="orthographic",this.setSlabAndFog()}setViewStyle(u){if(u=u||{},u.style=u.style||"",u.style.includes("outline")){var _={};u.color&&(_.color=h.CC.color(u.color)),u.width&&(_.width=u.width),this.renderer.enableOutline(_)}else this.renderer.disableOutline();if(u.style.includes("ambientOcclusion")){var _={};u.strength&&(_.strength=u.strength),u.radius&&(_.radius=u.radius),this.renderer.enableAmbientOcclusion(_)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(u){return this.WIDTH=u||this.WIDTH,this.updateSize(),this}setHeight(u){return this.HEIGHT=u||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let u=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let _=!1,M=this.container.querySelector("canvas");M&&M!=this.renderer.getCanvas()?this.config.canvas=M:(M.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,_=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),u=!0,_&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),u){let _=this.renderer.supportedExtensions();if(_.regen=!0,this.viewers)for(let M=0,R=this.viewers.length;M<R;M++)for(let N=0,I=this.viewers[M].length;N<I;N++)this.viewers[M][N].render(null,_);this._viewer.render(null,_)}else this.show();return this}getModel(u){return u===void 0?this.models.length==0?null:this.models[this.models.length-1]:u instanceof g.GLModel?u:u in this.models?this.models[u]:this.models.length==0?null:this.models[this.models.length-1]}spin(u,_=1){if(clearInterval(this.spinInterval),typeof u>"u"&&(u="y"),typeof u=="boolean")if(u)u="y";else return;Array.isArray(u)&&(u={x:u[0],y:u[1],z:u[2]});var M=this;this.spinInterval=setInterval(function(){!M.getCanvas().isConnected&&M.renderer.isLost()&&clearInterval(M.spinInterval),M.rotate(1*_,u)},25)}animateMotion(u,_,M,R,N,I){var L=20,Y=Math.ceil(u/L);Y<1&&(Y=1),this.incAnim();var B={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(_){let W=new Array(Y);for(let O=0;O<Y;O++){let j=(O+1)/Y,J={mpos:B.mpos,rz:B.rz,rot:B.rot};J.mpos=M.clone().sub(B.mpos).multiplyScalar(j).add(B.mpos),J.rz=B.rz+j*(R-B.rz),J.rot=s.slerp(B.rot,N,j),J.cam=I.clone().sub(B.cam).multiplyScalar(j).add(B.cam),W[O]=J}let q=0,V=this,$=function(){var O=W[q];q+=1,V.modelGroup.position=O.mpos,V.rotationGroup.position.z=O.rz,V.rotationGroup.quaternion=O.rot,V.camera.lookAt(O.cam),q<W.length?setTimeout($,L):V.decAnim(),V.show()};setTimeout($,L)}else{var D={};let W=1/Y;if(M&&(D.mpos=M.clone().sub(B.mpos).multiplyScalar(W)),typeof R<"u"&&R!=null&&(D.rz=W*(R-B.rz)),N){var H=s.slerp(B.rot,N,W);D.rot=B.rot.clone().inverse().multiply(H)}I&&(D.cam=I.clone().sub(B.cam).multiplyScalar(W));let q=0,V=this,$=function(){q+=1,D.mpos&&V.modelGroup.position.add(D.mpos),D.rz&&(V.rotationGroup.position.z+=D.rz),D.rot&&V.rotationGroup.quaternion.multiply(D.rot),D.cam&&(V.lookingAt.add(D.cam),V.camera.lookAt(V.lookingAt)),q<Y?setTimeout($,L):V.decAnim(),V.show()};setTimeout($,L)}}rotate(u,_="y",M=0,R=!1){if(_=="x"?_={x:1,y:0,z:0}:_=="y"?_={x:0,y:1,z:0}:_=="z"&&(_={x:0,y:0,z:1}),_=="vx"?_={vx:1,vy:0,vz:0}:_=="vy"?_={vx:0,vy:1,vz:0}:_=="vz"&&(_={vx:0,vy:0,vz:1}),typeof _.vx<"u"){var N=new c.Vector3(_.vx,_.vy,_.vz);N.applyQuaternion(this.rotationGroup.quaternion),_={x:N.x,y:N.y,z:N.z}}var I=function(D){var H=Math.sin(D/2),W=Math.cos(D/2),q=0,V=0,$=0;return q=_.x*H,V=_.y*H,$=_.z*H,new c.Quaternion(q,V,$,W).normalize()},L=Math.PI*u/180,Y=I(L);if(M){var B=new c.Quaternion().copy(this.rotationGroup.quaternion).multiply(Y);this.animateMotion(M,R,this.modelGroup.position,this.rotationGroup.position.z,B,this.lookingAt)}else this.rotationGroup.quaternion.multiply(Y),this.show();return this}surfacesFinished(){for(var u in this.surfaces)if(!this.surfaces[u][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var u=this.modelGroup.position,_=this.rotationGroup.quaternion;return[u.x,u.y,u.z,this.rotationGroup.position.z,_.x,_.y,_.z,_.w]}setView(u,_){return u===void 0||!(u instanceof Array||u.length!==8)?this:!this.modelGroup||!this.rotationGroup?this:(this.modelGroup.position.x=u[0],this.modelGroup.position.y=u[1],this.modelGroup.position.z=u[2],this.rotationGroup.position.z=u[3],this.rotationGroup.quaternion.x=u[4],this.rotationGroup.quaternion.y=u[5],this.rotationGroup.quaternion.z=u[6],this.rotationGroup.quaternion.w=u[7],typeof u[8]<"u"&&(this.rotationGroup.position.x=u[8],this.rotationGroup.position.y=u[9]),this.show(_),this)}render(u,_){this.renderer.setViewport(),this.updateClickables();var M=this.getView();this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState());var R,N;for(_||(_=this.renderer.supportedExtensions()),R=0;R<this.models.length;R++)this.models[R]&&this.models[R].globj(this.modelGroup,_);for(R=0;R<this.shapes.length;R++)this.shapes[R]&&(typeof this.shapes[R].frame>"u"||this.viewer_frame<0||this.shapes[R].frame<0||this.shapes[R].frame==this.viewer_frame?this.shapes[R].globj(this.modelGroup,_):this.shapes[R].removegl(this.modelGroup));for(R=0;R<this.labels.length;R++)_.regen&&(this.labels[R].dispose(),this.modelGroup.remove(this.labels[R].sprite),this.labels[R].setContext(),this.modelGroup.add(this.labels[R].sprite)),this.labels[R]&&typeof this.labels[R].frame<"u"&&this.labels[R].frame>=0&&(this.modelGroup.remove(this.labels[R].sprite),(this.viewer_frame<0||this.labels[R].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[R].sprite));for(R in this.surfaces)if(this.surfaces.hasOwnProperty(R)){var I=this.surfaces[R];for(N=0;N<I.length;N++)if(I.hasOwnProperty(N)){var L=I[N].geo;if(!I[N].finished||_.regen){L.verticesNeedUpdate=!0,L.elementsNeedUpdate=!0,L.normalsNeedUpdate=!0,L.colorsNeedUpdate=!0,L.buffersNeedUpdate=!0,L.boundingSphere=null,I[N].mat.needsUpdate=!0,I[N].done&&(I[N].finished=!0),I[N].lastGL&&this.modelGroup.remove(I[N].lastGL);var Y=null;if(I[N].mat instanceof o.LineBasicMaterial?Y=new o.Line(L,I[N].mat):Y=new o.Mesh(L,I[N].mat),I[N].mat.transparent&&I[N].mat.opacity==0?Y.visible=!1:Y.visible=!0,I[N].symmetries.length>1||I[N].symmetries.length==1&&!I[N].symmetries[N].isIdentity()){var B,D=new o.Object3D;for(B=0;B<I[N].symmetries.length;B++){var H=Y.clone();H.matrix=I[N].symmetries[B],H.matrixAutoUpdate=!1,D.add(H)}I[N].lastGL=D,this.modelGroup.add(D)}else I[N].lastGL=Y,this.modelGroup.add(Y)}}}return this.setView(M),typeof u=="function"&&u(this),this}getModelList(u){let _=[];if(typeof u>"u"||typeof u.model>"u")for(let R=0;R<this.models.length;R++)this.models[R]&&_.push(this.models[R]);else{let R=u.model;Array.isArray(R)||(R=[R]);for(let N=0;N<R.length;N++)if(typeof R[N]=="number"){var M=R[N];M<0&&(M+=this.models.length),_.push(this.models[M])}else _.push(R[N])}return _}getAtomsFromSel(u){var _=[];typeof u>"u"&&(u={});var M=this.getModelList(u);for(let R=0;R<M.length;R++)_=_.concat(M[R].selectedAtoms(u));return _}atomIsSelected(u,_){typeof _>"u"&&(_={});for(var M=this.getModelList(_),R=0;R<M.length;R++)if(M[R].atomIsSelected(u,_))return!0;return!1}selectedAtoms(u){return this.getAtomsFromSel(u)}getUniqueValues(u,_){typeof _>"u"&&(_={});var M=this.getAtomsFromSel(_),R={};for(var N in M)if(M[N].hasOwnProperty(u)){var I=M[N][u];R[I]=!0}return Object.keys(R)}pdbData(u){for(var _=this.getAtomsFromSel(u),M="",R=0,N=_.length;R<N;++R)M+=_[R].pdbline+`
`;return M}zoom(u=2,_=0,M=!1){var R=(this.CAMERA_Z-this.rotationGroup.position.z)/u,N=this.CAMERA_Z-R;return _>0?this.animateMotion(_,M,this.modelGroup.position,this.adjustZoomToLimits(N),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(N),this.show()),this}translate(u,_,M=0,R=!1){var N=u/this.WIDTH,I=_/this.HEIGHT,L=new c.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(L,this.camera),L.x-=N,L.y-=I,this.projector.unprojectVector(L,this.camera),L.z=0;var Y=this.lookingAt.clone().add(L);return M>0?this.animateMotion(M,R,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,Y):(this.lookingAt=Y,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(u,_,M=0,R=!1){var N=this.screenOffsetToModel(u,_),I=this.modelGroup.position.clone().add(N);return M>0?this.animateMotion(M,R,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=I,this.show()),this}fitSlab(u){u=u||{};var _=this.getAtomsFromSel(u),M=(0,v.getExtent)(_),R=M[1][0]-M[0][0],N=M[1][1]-M[0][1],I=M[1][2]-M[0][2],L=Math.hypot(R,N,I);return L<5&&(L=5),this.slabNear=-L/1.9,this.slabFar=L/2,this}center(u={},_=0,M=!1){var R,N,I=this.getAtomsFromSel(u),L=(0,v.getExtent)(I);(0,v.isEmptyObject)(u)?(this.shapes.forEach(j=>{if(j&&j.boundingSphere&&j.boundingSphere.center){var J=j.boundingSphere.center,oe=j.boundingSphere.radius;oe>0?(I.push(new c.Vector3(J.x+oe,J.y,J.z)),I.push(new c.Vector3(J.x-oe,J.y,J.z)),I.push(new c.Vector3(J.x,J.y+oe,J.z)),I.push(new c.Vector3(J.x,J.y-oe,J.z)),I.push(new c.Vector3(J.x,J.y,J.z+oe)),I.push(new c.Vector3(J.x,J.y,J.z-oe))):I.push(J)}}),L=(0,v.getExtent)(I),R=I,N=L):(R=this.getAtomsFromSel({}),N=(0,v.getExtent)(R));var Y=new c.Vector3(L[2][0],L[2][1],L[2][2]),B=N[1][0]-N[0][0],D=N[1][1]-N[0][1],H=N[1][2]-N[0][2],W=Math.hypot(B,D,H);W<5&&(W=5),this.slabNear=-W/1.9,this.slabFar=W/2,B=L[1][0]-L[0][0],D=L[1][1]-L[0][1],H=L[1][2]-L[0][2],W=Math.hypot(B,D,H),W<5&&(W=5);for(var q=25,V=0;V<I.length;V++)if(I[V]){var $=Y.distanceToSquared(I[V]);$>q&&(q=$)}W=Math.sqrt(q)*2;var O=Y.clone().multiplyScalar(-1);return _>0?this.animateMotion(_,M,O,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=O,this.show()),this}zoomTo(u={},_=0,M=!1){let R=this.getAtomsFromSel(u),N=(0,v.getExtent)(R),I=N;if((0,v.isEmptyObject)(u)){let J=R&&R.length;if(this.shapes.forEach(oe=>{if(oe&&oe.boundingSphere){if(oe.boundingSphere.box){let de=oe.boundingSphere.box;R.push(new c.Vector3(de.min.x,de.min.y,de.min.z)),R.push(new c.Vector3(de.max.x,de.max.y,de.max.z))}else if(oe.boundingSphere.center){var ie=oe.boundingSphere.center,he=oe.boundingSphere.radius;he>0?(R.push(new c.Vector3(ie.x+he,ie.y,ie.z)),R.push(new c.Vector3(ie.x-he,ie.y,ie.z)),R.push(new c.Vector3(ie.x,ie.y+he,ie.z)),R.push(new c.Vector3(ie.x,ie.y-he,ie.z)),R.push(new c.Vector3(ie.x,ie.y,ie.z+he)),R.push(new c.Vector3(ie.x,ie.y,ie.z-he))):R.push(ie)}}}),I=(0,v.getExtent)(R),!J)for(let oe=0;oe<3;oe++)N[2][oe]=(I[0][oe]+I[1][oe])/2}else{let J=this.getAtomsFromSel({});I=(0,v.getExtent)(J)}var L=new c.Vector3(N[2][0],N[2][1],N[2][2]),Y=I[1][0]-I[0][0],B=I[1][1]-I[0][1],D=I[1][2]-I[0][2],H=Math.hypot(Y,B,D);H<5&&(H=5),this.slabNear=-H/1.9,this.slabFar=H/2,Object.keys(u).length===0&&(this.slabNear=Math.min(-H*2,-50),this.slabFar=Math.max(H*2,50));var W=this.config.minimumZoomToDistance||5;Y=N[1][0]-N[0][0],B=N[1][1]-N[0][1],D=N[1][2]-N[0][2],H=Math.hypot(Y,B,D),H<W&&(H=W);for(var q=W*W,V=0;V<R.length;V++)if(R[V]){var $=L.distanceToSquared(R[V]);$>q&&(q=$)}H=Math.sqrt(q)*2;var O=L.clone().multiplyScalar(-1),j=-(H*.5/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return j=this.adjustZoomToLimits(j),_>0?this.animateMotion(_,M,O,j,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=O,this.rotationGroup.position.z=j,this.show()),this}setSlab(u,_){this.slabNear=u,this.slabFar=_}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(u,_={},M,R=!1){if(M){var N=(0,v.getExtent)(this.getAtomsFromSel(M));_.position={x:N[2][0],y:N[2][1],z:N[2][2]}}var I=new x.Label(u,_);return I.setContext(),this.modelGroup.add(I.sprite),this.labels.push(I),R||this.show(),I}addResLabels(u,_,M=!1){let R=this.labels.length;return this.applyToModels("addResLabels",u,this,_,M),this.show(),this.labels.slice(R)}addPropertyLabels(u,_,M){return this.applyToModels("addPropertyLabels",u,_,this,M),this.show(),this}removeLabel(u){for(var _=0;_<this.labels.length;_++)if(this.labels[_]==u){this.labels.splice(_,1),u.dispose(),this.modelGroup.remove(u.sprite);break}return this.show(),this}removeAllLabels(){for(var u=0;u<this.labels.length;u++)this.labels[u]&&this.labels[u].sprite&&this.modelGroup.remove(this.labels[u].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}setLabelStyle(u,_){return this.modelGroup.remove(u.sprite),u.dispose(),u.stylespec=_,u.setContext(),this.modelGroup.add(u.sprite),this.show(),u}setLabelText(u,_){return this.modelGroup.remove(u.sprite),u.dispose(),u.text=_,u.setContext(),this.modelGroup.add(u.sprite),this.show(),u}addShape(u){u=u||{};var _=new f.GLShape(u);return _.shapePosition=this.shapes.length,this.shapes.push(_),_}removeShape(u){if(!u)return this;for(u.removegl(this.modelGroup),delete this.shapes[u.shapePosition];this.shapes.length>0&&typeof this.shapes[this.shapes.length-1]>"u";)this.shapes.pop();return this}removeAllShapes(){for(var u=0;u<this.shapes.length;u++){var _=this.shapes[u];_&&_.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(u){if(u.hasOwnProperty("x")&&u.hasOwnProperty("y")&&u.hasOwnProperty("z"))return u;var _=this.getAtomsFromSel(u);if(_.length==0)return{x:0,y:0,z:0};var M=(0,v.getExtent)(_);return{x:M[0][0]+(M[1][0]-M[0][0])/2,y:M[0][1]+(M[1][1]-M[0][1])/2,z:M[0][2]+(M[1][2]-M[0][2])/2}}addSphere(u){u=u||{},u.center=this.getSelectionCenter(u.center);var _=new f.GLShape(u);return _.shapePosition=this.shapes.length,_.addSphere(u),this.shapes.push(_),_.finalize(),_}addBox(u={}){u.corner!=null&&(u.corner=this.getSelectionCenter(u.corner)),u.center!=null&&(u.center=this.getSelectionCenter(u.center));var _=new f.GLShape(u);return _.shapePosition=this.shapes.length,_.addBox(u),this.shapes.push(_),_.finalize(),_}addArrow(u={}){u.start=this.getSelectionCenter(u.start),u.end=this.getSelectionCenter(u.end);var _=new f.GLShape(u);return _.shapePosition=this.shapes.length,_.addArrow(u),this.shapes.push(_),_.finalize(),_}addCylinder(u={}){u.start=this.getSelectionCenter(u.start),u.end=this.getSelectionCenter(u.end);var _=new f.GLShape(u);return _.shapePosition=this.shapes.length,u.dashed?_.addDashedCylinder(u):_.addCylinder(u),this.shapes.push(_),_.finalize(),_}addCurve(u={}){var _=new f.GLShape(u);return _.shapePosition=this.shapes.length,_.addCurve(u),this.shapes.push(_),_.finalize(),_}addLine(u={}){u.start=this.getSelectionCenter(u.start),u.end=this.getSelectionCenter(u.end),u.wireframe=!0;var _=new f.GLShape(u);return _.shapePosition=this.shapes.length,u.dashed?_=this.addLineDashed(u,_):_.addLine(u),this.shapes.push(_),_.finalize(),_}addUnitCell(u,_){u=this.getModel(u),_=_||{alabel:"a",blabel:"b",clabel:"c"},_.box=_.box||{},_.astyle=_.astyle||{color:"red",radius:.1,midpos:-1},_.bstyle=_.bstyle||{color:"green",radius:.1,midpos:-1},_.cstyle=_.cstyle||{color:"blue",radius:.1,midpos:-1},_.alabelstyle=_.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},_.blabelstyle=_.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},_.clabelstyle=_.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},u.unitCellObjects&&this.removeUnitCell(u),u.unitCellObjects={shapes:[],labels:[]};var M=u.getCrystData(),R=null;if(M){if(M.matrix)R=M.matrix;else{var N=M.a,I=M.b,L=M.c,Y=M.alpha,B=M.beta,D=M.gamma;Y=Y*Math.PI/180,B=B*Math.PI/180,D=D*Math.PI/180;var H,W,q;H=Math.cos(B),W=(Math.cos(Y)-Math.cos(B)*Math.cos(D))/Math.sin(D),q=Math.sqrt(Math.max(0,1-H*H-W*W)),R=new c.Matrix3(N,I*Math.cos(D),L*H,0,I*Math.sin(D),L*W,0,0,L*q)}var V=[new c.Vector3(0,0,0),new c.Vector3(1,0,0),new c.Vector3(0,1,0),new c.Vector3(0,0,1),new c.Vector3(1,1,0),new c.Vector3(0,1,1),new c.Vector3(1,0,1),new c.Vector3(1,1,1)];if(M.matrix4)for(let O=0;O<V.length;O++)M.size&&V[O].multiplyVectors(V[O],M.size),V[O]=V[O].applyMatrix4(M.matrix4);else for(let O=0;O<V.length;O++)V[O]=V[O].applyMatrix3(R);if(_.box&&!_.box.hidden){_.box.wireframe=!0;var $=new f.GLShape(_.box);$.shapePosition=this.shapes.length,$.addLine({start:V[0],end:V[1]}),$.addLine({start:V[0],end:V[2]}),$.addLine({start:V[1],end:V[4]}),$.addLine({start:V[2],end:V[4]}),$.addLine({start:V[0],end:V[3]}),$.addLine({start:V[3],end:V[5]}),$.addLine({start:V[2],end:V[5]}),$.addLine({start:V[1],end:V[6]}),$.addLine({start:V[4],end:V[7]}),$.addLine({start:V[6],end:V[7]}),$.addLine({start:V[3],end:V[6]}),$.addLine({start:V[5],end:V[7]}),this.shapes.push($),u.unitCellObjects.shapes.push($),$.finalize()}if(!_.astyle.hidden){_.astyle.start=V[0],_.astyle.end=V[1];let O=this.addArrow(_.astyle);u.unitCellObjects.shapes.push(O)}if(!_.bstyle.hidden){_.bstyle.start=V[0],_.bstyle.end=V[2];let O=this.addArrow(_.bstyle);u.unitCellObjects.shapes.push(O)}if(!_.cstyle.hidden){_.cstyle.start=V[0],_.cstyle.end=V[3];let O=this.addArrow(_.cstyle);u.unitCellObjects.shapes.push(O)}if(_.alabel){_.alabelstyle.position=V[1];let O=this.addLabel(_.alabel,_.alabelstyle);u.unitCellObjects.labels.push(O)}if(_.blabel){_.blabelstyle.position=V[2];let O=this.addLabel(_.blabel,_.blabelstyle);u.unitCellObjects.labels.push(O)}if(_.clabel){_.clabelstyle.position=V[3];let O=this.addLabel(_.clabel,_.clabelstyle);u.unitCellObjects.labels.push(O)}}}removeUnitCell(u){if(u=this.getModel(u),u.unitCellObjects){let _=this;u.unitCellObjects.shapes.forEach(function(M){_.removeShape(M)}),u.unitCellObjects.labels.forEach(function(M){_.removeLabel(M)})}delete u.unitCellObjects}replicateUnitCell(u=3,_=u,M=_,R,N,I){R=this.getModel(R);let L=R.getCrystData();if(L){const Y=R.selectedAtoms({}),B=L.matrix;let D=function(W){return W%2==0?-W/2:Math.ceil(W/2)};u<=1&&_<=1&&M<=1&&(I=!0,u=_=M=3);let H=function(W,q,V){return!1};if(I){const W=new c.Matrix3().getInverse3(B);H=function(q,V,$){let O=new c.Vector3(q,V,$).applyMatrix3(W);return!(O.x>-1e-4&&O.x<1.0001&&O.y>-1e-4&&O.y<1.0001&&O.z>-1e-4&&O.z<1.0001)}}for(let W=0;W<u;W++)for(let q=0;q<_;q++)for(let V=0;V<M;V++){if(W==0&&q==0&&V==0)continue;let $=new c.Vector3(D(W),D(q),D(V));$.applyMatrix3(B);let O=[];for(let j=0;j<Y.length;j++){let J=Y[j].x+$.x,oe=Y[j].y+$.y,ie=Y[j].z+$.z;if(H(J,oe,ie))continue;let he={};for(let de in Y[j])he[de]=Y[j][de];he.x=J,he.y=oe,he.z=ie,O.push(he)}R.addAtoms(O)}N&&R.assignBonds()}}addLineDashed(u,_){u.dashLength=u.dashLength||.5,u.gapLength=u.gapLength||.5;var M;u.start?M=new c.Vector3(u.start.x||0,u.start.y||0,u.start.z||0):M=new c.Vector3(0,0,0);var R;u.end?R=new c.Vector3(u.end.x,u.end.y||0,u.end.z||0):R=new c.Vector3(0,0,0);var N=new c.Vector3,I=new c.Vector3,L=new c.Vector3,Y,B,D,H=M.clone(),W=0;for(N.subVectors(R,M),Y=N.length(),N.normalize(),I=N.clone(),L=N.clone(),I.multiplyScalar(u.dashLength),L.multiplyScalar(u.gapLength),B=I.length(),D=L.length();W<Y;){if(W+B>Y){u.start=M,u.end=R,_.addLine(u);break}H.addVectors(M,I),u.start=M,u.end=H,_.addLine(u),M=H.clone(),W+=B,H.addVectors(M,L),M=H.clone(),W+=D}return _.finalize(),_}addCustom(u){u=u||{};var _=new f.GLShape(u);return _.shapePosition=this.shapes.length,_.addCustom(u),this.shapes.push(_),_.finalize(),_}addVolumetricData(u,_,M={}){var R=new b.VolumeData(u,_);return M.hasOwnProperty("transferfn")?this.addVolumetricRender(R,M):this.addIsosurface(R,M)}addIsosurface(u,_={},M){var R=new f.GLShape(_);return R.shapePosition=this.shapes.length,R.addIsosurface(u,_,M,this),this.shapes.push(R),R}addVolumetricRender(u,_){_=_||{};var M=new S.GLVolumetricRender(u,_,this);return M.shapePosition=this.shapes.length,this.shapes.push(M),M}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(u){u?this.scene.fog=new o.Fog(this.bgColor,100,200):(this.config.disableFog=!0,this.show())}setFrame(u){this.viewer_frame=u;let _=this;return new Promise(function(M){var R=_.models.map(function(N){return N.setFrame(u,_)});Promise.all(R).then(function(){M()})})}getFrame(){return this.viewer_frame}getNumFrames(){var u=0;for(let _=0;_<this.models.length;_++)this.models[_].getNumFrames()>u&&(u=this.models[_].getNumFrames());for(let _=0;_<this.shapes.length;_++)this.shapes[_].frame&&this.shapes[_].frame>=u&&(u=this.shapes[_].frame+1);for(let _=0;_<this.labels.length;_++)this.labels[_].frame&&this.labels[_].frame>=u&&(u=this.labels[_].frame+1);return u}animate(u){this.incAnim();var _=100,M="forward",R=1/0;u=u||{},u.interval&&(_=u.interval),u.loop&&(M=u.loop),u.reps&&(R=u.reps);var N=this.getNumFrames(),I=this,L=0;u.startFrame&&(L=u.startFrame%N);var Y=1;u.step&&(Y=u.step,R/=Y);var B=0,D=N*R,H=new Date,W,q,V=function($){H=new Date,$=="forward"?I.setFrame(L).then(function(){L=(L+Y)%N,W()}):$=="backward"?I.setFrame(N-1-L).then(function(){L=(L+Y)%N,W()}):I.setFrame(L).then(function(){L+=Y,Y*=L%(N-1)==0?-1:1,W()})};return W=function(){if(I.render(),!I.getCanvas().isConnected)I.stopAnimate();else if(++B>=D||!I.isAnimated())q.cancel(),I.animationTimers.delete(q),I.decAnim();else{var $=_-(new Date().getTime()-H.getTime());$=$>0?$:0,I.animationTimers.delete(q),q=new v.PausableTimer(V,$,M),I.animationTimers.add(q)}},q=new v.PausableTimer(V,0,M),this.animationTimers.add(q),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(u){u.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(u){u.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(u){u.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(u){return u&&!u.defaultcolors?(u.defaultcolors=this.defaultcolors,u.cartoonQuality=u.cartoonQuality||this.config.cartoonQuality):typeof u>"u"&&(u={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),u}addModel(u,_="",M){M=this.getModelOpt(M);var R=new g.GLModel(this.models.length,M);return R.addMolData(u,_,M),this.models.push(R),R}addModels(u,_,M){M=this.getModelOpt(M),M.multimodel=!0,M.frames=!0;for(var R=g.GLModel.parseMolData(u,_,M),N=0;N<R.length;N++){var I=new g.GLModel(this.models.length,M);I.setAtomDefaults(R[N]),I.addFrame(R[N]),I.setFrame(0),R.modelData&&I.setModelData(R.modelData[N]),I.setDontDuplicateAtoms(!M.duplicateAssemblyAtoms),this.models.push(I)}return this.models}addModelsAsFrames(u,_,M){M=this.getModelOpt(M),M.multimodel=!0,M.frames=!0;var R=new g.GLModel(this.models.length,M);return R.addMolData(u,_,M),this.models.push(R),R}addAsOneMolecule(u,_,M){M=this.getModelOpt(M),M.multimodel=!0,M.onemol=!0;var R=new g.GLModel(this.models.length,M);return R.addMolData(u,_,M),this.models.push(R),R}removeModel(u){if(u=this.getModel(u),!!u){for(u.removegl(this.modelGroup),delete this.models[u.getID()];this.models.length>0&&typeof this.models[this.models.length-1]>"u";)this.models.pop();return this}}removeAllModels(){for(var u=0;u<this.models.length;u++){var _=this.models[u];_&&_.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(u,_){var M={};return _===void 0?M.m=this.models.map(function(R){return R.toCDObject(u)}):M.m=[this.models[_].toCDObject()],JSON.stringify(M)}exportVRML(){var u=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new o.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var _=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=u,_}createModelFrom(u,_=!1){for(var M=new g.GLModel(this.models.length,this.defaultcolors),R=0;R<this.models.length;R++)if(this.models[R]){var N=this.models[R].selectedAtoms(u);M.addAtoms(N),_&&this.models[R].removeAtoms(N)}return this.models.push(M),M}applyToModels(u,_,M,R,N,I,L){for(var Y=this.getModelList(_),B=0;B<Y.length;B++)Y[B][u](_,M,R,N,I,L)}setStyle(u,_){return typeof _>"u"&&(_=u,u={}),this.applyToModels("setStyle",u,_,!1),this}addStyle(u,_){return typeof _>"u"&&(_=u,u={}),this.applyToModels("setStyle",u,_,!0),this}setClickable(u,_,M){return this.applyToModels("setClickable",u,_,M),this}setHoverable(u,_,M,R){return this.applyToModels("setHoverable",u,_,M,R),this}enableContextMenu(u,_){return this.applyToModels("enableContextMenu",u,_),this}vibrate(u,_,M,R){return this.applyToModels("vibrate",u,_,M,this,R),this}setColorByProperty(u,_,M,R){return this.applyToModels("setColorByProperty",u,_,M,R),this}setColorByElement(u,_){return this.applyToModels("setColorByElement",u,_),this}static getAtomsWithin(u,_){var M=[];for(let N=0;N<u.length;N++){var R=u[N];typeof R>"u"||R.x<_[0][0]||R.x>_[1][0]||R.y<_[0][1]||R.y>_[1][1]||R.z<_[0][2]||R.z>_[1][2]||M.push(R)}return M}static volume(u){var _=u[1][0]-u[0][0],M=u[1][1]-u[0][1],R=u[1][2]-u[0][2];return _*M*R}carveUpExtent(u,_,M){let R=[],N={};for(let H=0,W=_.length;H<W;H++)N[_[H].index]=H;let I=function(H){let W=[];for(let q=0,V=H.length;q<V;q++)H[q].index in N&&W.push(N[H[q].index]);return W},L=function(H){let W=[];return W[0]=[H[0][0],H[0][1],H[0][2]],W[1]=[H[1][0],H[1][1],H[1][2]],W},Y=function(H){if(s.volume(H)<s.maxVolume)return[H];var W=H[1][0]-H[0][0],q=H[1][1]-H[0][1],V=H[1][2]-H[0][2],$;W>q&&W>V?$=0:q>W&&q>V?$=1:$=2;var O=L(H),j=L(H),J=(H[1][$]-H[0][$])/2+H[0][$];O[1][$]=J,j[0][$]=J;var oe=Y(O),ie=Y(j);return oe.concat(ie)},B=Y(u),D=6;for(let H=0,W=B.length;H<W;H++){let q=L(B[H]);q[0][0]-=D,q[0][1]-=D,q[0][2]-=D,q[1][0]+=D,q[1][1]+=D,q[1][2]+=D;let V=s.getAtomsWithin(_,q),$=s.getAtomsWithin(M,B[H]);R.push({extent:B[H],atoms:I(V),toshow:I($)})}return R}static generateSurfaceMesh(u,_,M){var R=new o.Geometry(!0),N=R.updateGeoGroup(0),I=[];for(let We=0,Fe=u.length;We<Fe;We++){var L=u[We];L&&(typeof L.surfaceColor<"u"?I[We]=L.surfaceColor:L.color&&(I[We]=h.CC.color(L.color)))}var Y=N.vertexArray,B=_.vertices;for(let We=0,Fe=B.length;We<Fe;We++){let me=N.vertices*3;Y[me]=B[We].x,Y[me+1]=B[We].y,Y[me+2]=B[We].z,N.vertices++}var D=N.colorArray;if(M.voldata&&M.volscheme){var H=M.volscheme,W=M.voldata,q=H.range()||[-1,1];for(let We=0,Fe=B.length;We<Fe;We++){let me=W.getVal(B[We].x,B[We].y,B[We].z),ke=h.CC.color(H.valueToHex(me,q)),Qe=We*3;D[Qe]=ke.r,D[Qe+1]=ke.g,D[Qe+2]=ke.b}}else if(I.length>0)for(let We=0,Fe=B.length;We<Fe;We++){let me=B[We].atomid,ke=We*3;D[ke]=I[me].r,D[ke+1]=I[me].g,D[ke+2]=I[me].b}var V=_.faces;N.faceidx=V.length,R.initTypedArrays();var $=N.vertexArray,O=N.normalArray,j,J,oe,ie;for(let We=0,Fe=V.length;We<Fe;We+=3){var he=V[We],de=V[We+1],fe=V[We+2],ue=he*3,ye=de*3,ze=fe*3;j=new c.Vector3($[ue],$[ue+1],$[ue+2]),J=new c.Vector3($[ye],$[ye+1],$[ye+2]),oe=new c.Vector3($[ze],$[ze+1],$[ze+2]),oe.subVectors(oe,J),j.subVectors(j,J),oe.cross(j),ie=oe,ie.normalize(),O[ue]+=ie.x,O[ye]+=ie.x,O[ze]+=ie.x,O[ue+1]+=ie.y,O[ye+1]+=ie.y,O[ze+1]+=ie.y,O[ue+2]+=ie.z,O[ye+2]+=ie.z,O[ze+2]+=ie.z}N.faceArray=new Uint16Array(V);var $e=new o.Mesh(R,M);return $e}static generateMeshSyncHelper(u,_,M,R,N,I){var L=new C.ProteinSurface;return L.initparm(_,u!==1,I),L.fillvoxels(N,M),L.buildboundary(),(u==C.SurfaceType.SES||u==C.SurfaceType.MS)&&(L.fastdistancemap(),L.boundingatom(!1),L.fillvoxelswaals(N,M)),L.marchingcube(u),L.getFacesAndVertices(R)}static getMatWithStyle(u){let _=null;u.onesided?_=new o.MeshLambertMaterial:_=new o.MeshDoubleLambertMaterial,_.vertexColors=o.Coloring.VertexColors;for(var M in u)M==="color"||M==="map"||u.hasOwnProperty(M)&&(_[M]=u[M]);return u.opacity!==void 0&&(u.opacity===1?_.transparent=!1:_.transparent=!0),_}addMesh(u){var _={geo:u.geometry,mat:u.material,done:!0,finished:!1},M=this.nextSurfID();return this.surfaces[M]=_,M}static shallowCopy(u){var _=[];let M=u.length;for(let R=0;R<M;R++)_[R]=(0,v.extend)({},u[R]);return _}addSurface(u,_={},M={},R,N,I){let L=this.nextSurfID(),Y=null,B=this,D=C.SurfaceType.VDW;typeof u=="string"?s.surfaceTypeMap[u.toUpperCase()]!==void 0?D=s.surfaceTypeMap[u]:console.log("Surface type : "+u+" is not recognized"):typeof u=="number"&&(D=u);var H=null,W=null,q=s.shallowCopy(this.getAtomsFromSel(M));R?H=s.shallowCopy(this.getAtomsFromSel(R)):H=q,(0,v.adjustVolumeStyle)(_);var V=!1,$;for($=0;$<this.models.length;$++)if(this.models[$]){var O=this.models[$].getSymmetries();if(O.length>1||O.length==1&&!O[0].isIdentity()){V=!0;break}}var j=function(fe,ue,ye){N?W=s.shallowCopy(B.getAtomsFromSel(N)):W=ye;var ze,$e=(0,v.getExtent)(ye,!0);if(_.map&&_.map.prop){var We=_.map.prop;let Ue=(0,p.getGradient)(_.map.scheme||_.map.gradient||new p.Gradient.RWB),He=Ue.range();He||(He=(0,v.getPropertyRange)(ye,We)),_.colorscheme={prop:We,gradient:Ue}}for(let Ue=0,He=ue.length;Ue<He;Ue++)ze=ue[Ue],ze.surfaceColor=(0,v.getColorFromStyle)(ze,_);var Fe=s.volume($e),me=B.carveUpExtent($e,ue,ye);if(W&&W.length&&W.length>0){var ke=(0,v.getExtent)(W,!0),Qe=function(Ue,He){var mt=function(se,le){var Se=se.extent,we=Se[1][0]-Se[0][0],Xe=Se[1][1]-Se[0][1],je=Se[1][2]-Se[0][2],K=we-le[2][0];K*=K;var xe=Xe-le[2][1];xe*=xe;var Me=je-le[2][2];return Me*=Me,K+xe+Me},ht=mt(Ue,ke),te=mt(He,ke);return ht-te};me.sort(Qe)}var Je=[];for(let Ue=0,He=ue.length;Ue<He;Ue++)ze=ue[Ue],Je[Ue]={x:ze.x,y:ze.y,z:ze.z,serial:Ue,elem:ze.elem};var Ye=!!C.syncSurface;if(Ye){var nt=function(Ue){return new Promise(function(He){for(var mt=s.generateMeshSyncHelper(D,me[Ue].extent,me[Ue].atoms,me[Ue].toshow,Je,Fe),ht=(0,f.splitMesh)({vertexArr:mt.vertices,faceArr:mt.faces}),te=0,se=ht.length;te<se;te++){mt={vertices:ht[te].vertexArr,faces:ht[te].faceArr};var le=s.generateSurfaceMesh(ue,mt,Y);(0,v.mergeGeos)(fe.geo,le)}B.render(),He()})},rt=[];for(let Ue=0;Ue<me.length;Ue++)rt.push(nt(Ue));return Promise.all(rt).then(function(){return fe.done=!0,Promise.resolve(L)})}else{var et=[];D<0&&(D=0);for(let Ue=0,He=s.numWorkers;Ue<He;Ue++){var Ke=new Worker($3Dmol.SurfaceWorker);et.push(Ke),Ke.postMessage({type:-1,atoms:Je,volume:Fe})}return new Promise(function(Ue,He){var mt=0,ht=function(){!et||!et.length||et.forEach(function(Se){Se&&Se.terminate&&Se.terminate()})},te=function(Se){for(var we=(0,f.splitMesh)({vertexArr:Se.data.vertices,faceArr:Se.data.faces}),Xe=0,je=we.length;Xe<je;Xe++){var K={vertices:we[Xe].vertexArr,faces:we[Xe].faceArr},xe=s.generateSurfaceMesh(ue,K,Y);(0,v.mergeGeos)(fe.geo,xe)}B.render(),mt++,mt==me.length&&(fe.done=!0,ht(),Ue(L))},se=function(Se){ht(),console.log(Se.message+" ("+Se.filename+":"+Se.lineno+")"),He(Se)};for(let Se=0;Se<me.length;Se++){var le=et[Se%et.length];le.onmessage=te,le.onerror=se,le.postMessage({type:D,expandedExtent:me[Se].extent,extendedAtoms:me[Se].atoms,atomsToShow:me[Se].toshow})}})}};_=_||{},Y=s.getMatWithStyle(_);var J=[];J.style=_,J.atomsel=M,J.allsel=R,J.focus=N;var oe=null;if(V){var ie={},he={};for($=0;$<this.models.length;$++)ie[$]=[],he[$]=[];for($=0;$<H.length;$++)ie[H[$].model].push(H[$]);for($=0;$<q.length;$++)he[q[$].model].push(q[$]);var de=[];for($=0;$<this.models.length;$++)he[$].length>0&&(J.push({geo:new o.Geometry(!0),mat:Y,done:!1,finished:!1,symmetries:this.models[$].getSymmetries()}),de.push(j(J[J.length-1],ie[$],he[$])));oe=Promise.all(de)}else J.push({geo:new o.Geometry(!0),mat:Y,done:!1,finished:!1,symmetries:[new c.Matrix4]}),oe=j(J[J.length-1],H,q);return this.surfaces[L]=J,oe.surfid=L,I&&typeof I=="function"?(oe.then(function(fe){I(fe)}),L):oe}setSurfaceMaterialStyle(u,_){if((0,v.adjustVolumeStyle)(_),this.surfaces[u]){var M=this.surfaces[u];M.style=_;for(var R=0;R<M.length;R++){var N=M[R].mat=s.getMatWithStyle(_);if(M[R].mat.side=o.FrontSide,_.color){M[R].mat.color=_.color,M[R].geo.colorsNeedUpdate=!0;const I=h.CC.color(_.color);M[R].geo.setColors(function(){return I})}else if(N.voldata&&N.volscheme){const I=N.volscheme,L=N.voldata,Y=h.CC,B=I.range()||[-1,1];M[R].geo.setColors(function(D,H,W){let q=L.getVal(D,H,W);return Y.color(I.valueToHex(q,B))})}M[R].finished=!1}}return this}getSurface(u){return this.surfaces[u]}removeSurface(u){for(var _=this.surfaces[u],M=0;M<_.length;M++)_[M]&&_[M].lastGL&&(_[M].geo!==void 0&&_[M].geo.dispose(),_[M].mat!==void 0&&_[M].mat.dispose(),this.modelGroup.remove(_[M].lastGL));return delete this.surfaces[u],this.show(),this}removeAllSurfaces(){for(var u in this.surfaces)if(this.surfaces.hasOwnProperty(u)){for(var _=this.surfaces[u],M=0;M<_.length;M++)_[M]&&_[M].lastGL&&(_[M].geo!==void 0&&_[M].geo.dispose(),_[M].mat!==void 0&&_[M].mat.dispose(),this.modelGroup.remove(_[M].lastGL));delete this.surfaces[u]}return this.show(),this}jmolMoveTo(){var u=this.modelGroup.position,_="center { "+-u.x+" "+-u.y+" "+-u.z+" }; ",M=this.rotationGroup.quaternion;return _+="moveto .5 quaternion { "+M.x+" "+M.y+" "+M.z+" "+M.w+" };",_}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(u,_){_=_||{};var M=this.getAtomsFromSel(_);if(typeof u=="function")for(let I=0,L=M.length;I<L;I++){let Y=M[I];u(Y)}else for(let I=0,L=M.length;I<L;I++){var R=M[I];for(let Y=0,B=u.length;Y<B;Y++){let D=u[Y];if(D.props)for(var N in D.props)D.props.hasOwnProperty(N)&&this.atomIsSelected(R,D)&&(R.properties||(R.properties={}),R.properties[N]=D.props[N])}}return this}linkViewer(u){return this.linkedViewers.push(u),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(u){this.rotationGroup.position.z=this.CAMERA_Z-u}setAutoEyeSeparation(u,_){var M=this.getPerceivedDistance();return _||(_=5),u||this.camera.position.x>0?this.camera.position.x=M*Math.tan(Math.PI/180*_):this.camera.position.x=-M*Math.tan(Math.PI/180*_),this.camera.lookAt(new c.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(u){this.config.cartoonQuality=u}}s.numWorkers=4,s.maxVolume=64e3,s.surfaceTypeMap={VDW:C.SurfaceType.VDW,MS:C.SurfaceType.MS,SAS:C.SurfaceType.SAS,SES:C.SurfaceType.SES};function y(T,u){if(T=(0,v.getElement)(T),!!T){u=u||{};try{var _=new s(T,u);return _}catch(M){throw"error creating viewer: "+M}}}function A(T,u={},_={}){if(T=(0,v.getElement)(T),!!T){var M=[],R=document.createElement("canvas");_.rows=u.rows,_.cols=u.cols,_.control_all=u.control_all!=null?u.control_all:!1,T.appendChild(R);try{for(var N=0;N<u.rows;N++){for(var I=[],L=0;L<u.cols;L++){_.row=N,_.col=L,_.canvas=R,_.viewers=M,_.control_all=u.control_all;var Y=y(T,(0,v.extend)({},_));I.push(Y)}M.unshift(I)}}catch(B){throw"error creating viewer grid: "+B}return M}}function E(T){var u=this;if(T=(0,v.getElement)(T),!!T){var _=A(T,{rows:1,cols:2,control_all:!0});this.glviewer1=_[0][0],this.glviewer2=_[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var M=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(N){return typeof u.glviewer1[N]=="function"}),R=0;R<M.length;R++)this[M[R]]=(function(N){return function(){var I=this.glviewer1[N].apply(this.glviewer1,arguments),L=this.glviewer2[N].apply(this.glviewer2,arguments);return[I,L]}})(M[R]);this.setCoordinates=function(N,I,L){for(var Y=0;Y<N.length;Y++)N[Y].setCoordinates(I,L)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(N){this.glviewer1.render(),this.glviewer2.render(),N&&N(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}}),"./src/Gradient.ts":((r,e,t)=>{t.r(e),t.d(e,{CustomLinear:()=>f,Gradient:()=>C,GradientType:()=>c,ROYGB:()=>g,RWB:()=>p,Sinebow:()=>x,builtinGradients:()=>b,getGradient:()=>v,normalizeValue:()=>h});var o=t("./src/colors.ts");class c{}function h(S,k,l){return k>=S?(l<S&&(l=S),l>k&&(l=k),{lo:S,hi:k,val:l}):(l>S&&(l=S),l<k&&(l=k),l=S-l+k,{lo:k,hi:S,val:l})}function v(S){if(S instanceof c)return S;if(S.gradient!==void 0&&b[S.gradient]){let k=S.min===void 0?-1:S.min,l=S.max===void 0?1:S.max;return S.mid===void 0?S.colors===void 0?new b[S.gradient](k,l):new b[S.gradient](k,l,S.colors):new b[S.gradient](k,l,S.mid)}else if(typeof S.gradient=="string"&&S.gradient.startsWith("linear_")){let k=S.gradient.split("_");k.shift();let l=S.min===void 0?-1:S.min,s=S.max===void 0?1:S.max;return new f(l,s,k)}return S}class p extends c{constructor(k,l,s){super(),this.gradient="RWB",this.mult=1,this.mid=s,this.min=k,this.max=l,typeof l>"u"&&Array.isArray(k)&&k.length>=2?(this.max=k[1],this.min=k[0]):k&&l&&!Array.isArray(k)&&(this.min=k,this.max=l)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(k,l){var s,y;if(k=this.mult*k,l?(s=l[0],y=l[1]):(s=this.min,y=this.max),k===void 0)return 16777215;var A=h(s,y,k);s=A.lo,y=A.hi,k=A.val;var E=(y+s)/2;l&&typeof l[2]<"u"?E=l[2]:typeof this.mid<"u"?E=this.mid:E=(s+y)/2;var T,u;return k<E?(T=Math.floor(255*Math.sqrt((k-s)/(E-s))),u=16711680+256*T+T,u):k>E?(T=Math.floor(255*Math.sqrt(1-(k-E)/(y-E))),u=65536*T+256*T+255,u):16777215}}class g extends c{constructor(k,l){super(),this.gradient="ROYGB",this.mult=1,this.min=k,this.max=l,typeof l>"u"&&Array.isArray(k)&&k.length>=2?(this.max=k[1],this.min=k[0]):k&&l&&!Array.isArray(k)&&(this.min=k,this.max=l)}valueToHex(k,l){var s,y;if(k=this.mult*k,l?(s=l[0],y=l[1]):(s=this.min,y=this.max),typeof k>"u")return 16777215;var A=h(s,y,k);s=A.lo,y=A.hi,k=A.val;var E=(s+y)/2,T=(s+E)/2,u=(E+y)/2,_,M;return k<T?(_=Math.floor(255*Math.sqrt((k-s)/(T-s))),M=16711680+256*_+0,M):k<E?(_=Math.floor(255*Math.sqrt(1-(k-T)/(E-T))),M=65536*_+65280+0,M):k<u?(_=Math.floor(255*Math.sqrt((k-E)/(u-E))),M=65280+1*_,M):(_=Math.floor(255*Math.sqrt(1-(k-u)/(y-u))),M=0+256*_+255,M)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class x extends c{constructor(k,l){super(),this.gradient="Sinebow",this.mult=1,this.min=k,this.max=l,typeof l>"u"&&Array.isArray(k)&&k.length>=2&&(this.max=k[1],this.min=k[0]),l<k&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(k,l){var s,y;if(k=this.mult*k,l?(s=l[0],y=l[1]):(s=this.min,y=this.max),typeof k>"u")return 16777215;var A=C.normalizeValue(s,y,k);s=A.lo,y=A.hi,k=A.val;var E=(k-s)/(y-s),T=5*E/6+.5,u=Math.sin(Math.PI*T);u*=u*255;var _=Math.sin(Math.PI*(T+1/3));_*=_*255;var M=Math.sin(Math.PI*(T+2/3));return M*=M*255,65536*Math.floor(u)+256*Math.floor(M)+1*Math.floor(_)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class f extends c{constructor(k,l,s){super(),this.gradient="linear",this.colors=new Array;var y;if(Array.isArray(k)&&k.length>=2?(this.max=k[1],this.min=k[0],y=l):(this.min=k,this.max=l,y=s),y)for(let A of y)this.colors.push(o.CC.color(A));else this.colors.push(o.CC.color(0))}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(k,l){var s,y;if(l?(s=l[0],y=l[1]):(s=this.min,y=this.max),k===void 0)return 16777215;var A=h(s,y,k);s=A.lo,y=A.hi,k=A.val;let E=this.colors.length,T=(y-s)/E,u=Math.min(Math.floor((k-s)/T),E-1),_=Math.min(u+1,E-1),M=(k-s-u*T)/T,R=this.colors[u],N=this.colors[_];return new o.Color(R.r+M*(N.r-R.r),R.g+M*(N.g-R.g),R.b+M*(N.b-R.b)).getHex()}}const b={rwb:p,RWB:p,roygb:g,ROYGB:g,sinebow:x,linear:f};class C extends c{valueToHex(k,l){return 0}range(){return null}}C.RWB=p,C.ROYGB=g,C.Sinebow=x,C.CustomLinear=f,C.builtinGradients=b,C.normalizeValue=h,C.getGradient=v}),"./src/Label.ts":((r,e,t)=>{t.r(e),t.d(e,{Label:()=>x,LabelCount:()=>v});var o=t("./src/WebGL/index.ts"),c=t("./src/Gradient.ts"),h=t("./src/colors.ts");let v=0;function p(f,b,C,S,k,l,s){f.beginPath(),f.moveTo(b+l,C),f.lineTo(b+S-l,C),f.quadraticCurveTo(b+S,C,b+S,C+l),f.lineTo(b+S,C+k-l),f.quadraticCurveTo(b+S,C+k,b+S-l,C+k),f.lineTo(b+l,C+k),f.quadraticCurveTo(b,C+k,b,C+k-l),f.lineTo(b,C+l),f.quadraticCurveTo(b,C,b+l,C),f.closePath(),f.fill(),s&&f.stroke()}function g(f,b,C){var S=C;return typeof f<"u"&&(f instanceof h.Color?S=f.scaled():(S=h.CC.color(f),typeof S.scaled<"u"&&(S=S.scaled()))),typeof b<"u"&&(S.a=parseFloat(b)),S}class x{constructor(b,C){this.id=v++,this.stylespec=C||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new o.Sprite,this.text=b,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}setContext(){var b=this.stylespec,C=typeof b.useScreen>"u"?!1:b.useScreen,S=b.showBackground;(S==="0"||S==="false")&&(S=!1),typeof S>"u"&&(S=!0);var k=b.font?b.font:"sans-serif",l=parseInt(b.fontSize)?parseInt(b.fontSize):18,s=g(b.fontColor,b.fontOpacity,{r:255,g:255,b:255,a:1}),y=b.padding?b.padding:4,A=b.borderThickness?b.borderThickness:0,E=g(b.backgroundColor,b.backgroundOpacity,{r:0,g:0,b:0,a:1}),T=g(b.borderColor,b.borderOpacity,E),u=b.position?b.position:{x:-10,y:1,z:1},_=b.inFront!==void 0?b.inFront:!0;(_==="false"||_==="0")&&(_=!1);var M=b.alignment||o.SpriteAlignment.topLeft;typeof M=="string"&&M in o.SpriteAlignment&&(M=o.SpriteAlignment[M]);var R="";b.bold&&(R="bold "),this.context.font=R+l+"px  "+k;var N=this.context.measureText(this.text),I=N.width;S||(A=0);var L=I+2.5*A+2*y,Y=l*1.25+2*A+2*y;if(b.backgroundImage){var B=b.backgroundImage,D=b.backgroundWidth?b.backgroundWidth:B.width,H=b.backgroundHeight?b.backgroundHeight:B.height;D>L&&(L=D),H>Y&&(Y=H)}if(this.canvas.width=L,this.canvas.height=Y,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),R="",b.bold&&(R="bold "),this.context.font=R+l+"px  "+k,this.context.fillStyle="rgba("+E.r+","+E.g+","+E.b+","+E.a+")",this.context.strokeStyle="rgba("+T.r+","+T.g+","+T.b+","+T.a+")",b.backgroundGradient){let q=this.context.createLinearGradient(0,Y/2,L,Y/2),V=c.Gradient.getGradient(b.backgroundGradient),$=V.range(),O=-1,j=1;$&&(O=$[0],j=$[1]);let J=j-O;for(let oe=0;oe<1.01;oe+=.1){let ie=g(V.valueToHex(O+J*oe)),he="rgba("+ie.r+","+ie.g+","+ie.b+","+ie.a+")";q.addColorStop(oe,he)}this.context.fillStyle=q}this.context.lineWidth=A,S&&p(this.context,A,A,L-2*A,Y-2*A,6,A>0),b.backgroundImage&&this.context.drawImage(B,0,0,L,Y),this.context.fillStyle="rgba("+s.r+","+s.g+","+s.b+","+s.a+")",this.context.fillText(this.text,A+y,l+A+y,I);var W=new o.Texture(this.canvas);W.needsUpdate=!0,this.sprite.material=new o.SpriteMaterial({map:W,useScreenCoordinates:C,alignment:M,depthTest:!_,screenOffset:b.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(u.x,u.y,u.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}}),"./src/ProteinSurface4.ts":((r,e,t)=>{t.r(e),t.d(e,{MarchingCube:()=>g,MarchingCubeInitializer:()=>p,PointGrid:()=>x,ProteinSurface:()=>f,SurfaceType:()=>c,setSyncSurface:()=>v,syncSurface:()=>h});var o=t("./src/WebGL/math/index.ts"),c;(function(b){b[b.VDW=1]="VDW",b[b.MS=2]="MS",b[b.SAS=3]="SAS",b[b.SES=4]="SES"})(c||(c={}));var h=!1;function v(b){h=b}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&(h=!0);class p{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(C,S,k,l){let s=!!l.fulltable,y=l.hasOwnProperty("origin")&&l.origin.hasOwnProperty("x")?l.origin:{x:0,y:0,z:0},A=!!l.voxel,E=l.matrix,T=l.nX||0,u=l.nY||0,_=l.nZ||0,M=l.scale||1,R=null;l.unitCube?R=l.unitCube:R={x:M,y:M,z:M};let N=new Int32Array(T*u*_),I,L;for(I=0,L=N.length;I<L;++I)N[I]=-1;let Y=function(W,q,V,$,O,j){let J={x:0,y:0,z:0},oe=!!($&1<<O),ie=!!($&1<<j),he=O;if(!oe&&ie&&(he=j),he&1&&V++,he&2&&q++,he&4&&W++,E){let fe=new o.Vector3(W,q,V);fe=fe.applyMatrix4(E),J={x:fe.x,y:fe.y,z:fe.z}}else J.x=y.x+R.x*W,J.y=y.y+R.y*q,J.z=y.z+R.z*V;let de=(u*W+q)*_+V;return A?(S.push(J),S.length-1):(N[de]<0&&(N[de]=S.length,S.push(J)),N[de])},B=new Int32Array(12),D=s?this.edgeTable2:this.edgeTable,H=s?this.triTable2:this.triTable;for(I=0;I<T-1;++I)for(let W=0;W<u-1;++W)for(let q=0;q<_-1;++q){let V=0;for(let j=0;j<8;++j){let J=(u*(I+((j&4)>>2))+W+((j&2)>>1))*_+q+(j&1),oe=!!(C[J]&this.ISDONE);V|=oe<<j}if(V===0||V===255)continue;let $=D[V];if($===0)continue;let O=H[V];$&1&&(B[0]=Y(I,W,q,V,0,1)),$&2&&(B[1]=Y(I,W,q,V,1,3)),$&4&&(B[2]=Y(I,W,q,V,3,2)),$&8&&(B[3]=Y(I,W,q,V,2,0)),$&16&&(B[4]=Y(I,W,q,V,4,5)),$&32&&(B[5]=Y(I,W,q,V,5,7)),$&64&&(B[6]=Y(I,W,q,V,7,6)),$&128&&(B[7]=Y(I,W,q,V,6,4)),$&256&&(B[8]=Y(I,W,q,V,0,4)),$&512&&(B[9]=Y(I,W,q,V,1,5)),$&1024&&(B[10]=Y(I,W,q,V,3,7)),$&2048&&(B[11]=Y(I,W,q,V,2,6));for(let j=0;j<O.length;j+=3){let J=B[O[j]],oe=B[O[j+1]],ie=B[O[j+2]];A&&j>=3&&(S.push(S[J]),J=S.length-1,S.push(S[oe]),oe=S.length-1,S.push(S[ie]),ie=S.length-1),k.push(J),k.push(oe),k.push(ie)}}}laplacianSmooth(C,S,k){let l=new Array(S.length),s,y,A,E,T;for(s=0,y=S.length;s<y;s++)l[s]={x:0,y:0,z:0};let u=new Array(20),_;for(s=0;s<20;s++)u[s]=new Array(S.length);for(s=0,y=S.length;s<y;s++)u[0][s]=0;for(s=0,y=k.length/3;s<y;s++){let N=s*3,I=s*3+1,L=s*3+2;for(_=!0,A=0,E=u[0][k[N]];A<E;A++)if(k[I]==u[A+1][k[N]]){_=!1;break}for(_&&(u[0][k[N]]++,u[u[0][k[N]]][k[N]]=k[I]),_=!0,A=0,E=u[0][k[N]];A<E;A++)if(k[L]==u[A+1][k[N]]){_=!1;break}for(_&&(u[0][k[N]]++,u[u[0][k[N]]][k[N]]=k[L]),_=!0,A=0,E=u[0][k[I]];A<E;A++)if(k[N]==u[A+1][k[I]]){_=!1;break}for(_&&(u[0][k[I]]++,u[u[0][k[I]]][k[I]]=k[N]),_=!0,A=0,E=u[0][k[I]];A<E;A++)if(k[L]==u[A+1][k[I]]){_=!1;break}for(_&&(u[0][k[I]]++,u[u[0][k[I]]][k[I]]=k[L]),_=!0,A=0;A<u[0][k[L]];A++)if(k[N]==u[A+1][k[L]]){_=!1;break}for(_&&(u[0][k[L]]++,u[u[0][k[L]]][k[L]]=k[N]),_=!0,A=0,E=u[0][k[L]];A<E;A++)if(k[I]==u[A+1][k[L]]){_=!1;break}_&&(u[0][k[L]]++,u[u[0][k[L]]][k[L]]=k[I])}let M=1,R=.5;for(T=0;T<C;T++){for(s=0,y=S.length;s<y;s++)if(u[0][s]<3)l[s].x=S[s].x,l[s].y=S[s].y,l[s].z=S[s].z;else if(u[0][s]==3||u[0][s]==4){for(l[s].x=0,l[s].y=0,l[s].z=0,A=0,E=u[0][s];A<E;A++)l[s].x+=S[u[A+1][s]].x,l[s].y+=S[u[A+1][s]].y,l[s].z+=S[u[A+1][s]].z;l[s].x+=R*S[s].x,l[s].y+=R*S[s].y,l[s].z+=R*S[s].z,l[s].x/=R+u[0][s],l[s].y/=R+u[0][s],l[s].z/=R+u[0][s]}else{for(l[s].x=0,l[s].y=0,l[s].z=0,A=0,E=u[0][s];A<E;A++)l[s].x+=S[u[A+1][s]].x,l[s].y+=S[u[A+1][s]].y,l[s].z+=S[u[A+1][s]].z;l[s].x+=M*S[s].x,l[s].y+=M*S[s].y,l[s].z+=M*S[s].z,l[s].x/=M+u[0][s],l[s].y/=M+u[0][s],l[s].z/=M+u[0][s]}for(s=0,y=S.length;s<y;s++)S[s].x=l[s].x,S[s].y=l[s].y,S[s].z=l[s].z}}}let g=new p;class x{constructor(C,S,k){this.data=new Int32Array(C*S*k*3),this.width=S,this.height=k}set(C,S,k,l){let s=((C*this.width+S)*this.height+k)*3;this.data[s]=l.ix,this.data[s+1]=l.iy,this.data[s+2]=l.iz}get(C,S,k){let l=((C*this.width+S)*this.height+k)*3;return{ix:this.data[l],iy:this.data[l+1],iz:this.data[l+2]}}}class f{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],f.MarchingCube||(f.MarchingCube=new p)}getVDWIndex(C){return!C.elem||typeof this.vdwRadii[C.elem]>"u"?"X":C.elem}getFacesAndVertices(C){let S={};for(let s=0,y=C.length;s<y;s++)S[C[s]]=!0;let k=this.verts;for(let s=0,y=k.length;s<y;s++)k[s].x=k[s].x/this.scaleFactor-this.ptranx,k[s].y=k[s].y/this.scaleFactor-this.ptrany,k[s].z=k[s].z/this.scaleFactor-this.ptranz;let l=[];for(let s=0,y=this.faces.length;s<y;s+=3){let A=this.faces[s],E=this.faces[s+1],T=this.faces[s+2],u=k[A].atomid,_=k[E].atomid,M=k[T].atomid,R=u;_<R&&(R=_),M<R&&(R=M),S[R]&&A!==E&&E!==T&&A!==T&&(l.push(A),l.push(E),l.push(T))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:k,faces:l}}initparm(C,S,k){k>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let l=1/this.scaleFactor*5.5;this.pminx=C[0][0],this.pmaxx=C[1][0],this.pminy=C[0][1],this.pmaxy=C[1][1],this.pminz=C[0][2],this.pmaxz=C[1][2],S?(this.pminx-=this.probeRadius+l,this.pminy-=this.probeRadius+l,this.pminz-=this.probeRadius+l,this.pmaxx+=this.probeRadius+l,this.pmaxy+=this.probeRadius+l,this.pmaxz+=this.probeRadius+l):(this.pminx-=l,this.pminy-=l,this.pminz-=l,this.pmaxx+=l,this.pmaxy+=l,this.pmaxz+=l),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(S),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(C){let S={};for(const k in this.vdwRadii){let l=this.vdwRadii[k];C?S[k]=(l+this.probeRadius)*this.scaleFactor+.5:S[k]=l*this.scaleFactor+.5;let s=S[k]*S[k];this.widxz[k]=Math.floor(S[k])+1,this.depty[k]=new Int32Array(this.widxz[k]*this.widxz[k]);let y=0;for(let A=0;A<this.widxz[k];A++)for(let E=0;E<this.widxz[k];E++){let T=A*A+E*E;if(T>s)this.depty[k][y]=-1;else{let u=Math.sqrt(s-T);this.depty[k][y]=Math.floor(u)}y++}}}fillvoxels(C,S){for(let k=0,l=this.vpBits.length;k<l;k++)this.vpBits[k]=0,this.vpDistance[k]=-1,this.vpAtomID[k]=-1;for(let k in S){let l=C[S[k]];l!==void 0&&this.fillAtom(l,C)}for(let k=0,l=this.vpBits.length;k<l;k++)this.vpBits[k]&this.INOUT&&(this.vpBits[k]|=this.ISDONE)}fillAtom(C,S){let k=Math.floor(.5+this.scaleFactor*(C.x+this.ptranx)),l=Math.floor(.5+this.scaleFactor*(C.y+this.ptrany)),s=Math.floor(.5+this.scaleFactor*(C.z+this.ptranz)),y=this.getVDWIndex(C),A=0,E=this.pWidth*this.pHeight;for(let T=0,u=this.widxz[y];T<u;T++)for(let _=0;_<u;_++){if(this.depty[y][A]!=-1){for(let M=-1;M<2;M++)for(let R=-1;R<2;R++)for(let N=-1;N<2;N++)if(M!==0&&R!==0&&N!==0){let I=M*T,L=N*_;for(let Y=0;Y<=this.depty[y][A];Y++){let B=Y*R,D=k+I,H=l+B,W=s+L;if(D<0||H<0||W<0||D>=this.pLength||H>=this.pWidth||W>=this.pHeight)continue;let q=D*E+H*this.pHeight+W;if(!(this.vpBits[q]&this.INOUT))this.vpBits[q]|=this.INOUT,this.vpAtomID[q]=C.serial;else{let V=S[this.vpAtomID[q]];if(V.serial!=C.serial){let $=k+I-Math.floor(.5+this.scaleFactor*(V.x+this.ptranx)),O=l+B-Math.floor(.5+this.scaleFactor*(V.y+this.ptrany)),j=s+L-Math.floor(.5+this.scaleFactor*(V.z+this.ptranz));I*I+B*B+L*L<$*$+O*O+j*j&&(this.vpAtomID[q]=C.serial)}}}}}A++}}fillvoxelswaals(C,S){for(let k=0,l=this.vpBits.length;k<l;k++)this.vpBits[k]&=~this.ISDONE;for(let k in S){let l=C[S[k]];l!==void 0&&this.fillAtomWaals(l,C)}}fillAtomWaals(C,S){let k=0,l=Math.floor(.5+this.scaleFactor*(C.x+this.ptranx)),s=Math.floor(.5+this.scaleFactor*(C.y+this.ptrany)),y=Math.floor(.5+this.scaleFactor*(C.z+this.ptranz)),A=this.getVDWIndex(C),E=this.pWidth*this.pHeight;for(let T=0,u=this.widxz[A];T<u;T++)for(let _=0;_<u;_++){if(this.depty[A][k]!=-1){for(let M=-1;M<2;M++)for(let R=-1;R<2;R++)for(let N=-1;N<2;N++)if(M!==0&&R!==0&&N!==0){let I=M*T,L=N*_;for(let Y=0;Y<=this.depty[A][k];Y++){let B=Y*R,D=l+I,H=s+B,W=y+L;if(D<0||H<0||W<0||D>=this.pLength||H>=this.pWidth||W>=this.pHeight)continue;let q=D*E+H*this.pHeight+W;if(!(this.vpBits[q]&this.ISDONE))this.vpBits[q]|=this.ISDONE,this.vpAtomID[q]=C.serial;else{let V=S[this.vpAtomID[q]];if(V.serial!=C.serial){let $=l+I-Math.floor(.5+this.scaleFactor*(V.x+this.ptranx)),O=s+B-Math.floor(.5+this.scaleFactor*(V.y+this.ptrany)),j=y+L-Math.floor(.5+this.scaleFactor*(V.z+this.ptranz));I*I+B*B+L*L<$*$+O*O+j*j&&(this.vpAtomID[q]=C.serial)}}}}}k++}}buildboundary(){let C=this.pWidth*this.pHeight;for(let S=0;S<this.pLength;S++)for(let k=0;k<this.pHeight;k++)for(let l=0;l<this.pWidth;l++){let s=S*C+l*this.pHeight+k;if(this.vpBits[s]&this.INOUT){let y=0;for(;y<26;){let A=S+this.nb[y][0],E=k+this.nb[y][2],T=l+this.nb[y][1];if(A>-1&&A<this.pLength&&T>-1&&T<this.pWidth&&E>-1&&E<this.pHeight&&!(this.vpBits[A*C+T*this.pHeight+E]&this.INOUT)){this.vpBits[s]|=this.ISBOUND;break}else y++}}}}fastdistancemap(){let C=new x(this.pLength,this.pWidth,this.pHeight),S=this.pWidth*this.pHeight,k=this.cutRadius*this.cutRadius,l=[],s=[],y;for(let T=0;T<this.pLength;T++)for(let u=0;u<this.pWidth;u++)for(let _=0;_<this.pHeight;_++)if(y=T*S+u*this.pHeight+_,this.vpBits[y]&=~this.ISDONE,this.vpBits[y]&this.INOUT&&this.vpBits[y]&this.ISBOUND){let M={ix:T,iy:u,iz:_};C.set(T,u,_,M),l.push(M),this.vpDistance[y]=0,this.vpBits[y]|=this.ISDONE,this.vpBits[y]&=~this.ISBOUND}do{s=this.fastoneshell(l,C),l=[];for(let T=0,u=s.length;T<u;T++)y=S*s[T].ix+this.pHeight*s[T].iy+s[T].iz,this.vpBits[y]&=~this.ISBOUND,this.vpDistance[y]<=1.0404*k&&l.push({ix:s[T].ix,iy:s[T].iy,iz:s[T].iz})}while(l.length!==0);l=[],s=[],C=null;let A=this.scaleFactor-.5;A<0&&(A=0);let E=k-.5/(.1+A);for(let T=0;T<this.pLength;T++)for(let u=0;u<this.pWidth;u++)for(let _=0;_<this.pHeight;_++)y=T*S+u*this.pHeight+_,this.vpBits[y]&=~this.ISBOUND,this.vpBits[y]&this.INOUT&&(!(this.vpBits[y]&this.ISDONE)||this.vpBits[y]&this.ISDONE&&this.vpDistance[y]>=E)&&(this.vpBits[y]|=this.ISBOUND)}fastoneshell(C,S){let k,l,s,y,A,E,T,u,_,M=[];if(C.length===0)return M;let R={ix:-1,iy:-1,iz:-1},N=this.pWidth*this.pHeight;for(let I=0,L=C.length;I<L;I++){k=C[I].ix,l=C[I].iy,s=C[I].iz,u=S.get(k,l,s);for(let Y=0;Y<6;Y++)R.ix=k+this.nb[Y][0],R.iy=l+this.nb[Y][1],R.iz=s+this.nb[Y][2],R.ix<this.pLength&&R.ix>-1&&R.iy<this.pWidth&&R.iy>-1&&R.iz<this.pHeight&&R.iz>-1&&(_=R.ix*N+this.pHeight*R.iy+R.iz,this.vpBits[_]&this.INOUT&&!(this.vpBits[_]&this.ISDONE)?(S.set(R.ix,R.iy,s+this.nb[Y][2],u),y=R.ix-u.ix,A=R.iy-u.iy,E=R.iz-u.iz,T=y*y+A*A+E*E,this.vpDistance[_]=T,this.vpBits[_]|=this.ISDONE,this.vpBits[_]|=this.ISBOUND,M.push({ix:R.ix,iy:R.iy,iz:R.iz})):this.vpBits[_]&this.INOUT&&this.vpBits[_]&this.ISDONE&&(y=R.ix-u.ix,A=R.iy-u.iy,E=R.iz-u.iz,T=y*y+A*A+E*E,T<this.vpDistance[_]&&(S.set(R.ix,R.iy,R.iz,u),this.vpDistance[_]=T,this.vpBits[_]&this.ISBOUND||(this.vpBits[_]|=this.ISBOUND,M.push({ix:R.ix,iy:R.iy,iz:R.iz})))))}for(let I=0,L=C.length;I<L;I++){k=C[I].ix,l=C[I].iy,s=C[I].iz,u=S.get(k,l,s);for(let Y=6;Y<18;Y++)R.ix=k+this.nb[Y][0],R.iy=l+this.nb[Y][1],R.iz=s+this.nb[Y][2],R.ix<this.pLength&&R.ix>-1&&R.iy<this.pWidth&&R.iy>-1&&R.iz<this.pHeight&&R.iz>-1&&(_=R.ix*N+this.pHeight*R.iy+R.iz,this.vpBits[_]&this.INOUT&&!(this.vpBits[_]&this.ISDONE)?(S.set(R.ix,R.iy,s+this.nb[Y][2],u),y=R.ix-u.ix,A=R.iy-u.iy,E=R.iz-u.iz,T=y*y+A*A+E*E,this.vpDistance[_]=T,this.vpBits[_]|=this.ISDONE,this.vpBits[_]|=this.ISBOUND,M.push({ix:R.ix,iy:R.iy,iz:R.iz})):this.vpBits[_]&this.INOUT&&this.vpBits[_]&this.ISDONE&&(y=R.ix-u.ix,A=R.iy-u.iy,E=R.iz-u.iz,T=y*y+A*A+E*E,T<this.vpDistance[_]&&(S.set(R.ix,R.iy,R.iz,u),this.vpDistance[_]=T,this.vpBits[_]&this.ISBOUND||(this.vpBits[_]|=this.ISBOUND,M.push({ix:R.ix,iy:R.iy,iz:R.iz})))))}for(let I=0,L=C.length;I<L;I++){k=C[I].ix,l=C[I].iy,s=C[I].iz,u=S.get(k,l,s);for(let Y=18;Y<26;Y++)R.ix=k+this.nb[Y][0],R.iy=l+this.nb[Y][1],R.iz=s+this.nb[Y][2],R.ix<this.pLength&&R.ix>-1&&R.iy<this.pWidth&&R.iy>-1&&R.iz<this.pHeight&&R.iz>-1&&(_=R.ix*N+this.pHeight*R.iy+R.iz,this.vpBits[_]&this.INOUT&&!(this.vpBits[_]&this.ISDONE)?(S.set(R.ix,R.iy,s+this.nb[Y][2],u),y=R.ix-u.ix,A=R.iy-u.iy,E=R.iz-u.iz,T=y*y+A*A+E*E,this.vpDistance[_]=T,this.vpBits[_]|=this.ISDONE,this.vpBits[_]|=this.ISBOUND,M.push({ix:R.ix,iy:R.iy,iz:R.iz})):this.vpBits[_]&this.INOUT&&this.vpBits[_]&this.ISDONE&&(y=R.ix-u.ix,A=R.iy-u.iy,E=R.iz-u.iz,T=y*y+A*A+E*E,T<this.vpDistance[_]&&(S.set(R.ix,R.iy,R.iz,u),this.vpDistance[_]=T,this.vpBits[_]&this.ISBOUND||(this.vpBits[_]|=this.ISBOUND,M.push({ix:R.ix,iy:R.iy,iz:R.iz})))))}return M}marchingcubeinit(C){for(let S=0,k=this.vpBits.length;S<k;S++)C==1?this.vpBits[S]&=~this.ISBOUND:C==4?(this.vpBits[S]&=~this.ISDONE,this.vpBits[S]&this.ISBOUND&&(this.vpBits[S]|=this.ISDONE),this.vpBits[S]&=~this.ISBOUND):C==2?this.vpBits[S]&this.ISBOUND&&this.vpBits[S]&this.ISDONE?this.vpBits[S]&=~this.ISBOUND:this.vpBits[S]&this.ISBOUND&&!(this.vpBits[S]&this.ISDONE)&&(this.vpBits[S]|=this.ISDONE):C==3&&(this.vpBits[S]&=~this.ISBOUND)}marchingcube(C){this.marchingcubeinit(C),this.verts=[],this.faces=[],f.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let S=this.pWidth*this.pHeight;for(let k=0,l=this.verts.length;k<l;k++)this.verts[k].atomid=this.vpAtomID[this.verts[k].x*S+this.pHeight*this.verts[k].y+this.verts[k].z];f.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}f.MarchingCube=new p}),"./src/VolumeData.ts":((r,e,t)=>{t.r(e),t.d(e,{VolumeData:()=>g});var o=t("./src/utilities.ts"),c=t("./src/WebGL/math/index.ts"),h=t("./src/parsers/VASP.ts"),v=t("./src/parsers/CUBE.ts"),p=t("./node_modules/pako/dist/pako.esm.mjs");class g{constructor(f,b,C){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(y){var A=y/(this.size.y*this.size.z),E=y%(this.size.y*this.size.z),T=y%this.size.z;return A*=this.unit.x,E*=this.unit.y,T*=this.unit.z,A+=this.origin.x,E+=this.origin.y,T+=this.origin.z,{x:A,y:E,z:T}},this.vasp=function(y){var A=y.replace(/^\s+/,"").split(/[\n\r]/),E=(0,h.VASP)(y)[0],T=E.length;if(T==0){console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),this.data=[];return}var u=1.889725992,_=.036749309,M=parseFloat(A[1]),R;R=A[2].replace(/^\s+/,"").split(/\s+/);var N=new c.Vector3(parseFloat(R[0]),parseFloat(R[1]),parseFloat(R[2])).multiplyScalar(M*u);R=A[3].replace(/^\s+/,"").split(/\s+/);var I=new c.Vector3(parseFloat(R[0]),parseFloat(R[1]),parseFloat(R[2])).multiplyScalar(M*u);R=A[4].replace(/^\s+/,"").split(/\s+/);var L=new c.Vector3(parseFloat(R[0]),parseFloat(R[1]),parseFloat(R[2])).multiplyScalar(M*u),Y=N.x*(I.y*L.z-L.y*I.z)-I.x*(N.y*L.z-L.y*N.z)+L.x*(N.y*I.z-I.y*N.z);Y=Math.abs(Y)/Math.pow(u,3);var B=1/Y;A.splice(0,8+T+1);var D=A[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),H=Math.abs(parseFloat(D[0])),W=Math.abs(parseFloat(D[1])),q=Math.abs(parseFloat(D[2])),V=this.origin=new c.Vector3(0,0,0);this.size={x:H,y:W,z:q},this.unit=new c.Vector3(N.x,I.y,L.z),N=N.multiplyScalar(1/(u*H)),I=I.multiplyScalar(1/(u*W)),L=L.multiplyScalar(1/(u*q)),(N.y!=0||N.z!=0||I.x!=0||I.z!=0||L.x!=0||L.y!=0)&&(this.matrix=new c.Matrix4(N.x,I.x,L.x,0,N.y,I.y,L.y,0,N.z,I.z,L.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new c.Matrix4().makeTranslation(V.x,V.y,V.z)),this.origin=new c.Vector3(0,0,0),this.unit=new c.Vector3(1,1,1)),A.splice(0,1);var $=A.join(" ");$=$.replace(/^\s+/,"");var O=$.split(/[\s\r]+/);O.splice(H*W*q+1);for(var j=Float32Array.from(O,parseFloat),J=0;J<j.length;J++)j[J]=j[J]*B*_;this.data=j},this.dx=function(y){var A=y.split(/[\n\r]+/),E,T=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,u=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,_=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,M=/data follows/,R=0;for(R=0;R<A.length;R++){var N=A[R];if(E=T.exec(N)){var I=parseInt(E[1]),L=parseInt(E[2]),Y=parseInt(E[3]);this.size={x:I,y:L,z:Y}}else if(E=_.exec(N)){var B=parseFloat(E[1]);if((parseFloat(E[2])!=0||parseFloat(E[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),R+=1,N=A[R],E=_.exec(N),E==null){console.error("Parse error in dx delta matrix");return}var D=parseFloat(E[2]);if((parseFloat(E[1])!=0||parseFloat(E[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),R+=1,N=A[R],E=_.exec(N),E==null){console.error("Parse error in dx delta matrix");return}var H=parseFloat(E[3]);(parseFloat(E[1])!=0||parseFloat(E[2])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new c.Vector3(B,D,H)}else if(E=u.exec(N)){var W=parseFloat(E[1]),q=parseFloat(E[2]),V=parseFloat(E[3]);this.origin=new c.Vector3(W,q,V)}else if(E=M.exec(N))break}if(R+=1,!this.size||!this.origin||!this.unit||!this.size){console.error("Error parsing dx format");return}var $=A.splice(R).join(" "),O=$.split(/[\s\r]+/);this.data=Float32Array.from(O,parseFloat)},b=b.toLowerCase(),/\.gz$/.test(b)){b=b.replace(/\.gz$/,"");try{this[b]&&this.isbinary.has(b)?(typeof f=="string"&&(f=(0,o.base64ToArray)(f)),f=(0,p.inflate)(f)):f=new TextDecoder("utf-8").decode((0,p.inflate)(f))}catch(y){console.error(y)}}if(this[b]&&(this.isbinary.has(b)&&typeof f=="string"&&(f=(0,o.base64ToArray)(f)),this[b](f)),C){if(C.negate)for(let y=0,A=this.data.length;y<A;y++)this.data[y]=-this.data[y];if(C.normalize){var S=0;for(let y=0,A=this.data.length;y<A;y++)S+=this.data[y];var k=S/this.data.length;S=0;for(let y=0,A=this.data.length;y<A;y++){var l=this.data[y]-k;S+=l*l}var s=S/this.data.length;for(let y=0,A=this.data.length;y<A;y++)this.data[y]=(this.data[y]-k)/s}}}getIndex(f,b,C){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new c.Matrix4().getInverse(this.matrix));var S=new c.Vector3(f,b,C);S=S.applyMatrix4(this.inversematrix),f=S.x,b=S.y,C=S.z}else f-=this.origin.x,b-=this.origin.y,C-=this.origin.z,f/=this.unit.x,b/=this.unit.y,C/=this.unit.z;return f=Math.round(f),b=Math.round(b),C=Math.round(C),f<0||f>=this.size.x||b<0||b>=this.size.y||C<0||C>=this.size.z?-1:f*this.size.y*this.size.z+b*this.size.z+C}getVal(f,b,C){let S=this.getIndex(f,b,C);return S<0?0:this.data[S]}cube(f){var b=f.split(/\r?\n/);if(!(b.length<6)){var C=(0,v.CUBE)(f,{}).modelData[0].cryst,S=b[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),k=parseFloat(S[0]),l=Math.abs(k);this.origin=C.origin,this.size=C.size,this.unit=C.unit,this.matrix=C.matrix4;var s=6;k<0&&s++;var y=b.splice(l+s).join(" ");y=y.replace(/^\s+/,"");var A=y.split(/[\s\r]+/);this.data=Float32Array.from(A,parseFloat)}}ccp4(f){var b={};f=new Int8Array(f);var C=new Int32Array(f.buffer,0,56),S=new Float32Array(f.buffer,0,56),k=new DataView(f.buffer);if(b.MAP=String.fromCharCode(k.getUint8(208),k.getUint8(209),k.getUint8(210),k.getUint8(211)),b.MACHST=[k.getUint8(212),k.getUint8(213)],b.MACHST[0]===17&&b.MACHST[1]===17)for(var l=f.byteLength,s=0;s<l;s+=4)k.setFloat32(s,k.getFloat32(s),!0);b.NX=C[0],b.NY=C[1],b.NZ=C[2],b.MODE=C[3],b.NXSTART=C[4],b.NYSTART=C[5],b.NZSTART=C[6],b.MX=C[7],b.MY=C[8],b.MZ=C[9],b.xlen=S[10],b.ylen=S[11],b.zlen=S[12],b.alpha=S[13],b.beta=S[14],b.gamma=S[15],b.MAPC=C[16],b.MAPR=C[17],b.MAPS=C[18],b.DMIN=S[19],b.DMAX=S[20],b.DMEAN=S[21],b.ISPG=C[22],b.NSYMBT=C[23],b.LSKFLG=C[24],b.originX=S[49],b.originY=S[50],b.originZ=S[51],b.ARMS=S[54];var y=b,A=[y.xlen,0,0],E=[y.ylen*Math.cos(Math.PI/180*y.gamma),y.ylen*Math.sin(Math.PI/180*y.gamma),0],T=[y.zlen*Math.cos(Math.PI/180*y.beta),y.zlen*(Math.cos(Math.PI/180*y.alpha)-Math.cos(Math.PI/180*y.gamma)*Math.cos(Math.PI/180*y.beta))/Math.sin(Math.PI/180*y.gamma),0];T[2]=Math.sqrt(y.zlen*y.zlen*Math.sin(Math.PI/180*y.beta)*Math.sin(Math.PI/180*y.beta)-T[1]*T[1]);var u=[0,A,E,T],_=[0,y.MX,y.MY,y.MZ],M=[0,y.MAPC,y.MAPR,y.MAPS];this.matrix=new c.Matrix4,this.matrix.set(u[M[1]][0]/_[M[1]],u[M[2]][0]/_[M[2]],u[M[3]][0]/_[M[3]],0,u[M[1]][1]/_[M[1]],u[M[2]][1]/_[M[2]],u[M[3]][1]/_[M[3]],0,u[M[1]][2]/_[M[1]],u[M[2]][2]/_[M[2]],u[M[3]][2]/_[M[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new c.Matrix4().makeTranslation(y.NXSTART+y.originX,y.NYSTART+y.originY,y.NZSTART+y.originZ)),this.origin=new c.Vector3(0,0,0),this.unit=new c.Vector3(1,1,1),this.size={x:b.NX,y:b.NY,z:b.NZ},this.dimensionorder=[b.MAPC,b.MAPR,b.MAPS];var R=new Float32Array(f.buffer,1024+b.NSYMBT),N=b.NX,I=b.NY,L=b.NZ;this.data=new Float32Array(N*I*L);for(let Y=0;Y<N;Y++)for(let B=0;B<I;B++)for(let D=0;D<L;D++)this.data[(Y*I+B)*L+D]=R[(D*I+B)*N+Y]}}}),"./src/VolumetricRender.ts":((r,e,t)=>{t.r(e),t.d(e,{GLVolumetricRender:()=>g});var o=t("./src/WebGL/shapes/index.ts"),c=t("./src/WebGL/math/index.ts"),h=t("./src/WebGL/index.ts"),v=t("./src/colors.ts"),p=t("./src/GLShape.ts");class g{static interpolateArray(f,b){function C(T,u,_){return T+(u-T)*_}var S=[],k=(f.length-1)/(b-1);S[0]=f[0];for(var l=1;l<b-1;l++){var s=l*k,y=Math.floor(s),A=Math.ceil(s),E=s-y;S[l]=C(f[y],f[A],E)}return S[b-1]=f[f.length-1],S}constructor(f,b,C){this.hidden=!1,this.boundingSphere=new o.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,b=b||{};var S=Object.assign([],b.transferfn);this.subsamples=b.subsamples||5;let k=256;S.forEach(function(I){I.value=parseFloat(I.value)}),S.sort(function(I,L){return I.value-L.value}),this.min=S[0].value,S.length==0&&S.push(S[0]),this.max=S[S.length-1].value;var l,s,y,A,E,T,u,_,M,R;for(let I=0;I<S.length-1;I++)if(y=v.CC.color(S[I].color),A=v.CC.color(S[I+1].color),M=S[I].opacity,R=S[I+1].opacity,l=Math.floor((S[I].value-this.min)*k/(this.max-this.min)),s=Math.floor((S[I+1].value-this.min)*k/(this.max-this.min)),l!=s){E=g.interpolateArray([y.r*255,A.r*255],s-l),T=g.interpolateArray([y.g*255,A.g*255],s-l),u=g.interpolateArray([y.b*255,A.b*255],s-l),_=g.interpolateArray([M*255,R*255],s-l);for(let L=0;L<E.length;L++)this.transferfunctionbuffer.push(E[L]),this.transferfunctionbuffer.push(T[L]),this.transferfunctionbuffer.push(u[L]),this.transferfunctionbuffer.push(_[L])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),f.matrix){let I=new c.Vector3(0,0,0),L=new c.Vector3(f.size.x,f.size.y,f.size.z),Y=new c.Vector3(1,1,1);I.applyMatrix4(f.matrix),L.applyMatrix4(f.matrix),Y.applyMatrix4(f.matrix).sub(I),this.extent=[[I.x,I.y,I.z],[L.x,L.y,L.z]];for(let W=1;W<7;W++)L.x=W&1?f.size.x:0,L.y=W&2?f.size.y:0,L.z=W&4?f.size.z:0,L.applyMatrix4(f.matrix),this.extent[0][0]=Math.min(this.extent[0][0],L.x),this.extent[0][1]=Math.min(this.extent[0][1],L.y),this.extent[0][2]=Math.min(this.extent[0][2],L.z),this.extent[1][0]=Math.max(this.extent[1][0],L.x),this.extent[1][1]=Math.max(this.extent[1][1],L.y),this.extent[1][2]=Math.max(this.extent[1][2],L.z);let B=L.x-I.x,D=L.y-I.y,H=L.z-I.z;this.maxdepth=Math.sqrt(B*B+D*D+H*H),this.minunit=Math.min(Math.min(Y.x,Y.y),Y.z),this.texmatrix=new c.Matrix4().identity().scale({x:f.size.x,y:f.size.y,z:f.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(f.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new c.Matrix4().identity();let I=f.unit.x*f.size.x,L=f.unit.y*f.size.y,Y=f.unit.z*f.size.z;this.texmatrix.makeTranslation(-f.origin.x/I,-f.origin.y/L,-f.origin.z/Y),this.texmatrix.scale({x:1/I,y:1/L,z:1/Y}),this.minunit=Math.min(Math.min(f.unit.x,f.unit.y),f.unit.z),this.extent=[[f.origin.x,f.origin.y,f.origin.z],[f.origin.x+I,f.origin.y+L,f.origin.z+Y]],this.maxdepth=Math.sqrt(I*I+L*L+Y*Y)}var N=new p.GLShape({});if(N.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=N.finalize(),this.boundingSphere.center=new c.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,b.coords===void 0&&b.selection!==void 0&&(C?b.coords=C.selectedAtoms(b.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),b.coords!==void 0&&b.seldist!==void 0){let I=new Uint8Array(f.data.length),L=b.seldist,Y=L*L;for(let B=0,D=b.coords.length;B<D;B++){let H=b.coords[B],W=H.x-L,q=H.y-L,V=H.z-L,$=H.x+L,O=H.y+L,j=H.z+L;if(f.getIndex(W,q,V)>=0||f.getIndex($,O,j)>=0)for(let J=W;J<$;J+=this.minunit)for(let oe=q;oe<O;oe+=this.minunit)for(let ie=V;ie<j;ie+=this.minunit){let he=f.getIndex(J,oe,ie);he>=0&&!I[he]&&(J-H.x)*(J-H.x)+(oe-H.y)*(oe-H.y)+(ie-H.z)*(ie-H.z)<Y&&(I[he]=1)}}for(let B=0,D=f.data.length;B<D;B++)I[B]==0&&(f.data[B]=1/0)}this.data=f}globj(f){if(this.renderedShapeObj&&(f.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new h.Object3D;var b=null,C=new h.Texture(this.data,!0),S=new h.Texture(this.transferfunctionbuffer,!1);C.needsUpdate=!0,S.needsUpdate=!0,S.flipY=!1,b=new h.VolumetricMaterial({transferfn:S,transfermin:this.min,transfermax:this.max,map:C,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var k=new h.Mesh(this.geo,b);this.shapeObj.add(k),this.renderedShapeObj=this.shapeObj.clone(),f.add(this.renderedShapeObj)}}removegl(f){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),f.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}}),"./src/WebGL/Camera.ts":((r,e,t)=>{t.r(e),t.d(e,{Camera:()=>h});var o=t("./src/WebGL/core/index.ts"),c=t("./src/WebGL/math/index.ts");class h extends o.Object3D{constructor(p=50,g=1,x=.1,f=2e3,b=!1){super(),this.projectionMatrix=new c.Matrix4,this.projectionMatrixInverse=new c.Matrix4,this.matrixWorldInverse=new c.Matrix4,this.fov=p,this.aspect=g,this.near=x,this.far=f;var C=this.position.z;this.right=C*Math.tan(Math.PI/180*p),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!b,this.updateProjectionMatrix()}lookAt(p){this.matrix.lookAt(this.position,p,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof c.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}}),"./src/WebGL/Fog.ts":((r,e,t)=>{t.r(e),t.d(e,{Fog:()=>c});var o=t("./src/colors.ts");class c{constructor(v,p=1,g=1e3){this.name="",this.color=new o.Color(v),this.near=p,this.far=g}clone(){return new c(this.color.getHex(),this.near,this.far)}}}),"./src/WebGL/Renderer.ts":((r,e,t)=>{t.r(e),t.d(e,{Renderer:()=>S});var o=t("./src/WebGL/Camera.ts"),c=t("./src/WebGL/constants/Sides.ts"),h=t("./src/WebGL/constants/TextureConstants.ts"),v=t("./src/WebGL/core/index.ts"),p=t("./src/colors.ts"),g=t("./src/WebGL/materials/index.ts"),x=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/objects/index.ts"),b=t("./src/WebGL/shaders/index.ts"),C=t("./src/WebGL/SpritePlugin.ts");class S{constructor(l){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new x.Vector3,this._worldInverse=new x.Matrix4,this._projInverse=new x.Matrix4,this._textureMatrix=new x.Matrix4,this._fullProjModelMatrix=new x.Matrix4,this._fullProjModelMatrixInv=new x.Matrix4,this._direction=new x.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new C.SpritePlugin,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,l=l||{},this.row=l.row,this.col=l.col,this.rows=l.rows,this.cols=l.cols,this._canvas=l.canvas!==void 0?l.canvas:document.createElement("canvas"),this._precision=l.precision!==void 0?l.precision:"highp",this._alpha=l.alpha!==void 0?l.alpha:!0,this._premultipliedAlpha=l.premultipliedAlpha!==void 0?l.premultipliedAlpha:!0,this._antialias=l.antialias!==void 0?l.antialias:!1,this._preserveDrawingBuffer=l.preserveDrawingBuffer!==void 0?l.preserveDrawingBuffer:!1,this._clearColor=l.clearColor!==void 0?new p.Color(l.clearColor):new p.Color(0),this._clearAlpha=l.clearAlpha!==void 0?l.clearAlpha:0,this._outlineMaterial=new g.MeshOutlineMaterial(l.outline),this._outlineSphereImposterMaterial=new g.SphereImposterOutlineMaterial(l.outline),this._outlineStickImposterMaterial=new g.StickImposterOutlineMaterial(l.outline),this._outlineEnabled=!!l.outline,this._AOEnabled=!!l.ambientOcclusion,l.ambientOcclusion&&typeof l.ambientOcclusion.strength<"u"&&(this._AOstrength=parseFloat(l.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),l.ambientOcclusion&&typeof l.ambientOcclusion.radius<"u"&&(this._AOradius=parseFloat(l.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=l.id,!(l.containerWidth==0||l.containerHeight==0)&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(l,s){this._clearColor.setHex(l),this._clearAlpha=s,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(l){this._outlineMaterial=new g.MeshOutlineMaterial(l),this._outlineSphereImposterMaterial=new g.SphereImposterOutlineMaterial(l),this._outlineStickImposterMaterial=new g.StickImposterOutlineMaterial(l),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(l){l&&(l.strength&&(this._AOstrength=l.strength),l.scale&&(this._AOradius=l.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var l=this._canvas.width/this.cols,s=this._canvas.height/this.rows;this._viewportWidth=l,this._viewportHeight=s,this.isLost()||(this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(l*this.col,s*this.row,l,s),this._gl.viewport(l*this.col,s*this.row,l,s))}}setSize(l,s){if(this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._antialias&&this.devicePixelRatio<2&&(this.devicePixelRatio*=2),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var y=l/this.cols,A=s/this.rows;this._canvas.width=l*this.devicePixelRatio,this._canvas.height=s*this.devicePixelRatio,this._viewportWidth=y*this.devicePixelRatio,this._viewportHeight=A*this.devicePixelRatio,this._canvas.style.width=l+"px",this._canvas.style.height=s+"px",this.setViewport()}else this._viewportWidth=this._canvas.width=l*this.devicePixelRatio,this._viewportHeight=this._canvas.height=s*this.devicePixelRatio,this._canvas.style.width=l+"px",this._canvas.style.height=s+"px",this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight);this.initFrameBuffer()}clear(l,s,y){var A=0;(l===void 0||l)&&(A|=this._gl.COLOR_BUFFER_BIT),(s===void 0||s)&&(A|=this._gl.DEPTH_BUFFER_BIT),(y===void 0||y)&&(A|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(A)}setMaterialFaces(l,s){var y=l.side===c.DoubleSide,A=l.side===c.BackSide;l.imposter||(A=s?!A:A),this._oldDoubleSided!==y&&(y?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=y),this._oldFlipSided!==A&&(A?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=A),this._gl.cullFace(this._gl.BACK)}setDepthTest(l){this._oldDepthTest!==l&&(l?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=l)}setDepthWrite(l){this._oldDepthWrite!==l&&(this._gl.depthMask(l),this._oldDepthWrite=l)}setBlending(l){l?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(l,s,y,A){l.addEventListener("dispose",this.onMaterialDispose.bind(this));var E,T;if(T=l.shaderID,T){var u=b.ShaderLib[T];l.vertexShader=u.vertexShader,l.fragmentShader=u.fragmentShader,l.uniforms=b.ShaderUtils.clone(u.uniforms),l.shaded&&l.makeShaded(this.SHADE_TEXTURE)}E={wireframe:l.wireframe,fragdepth:l.imposter,volumetric:l.volumetric,shaded:l.shaded},l.program=this.buildProgram(l.fragmentShader,l.vertexShader,l.uniforms,E)}renderBuffer(l,s,y,A,E,T){if(A.visible){var u,_;if(u=this.setProgram(l,s,y,A,T,this),!!u){_=u.attributes;var M=!1,R=A.wireframe?1:0,N=E.id*16777215+u.id*2+R;N!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=N,M=!0),M&&(this.disableAttributes(),_.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglVertexBuffer),this.enableAttribute(_.position),this._gl.vertexAttribPointer(_.position,3,this._gl.FLOAT,!1,0,0)),_.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglColorBuffer),this.enableAttribute(_.color),this._gl.vertexAttribPointer(_.color,3,this._gl.FLOAT,!1,0,0)),_.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglNormalBuffer),this.enableAttribute(_.normal),this._gl.vertexAttribPointer(_.normal,3,this._gl.FLOAT,!1,0,0)),_.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglOffsetBuffer),this.enableAttribute(_.offset),this._gl.vertexAttribPointer(_.offset,3,this._gl.FLOAT,!1,0,0)),_.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglRadiusBuffer),this.enableAttribute(_.radius),this._gl.vertexAttribPointer(_.radius,1,this._gl.FLOAT,!1,0,0)));var I,L;if(T instanceof f.Mesh){if(A.shaderID==="instanced"){var Y=A.sphere.geometryGroups[0];M&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Y.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,E.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,Y.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,E.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,Y.faceArray,this._gl.STATIC_DRAW)),I=Y.faceidx,this._extInstanced.vertexAttribDivisorANGLE(_.offset,1),this._extInstanced.vertexAttribDivisorANGLE(_.radius,1),this._extInstanced.vertexAttribDivisorANGLE(_.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,I,this._gl.UNSIGNED_SHORT,0,E.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(_.offset,0),this._extInstanced.vertexAttribDivisorANGLE(_.radius,0),this._extInstanced.vertexAttribDivisorANGLE(_.color,0)}else A.wireframe?(L=E.lineidx,this.setLineWidth(A.wireframeLinewidth),M&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,E.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,L,this._gl.UNSIGNED_SHORT,0)):(I=E.faceidx,M&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,E.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,I,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=I,this.info.render.faces+=I/3}else T instanceof f.Line&&(L=E.vertices,this.setLineWidth(A.linewidth),this._gl.drawArrays(this._gl.LINES,0,L),this.info.render.calls++)}}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(l,s,y){let A=l.__lights,E=l.fog,T=[];for(let M=0,R=l.__webglObjects.length;M<R;M++){let N=l.__webglObjects[M];N.render&&N[y]&&T.push(N)}if(T.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(l.__webglObjects,!0,y+"Depth",s,A,E,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let u=this._AOshader.uniforms;this._gl.uniform1f(u.total_strength,this._AOstrength),this._gl.uniform1f(u.radius,this._AOradius),this._fullProjModelMatrix=new x.Matrix4,this._fullProjModelMatrixInv=new x.Matrix4;let _=T[0].object;this._fullProjModelMatrix.multiplyMatrices(s.projectionMatrix,_._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(u.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(u.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(l,s){if(!(s instanceof o.Camera)){console.error("Renderer.render: camera is not an instance of Camera.");return}var y,A,E,T,u,_=l.__lights,M=l.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&l.updateMatrixWorld(),s.parent===void 0&&s.updateMatrixWorld(),s.matrixWorldInverse.getInverse(s.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(l),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),u=l.__webglObjects;let R=!1,N=this._AOEnabled;for(y=0,A=u.length;y<A;y++)E=u[y],T=E.object,E.render=!1,T.visible&&(this.setupMatrices(T,s),this.unrollBufferMaterial(E),E.render=!0,E.volumetric&&(R=!0),E.hasAO&&(N=!0));this.setBlending(!1),N&&this.setShading(l,s,"opaque"),this.renderObjects(l.__webglObjects,!0,"opaque",s,_,M,!1),N&&this.clearShading(),this.renderSprites(l,s,!1),this.renderObjects(l.__webglObjects,!0,"transparentDepth",s,_,M,!0),this.renderObjects(l.__webglObjects,!1,"transparent",s,_,M,!0),R&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(l.__webglObjects,!1,"volumetric",s,_,M,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(l,s,!0)}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let l=this._viewportWidth,s=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,l,s),this._gl.viewport(0,0,l,s),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,l,s,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,l,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,l,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,l,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let l=this._viewportWidth,s=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,l,s),this._gl.viewport(0,0,l,s),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var y=this._antialias?b.ShaderLib.screenaa:b.ShaderLib.screen;this._screenshader=this.buildProgram(y.fragmentShader,y.vertexShader,y.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition");var A=[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1];this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(A),this._gl.STATIC_DRAW);let E=b.ShaderLib.ssao;this._AOshader=this.buildProgram(E.fragmentShader,E.vertexShader,E.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let T=b.ShaderLib.blur;this._blurshader=this.buildProgram(T.fragmentShader,T.vertexShader,T.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(l){if(l.__webglObjects||(l.__webglObjects=[],l.__webglObjectsImmediate=[],l.__webglSprites=[],l.__webglFlares=[]),l.__objectsAdded.length){for(;l.__objectsAdded.length;)this.addObject(l.__objectsAdded[0],l),l.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;l.__objectsRemoved.length;)this.removeObject(l.__objectsRemoved[0],l),l.__objectsRemoved.splice(0,1);for(var s=0,y=l.__webglObjects.length;s<y;s++)this.updateObject(l.__webglObjects[s].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(l,s){(l==null||s==null)&&(l=this._canvas.width,s=this._canvas.height);var y=l/s;if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var A=l/this.cols,E=s/this.rows;y=A/E}return y}setTexture(l,s,y){if(l.needsUpdate){l.__webglInit||(l.__webglInit=!0,l.addEventListener("dispose",this.onTextureDispose.bind(this)),l.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+s);var A=y?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(A,l.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,l.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,l.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,l.unpackAlignment);var E=this.paramToGL(l.format),T=this.paramToGL(l.type);if(y)this.setTextureParameters(this._gl.TEXTURE_3D,l),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,l.image.size.z,l.image.size.y,l.image.size.x,0,this._gl.RED,this._gl.FLOAT,l.image.data);else{var u=l.image,_=u.width,M=u.height;typeof _>"u"&&(_=u.length,E==this._gl.RGBA&&(_/=4),M=1),this.setTextureParameters(this._gl.TEXTURE_2D,l),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,E,E,T,l.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,E,_,M,0,E,T,l.image)}l.needsUpdate=!1,l.onUpdate&&l.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+s),y?this._gl.bindTexture(this._gl.TEXTURE_3D,l.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,l.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(l){this._enabledAttributes[l]||(this._gl.enableVertexAttribArray(l),this._enabledAttributes[l]=!0)}disableAttributes(){for(let l in this._enabledAttributes)this._enabledAttributes[l]&&(this._gl.disableVertexAttribArray(l),this._enabledAttributes[l]=!1)}setPolygonOffset(l,s,y){this._oldPolygonOffset!==l&&(l?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(l){l!==this._oldLineWidth&&(this._gl.lineWidth(l),this._oldLineWidth=l)}deallocateGeometry(l){if(l.__webglInit=void 0,l.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(l.__webglVertexBuffer),l.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(l.__webglColorBuffer),l.geometryGroups!==void 0)for(var s=0,y=l.groups;s<y;s++){var A=l.geometryGroups[s];A.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(A.__webglVertexBuffer),A.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(A.__webglColorBuffer),A.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(A.__webglNormalBuffer),A.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(A.__webglFaceBuffer),A.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(A.__webglLineBuffer)}}deallocateMaterial(l){var s=l.program;if(s!==void 0){l.program=void 0;var y,A,E,T=!1;for(y=0,A=this._programs.length;y<A;y++)if(E=this._programs[y],E.program===s){E.usedTimes--,E.usedTimes===0&&(T=!0);break}if(T===!0){var u=[];for(y=0,A=this._programs.length;y<A;y++)E=this._programs[y],E.program!==s&&u.push(E);this._programs=u,this._gl.deleteProgram(s),this.info.memory.programs--}}}deallocateTexture(l){if(l.image&&l.image.__webglTextureCube)this._gl.deleteTexture(l.image.__webglTextureCube);else{if(!l.__webglInit)return;l.__webglInit=!1,this._gl.deleteTexture(l.__webglTexture)}}onGeometryDispose(l){var s=l.target;s.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(s),this.info.memory.geometries--}onTextureDispose(l){var s=l.target;s.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(s),this.info.memory.textures--}onMaterialDispose(l){var s=l.target;s.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(s)}getShader(l,s){var y;return!this.isWebGL1()&&!s.startsWith("#version")&&(s=s.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),l=="fragment"?s=s.replace(/varying/g,"in"):s=s.replace(/varying/g,"out"),s=s.replace(/attribute/g,"in"),s=s.replace(/texture2D/g,"texture"),s=s.replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;"),s=s.replace(/gl_FragColor/g,"glFragColor"),s=`#version 300 es
`+s),l==="fragment"?y=this._gl.createShader(this._gl.FRAGMENT_SHADER):l==="vertex"&&(y=this._gl.createShader(this._gl.VERTEX_SHADER)),y==null?null:(this._gl.shaderSource(y,s),this._gl.compileShader(y),this._gl.getShaderParameter(y,this._gl.COMPILE_STATUS)?y:(console.error(this._gl.getShaderInfoLog(y)),console.error("could not initialize shader"),null))}buildProgram(l,s,y,A){var E,T,u,_,M=[];M.push(l),M.push(s);for(E in A)M.push(E),M.push(A[E]);for(_=M.join(),E=0,T=this._programs.length;E<T;E++){var R=this._programs[E];if(R.code===_)return R.usedTimes++,R.program}if(this.isWebGL1()&&A.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if(u=this._gl.createProgram(),u==null)return null;var N=this._precision,I="precision "+N+" float;",L=[A.volumetric?"#version 300 es":"",I].join(`
`),Y=[A.volumetric?"#version 300 es":"",A.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",A.shaded?"#define SHADED 1":"",A.wireframe?"#define WIREFRAME 1":"",I].join(`
`),B=this.getShader("fragment",Y+l),D=this.getShader("vertex",L+s);D!=null&&this._gl.attachShader(u,D),B!=null&&this._gl.attachShader(u,B),this._gl.linkProgram(u),this._gl.getProgramParameter(u,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),u.uniforms={},u.attributes={};var H,W,q;H=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix"];for(W in y)H.push(W);for(q=0;q<H.length;q++){var V=H[q];u.uniforms[V]=this._gl.getUniformLocation(u,V)}for(H=["position","normal","color","lineDistance","offset","radius"],q=0;q<H.length;q++){var $=H[q];u.attributes[$]=this._gl.getAttribLocation(u,$)}return u.id=this._programs_counter++,this._programs.push({program:u,code:_,usedTimes:1}),this.info.memory.programs=this._programs.length,u}setProgram(l,s,y,A,E,T){if(A.needsUpdate&&(A.program&&this.deallocateMaterial(A),this.initMaterial(A,s,y,E),A.needsUpdate=!1),A.program==null)return null;var u=!1,_=A.program,M=_.uniforms,R=A.uniforms;if(_!=this._currentProgram&&(this._gl.useProgram(_),this._currentProgram=_,u=!0),A.id!=this._currentMaterialId&&(this._currentMaterialId=A.id,u=!0),l!=this._currentCamera&&(this._currentCamera=l,u=!0),M.projectionMatrix&&this._gl.uniformMatrix4fv(M.projectionMatrix,!1,l.projectionMatrix.elements),M.modelViewMatrix&&this._gl.uniformMatrix4fv(M.modelViewMatrix,!1,E._modelViewMatrix.elements),M.normalMatrix&&this._gl.uniformMatrix3fv(M.normalMatrix,!1,E._normalMatrix.elements),M.projinv&&(this._projInverse.getInverse(l.projectionMatrix),this._gl.uniformMatrix4fv(M.projinv,!1,this._projInverse.elements)),M.viewMatrix&&this._gl.uniformMatrix4fv(M.viewMatrix,!1,l.matrixWorldInverse.elements),u){if(R.fogColor.value=y.color,R.fogNear.value=y.near,R.fogFar.value=y.far,A.shaderID.startsWith("lambert")||A.shaderID==="instanced"||A.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(_,s),this._lightsNeedUpdate=!1),R.directionalLightColor.value=this._lights.directional.colors,R.directionalLightDirection.value=this._lights.directional.positions;else if(A.shaderID.endsWith("outline"))R.outlineColor.value=A.outlineColor,R.outlineWidth.value=A.outlineWidth,R.outlinePushback.value=A.outlinePushback;else if(A.shaderID==="volumetric"){E._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(E._modelViewMatrix),this._projInverse.getInverse(l.projectionMatrix),this._textureMatrix.multiplyMatrices(E.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(M.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(M.projinv,!1,this._projInverse.elements);let N=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);R.step.value=E.material.unit*N,R.maxdepth.value=E.material.maxdepth*N,R.transfermax.value=E.material.transfermax,R.transfermin.value=E.material.transfermin,R.subsamples.value=E.material.subsamples,T.setTexture(E.material.transferfn,4,!1),T.setTexture(E.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}R.opacity.value=A.opacity,this.loadMaterialUniforms(M,R)}return R.shading&&(R.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),_}loadMaterialUniforms(l,s){var y,A,E,T;for(y in s)l[y]&&(A=s[y].type,E=s[y].value,T=l[y],A==="f"?this._gl.uniform1f(T,E):A==="i"?this._gl.uniform1i(T,E):A==="fv"?this._gl.uniform3fv(T,E):A==="c"?this._gl.uniform3f(T,E.r,E.g,E.b):A==="f4"&&this._gl.uniform4f(T,E[0],E[1],E[2],E[3]))}addObject(l,s){var y,A,E,T;if(!l.__webglInit&&(l.__webglInit=!0,l._modelViewMatrix=new x.Matrix4,l._normalMatrix=new x.Matrix3,l.geometry!==void 0&&l.geometry.__webglInit===void 0&&(l.geometry.__webglInit=!0,l.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),l instanceof f.Mesh||l instanceof f.Line))for(E=l.geometry,y=0,A=E.geometryGroups.length;y<A;y++)T=E.geometryGroups[y],T.id=this._geometryGroupCounter++,T.__webglVertexBuffer||(l instanceof f.Mesh?(this.createMeshBuffers(T),E.elementsNeedUpdate=!0,E.normalsNeedUpdate=!0):l instanceof f.Line&&this.createLineBuffers(T),E.verticesNeedUpdate=!0,E.colorsNeedUpdate=!0);if(!l.__webglActive){if(l instanceof f.Mesh||l instanceof f.Line)for(E=l.geometry,y=0,A=E.geometryGroups.length;y<A;y++)T=E.geometryGroups[y],this.addBuffer(s.__webglObjects,T,l);else l instanceof f.Sprite&&s.__webglSprites.push(l);l.__webglActive=!0}}updateObject(l){var s=l.geometry,y;if(l instanceof f.Mesh||l instanceof f.Line){for(var A=0,E=s.geometryGroups.length;A<E;A++)y=s.geometryGroups[A],(s.verticesNeedUpdate||s.elementsNeedUpdate||s.colorsNeedUpdate||s.normalsNeedUpdate)&&this.setBuffers(y,this._gl.STATIC_DRAW);s.verticesNeedUpdate=!1,s.elementsNeedUpdate=!1,s.normalsNeedUpdate=!1,s.colorsNeedUpdate=!1,s.buffersNeedUpdate=!1}}removeObject(l,s){l instanceof f.Mesh||l instanceof f.Line?this.removeInstances(s.__webglObjects,l):l instanceof f.Sprite&&this.removeInstancesDirect(s.__webglSprites,l),l.__webglActive=!1}removeInstances(l,s){for(var y=l.length-1;y>=0;--y)l[y].object===s&&l.splice(y,1)}removeInstancesDirect(l,s){for(var y=l.length-1;y>=0;--y)l[y]===s&&l.splice(y,1)}unrollBufferMaterial(l){var s=l.object,y=s.material;if(y.volumetric)l.opaque=null,l.transparent=null,l.volumetric=y;else if(y.transparent){if(l.opaque=null,l.volumetric=null,l.transparent=y,!y.wireframe){let A=y.clone();A.opacity=0,l.transparentDepth=A}}else{if(l.opaque=y,l.transparent=null,l.volumetric=null,!y.wireframe){let A=y.clone();A.opacity=0,l.opaqueDepth=A}y.hasAO&&(l.hasAO=!0),(this._AOEnabled||l.hasAO)&&(l.opaqueShaded=y.clone(),l.opaqueShaded.shaded=!0)}}setBuffers(l,s){var y=l.vertexArray,A=l.colorArray;if(l.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,y,s)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,y,s)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,A,s),l.normalArray&&l.__webglNormalBuffer!==void 0){var E=l.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,E,s)}if(l.radiusArray&&l.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,l.radiusArray,s)),l.faceArray&&l.__webglFaceBuffer!==void 0){var T=l.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,l.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,T,s)}if(l.lineArray&&l.__webglLineBuffer!==void 0){var u=l.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,l.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,u,s)}}createMeshBuffers(l){l.radiusArray&&(l.__webglRadiusBuffer=this._gl.createBuffer()),l.useOffset&&(l.__webglOffsetBuffer=this._gl.createBuffer()),l.__webglVertexBuffer=this._gl.createBuffer(),l.__webglNormalBuffer=this._gl.createBuffer(),l.__webglColorBuffer=this._gl.createBuffer(),l.__webglFaceBuffer=this._gl.createBuffer(),l.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(l){l.__webglVertexBuffer=this._gl.createBuffer(),l.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(l,s,y){l.push({buffer:s,object:y,opaque:null,transparent:null})}setupMatrices(l,s){l._modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,l.matrixWorld),l._normalMatrix.getInverse(l._modelViewMatrix),l._normalMatrix.transpose()}filterFallback(l){return this._gl.LINEAR}setTextureParameters(l,s){l==this._gl.TEXTURE_2D?(this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(s.magFilter)),this._gl.texParameteri(l,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(s.minFilter))):(this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(l,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(l,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(l,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(l,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(l){return l===h.UnsignedByteType?this._gl.UNSIGNED_BYTE:l===h.RGBAFormat?this._gl.RGBA:l===h.NearestFilter?this._gl.NEAREST:0}setupLights(l,s){var y,A,E,T=0,u=0,_=0,M,R,N=this._lights,I=N.directional.colors,L=N.directional.positions,Y=0,B=0;for(y=0,A=s.length;y<A;y++)if(E=s[y],M=E.color,R=E.intensity,E instanceof v.Light){if(this._direction.getPositionFromMatrix(E.matrixWorld),this._vector3.getPositionFromMatrix(E.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;L[B]=this._direction.x,L[B+1]=this._direction.y,L[B+2]=this._direction.z,I[B]=M.r*R,I[B+1]=M.g*R,I[B+2]=M.b*R,B+=3,Y++}N.ambient[0]=T,N.ambient[1]=u,N.ambient[2]=_,N.directional.length=Y}initGL(){try{if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context.";var l=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(l[6])}catch(s){console.error(s)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearColor(0,0,0,1),this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(l,s,y,A,E,T,u){var _,M,R,N,I,L,Y;s?(I=l.length-1,L=-1,Y=-1):(I=0,L=l.length,Y=1);for(var B=I;B!==L;B+=Y)if(_=l[B],_.render){if(M=_.object,R=_.buffer,N=_[y],(_.hasAO||this._AOEnabled)&&_[y+"Shaded"]&&(N=_[y+"Shaded"]),!N)continue;u&&this.setBlending(!0),this.setDepthTest(N.depthTest),this.setDepthWrite(N.depthWrite),this.setPolygonOffset(N.polygonOffset,N.polygonOffsetFactor,N.polygonOffsetUnits);var D=M._modelViewMatrix.isReflected();if(this.setMaterialFaces(N,D),this.renderBuffer(A,E,T,N,R,M),(this._outlineEnabled||N.outline)&&!N.wireframe&&N.shaderID!=="basic"&&N.opacity!==0){let H=this._outlineMaterial;N.shaderID=="sphereimposter"?H=this._outlineSphereImposterMaterial:N.shaderID=="stickimposter"&&(H=this._outlineStickImposterMaterial),this.renderBuffer(A,E,T,H,R,M)}}}renderSprites(l,s,y){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(l,s,this._currentWidth,this._currentHeight,y),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}}),"./src/WebGL/SpritePlugin.ts":((r,e,t)=>{t.r(e),t.d(e,{SpritePlugin:()=>c});var o=t("./src/WebGL/shaders/index.ts");class c{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(p){this.gl=p.context,this.renderer=p,this.precision=p.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var g=0;this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=1,g=0,this.sprite.faces[g++]=0,this.sprite.faces[g++]=1,this.sprite.faces[g++]=2,this.sprite.faces[g++]=0,this.sprite.faces[g++]=2,this.sprite.faces[g++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(o.ShaderLib.sprite,this.precision||1),this.sprite.attributes={};const x={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),x.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),x.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),x.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),x.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),x.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),x.color=this.gl.getUniformLocation(this.sprite.program,"color"),x.map=this.gl.getUniformLocation(this.sprite.program,"map"),x.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),x.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),x.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),x.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),x.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),x.fogType=this.gl.getUniformLocation(this.sprite.program,"fogType"),x.fogDensity=this.gl.getUniformLocation(this.sprite.program,"fogDensity"),x.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),x.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),x.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),x.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=x}render(p,g,x,f,b){var C,S,k,l,s,y,A,E,T,u;if(!this.gl)throw new Error("WebGLRenderer not initialized");let _=[];(C=p?.__webglSprites)===null||C===void 0||C.forEach(oe=>{(b&&oe.material.depthTest==!1||!b&&oe.material.depthTest)&&_.push(oe)});let M=_.length;if(!M)return;const R=this.sprite.attributes,N=this.sprite.uniforms;if(!N)throw new Error("Uniforms not defined");var I=x*.5,L=f*.5;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(R.position),this.gl.enableVertexAttribArray(R.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(R.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(R.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(N.projectionMatrix,!1,g.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(N.map,0);var Y=0,B=0,D=p.fog;D?(this.gl.uniform3f(N.fogColor,D.color.r,D.color.g,D.color.b),this.gl.uniform1f(N.fogNear,D.near),this.gl.uniform1f(N.fogFar,D.far),this.gl.uniform1i(N.fogType,1),Y=1,B=1):(this.gl.uniform1i(N.fogType,0),Y=0,B=0);var H;let W,q,V,$,O=[];for(H=0;H<M;H++)W=_[H],q=W.material,q&&(q.depthTest==!1&&!b||!W.visible||q.opacity===0||(q.useScreenCoordinates?W.z=-W.position.z:(W._modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,W.matrixWorld),W.z=-W._modelViewMatrix.elements[14])));for(_.sort(h),H=0;H<M;H++)if(W=_[H],q=W.material,!!q&&!(!W.visible||q.opacity===0)&&q.map&&q.map.image&&q.map.image.width){this.gl.uniform1f(N?.alphaTest||null,q.alphaTest);var j=q.map.image.width,J=q.map.image.height;O[0]=j*this.renderer.devicePixelRatio/x,O[1]=J*this.renderer.devicePixelRatio/f,q.useScreenCoordinates===!0?(this.gl.uniform1i(N.useScreenCoordinates,1),this.gl.uniform3f(N.screenPosition,(W.position.x*this.renderer.devicePixelRatio-I)/I,(L-W.position.y*this.renderer.devicePixelRatio)/L,Math.max(0,Math.min(1,W.position.z)))):(this.gl.uniform1i(N.useScreenCoordinates,0),this.gl.uniformMatrix4fv(N.modelViewMatrix,!1,W._modelViewMatrix.elements)),p.fog&&q.fog?$=B:$=0,Y!==$&&(this.gl.uniform1i(N.fogType,$),Y=$),V=1/(q.scaleByViewport?f:1),O[0]*=V*W.scale.x,O[1]*=V*W.scale.y;let oe=(S=q?.alignment)===null||S===void 0?void 0:S.x,ie=(k=q?.alignment)===null||k===void 0?void 0:k.y;q.screenOffset&&(oe=(oe||0)+2*q.screenOffset.x/j,ie=(ie||0)+2*q.screenOffset.y/J),this.gl.uniform2f(N.uvScale,((l=q?.uvScale)===null||l===void 0?void 0:l.x)||1,((s=q?.uvScale)===null||s===void 0?void 0:s.y)||1),this.gl.uniform2f(N.uvOffset,((y=q?.uvOffset)===null||y===void 0?void 0:y.x)||0,((A=q?.uvOffset)===null||A===void 0?void 0:A.y)||0),this.gl.uniform2f(N.alignment,oe||0,ie||0),this.gl.uniform1f(N.opacity,q.opacity),this.gl.uniform3f(N.color,((E=q?.color)===null||E===void 0?void 0:E.r)||0,((T=q?.color)===null||T===void 0?void 0:T.g)||0,((u=q?.color)===null||u===void 0?void 0:u.b)||0),this.gl.uniform1f(N.rotation,W.rotation),this.gl.uniform2fv(N.scale,O),this.renderer.setDepthTest(q.depthTest),this.renderer.setDepthWrite(q.depthWrite),this.renderer.setTexture(q.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(p,g){if(!this.gl)throw new Error("WebGL Rendering context not found");var x=this.gl.createProgram();if(!x)throw new Error("Error creating webgl program");var f=this.gl.createShader(this.gl.FRAGMENT_SHADER),b=this.gl.createShader(this.gl.VERTEX_SHADER);if(!f)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!b)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var C="precision "+g+` float;
`;if(this.gl.shaderSource(f,C+p.fragmentShader),this.gl.shaderSource(b,C+p.vertexShader),this.gl.compileShader(f),this.gl.compileShader(b),!this.gl.getShaderParameter(f,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(b,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(f)} 
      ${this.gl.getShaderInfoLog(b)}`);return this.gl.attachShader(x,f),this.gl.attachShader(x,b),this.gl.linkProgram(x),this.gl.getProgramParameter(x,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),x}}function h(v,p){return v.z!==p.z?p.z-v.z:p.id-v.id}}),"./src/WebGL/constants/Coloring.ts":((r,e,t)=>{t.r(e),t.d(e,{Coloring:()=>o});var o;(function(c){c[c.NoColors=0]="NoColors",c[c.FaceColors=1]="FaceColors",c[c.VertexColors=2]="VertexColors"})(o||(o={}))}),"./src/WebGL/constants/Shading.ts":((r,e,t)=>{t.r(e),t.d(e,{Shading:()=>o});var o;(function(c){c[c.NoShading=0]="NoShading",c[c.FlatShading=1]="FlatShading",c[c.SmoothShading=2]="SmoothShading"})(o||(o={}))}),"./src/WebGL/constants/Sides.ts":((r,e,t)=>{t.r(e),t.d(e,{BackSide:()=>c,DoubleSide:()=>h,FrontSide:()=>o});const o=0,c=1,h=2}),"./src/WebGL/constants/SpriteAlignment.ts":((r,e,t)=>{t.r(e),t.d(e,{SpriteAlignment:()=>c});var o=t("./src/WebGL/math/index.ts");const c={topLeft:new o.Vector2(1,-1),topCenter:new o.Vector2(0,-1),topRight:new o.Vector2(-1,-1),centerLeft:new o.Vector2(1,0),center:new o.Vector2(0,0),centerRight:new o.Vector2(-1,0),bottomLeft:new o.Vector2(1,1),bottomCenter:new o.Vector2(0,1),bottomRight:new o.Vector2(-1,1)}}),"./src/WebGL/constants/TextureConstants.ts":((r,e,t)=>{t.r(e),t.d(e,{ClampToEdgeWrapping:()=>o,FloatType:()=>g,LinearFilter:()=>c,LinearMipMapLinearFilter:()=>v,NearestFilter:()=>h,R32Format:()=>b,RFormat:()=>f,RGBAFormat:()=>x,UnsignedByteType:()=>p});const o=1001,c=1006,h=1007,v=1008,p=1009,g=1010,x=1021,f=1022,b=1023}),"./src/WebGL/constants/TextureOperations.ts":((r,e,t)=>{t.r(e),t.d(e,{TextureOperations:()=>o});var o;(function(c){c[c.MultiplyOperation=0]="MultiplyOperation",c[c.MixOperation=1]="MixOperation",c[c.AddOperation=2]="AddOperation"})(o||(o={}))}),"./src/WebGL/constants/index.ts":((r,e,t)=>{t.r(e),t.d(e,{BackSide:()=>c.BackSide,ClampToEdgeWrapping:()=>p.ClampToEdgeWrapping,Coloring:()=>o.Coloring,DoubleSide:()=>c.DoubleSide,FloatType:()=>p.FloatType,FrontSide:()=>c.FrontSide,LinearFilter:()=>p.LinearFilter,LinearMipMapLinearFilter:()=>p.LinearMipMapLinearFilter,NearestFilter:()=>p.NearestFilter,R32Format:()=>p.R32Format,RFormat:()=>p.RFormat,RGBAFormat:()=>p.RGBAFormat,Shading:()=>h.Shading,SpriteAlignment:()=>v.SpriteAlignment,TextureOperations:()=>g.TextureOperations,UnsignedByteType:()=>p.UnsignedByteType});var o=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Sides.ts"),h=t("./src/WebGL/constants/Shading.ts"),v=t("./src/WebGL/constants/SpriteAlignment.ts"),p=t("./src/WebGL/constants/TextureConstants.ts"),g=t("./src/WebGL/constants/TextureOperations.ts")}),"./src/WebGL/core/EventDispatcher.ts":((r,e,t)=>{t.r(e),t.d(e,{EventDispatcher:()=>o});class o{constructor(){this.listeners={}}dispatchEvent(h){var v=this.listeners[h.type];if(v!==void 0){h.target=this;for(var p=0,g=v.length;p<g;p++)v[p].call(this,h)}}removeEventListener(h,v){if(!v)this.listeners[h]=[];else{var p=this.listeners[h].indexOf(v);p!==-1&&this.listeners[h].splice(p,1)}}addEventListener(h,v){this.listeners[h]===void 0&&(this.listeners[h]=[]),this.listeners[h].indexOf(v)===-1&&this.listeners[h].push(v)}}}),"./src/WebGL/core/Geometry.ts":((r,e,t)=>{t.r(e),t.d(e,{Geometry:()=>x,GeometryGroup:()=>g,GeometryIDCount:()=>f});var o=t("./src/WebGL/materials/LineBasicMaterial.ts"),c=t("./src/WebGL/core/EventDispatcher.ts"),h=t("./src/WebGL/math/index.ts"),v=t("./src/colors.ts");const p=65535;class g{constructor(C=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=C}setColors(C){var S=this.vertexArray,k=this.colorArray;if(!S)throw new Error("vertex array not initialized");if(!k)throw new Error("color array not initialized");if(S.length!=k.length){console.log("Cannot re-color geometry group due to mismatched lengths.");return}for(var l=0;l<S.length;l+=3){var s=C(S[l],S[l+1],S[l+2]);s instanceof v.Color||(s=v.CC.color(s)),k[l]=s.r,k[l+1]=s.g,k[l+2]=s.b}}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var C=new h.Vector3,S,k,l,s,y=0;y<this.vertices;++y)S=y*3,k=this.vertexArray[S],l=this.vertexArray[S+1],s=this.vertexArray[S+2],C.x+=k,C.y+=l,C.z+=s;return C.divideScalar(this.vertices),C}setNormals(){var C=this.faceArray,S=this.vertexArray,k=this.normalArray;if(!(!this.vertices||!this.faceidx)){if(!C)throw new Error("face array not initialized");if(!S)throw new Error("vertex array not initialized");if(!k)throw new Error("normal array not initialized");for(var l,s,y,A,E,T,u,_=0;_<C.length/3;++_)l=C[_*3]*3,s=C[_*3+1]*3,y=C[_*3+2]*3,A=new h.Vector3(S[l],S[l+1],S[l+2]),E=new h.Vector3(S[s],S[s+1],S[s+2]),T=new h.Vector3(S[y],S[y+1],S[y+2]),A.subVectors(A,E),T.subVectors(T,E),T.cross(A),u=T,u.normalize(),k[l]+=u.x,k[s]+=u.x,k[y]+=u.x,k[l+1]+=u.y,k[s+1]+=u.y,k[y+1]+=u.y,k[l+2]+=u.z,k[s+2]+=u.z,k[y+2]+=u.z}}setLineIndices(){if(this.faceidx&&!(this.lineArray&&this.lineArray.length==this.faceidx*2&&this.lineidx==this.faceidx*2)){var C=this.faceArray,S=this.lineArray=new Uint16Array(this.faceidx*2);if(this.lineidx=this.faceidx*2,!C)throw new Error("face array not initialized");for(var k=0;k<this.faceidx/3;++k){var l=k*3,s=l*2,y=C[l],A=C[l+1],E=C[l+2];S[s]=y,S[s+1]=A,S[s+2]=y,S[s+3]=E,S[s+4]=A,S[s+5]=E}}}vrml(C,S){var k,l,s,y,A,E,T,u,_,M,R,N,I,L,Y,B,D,H,W="";if(W+=C+`Shape {
`+C+` appearance Appearance {
`+C+`  material Material {
`+C+"   diffuseColor "+((k=S?.color)===null||k===void 0?void 0:k.r)+" "+((l=S?.color)===null||l===void 0?void 0:l.g)+" "+((s=S?.color)===null||s===void 0?void 0:s.b)+`
`,S.wireframe&&this.colorArray){let V=this.colorArray;W+=C+"    emissiveColor "+V[0]+" "+V[1]+" "+V[2]+`
`}S!=null&&S.transparent&&(W+=C+"   transparency "+(1-S.opacity)+`
`),W+=C+`  }
`,W+=C+` }
`;var q=C;if(C+=" ",S instanceof o.LineBasicMaterial||S.wireframe){W+=C+`geometry IndexedLineSet {
`+C+` colorPerVertex TRUE
`+C+` coord Coordinate {
`+C+`  point [
`;let V,$,O;for(let j=0;j<this.vertices;++j){let J=j*3;V=(y=this.vertexArray)===null||y===void 0?void 0:y[J],$=(A=this.vertexArray)===null||A===void 0?void 0:A[J+1],O=(E=this.vertexArray)===null||E===void 0?void 0:E[J+2],W+=C+"   "+V+" "+$+" "+O+`,
`}if(W+=C+`  ]
`,W+=C+` }
`,this.colorArray&&!S.wireframe){W+=C+` color Color {
`+C+`  color [
`;for(let j=0;j<this.vertices;++j){let J=j*3;V=this.colorArray[J],$=this.colorArray[J+1],O=this.colorArray[J+2],W+=C+"   "+V+" "+$+" "+O+`,
`}W+=C+`  ]
`,W+=C+` }
`}if(W+=C+` coordIndex [
`,S.wireframe&&this.faceArray)for(let j=0;j<this.faceidx;j+=3)V=(T=this.faceArray)===null||T===void 0?void 0:T[j],$=(u=this.faceArray)===null||u===void 0?void 0:u[j+1],O=(_=this.faceArray)===null||_===void 0?void 0:_[j+2],W+=C+"  "+V+", "+$+", "+O+`, -1,
`;else for(let j=0;j<this.vertices-1;j+=2)W+=C+"  "+j+", "+(j+1)+`, -1,
`;W+=C+` ]
`,W+=C+`}
`}else{W+=C+`geometry IndexedFaceSet {
`+C+` colorPerVertex TRUE
`+C+` normalPerVertex TRUE
`+C+` solid FALSE
`,W+=C+` coord Coordinate {
`+C+`  point [
`;let V,$,O;for(let j=0;j<this.vertices;++j){let J=j*3;V=(M=this.vertexArray)===null||M===void 0?void 0:M[J],$=(R=this.vertexArray)===null||R===void 0?void 0:R[J+1],O=(N=this.vertexArray)===null||N===void 0?void 0:N[J+2],W+=C+"   "+V+" "+$+" "+O+`,
`}W+=C+`  ]
`,W+=C+` }
`,W+=C+` normal Normal {
`+C+`  vector [
`;for(let j=0;j<this.vertices;++j){let J=j*3;V=(I=this.normalArray)===null||I===void 0?void 0:I[J],$=(L=this.normalArray)===null||L===void 0?void 0:L[J+1],O=(Y=this.normalArray)===null||Y===void 0?void 0:Y[J+2],W+=C+"   "+V+" "+$+" "+O+`,
`}if(W+=C+`  ]
`,W+=C+` }
`,this.colorArray){W+=C+` color Color {
`+C+`  color [
`;for(let j=0;j<this.vertices;++j){let J=j*3;V=this.colorArray[J],$=this.colorArray[J+1],O=this.colorArray[J+2],W+=C+"   "+V+" "+$+" "+O+`,
`}W+=C+`  ]
`,W+=C+` }
`}W+=C+` coordIndex [
`;for(let j=0;j<this.faceidx;j+=3)V=(B=this.faceArray)===null||B===void 0?void 0:B[j],$=(D=this.faceArray)===null||D===void 0?void 0:D[j+1],O=(H=this.faceArray)===null||H===void 0?void 0:H[j+2],W+=C+"  "+V+", "+$+", "+O+`, -1,
`;W+=C+` ]
`,W+=C+`}
`}return W+=q+"}",W}truncateArrayBuffers(C=!0,S=!1){var k=this.vertexArray,l=this.colorArray,s=this.normalArray,y=this.faceArray,A=this.lineArray,E=this.radiusArray;this.vertexArray=k?.subarray(0,this.vertices*3)||null,this.colorArray=l?.subarray(0,this.vertices*3)||null,C?(this.normalArray=s?.subarray(0,this.vertices*3)||null,this.faceArray=y?.subarray(0,this.faceidx)||null,this.lineidx>0?this.lineArray=A?.subarray(0,this.lineidx)||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),E&&(this.radiusArray=E.subarray(0,this.vertices)),S&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class x extends c.EventDispatcher{constructor(C=!1,S=!1,k=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=f++,this.mesh=C,this.radii=S,this.offset=k}updateGeoGroup(C=0){var S,k=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!k||k.vertices+C>(((S=k?.vertexArray)===null||S===void 0?void 0:S.length)||0)/3)&&(k=this.addGeoGroup()),k}vrml(C,S){for(var k="",l=this.geometryGroups.length,s=0;s<l;s++){var y=this.geometryGroups[s];k+=y.vrml(C,S)+`,
`}return k}addGeoGroup(){var C=new g(this.geometryGroups.length);return this.geometryGroups.push(C),this.groups=this.geometryGroups.length,C.vertexArray=new Float32Array(p*3),C.colorArray=new Float32Array(p*3),this.mesh&&(C.normalArray=new Float32Array(p*3),C.faceArray=new Uint16Array(p*6),C.lineArray=new Uint16Array(p*6)),this.radii&&(C.radiusArray=new Float32Array(p)),C.useOffset=this.offset,C}setUpNormals(...C){for(var S=0;S<this.groups;S++){var k=this.geometryGroups[S];k.setNormals(...C)}}setColors(...C){for(var S=this.geometryGroups.length,k=0;k<S;k++){var l=this.geometryGroups[k];l.setColors(...C)}}setUpWireframe(...C){for(var S=0;S<this.groups;S++){var k=this.geometryGroups[S];k.setLineIndices(...C)}}initTypedArrays(){for(var C=0;C<this.groups;C++){var S=this.geometryGroups[C];S.__inittedArrays!==!0&&S.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var C=0,S=0;S<this.groups;S++)C+=this.geometryGroups[S].vertices;return C}}let f=0}),"./src/WebGL/core/Object3D.ts":((r,e,t)=>{t.r(e),t.d(e,{Light:()=>g,Object3D:()=>v,Object3DIDCount:()=>h,Scene:()=>p});var o=t("./src/WebGL/math/index.ts"),c=t("./src/colors.ts");let h=0;class v{constructor(){this.id=h++,this.name="",this.children=[],this.position=new o.Vector3,this.rotation=new o.Vector3,this.matrix=new o.Matrix4,this.matrixWorld=new o.Matrix4,this.quaternion=new o.Quaternion,this.eulerOrder="XYZ",this.up=new o.Vector3(0,1,0),this.scale=new o.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(f){this.matrix.lookAt(f,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof o.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(f){if(f===this){console.error("Can't add $3Dmol.Object3D to itself");return}f.parent=this,this.children.push(f);for(var b=this;b.parent!==void 0;)b=b.parent;b!==void 0&&b instanceof p&&b.__addObject(f)}remove(f){var b=this.children.indexOf(f);if(b!==-1){f.parent=void 0,this.children.splice(b,1);for(var C=this;C.parent!==void 0;)C=C.parent;C!==void 0&&C instanceof p&&C.__removeObject(f)}}vrml(f){f||(f=" ");var b=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),C=0,S=0,k=0;if(b!=0){let y=Math.sin(b/2);C=this.quaternion.x/y,S=this.quaternion.y/y,k=this.quaternion.z/y}var l=f+`Transform {
`+f+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+f+" rotation "+C+" "+S+" "+k+" "+b+`
`+f+` children [
`;this.geometry&&(l+=this.geometry.vrml(f,this.material));for(var s=0;s<this.children.length;s++)l+=this.children[s].vrml(f+" ")+`,
`;return l+=` ]
`,l+="}",l}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof o.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),(this.scale.x!==1||this.scale.y!==1||this.scale.z!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(f){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||f===!0)&&(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var b=0;b<this.children.length;b++)this.children[b].updateMatrixWorld(!0)}clone(f){f===void 0&&(f=new v),f.name=this.name,f.up.copy(this.up),f.position.copy(this.position),f.rotation instanceof o.Vector3&&this.rotation instanceof o.Vector3?f.rotation.copy(this.rotation):f.rotation=this.rotation,f.eulerOrder=this.eulerOrder,f.scale.copy(this.scale),f.rotationAutoUpdate=this.rotationAutoUpdate,f.matrix.copy(this.matrix),f.matrixWorld.copy(this.matrixWorld),f.quaternion.copy(this.quaternion),f.matrixAutoUpdate=this.matrixAutoUpdate,f.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,f.useQuaternion=this.useQuaternion,f.visible=this.visible;for(var b=0;b<this.children.length;b++){var C=this.children[b];f.add(C.clone())}return f}setVisible(f){this.visible=f;for(var b=0;b<this.children.length;b++){var C=this.children[b];C.setVisible(f)}}}class p extends v{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(f){if(f instanceof g)this.__lights.indexOf(f)===-1&&this.__lights.push(f),f.target&&f.target.parent===void 0&&this.add(f.target);else if(this.__objects.indexOf(f)===-1){this.__objects.push(f),this.__objectsAdded.push(f);var b=this.__objectsRemoved.indexOf(f);b!==-1&&this.__objectsRemoved.splice(b,1)}for(var C=0;C<f.children.length;C++)this.__addObject(f.children[C])}__removeObject(f){var b;if(f instanceof g)b=this.__lights.indexOf(f),b!==-1&&this.__lights.splice(b,1);else if(b=this.__objects.indexOf(f),b!==-1){this.__objects.splice(b,1),this.__objectsRemoved.push(f);var C=this.__objectsAdded.indexOf(f);C!==-1&&this.__objectsAdded.splice(b,1)}for(var S=0;S<f.children.length;S++)this.__removeObject(f.children[S])}}class g extends v{constructor(f,b=1){super(),this.position=new o.Vector3(0,1,0),this.target=new v,this.castShadow=!1,this.onlyShadow=!1,this.color=new c.Color(f),this.intensity=b}}}),"./src/WebGL/core/Projector.ts":((r,e,t)=>{t.r(e),t.d(e,{Projector:()=>h});var o=t("./src/WebGL/math/index.ts");const c=new o.Matrix4;class h{static unprojectVector(p,g){return g.projectionMatrixInverse.getInverse(g.projectionMatrix),c.multiplyMatrices(g.matrixWorld,g.projectionMatrixInverse),p.applyProjection(c)}static projectVector(p,g){return g.matrixWorldInverse.getInverse(g.matrixWorld),c.multiplyMatrices(g.projectionMatrix,g.matrixWorldInverse),p.applyProjection(c)}projectVector(p,g){return h.projectVector(p,g)}unprojectVector(p,g){return h.unprojectVector(p,g)}}}),"./src/WebGL/core/Raycaster.ts":((r,e,t)=>{t.r(e),t.d(e,{Raycaster:()=>p,intersectObject:()=>y});var o=t("./src/WebGL/math/index.ts"),c=t("./src/WebGL/shapes/index.ts");const h=(A,E)=>A.distance-E.distance,v=new o.Matrix4;class p{constructor(E,T,u,_){this.precision=1e-4,this.linePrecision=.2,this.ray=new o.Ray(E,T),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=_||0,this.far=u||1/0}set(E,T){this.ray.set(E,T)}setFromCamera(E,T){T.ortho?(this.ray.origin.set(E.x,E.y,(T.near+T.far)/(T.near-T.far)).unproject(T),this.ray.direction.set(0,0,-1).transformDirection(T.matrixWorld)):(this.ray.origin.setFromMatrixPosition(T.matrixWorld),this.ray.direction.set(E.x,E.y,E.z),T.projectionMatrixInverse.getInverse(T.projectionMatrix),v.multiplyMatrices(T.matrixWorld,T.projectionMatrixInverse),this.ray.direction.applyProjection(v),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(E,T){for(var u=[],_=0,M=T.length;_<M;_++)y(E,T[_],this,u);return u.sort(h),u}}const g=A=>Math.min(Math.max(A,-1),1);var x=new c.Sphere,f=new c.Cylinder,b=new c.Triangle,C=new o.Vector3,S=new o.Vector3,k=new o.Vector3,l=new o.Vector3,s=new o.Vector3;function y(A,E,T,u){if(s.getPositionFromMatrix(A.matrixWorld),E.intersectionShape===void 0)return u;var _=E.intersectionShape,M=T.linePrecision;M*=A.matrixWorld.getMaxScaleOnAxis();var R=M*M;if(E.boundingSphere!==void 0&&E.boundingSphere instanceof c.Sphere&&(x.copy(E.boundingSphere),x.applyMatrix4(A.matrixWorld),!T.ray.isIntersectionSphere(x)))return u;var N,I,L,Y,B,D,H,W,q,V,$,O,j,J;for(N=0,I=_.triangle.length;N<I;N++)if(_.triangle[N]instanceof c.Triangle){if(b.copy(_.triangle[N]),b.applyMatrix4(A.matrixWorld),L=b.getNormal(),Y=T.ray.direction.dot(L),Y>=0||(C.subVectors(b.a,T.ray.origin),H=L.dot(C)/Y,H<0))continue;S.copy(T.ray.direction).multiplyScalar(H).add(T.ray.origin),S.sub(b.a),k.copy(b.b).sub(b.a),l.copy(b.c).sub(b.a);var oe=k.dot(l),ie=k.lengthSq(),he=l.lengthSq();if(O=(ie*S.dot(l)-oe*S.dot(k))/(ie*he-oe*oe),O<0||O>1||($=(S.dot(k)-O*oe)/ie,$<0||$>1||$+O>1))continue;u.push({clickable:E,distance:H})}for(N=0,I=_.cylinder.length;N<I;N++)if(_.cylinder[N]instanceof c.Cylinder){if(f.copy(_.cylinder[N]),f.applyMatrix4(A.matrixWorld),C.subVectors(f.c1,T.ray.origin),B=C.dot(f.direction),D=C.dot(T.ray.direction),Y=g(T.ray.direction.dot(f.direction)),q=1-Y*Y,q===0)continue;j=(Y*D-B)/q,J=(D-Y*B)/q,S.copy(f.direction).multiplyScalar(j).add(f.c1),k.copy(T.ray.direction).multiplyScalar(J).add(T.ray.origin),W=l.subVectors(S,k).lengthSq();var de=f.radius*f.radius;if(W<=de){if(V=(Y*B-D)*(Y*B-D)-q*(C.lengthSq()-B*B-de),V<=0?O=H=Math.sqrt(W):O=H=(D-Y*B-Math.sqrt(V))/q,$=Y*O-B,$<0||$*$>f.lengthSq()||O<0)continue;u.push({clickable:E,distance:H})}}for(N=0,I=_.line.length;N<I;N+=2){S.copy(_.line[N]),S.applyMatrix4(A.matrixWorld),k.copy(_.line[N+1]),k.applyMatrix4(A.matrixWorld),l.subVectors(k,S);var fe=l.lengthSq();l.normalize(),C.subVectors(S,T.ray.origin);var ue=C.dot(l);D=C.dot(T.ray.direction),Y=g(T.ray.direction.dot(l)),q=1-Y*Y,q!==0&&(j=(Y*D-ue)/q,J=(D-Y*ue)/q,S.add(l.multiplyScalar(j)),k.copy(T.ray.direction).multiplyScalar(J).add(T.ray.origin),W=l.subVectors(k,S).lengthSq(),W<R&&j*j<fe&&u.push({clickable:E,distance:J}))}for(N=0,I=_.sphere.length;N<I;N++)if(_.sphere[N]instanceof c.Sphere&&(x.copy(_.sphere[N]),x.applyMatrix4(A.matrixWorld),T.ray.isIntersectionSphere(x))){S.subVectors(x.center,T.ray.origin);var ye=S.dot(T.ray.direction);if(V=ye*ye-(S.lengthSq()-x.radius*x.radius),ye<0)return u;V<=0?H=ye:H=ye-Math.sqrt(V),u.push({clickable:E,distance:H})}return u}}),"./src/WebGL/core/Texture.ts":((r,e,t)=>{t.r(e),t.d(e,{Texture:()=>p,TextureIdCount:()=>g});var o=t("./src/WebGL/constants/TextureConstants.ts"),c=t("./src/WebGL/math/index.ts"),h=t("./src/WebGL/core/EventDispatcher.ts"),v=t("./src/WebGL/core/UVMapping.ts");class p extends h.EventDispatcher{constructor(f,b){super(),this.id=g++,this.name="",this.image=f,this.mapping=new v.UVMapping,this.wrapS=o.ClampToEdgeWrapping,this.wrapT=o.ClampToEdgeWrapping,this.anisotropy=1,b?(this.format=o.RFormat,this.type=o.FloatType,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=o.NearestFilter,this.minFilter=o.NearestFilter):(this.format=o.RGBAFormat,this.type=o.UnsignedByteType,this.offset=new c.Vector2(0,0),this.repeat=new c.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=o.LinearFilter,this.minFilter=o.LinearMipMapLinearFilter),this.needsUpdate=!1,this.onUpdate=null}clone(f=new p){return f.image=this.image,f.mapping=this.mapping,f.wrapS=this.wrapS,f.wrapT=this.wrapT,f.magFilter=this.magFilter,f.minFilter=this.minFilter,f.anisotropy=this.anisotropy,f.format=this.format,f.type=this.type,f.offset.copy(this.offset),f.repeat.copy(this.repeat),f.premultiplyAlpha=this.premultiplyAlpha,f.flipY=this.flipY,f.unpackAlignment=this.unpackAlignment,f}dispose(){this.dispatchEvent({type:"dispose"})}}let g=0}),"./src/WebGL/core/UVMapping.ts":((r,e,t)=>{t.r(e),t.d(e,{UVMapping:()=>o});class o{}}),"./src/WebGL/core/index.ts":((r,e,t)=>{t.r(e),t.d(e,{EventDispatcher:()=>o.EventDispatcher,Geometry:()=>c.Geometry,GeometryGroup:()=>c.GeometryGroup,GeometryIDCount:()=>c.GeometryIDCount,Light:()=>h.Light,Object3D:()=>h.Object3D,Object3DIDCount:()=>h.Object3DIDCount,Projector:()=>v.Projector,Raycaster:()=>p.Raycaster,Scene:()=>h.Scene,Texture:()=>g.Texture,TextureIdCount:()=>g.TextureIdCount,UVMapping:()=>x.UVMapping,intersectObject:()=>p.intersectObject});var o=t("./src/WebGL/core/EventDispatcher.ts"),c=t("./src/WebGL/core/Geometry.ts"),h=t("./src/WebGL/core/Object3D.ts"),v=t("./src/WebGL/core/Projector.ts"),p=t("./src/WebGL/core/Raycaster.ts"),g=t("./src/WebGL/core/Texture.ts"),x=t("./src/WebGL/core/UVMapping.ts")}),"./src/WebGL/index.ts":((r,e,t)=>{t.r(e),t.d(e,{BackSide:()=>o.BackSide,Camera:()=>f.Camera,ClampToEdgeWrapping:()=>o.ClampToEdgeWrapping,Coloring:()=>o.Coloring,Cylinder:()=>x.Cylinder,DoubleSide:()=>o.DoubleSide,EventDispatcher:()=>c.EventDispatcher,FloatType:()=>o.FloatType,Fog:()=>b.Fog,FrontSide:()=>o.FrontSide,Geometry:()=>c.Geometry,GeometryGroup:()=>c.GeometryGroup,GeometryIDCount:()=>c.GeometryIDCount,ImposterMaterial:()=>h.ImposterMaterial,InstancedMaterial:()=>h.InstancedMaterial,Light:()=>c.Light,Line:()=>p.Line,LineBasicMaterial:()=>h.LineBasicMaterial,LineStyle:()=>p.LineStyle,LinearFilter:()=>o.LinearFilter,LinearMipMapLinearFilter:()=>o.LinearMipMapLinearFilter,Material:()=>h.Material,MaterialIdCount:()=>h.MaterialIdCount,Matrix3:()=>v.Matrix3,Matrix4:()=>v.Matrix4,Mesh:()=>p.Mesh,MeshDoubleLambertMaterial:()=>h.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>h.MeshLambertMaterial,MeshOutlineMaterial:()=>h.MeshOutlineMaterial,NearestFilter:()=>o.NearestFilter,Object3D:()=>c.Object3D,Object3DIDCount:()=>c.Object3DIDCount,Projector:()=>c.Projector,Quaternion:()=>v.Quaternion,R32Format:()=>o.R32Format,RFormat:()=>o.RFormat,RGBAFormat:()=>o.RGBAFormat,Ray:()=>v.Ray,Raycaster:()=>c.Raycaster,Renderer:()=>C.Renderer,Scene:()=>c.Scene,ShaderLib:()=>g.ShaderLib,ShaderUtils:()=>g.ShaderUtils,Shading:()=>o.Shading,Sphere:()=>x.Sphere,SphereImposterMaterial:()=>h.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>h.SphereImposterOutlineMaterial,Sprite:()=>p.Sprite,SpriteAlignment:()=>o.SpriteAlignment,SpriteMaterial:()=>h.SpriteMaterial,SpritePlugin:()=>S.SpritePlugin,StickImposterMaterial:()=>h.StickImposterMaterial,StickImposterOutlineMaterial:()=>h.StickImposterOutlineMaterial,Texture:()=>c.Texture,TextureIdCount:()=>c.TextureIdCount,TextureOperations:()=>o.TextureOperations,Triangle:()=>x.Triangle,UVMapping:()=>c.UVMapping,UnsignedByteType:()=>o.UnsignedByteType,Vector2:()=>v.Vector2,Vector3:()=>v.Vector3,VolumetricMaterial:()=>h.VolumetricMaterial,basic:()=>g.basic,clamp:()=>v.clamp,clone:()=>g.clone,conversionMatrix3:()=>v.conversionMatrix3,degToRad:()=>v.degToRad,instanced:()=>g.instanced,intersectObject:()=>c.intersectObject,lambert:()=>g.lambert,lambertdouble:()=>g.lambertdouble,outline:()=>g.outline,screen:()=>g.screen,screenaa:()=>g.screenaa,sphereimposter:()=>g.sphereimposter,sphereimposteroutline:()=>g.sphereimposteroutline,sprite:()=>g.sprite,stickimposter:()=>g.stickimposter,stickimposteroutline:()=>g.stickimposteroutline,volumetric:()=>g.volumetric});var o=t("./src/WebGL/constants/index.ts"),c=t("./src/WebGL/core/index.ts"),h=t("./src/WebGL/materials/index.ts"),v=t("./src/WebGL/math/index.ts"),p=t("./src/WebGL/objects/index.ts"),g=t("./src/WebGL/shaders/index.ts"),x=t("./src/WebGL/shapes/index.ts"),f=t("./src/WebGL/Camera.ts"),b=t("./src/WebGL/Fog.ts"),C=t("./src/WebGL/Renderer.ts"),S=t("./src/WebGL/SpritePlugin.ts")}),"./src/WebGL/materials/ImposterMaterial.ts":((r,e,t)=>{t.r(e),t.d(e,{ImposterMaterial:()=>g});var o=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Shading.ts"),h=t("./src/colors.ts"),v=t("./src/WebGL/math/index.ts"),p=t("./src/WebGL/materials/Material.ts");class g extends p.Material{constructor(f){super(),this.color=new h.Color(16777215),this.ambient=new h.Color(1048575),this.emissive=new h.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new v.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=c.Shading.SmoothShading,this.shaderID=null,this.vertexColors=o.Coloring.NoColors,this.skinning=!1,this.setValues(f)}clone(f=new g){return super.clone.call(this,f),f.color.copy(this.color),f.ambient.copy(this.ambient),f.emissive.copy(this.emissive),f.wrapAround=this.wrapAround,f.wrapRGB.copy(this.wrapRGB),f.map=this.map,f.lightMap=this.lightMap,f.specularMap=this.specularMap,f.envMap=this.envMap,f.combine=this.combine,f.reflectivity=this.reflectivity,f.refractionRatio=this.refractionRatio,f.fog=this.fog,f.shading=this.shading,f.shaderID=this.shaderID,f.vertexColors=this.vertexColors,f.skinning=this.skinning,f.morphTargets=this.morphTargets,f.morphNormals=this.morphNormals,f}}}),"./src/WebGL/materials/InstancedMaterial.ts":((r,e,t)=>{t.r(e),t.d(e,{InstancedMaterial:()=>g});var o=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Shading.ts"),h=t("./src/colors.ts"),v=t("./src/WebGL/math/index.ts"),p=t("./src/WebGL/materials/Material.ts");class g extends p.Material{constructor(f){super(),this.color=new h.Color(16777215),this.ambient=new h.Color(1048575),this.emissive=new h.Color(0),this.wrapAround=!1,this.wrapRGB=new v.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=c.Shading.SmoothShading,this.shaderID="instanced",this.vertexColors=o.Coloring.NoColors,this.skinning=!1,this.sphere=null,this.setValues(f)}clone(f=new g){return super.clone.call(this,f),f.color.copy(this.color),f.ambient.copy(this.ambient),f.emissive.copy(this.emissive),f.wrapAround=this.wrapAround,f.wrapRGB.copy(this.wrapRGB),f.map=this.map,f.lightMap=this.lightMap,f.specularMap=this.specularMap,f.envMap=this.envMap,f.combine=this.combine,f.reflectivity=this.reflectivity,f.refractionRatio=this.refractionRatio,f.fog=this.fog,f.shading=this.shading,f.shaderID=this.shaderID,f.vertexColors=this.vertexColors,f.skinning=this.skinning,f.morphTargets=this.morphTargets,f.morphNormals=this.morphNormals,f.sphere=this.sphere,f}}}),"./src/WebGL/materials/LineBasicMaterial.ts":((r,e,t)=>{t.r(e),t.d(e,{LineBasicMaterial:()=>h});var o=t("./src/colors.ts"),c=t("./src/WebGL/materials/Material.ts");class h extends c.Material{constructor(p){super(),this.color=new o.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(p)}clone(p=new h){return super.clone.call(this,p),p.color.copy(this.color),p}}}),"./src/WebGL/materials/Material.ts":((r,e,t)=>{t.r(e),t.d(e,{Material:()=>p,MaterialIdCount:()=>g});var o=t("./src/WebGL/constants/Sides.ts"),c=t("./src/WebGL/core/index.ts"),h=t("./src/WebGL/math/index.ts"),v=t("./src/colors.ts");class p extends c.EventDispatcher{constructor(){super(...arguments),this.id=g++,this.name="",this.side=o.FrontSide,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(f={}){if(f!==void 0)for(var b in f){var C=f[b];if(C===void 0){console.warn("$3Dmol.Material: '"+b+"' parameter is undefined.");continue}if(b in this){var S=this[b];S instanceof v.Color&&C instanceof v.Color?S.copy(C):S instanceof v.Color?S.set(C):S instanceof h.Vector3&&C instanceof h.Vector3?S.copy(C):this[b]=C}}}clone(f=new p){return f.name=this.name,f.side=this.side,f.opacity=this.opacity,f.transparent=this.transparent,f.depthTest=this.depthTest,f.depthWrite=this.depthWrite,f.polygonOffset=this.polygonOffset,f.polygonOffsetFactor=this.polygonOffsetFactor,f.polygonOffsetUnits=this.polygonOffsetUnits,f.alphaTest=this.alphaTest,f.overdraw=this.overdraw,f.visible=this.visible,f}makeShaded(f){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:f},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let g=0}),"./src/WebGL/materials/MeshDoubleLambertMaterial.ts":((r,e,t)=>{t.r(e),t.d(e,{MeshDoubleLambertMaterial:()=>h});var o=t("./src/WebGL/constants/Sides.ts"),c=t("./src/WebGL/materials/MeshLambertMaterial.ts");class h extends c.MeshLambertMaterial{constructor(p){super(p),this.shaderID="lambertdouble",this.side=o.DoubleSide,this.outline=!1}clone(p=new h){return super.clone.call(this,p),p}}}),"./src/WebGL/materials/MeshLambertMaterial.ts":((r,e,t)=>{t.r(e),t.d(e,{MeshLambertMaterial:()=>g});var o=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Shading.ts"),h=t("./src/WebGL/materials/Material.ts"),v=t("./src/colors.ts"),p=t("./src/WebGL/math/index.ts");class g extends h.Material{constructor(f){super(),this.color=new v.Color(16777215),this.ambient=new v.Color(1048575),this.emissive=new v.Color(0),this.wrapAround=!1,this.wrapRGB=new p.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=c.Shading.SmoothShading,this.shaderID="lambert",this.vertexColors=o.Coloring.NoColors,this.skinning=!1,this.setValues(f)}clone(f=new g){return super.clone.call(this,f),f.color.copy(this.color),f.ambient.copy(this.ambient),f.emissive.copy(this.emissive),f.wrapAround=this.wrapAround,f.wrapRGB.copy(this.wrapRGB),f.map=this.map,f.lightMap=this.lightMap,f.specularMap=this.specularMap,f.envMap=this.envMap,f.combine=this.combine,f.reflectivity=this.reflectivity,f.refractionRatio=this.refractionRatio,f.fog=this.fog,f.shading=this.shading,f.shaderID=this.shaderID,f.vertexColors=this.vertexColors,f.skinning=this.skinning,f.morphTargets=this.morphTargets,f.morphNormals=this.morphNormals,f}}}),"./src/WebGL/materials/MeshOutlineMaterial.ts":((r,e,t)=>{t.r(e),t.d(e,{MeshOutlineMaterial:()=>h});var o=t("./src/colors.ts"),c=t("./src/WebGL/materials/Material.ts");class h extends c.Material{constructor(p){super(),p=p||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=p.color||new o.Color(0,0,0),this.outlineWidth=p.width||.1,this.outlinePushback=p.pushback||1}clone(p=new h){return super.clone.call(this,p),p.fog=this.fog,p.shaderID=this.shaderID,p.wireframe=this.wireframe,p}}}),"./src/WebGL/materials/SphereImposterMaterial.ts":((r,e,t)=>{t.r(e),t.d(e,{SphereImposterMaterial:()=>c});var o=t("./src/WebGL/materials/ImposterMaterial.ts");class c extends o.ImposterMaterial{constructor(v){super(v),this.shaderID="sphereimposter",this.setValues(v)}clone(v=new c){return super.clone.call(this,v),v}}}),"./src/WebGL/materials/SphereImposterOutlineMaterial.ts":((r,e,t)=>{t.r(e),t.d(e,{SphereImposterOutlineMaterial:()=>h});var o=t("./src/colors.ts"),c=t("./src/WebGL/materials/ImposterMaterial.ts");class h extends c.ImposterMaterial{constructor(p){super(p),p=p||{},this.shaderID="sphereimposteroutline",this.outlineColor=p.color||new o.Color(0,0,0),this.outlineWidth=p.width||.1,this.outlinePushback=p.pushback||1,this.setValues(p)}clone(p=new h){return super.clone.call(this,p),p.outlineColor=this.outlineColor,p.outlineWidth=this.outlineWidth,p.outlinePushback=this.outlinePushback,p}}}),"./src/WebGL/materials/SpriteMaterial.ts":((r,e,t)=>{t.r(e),t.d(e,{SpriteMaterial:()=>g});var o=t("./src/WebGL/constants/SpriteAlignment.ts"),c=t("./src/WebGL/core/Texture.ts"),h=t("./src/colors.ts"),v=t("./src/WebGL/math/index.ts"),p=t("./src/WebGL/materials/Material.ts");class g extends p.Material{constructor(f){super(),this.color=new h.Color(16777215),this.map=new c.Texture,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new v.Vector2(0,0),this.uvScale=new v.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=o.SpriteAlignment.center.clone(),this.setValues(f),f=f||{},f.depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),f.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),f.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(f=new g){return super.clone.call(this,f),f.color.copy(this.color),f.map=this.map,f.useScreenCoordinates=this.useScreenCoordinates,f.screenOffset=this.screenOffset,f.sizeAttenuation=this.sizeAttenuation,f.scaleByViewport=this.scaleByViewPort,f.alignment.copy(this.alignment),f.uvOffset.copy(this.uvOffset),f}}}),"./src/WebGL/materials/StickImposterMaterial.ts":((r,e,t)=>{t.r(e),t.d(e,{StickImposterMaterial:()=>c});var o=t("./src/WebGL/materials/ImposterMaterial.ts");class c extends o.ImposterMaterial{constructor(v){super(v),this.shaderID="stickimposter",this.setValues(v)}clone(v=new c){return super.clone.call(this,v),v}}}),"./src/WebGL/materials/StickImposterOutlineMaterial.ts":((r,e,t)=>{t.r(e),t.d(e,{StickImposterOutlineMaterial:()=>h});var o=t("./src/colors.ts"),c=t("./src/WebGL/materials/ImposterMaterial.ts");class h extends c.ImposterMaterial{constructor(p={}){super(p),this.shaderID="stickimposteroutline",this.outlineColor=new o.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,p.color&&(this.outlineColor=p.color),p.width&&(this.outlineWidth=p.width),p.pushback&&(this.outlinePushback=p.pushback),this.setValues(p)}clone(p=new h){return super.clone.call(this,p),p.outlineColor=this.outlineColor,p.outlineWidth=this.outlineWidth,p.outlinePushback=this.outlinePushback,p}}}),"./src/WebGL/materials/VolumetricMaterial.ts":((r,e,t)=>{t.r(e),t.d(e,{VolumetricMaterial:()=>v});var o=t("./src/WebGL/constants/Sides.ts"),c=t("./src/colors.ts"),h=t("./src/WebGL/materials/Material.ts");class v extends h.Material{constructor(g){super(),this.transparent=!1,this.volumetric=!0,this.color=new c.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=o.FrontSide,this.setValues(g)}clone(g=new v){return super.clone.call(this,g),g.transparent=this.transparent,g.volumetric=this.volumetric,g.color=this.color,g.transferfn=this.transferfn,g.map=this.map,g.extent=this.extent,g.maxdepth=this.maxdepth,g.unit=this.unit,g.texmatrix=this.texmatrix,g.transfermin=this.transfermin,g.transfermax=this.transfermax,g.subsamples=this.subsamples,g.shaderID=this.shaderID,g.side=this.side,g}}}),"./src/WebGL/materials/index.ts":((r,e,t)=>{t.r(e),t.d(e,{ImposterMaterial:()=>o.ImposterMaterial,InstancedMaterial:()=>c.InstancedMaterial,LineBasicMaterial:()=>h.LineBasicMaterial,Material:()=>v.Material,MaterialIdCount:()=>v.MaterialIdCount,MeshDoubleLambertMaterial:()=>p.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>g.MeshLambertMaterial,MeshOutlineMaterial:()=>x.MeshOutlineMaterial,SphereImposterMaterial:()=>f.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>b.SphereImposterOutlineMaterial,SpriteMaterial:()=>C.SpriteMaterial,StickImposterMaterial:()=>S.StickImposterMaterial,StickImposterOutlineMaterial:()=>k.StickImposterOutlineMaterial,VolumetricMaterial:()=>l.VolumetricMaterial});var o=t("./src/WebGL/materials/ImposterMaterial.ts"),c=t("./src/WebGL/materials/InstancedMaterial.ts"),h=t("./src/WebGL/materials/LineBasicMaterial.ts"),v=t("./src/WebGL/materials/Material.ts"),p=t("./src/WebGL/materials/MeshDoubleLambertMaterial.ts"),g=t("./src/WebGL/materials/MeshLambertMaterial.ts"),x=t("./src/WebGL/materials/MeshOutlineMaterial.ts"),f=t("./src/WebGL/materials/SphereImposterMaterial.ts"),b=t("./src/WebGL/materials/SphereImposterOutlineMaterial.ts"),C=t("./src/WebGL/materials/SpriteMaterial.ts"),S=t("./src/WebGL/materials/StickImposterMaterial.ts"),k=t("./src/WebGL/materials/StickImposterOutlineMaterial.ts"),l=t("./src/WebGL/materials/VolumetricMaterial.ts")}),"./src/WebGL/math/Quaternion.ts":((r,e,t)=>{t.r(e),t.d(e,{Quaternion:()=>o});class o{constructor(h,v,p,g){this.x=h||0,this.y=v||0,this.z=p||0,this.w=g!==void 0?g:1}set(h,v,p,g){return this.x=h,this.y=v,this.z=p,this.w=g,this}copy(h){return this.x=h.x,this.y=h.y,this.z=h.z,this.w=h.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let h=this.length();return h===0?(this.x=0,this.y=0,this.z=0,this.w=1):(h=1/h,this.x*=h,this.y*=h,this.z*=h,this.w*=h),this}multiply(h){return this.multiplyQuaternions(this,h)}multiplyScalar(h){return this.x*=h,this.y*=h,this.z*=h,this.w*=h,this}multiplyQuaternions(h,v){const p=h.x,g=h.y,x=h.z,f=h.w,b=v.x,C=v.y,S=v.z,k=v.w;return this.x=p*k+f*b+g*S-x*C,this.y=g*k+f*C+x*b-p*S,this.z=x*k+f*S+p*C-g*b,this.w=f*k-p*b-g*C-x*S,this}sub(h){return this.x-=h.x,this.y-=h.y,this.z-=h.z,this.w-=h.w,this}clone(){return new o(this.x,this.y,this.z,this.w)}setFromEuler(h){const v=Math.cos(h.x/2),p=Math.cos(h.y/2),g=Math.cos(h.z/2),x=Math.sin(h.x/2),f=Math.sin(h.y/2),b=Math.sin(h.z/2);return this.x=x*p*g+v*f*b,this.y=v*f*g-x*p*b,this.z=v*p*b+x*f*g,this.w=v*p*g-x*f*b,this}}}),"./src/WebGL/math/Vector2.ts":((r,e,t)=>{t.r(e),t.d(e,{Vector2:()=>o});class o{constructor(h,v){this.x=h||0,this.y=v||0}set(h,v){return this.x=h,this.y=v,this}subVectors(h,v){return this.x=h.x-v.x,this.y=h.y-v.y,this}copy(h){return this.x=h.x,this.y=h.y,this}clone(){return new o(this.x,this.y)}}}),"./src/WebGL/math/index.ts":((r,e,t)=>{t.r(e),t.d(e,{Matrix3:()=>g.Matrix3,Matrix4:()=>g.Matrix4,Quaternion:()=>o.Quaternion,Ray:()=>g.Ray,Vector2:()=>c.Vector2,Vector3:()=>g.Vector3,clamp:()=>h.clamp,conversionMatrix3:()=>v.conversionMatrix3,degToRad:()=>p.degToRad});var o=t("./src/WebGL/math/Quaternion.ts"),c=t("./src/WebGL/math/Vector2.ts"),h=t("./src/WebGL/math/utils/clamp.ts"),v=t("./src/WebGL/math/utils/conversionMatrix3.ts"),p=t("./src/WebGL/math/utils/degToRad.ts"),g=t("./src/WebGL/math/math.ts")}),"./src/WebGL/math/math.ts":((r,e,t)=>{t.r(e),t.d(e,{Matrix3:()=>C,Matrix4:()=>f,Ray:()=>S,Vector3:()=>b});var o=t("./src/WebGL/math/utils/degToRad.ts"),c=t("./src/WebGL/math/utils/clamp.ts"),h,v,p,g,x;class f{constructor(l=1,s=0,y=0,A=0,E=0,T=1,u=0,_=0,M=0,R=0,N=1,I=0,L=0,Y=0,B=0,D=1){typeof l<"u"&&typeof l!="number"?this.elements=new Float32Array(l):(this.elements=new Float32Array(16),this.elements[0]=l,this.elements[4]=s,this.elements[8]=y,this.elements[12]=A,this.elements[1]=E,this.elements[5]=T,this.elements[9]=u,this.elements[13]=_,this.elements[2]=M,this.elements[6]=R,this.elements[10]=N,this.elements[14]=I,this.elements[3]=L,this.elements[7]=Y,this.elements[11]=B,this.elements[15]=D)}makeScale(l,s,y){throw new Error("Method not implemented.")}set(l,s,y,A,E,T,u,_,M,R,N,I,L,Y,B,D){const H=this.elements;return H[0]=l,H[4]=s,H[8]=y,H[12]=A,H[1]=E,H[5]=T,H[9]=u,H[13]=_,H[2]=M,H[6]=R,H[10]=N,H[14]=I,H[3]=L,H[7]=Y,H[11]=B,H[15]=D,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(l){const s=l.elements;return this.set(s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14],s[3],s[7],s[11],s[15]),this}matrix3FromTopLeft(){const l=this.elements;return new C(l[0],l[4],l[8],l[1],l[5],l[9],l[2],l[6],l[10])}setRotationFromEuler(l,s){const y=this.elements,{x:A,y:E,z:T}=l,u=Math.cos(A),_=Math.sin(A),M=Math.cos(E),R=Math.sin(E),N=Math.cos(T),I=Math.sin(T);if(s===void 0||s==="XYZ"){const L=u*N,Y=u*I,B=_*N,D=_*I;y[0]=M*N,y[4]=-M*I,y[8]=R,y[1]=Y+B*R,y[5]=L-D*R,y[9]=-_*M,y[2]=D-L*R,y[6]=B+Y*R,y[10]=u*M}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${s}`);return this}setRotationFromQuaternion(l){const s=this.elements,{x:y,y:A,z:E,w:T}=l,u=y+y,_=A+A,M=E+E,R=y*u,N=y*_,I=y*M,L=A*_,Y=A*M,B=E*M,D=T*u,H=T*_,W=T*M;return s[0]=1-(L+B),s[4]=N-W,s[8]=I+H,s[1]=N+W,s[5]=1-(R+B),s[9]=Y-D,s[2]=I-H,s[6]=Y+D,s[10]=1-(R+L),this}multiplyMatrices(l,s){const y=l.elements,A=s.elements,E=this.elements,T=y[0],u=y[4],_=y[8],M=y[12],R=y[1],N=y[5],I=y[9],L=y[13],Y=y[2],B=y[6],D=y[10],H=y[14],W=y[3],q=y[7],V=y[11],$=y[15],O=A[0],j=A[4],J=A[8],oe=A[12],ie=A[1],he=A[5],de=A[9],fe=A[13],ue=A[2],ye=A[6],ze=A[10],$e=A[14],We=A[3],Fe=A[7],me=A[11],ke=A[15];return E[0]=T*O+u*ie+_*ue+M*We,E[4]=T*j+u*he+_*ye+M*Fe,E[8]=T*J+u*de+_*ze+M*me,E[12]=T*oe+u*fe+_*$e+M*ke,E[1]=R*O+N*ie+I*ue+L*We,E[5]=R*j+N*he+I*ye+L*Fe,E[9]=R*J+N*de+I*ze+L*me,E[13]=R*oe+N*fe+I*$e+L*ke,E[2]=Y*O+B*ie+D*ue+H*We,E[6]=Y*j+B*he+D*ye+H*Fe,E[10]=Y*J+B*de+D*ze+H*me,E[14]=Y*oe+B*fe+D*$e+H*ke,E[3]=W*O+q*ie+V*ue+$*We,E[7]=W*j+q*he+V*ye+$*Fe,E[11]=W*J+q*de+V*ze+$*me,E[15]=W*oe+q*fe+V*$e+$*ke,this}multiplyScalar(l){const s=this.elements;return s[0]*=l,s[4]*=l,s[8]*=l,s[12]*=l,s[1]*=l,s[5]*=l,s[9]*=l,s[13]*=l,s[2]*=l,s[6]*=l,s[10]*=l,s[14]*=l,s[3]*=l,s[7]*=l,s[11]*=l,s[15]*=l,this}makeTranslation(l,s,y){return this.set(1,0,0,l,0,1,0,s,0,0,1,y,0,0,0,1),this}snap(l){const s=Math.pow(10,4),y=this.elements;for(let A=0;A<16;A++){const E=Math.round(y[A]);E===Math.round(y[A]*s)/s&&(y[A]=E)}return this}transpose(){const l=this.elements;let s;return s=l[1],l[1]=l[4],l[4]=s,s=l[2],l[2]=l[8],l[8]=s,s=l[6],l[6]=l[9],l[9]=s,s=l[3],l[3]=l[12],l[12]=s,s=l[7],l[7]=l[13],l[13]=s,s=l[11],l[11]=l[14],l[14]=s,this}setPosition(l){const s=this.elements;return s[12]=l.x,s[13]=l.y,s[14]=l.z,this}translate(l){const s=this.elements;return s[12]+=l.x,s[13]+=l.y,s[14]+=l.z,this}getInverse(l,s){const y=this.elements,A=l.elements,E=A[0],T=A[4],u=A[8],_=A[12],M=A[1],R=A[5],N=A[9],I=A[13],L=A[2],Y=A[6],B=A[10],D=A[14],H=A[3],W=A[7],q=A[11],V=A[15];y[0]=N*D*W-I*B*W+I*Y*q-R*D*q-N*Y*V+R*B*V,y[4]=_*B*W-u*D*W-_*Y*q+T*D*q+u*Y*V-T*B*V,y[8]=u*I*W-_*N*W+_*R*q-T*I*q-u*R*V+T*N*V,y[12]=_*N*Y-u*I*Y-_*R*B+T*I*B+u*R*D-T*N*D,y[1]=I*B*H-N*D*H-I*L*q+M*D*q+N*L*V-M*B*V,y[5]=u*D*H-_*B*H+_*L*q-E*D*q-u*L*V+E*B*V,y[9]=_*N*H-u*I*H-_*M*q+E*I*q+u*M*V-E*N*V,y[13]=u*I*L-_*N*L+_*M*B-E*I*B-u*M*D+E*N*D,y[2]=R*D*H-I*Y*H+I*L*W-M*D*W-R*L*V+M*Y*V,y[6]=_*Y*H-T*D*H-_*L*W+E*D*W+T*L*V-E*Y*V,y[10]=T*I*H-_*R*H+_*M*W-E*I*W-T*M*V+E*R*V,y[14]=_*R*L-T*I*L-_*M*Y+E*I*Y+T*M*D-E*R*D,y[3]=N*Y*H-R*B*H-N*L*W+M*B*W+R*L*q-M*Y*q,y[7]=T*B*H-u*Y*H+u*L*W-E*B*W-T*L*q+E*Y*q,y[11]=u*R*H-T*N*H-u*M*W+E*N*W+T*M*q-E*R*q,y[15]=T*N*L-u*R*L+u*M*Y-E*N*Y-T*M*B+E*R*B;const $=E*y[0]+M*y[4]+L*y[8]+H*y[12];if($===0){const O="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(s)throw new Error(O);return console.warn(O),this.identity(),this}return this.multiplyScalar(1/$),this}isReflected(){const l=this.elements,s=l[0],y=l[4],A=l[8],E=l[1],T=l[5],u=l[9],_=l[2],M=l[6],R=l[10];return s*T*R+E*M*A+_*y*u-_*T*A-E*y*R-s*M*u<0}scale(l){const s=this.elements,{x:y}=l,{y:A}=l,{z:E}=l;return s[0]*=y,s[4]*=A,s[8]*=E,s[1]*=y,s[5]*=A,s[9]*=E,s[2]*=y,s[6]*=A,s[10]*=E,s[3]*=y,s[7]*=A,s[11]*=E,this}getMaxScaleOnAxis(){const l=this.elements,s=l[0]*l[0]+l[1]*l[1]+l[2]*l[2],y=l[4]*l[4]+l[5]*l[5]+l[6]*l[6],A=l[8]*l[8]+l[9]*l[9]+l[10]*l[10];return Math.sqrt(Math.max(s,Math.max(y,A)))}makeFrustum(l,s,y,A,E,T){const u=this.elements,_=2*E/(s-l),M=2*E/(A-y),R=(s+l)/(s-l),N=(A+y)/(A-y),I=-(T+E)/(T-E),L=-2*T*E/(T-E);return u[0]=_,u[4]=0,u[8]=R,u[12]=0,u[1]=0,u[5]=M,u[9]=N,u[13]=0,u[2]=0,u[6]=0,u[10]=I,u[14]=L,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makePerspective(l,s,y,A){const E=y*Math.tan((0,o.degToRad)(l*.5)),T=-E,u=T*s,_=E*s;return this.makeFrustum(u,_,T,E,y,A)}makeOrthographic(l,s,y,A,E,T){const u=this.elements,_=1/(s-l),M=1/(y-A),R=1/(T-E),N=(s+l)*_,I=(y+A)*M,L=(T+E)*R;return u[0]=2*_,u[4]=0,u[8]=0,u[12]=-N,u[1]=0,u[5]=2*M,u[9]=0,u[13]=-I,u[2]=0,u[6]=0,u[10]=-2*R,u[14]=-L,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}isEqual(l){const s=l.elements,y=this.elements;return y[0]===s[0]&&y[4]===s[4]&&y[8]===s[8]&&y[12]===s[12]&&y[1]===s[1]&&y[5]===s[5]&&y[9]===s[9]&&y[13]===s[13]&&y[2]===s[2]&&y[6]===s[6]&&y[10]===s[10]&&y[14]===s[14]&&y[3]===s[3]&&y[7]===s[7]&&y[11]===s[11]&&y[15]===s[15]}clone(){const l=this.elements;return new f(l[0],l[4],l[8],l[12],l[1],l[5],l[9],l[13],l[2],l[6],l[10],l[14],l[3],l[7],l[11],l[15])}isIdentity(){const l=this.elements;return l[0]===1&&l[4]===0&&l[8]===0&&l[12]===0&&l[1]===0&&l[5]===1&&l[9]===0&&l[13]===0&&l[2]===0&&l[6]===0&&l[10]===1&&l[14]===0&&l[3]===0&&l[7]===0&&l[11]===0&&l[15]===1}isNearlyIdentity(l){return this.clone().snap(l).isIdentity()}getScale(l){const s=this.elements;return l=l||new b,p.set(s[0],s[1],s[2]),g.set(s[4],s[5],s[6]),x.set(s[8],s[9],s[10]),l.x=p.length(),l.y=g.length(),l.z=x.length(),l}lookAt(l,s,y){const A=this.elements;return x.subVectors(l,s).normalize(),x.length()===0&&(x.z=1),p.crossVectors(y,x).normalize(),p.length()===0&&(x.x+=1e-4,p.crossVectors(y,x).normalize()),g.crossVectors(x,p),A[0]=p.x,A[4]=g.x,A[8]=x.x,A[1]=p.y,A[5]=g.y,A[9]=x.y,A[2]=p.z,A[6]=g.z,A[10]=x.z,this}compose(l,s,y){const A=this.elements;return h.identity(),h.setRotationFromQuaternion(s),v.makeScale(y.x,y.y,y.z),this.multiplyMatrices(h,v),A[12]=l.x,A[13]=l.y,A[14]=l.z,this}}h=new f,v=new f;class b{constructor(l,s,y){this.x=l||0,this.y=s||0,this.z=y||0,this.atomid=void 0}set(l,s,y){return this.x=l,this.y=s,this.z=y,this}copy(l){return this.x=l.x,this.y=l.y,this.z=l.z,this}add(l){return this.x+=l.x,this.y+=l.y,this.z+=l.z,this}addVectors(l,s){return this.x=l.x+s.x,this.y=l.y+s.y,this.z=l.z+s.z,this}multiplyVectors(l,s){return this.x=l.x*s.x,this.y=l.y*s.y,this.z=l.z*s.z,this}sub(l){return this.x-=l.x,this.y-=l.y,this.z-=l.z,this}subVectors(l,s){return this.x=l.x-s.x,this.y=l.y-s.y,this.z=l.z-s.z,this}multiplyScalar(l){return this.x*=l,this.y*=l,this.z*=l,this}divideScalar(l){return l!==0?(this.x/=l,this.y/=l,this.z/=l):(this.x=0,this.y=0,this.z=0),this}max(l){return this.x=Math.max(this.x,l.x),this.y=Math.max(this.y,l.y),this.z=Math.max(this.z,l.z),this}min(l){return this.x=Math.min(this.x,l.x),this.y=Math.min(this.y,l.y),this.z=Math.min(this.z,l.z),this}distanceTo(l){return Math.sqrt(this.distanceToSquared(l))}distanceToSquared(l){const s=this.x-l.x,y=this.y-l.y,A=this.z-l.z;return s*s+y*y+A*A}applyMatrix3(l){const{x:s}=this,{y}=this,{z:A}=this,E=l.elements;return this.x=E[0]*s+E[3]*y+E[6]*A,this.y=E[1]*s+E[4]*y+E[7]*A,this.z=E[2]*s+E[5]*y+E[8]*A,this}applyMatrix4(l){const{x:s}=this,{y}=this,{z:A}=this,E=l.elements;return this.x=E[0]*s+E[4]*y+E[8]*A+E[12],this.y=E[1]*s+E[5]*y+E[9]*A+E[13],this.z=E[2]*s+E[6]*y+E[10]*A+E[14],this}applyProjection(l){const{x:s}=this,{y}=this,{z:A}=this,E=l.elements,T=E[3]*s+E[7]*y+E[11]*A+E[15];return this.x=(E[0]*s+E[4]*y+E[8]*A+E[12])/T,this.y=(E[1]*s+E[5]*y+E[9]*A+E[13])/T,this.z=(E[2]*s+E[6]*y+E[10]*A+E[14])/T,this}applyQuaternion(l){const{x:s}=this,{y}=this,{z:A}=this,E=l.x,T=l.y,u=l.z,_=l.w,M={};M.x=2*(y*u-A*T),M.y=2*(A*E-s*u),M.z=2*(s*T-y*E);const R={};return R.x=M.y*u-M.z*T,R.y=M.z*E-M.x*u,R.z=M.x*T-M.y*E,this.x=s+_*M.x+R.x,this.y=y+_*M.y+R.y,this.z=A+_*M.z+R.z,this}negate(){return this.multiplyScalar(-1)}dot(l){return this.x*l.x+this.y*l.y+this.z*l.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross(l){const{x:s}=this,{y}=this,{z:A}=this;return this.x=y*l.z-A*l.y,this.y=A*l.x-s*l.z,this.z=s*l.y-y*l.x,this}crossVectors(l,s){return this.x=l.y*s.z-l.z*s.y,this.y=l.z*s.x-l.x*s.z,this.z=l.x*s.y-l.y*s.x,this}equals(l){return this.x==l.x&&this.y==l.y&&this.z==l.z}getPositionFromMatrix(l){return this.x=l.elements[12],this.y=l.elements[13],this.z=l.elements[14],this}setEulerFromRotationMatrix(l,s){const y=l.elements,A=y[0],E=y[4],T=y[8],u=y[5],_=y[9],M=y[6],R=y[10];return s===void 0||s==="XYZ"?(this.y=Math.asin((0,c.clamp)(T,-1,1)),Math.abs(T)<.99999?(this.x=Math.atan2(-_,R),this.z=Math.atan2(-E,A)):(this.x=Math.atan2(M,u),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${s}`),this}rotateAboutVector(l,s){l.normalize();const y=Math.cos(s),A=Math.sin(s),E=this.clone().multiplyScalar(y),T=l.clone().cross(this).multiplyScalar(A),u=l.clone().multiplyScalar(l.clone().dot(this)).multiplyScalar(1-y),_=E.add(T).add(u);return this.x=_.x,this.y=_.y,this.z=_.z,this}setFromMatrixPosition(l){const s=l.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}transformDirection(l){const{x:s}=this,{y}=this,{z:A}=this,E=l.elements;return this.x=E[0]*s+E[4]*y+E[8]*A,this.y=E[1]*s+E[5]*y+E[9]*A,this.z=E[2]*s+E[6]*y+E[10]*A,this.normalize()}clone(){return new b(this.x,this.y,this.z)}unproject(l){const s=h;return s.multiplyMatrices(l.matrixWorld,s.getInverse(l.projectionMatrix)),this.applyMatrix4(s)}}p=new b,g=new b,x=new b;class C{constructor(l=1,s=0,y=0,A=0,E=1,T=0,u=0,_=0,M=1){this.elements=new Float32Array(9),this.set(l,s,y,A,E,T,u,_,M)}set(l,s,y,A,E,T,u,_,M){const R=this.elements;return R[0]=l,R[3]=s,R[6]=y,R[1]=A,R[4]=E,R[7]=T,R[2]=u,R[5]=_,R[8]=M,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(l){const s=l.elements;this.set(s[0],s[3],s[6],s[1],s[4],s[7],s[2],s[5],s[8])}multiplyScalar(l){const s=this.elements;return s[0]*=l,s[3]*=l,s[6]*=l,s[1]*=l,s[4]*=l,s[7]*=l,s[2]*=l,s[5]*=l,s[8]*=l,this}getInverse3(l){const s=l.elements,y=this.elements;y[0]=s[4]*s[8]-s[5]*s[7],y[3]=s[6]*s[5]-s[3]*s[8],y[6]=s[3]*s[7]-s[6]*s[4],y[1]=s[7]*s[2]-s[1]*s[8],y[4]=s[0]*s[8]-s[6]*s[2],y[7]=s[1]*s[6]-s[0]*s[7],y[2]=s[1]*s[5]-s[2]*s[4],y[5]=s[2]*s[3]-s[0]*s[5],y[8]=s[0]*s[4]-s[1]*s[3];const A=s[0]*y[0]+s[3]*y[1]+s[6]*y[2];return this.multiplyScalar(1/A),this}getInverse(l,s){const y=l.elements,A=this.elements;A[0]=y[10]*y[5]-y[6]*y[9],A[1]=-y[10]*y[1]+y[2]*y[9],A[2]=y[6]*y[1]-y[2]*y[5],A[3]=-y[10]*y[4]+y[6]*y[8],A[4]=y[10]*y[0]-y[2]*y[8],A[5]=-y[6]*y[0]+y[2]*y[4],A[6]=y[9]*y[4]-y[5]*y[8],A[7]=-y[9]*y[0]+y[1]*y[8],A[8]=y[5]*y[0]-y[1]*y[4];const E=y[0]*A[0]+y[1]*A[3]+y[2]*A[6];if(E===0){const T="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(s)throw new Error(T);return console.warn(T),this.identity(),this}return this.multiplyScalar(1/E),this}getDeterminant(){const l=this.elements;return l[0]*l[4]*l[8]+l[1]*l[5]*l[6]+l[2]*l[3]*l[7]-l[2]*l[4]*l[6]-l[1]*l[3]*l[8]-l[0]*l[5]*l[7]}transpose(){let l;const s=this.elements;return l=s[1],s[1]=s[3],s[3]=l,l=s[2],s[2]=s[6],s[6]=l,l=s[5],s[5]=s[7],s[7]=l,this}clone(){const l=this.elements;return new C(l[0],l[3],l[6],l[1],l[4],l[7],l[2],l[5],l[8])}getMatrix4(){const l=this.elements;return new f(l[0],l[3],l[6],0,l[1],l[4],l[7],0,l[2],l[5],l[8],0)}}class S{constructor(l,s){this.origin=l!==void 0?l:new b,this.direction=s!==void 0?s:new b}set(l,s){return this.origin.copy(l),this.direction.copy(s),this}copy(l){return this.origin.copy(l.origin),this.direction.copy(l.direction),this}at(l,s){return(s||new b).copy(this.direction).multiplyScalar(l).add(this.origin)}recast(l){const s=p;return this.origin.copy(this.at(l,s)),this}closestPointToPoint(l,s){const y=s||new b;y.subVectors(l,this.origin);const A=y.dot(this.direction);return y.copy(this.direction).multiplyScalar(A).add(this.origin)}distanceToPoint(l){const s=p,y=s.subVectors(l,this.origin).dot(this.direction);return s.copy(this.direction).multiplyScalar(y).add(this.origin),s.distanceTo(l)}isIntersectionCylinder(){}isIntersectionSphere(l){return this.distanceToPoint(l.center)<=l.radius}isIntersectionPlane(l){return l.normal.dot(this.direction)!==0||l.distanceToPoint(this.origin)===0}distanceToPlane(l){const s=l.normal.dot(this.direction);return s===0?l.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot(l.normal)+l.constant)/s}intersectPlane(l,s){const y=this.distanceToPlane(l);if(y!==void 0)return this.at(y,s)}applyMatrix4(l){return this.direction.add(this.origin).applyMatrix4(l),this.origin.applyMatrix4(l),this.direction.sub(this.origin),this}clone(){return new S().copy(this)}}}),"./src/WebGL/math/utils/clamp.ts":((r,e,t)=>{t.r(e),t.d(e,{clamp:()=>o});function o(c,h,v){return Math.min(Math.max(c,h),v)}}),"./src/WebGL/math/utils/conversionMatrix3.ts":((r,e,t)=>{t.r(e),t.d(e,{conversionMatrix3:()=>c});var o=t("./src/WebGL/math/math.ts");function c(h,v,p,g,x,f){g=g*Math.PI/180,x=x*Math.PI/180,f=f*Math.PI/180;const b=s=>s*s,C=Math.cos(g),S=Math.cos(x),k=Math.cos(f),l=Math.sin(f);return new o.Matrix3(h,v*k,p*S,0,v*l,p*(C-S*k)/l,0,0,p*Math.sqrt(1-b(C)-b(S)-b(k)+2*C*S*k)/l)}}),"./src/WebGL/math/utils/degToRad.ts":((r,e,t)=>{t.r(e),t.d(e,{degToRad:()=>c});const o=Math.PI/180;function c(h){return h*o}}),"./src/WebGL/objects/Line.ts":((r,e,t)=>{t.r(e),t.d(e,{Line:()=>v,LineStyle:()=>h});var o=t("./src/WebGL/materials/index.ts"),c=t("./src/WebGL/core/index.ts"),h;(function(p){p[p.LineStrip=0]="LineStrip",p[p.LinePieces=1]="LinePieces"})(h||(h={}));class v extends c.Object3D{constructor(g,x=new o.LineBasicMaterial({color:Math.random()*16777215}),f=h.LineStrip){super(),this.geometry=g,this.material=x,this.type=f}clone(g=new v(this.geometry,this.material,this.type)){return super.clone.call(this,g),g}}}),"./src/WebGL/objects/Mesh.ts":((r,e,t)=>{t.r(e),t.d(e,{Mesh:()=>c});var o=t("./src/WebGL/core/index.ts");class c extends o.Object3D{constructor(v,p){super(),this.geometry=v,this.material=p}clone(v){return v===void 0&&(v=new c(this.geometry,this.material)),super.clone.call(this,v),v}}}),"./src/WebGL/objects/Sprite.ts":((r,e,t)=>{t.r(e),t.d(e,{Sprite:()=>h});var o=t("./src/WebGL/materials/index.ts"),c=t("./src/WebGL/core/index.ts");class h extends c.Object3D{constructor(p=new o.SpriteMaterial){super(),this.material=p,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),(this.scale.x!==1||this.scale.y!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(p=new h(this.material)){return c.Object3D.prototype.clone.call(this,p),p}}}),"./src/WebGL/objects/index.ts":((r,e,t)=>{t.r(e),t.d(e,{Line:()=>o.Line,LineStyle:()=>o.LineStyle,Mesh:()=>c.Mesh,Sprite:()=>h.Sprite});var o=t("./src/WebGL/objects/Line.ts"),c=t("./src/WebGL/objects/Mesh.ts"),h=t("./src/WebGL/objects/Sprite.ts")}),"./src/WebGL/shaders/ShaderType.ts":((r,e,t)=>{t.r(e)}),"./src/WebGL/shaders/index.ts":((r,e,t)=>{t.r(e),t.d(e,{ShaderLib:()=>o.ShaderLib,ShaderUtils:()=>c.ShaderUtils,basic:()=>o.basic,clone:()=>c.clone,instanced:()=>o.instanced,lambert:()=>o.lambert,lambertdouble:()=>o.lambertdouble,outline:()=>o.outline,screen:()=>o.screen,screenaa:()=>o.screenaa,sphereimposter:()=>o.sphereimposter,sphereimposteroutline:()=>o.sphereimposteroutline,sprite:()=>o.sprite,stickimposter:()=>o.stickimposter,stickimposteroutline:()=>o.stickimposteroutline,volumetric:()=>o.volumetric});var o=t("./src/WebGL/shaders/lib/index.ts"),c=t("./src/WebGL/shaders/utils/index.ts");t("./src/WebGL/shaders/ShaderType.ts")}),"./src/WebGL/shaders/lib/basic/index.ts":((r,e,t)=>{t.r(e),t.d(e,{basic:()=>v});var o=t("./src/WebGL/shaders/lib/basic/uniforms.ts"),c=t("./src/WebGL/shaders/lib/basic/basic.frag"),h=t("./src/WebGL/shaders/lib/basic/basic.vert");const v={vertexShader:h.default.replace("#define GLSLIFY 1",""),fragmentShader:c.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/basic/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}}}),"./src/WebGL/shaders/lib/blur/index.ts":((r,e,t)=>{t.r(e),t.d(e,{blur:()=>v});var o=t("./src/WebGL/shaders/lib/blur/uniforms.ts"),c=t("./src/WebGL/shaders/lib/blur/blur.frag"),h=t("./src/WebGL/shaders/lib/blur/blur.vert");const v={fragmentShader:c.default,vertexShader:h.default,uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/blur/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>o});const o={}}),"./src/WebGL/shaders/lib/index.ts":((r,e,t)=>{t.r(e),t.d(e,{ShaderLib:()=>A,basic:()=>o.basic,instanced:()=>c.instanced,lambert:()=>h.lambert,lambertdouble:()=>v.lambertdouble,outline:()=>p.outline,screen:()=>g.screen,screenaa:()=>x.screenaa,sphereimposter:()=>f.sphereimposter,sphereimposteroutline:()=>b.sphereimposteroutline,sprite:()=>C.sprite,stickimposter:()=>S.stickimposter,stickimposteroutline:()=>k.stickimposteroutline,volumetric:()=>l.volumetric});var o=t("./src/WebGL/shaders/lib/basic/index.ts"),c=t("./src/WebGL/shaders/lib/instanced/index.ts"),h=t("./src/WebGL/shaders/lib/lambert/index.ts"),v=t("./src/WebGL/shaders/lib/lambertdouble/index.ts"),p=t("./src/WebGL/shaders/lib/outline/index.ts"),g=t("./src/WebGL/shaders/lib/screen/index.ts"),x=t("./src/WebGL/shaders/lib/screenaa/index.ts"),f=t("./src/WebGL/shaders/lib/sphereimposter/index.ts"),b=t("./src/WebGL/shaders/lib/sphereimposteroutline/index.ts"),C=t("./src/WebGL/shaders/lib/sprite/index.ts"),S=t("./src/WebGL/shaders/lib/stickimposter/index.ts"),k=t("./src/WebGL/shaders/lib/stickimposteroutline/index.ts"),l=t("./src/WebGL/shaders/lib/volumetric/index.ts"),s=t("./src/WebGL/shaders/lib/ssao/index.ts"),y=t("./src/WebGL/shaders/lib/blur/index.ts");const A={basic:o.basic,blur:y.blur,instanced:c.instanced,lambert:h.lambert,lambertdouble:v.lambertdouble,outline:p.outline,screen:g.screen,screenaa:x.screenaa,ssao:s.ssao,sphereimposter:f.sphereimposter,sphereimposteroutline:b.sphereimposteroutline,sprite:C.sprite,stickimposter:S.stickimposter,stickimposteroutline:k.stickimposteroutline,volumetric:l.volumetric}}),"./src/WebGL/shaders/lib/instanced/index.ts":((r,e,t)=>{t.r(e),t.d(e,{instanced:()=>v});var o=t("./src/WebGL/shaders/lib/instanced/uniforms.ts"),c=t("./src/WebGL/shaders/lib/instanced/instanced.frag"),h=t("./src/WebGL/shaders/lib/instanced/instanced.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/instanced/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/lambert/index.ts":((r,e,t)=>{t.r(e),t.d(e,{lambert:()=>v});var o=t("./src/WebGL/shaders/lib/lambert/uniforms.ts"),c=t("./src/WebGL/shaders/lib/lambert/lambert.frag"),h=t("./src/WebGL/shaders/lib/lambert/lambert.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/lambert/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/lambertdouble/index.ts":((r,e,t)=>{t.r(e),t.d(e,{lambertdouble:()=>v});var o=t("./src/WebGL/shaders/lib/lambertdouble/uniforms.ts"),c=t("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag"),h=t("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/lambertdouble/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/outline/index.ts":((r,e,t)=>{t.r(e),t.d(e,{outline:()=>v});var o=t("./src/WebGL/shaders/lib/outline/uniforms.ts"),c=t("./src/WebGL/shaders/lib/outline/outline.frag"),h=t("./src/WebGL/shaders/lib/outline/outline.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/outline/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new o.Color(0,0,0)},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/screen/index.ts":((r,e,t)=>{t.r(e),t.d(e,{screen:()=>v});var o=t("./src/WebGL/shaders/lib/screen/uniforms.ts"),c=t("./src/WebGL/shaders/lib/screen/screen.frag"),h=t("./src/WebGL/shaders/lib/screen/screen.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/screen/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>o});const o={}}),"./src/WebGL/shaders/lib/screenaa/index.ts":((r,e,t)=>{t.r(e),t.d(e,{screenaa:()=>v});var o=t("./src/WebGL/shaders/lib/screenaa/uniforms.ts"),c=t("./src/WebGL/shaders/lib/screenaa/screenaa.frag"),h=t("./src/WebGL/shaders/lib/screenaa/screenaa.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/screenaa/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>o});const o={}}),"./src/WebGL/shaders/lib/sphereimposter/index.ts":((r,e,t)=>{t.r(e),t.d(e,{sphereimposter:()=>v});var o=t("./src/WebGL/shaders/lib/sphereimposter/uniforms.ts"),c=t("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag"),h=t("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert");const v={vertexShader:h.default.replace("#define GLSLIFY 1",""),fragmentShader:c.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/sphereimposter/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/sphereimposteroutline/index.ts":((r,e,t)=>{t.r(e),t.d(e,{sphereimposteroutline:()=>v});var o=t("./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts"),c=t("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag"),h=t("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new o.Color(0,0,0)},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/sprite/index.ts":((r,e,t)=>{t.r(e),t.d(e,{sprite:()=>v});var o=t("./src/WebGL/shaders/lib/sprite/uniforms.ts"),c=t("./src/WebGL/shaders/lib/sprite/sprite.frag"),h=t("./src/WebGL/shaders/lib/sprite/sprite.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/sprite/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>o});const o={}}),"./src/WebGL/shaders/lib/ssao/index.ts":((r,e,t)=>{t.r(e),t.d(e,{ssao:()=>v});var o=t("./src/WebGL/shaders/lib/ssao/uniforms.ts"),c=t("./src/WebGL/shaders/lib/ssao/ssao.frag"),h=t("./src/WebGL/shaders/lib/ssao/ssao.vert");const v={fragmentShader:c.default,vertexShader:h.default,uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/ssao/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>o});const o={total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}}),"./src/WebGL/shaders/lib/stickimposter/index.ts":((r,e,t)=>{t.r(e),t.d(e,{stickimposter:()=>p});var o=t("./src/WebGL/shaders/lib/stickimposter/uniforms.ts"),c=t("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),h=t("./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag"),v=t("./src/WebGL/shaders/lib/stickimposter/stickimposter.vert");const p={fragmentShader:[c.default,h.default].join(`
`),vertexShader:v.default,uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/stickimposter/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/stickimposteroutline/index.ts":((r,e,t)=>{t.r(e),t.d(e,{stickimposteroutline:()=>v});var o=t("./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts"),c=t("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),h=t("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert");const v={fragmentShader:c.default+"gl_FragColor = vec4(color,1.0);}",vertexShader:h.default,uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new o.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/volumetric/index.ts":((r,e,t)=>{t.r(e),t.d(e,{volumetric:()=>v});var o=t("./src/WebGL/shaders/lib/volumetric/uniforms.ts"),c=t("./src/WebGL/shaders/lib/volumetric/volumetric.frag"),h=t("./src/WebGL/shaders/lib/volumetric/volumetric.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/volumetric/uniforms.ts":((r,e,t)=>{t.r(e),t.d(e,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}}}),"./src/WebGL/shaders/utils/clone.ts":((r,e,t)=>{t.r(e),t.d(e,{clone:()=>c});var o=t("./src/colors.ts");function c(h){let v={};for(const g in h){v[g]={},v[g].type=h[g].type;var p=h[g].value;p instanceof o.Color?v[g].value=p.clone():typeof p=="number"?v[g].value=p:p instanceof Array?v[g].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return v}}),"./src/WebGL/shaders/utils/index.ts":((r,e,t)=>{t.r(e),t.d(e,{ShaderUtils:()=>c,clone:()=>o.clone});var o=t("./src/WebGL/shaders/utils/clone.ts");const c={clone:o.clone}}),"./src/WebGL/shapes/Cylinder.ts":((r,e,t)=>{t.r(e),t.d(e,{Cylinder:()=>h});var o=t("./src/WebGL/math/index.ts");let c=new o.Vector3;class h{constructor(p=new o.Vector3,g=new o.Vector3,x=0){this.c1=p,this.c2=g,this.radius=x,this.direction=new o.Vector3().subVectors(this.c2,this.c1).normalize()}copy(p){return this.c1.copy(p.c1),this.c2.copy(p.c2),this.direction.copy(p.direction),this.radius=p.radius,this}lengthSq(){return c.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(p){return this.direction.add(this.c1).applyMatrix4(p),this.c1.applyMatrix4(p),this.c2.applyMatrix4(p),this.direction.sub(this.c1).normalize(),this.radius=this.radius*p.getMaxScaleOnAxis(),this}}}),"./src/WebGL/shapes/Sphere.ts":((r,e,t)=>{t.r(e),t.d(e,{Sphere:()=>c});var o=t("./src/WebGL/math/index.ts");class c{constructor(v={x:0,y:0,z:0},p=0){this.center=new o.Vector3(v.x,v.y,v.z),this.radius=p}set(v,p){return this.center.copy(v),this.radius=p,this}copy(v){return this.center.copy(v.center),this.radius=v.radius,this}applyMatrix4(v){return this.center.applyMatrix4(v),this.radius=this.radius*v.getMaxScaleOnAxis(),this}translate(v){return this.center.add(v),this}equals(v){return v.center.equals(this.center)&&v.radius===this.radius}clone(){return new c().copy(this)}}}),"./src/WebGL/shapes/Triangle.ts":((r,e,t)=>{t.r(e),t.d(e,{Triangle:()=>h});var o=t("./src/WebGL/math/index.ts");const c=new o.Vector3;class h{constructor(p=new o.Vector3,g=new o.Vector3,x=new o.Vector3){this.a=p,this.b=g,this.c=x}copy(p){return this.a.copy(p.a),this.b.copy(p.b),this.c.copy(p.c),this}applyMatrix4(p){return this.a.applyMatrix4(p),this.b.applyMatrix4(p),this.c.applyMatrix4(p),this}getNormal(){var p=this.a.clone();return p.sub(this.b),c.subVectors(this.c,this.b),p.cross(c),p.normalize(),p}}}),"./src/WebGL/shapes/index.ts":((r,e,t)=>{t.r(e),t.d(e,{Cylinder:()=>c.Cylinder,Sphere:()=>o.Sphere,Triangle:()=>h.Triangle});var o=t("./src/WebGL/shapes/Sphere.ts"),c=t("./src/WebGL/shapes/Cylinder.ts"),h=t("./src/WebGL/shapes/Triangle.ts")}),"./src/autoload.ts":((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{autoinit:()=>autoinit,autoload:()=>autoload,processing_autoinit:()=>processing_autoinit,viewers:()=>viewers});var _GLViewer__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/GLViewer.ts"),_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/ProteinSurface4.ts"),_utilities__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utilities.ts"),_colors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/colors.ts"),autoinit=!1,processing_autoinit=!1,viewers={};function autoload(viewer,callback){var i,dataname,type;if(document.querySelector(".viewer_3Dmoljs")!=null&&(autoinit=!0),autoinit){processing_autoinit=!0,viewer=viewer??null;var nviewers=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(viewerdiv=>{var datauri=[],datatypes=[],uri="";viewerdiv.style.position=="static"&&(viewerdiv.style.position="relative");var UI=null;if(type=null,viewerdiv.dataset.pdb)datauri.push("https://files.rcsb.org/view/"+viewerdiv.dataset.pdb+".pdb"),datatypes.push("pdb");else if(viewerdiv.dataset.cid)datatypes.push("sdf"),datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+viewerdiv.dataset.cid+"/SDF?record_type=3d");else if(viewerdiv.dataset.href||viewerdiv.dataset.url){if(viewerdiv.dataset.href?uri=viewerdiv.dataset.href:uri=viewerdiv.dataset.url,datauri.push(uri),type=uri.substring(uri.lastIndexOf(".")+1),type=="gz"){let r=uri.substring(0,uri.lastIndexOf(".")).lastIndexOf(".");type=uri.substring(r+1)}datatypes.push(type);var molName=uri.substring(uri.lastIndexOf("/")+1,uri.lastIndexOf("."));molName=="/"&&(molName=uri.substring(uri.lastIndexOf("/")+1)),viewerdiv.dataset[datatypes[datatypes.length-1]]=molName}let divdata=viewerdiv.dataset;for(i in divdata)i.substring(0,3)==="pdb"&&i!=="pdb"?(datauri.push("https://files.rcsb.org/view/"+divdata[i]+".pdb"),datatypes.push("pdb")):i.substring(0,4)==="href"&&i!=="href"?(uri=divdata[i],datauri.push(uri),datatypes.push(uri.substring(uri.lastIndexOf(".")+1))):i.substring(0,3)==="cid"&&i!=="cid"&&(datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+divdata[i]+"/SDF?record_type=3d"),datatypes.push("sdf"));var options={};viewerdiv.dataset.options&&(options=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.options));var bgcolor=_colors__WEBPACK_IMPORTED_MODULE_3__.CC.color(viewerdiv.dataset.backgroundcolor),bgalpha=viewerdiv.dataset.backgroundalpha;bgalpha=bgalpha==null?1:parseFloat(bgalpha);var style={line:{}};viewerdiv.dataset.style&&(style=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.style));var select={};viewerdiv.dataset.select&&(select=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.select));var selectstylelist=[],surfaces=[],labels=[],zoomto={},spin=null,d=viewerdiv.dataset,stylere=/style(.+)/,surfre=/surface(.*)/,reslabre=/labelres(.*)/,keys=[];for(dataname in d)Object.prototype.hasOwnProperty.call(d,dataname)&&keys.push(dataname);for(keys.sort(),i=0;i<keys.length;i++){dataname=keys[i];var m=stylere.exec(dataname),selname,newsel,styleobj;m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),selectstylelist.push([newsel,styleobj])),m=surfre.exec(dataname),m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),surfaces.push([newsel,styleobj])),m=reslabre.exec(dataname),m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),labels.push([newsel,styleobj])),dataname=="zoomto"&&(zoomto=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname])),dataname=="spin"&&(spin=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]))}var applyStyles=function(r){for(r.setStyle(select,style),UI&&UI.createSelectionAndStyle(select,style),i=0;i<selectstylelist.length;i++){let e=selectstylelist[i][0]||{},t=selectstylelist[i][1]||{line:{}};r.setStyle(e,t),UI&&UI.createSelectionAndStyle(select,style)}for(i=0;i<surfaces.length;i++){let e=surfaces[i][0]||{},t=surfaces[i][1]||{};UI?r.addSurface(_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__.SurfaceType.VDW,t,e,e).then(o=>{UI.loadSurface("VDW",e,t,o)}):r.addSurface(_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__.SurfaceType.VDW,t,e,e)}for(i=0;i<labels.length;i++){let e=labels[i][0]||{},t=labels[i][1]||{};r.addResLabels(e,t)}r.render(),r.zoomTo(zoomto),spin&&r.spin(spin.axis,spin.speed)};let glviewer=viewer;try{var config=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.config)||{};config.backgroundColor===void 0&&(config.backgroundColor=bgcolor),config.backgroundAlpha===void 0&&(config.backgroundAlpha=bgalpha),glviewer==null?glviewer=viewers[viewerdiv.id||nviewers++]=(0,_GLViewer__WEBPACK_IMPORTED_MODULE_0__.createViewer)(viewerdiv,config):(glviewer.setBackgroundColor(bgcolor,bgalpha),glviewer.setConfig(config),UI&&UI.initiateUI()),viewerdiv.dataset.ui&&$3Dmol.StateManager&&(UI=new $3Dmol.StateManager(glviewer))}catch(r){console.log(r),viewerdiv.textContent="WebGL appears to be disabled."}if(datauri.length!=0){let i=0,process=((viewerdiv,glviewer)=>function(moldata){uri=datauri[i];var type=viewerdiv.dataset.type||viewerdiv.dataset.datatype||datatypes[i];if(glviewer.addModel(moldata,type,options),UI){var modelName=viewerdiv.dataset[datatypes[i]];UI.setModelTitle(modelName)}if(i+=1,i<datauri.length)(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.get)(datauri[i]).then(process);else{if(applyStyles(glviewer),viewerdiv.dataset.callback){var runres=eval(viewerdiv.dataset.callback);typeof runres=="function"&&runres(glviewer)}processing_autoinit=!1,callback&&callback(glviewer)}})(viewerdiv,glviewer);type&&type.endsWith("gz")?(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.getbin)(datauri[0]).then(process):(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.get)(datauri[0]).then(process)}else{if(viewerdiv.dataset.element){var moldataid="#"+viewerdiv.dataset.element,molelem=document.querySelector(moldataid),moldata=molelem?molelem.textContent:"";type=viewerdiv.dataset.type||viewerdiv.dataset.datatype,glviewer.addModel(moldata,type,options)}if(applyStyles(glviewer),viewerdiv.dataset.callback){var runres=eval(viewerdiv.dataset.callback);typeof runres=="function"&&runres(glviewer)}processing_autoinit=!1,callback&&callback(glviewer)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&autoload()}}),"./src/colors.ts":((r,e,t)=>{t.r(e),t.d(e,{CC:()=>c,Color:()=>o,builtinColorSchemes:()=>b,chains:()=>f,elementColors:()=>g,htmlColors:()=>h,residues:()=>x,ssColors:()=>v});class o{constructor(S,k,l){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof S=="number"?(this.r=S||0,this.g=k||0,this.b=l||0,this):this.set(S||0)}set(S){return S instanceof o?S.clone():(typeof S=="number"?this.setHex(S):typeof S=="object"&&(this.r=S?.r||0,this.g=S?.g||0,this.b=S?.b||0),this)}setHex(S){return S=Math.floor(S),this.r=(S>>16&255)/255,this.g=(S>>8&255)/255,this.b=(S&255)/255,this}getHex(){var S=Math.round(this.r*255),k=Math.round(this.g*255),l=Math.round(this.b*255);return S<<16|k<<8|l}clone(){return new o(this.r,this.g,this.b)}copy(S){return this.r=S.r,this.g=S.g,this.b=S.b,this}scaled(){var S={};return S.r=Math.round(this.r*255),S.g=Math.round(this.g*255),S.b=Math.round(this.b*255),S.a=1,S}}class c{static color(S){if(!S)return c.cache[0];if(S instanceof o)return S;if(typeof S=="number"&&typeof c.cache[S]<"u")return c.cache[S];if(S&&Array.isArray(S))return S.map(c.color);let k=c.getHex(S),l=new o(k);return c.cache[k]=l,l}static getHex(S){var k;if(Array.isArray(S))return S.map(c.getHex);if(typeof S=="string"){let l=S;if(!isNaN(parseInt(l)))return parseInt(l);if(l=l.trim(),l.length==4&&l[0]=="#"&&(l="#"+l[1]+l[1]+l[2]+l[2]+l[3]+l[3]),l.length==7&&l[0]=="#")return parseInt(l.substring(1),16);let s=c.rgbRegEx.exec(l);if(s){s[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let y=0;for(let A=2;A<5;A++){y*=256;let E=s[A].endsWith("%")?255*parseFloat(s[A])/100:parseFloat(s[A]);y+=Math.round(E)}return y}return((k=window?.$3Dmol)===null||k===void 0?void 0:k.htmlColors[S.toLowerCase()])||0}return S}}c.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,c.cache={0:new o(0)};const h={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},v={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},p={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},g={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:p,defaultColors:Object.assign({},p),greenCarbon:Object.assign(Object.assign({},p),{C:65280}),cyanCarbon:Object.assign(Object.assign({},p),{C:65535}),magentaCarbon:Object.assign(Object.assign({},p),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},p),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},p),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},p),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},p),{C:8388736}),blueCarbon:Object.assign(Object.assign({},p),{C:255})},x={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},f={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},b={ssPyMol:{prop:"ss",map:v.pyMol},ssJmol:{prop:"ss",map:v.Jmol},Jmol:{prop:"elem",map:g.Jmol},amino:{prop:"resn",map:x.amino},shapely:{prop:"resn",map:x.shapely},nucleic:{prop:"resn",map:x.nucleic},chain:{prop:"chain",map:f.atom},rasmol:{prop:"elem",map:g.rasmol},default:{prop:"elem",map:g.defaultColors},greenCarbon:{prop:"elem",map:g.greenCarbon},chainHetatm:{prop:"chain",map:f.hetatm},cyanCarbon:{prop:"elem",map:g.cyanCarbon},magentaCarbon:{prop:"elem",map:g.magentaCarbon},purpleCarbon:{prop:"elem",map:g.purpleCarbon},whiteCarbon:{prop:"elem",map:g.whiteCarbon},orangeCarbon:{prop:"elem",map:g.orangeCarbon},yellowCarbon:{prop:"elem",map:g.yellowCarbon},blueCarbon:{prop:"elem",map:g.blueCarbon}}}),"./src/glcartoon.ts":((r,e,t)=>{t.r(e),t.d(e,{drawCartoon:()=>Y,subdivide_spline:()=>f});var o=t("./src/WebGL/math/index.ts"),c=t("./src/WebGL/shapes/index.ts"),h=t("./src/WebGL/index.ts"),v=t("./src/Gradient.ts"),p=t("./src/colors.ts"),g=t("./src/GLDraw.ts"),x=t("./src/utilities.ts");function f(B,D){var H=[],W=B;W=[],W.push(B[0]);var q,V,$,O,j,J,oe,ie,he;for(q=1,V=B.length-1;q<V;q++)if(j=B[q],J=B[q+1],j.smoothen){var de=new o.Vector3((j.x+J.x)/2,(j.y+J.y)/2,(j.z+J.z)/2);de.atom=j.atom,W.push(de)}else W.push(j);for(W.push(B[B.length-1]),q=-1,$=W.length;q<=$-3;q++)if(O=W[q===-1?0:q],j=W[q+1],J=W[q+2],oe=W[q===$-3?$-1:q+3],ie=new o.Vector3().subVectors(J,O).multiplyScalar(.5),he=new o.Vector3().subVectors(oe,j).multiplyScalar(.5),!J.skip)for(var fe=0;fe<D;fe++){var ue=1/D*fe,ye=j.x+ue*ie.x+ue*ue*(-3*j.x+3*J.x-2*ie.x-he.x)+ue*ue*ue*(2*j.x-2*J.x+ie.x+he.x),ze=j.y+ue*ie.y+ue*ue*(-3*j.y+3*J.y-2*ie.y-he.y)+ue*ue*ue*(2*j.y-2*J.y+ie.y+he.y),$e=j.z+ue*ie.z+ue*ue*(-3*j.z+3*J.z-2*ie.z-he.z)+ue*ue*ue*(2*j.z-2*J.z+ie.z+he.z),We=new o.Vector3(ye,ze,$e);fe<D/2?We.atom=j.atom:We.atom=J.atom,H.push(We)}return H.push(W[W.length-1]),H}const b=.5,C=1.3,S=.8,k=.4,l=.4;function s(B,D,H,W){for(var q,V,$,O,j=0,J=D.length;j<J;j++){O=Math.round(j*(W.length-1)/J),$=p.CC.color(W[O]);var oe=B.updateGeoGroup(2),ie=oe.vertexArray,he=oe.colorArray,de=oe.faceArray;q=oe.vertices,V=q*3,ie[V]=D[j].x,ie[V+1]=D[j].y,ie[V+2]=D[j].z,ie[V+3]=H[j].x,ie[V+4]=H[j].y,ie[V+5]=H[j].z;for(var fe=0;fe<6;++fe)he[V+3*fe]=$.r,he[V+1+3*fe]=$.g,he[V+2+3*fe]=$.b;if(j>0){var ue=[q,q+1,q-1,q-2],ye=oe.faceidx;de[ye]=ue[0],de[ye+1]=ue[1],de[ye+2]=ue[3],de[ye+3]=ue[1],de[ye+4]=ue[2],de[ye+5]=ue[3],oe.faceidx+=6}oe.vertices+=2}}function y(B,D,H,W,q,V,$){var O,j,J,oe;if(J=D.length,J<2||D[0].length<2)return;for(O=0;O<J;O++)D[O]=f(D[O],W);if(oe=D[0].length,!q)return s(B,D[0],D[J-1],H);var ie,he,de,fe,ue,ye,ze=[],$e=[],We=[];for(j=0;j<J;j++)ze.push(.25+1.5*Math.sqrt((J-1)*j-Math.pow(j,2))/(J-1)),$e.push(.5),We.push(2*(Math.pow(j/J,2)-j/J)+.6);var Fe=[];for(j=0;j<J*2-1;j++)Fe[j]=[j,j+1,j+1-2*J,j-2*J];Fe[J*2-1]=[j,j+1-2*J,j+1-4*J,j-2*J];var me,ke,Qe,Je,Ye,nt,rt,et,Ke,Ue;let He=B.updateGeoGroup();for(O=0;O<oe;O++){let se=B.groups,le=!1;He=B.updateGeoGroup(2*J),se!=B.groups&&O>0&&(O=O-1,le=!0),nt=Math.round(O*(H.length-1)/oe),Ye=p.CC.color(H[nt]),ue=de,ye=fe,de=[],fe=[],ie=[],D[0][O].atom!==void 0&&(Je=D[0][O].atom,$==="oval"?he=ze:$==="rectangle"?he=$e:$==="parabola"&&(he=We)),he||(he=$e);var mt,ht;for(j=0;j<J;j++)O<oe-1?mt=D[j][O+1].clone().sub(D[j][O]):mt=D[j][O-1].clone().sub(D[j][O]).negate(),j<J-1?ht=D[j+1][O].clone().sub(D[j][O]):ht=D[j-1][O].clone().sub(D[j][O]).negate(),ie[j]=ht.cross(mt).normalize().multiplyScalar(q*he[j]);for(j=0;j<J;j++)de[j]=D[j][O].clone().add(ie[j].clone().negate());for(j=0;j<J;j++)fe[j]=D[j][O].clone().add(ie[j]);for(rt=He.vertexArray,et=He.colorArray,Ke=He.faceArray,me=He.vertices,ke=me*3,j=0;j<J;j++)rt[ke+3*j+0]=de[j].x,rt[ke+3*j+1]=de[j].y,rt[ke+3*j+2]=de[j].z;for(j=0;j<J;j++)rt[ke+3*j+0+3*J]=fe[J-1-j].x,rt[ke+3*j+1+3*J]=fe[J-1-j].y,rt[ke+3*j+2+3*J]=fe[J-1-j].z;for(j=0;j<2*J;++j)et[ke+3*j+0]=Ye.r,et[ke+3*j+1]=Ye.g,et[ke+3*j+2]=Ye.b;if(O>0&&!le){for(j=0;j<J*2;j++)Ue=[me+Fe[j][0],me+Fe[j][1],me+Fe[j][2],me+Fe[j][3]],Qe=He.faceidx,Ke[Qe]=Ue[0],Ke[Qe+1]=Ue[1],Ke[Qe+2]=Ue[3],Ke[Qe+3]=Ue[1],Ke[Qe+4]=Ue[2],Ke[Qe+5]=Ue[3],He.faceidx+=6;if(Je.clickable||Je.hoverable){var te=[];te.push(new c.Triangle(ue[0],de[0],de[J-1])),te.push(new c.Triangle(ue[0],de[J-1],ue[J-1])),te.push(new c.Triangle(ue[J-1],de[J-1],fe[J-1])),te.push(new c.Triangle(ue[J-1],fe[J-1],ye[J-1])),te.push(new c.Triangle(fe[0],ye[0],ye[J-1])),te.push(new c.Triangle(fe[J-1],fe[0],ye[J-1])),te.push(new c.Triangle(de[0],ue[0],ye[0])),te.push(new c.Triangle(fe[0],de[0],ye[0]));for(j in te)Je.intersectionShape.triangle.push(te[j])}}He.vertices+=2*J}for(rt=He.vertexArray,et=He.colorArray,Ke=He.faceArray,me=He.vertices,ke=me*3,Qe=He.faceidx,O=0;O<J-1;O++)Ue=[O,O+1,2*J-2-O,2*J-1-O],Qe=He.faceidx,Ke[Qe]=Ue[0],Ke[Qe+1]=Ue[1],Ke[Qe+2]=Ue[3],Ke[Qe+3]=Ue[1],Ke[Qe+4]=Ue[2],Ke[Qe+5]=Ue[3],He.faceidx+=6;for(O=0;O<J-1;O++)Ue=[me-1-O,me-2-O,me-2*J+O+1,me-2*J+O],Qe=He.faceidx,Ke[Qe]=Ue[0],Ke[Qe+1]=Ue[1],Ke[Qe+2]=Ue[3],Ke[Qe+3]=Ue[1],Ke[Qe+4]=Ue[2],Ke[Qe+5]=Ue[3],He.faceidx+=6}function A(B,D,H,W,q,V){if(!(D.length<2)){var $,O;if($=D[0],O=D[D.length-1],$=f($,W),O=f(O,W),!q)return s(B,$,O,H);var j=[],J,oe,ie,he,de,fe=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],ue,ye,ze,$e,We,Fe,me,ke,Qe,Je,Ye,nt,rt,et,Ke,Ue,He;for(ke=0,Qe=$.length;ke<Qe;ke++){if(We=Math.round(ke*(H.length-1)/Qe),$e=p.CC.color(H[We]),j.push(oe=$[ke]),j.push(oe),j.push(ie=O[ke]),j.push(ie),ke<Qe-1){var mt=$[ke+1].clone().sub($[ke]),ht=O[ke].clone().sub($[ke]);J=ht.cross(mt).normalize().multiplyScalar(q)}for(j.push(he=$[ke].clone().add(J)),j.push(he),j.push(de=O[ke].clone().add(J)),j.push(de),oe.atom!==void 0&&(Fe=oe.atom),et=B.updateGeoGroup(8),Ke=et.vertexArray,Ue=et.colorArray,He=et.faceArray,ue=et.vertices,ye=ue*3,Ke[ye]=oe.x,Ke[ye+1]=oe.y,Ke[ye+2]=oe.z,Ke[ye+3]=oe.x,Ke[ye+4]=oe.y,Ke[ye+5]=oe.z,Ke[ye+6]=ie.x,Ke[ye+7]=ie.y,Ke[ye+8]=ie.z,Ke[ye+9]=ie.x,Ke[ye+10]=ie.y,Ke[ye+11]=ie.z,Ke[ye+12]=he.x,Ke[ye+13]=he.y,Ke[ye+14]=he.z,Ke[ye+15]=he.x,Ke[ye+16]=he.y,Ke[ye+17]=he.z,Ke[ye+18]=de.x,Ke[ye+19]=de.y,Ke[ye+20]=de.z,Ke[ye+21]=de.x,Ke[ye+22]=de.y,Ke[ye+23]=de.z,Je=0;Je<8;++Je)Ue[ye+3*Je]=$e.r,Ue[ye+1+3*Je]=$e.g,Ue[ye+2+3*Je]=$e.b;if(ke>0){var te=me!==void 0&&Fe!==void 0&&me.serial!==Fe.serial;for(Je=0;Je<4;Je++){var se=[ue+fe[Je][0],ue+fe[Je][1],ue+fe[Je][2],ue+fe[Je][3]];if(ze=et.faceidx,He[ze]=se[0],He[ze+1]=se[1],He[ze+2]=se[3],He[ze+3]=se[1],He[ze+4]=se[2],He[ze+5]=se[3],et.faceidx+=6,Fe.clickable||me.clickable||Fe.hoverable||me.hoverable){var le=j[se[3]].clone(),Se=j[se[0]].clone(),we=j[se[2]].clone(),Xe=j[se[1]].clone();if(le.atom=j[se[3]].atom||null,we.atom=j[se[2]].atom||null,Se.atom=j[se[0]].atom||null,Xe.atom=j[se[1]].atom||null,te){var je=le.clone().add(Se).multiplyScalar(.5),K=we.clone().add(Xe).multiplyScalar(.5),xe=le.clone().add(Xe).multiplyScalar(.5);Je%2===0?((me.clickable||me.hoverable)&&(Ye=new c.Triangle(je,xe,le),nt=new c.Triangle(K,we,xe),rt=new c.Triangle(xe,we,le),me.intersectionShape.triangle.push(Ye),me.intersectionShape.triangle.push(nt),me.intersectionShape.triangle.push(rt)),(Fe.clickable||Fe.hoverable)&&(Ye=new c.Triangle(Se,Xe,xe),nt=new c.Triangle(Xe,K,xe),rt=new c.Triangle(Se,xe,je),Fe.intersectionShape.triangle.push(Ye),Fe.intersectionShape.triangle.push(nt),Fe.intersectionShape.triangle.push(rt))):((Fe.clickable||Fe.hoverable)&&(Ye=new c.Triangle(je,xe,le),nt=new c.Triangle(K,we,xe),rt=new c.Triangle(xe,we,le),Fe.intersectionShape.triangle.push(Ye),Fe.intersectionShape.triangle.push(nt),Fe.intersectionShape.triangle.push(rt)),(me.clickable||me.hoverable)&&(Ye=new c.Triangle(Se,Xe,xe),nt=new c.Triangle(Xe,K,xe),rt=new c.Triangle(Se,xe,je),me.intersectionShape.triangle.push(Ye),me.intersectionShape.triangle.push(nt),me.intersectionShape.triangle.push(rt)))}else(Fe.clickable||Fe.hoverable)&&(Ye=new c.Triangle(Se,Xe,le),nt=new c.Triangle(Xe,we,le),Fe.intersectionShape.triangle.push(Ye),Fe.intersectionShape.triangle.push(nt))}}}et.vertices+=8,me=Fe}var Me=j.length-8;for(et=B.updateGeoGroup(8),Ke=et.vertexArray,Ue=et.colorArray,He=et.faceArray,ue=et.vertices,ye=ue*3,ze=et.faceidx,ke=0;ke<4;ke++){j.push(j[ke*2]),j.push(j[Me+ke*2]);var Ze=j[ke*2],_e=j[Me+ke*2];Ke[ye+6*ke]=Ze.x,Ke[ye+1+6*ke]=Ze.y,Ke[ye+2+6*ke]=Ze.z,Ke[ye+3+6*ke]=_e.x,Ke[ye+4+6*ke]=_e.y,Ke[ye+5+6*ke]=_e.z,Ue[ye+6*ke]=$e.r,Ue[ye+1+6*ke]=$e.g,Ue[ye+2+6*ke]=$e.b,Ue[ye+3+6*ke]=$e.r,Ue[ye+4+6*ke]=$e.g,Ue[ye+5+6*ke]=$e.b}Me+=8,Ye=[ue,ue+2,ue+6,ue+4],nt=[ue+1,ue+5,ue+7,ue+3],He[ze]=Ye[0],He[ze+1]=Ye[1],He[ze+2]=Ye[3],He[ze+3]=Ye[1],He[ze+4]=Ye[2],He[ze+5]=Ye[3],He[ze+6]=nt[0],He[ze+7]=nt[1],He[ze+8]=nt[3],He[ze+9]=nt[1],He[ze+10]=nt[2],He[ze+11]=nt[3],et.faceidx+=12,et.vertices+=8}}function E(B,D,H,W,q,V,$){(!$||$==="default")&&($="rectangle"),$==="edged"?A(B,D,H,W,q):($==="rectangle"||$==="oval"||$==="parabola")&&y(B,D,H,W,q,V,$)}function T(B){return B&&B.elem==="C"&&B.atom==="CA"}function u(B,D){if(B&&D&&B.chain===D.chain){if(!B.hetflag&&!D.hetflag&&B.reschain===D.reschain&&(B.resi===D.resi||B.resi===D.resi-1))return!0;if(B.resi<D.resi){var H=B.x-D.x,W=B.y-D.y,q=B.z-D.z,V=H*H+W*W+q*q;if(B.atom=="CA"&&D.atom=="CA"&&V<16||(B.atom=="P"||D.atom=="P")&&V<64)return!0}}return!1}function _(B,D,H,W,q){if(!(D==null||D.vertices==0)){q&&(D.initTypedArrays(),D.setUpNormals());var V=new h.MeshDoubleLambertMaterial;V.vertexColors=h.Coloring.FaceColors,typeof H=="number"&&H>=0&&H<1&&(V.transparent=!0,V.opacity=H),V.outline=W;var $=new h.Mesh(D,V);B.add($)}}function M(B,D,H,W,q,V,$,O,j){var J,oe,ie,he,de,fe;if(!(!W||!q||!$)){var ue=q.sub(W);ue.normalize();var ye=O[j];for(oe=j+1;oe<O.length&&(ye=O[oe],ye.atom!=$.atom);oe++);if(ye=ye?new o.Vector3(ye.x,ye.y,ye.z):new o.Vector3(0,0,0),ye.sub(W),$.ss==="arrow start"){var ze=ye.clone().multiplyScalar(.3).cross(q);W.add(ze);var $e=ye.clone().cross(ue).normalize();ue.rotateAboutVector($e,.43)}for($.style.cartoon.ribbon?J=$.style.cartoon.thickness||k:$.style.cartoon.width?J=$.style.cartoon.width:$.ss==="c"?$.atom==="P"?J=S:J=b:$.ss==="arrow start"?(J=C,de=!0):$.ss==="arrow end"||$.ss==="h"&&$.style.cartoon.tubes||$.ss==="tube start"?J=b:J=C,V!=null&&ue.dot(V)<0&&ue.negate(),ue.multiplyScalar(J),oe=0;oe<D;oe++)ie=-1+oe*2/(D-1),he=new o.Vector3(W.x+ie*ue.x,W.y+ie*ue.y,W.z+ie*ue.z),he.atom=$,$.ss==="s"&&(he.smoothen=!0),B[oe].push(he);if(de)for(ue.multiplyScalar(2),oe=0;oe<D;oe++)ie=-1+oe*2/(D-1),he=new o.Vector3(W.x+ie*ue.x,W.y+ie*ue.y,W.z+ie*ue.z),he.atom=$,he.smoothen=!1,he.skip=!0,B[oe].push(he);return fe=$.style.cartoon.style||"default",B.style?B.style!=fe&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),B.style="default"):B.style=fe,($.ss==="arrow start"||$.ss==="arrow end")&&($.ss="s"),de}}const R={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},N={DA:!0,DG:!0,A:!0,G:!0},I={DT:!0,DC:!0,U:!0,C:!0,T:!0},L={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function Y(B,D,H,W=10){let q=W,V=W;var $,O,j,J,oe,ie,he,de,fe,ue,ye,ze,$e,We,Fe,me,ke,Qe,Je=new h.Geometry(!0),Ye=new h.Geometry(!0),nt=[],rt=[],et=1,Ke=!1,Ue={};for(var He in v.Gradient.builtinGradients)v.Gradient.builtinGradients.hasOwnProperty(He)&&(Ue[He]=new v.Gradient.builtinGradients[He](H[1],H[0]));var mt=function(ee,Pe){return H&&Pe.color==="spectrum"?Pe.colorscheme in Ue?Ue[Pe.colorscheme].valueToHex(ee.resi):Ue.sinebow.valueToHex(ee.resi):(0,x.getColorFromStyle)(ee,Pe).getHex()};for(de=0;de<q;de++)rt[de]=[];var ht=!1,te=!1,se=[];for(de in D){if(J=D[de],J.elem==="C"&&J.atom==="CA"){var le=u(j,J);le&&J.ss==="s"?ht=!0:ht&&(j&&O&&j.style.cartoon.arrows&&O.style.cartoon.arrows&&(j.ss="arrow end",O.ss="arrow start"),ht=!1),le&&(j.ss==="h"||j.ss=="tube start")&&j.style.cartoon.tubes?!te&&j.ss!="tube start"&&J.style.cartoon.tubes&&(J.ss="tube start",te=!0):te&&(j.ss==="tube start"?j.ss="tube end":O&&O.style.cartoon.tubes&&(O.ss="tube end"),te=!1),O=j,j=J}J&&J.atom in R&&se.push(J)}te&&j.style.cartoon.tubes&&(j.ss="tube end",te=!1);var Se=function(ee){rt[0].length>0&&E(Ye,rt,nt,V,he,et,rt.style);var Pe=[],at=null;if(ee){for(de=0;de<q;de++)Pe[de]=rt[de][rt[de].length-1];at=nt[nt.length-1]}for(rt=[],de=0;de<q;de++)rt[de]=[];if(nt=[],ee){for(de=0;de<q;de++)rt[de].push(Pe[de]);nt.push(at)}_(B,Ye,et,Ke,!0),_(B,Je,et,Ke,!1),Ye=new h.Geometry(!0),Je=new h.Geometry(!0)};j=void 0;for(var we=0;we<se.length;we++){J=se[we];var Xe=J.resn.trim(),je=Xe in L;if(et=1,$=J.style.cartoon,j&&j.style.cartoon&&(et=j.style.cartoon.opacity),j&&j.style.cartoon&&j.style.cartoon.outline&&(Ke=j.style.cartoon.outline),j&&j.style.cartoon&&(!J.style.cartoon||j.style.cartoon.opacity!=J.style.cartoon.opacity)&&Se(j.chain==J.chain),$.style==="trace"){if(!J.hetflag&&(J.elem==="C"&&J.atom==="CA"||je&&J.atom==="P"||J.atom==="BB")){if(ie=mt(J,$),(0,x.isNumeric)($.thickness)?he=$.thickness:he=k,u(j,J))if(ie==oe){var K=p.CC.color(ie);g.GLDraw.drawCylinder(Je,j,J,he,K,2,2)}else{var xe=new o.Vector3().addVectors(j,J).multiplyScalar(.5),Me=p.CC.color(oe),Ze=p.CC.color(ie);g.GLDraw.drawCylinder(Je,j,xe,he,Me,2,0),g.GLDraw.drawCylinder(Je,xe,J,he,Ze,0,2)}if((J.clickable===!0||J.hoverable)&&J.intersectionShape!==void 0){var _e=new o.Vector3(J.x,J.y,J.z);J.intersectionShape.sphere.push(new c.Sphere(_e,he))}j=J,oe=ie}}else{if(T(J)||je&&(J.atom==="P"||J.atom.indexOf("O5")==0)){if(Qe)if(J.ss==="tube end")Qe=!1,ke=new o.Vector3(J.x,J.y,J.z),g.GLDraw.drawCylinder(Je,me,ke,2,p.CC.color(oe),1,1),J.ss="h";else if(j.chain!=J.chain||j.ss==="tube end")Qe=!1,j.ss="h",ke=new o.Vector3(j.x,j.y,j.z),g.GLDraw.drawCylinder(Je,me,ke,2,p.CC.color(oe),1,1);else continue;if(j&&(!u(j,J)||j.ss==="tube start")){for(j.ss==="tube start"&&(Qe=!0,me=new o.Vector3(j.x,j.y,j.z),j.ss="h"),Fe&&(ze?We=new o.Vector3().addVectors(j,ze).multiplyScalar(.5):We=new o.Vector3(j.x,j.y,j.z),g.GLDraw.drawCylinder(Je,We,Fe,l,p.CC.color(Fe.color),0,2),M(rt,q,!0,ze,$e,ye,j,se,we),nt.push(ie),We=null,Fe=null),rt[0].length>0&&E(Ye,rt,nt,V,he,et,rt.style),rt=[],de=0;de<q;de++)rt[de]=[];nt=[]}if(j===void 0||j.rescode!=J.rescode||j.resi!=J.resi){if(Fe&&j!=null){We=new o.Vector3().addVectors(j,J).multiplyScalar(.5);var Ve=We.clone().sub(Fe).multiplyScalar(.02);We.add(Ve),g.GLDraw.drawCylinder(Je,We,Fe,l,p.CC.color(Fe.color),0,2),We=null,Fe=null}ie=mt(J,$),nt.push(ie),(0,x.isNumeric)($.thickness)?he=$.thickness:he=k,j=J,fe=new o.Vector3(j.x,j.y,j.z),fe.resi=j.resi,oe=ie}(J.clickable===!0||J.hoverable===!0)&&(J.intersectionShape===void 0||J.intersectionShape.triangle===void 0)&&(J.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else j!=null&&(T(j)&&J.atom==="O"||je&&j.atom==="P"&&(J.atom==="OP2"||J.atom==="O2P")||je&&j.atom.indexOf("O5")==0&&J.atom.indexOf("C5")==0)?(ue=new o.Vector3(J.x,J.y,J.z),ue.resi=J.resi,(J.atom==="OP2"||J.atom==="O2P")&&($e=new o.Vector3(J.x,J.y,J.z))):je&&J.atom.indexOf("O3")==0?ze=new o.Vector3(J.x,J.y,J.z):(J.atom==="N1"&&Xe in N||J.atom==="N3"&&Xe in I)&&(Fe=new o.Vector3(J.x,J.y,J.z),Fe.color=(0,x.getColorFromStyle)(J,$).getHex());ue&&fe&&ue.resi===fe.resi&&(M(rt,q,!0,fe,ue,ye,j,se,we),ye=ue,fe=null,ue=null,nt.push(ie))}}Fe&&(ze?We=new o.Vector3().addVectors(j,ze).multiplyScalar(.5):We=new o.Vector3(j.x,j.y,j.z),g.GLDraw.drawCylinder(Je,We,Fe,l,p.CC.color(Fe.color),0,2),M(rt,q,!0,ze,$e,ye,j,se,we),nt.push(ie)),Se(!1)}}),"./src/index.ts":((r,e,t)=>{t.r(e),t.d(e,{CAP:()=>l.CAP,CC:()=>c.CC,CONTEXTS_PER_VIEWPORT:()=>A.CONTEXTS_PER_VIEWPORT,Color:()=>c.Color,CustomLinear:()=>o.CustomLinear,Cylinder:()=>x.Cylinder,GLDraw:()=>l.GLDraw,GLModel:()=>y.GLModel,GLShape:()=>k.GLShape,GLViewer:()=>A.GLViewer,GLVolumetricRender:()=>S.GLVolumetricRender,Gradient:()=>o.Gradient,GradientType:()=>o.GradientType,Label:()=>h.Label,LabelCount:()=>h.LabelCount,MarchingCube:()=>b.MarchingCube,MarchingCubeInitializer:()=>b.MarchingCubeInitializer,Matrix3:()=>g.Matrix3,Matrix4:()=>g.Matrix4,Parsers:()=>p.Parsers,PausableTimer:()=>f.PausableTimer,PointGrid:()=>b.PointGrid,ProteinSurface:()=>b.ProteinSurface,Quaternion:()=>g.Quaternion,ROYGB:()=>o.ROYGB,RWB:()=>o.RWB,Ray:()=>g.Ray,Sinebow:()=>o.Sinebow,Sphere:()=>x.Sphere,SurfaceType:()=>b.SurfaceType,Triangle:()=>x.Triangle,Vector2:()=>g.Vector2,Vector3:()=>g.Vector3,VolumeData:()=>C.VolumeData,adjustVolumeStyle:()=>f.adjustVolumeStyle,applyPartialCharges:()=>v.applyPartialCharges,autoinit:()=>E.autoinit,autoload:()=>E.autoload,base64ToArray:()=>f.base64ToArray,bondLength:()=>p.bondLength,builtinColorSchemes:()=>c.builtinColorSchemes,builtinGradients:()=>o.builtinGradients,chains:()=>c.chains,clamp:()=>g.clamp,conversionMatrix3:()=>g.conversionMatrix3,createStereoViewer:()=>A.createStereoViewer,createViewer:()=>A.createViewer,createViewerGrid:()=>A.createViewerGrid,deepCopy:()=>f.deepCopy,degToRad:()=>g.degToRad,download:()=>f.download,drawCartoon:()=>s.drawCartoon,elementColors:()=>c.elementColors,extend:()=>f.extend,get:()=>f.get,getAtomProperty:()=>f.getAtomProperty,getColorFromStyle:()=>f.getColorFromStyle,getElement:()=>f.getElement,getExtent:()=>f.getExtent,getGradient:()=>o.getGradient,getPropertyRange:()=>f.getPropertyRange,getbin:()=>f.getbin,htmlColors:()=>c.htmlColors,inflateString:()=>f.inflateString,isEmptyObject:()=>f.isEmptyObject,isNumeric:()=>f.isNumeric,makeFunction:()=>f.makeFunction,mergeGeos:()=>f.mergeGeos,normalizeValue:()=>o.normalizeValue,partialCharges:()=>v.partialCharges,processing_autoinit:()=>E.processing_autoinit,residues:()=>c.residues,setBondLength:()=>p.setBondLength,setSyncSurface:()=>b.setSyncSurface,specStringToObject:()=>f.specStringToObject,splitMesh:()=>k.splitMesh,ssColors:()=>c.ssColors,subdivide_spline:()=>s.subdivide_spline,syncSurface:()=>b.syncSurface,viewers:()=>E.viewers});var o=t("./src/Gradient.ts"),c=t("./src/colors.ts"),h=t("./src/Label.ts"),v=t("./src/partialCharges.ts"),p=t("./src/parsers/index.ts"),g=t("./src/WebGL/math/index.ts"),x=t("./src/WebGL/shapes/index.ts"),f=t("./src/utilities.ts"),b=t("./src/ProteinSurface4.ts"),C=t("./src/VolumeData.ts"),S=t("./src/VolumetricRender.ts"),k=t("./src/GLShape.ts"),l=t("./src/GLDraw.ts"),s=t("./src/glcartoon.ts"),y=t("./src/GLModel.ts"),A=t("./src/GLViewer.ts"),E=t("./src/autoload.ts");t("./src/specs.ts"),window&&(window.$3Dmol=e)}),"./src/parsers/BCIF.ts":((r,e,t)=>{t.r(e),t.d(e,{BCIF:()=>k});var o=t("./src/utilities.ts"),c=t("./src/parsers/utils/computeSecondaryStructure.ts"),h=t("./src/parsers/utils/processSymmetries.ts"),v=t("./src/parsers/cifutils/category.ts"),p=t("./src/parsers/utils/assignPDBBonds.ts"),g=t("./src/WebGL/index.ts"),x=t("./src/parsers/utils/isEmpty.ts"),f=t("./src/vendor/mmtf.js");class b{constructor(s){if(this.C={},s){let y=s.getField("comp_id"),A=s.getField("atom_id_1"),E=s.getField("atom_id_2"),T=s.getField("value_order");for(let u=0;u<y.length;u++){let _=y[u],M=A[u],R=E[u],N=T[u],I=1;N=="doub"?I=2:N=="trip"&&(I=3),this.C[_]==null&&(this.C[_]={}),this.C[_][M]==null&&(this.C[_][M]={}),this.C[_][R]==null&&(this.C[_][R]={}),this.C[_][M][R]=I,this.C[_][R][M]=I}}}order(s,y,A){return this.C[s]!==void 0&&this.C[s][y]!==void 0&&this.C[s][y][A]!==void 0?this.C[s][y][A]:0}}class C{constructor(s){if(this.C=[],s){let y=s.getField("conn_type_id"),A=s.getField("ptnr1_label_asym_id"),E=s.getField("ptnr1_label_seq_id"),T=s.getField("ptnr1_label_comp_id"),u=s.getField("ptnr1_label_atom_id"),_=s.getField("ptnr2_label_asym_id"),M=s.getField("ptnr2_label_seq_id"),R=s.getField("ptnr2_label_comp_id"),N=s.getField("ptnr2_label_atom_id"),I=s.getField("pdbx_value_order");for(let L=0;L<y.length;L++)if(y[L]=="disulf"||y[L]=="covale"){let Y=I?I[L]==""?1:parseInt(I[L]):1;this.C.push([[A[L],E[L],T[L],u[L]],[_[L],M[L],R[L],N[L]],Y])}}}}class S{constructor(){this.R={}}add(s){this.R[s.lchain]==null&&(this.R[s.lchain]={}),this.R[s.lchain][s.lresi]==null&&(this.R[s.lchain][s.lresi]={}),this.R[s.lchain][s.lresi][s.lresn]==null&&(this.R[s.lchain][s.lresi][s.lresn]=[]),this.R[s.lchain][s.lresi][s.lresn].push(s),this.R[s.lchain][s.lresi][s.lresn][s.atom]=s}geta([s,y,A,E]){if(this.R[s]!==void 0&&this.R[s][y]!==void 0&&this.R[s][y][A]!==void 0)return this.R[s][y][A][E]}setBonds(s,y){for(let A in this.R)for(let E in this.R[A])for(let T in this.R[A][E]){let u=this.R[A][E][T];for(let _=0;_<u.length;_++)for(let M=_+1;M<u.length;M++){let R=u[_],N=u[M],I=s.order(T,R.atom,N.atom);I>0&&(R.bonds.push(N.index),N.bonds.push(R.index),R.bondOrder.push(I),N.bondOrder.push(I))}}for(let A of y.C){let E=A[0],T=A[1],u=A[2],_=this.geta(E),M=this.geta(T);_!=null&&M!=null&&(_.bonds.push(M.index),M.bonds.push(_.index),_.bondOrder.push(u),M.bondOrder.push(u))}}}function k(l,s){var y=!s.keepH,A=s.altLoc?s.altLoc:"A",E=!s.noComputeSecondaryStructure;const T=!s.doAssembly,u=s.assignBonds===void 0?!0:s.assignBonds;if(typeof l=="string")try{l=(0,o.base64ToArray)(l)}catch{l=new TextEncoder().encode(l)}else l=new Uint8Array(l);var _=f.decodeMsgpack(l);_==31&&(l=(0,o.inflateString)(l,!1),_=f.decodeMsgpack(l));var M=[],R=M.modelData=[],N=_.dataBlocks.length;if(N==0)return M;s.multimodel||(N=1);for(let I=0;I<N;I++){let L=M.length;const Y=[];R.push({symmetries:[]}),M.push([]);const B=_.dataBlocks[I],D=Object.create(null);for(const Ue of B.categories)D[Ue.name.substr(1)]=(0,v.Category)(Ue);let H={},W=D.struct_conf;if(W){let Ue=W.getField("conf_type_id"),He=W.getField("beg_label_asym_id"),mt=W.getField("beg_label_seq_id"),ht=W.getField("end_label_seq_id");for(let te=0;te<Ue.length;te++)if(Ue[te].startsWith("H")){let se=He[te],le=mt[te],Se=ht[te];se in H||(H[se]={}),H[se][le]="h1";for(let we=le+1;we<Se;we++)H[se][we]="h";H[se][Se]="h2"}}let q=D.struct_sheet_range;if(q){let Ue=q.getField("id"),He=q.getField("beg_label_asym_id"),mt=q.getField("beg_label_seq_id"),ht=q.getField("end_label_seq_id");for(let te=0;te<Ue.length;te++){let se=He[te],le=mt[te],Se=ht[te];se in H||(H[se]={}),H[se][le]="s1";for(let we=le+1;we<Se;we++)H[se][we]="s";H[se][Se]="s2"}}let V=D.pdbx_struct_oper_list,$=V.getField("id");if($&&!T){let Ue=V.getField("matrix[1][1]"),He=V.getField("matrix[1][2]"),mt=V.getField("matrix[1][3]"),ht=V.getField("matrix[2][1]"),te=V.getField("matrix[2][2]"),se=V.getField("matrix[2][3]"),le=V.getField("matrix[3][1]"),Se=V.getField("matrix[3][2]"),we=V.getField("matrix[3][3]"),Xe=V.getField("vector[1]"),je=V.getField("vector[2]"),K=V.getField("vector[3]");for(let xe=0;xe<$.length;xe++){const Me=new g.Matrix4(Ue[xe],He[xe],mt[xe],Xe[xe],ht[xe],te[xe],se[xe],je[xe],le[xe],Se[xe],we[xe],K[xe]);R[R.length-1].symmetries.push(Me)}}let O=new b(D.chem_comp_bond),j=new S,J=new C(D.struct_conn),oe=D.atom_site,ie=oe.rowCount,he=oe.getField("group_PDB"),de=oe.getField("Cartn_x"),fe=oe.getField("Cartn_y"),ue=oe.getField("Cartn_z"),ye=oe.getField("auth_asym_id"),ze=oe.getField("label_asym_id"),$e=oe.getField("auth_seq_id"),We=oe.getField("label_seq_id"),Fe=oe.getField("auth_comp_id"),me=oe.getField("label_comp_id"),ke=oe.getField("auth_atom_id"),Qe=oe.getField("label_atom_id"),Je=oe.getField("type_symbol"),Ye=oe.getField("B_iso_or_equiv"),nt=oe.getField("id"),rt=oe.getField("label_alt_id"),et=oe.getField("pdbx_PDB_model_num"),Ke=et?et[0]:0;for(let Ue=0;Ue<ie;Ue++){if(he!==void 0&&he[Ue]==="TER")continue;if(et&&et[Ue]!=Ke)if(Ke=et[Ue],s.multimodel)s.onemol||(M.push([]),R.push(R[R.length-1]),Ke=et[Ue],j.setBonds(O,J),j=new S);else break;const He={};He.x=de[Ue],He.y=fe[Ue],He.z=ue[Ue],He.chain=ye?ye[Ue]:ze?ze[Ue]:void 0,He.lchain=ze?ze[Ue]:void 0,He.resi=$e?$e[Ue]:We?We[Ue]:void 0,He.lresi=We?We[Ue]:void 0,He.resn=Fe?Fe[Ue].trim():me?me[Ue].trim():void 0,He.lresn=me?me[Ue].trim():void 0,He.atom=ke?ke[Ue].replace(/"/gm,""):Qe?Qe[Ue].replace(/"/gm,""):void 0,He.icode=rt?rt[Ue]:void 0,He.altLoc=He.icode,He.hetflag=!he||he[Ue]==="HETA"||he[Ue]==="HETATM";let mt="X";Je&&(mt=Je[Ue].replace(/\(?\+?\d+.*/,"")),He.elem=mt[0].toUpperCase()+mt.substring(1,2).toLowerCase(),Ye&&(He.b=Ye[Ue]),!(y&&He.elem=="H")&&(He.altLoc!=""&&He.altLoc!=A&&A!="*"||(He.bonds=[],He.ss="c",He.serial=nt[Ue],He.model=Ke,He.bondOrder=[],He.properties={},He.index=M[M.length-1].length,Y[He.serial]=[M.length,He.index],M[M.length-1].push(He),j.add(He)))}if(j.setBonds(O,J),!(0,x.isEmpty)(H))for(let Ue=L;Ue<M.length;Ue++){let He=M[Ue];for(let mt=0;mt<He.length;mt++){const ht=He[mt];if(ht!==void 0&&ht.lchain in H&&ht.lresi in H[ht.lchain]){const te=H[ht.lchain][ht.lresi];ht.ss=te[0],te.length>1&&(te[1]=="1"?ht.ssbegin=!0:te[1]=="2"&&(ht.ssend=!0))}}}s.multimodel&&I<N-1&&(s.onemol||(M.push([]),R.push({symmetries:[]})))}for(let I=0;I<M.length;I++)u&&!(s.duplicateAssemblyAtoms&&!s.dontConnectDuplicatedAtoms)&&(0,p.assignPDBBonds)(M[I],s),E&&(0,c.computeSecondaryStructure)(M[I],s.hbondCutoff),(0,h.processSymmetries)(R[I].symmetries,M[I],s,R[I].cryst),s.duplicateAssemblyAtoms&&!s.dontConnectDuplicatedAtoms&&u&&(0,p.assignPDBBonds)(M[I],s);return M}}),"./src/parsers/CDJSON.ts":((r,e,t)=>{t.r(e),t.d(e,{CDJSON:()=>o});function o(c,h){var v=[[]];typeof c=="string"&&(c=JSON.parse(c));for(var p=c.m,g=p[0].a,x=p[0].b,f=p[0].s,b=h!==void 0&&h.parseStyle!==void 0?h.parseStyle:f!==void 0,C=v[v.length-1].length,S=0;S<g.length;S++){var k=g[S],l={};l.id=k.i,l.x=k.x,l.y=k.y,l.z=k.z||0,l.bonds=[],l.bondOrder=[];var s=k.l||"C";l.elem=s[0].toUpperCase()+s.substring(1).toLowerCase(),l.serial=v[v.length-1].length,b&&(l.style=f[k.s||0]),v[v.length-1].push(l)}for(let y=0;y<x.length;y++){let A=x[y],E=A.b+C,T=A.e+C,u=A.o||1,_=v[v.length-1][E],M=v[v.length-1][T];_.bonds.push(T),_.bondOrder.push(u),M.bonds.push(E),M.bondOrder.push(u)}return v}}),"./src/parsers/CIF.ts":((r,e,t)=>{t.r(e),t.d(e,{CIF:()=>g});var o=t("./src/parsers/utils/computeSecondaryStructure.ts"),c=t("./src/parsers/utils/processSymmetries.ts"),h=t("./src/WebGL/index.ts"),v=t("./src/parsers/utils/assignPDBBonds.ts");const p=function(x,f,b,C){return new h.Vector3(f,b,C).applyMatrix3(x)};function g(x,f={}){const b=[],C=!f.doAssembly,S=b.modelData=[],k=f.assignBonds===void 0?!0:f.assignBonds;function l(u,_){const M=[];let R=0,N=0;for(;N<u.length;){for(;u.substring(N,N+_.length)!==_&&N<u.length;)if(u[N]==="'"){for(N++;N<u.length&&u[N]!=="'";)N++;for(;u.substring(N,N+_.length)!==_&&N<u.length;)N++}else if(u[N]==='"'){for(N++;N<u.length&&u[N]!=='"';)N++;N++}else N++;M.push(u.substring(R,N)),R=N=N+_.length}return M}const s=x.split(/\r?\n|\r/),y=[];let A=!1;for(let u=0;u<s.length;u++){var E=s[u].split("#")[0];if(A?E[0]===";"&&(A=!1):E[0]===";"&&(A=!0),A||E!==""){if(!A&&(E=E.trim(),E[0]==="_")){const _=E.split(/\s/)[0].indexOf(".");if(_>-1){let M=E.split("");M[_]="_",E=M.join(""),E=E.substring(0,_)+"_"+E.substring(_+1)}}y.push(E)}}let T=0;for(;T<y.length;){for(;!y[T].startsWith("data_")||y[T]==="data_global";)T++;T++;const u={};for(;T<y.length&&!y[T].startsWith("data_");)if(y[T][0]===void 0)T++;else if(y[T][0]==="_"){const N=y[T].split(/\s/)[0].toLowerCase(),I=u[N]=u[N]||[],L=y[T].substring(y[T].indexOf(N)+N.length);if(L==="")if(T++,y[T][0]===";"){let Y=y[T].substring(1);for(T++;y[T]!==";";)Y=Y+`
`+y[T],T++;I.push(Y)}else I.push(y[T]);else I.push(L.trim());T++}else if(y[T].substring(0,5)==="loop_"){T++;const N=[];for(;y[T]===""||y[T][0]==="_";){if(y[T]!==""){let L=y[T].split(/\s/)[0].toLowerCase(),Y=u[L]=u[L]||[];N.push(Y)}T++}let I=0;for(;T<y.length&&y[T][0]!=="_"&&!y[T].startsWith("loop_")&&!y[T].startsWith("data_");){let L=l(y[T]," ");for(let Y=0;Y<L.length;Y++)L[Y]!==""&&(N[I].push(L[Y]),I=(I+1)%N.length);T++}}else T++;S.push({symmetries:[]}),b.push([]);const _=u._atom_site_id!==void 0?u._atom_site_id.length:u._atom_site_label.length;let M;if(u._cell_length_a!==void 0){const N=parseFloat(u._cell_length_a),I=parseFloat(u._cell_length_b),L=parseFloat(u._cell_length_c),Y=parseFloat(u._cell_angle_alpha)||90,B=parseFloat(u._cell_angle_beta)||90,D=parseFloat(u._cell_angle_gamma)||90;M=(0,h.conversionMatrix3)(N,I,L,Y,B,D),S[S.length-1].cryst={a:N,b:I,c:L,alpha:Y,beta:B,gamma:D}}for(let N=0;N<_;N++){if(u._atom_site_group_pdb!==void 0&&u._atom_site_group_pdb[N]==="TER")continue;const I={};if(u._atom_site_cartn_x!==void 0)I.x=parseFloat(u._atom_site_cartn_x[N]),I.y=parseFloat(u._atom_site_cartn_y[N]),I.z=parseFloat(u._atom_site_cartn_z[N]);else{const Y=p(M,parseFloat(u._atom_site_fract_x[N]),parseFloat(u._atom_site_fract_y[N]),parseFloat(u._atom_site_fract_z[N]));I.x=Y.x,I.y=Y.y,I.z=Y.z}I.chain=u._atom_site_auth_asym_id?u._atom_site_auth_asym_id[N]:u._atom_site_label_asym_id?u._atom_site_label_asym_id[N]:void 0,I.resi=u._atom_site_auth_seq_id?parseInt(u._atom_site_auth_seq_id[N]):u._atom_site_label_seq_id?u._atom_site_label_seq_id[N]:void 0,I.resn=u._atom_site_auth_comp_id?u._atom_site_auth_comp_id[N].trim():u._atom_site_label_comp_id?u._atom_site_label_comp_id[N].trim():void 0,I.atom=u._atom_site_auth_atom_id?u._atom_site_auth_atom_id[N].replace(/"/gm,""):u._atom_site_label_atom_id?u._atom_site_label_atom_id[N].replace(/"/gm,""):void 0,I.hetflag=!u._atom_site_group_pdb||u._atom_site_group_pdb[N]==="HETA"||u._atom_site_group_pdb[N]==="HETATM",u._atom_site_b_iso_or_equiv&&(I.b=parseFloat(u._atom_site_b_iso_or_equiv[N]));let L="X";u._atom_site_type_symbol?L=u._atom_site_type_symbol[N].replace(/\(?\+?\d+.*/,""):u._atom_site_label&&(L=u._atom_site_label[N].split("_")[0].replace(/\(?\d+.*/,"")),I.elem=L[0].toUpperCase()+L.substring(1,2).toLowerCase(),I.bonds=[],I.ss="c",I.serial=N,I.bondOrder=[],I.properties={},b[b.length-1].push(I)}if(u._pdbx_struct_oper_list_id!==void 0&&!C)for(let N=0;N<u._pdbx_struct_oper_list_id.length;N++){const I=parseFloat(u["_pdbx_struct_oper_list_matrix[1][1]"][N]),L=parseFloat(u["_pdbx_struct_oper_list_matrix[1][2]"][N]),Y=parseFloat(u["_pdbx_struct_oper_list_matrix[1][3]"][N]),B=parseFloat(u["_pdbx_struct_oper_list_vector[1]"][N]),D=parseFloat(u["_pdbx_struct_oper_list_matrix[2][1]"][N]),H=parseFloat(u["_pdbx_struct_oper_list_matrix[2][2]"][N]),W=parseFloat(u["_pdbx_struct_oper_list_matrix[2][3]"][N]),q=parseFloat(u["_pdbx_struct_oper_list_vector[2]"][N]),V=parseFloat(u["_pdbx_struct_oper_list_matrix[3][1]"][N]),$=parseFloat(u["_pdbx_struct_oper_list_matrix[3][2]"][N]),O=parseFloat(u["_pdbx_struct_oper_list_matrix[3][3]"][N]),j=parseFloat(u["_pdbx_struct_oper_list_vector[3]"][N]),J=new h.Matrix4(I,L,Y,B,D,H,W,q,V,$,O,j);S[S.length-1].symmetries.push(J)}const R=function(N){const I=N.match("-");N=N.replace(/[-xyz]/g,"");const L=N.split("/");let Y,B;return L[1]===void 0?B=1:B=parseInt(L[1]),L[0]===""?Y=1:Y=parseInt(L[0]),Y/B*(I?-1:1)};if(u._symmetry_equiv_pos_as_xyz!==void 0&&!C)for(let N=0;N<u._symmetry_equiv_pos_as_xyz.length;N++){const I=u._symmetry_equiv_pos_as_xyz[N].replace(/["' ]/g,"").split(",").map(function(D){return D.replace(/-/g,"+-")});let L=new h.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let D=0;D<3;D++){const H=I[D].split("+");for(let W=0;W<H.length;W++){const q=H[W];if(q==="")continue;const V=R(q);q.match("x")?L.elements[D+0]=V:q.match("y")?L.elements[D+4]=V:q.match("z")?L.elements[D+8]=V:L.elements[D+12]=V}}const Y=M.getMatrix4(),B=new h.Matrix4().getInverse(Y,!0);L=new h.Matrix4().multiplyMatrices(L,B),L=new h.Matrix4().multiplyMatrices(Y,L),S[S.length-1].symmetries.push(L)}}for(let u=0;u<b.length;u++)k&&!(f.duplicateAssemblyAtoms&&!f.dontConnectDuplicatedAtoms)&&(0,v.assignPDBBonds)(b[u],f),(0,o.computeSecondaryStructure)(b[u],f.hbondCutoff),(0,c.processSymmetries)(S[u].symmetries,b[u],f,S[u].cryst),f.duplicateAssemblyAtoms&&!f.dontConnectDuplicatedAtoms&&k&&(0,v.assignPDBBonds)(b[u],f);return b}}),"./src/parsers/CUBE.ts":((r,e,t)=>{t.r(e),t.d(e,{CUBE:()=>v});var o=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/assignBonds.ts"),h=t("./src/parsers/utils/anumToSymbol.ts");function v(p,g){g=g||{};const x=[[]];let f=p.split(/\r?\n/);const b=g.assignBonds===void 0?!0:g.assignBonds;if(f.length<6)return x;let C=f[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const S=Math.abs(parseFloat(C[0]));let k={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const l=k.origin=new o.Vector3(parseFloat(C[1]),parseFloat(C[2]),parseFloat(C[3]));C=f[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),C=f[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const s=C[0]>0?.529177:1;l.multiplyScalar(s);const y=Math.abs(C[0]),A=new o.Vector3(parseFloat(C[1]),parseFloat(C[2]),parseFloat(C[3])).multiplyScalar(s);C=f[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const E=Math.abs(C[0]),T=new o.Vector3(parseFloat(C[1]),parseFloat(C[2]),parseFloat(C[3])).multiplyScalar(s);C=f[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const u=Math.abs(C[0]),_=new o.Vector3(parseFloat(C[1]),parseFloat(C[2]),parseFloat(C[3])).multiplyScalar(s);if(k.size={x:y,y:E,z:u},k.unit=new o.Vector3(A.x,T.y,_.z),A.y!=0||A.z!=0||T.x!=0||T.z!=0||_.x!=0||_.y!=0){k.matrix4=new o.Matrix4(A.x,T.x,_.x,0,A.y,T.y,_.y,0,A.z,T.z,_.z,0,0,0,0,1);let B=new o.Matrix4().makeTranslation(l.x,l.y,l.z);k.matrix4=k.matrix4.multiplyMatrices(B,k.matrix4),k.matrix=k.matrix4.matrix3FromTopLeft(),k.origin=new o.Vector3(0,0,0),k.unit=new o.Vector3(1,1,1)}x.modelData=[{cryst:k}],f=f.splice(6,S);for(var M=x[x.length-1].length,R=M+f.length,N=M;N<R;++N){var I={};I.serial=N;var L=f[N-M],Y=L.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");I.elem=h.anumToSymbol[Y[0]],I.x=parseFloat(Y[2])*s,I.y=parseFloat(Y[3])*s,I.z=parseFloat(Y[4])*s,I.hetflag=!0,I.bonds=[],I.bondOrder=[],I.properties={},x[x.length-1].push(I)}if(b)for(let B=0;B<x.length;B++)(0,c.assignBonds)(x[B],g);return x}}),"./src/parsers/GRO.ts":((r,e,t)=>{t.r(e),t.d(e,{GRO:()=>h});var o=t("./src/parsers/utils/assignPDBBonds.ts"),c=t("./src/parsers/utils/atomNameToElem.ts");function h(v,p){const g=[],x=v.split(/\r?\n|\r/);for(;x.length>0;){const f=parseInt(x[1]);if(x.length<3||isNaN(f)||f<=0||x.length<f+3)break;const b=[];g.push(b);let C=2;const S=b.length,k=S+f;for(let l=S;l<k;l++){const s=x[C++],y={};y.serial=l,y.atom=s.slice(10,15).trim(),y.elem=(0,c.atomNameToElem)(y.atom,!0),y.x=10*parseFloat(s.slice(20,28)),y.y=10*parseFloat(s.slice(28,36)),y.z=10*parseFloat(s.slice(36,44)),y.resi=parseInt(s.slice(0,5)),y.resn=s.slice(5,10).trim(),y.bonds=[],y.bondOrder=[],y.properties={},s.length>44&&(y.dx=10*parseFloat(s.slice(44,52)),y.dy=10*parseFloat(s.slice(52,60)),y.dz=10*parseFloat(s.slice(60,68))),b[l]=y}if(x.length<=C+3){const l=x[C++].trim().split(/\s+/);if(l.length===3){for(let s=0;s<3;s++)l[s]=(parseFloat(l[s])*10).toString();g.box=l}}x.splice(0,++C)}for(let f=0;f<g.length;f++)(0,o.assignPDBBonds)(g[f],p);return g}}),"./src/parsers/LAMMPSTRJ.ts":((r,e,t)=>{t.r(e),t.d(e,{LAMMPSTRJ:()=>h});var o=t("./src/parsers/utils/assignBonds.ts");const c={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function h(v,p){const g=[],x=v.split(/\r?\n|\r/);let f=0,b=0,C=0;for(;C<x.length-9;){for(var S=C;S<x.length;S++)if(x[S].match(/ITEM: NUMBER OF ATOMS/)&&(b=parseInt(x[S+1])),x[S].match(/ITEM: ATOMS/)){f=S+1;break}const k=x[f-1].replace("ITEM: ATOMS ","").split(" ");g.push([]);for(let l=f;l<f+b;l++){const s={},y={},A=x[l].split(" ");for(let E=0;E<A.length;E++){const T=c[k[E]];T!==void 0&&(T==="serial"?s[T]=parseInt(A[E]):T==="x"||T==="y"||T==="z"?s[T]=parseFloat(A[E]):T==="charge"||T==="radius"?y[T]=parseFloat(A[E]):s[T]=A[E]),s.properties=y,s.bonds=[],s.bondOrder=[]}g[g.length-1][l-f]=s}C=f+b-1}if(p.assignBonds)for(let k=0;k<g.length;k++)(0,o.assignBonds)(g[k],p);return g}}),"./src/parsers/MMTF.ts":((r,e,t)=>{t.r(e),t.d(e,{MMTFparser:()=>b});var o=t("./src/utilities.ts"),c=t("./src/WebGL/index.ts"),h=t("./src/parsers/utils/computeSecondaryStructure.ts"),v=t("./src/parsers/utils/processSymmetries.ts"),p=t("./src/vendor/mmtf.js"),g=function(C){return String.fromCharCode.apply(null,C).replace(/\0/g,"")},x=function(C){return C==0||C==2||C==4?"h":C==3?"s":"c"};let f=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function b(C,S){var k=!S.keepH,l=S.altLoc?S.altLoc:"A",s=!!S.noSecondaryStructure,y=!S.noComputeSecondaryStructure,A=!S.doAssembly,E=S.assemblyIndex?S.assemblyIndex:0;typeof C=="string"?C=(0,o.base64ToArray)(C):C=new Uint8Array(C);var T=p.decode(C),u=[[]],_=u.modelData=[],M=0,R=0,N=0,I=T.secStructList,L=T.bFactorList,Y=T.altLocList,B=T.occupancyList,D=T.bondAtomList,H=T.bondOrderList,W=T.numModels;if(W==0)return u;S.multimodel||(W=1);var q,V,$,O,j,J,oe=[];if(!A&&T.bioAssemblyList&&T.bioAssemblyList.length>0){var ie=T.bioAssemblyList[E].transformList;for(q=0,J=ie.length;q<J;q++){var he=new c.Matrix4(ie[q].matrix);he.transpose(),oe.push(he)}}var de=null;if(T.unitCell){var fe=T.unitCell;de={a:fe[0],b:fe[1],c:fe[2],alpha:fe[3],beta:fe[4],gamma:fe[5]}}let ue=[];T.entityList.forEach(Ae=>{Ae.chainIndexList.forEach(ne=>{ue[ne]=Ae.type=="polymer"})});var ye=0;for(j=0;j<W;j++){var ze=T.chainsPerModel[j],$e=u[u.length-1],We=[];for(_.push({symmetries:oe,cryst:de}),q=0;q<ze;++q){var Fe=T.groupsPerChain[M],me=g(T.chainIdList.subarray(M*4,M*4+4));T.chainNameList&&(me=g(T.chainNameList.subarray(M*4,M*4+4)));var ke=R,Qe="";for(V=0;V<Fe;++V){var Je=T.groupList[T.groupTypeList[R]],Ye=Je.atomNameList.length,nt=0,rt=!1,et=!1;if(I){nt=I[R];var Ke=x(nt);(R==0||Ke!=Qe)&&(rt=!0),Qe=Ke;var Ue=R+1;(Ue>=I.length||x(I[Ue]!=Ke))&&(et=!0)}var He=T.groupIdList[R],mt=Je.groupName;let Ae=Je.chemCompType;var ht=N;let ne=f.has(Ae)||!ue[M];for($=0;$<Ye;++$){var te=Je.elementList[$];if(k&&te=="H"){N+=1;continue}var se="";L&&(se=L[N]);var le="";Y&&Y[N]&&(le=String.fromCharCode(Y[N]));var Se="";if(B&&(Se=B[N]),le!=""&&le!=l&&l!="*"){N+=1;continue}var we=T.atomIdList[N],Xe=Je.atomNameList[$],je=0;Je.atomChargeList&&(je=Je.atomChargeList[$]);var K=T.xCoordList[N],xe=T.yCoordList[N],Me=T.zCoordList[N];We[N]=$e.length,$e.push({resn:mt,x:K,y:xe,z:Me,elem:te,hetflag:ne,chain:me,resi:He,icode:le,rescode:He+(le!=" "?"^"+le:""),serial:we,altLoc:le,index:N,atom:Xe,bonds:[],ss:x(nt),ssbegin:rt,ssend:et,bondOrder:[],properties:{charge:je,occupancy:Se},b:se}),N+=1}var Ze=Je.bondAtomList;for($=0,O=Je.bondOrderList.length;$<O;++$){var _e=ht+Ze[$*2],Ve=ht+Ze[$*2+1],ee=Je.bondOrderList[$],Pe=We[_e],at=We[Ve],X=$e[Pe],Re=$e[at];X&&Re&&(X.bonds.push(at),X.bondOrder.push(ee),Re.bonds.push(Pe),Re.bondOrder.push(ee))}R+=1}for(R=ke,V=0;V<Fe;++V)R+=1;M+=1}if(D)for(let Ae=ye,ne=D.length;Ae<ne;Ae+=2){let ve=D[Ae],Ne=D[Ae+1],gt=H?H[Ae/2]:1;if(ve>=N){ye=Ae;break}let ft=We[ve],vt=We[Ne],Tt=$e[ft],xr=$e[vt];Tt&&xr&&(Tt.bonds.push(vt),Tt.bondOrder.push(gt),xr.bonds.push(ft),xr.bondOrder.push(gt))}S.multimodel&&(S.onemol||u.push([]))}if(!A)for(let Ae=0;Ae<u.length;Ae++)(0,v.processSymmetries)(_[Ae].symmetries,u[Ae],S,_[Ae].cryst);return y&&!s&&(0,h.computeSecondaryStructure)(u,S.hbondCutoff),u}}),"./src/parsers/MOL2.ts":((r,e,t)=>{t.r(e),t.d(e,{MOL2:()=>c});let o={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function c(h,v){var p=[[]],g=!1;typeof v.keepH<"u"&&(g=!v.keepH);var x=h.search(/@<TRIPOS>MOLECULE/),f=h.search(/@<TRIPOS>ATOM/);if(x==-1||f==-1)return p;for(var b=h.substring(x).split(/\r?\n|\r/);b.length>0;){var C=[],S=b[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),k=parseInt(S[0]),l=0;S.length>1&&(l=parseInt(S[1]));var s=4,y;for(y=3;y<b.length;y++)if(b[y]=="@<TRIPOS>ATOM"){s=y+1;break}var A=p[p.length-1].length,E=A+k,T;for(y=A;y<E;y++){T=b[s++],S=T.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var u={},_=S[5];if(o[_]!==void 0?_=o[_]:(_=_.split(".")[0],_=_[0].toUpperCase()+_.substring(1).toLowerCase()),u.atom=S[1],u.elem=_,!(u.elem=="H"&&g)){var M=p[p.length-1].length,R=parseInt(S[0]);u.serial=R,u.x=parseFloat(S[2]),u.y=parseFloat(S[3]),u.z=parseFloat(S[4]),u.atom=S[5];var N=parseFloat(S[8]);u.index=M,u.bonds=[],u.bondOrder=[],u.properties={charge:N,partialCharge:N},C[R]=M,p[p.length-1].push(u)}}for(var I=!1;s<b.length;)if(b[s++]=="@<TRIPOS>BOND"){I=!0;break}if(I&&l)for(y=0;y<l;y++){T=b[s++],S=T.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var L=parseInt(S[1]),Y=p[p.length-1][C[L]],B=parseInt(S[2]),D=p[p.length-1][C[B]],H=parseInt(S[3]);isNaN(H)&&(H=1),Y!==void 0&&D!==void 0&&(Y.bonds.push(C[B]),Y.bondOrder.push(H),D.bonds.push(C[L]),D.bondOrder.push(H))}if(v.multimodel){v.onemol||p.push([]),b.splice(0,s),h=b.join(`
`);continue}else break}return p}}),"./src/parsers/PDB.ts":((r,e,t)=>{t.r(e),t.d(e,{PDB:()=>c});var o=t("./src/parsers/utils/getSinglePDB.ts");function c(h,v){v=v||{};var p=[],g={};p.modelData=[];for(var x=h.split(/\r?\n|\r/);x.length>0;){var f=(0,o.getSinglePDB)(x,v,g),b=f[0],C=f[1];if(x=f[2],b.length!=0){if(v.multimodel&&v.onemol&&p.length>0)for(var S=p[0].length,k=0;k<b.length;k++){var l=b[k];l.index=k;for(var s=0;s<l.bonds.length;s++)l.bonds[s]+=S;p[0].push(l)}else p.modelData.push(C),p.push(b);if(!v.multimodel)break}}return p}}),"./src/parsers/PQR.ts":((r,e,t)=>{t.r(e),t.d(e,{PQR:()=>h});var o=t("./src/parsers/utils/assignPDBBonds.ts"),c=t("./src/parsers/utils/computeSecondaryStructure.ts");function h(v,p){var g=[[]],x=!p.noSecondaryStructure;g.modelData=[{symmetries:[]}];var f=[],b=v.split(/\r?\n|\r/),C;for(let I=0;I<b.length;I++){C=b[I].replace(/^\s*/,"");var S=C.substring(0,6);if(S.indexOf("END")==0)if(p.multimodel){p.onemol||g.push([]);continue}else break;else if(S=="ATOM  "||S=="HETATM"){var k;let L=parseInt(C.substring(6,11)),Y=C.substring(12,16).replace(/ /g,""),B=C.substring(17,20).trim(),D=C.substring(21,22),H=parseInt(C.substring(22,26));var l=C.substring(30).trim().split(/\s+/),s=parseFloat(l[0]),y=parseFloat(l[1]),A=parseFloat(l[2]),E=parseFloat(l[3]),T=parseFloat(l[4]),u=Y[0];Y.length>1&&Y[1].toUpperCase()!=Y[1]&&(u=Y.substring(0,2)),C[0]=="H"?k=!0:k=!1,f[L]=g[g.length-1].length,g[g.length-1].push({resn:B,x:s,y,z:A,elem:u,hetflag:k,chain:D,resi:H,serial:L,atom:Y,bonds:[],ss:"c",bondOrder:[],properties:{charge:E,partialCharge:E,radius:T},pdbline:C})}else if(S=="CONECT"){var _=parseInt(C.substring(6,11)),M=g[g.length-1][f[_]];for(let L=0;L<4;L++){var R=parseInt(C.substring([11,16,21,26][L],[11,16,21,26][L]+5)),N=g[g.length-1][f[R]];M!==void 0&&N!==void 0&&(M.bonds.push(f[R]),M.bondOrder.push(1))}}}for(let I=0;I<g.length;I++)(0,o.assignPDBBonds)(g[I],p),x&&(0,c.computeSecondaryStructure)(g[I],p.hbondCutoff);return g}}),"./src/parsers/PRMTOP.ts":((r,e,t)=>{t.r(e),t.d(e,{PRMTOP:()=>o});function o(c){var h=[],v,p=0,g=c.split(/\r?\n|\r/);if(g.length>0&&g[0].includes("VERSION")){var x=g.filter(function(s){return s.includes("POINTERS")||s.includes("ATOM_NAME")||s.includes("CHARGE")||s.includes("RADII")||s.includes("BONDS_INC_HYDROGEN")||s.includes("BONDS_WITHOUT_HYDROGEN")}),f=k("POINTERS");if(f==-1)return[];var b=l(f),C=parseInt(g[f+1].slice(0,b[1]));if(isNaN(C)||C<=0)return[];if(f=k("ATOM_NAME"),f==-1)return[];b=l(f);var S=b[0];for(let s=0;s<C/b[0];s++){s==parseInt(C/b[0])&&(S=C%b[0]);for(let y=0;y<S;y++){let A={},E={charge:"",radii:""};A.serial=p,A.x=0,A.y=0,A.z=0,A.atom=g[f+1].slice(b[1]*y,b[1]*(y+1)).trim(),A.elem=g[f+1].slice(b[1]*y,b[1]*y+1).trim(),A.properties=E,A.bonds=[],A.bondOrder=[],h.push(A),p++}f++}if(f=k("CHARGE"),f!=-1){b=l(f),p=0,S=b[0];for(let s=0;s<C/b[0];s++){s==parseInt(C/b[0])&&(S=C%b[0]);for(let y=0;y<S;y++)h[p].properties.charge=parseFloat(g[f+1].slice(b[1]*y,b[1]*(y+1))),p++;f++}}if(f=k("RADII"),f!=-1){b=l(f),p=0,S=b[0];for(let s=0;s<C/b[0];s++){s==parseInt(C/b[0])&&(S=C%b[0]);for(let y=0;y<S;y++)h[p].properties.radii=parseFloat(g[f+1].slice(b[1]*y,b[1]*(y+1))),p++;f++}}if(f=k("BONDS_WITHOUT_HYDROGEN"),f!=-1)for(b=l(f),p=0,S=b[0],f=f+1;!g[f].match(/^%FLAG/);){g[f+1].match(/^%FLAG/)&&(S=C%b[0]);for(let s=0;s<S;s++)p%3==0?v=parseInt(g[f].slice(b[1]*s,b[1]*(s+1))/3):p%3==1&&h[v].bonds.push(parseInt(g[f].slice(b[1]*s,b[1]*(s+1))/3)),p++;f++}if(f=k("BONDS_INC_HYDROGEN"),f!=-1)for(b=l(f),p=0,S=b[0],f=f+1;!g[f].match(/^%FLAG/);){g[f+1].match(/^%FLAG/)&&(S=C%b[0]);for(let s=0;s<S;s++)p%3==0?v=parseInt(g[f].slice(b[1]*s,b[1]*(s+1))/3):p%3==1&&h[v].bonds.push(parseInt(g[f].slice(b[1]*s,b[1]*(s+1))/3)),p++;f++}}else return[];function k(s){var y=g.indexOf(x.filter(function(A){return A.includes(s)})[0]);if(Number.isInteger(y)&&y>0){for(;!g[y].includes("FORMAT");)y++;return y}else return-1}function l(s){var y=g[s].match(/\((\d*)\S*/),A=g[s].match(/[a-zA-Z](\d*)\)\s*/);return A==null&&(A=g[s].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[y[1],A[1]]}return[h]}}),"./src/parsers/SDF.ts":((r,e,t)=>{t.r(e),t.d(e,{SDF:()=>h});var o=function(v,p){var g=[[]],x=!1;for(typeof p.keepH<"u"&&(x=!p.keepH);v.length>0&&!(v.length<4);){var f=parseInt(v[3].substring(0,3));if(isNaN(f)||f<=0)break;var b=parseInt(v[3].substring(3,6)),C=4;if(v.length<4+f+b)break;var S=[],k=g[g.length-1].length,l=k+f,s,y;for(s=k;s<l;s++,C++){y=v[C];var A={},E=y.substring(31,34).replace(/ /g,"");A.atom=A.elem=E[0].toUpperCase()+E.substring(1).toLowerCase(),(A.elem!=="H"||!x)&&(A.serial=s,S[s]=g[g.length-1].length,A.x=parseFloat(y.substring(0,10)),A.y=parseFloat(y.substring(10,20)),A.z=parseFloat(y.substring(20,30)),A.hetflag=!0,A.bonds=[],A.bondOrder=[],A.properties={},A.index=g[g.length-1].length,g[g.length-1].push(A))}for(s=0;s<b;s++,C++){y=v[C];var T=S[parseInt(y.substring(0,3))-1+k],u=S[parseInt(y.substring(3,6))-1+k],_=parseFloat(y.substring(6));typeof T<"u"&&typeof u<"u"&&(g[g.length-1][T].bonds.push(u),g[g.length-1][T].bondOrder.push(_),g[g.length-1][u].bonds.push(T),g[g.length-1][u].bondOrder.push(_))}if(p.multimodel){for(p.onemol||g.push([]);v[C]!=="$$$$"&&C<v.length;)C++;v.splice(0,++C)}else break}return g},c=function(v,p){var g=[[]],x=!1;for(typeof p.keepH<"u"&&(x=!p.keepH);v.length>0&&!(v.length<8||!v[4].startsWith("M  V30 BEGIN CTAB")||!v[5].startsWith("M  V30 COUNTS")||v[5].length<14);){var f=v[5].substring(13).match(/\S+/g);if(f.length<2)break;var b=parseInt(f[0]);if(isNaN(b)||b<=0)break;var C=parseInt(f[1]),S=7;if(v.length<8+b+C)break;var k=[],l=g[g.length-1].length,s=l+b,y,A;for(y=l;y<s;y++,S++){A=v[S];var E=A.substring(6).match(/\S+/g);if(E.length>4){var T={},u=E[1].replace(/ /g,"");T.atom=T.elem=u[0].toUpperCase()+u.substring(1).toLowerCase(),(T.elem!=="H"||!x)&&(T.serial=y,k[y]=g[g.length-1].length,T.x=parseFloat(E[2]),T.y=parseFloat(E[3]),T.z=parseFloat(E[4]),T.hetflag=!0,T.bonds=[],T.bondOrder=[],T.properties={},T.index=g[g.length-1].length,g[g.length-1].push(T))}}if(v[S]==="M  V30 END ATOM")S++;else break;if(C!==0&&v[S]==="M  V30 BEGIN BOND")S++;else break;for(y=0;y<C;y++,S++){A=v[S];var _=A.substring(6).match(/\S+/g);if(_.length>3){var M=k[parseInt(_[2])-1+l],R=k[parseInt(_[3])-1+l],N=parseFloat(_[1]);typeof M<"u"&&typeof R<"u"&&(g[g.length-1][M].bonds.push(R),g[g.length-1][M].bondOrder.push(N),g[g.length-1][R].bonds.push(M),g[g.length-1][R].bondOrder.push(N))}}if(p.multimodel){for(p.onemol||g.push([]);v[S]!=="$$$$"&&S<v.length;)S++;v.splice(0,++S)}else break}return g};function h(v,p){var g="V2000",x=v.split(/\r?\n|\r/);return x.length>3&&x[3].length>38&&(g=x[3].substring(34,39)),g==="V2000"?o(x,p):g==="V3000"?c(x,p):[[""]]}}),"./src/parsers/VASP.ts":((r,e,t)=>{t.r(e),t.d(e,{VASP:()=>h});var o=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/assignBonds.ts");function h(v,p={}){var g=[[]],x={};const f=p.assignBonds===void 0?!0:p.assignBonds;var b=v.replace(/^\s+/,"").split(/\r?\n/);if(b.length<3)return g;if(b[1].match(/\d+/))x.length=parseFloat(b[1]);else return console.log("Warning: second line of the vasp structure file must be a number"),g;if(x.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),g;x.xVec=new Float32Array(b[2].replace(/^\s+/,"").split(/\s+/)),x.yVec=new Float32Array(b[3].replace(/^\s+/,"").split(/\s+/)),x.zVec=new Float32Array(b[4].replace(/^\s+/,"").split(/\s+/));var C=new o.Matrix3(x.xVec[0],x.xVec[1],x.xVec[2],x.yVec[0],x.yVec[1],x.yVec[2],x.zVec[0],x.zVec[1],x.zVec[2]);C.multiplyScalar(x.length),g.modelData=[{symmetries:[],cryst:{matrix:C}}];var S=b[5].replace(/\s+/,"").replace(/\s+$/,"").split(/\s+/),k=new Int16Array(b[6].replace(/^\s+/,"").split(/\s+/)),l=b[7].replace(/\s+/,""),s=!1;if(l.match(/S/)&&(s=!0,l=b[8].replace(/\s+/,"")),l.match(/C/))l="cartesian";else if(l.match(/D/))l="direct";else return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),g;if(S.length!=k.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(S),console.log(k),g;s?b.splice(0,9):b.splice(0,8);for(var y=0,A=0,E=S.length;A<E;A++){for(var T=S[A],u=0,_=k[A];u<_;u++){var M=new Float32Array(b[y+u].replace(/^\s+/,"").split(/\s+/)),R={};R.elem=T,l=="cartesian"?(R.x=x.length*M[0],R.y=x.length*M[1],R.z=x.length*M[2]):(R.x=x.length*(M[0]*x.xVec[0]+M[1]*x.yVec[0]+M[2]*x.zVec[0]),R.y=x.length*(M[0]*x.xVec[1]+M[1]*x.yVec[1]+M[2]*x.zVec[1]),R.z=x.length*(M[0]*x.xVec[2]+M[1]*x.yVec[2]+M[2]*x.zVec[2])),R.bonds=[],R.bondOrder=[],g[0].push(R)}y+=k[A]}if(f)for(let N=0;N<g.length;N++)(0,c.assignBonds)(g[N],p);return g}}),"./src/parsers/XYZ.ts":((r,e,t)=>{t.r(e),t.d(e,{XYZ:()=>h});var o=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/assignBonds.ts");function h(v,p){p=p||{};for(var g=[[]],x=p.assignBonds===void 0?!0:p.assignBonds,f=v.split(/\r?\n|\r/);f.length>0&&!(f.length<3);){var b=parseInt(f[0]);if(isNaN(b)||b<=0||f.length<b+2)break;var C=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi,S=C.exec(f[1]);if(S!=null&&S.length>1){var k=new Float32Array(S[1].split(/\s+/)),l=new o.Matrix3(k[0],k[3],k[6],k[1],k[4],k[7],k[2],k[5],k[8]);g.modelData=[{cryst:{matrix:l}}]}for(var s=2,y=g[g.length-1].length,A=y+b,E=y;E<A;E++){var T=f[s++],u=T.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),_={};_.serial=E;var M=u[0];_.atom=_.elem=M[0].toUpperCase()+M.substring(1,2).toLowerCase(),_.x=parseFloat(u[1]),_.y=parseFloat(u[2]),_.z=parseFloat(u[3]),_.hetflag=!0,_.bonds=[],_.bondOrder=[],_.properties={},g[g.length-1][E]=_,u.length>=7&&(_.dx=parseFloat(u[4]),_.dy=parseFloat(u[5]),_.dz=parseFloat(u[6]))}if(p.multimodel)g.push([]),f.splice(0,s);else break}if(x)for(let N=0;N<g.length;N++)(0,c.assignBonds)(g[N],p);if(p.onemol){var R=g;g=[],g.push(R[0]);for(let N=1;N<R.length;N++){let I=g[0].length;for(let L=0;L<R[N].length;L++){let Y=R[N][L];for(let B=0;B<Y.bonds.length;B++)Y.bonds[B]=Y.bonds[B]+I;Y.index=g[0].length,Y.serial=g[0].length,g[0].push(Y)}}}return g}}),"./src/parsers/cifutils/category.ts":((r,e,t)=>{t.r(e),t.d(e,{Category:()=>c});var o=t("./src/parsers/cifutils/decoder.ts");function c(h){const v=Object.create(null),p=Object.create(null);for(const g of h.columns)v[g.name]=g;return{rowCount:h.rowCount,name:h.name.substring(1),fieldNames:h.columns.map(g=>g.name),getField(g){const x=v[g];if(x)return p[g]||(p[g]=(0,o.decode)(x.data)),p[g]}}}}),"./src/parsers/cifutils/decoder.ts":((r,e,t)=>{t.r(e),t.d(e,{decode:()=>v});var o=t("./src/parsers/cifutils/encoding.ts");const c=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function h(I,L){const Y=new ArrayBuffer(I.length),B=new Uint8Array(Y);for(let D=0,H=I.length;D<H;D+=L)for(let W=0;W<L;W++)B[D+L-W-1]=I[D+W];return Y}function v(I){let L=I.data;for(let Y=I.encoding.length-1;Y>=0;Y--)L=p(L,I.encoding[Y]);return L}function p(I,L){switch(L.kind){case"ByteArray":switch(L.type){case o.Encoding.IntDataType.Uint8:return I;case o.Encoding.IntDataType.Int8:return f(I);case o.Encoding.IntDataType.Int16:return C(I);case o.Encoding.IntDataType.Uint16:return S(I);case o.Encoding.IntDataType.Int32:return k(I);case o.Encoding.IntDataType.Uint32:return l(I);case o.Encoding.FloatDataType.Float32:return s(I);case o.Encoding.FloatDataType.Float64:return y(I);default:throw new Error("unreachable")}case"FixedPoint":return A(I,L);case"IntervalQuantization":return E(I,L);case"RunLength":return T(I,L);case"Delta":return u(I,L);case"IntegerPacking":return R(I,L);case"StringArray":return N(I,L)}}function g(I,L){switch(I){case o.Encoding.IntDataType.Int8:return new Int8Array(L);case o.Encoding.IntDataType.Int16:return new Int16Array(L);case o.Encoding.IntDataType.Int32:return new Int32Array(L);case o.Encoding.IntDataType.Uint8:return new Uint8Array(L);case o.Encoding.IntDataType.Uint16:return new Uint16Array(L);case o.Encoding.IntDataType.Uint32:return new Uint32Array(L);default:return new Int32Array(L)}}function x(I,L){switch(I){case o.Encoding.FloatDataType.Float32:return new Float32Array(L);case o.Encoding.FloatDataType.Float64:return new Float64Array(L);default:return new Float64Array(L)}}function f(I){return new Int8Array(I.buffer,I.byteOffset)}function b(I,L,Y){return(I.byteOffset!=0||I.byteLength!=I.buffer.byteLength)&&(I=new Uint8Array(I)),c?new Y(I.buffer):new Y(h(I,L))}function C(I){return b(I,2,Int16Array)}function S(I){return b(I,2,Uint16Array)}function k(I){return b(I,4,Int32Array)}function l(I){return b(I,4,Uint32Array)}function s(I){return b(I,4,Float32Array)}function y(I){return b(I,8,Float64Array)}function A(I,L){const Y=I.length,B=x(L.srcType,Y),D=1/L.factor;for(let H=0;H<Y;H++)B[H]=D*I[H];return B}function E(I,L){const Y=I.length,B=x(L.srcType,Y),D=(L.max-L.min)/(L.numSteps-1),H=L.min;for(let W=0;W<Y;W++)B[W]=H+D*I[W];return B}function T(I,L){const Y=g(L.srcType,L.srcSize);let B=0;for(let D=0,H=I.length;D<H;D+=2){const W=I[D],q=I[D+1];for(let V=0;V<q;++V)Y[B++]=W}return Y}function u(I,L){const Y=I.length,B=g(L.srcType,Y);if(!Y)return I;B[0]=I[0]+(L.origin|0);for(let D=1;D<Y;++D)B[D]=I[D]+B[D-1];return B}function _(I,L){const Y=L.byteCount===1?127:32767,B=-Y-1,D=I.length,H=new Int32Array(L.srcSize);let W=0,q=0;for(;W<D;){let V=0,$=I[W];for(;$===Y||$===B;)V+=$,W++,$=I[W];V+=$,H[q]=V,W++,q++}return H}function M(I,L){const Y=L.byteCount===1?255:65535,B=I.length,D=new Int32Array(L.srcSize);let H=0,W=0;for(;H<B;){let q=0,V=I[H];for(;V===Y;)q+=V,H++,V=I[H];q+=V,D[W]=q,H++,W++}return D}function R(I,L){return I.length===L.srcSize?I:L.isUnsigned?M(I,L):_(I,L)}function N(I,L){const Y=v({encoding:L.offsetEncoding,data:L.offsets}),B=v({encoding:L.dataEncoding,data:I}),D=L.stringData,H=new Array(Y.length);H[0]="";for(let V=1,$=Y.length;V<$;V++)H[V]=D.substring(Y[V-1],Y[V]);let W=0;const q=new Array(B.length);for(let V=0,$=B.length;V<$;V++)q[W++]=H[B[V]+1];return q}}),"./src/parsers/cifutils/encoding.ts":((r,e,t)=>{t.r(e),t.d(e,{Encoding:()=>c,VERSION:()=>o});const o="0.3.0";var c;(function(h){(function(g){g[g.Int8=1]="Int8",g[g.Int16=2]="Int16",g[g.Int32=3]="Int32",g[g.Uint8=4]="Uint8",g[g.Uint16=5]="Uint16",g[g.Uint32=6]="Uint32"})(h.IntDataType||(h.IntDataType={})),(function(g){g[g.Float32=32]="Float32",g[g.Float64=33]="Float64"})(h.FloatDataType||(h.FloatDataType={}));function v(g){let x;return g instanceof Int8Array?x=h.IntDataType.Int8:g instanceof Int16Array?x=h.IntDataType.Int16:g instanceof Int32Array?x=h.IntDataType.Int32:g instanceof Uint8Array?x=h.IntDataType.Uint8:g instanceof Uint16Array?x=h.IntDataType.Uint16:g instanceof Uint32Array?x=h.IntDataType.Uint32:g instanceof Float32Array?x=h.FloatDataType.Float32:g instanceof Float64Array?x=h.FloatDataType.Float64:x=h.IntDataType.Int32,x}h.getDataType=v;function p(g){if(g instanceof Int8Array||g instanceof Int16Array||g instanceof Int32Array)return!0;for(let x=0,f=g.length;x<f;x++)if(x<0)return!1;return!0}h.isSignedIntegerDataType=p})(c||(c={}))}),"./src/parsers/index.ts":((r,e,t)=>{t.r(e),t.d(e,{Parsers:()=>A,bondLength:()=>y.bondLength,setBondLength:()=>y.setBondLength});var o=t("./src/parsers/VASP.ts"),c=t("./src/parsers/CUBE.ts"),h=t("./src/parsers/XYZ.ts"),v=t("./src/parsers/SDF.ts"),p=t("./src/parsers/CDJSON.ts"),g=t("./src/parsers/CIF.ts"),x=t("./src/parsers/MOL2.ts"),f=t("./src/parsers/PDB.ts"),b=t("./src/parsers/PQR.ts"),C=t("./src/parsers/MMTF.ts"),S=t("./src/parsers/PRMTOP.ts"),k=t("./src/parsers/GRO.ts"),l=t("./src/parsers/LAMMPSTRJ.ts"),s=t("./src/parsers/BCIF.ts"),y=t("./src/parsers/utils/bondLength.ts");const A={vasp:o.VASP,VASP:o.VASP,cube:c.CUBE,CUBE:c.CUBE,xyz:h.XYZ,XYZ:h.XYZ,sdf:v.SDF,SDF:v.SDF,json:p.CDJSON,cdjson:p.CDJSON,CDJSON:p.CDJSON,mcif:g.CIF,cif:g.CIF,CIF:g.CIF,mol2:x.MOL2,MOL2:x.MOL2,pdb:f.PDB,PDB:f.PDB,pdbqt:f.PDB,PDBQT:f.PDB,pqr:b.PQR,PQR:b.PQR,mmtf:C.MMTFparser,MMTF:C.MMTFparser,prmtop:S.PRMTOP,PRMTOP:S.PRMTOP,gro:k.GRO,GRO:k.GRO,lammpstrj:l.LAMMPSTRJ,LAMMPSTRJ:l.LAMMPSTRJ,bcif:s.BCIF,BCIF:s.BCIF}}),"./src/parsers/utils/anumToSymbol.ts":((r,e,t)=>{t.r(e),t.d(e,{anumToSymbol:()=>o});const o={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"}}),"./src/parsers/utils/areConnected.ts":((r,e,t)=>{t.r(e),t.d(e,{areConnected:()=>h});var o=t("./src/parsers/utils/bondLength.ts");const c=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function h(v,p,g){if(g&&g.unboundCations&&(c.has(v.elem)||c.has(p.elem)))return!1;let x=(0,o.bondLength)(v.elem)+(0,o.bondLength)(p.elem);x+=.25,x*=x;let f=v.x-p.x;if(f*=f,f>x)return!1;let b=v.y-p.y;if(b*=b,b>x)return!1;let C=v.z-p.z;if(C*=C,C>x)return!1;const S=f+b+C;return!(isNaN(S)||S<.5||S>x||v.altLoc!==p.altLoc&&v.altLoc.trim()!==""&&p.altLoc.trim()!=="")}}),"./src/parsers/utils/assignBackboneHBonds.ts":((r,e,t)=>{t.r(e),t.d(e,{assignBackboneHBonds:()=>o});function o(c,h){const v=h||3.2,p=v*v,g=[];for(let x=0,f=c.length;x<f;x++){c[x].index=x;const b=c[x];!b.hetflag&&(b.atom==="N"||b.atom==="O")&&(g.push(b),b.hbondOther=null,b.hbondDistanceSq=Number.POSITIVE_INFINITY)}g.sort(function(x,f){return x.z-f.z});for(let x=0,f=g.length;x<f;x++){const b=g[x];for(let C=x+1;C<f;C++){const S=g[C],k=S.z-b.z;if(k>v)break;if(S.atom==b.atom)continue;const l=Math.abs(S.y-b.y);if(l>v)continue;const s=Math.abs(S.x-b.x);if(s>v)continue;const y=s*s+l*l+k*k;y>p||S.chain==b.chain&&Math.abs(S.resi-b.resi)<4||(y<b.hbondDistanceSq&&(b.hbondOther=S,b.hbondDistanceSq=y),y<S.hbondDistanceSq&&(S.hbondOther=b,S.hbondDistanceSq=y))}}}}),"./src/parsers/utils/assignBonds.ts":((r,e,t)=>{t.r(e),t.d(e,{assignBonds:()=>v});var o=t("./src/parsers/utils/areConnected.ts");const c=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],h=4.95;function v(p,g){for(let b=0,C=p.length;b<C;b++)p[b].index||(p[b].index=b);const x={x:{y:{z:[]}}};for(let b=0;b<p.length;b++){const C=p[b],S=Math.floor(C.x/h),k=Math.floor(C.y/h),l=Math.floor(C.z/h);x[S]||(x[S]={}),x[S][k]||(x[S][k]={}),x[S][k][l]||(x[S][k][l]=[]),x[S][k][l].push(C)}function f(b,C){for(let S=0;S<b.length;S++){const k=b[S];for(let l=0;l<C.length;l++){const s=C[l];if((0,o.areConnected)(k,s,g)){const y=k.bonds.indexOf(s.index),A=s.bonds.indexOf(k.index);y===-1&&A===-1?(k.bonds.push(s.index),k.bondOrder.push(1),s.bonds.push(k.index),s.bondOrder.push(1)):y===-1?(k.bonds.push(s.index),k.bondOrder.push(s.bondOrder[A])):A===-1&&(s.bonds.push(k.index),s.bondOrder.push(k.bondOrder[y]))}}}}for(let b in x){const C=parseInt(b);for(let S in x[C]){const k=parseInt(S);for(let l in x[C][k]){const s=parseInt(l),y=x[C][k][s];for(let A=0;A<y.length;A++){const E=y[A];for(let T=A+1;T<y.length;T++){const u=y[T];(0,o.areConnected)(E,u,g)&&E.bonds.indexOf(u.index)==-1&&(E.bonds.push(u.index),E.bondOrder.push(1),u.bonds.push(E.index),u.bondOrder.push(1))}}for(let A=0;A<c.length;A++){const E=c[A];if(!x[C+E.x]||!x[C+E.x][k+E.y]||!x[C+E.x][k+E.y][s+E.z])continue;const T=x[C+E.x][k+E.y][s+E.z];f(y,T)}}}}}}),"./src/parsers/utils/assignPDBBonds.ts":((r,e,t)=>{t.r(e),t.d(e,{assignPDBBonds:()=>v});var o=t("./src/parsers/utils/areConnected.ts"),c=t("./src/parsers/utils/assignBonds.ts"),h=t("./src/parsers/utils/standardResidues.ts");function v(p,g){const x=[],f=[];for(let k=0,l=p.length;k<l;k++){const s=p[k];s.index=k,s.hetflag||!h.standardResidues.has(s.resn)?f.push(s):x.push(s)}(0,c.assignBonds)(f,g),x.sort(function(k,l){return k.chain!==l.chain?k.chain<l.chain?-1:1:k.resi-l.resi});let b=-1,C=-1,S;for(let k=0,l=x.length;k<l;k++){const s=x[k];s.resi!==b&&(b=s.resi,S||C++,S=!1),s.reschain=C;for(let y=k+1;y<x.length;y++){const A=x[y];if(A.chain!==s.chain||A.resi-s.resi>1)break;(0,o.areConnected)(s,A,g)&&(s.bonds.indexOf(A.index)===-1&&(s.bonds.push(A.index),s.bondOrder.push(1),A.bonds.push(s.index),A.bondOrder.push(1)),s.resi!==A.resi&&(S=!0))}}}}),"./src/parsers/utils/atomNameToElem.ts":((r,e,t)=>{t.r(e),t.d(e,{atomNameToElem:()=>c});var o=t("./src/parsers/utils/bondLength.ts");function c(h,v){let p=h.replace(/ /g,"");return p.length>0&&p[0]==="H"&&p!=="Hg"&&p!=="He"&&p!=="Hf"&&p!=="Hs"&&p!=="Ho"&&(p="H"),p.length>1&&(p=p[0].toUpperCase()+p.substring(1).toLowerCase(),o.bondTable[p]===void 0?p=p[0]:v&&(p==="Ca"||p==="Cd")&&(p="C")),p}}),"./src/parsers/utils/bondLength.ts":((r,e,t)=>{t.r(e),t.d(e,{bondLength:()=>c,bondTable:()=>o,setBondLength:()=>h});let o={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function c(v){return o[v]||1.6}function h(v,p){p<0&&(p=0),o[v]=p}}),"./src/parsers/utils/computeSecondaryStructure.ts":((r,e,t)=>{t.r(e),t.d(e,{computeSecondaryStructure:()=>c});var o=t("./src/parsers/utils/assignBackboneHBonds.ts");function c(h,v){(0,o.assignBackboneHBonds)(h,v);const p={};let g,x,f,b,C,S;for(g=0,x=h.length;g<x;g++)if(C=h[g],p[C.chain]===void 0&&(p[C.chain]=[]),isFinite(C.hbondDistanceSq)){const k=C.hbondOther;p[k.chain]===void 0&&(p[k.chain]=[]),Math.abs(k.resi-C.resi)===4&&(p[C.chain][C.resi]="h")}for(f in p)for(b=1;b<p[f].length-1;b++){const k=p[f][b-1],l=p[f][b+1];S=p[f][b],k=="h"&&k==l&&S!=k&&(p[f][b]=k)}for(g=0,x=h.length;g<x;g++)C=h[g],isFinite(C.hbondDistanceSq)&&p[C.chain][C.resi]!="h"&&C.ss!=="h"&&(p[C.chain][C.resi]="maybesheet");for(let k=0,l=h.length;k<l;k++)if(C=h[k],isFinite(C.hbondDistanceSq)&&p[C.chain][C.resi]=="maybesheet"){let s=C.hbondOther,y=p[s.chain][s.resi];(y=="maybesheet"||y=="s")&&(p[C.chain][C.resi]="s",p[s.chain][s.resi]="s")}for(let k in p){for(let l=1;l<p[k].length-1;l++){const s=p[k][l-1],y=p[k][l+1];S=p[k][l],s=="s"&&s==y&&S!=s&&(p[k][l]=s)}for(let l=0;l<p[k].length;l++){const s=p[k][l];(s=="h"||s=="s")&&p[k][l-1]!=s&&p[k][l+1]!=s&&delete p[k][l]}}for(g=0,x=h.length;g<x;g++)C=h[g],S=p[C.chain][C.resi],delete C.hbondOther,delete C.hbondDistanceSq,!(S===void 0||S==="maybesheet")&&(C.ss=S,p[C.chain][C.resi-1]!=S&&(C.ssbegin=!0),p[C.chain][C.resi+1]!=S&&(C.ssend=!0))}}),"./src/parsers/utils/getSinglePDB.ts":((r,e,t)=>{t.r(e),t.d(e,{getSinglePDB:()=>b});var o=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/atomNameToElem.ts"),h=t("./src/parsers/utils/bondLength.ts"),v=t("./src/parsers/utils/computeSecondaryStructure.ts"),p=t("./src/parsers/utils/isEmpty.ts"),g=t("./src/parsers/utils/processSymmetries.ts"),x=t("./src/parsers/utils/assignPDBBonds.ts"),f=t("./src/parsers/utils/validateBonds.ts");function b(C,S,k){const l=[],s=S.assignBonds===void 0?!0:S.assignBonds,y=!S.keepH,A=!!S.noSecondaryStructure,E=!S.noComputeSecondaryStructure,T=!S.doAssembly,u=S.altLoc?S.altLoc:"A",_={symmetries:[],cryst:void 0};let M,R=[];const N=[];let I;const L={};for(let Y=0;Y<C.length;Y++){I=C[Y].replace(/^\s*/,"");const B=I.substring(0,6);let D,H,W;if(B.indexOf("END")===0){if(R=C.slice(Y+1),B==="END")for(const q in k)k.hasOwnProperty(q)&&delete k[q];break}else if(B==="ATOM  "||B==="HETATM"){let q,V,$,O,j,J,oe,ie,he,de,fe,ue;if(fe=I.substring(16,17),fe!==" "&&fe!==u&&u!=="*"||(de=parseInt(I.substring(6,11)),M=I.substring(12,16).replace(/ /g,""),q=I.substring(17,20).replace(/ /g,""),V=I.substring(21,22),$=parseInt(I.substring(22,26)),O=I.substring(26,27),j=parseFloat(I.substring(30,38)),J=parseFloat(I.substring(38,46)),oe=parseFloat(I.substring(46,54)),ue=parseFloat(I.substring(60,68)),he=I.substring(76,78).replace(/ /g,""),he===""||h.bondTable[he]===void 0?he=(0,c.atomNameToElem)(I.substring(12,14),I[0]=="A"):he=he[0].toUpperCase()+he.substring(1).toLowerCase(),he==="H"&&y))continue;B[0]=="H"?ie=!0:ie=!1,N[de]=l.length,l.push({resn:q,x:j,y:J,z:oe,elem:he,hetflag:ie,altLoc:fe,chain:V,resi:$,icode:O,rescode:$+(O!==" "?"^"+O:""),serial:de,atom:M,bonds:[],ss:"c",bondOrder:[],properties:{},b:ue,pdbline:I})}else if(B==="SHEET "){D=I.substring(21,22),H=parseInt(I.substring(22,26)),W=parseInt(I.substring(33,37)),D in k||(k[D]={}),k[D][H]="s1";for(let q=H+1;q<W;q++)k[D][q]="s";k[D][W]="s2"}else if(B==="CONECT"){const q=parseInt(I.substring(6,11)),V=N[q],$=l[V],O=[11,16,21,26];for(let j=0;j<4;j++){const J=parseInt(I.substring(O[j],O[j]+5)),oe=N[J];let ie=V+":"+oe;const he=l[oe];if($!==void 0&&he!==void 0)if(!L[ie])L[ie]=1,($.bonds.length==0||$.bonds[$.bonds.length-1]!==oe)&&($.bonds.push(oe),$.bondOrder.push(1));else{L[ie]+=1;for(let de=0;de<$.bonds.length;de++)if($.bonds[de]==oe){const fe=L[ie];fe>=4?$.bondOrder[de]=1:$.bondOrder[de]=fe}}}}else if(B==="HELIX "){D=I.substring(19,20),H=parseInt(I.substring(21,25)),W=parseInt(I.substring(33,37)),D in k||(k[D]={}),k[D][H]="h1";for(let q=H+1;q<W;q++)k[D][q]="h";k[D][W]="h2"}else if(!T&&B==="REMARK"&&I.substring(13,18)==="BIOMT"){let q,V=new o.Matrix4;for(q=1;q<=3;q++)if(I=C[Y].replace(/^\s*/,""),parseInt(I.substring(18,19))==q)V.elements[q-1]=parseFloat(I.substring(23,33)),V.elements[q-1+4]=parseFloat(I.substring(33,43)),V.elements[q-1+8]=parseFloat(I.substring(43,53)),V.elements[q-1+12]=parseFloat(I.substring(53)),Y++;else for(;I.substring(13,18)==="BIOMT";)Y++,I=C[Y].replace(/^\s*/,"");V.elements[3]=0,V.elements[7]=0,V.elements[11]=0,V.elements[15]=1,_.symmetries.push(V),Y--}else if(B==="CRYST1"){let q,V,$,O,j,J;q=parseFloat(I.substring(7,15)),V=parseFloat(I.substring(16,24)),$=parseFloat(I.substring(25,33)),O=parseFloat(I.substring(34,40)),j=parseFloat(I.substring(41,47)),J=parseFloat(I.substring(48,54)),_.cryst={a:q,b:V,c:$,alpha:O,beta:j,gamma:J}}else if(B==="ANISOU"){const q=parseInt(I.substring(6,11)),V=N[q],$=l[V];if($){const O=I.substring(30).trim().split(/\s+/),j={u11:parseInt(O[0]),u22:parseInt(O[1]),u33:parseInt(O[2]),u12:parseInt(O[3]),u13:parseInt(O[4]),u23:parseInt(O[5])};$.uMat=j}}}if((0,f.validateBonds)(l,N),s&&(0,x.assignPDBBonds)(l,S),T||(0,g.processSymmetries)(_.symmetries,l,S,_.cryst),E&&!A&&(0,v.computeSecondaryStructure)(l,S.hbondCutoff),!(0,p.isEmpty)(k))for(let Y=0;Y<l.length;Y++){const B=l[Y];if(B!==void 0&&B.chain in k&&B.resi in k[B.chain]){const D=k[B.chain][B.resi];B.ss=D[0],D.length>1&&(D[1]=="1"?B.ssbegin=!0:D[1]=="2"&&(B.ssend=!0))}}return[l,_,R]}}),"./src/parsers/utils/isEmpty.ts":((r,e,t)=>{t.r(e),t.d(e,{isEmpty:()=>o});function o(c){for(const h in c)return!1;return!0}}),"./src/parsers/utils/processSymmetries.ts":((r,e,t)=>{t.r(e),t.d(e,{processSymmetries:()=>c});var o=t("./src/WebGL/index.ts");function c(h,v,p,g){const x=!p.duplicateAssemblyAtoms,f=v.length;let b=f,C=-1,S=null,k=null;(p.normalizeAssembly||p.wrapAtoms)&&g&&(S=(0,o.conversionMatrix3)(g.a,g.b,g.c,g.alpha,g.beta,g.gamma),k=new o.Matrix3,k.getInverse3(S));let l=function(A){let E=A.clone().applyMatrix3(k);const T=[E.x,E.y,E.z],u=[0,0,0];for(let M=0;M<3;M++){for(;T[M]<-.001;)T[M]+=1,u[M]+=1;for(;T[M]>1.001;)T[M]-=1,u[M]-=1}const _=new o.Vector3(u[0],u[1],u[2]);return _.applyMatrix3(S),_};if(p.normalizeAssembly&&g)for(let A=0;A<h.length;A++){const E=new o.Vector3(0,0,0);for(let u=0;u<f;u++){const _=new o.Vector3(v[u].x,v[u].y,v[u].z);_.applyMatrix4(h[A]),E.add(_)}E.divideScalar(f);const T=l(E);h[A].isNearlyIdentity()&&T.lengthSq()>.001&&(C=A),h[A].translate(T)}if(x){if(h.length>1)for(let A=0;A<v.length;A++){var s=[];for(let E=0;E<h.length;E++)if(!h[E].isNearlyIdentity()){var y=new o.Vector3;y.set(v[A].x,v[A].y,v[A].z),y.applyMatrix4(h[E]),s.push(y)}v[A].symmetries=s}}else{for(let A=0;A<f;A++)v[A].sym=-1;for(let A=0;A<h.length;A++)if(!h[A].isNearlyIdentity()&&C!=A){let E=new o.Vector3;for(let T=0;T<f;T++){const u=[];for(let M=0;M<v[T].bonds.length;M++)u.push(v[T].bonds[M]+b);if(E.set(v[T].x,v[T].y,v[T].z),E.applyMatrix4(h[A]),p.wrapAtoms&&g){let M=l(E);E.add(M)}const _={};for(const M in v[T])_[M]=v[T][M];_.x=E.x,_.y=E.y,_.z=E.z,_.bonds=u,_.sym=A,_.index=v.length,v.push(_)}b=v.length}else for(let E=0;E<f;E++)v[E].sym=A;if(p.wrapAtoms&&g){let A=new o.Vector3;for(let E=0;E<f;E++){A.set(v[E].x,v[E].y,v[E].z);let T=l(A);A.add(T),v[E].x=A.x,v[E].y=A.y,v[E].z=A.z}}if(C>=0){const A=new o.Vector3;for(let E=0;E<f;E++)A.set(v[E].x,v[E].y,v[E].z),A.applyMatrix4(h[C]),v[E].x=A.x,v[E].y=A.y,v[E].z=A.z}h.length=0}}}),"./src/parsers/utils/standardResidues.ts":((r,e,t)=>{t.r(e),t.d(e,{standardResidues:()=>o});const o=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"])}),"./src/parsers/utils/validateBonds.ts":((r,e,t)=>{t.r(e),t.d(e,{validateBonds:()=>o});function o(c,h){for(let v=0,p=c.length;v<p;v++){const g=c[v];for(let x=0;x<g.bonds.length;x++){const f=g.bonds[x],b=c[f],C=h[g.serial];b&&C&&b.bonds.indexOf(C)<0&&(b.bonds.push(C),b.bondOrder.push(g.bondOrder[x]))}}}}),"./src/partialCharges.ts":((r,e,t)=>{t.r(e),t.d(e,{applyPartialCharges:()=>c,partialCharges:()=>o});const o={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function c(h,v){if((!v||typeof h.partialCharge>"u")&&h.resn&&h.atom){var p=h.resn+":"+h.atom;h.properties.partialCharge=o[p]}}}),"./src/specs.ts":((r,e,t)=>{t.r(e)}),"./src/utilities.ts":((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/Gradient.ts"),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/VolumeData.ts"),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/colors.ts"),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/pako/dist/pako.esm.mjs");function extend(r,e){for(var t in e)e.hasOwnProperty(t)&&e[t]!==void 0&&(r[t]=e[t]);return r}function deepCopy(r){let e,t,o;if(r==null)return{};if(typeof r!="object"||r===null)return r;e=Array.isArray(r)?[]:{};for(o in r)t=r[o],e[o]=deepCopy(t);return e}function isNumeric(r){var e=typeof r;return(e==="number"||e==="string")&&!isNaN(r-parseFloat(r))}function isEmptyObject(r){var e;for(e in r)return!1;return!0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?null:callback}function adjustVolumeStyle(r){r&&(r.volformat&&!(r.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData)&&(r.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(r.voldata,r.volformat)),r.volscheme&&(r.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(r.volscheme)))}function getExtent(r,e){var t,o,c,h,v,p,g,x,f,b,C=!e;if(t=o=c=9999,h=v=p=-9999,g=x=f=b=0,r.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var S=0;S<r.length;S++){var k=r[S];if(!(typeof k>"u"||!isFinite(k.x)||!isFinite(k.y)||!isFinite(k.z))&&(b++,g+=k.x,x+=k.y,f+=k.z,t=t<k.x?t:k.x,o=o<k.y?o:k.y,c=c<k.z?c:k.z,h=h>k.x?h:k.x,v=v>k.y?v:k.y,p=p>k.z?p:k.z,k.symmetries&&C))for(var l=0;l<k.symmetries.length;l++)b++,g+=k.symmetries[l].x,x+=k.symmetries[l].y,f+=k.symmetries[l].z,t=t<k.symmetries[l].x?t:k.symmetries[l].x,o=o<k.symmetries[l].y?o:k.symmetries[l].y,c=c<k.symmetries[l].z?c:k.symmetries[l].z,h=h>k.symmetries[l].x?h:k.symmetries[l].x,v=v>k.symmetries[l].y?v:k.symmetries[l].y,p=p>k.symmetries[l].z?p:k.symmetries[l].z}return[[t,o,c],[h,v,p],[g/b,x/b,f/b]]}function getPropertyRange(r,e){for(var t=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,c=0,h=r.length;c<h;c++){var v=r[c],p=getAtomProperty(v,e);p!=null&&(p<t&&(t=p),p>o&&(o=p))}return!isFinite(t)&&!isFinite(o)?t=o=0:isFinite(t)?isFinite(o)||(o=t):t=o,[t,o]}class PausableTimer{constructor(e,t,o){this.total_time_run=0,this.fn=e,this.arg=o,this.countdown=t,this.start_time=new Date().getTime(),this.ident=setTimeout(e,t,o)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(r){for(var e=window.atob(r),t=e.length,o=new Uint8Array(t),c=0;c<t;c++)o[c]=e.charCodeAt(c);return o}function getAtomProperty(r,e){var t=null;return r.properties&&typeof r.properties[e]<"u"?t=r.properties[e]:typeof r[e]<"u"&&(t=r[e]),t}function mergeGeos(r,e){var t=e.geometry;t!==void 0&&r.geometryGroups.push(t.geometryGroups[0])}function specStringToObject(r){if(typeof r=="object"||typeof r>"u"||r==null)return r;try{return JSON.parse(r)}catch{}r=r.replace(/%7E/g,"~");var e=function(C){return isNumeric(C)?Math.floor(parseFloat(C))==parseInt(C)||C.indexOf(".")>=0?parseFloat(C):parseInt(C):C==="true"?!0:C==="false"?!1:C},t={};if(r==="all")return t;for(var o=r.split(";"),c=0;c<o.length;c++){var h=o[c].split(":"),v=h[0],p={},g=h[1];if(g)if(g=g.replace(/~/g,"="),g.indexOf("=")!==-1)for(var x=g.split(","),f=0;f<x.length;f++){var b=x[f].split("=",2);p[b[0]]=e(b[1])}else g.indexOf(",")!==-1?p=g.split(","):p=e(g);t[v]=p}return t}function checkStatus(r){if(!r.ok)throw new Error(`HTTP ${r.status} - ${r.statusText}`);return r}function get(r,e){var t=fetch(r).then(checkStatus).then(o=>o.text());return e?t.then(e):t}function getbin(r,e,t,o){var c;return t=="POST"?c=fetch(r,{method:"POST",body:o}).then(h=>checkStatus(h)).then(h=>h.arrayBuffer()):c=fetch(r).then(h=>checkStatus(h)).then(h=>h.arrayBuffer()),e?c.then(e):c}function download(r,e,t,o){var c="",h="",v="",p=null,g=e.addModel();if(r.indexOf(":")<0&&(r.length==4?r="pdb:"+r:isNaN(r)?r="url:"+r:r="cid:"+r),r.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),r="bcif:"+r.slice(5)),r.substring(0,5)==="bcif:")r=r.substring(5).toUpperCase(),v="https://models.rcsb.org/"+r+".bcif.gz",t&&typeof t.noComputeSecondaryStructure>"u"&&(t.noComputeSecondaryStructure=!0),p=new Promise(function(f){getbin(v).then(function(b){g.addMolData(b,"bcif.gz",t),e.zoomTo(),e.render(),f(g)},function(){console.error("fetch of "+v+" failed.")})});else{if(r.substring(0,4)==="pdb:"){if(c="bcif",t&&t.format&&(c=t.format),t&&typeof t.noComputeSecondaryStructure>"u"&&(t.noComputeSecondaryStructure=!0),r=r.substring(4).toUpperCase(),!r.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}c=="bcif"?v="https://models.rcsb.org/"+r.toUpperCase()+".bcif.gz":(h=t&&t.pdbUri?t.pdbUri:"https://files.rcsb.org/view/",v=h+r+"."+c)}else if(r.substring(0,4)=="cid:"){if(c="sdf",r=r.substring(4),!r.match(/^[0-9]+$/)){alert("Wrong Compound ID");return}v="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+r+"/SDF?record_type=3d"}else r.substring(0,4)=="url:"&&(v=r.substring(4),c=v);var x=function(f){g.addMolData(f,c,t),e.zoomTo(),e.render()};p=new Promise(function(f){c=="bcif"?getbin(v).then(function(b){x(b),f(g)}).catch(function(){h=t&&t.pdbUri?t.pdbUri:"https://files.rcsb.org/view/",v=h+r+".pdb",c="pdb",console.warn("falling back to pdb format"),get(v).then(function(b){x(b),f(g)}).catch(function(b){x(""),f(g),console.error("fetch of "+v+" failed: "+b.statusText)})}):get(v).then(function(b){x(b),f(g)}).catch(function(b){x(""),f(g),console.error("fetch of "+v+" failed: "+b.statusText)})})}return o?(p.then(function(f){o(f)}),g):p}function getColorFromStyle(r,e){let t=e.colorscheme;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]<"u")t=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t];else if(typeof t=="string"&&t.endsWith("Carbon")){let h=t.substring(0,t.lastIndexOf("Carbon")).toLowerCase();if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[h]<"u"){let v=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);v.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[h],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]={prop:"elem",map:v},t=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]}}let o=r.color;if(typeof e.color<"u"&&e.color!="spectrum"&&(o=e.color),typeof t<"u"){let h,v;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[t]<"u")t=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[t],typeof t[r[t.prop]]<"u"&&(o=t.map[r[t.prop]]);else if(typeof t[r[t.prop]]<"u")o=t.map[r[t.prop]];else if(typeof t.prop<"u"&&typeof t.gradient<"u"){h=t.prop;var c=t.gradient;c instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(c=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(t));let p=c.range()||[-1,1];v=getAtomProperty(r,h),v!=null&&(o=c.valueToHex(v,p))}else typeof t.prop<"u"&&typeof t.map<"u"?(h=t.prop,v=getAtomProperty(r,h),typeof t.map[v]<"u"&&(o=t.map[v])):typeof e.colorscheme[r.elem]<"u"?o=e.colorscheme[r.elem]:console.warn("Could not interpret colorscheme "+t)}else typeof e.colorfunc<"u"&&(o=e.colorfunc(r));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(o)}function getElement(r){let e=r;return typeof r=="string"?e=document.querySelector("#"+r):typeof r=="object"&&r.get&&(e=r.get(0)),e}function inflateString(r,e=!0){let t;return typeof r=="string"?t=new TextEncoder().encode(r):t=new Uint8Array(r),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(t,{to:e?"string":null})}}),"./node_modules/upng-js/UPNG.js":((r,e,t)=>{(function(){var o={},c;r.exports=o,c=t("./node_modules/upng-js/node_modules/pako/index.js"),(function(h,v){h.toRGBA8=function(p){var g=p.width,x=p.height;if(p.tabs.acTL==null)return[h.toRGBA8.decodeImage(p.data,g,x,p).buffer];var f=[];p.frames[0].data==null&&(p.frames[0].data=p.data);for(var b,C=new Uint8Array(g*x*4),S=0;S<p.frames.length;S++){var k=p.frames[S],l=k.rect.x,s=k.rect.y,y=k.rect.width,A=k.rect.height,E=h.toRGBA8.decodeImage(k.data,y,A,p);if(S==0?b=E:k.blend==0?h._copyTile(E,y,A,b,g,x,l,s,0):k.blend==1&&h._copyTile(E,y,A,b,g,x,l,s,1),f.push(b.buffer),b=b.slice(0),k.dispose!=0){if(k.dispose==1)h._copyTile(C,y,A,b,g,x,l,s,0);else if(k.dispose==2){for(var T=S-1;p.frames[T].dispose==2;)T--;b=new Uint8Array(f[T]).slice(0)}}}return f},h.toRGBA8.decodeImage=function(p,g,x,f){var b=g*x,C=h.decode._getBPP(f),S=Math.ceil(g*C/8),k=new Uint8Array(b*4),l=new Uint32Array(k.buffer),s=f.ctype,y=f.depth,A=h._bin.readUshort;if(s==6){var E=b<<2;if(y==8)for(var T=0;T<E;T++)k[T]=p[T];if(y==16)for(var T=0;T<E;T++)k[T]=p[T<<1]}else if(s==2){var u=f.tabs.tRNS,_=-1,M=-1,R=-1;if(u&&(_=u[0],M=u[1],R=u[2]),y==8)for(var T=0;T<b;T++){var N=T<<2,I=T*3;k[N]=p[I],k[N+1]=p[I+1],k[N+2]=p[I+2],k[N+3]=255,_!=-1&&p[I]==_&&p[I+1]==M&&p[I+2]==R&&(k[N+3]=0)}if(y==16)for(var T=0;T<b;T++){var N=T<<2,I=T*6;k[N]=p[I],k[N+1]=p[I+2],k[N+2]=p[I+4],k[N+3]=255,_!=-1&&A(p,I)==_&&A(p,I+2)==M&&A(p,I+4)==R&&(k[N+3]=0)}}else if(s==3){var L=f.tabs.PLTE,Y=f.tabs.tRNS,B=Y?Y.length:0;if(y==1)for(var D=0;D<x;D++)for(var H=D*S,W=D*g,T=0;T<g;T++){var N=W+T<<2,q=p[H+(T>>3)]>>7-((T&7)<<0)&1,V=3*q;k[N]=L[V],k[N+1]=L[V+1],k[N+2]=L[V+2],k[N+3]=q<B?Y[q]:255}if(y==2)for(var D=0;D<x;D++)for(var H=D*S,W=D*g,T=0;T<g;T++){var N=W+T<<2,q=p[H+(T>>2)]>>6-((T&3)<<1)&3,V=3*q;k[N]=L[V],k[N+1]=L[V+1],k[N+2]=L[V+2],k[N+3]=q<B?Y[q]:255}if(y==4)for(var D=0;D<x;D++)for(var H=D*S,W=D*g,T=0;T<g;T++){var N=W+T<<2,q=p[H+(T>>1)]>>4-((T&1)<<2)&15,V=3*q;k[N]=L[V],k[N+1]=L[V+1],k[N+2]=L[V+2],k[N+3]=q<B?Y[q]:255}if(y==8)for(var T=0;T<b;T++){var N=T<<2,q=p[T],V=3*q;k[N]=L[V],k[N+1]=L[V+1],k[N+2]=L[V+2],k[N+3]=q<B?Y[q]:255}}else if(s==4){if(y==8)for(var T=0;T<b;T++){var N=T<<2,$=T<<1,O=p[$];k[N]=O,k[N+1]=O,k[N+2]=O,k[N+3]=p[$+1]}if(y==16)for(var T=0;T<b;T++){var N=T<<2,$=T<<2,O=p[$];k[N]=O,k[N+1]=O,k[N+2]=O,k[N+3]=p[$+2]}}else if(s==0){var _=f.tabs.tRNS?f.tabs.tRNS:-1;if(y==1)for(var T=0;T<b;T++){var O=255*(p[T>>3]>>7-(T&7)&1),j=O==_*255?0:255;l[T]=j<<24|O<<16|O<<8|O}if(y==2)for(var T=0;T<b;T++){var O=85*(p[T>>2]>>6-((T&3)<<1)&3),j=O==_*85?0:255;l[T]=j<<24|O<<16|O<<8|O}if(y==4)for(var T=0;T<b;T++){var O=17*(p[T>>1]>>4-((T&1)<<2)&15),j=O==_*17?0:255;l[T]=j<<24|O<<16|O<<8|O}if(y==8)for(var T=0;T<b;T++){var O=p[T],j=O==_?0:255;l[T]=j<<24|O<<16|O<<8|O}if(y==16)for(var T=0;T<b;T++){var O=p[T<<1],j=A(p,T<<1)==_?0:255;l[T]=j<<24|O<<16|O<<8|O}}return k},h.decode=function(p){for(var g=new Uint8Array(p),x=8,f=h._bin,b=f.readUshort,C=f.readUint,S={tabs:{},frames:[]},k=new Uint8Array(g.length),l=0,s,y=0,A=[137,80,78,71,13,10,26,10],E=0;E<8;E++)if(g[E]!=A[E])throw"The input is not a PNG file!";for(;x<g.length;){var T=f.readUint(g,x);x+=4;var u=f.readASCII(g,x,4);if(x+=4,u=="IHDR")h.decode._IHDR(g,x,S);else if(u=="IDAT"){for(var E=0;E<T;E++)k[l+E]=g[x+E];l+=T}else if(u=="acTL")S.tabs[u]={num_frames:C(g,x),num_plays:C(g,x+4)},s=new Uint8Array(g.length);else if(u=="fcTL"){if(y!=0){var _=S.frames[S.frames.length-1];_.data=h.decode._decompress(S,s.slice(0,y),_.rect.width,_.rect.height),y=0}var M={x:C(g,x+12),y:C(g,x+16),width:C(g,x+4),height:C(g,x+8)},R=b(g,x+22);R=b(g,x+20)/(R==0?100:R);var N={rect:M,delay:Math.round(R*1e3),dispose:g[x+24],blend:g[x+25]};S.frames.push(N)}else if(u=="fdAT"){for(var E=0;E<T-4;E++)s[y+E]=g[x+E+4];y+=T-4}else if(u=="pHYs")S.tabs[u]=[f.readUint(g,x),f.readUint(g,x+4),g[x+8]];else if(u=="cHRM"){S.tabs[u]=[];for(var E=0;E<8;E++)S.tabs[u].push(f.readUint(g,x+E*4))}else if(u=="tEXt"){S.tabs[u]==null&&(S.tabs[u]={});var I=f.nextZero(g,x),L=f.readASCII(g,x,I-x),Y=f.readASCII(g,I+1,x+T-I-1);S.tabs[u][L]=Y}else if(u=="iTXt"){S.tabs[u]==null&&(S.tabs[u]={});var I=0,B=x;I=f.nextZero(g,B);var L=f.readASCII(g,B,I-B);B=I+1,g[B],g[B+1],B+=2,I=f.nextZero(g,B),f.readASCII(g,B,I-B),B=I+1,I=f.nextZero(g,B),f.readUTF8(g,B,I-B),B=I+1;var Y=f.readUTF8(g,B,T-(B-x));S.tabs[u][L]=Y}else if(u=="PLTE")S.tabs[u]=f.readBytes(g,x,T);else if(u=="hIST"){var D=S.tabs.PLTE.length/3;S.tabs[u]=[];for(var E=0;E<D;E++)S.tabs[u].push(b(g,x+E*2))}else if(u=="tRNS")S.ctype==3?S.tabs[u]=f.readBytes(g,x,T):S.ctype==0?S.tabs[u]=b(g,x):S.ctype==2&&(S.tabs[u]=[b(g,x),b(g,x+2),b(g,x+4)]);else if(u=="gAMA")S.tabs[u]=f.readUint(g,x)/1e5;else if(u=="sRGB")S.tabs[u]=g[x];else if(u=="bKGD")S.ctype==0||S.ctype==4?S.tabs[u]=[b(g,x)]:S.ctype==2||S.ctype==6?S.tabs[u]=[b(g,x),b(g,x+2),b(g,x+4)]:S.ctype==3&&(S.tabs[u]=g[x]);else if(u=="IEND"){if(y!=0){var _=S.frames[S.frames.length-1];_.data=h.decode._decompress(S,s.slice(0,y),_.rect.width,_.rect.height),y=0}S.data=h.decode._decompress(S,k,S.width,S.height);break}x+=T,f.readUint(g,x),x+=4}return delete S.compress,delete S.interlace,delete S.filter,S},h.decode._decompress=function(p,g,x,f){return p.compress==0&&(g=h.decode._inflate(g)),p.interlace==0?g=h.decode._filterZero(g,p,0,x,f):p.interlace==1&&(g=h.decode._readInterlace(g,p)),g},h.decode._inflate=function(p){return v.inflate(p)},h.decode._readInterlace=function(p,g){for(var x=g.width,f=g.height,b=h.decode._getBPP(g),C=b>>3,S=Math.ceil(x*b/8),k=new Uint8Array(f*S),l=0,s=[0,0,4,0,2,0,1],y=[0,4,0,2,0,1,0],A=[8,8,8,4,4,2,2],E=[8,8,4,4,2,2,1],T=0;T<7;){for(var u=A[T],_=E[T],M=0,R=0,N=s[T];N<f;)N+=u,R++;for(var I=y[T];I<x;)I+=_,M++;var L=Math.ceil(M*b/8);h.decode._filterZero(p,g,l,M,R);for(var Y=0,B=s[T];B<f;){for(var D=y[T],H=l+Y*L<<3;D<x;){if(b==1){var W=p[H>>3];W=W>>7-(H&7)&1,k[B*S+(D>>3)]|=W<<7-((D&3)<<0)}if(b==2){var W=p[H>>3];W=W>>6-(H&7)&3,k[B*S+(D>>2)]|=W<<6-((D&3)<<1)}if(b==4){var W=p[H>>3];W=W>>4-(H&7)&15,k[B*S+(D>>1)]|=W<<4-((D&1)<<2)}if(b>=8)for(var q=B*S+D*C,V=0;V<C;V++)k[q+V]=p[(H>>3)+V];H+=b,D+=_}Y++,B+=u}M*R!=0&&(l+=R*(1+L)),T=T+1}return k},h.decode._getBPP=function(p){var g=[1,null,3,1,2,null,4][p.ctype];return g*p.depth},h.decode._filterZero=function(p,g,x,f,b){var C=h.decode._getBPP(g),S=Math.ceil(f*C/8),k=h.decode._paeth;C=Math.ceil(C/8);for(var l=0;l<b;l++){var s=x+l*S,y=s+l+1,A=p[y-1];if(A==0)for(var E=0;E<S;E++)p[s+E]=p[y+E];else if(A==1){for(var E=0;E<C;E++)p[s+E]=p[y+E];for(var E=C;E<S;E++)p[s+E]=p[y+E]+p[s+E-C]&255}else if(l==0){for(var E=0;E<C;E++)p[s+E]=p[y+E];if(A==2)for(var E=C;E<S;E++)p[s+E]=p[y+E]&255;if(A==3)for(var E=C;E<S;E++)p[s+E]=p[y+E]+(p[s+E-C]>>1)&255;if(A==4)for(var E=C;E<S;E++)p[s+E]=p[y+E]+k(p[s+E-C],0,0)&255}else{if(A==2)for(var E=0;E<S;E++)p[s+E]=p[y+E]+p[s+E-S]&255;if(A==3){for(var E=0;E<C;E++)p[s+E]=p[y+E]+(p[s+E-S]>>1)&255;for(var E=C;E<S;E++)p[s+E]=p[y+E]+(p[s+E-S]+p[s+E-C]>>1)&255}if(A==4){for(var E=0;E<C;E++)p[s+E]=p[y+E]+k(0,p[s+E-S],0)&255;for(var E=C;E<S;E++)p[s+E]=p[y+E]+k(p[s+E-C],p[s+E-S],p[s+E-C-S])&255}}}return p},h.decode._paeth=function(p,g,x){var f=p+g-x,b=Math.abs(f-p),C=Math.abs(f-g),S=Math.abs(f-x);return b<=C&&b<=S?p:C<=S?g:x},h.decode._IHDR=function(p,g,x){var f=h._bin;x.width=f.readUint(p,g),g+=4,x.height=f.readUint(p,g),g+=4,x.depth=p[g],g++,x.ctype=p[g],g++,x.compress=p[g],g++,x.filter=p[g],g++,x.interlace=p[g],g++},h._bin={nextZero:function(p,g){for(;p[g]!=0;)g++;return g},readUshort:function(p,g){return p[g]<<8|p[g+1]},writeUshort:function(p,g,x){p[g]=x>>8&255,p[g+1]=x&255},readUint:function(p,g){return p[g]*16777216+(p[g+1]<<16|p[g+2]<<8|p[g+3])},writeUint:function(p,g,x){p[g]=x>>24&255,p[g+1]=x>>16&255,p[g+2]=x>>8&255,p[g+3]=x&255},readASCII:function(p,g,x){for(var f="",b=0;b<x;b++)f+=String.fromCharCode(p[g+b]);return f},writeASCII:function(p,g,x){for(var f=0;f<x.length;f++)p[g+f]=x.charCodeAt(f)},readBytes:function(p,g,x){for(var f=[],b=0;b<x;b++)f.push(p[g+b]);return f},pad:function(p){return p.length<2?"0"+p:p},readUTF8:function(p,g,x){for(var f="",b,C=0;C<x;C++)f+="%"+h._bin.pad(p[g+C].toString(16));try{b=decodeURIComponent(f)}catch{return h._bin.readASCII(p,g,x)}return b}},h._copyTile=function(p,g,x,f,b,C,S,k,l){for(var s=Math.min(g,b),y=Math.min(x,C),A=0,E=0,T=0;T<y;T++)for(var u=0;u<s;u++)if(S>=0&&k>=0?(A=T*g+u<<2,E=(k+T)*b+S+u<<2):(A=(-k+T)*g-S+u<<2,E=T*b+u<<2),l==0)f[E]=p[A],f[E+1]=p[A+1],f[E+2]=p[A+2],f[E+3]=p[A+3];else if(l==1){var _=p[A+3]*.00392156862745098,M=p[A]*_,R=p[A+1]*_,N=p[A+2]*_,I=f[E+3]*(1/255),L=f[E]*I,Y=f[E+1]*I,B=f[E+2]*I,D=1-_,H=_+I*D,W=H==0?0:1/H;f[E+3]=255*H,f[E+0]=(M+L*D)*W,f[E+1]=(R+Y*D)*W,f[E+2]=(N+B*D)*W}else if(l==2){var _=p[A+3],M=p[A],R=p[A+1],N=p[A+2],I=f[E+3],L=f[E],Y=f[E+1],B=f[E+2];_==I&&M==L&&R==Y&&N==B?(f[E]=0,f[E+1]=0,f[E+2]=0,f[E+3]=0):(f[E]=M,f[E+1]=R,f[E+2]=N,f[E+3]=_)}else if(l==3){var _=p[A+3],M=p[A],R=p[A+1],N=p[A+2],I=f[E+3],L=f[E],Y=f[E+1],B=f[E+2];if(_==I&&M==L&&R==Y&&N==B)continue;if(_<220&&I>20)return!1}return!0},h.encode=function(p,g,x,f,b,C){f==null&&(f=0),C==null&&(C=!1);for(var S=new Uint8Array(p[0].byteLength*p.length+100),k=[137,80,78,71,13,10,26,10],l=0;l<8;l++)S[l]=k[l];var s=8,y=h._bin,A=h.crc.crc,E=y.writeUint,T=y.writeUshort,u=y.writeASCII,_=h.encode.compressPNG(p,g,x,f,C);E(S,s,13),s+=4,u(S,s,"IHDR"),s+=4,E(S,s,g),s+=4,E(S,s,x),s+=4,S[s]=_.depth,s++,S[s]=_.ctype,s++,S[s]=0,s++,S[s]=0,s++,S[s]=0,s++,E(S,s,A(S,s-17,17)),s+=4,E(S,s,1),s+=4,u(S,s,"sRGB"),s+=4,S[s]=1,s++,E(S,s,A(S,s-5,5)),s+=4;var M=p.length>1;if(M&&(E(S,s,8),s+=4,u(S,s,"acTL"),s+=4,E(S,s,p.length),s+=4,E(S,s,0),s+=4,E(S,s,A(S,s-12,12)),s+=4),_.ctype==3){var R=_.plte.length;E(S,s,R*3),s+=4,u(S,s,"PLTE"),s+=4;for(var l=0;l<R;l++){var N=l*3,I=_.plte[l],L=I&255,Y=I>>8&255,B=I>>16&255;S[s+N+0]=L,S[s+N+1]=Y,S[s+N+2]=B}if(s+=R*3,E(S,s,A(S,s-R*3-4,R*3+4)),s+=4,_.gotAlpha){E(S,s,R),s+=4,u(S,s,"tRNS"),s+=4;for(var l=0;l<R;l++)S[s+l]=_.plte[l]>>24&255;s+=R,E(S,s,A(S,s-R-4,R+4)),s+=4}}for(var D=0,H=0;H<_.frames.length;H++){var W=_.frames[H];M&&(E(S,s,26),s+=4,u(S,s,"fcTL"),s+=4,E(S,s,D++),s+=4,E(S,s,W.rect.width),s+=4,E(S,s,W.rect.height),s+=4,E(S,s,W.rect.x),s+=4,E(S,s,W.rect.y),s+=4,T(S,s,b[H]),s+=2,T(S,s,1e3),s+=2,S[s]=W.dispose,s++,S[s]=W.blend,s++,E(S,s,A(S,s-30,30)),s+=4);var q=W.cimg,R=q.length;E(S,s,R+(H==0?0:4)),s+=4;var V=s;u(S,s,H==0?"IDAT":"fdAT"),s+=4,H!=0&&(E(S,s,D++),s+=4);for(var l=0;l<R;l++)S[s+l]=q[l];s+=R,E(S,s,A(S,V,s-V)),s+=4}return E(S,s,0),s+=4,u(S,s,"IEND"),s+=4,E(S,s,A(S,s-4,4)),s+=4,S.buffer.slice(0,s)},h.encode.compressPNG=function(p,g,x,f,b){for(var C=h.encode.compress(p,g,x,f,!1,b),S=0;S<p.length;S++){var k=C.frames[S];k.rect.width;var l=k.rect.height,s=k.bpl,y=k.bpp,A=new Uint8Array(l*s+l);k.cimg=h.encode._filterZero(k.img,l,y,s,A)}return C},h.encode.compress=function(p,g,x,f,b,C){C==null&&(C=!1);for(var S=6,k=8,l=4,s=255,y=0;y<p.length;y++)for(var A=new Uint8Array(p[y]),E=A.length,T=0;T<E;T+=4)s&=A[T+3];var u=s!=255,_={},M=[];if(p.length!=0&&(_[0]=0,M.push(0),f!=0&&f--),f!=0){var R=h.quantize(p,f,b);p=R.bufs;for(var T=0;T<R.plte.length;T++){var N=R.plte[T].est.rgba;_[N]==null&&(_[N]=M.length,M.push(N))}}else for(var y=0;y<p.length;y++)for(var I=new Uint32Array(p[y]),E=I.length,T=0;T<E;T++){var N=I[T];if((T<g||N!=I[T-1]&&N!=I[T-g])&&_[N]==null&&(_[N]=M.length,M.push(N),M.length>=300))break}var L=u?b:!1,Y=M.length;Y<=256&&C==!1&&(Y<=2?k=1:Y<=4?k=2:Y<=16?k=4:k=8,b&&(k=8),u=!0);for(var B=[],y=0;y<p.length;y++){var D=new Uint8Array(p[y]),H=new Uint32Array(D.buffer),W=0,q=0,V=g,$=x,O=0;if(y!=0&&!L){for(var j=b||y==1||B[B.length-2].dispose==2?1:2,J=0,oe=1e9,ie=0;ie<j;ie++){for(var Fe=new Uint8Array(p[y-1-ie]),he=new Uint32Array(p[y-1-ie]),de=g,fe=x,ue=-1,ye=-1,ze=0;ze<x;ze++)for(var $e=0;$e<g;$e++){var T=ze*g+$e;H[T]!=he[T]&&($e<de&&(de=$e),$e>ue&&(ue=$e),ze<fe&&(fe=ze),ze>ye&&(ye=ze))}var We=ue==-1?1:(ue-de+1)*(ye-fe+1);We<oe&&(oe=We,J=ie,ue==-1?(W=q=0,V=$=1):(W=de,q=fe,V=ue-de+1,$=ye-fe+1))}var Fe=new Uint8Array(p[y-1-J]);J==1&&(B[B.length-1].dispose=2);var me=new Uint8Array(V*$*4);new Uint32Array(me.buffer),h._copyTile(Fe,g,x,me,V,$,-W,-q,0),h._copyTile(D,g,x,me,V,$,-W,-q,3)?(h._copyTile(D,g,x,me,V,$,-W,-q,2),O=1):(h._copyTile(D,g,x,me,V,$,-W,-q,0),O=0),D=me,H=new Uint32Array(D.buffer)}var ke=4*V;if(Y<=256&&C==!1){ke=Math.ceil(k*V/8);for(var me=new Uint8Array(ke*$),ze=0;ze<$;ze++){var T=ze*ke,Qe=ze*V;if(k==8)for(var $e=0;$e<V;$e++)me[T+$e]=_[H[Qe+$e]];else if(k==4)for(var $e=0;$e<V;$e++)me[T+($e>>1)]|=_[H[Qe+$e]]<<4-($e&1)*4;else if(k==2)for(var $e=0;$e<V;$e++)me[T+($e>>2)]|=_[H[Qe+$e]]<<6-($e&3)*2;else if(k==1)for(var $e=0;$e<V;$e++)me[T+($e>>3)]|=_[H[Qe+$e]]<<7-($e&7)*1}D=me,S=3,l=1}else if(u==!1&&p.length==1){for(var me=new Uint8Array(V*$*3),Je=V*$,T=0;T<Je;T++){var Ye=T*3,nt=T*4;me[Ye]=D[nt],me[Ye+1]=D[nt+1],me[Ye+2]=D[nt+2]}D=me,S=2,l=3,ke=3*V}B.push({rect:{x:W,y:q,width:V,height:$},img:D,bpl:ke,bpp:l,blend:O,dispose:L?1:0})}return{ctype:S,depth:k,plte:M,gotAlpha:u,frames:B}},h.encode._filterZero=function(p,g,x,f,b){for(var C=[],S=0;S<5;S++)if(!(g*f>5e5&&(S==2||S==3||S==4))){for(var k=0;k<g;k++)h.encode._filterLine(b,p,k,f,x,S);if(C.push(v.deflate(b)),x==1)break}for(var l,s=1e9,y=0;y<C.length;y++)C[y].length<s&&(l=y,s=C[y].length);return C[l]},h.encode._filterLine=function(p,g,x,f,b,C){var S=x*f,k=S+x,l=h.decode._paeth;if(p[k]=C,k++,C==0)for(var s=0;s<f;s++)p[k+s]=g[S+s];else if(C==1){for(var s=0;s<b;s++)p[k+s]=g[S+s];for(var s=b;s<f;s++)p[k+s]=g[S+s]-g[S+s-b]+256&255}else if(x==0){for(var s=0;s<b;s++)p[k+s]=g[S+s];if(C==2)for(var s=b;s<f;s++)p[k+s]=g[S+s];if(C==3)for(var s=b;s<f;s++)p[k+s]=g[S+s]-(g[S+s-b]>>1)+256&255;if(C==4)for(var s=b;s<f;s++)p[k+s]=g[S+s]-l(g[S+s-b],0,0)+256&255}else{if(C==2)for(var s=0;s<f;s++)p[k+s]=g[S+s]+256-g[S+s-f]&255;if(C==3){for(var s=0;s<b;s++)p[k+s]=g[S+s]+256-(g[S+s-f]>>1)&255;for(var s=b;s<f;s++)p[k+s]=g[S+s]+256-(g[S+s-f]+g[S+s-b]>>1)&255}if(C==4){for(var s=0;s<b;s++)p[k+s]=g[S+s]+256-l(0,g[S+s-f],0)&255;for(var s=b;s<f;s++)p[k+s]=g[S+s]+256-l(g[S+s-b],g[S+s-f],g[S+s-b-f])&255}}},h.crc={table:(function(){for(var p=new Uint32Array(256),g=0;g<256;g++){for(var x=g,f=0;f<8;f++)x&1?x=3988292384^x>>>1:x=x>>>1;p[g]=x}return p})(),update:function(p,g,x,f){for(var b=0;b<f;b++)p=h.crc.table[(p^g[x+b])&255]^p>>>8;return p},crc:function(p,g,x){return h.crc.update(4294967295,p,g,x)^4294967295}},h.quantize=function(p,g,x){for(var f=[],b=0,C=0;C<p.length;C++)f.push(h.encode.alphaMul(new Uint8Array(p[C]),x)),b+=p[C].byteLength;for(var S=new Uint8Array(b),k=new Uint32Array(S.buffer),l=0,C=0;C<f.length;C++){for(var s=f[C],y=s.length,A=0;A<y;A++)S[l+A]=s[A];l+=y}var E={i0:0,i1:S.length,bst:null,est:null,tdst:0,left:null,right:null};E.bst=h.quantize.stats(S,E.i0,E.i1),E.est=h.quantize.estats(E.bst);for(var T=[E];T.length<g;){for(var u=0,_=0,C=0;C<T.length;C++)T[C].est.L>u&&(u=T[C].est.L,_=C);if(u<.001)break;var M=T[_],R=h.quantize.splitPixels(S,k,M.i0,M.i1,M.est.e,M.est.eMq255),N={i0:M.i0,i1:R,bst:null,est:null,tdst:0,left:null,right:null};N.bst=h.quantize.stats(S,N.i0,N.i1),N.est=h.quantize.estats(N.bst);var I={i0:R,i1:M.i1,bst:null,est:null,tdst:0,left:null,right:null};I.bst={R:[],m:[],N:M.bst.N-N.bst.N};for(var C=0;C<16;C++)I.bst.R[C]=M.bst.R[C]-N.bst.R[C];for(var C=0;C<4;C++)I.bst.m[C]=M.bst.m[C]-N.bst.m[C];I.est=h.quantize.estats(I.bst),M.left=N,M.right=I,T[_]=N,T.push(I)}T.sort(function(j,J){return J.bst.N-j.bst.N});for(var L=0;L<f.length;L++){for(var Y=h.quantize.planeDst,B=new Uint8Array(f[L].buffer),D=new Uint32Array(f[L].buffer),H=B.length,C=0;C<H;C+=4){for(var W=B[C]*.00392156862745098,q=B[C+1]*.00392156862745098,V=B[C+2]*.00392156862745098,$=B[C+3]*.00392156862745098,O=E;O.left;)O=Y(O.est,W,q,V,$)<=0?O.left:O.right;D[C>>2]=O.est.rgba}f[L]=D.buffer}return{bufs:f,plte:T}},h.quantize.getNearest=function(p,g,x,f,b){if(p.left==null)return p.tdst=h.quantize.dist(p.est.q,g,x,f,b),p;var C=h.quantize.planeDst(p.est,g,x,f,b),S=p.left,k=p.right;C>0&&(S=p.right,k=p.left);var l=h.quantize.getNearest(S,g,x,f,b);if(l.tdst<=C*C)return l;var s=h.quantize.getNearest(k,g,x,f,b);return s.tdst<l.tdst?s:l},h.quantize.planeDst=function(p,g,x,f,b){var C=p.e;return C[0]*g+C[1]*x+C[2]*f+C[3]*b-p.eMq},h.quantize.dist=function(p,g,x,f,b){var C=g-p[0],S=x-p[1],k=f-p[2],l=b-p[3];return C*C+S*S+k*k+l*l},h.quantize.splitPixels=function(p,g,x,f,b,C){var S=h.quantize.vecDot;for(f-=4;x<f;){for(;S(p,x,b)<=C;)x+=4;for(;S(p,f,b)>C;)f-=4;if(x>=f)break;var k=g[x>>2];g[x>>2]=g[f>>2],g[f>>2]=k,x+=4,f-=4}for(;S(p,x,b)>C;)x-=4;return x+4},h.quantize.vecDot=function(p,g,x){return p[g]*x[0]+p[g+1]*x[1]+p[g+2]*x[2]+p[g+3]*x[3]},h.quantize.stats=function(p,g,x){for(var f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=[0,0,0,0],C=x-g>>2,S=g;S<x;S+=4){var k=p[S]*.00392156862745098,l=p[S+1]*(1/255),s=p[S+2]*(1/255),y=p[S+3]*(1/255);b[0]+=k,b[1]+=l,b[2]+=s,b[3]+=y,f[0]+=k*k,f[1]+=k*l,f[2]+=k*s,f[3]+=k*y,f[5]+=l*l,f[6]+=l*s,f[7]+=l*y,f[10]+=s*s,f[11]+=s*y,f[15]+=y*y}return f[4]=f[1],f[8]=f[2],f[12]=f[3],f[9]=f[6],f[13]=f[7],f[14]=f[11],{R:f,m:b,N:C}},h.quantize.estats=function(p){var g=p.R,x=p.m,f=p.N,b=x[0],C=x[1],S=x[2],k=x[3],l=f==0?0:1/f,s=[g[0]-b*b*l,g[1]-b*C*l,g[2]-b*S*l,g[3]-b*k*l,g[4]-C*b*l,g[5]-C*C*l,g[6]-C*S*l,g[7]-C*k*l,g[8]-S*b*l,g[9]-S*C*l,g[10]-S*S*l,g[11]-S*k*l,g[12]-k*b*l,g[13]-k*C*l,g[14]-k*S*l,g[15]-k*k*l],y=s,A=h.M4,E=[.5,.5,.5,.5],T=0,u=0;if(f!=0)for(var _=0;_<10&&(E=A.multVec(y,E),u=Math.sqrt(A.dot(E,E)),E=A.sml(1/u,E),!(Math.abs(u-T)<1e-9));_++)T=u;var M=[b*l,C*l,S*l,k*l],R=A.dot(A.sml(255,M),E),N=M[3]<.001?0:1/M[3];return{Cov:s,q:M,e:E,L:T,eMq255:R,eMq:A.dot(E,M),rgba:(Math.round(255*M[3])<<24|Math.round(255*M[2]*N)<<16|Math.round(255*M[1]*N)<<8|Math.round(255*M[0]*N)<<0)>>>0}},h.M4={multVec:function(p,g){return[p[0]*g[0]+p[1]*g[1]+p[2]*g[2]+p[3]*g[3],p[4]*g[0]+p[5]*g[1]+p[6]*g[2]+p[7]*g[3],p[8]*g[0]+p[9]*g[1]+p[10]*g[2]+p[11]*g[3],p[12]*g[0]+p[13]*g[1]+p[14]*g[2]+p[15]*g[3]]},dot:function(p,g){return p[0]*g[0]+p[1]*g[1]+p[2]*g[2]+p[3]*g[3]},sml:function(p,g){return[p*g[0],p*g[1],p*g[2],p*g[3]]}},h.encode.alphaMul=function(p,g){for(var x=new Uint8Array(p.length),f=p.length>>2,b=0;b<f;b++){var C=b<<2,S=p[C+3];g&&(S=S<128?0:255);var k=S*(1/255);x[C+0]=p[C+0]*k,x[C+1]=p[C+1]*k,x[C+2]=p[C+2]*k,x[C+3]=S}return x}})(o,c)})()}),"./node_modules/upng-js/node_modules/pako/index.js":((r,e,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js").assign,c=t("./node_modules/upng-js/node_modules/pako/lib/deflate.js"),h=t("./node_modules/upng-js/node_modules/pako/lib/inflate.js"),v=t("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),p={};o(p,c,h,v),r.exports=p}),"./node_modules/upng-js/node_modules/pako/lib/deflate.js":((r,e,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),h=t("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),v=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),p=t("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),g=Object.prototype.toString,x=0,f=4,b=0,C=1,S=2,k=-1,l=0,s=8;function y(u){if(!(this instanceof y))return new y(u);this.options=c.assign({level:k,method:s,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},u||{});var _=this.options;_.raw&&_.windowBits>0?_.windowBits=-_.windowBits:_.gzip&&_.windowBits>0&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var M=o.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(M!==b)throw new Error(v[M]);if(_.header&&o.deflateSetHeader(this.strm,_.header),_.dictionary){var R;if(typeof _.dictionary=="string"?R=h.string2buf(_.dictionary):g.call(_.dictionary)==="[object ArrayBuffer]"?R=new Uint8Array(_.dictionary):R=_.dictionary,M=o.deflateSetDictionary(this.strm,R),M!==b)throw new Error(v[M]);this._dict_set=!0}}y.prototype.push=function(u,_){var M=this.strm,R=this.options.chunkSize,N,I;if(this.ended)return!1;I=_===~~_?_:_===!0?f:x,typeof u=="string"?M.input=h.string2buf(u):g.call(u)==="[object ArrayBuffer]"?M.input=new Uint8Array(u):M.input=u,M.next_in=0,M.avail_in=M.input.length;do{if(M.avail_out===0&&(M.output=new c.Buf8(R),M.next_out=0,M.avail_out=R),N=o.deflate(M,I),N!==C&&N!==b)return this.onEnd(N),this.ended=!0,!1;(M.avail_out===0||M.avail_in===0&&(I===f||I===S))&&(this.options.to==="string"?this.onData(h.buf2binstring(c.shrinkBuf(M.output,M.next_out))):this.onData(c.shrinkBuf(M.output,M.next_out)))}while((M.avail_in>0||M.avail_out===0)&&N!==C);return I===f?(N=o.deflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===b):(I===S&&(this.onEnd(b),M.avail_out=0),!0)},y.prototype.onData=function(u){this.chunks.push(u)},y.prototype.onEnd=function(u){u===b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=u,this.msg=this.strm.msg};function A(u,_){var M=new y(_);if(M.push(u,!0),M.err)throw M.msg||v[M.err];return M.result}function E(u,_){return _=_||{},_.raw=!0,A(u,_)}function T(u,_){return _=_||{},_.gzip=!0,A(u,_)}e.Deflate=y,e.deflate=A,e.deflateRaw=E,e.gzip=T}),"./node_modules/upng-js/node_modules/pako/lib/inflate.js":((r,e,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),h=t("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),v=t("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),p=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),g=t("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),x=t("./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js"),f=Object.prototype.toString;function b(k){if(!(this instanceof b))return new b(k);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},k||{});var l=this.options;l.raw&&l.windowBits>=0&&l.windowBits<16&&(l.windowBits=-l.windowBits,l.windowBits===0&&(l.windowBits=-15)),l.windowBits>=0&&l.windowBits<16&&!(k&&k.windowBits)&&(l.windowBits+=32),l.windowBits>15&&l.windowBits<48&&(l.windowBits&15||(l.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var s=o.inflateInit2(this.strm,l.windowBits);if(s!==v.Z_OK)throw new Error(p[s]);if(this.header=new x,o.inflateGetHeader(this.strm,this.header),l.dictionary&&(typeof l.dictionary=="string"?l.dictionary=h.string2buf(l.dictionary):f.call(l.dictionary)==="[object ArrayBuffer]"&&(l.dictionary=new Uint8Array(l.dictionary)),l.raw&&(s=o.inflateSetDictionary(this.strm,l.dictionary),s!==v.Z_OK)))throw new Error(p[s])}b.prototype.push=function(k,l){var s=this.strm,y=this.options.chunkSize,A=this.options.dictionary,E,T,u,_,M,R=!1;if(this.ended)return!1;T=l===~~l?l:l===!0?v.Z_FINISH:v.Z_NO_FLUSH,typeof k=="string"?s.input=h.binstring2buf(k):f.call(k)==="[object ArrayBuffer]"?s.input=new Uint8Array(k):s.input=k,s.next_in=0,s.avail_in=s.input.length;do{if(s.avail_out===0&&(s.output=new c.Buf8(y),s.next_out=0,s.avail_out=y),E=o.inflate(s,v.Z_NO_FLUSH),E===v.Z_NEED_DICT&&A&&(E=o.inflateSetDictionary(this.strm,A)),E===v.Z_BUF_ERROR&&R===!0&&(E=v.Z_OK,R=!1),E!==v.Z_STREAM_END&&E!==v.Z_OK)return this.onEnd(E),this.ended=!0,!1;s.next_out&&(s.avail_out===0||E===v.Z_STREAM_END||s.avail_in===0&&(T===v.Z_FINISH||T===v.Z_SYNC_FLUSH))&&(this.options.to==="string"?(u=h.utf8border(s.output,s.next_out),_=s.next_out-u,M=h.buf2string(s.output,u),s.next_out=_,s.avail_out=y-_,_&&c.arraySet(s.output,s.output,u,_,0),this.onData(M)):this.onData(c.shrinkBuf(s.output,s.next_out))),s.avail_in===0&&s.avail_out===0&&(R=!0)}while((s.avail_in>0||s.avail_out===0)&&E!==v.Z_STREAM_END);return E===v.Z_STREAM_END&&(T=v.Z_FINISH),T===v.Z_FINISH?(E=o.inflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===v.Z_OK):(T===v.Z_SYNC_FLUSH&&(this.onEnd(v.Z_OK),s.avail_out=0),!0)},b.prototype.onData=function(k){this.chunks.push(k)},b.prototype.onEnd=function(k){k===v.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=k,this.msg=this.strm.msg};function C(k,l){var s=new b(l);if(s.push(k,!0),s.err)throw s.msg||p[s.err];return s.result}function S(k,l){return l=l||{},l.raw=!0,C(k,l)}e.Inflate=b,e.inflate=C,e.inflateRaw=S,e.ungzip=C}),"./node_modules/upng-js/node_modules/pako/lib/utils/common.js":((r,e)=>{var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function o(v,p){return Object.prototype.hasOwnProperty.call(v,p)}e.assign=function(v){for(var p=Array.prototype.slice.call(arguments,1);p.length;){var g=p.shift();if(g){if(typeof g!="object")throw new TypeError(g+"must be non-object");for(var x in g)o(g,x)&&(v[x]=g[x])}}return v},e.shrinkBuf=function(v,p){return v.length===p?v:v.subarray?v.subarray(0,p):(v.length=p,v)};var c={arraySet:function(v,p,g,x,f){if(p.subarray&&v.subarray){v.set(p.subarray(g,g+x),f);return}for(var b=0;b<x;b++)v[f+b]=p[g+b]},flattenChunks:function(v){var p,g,x,f,b,C;for(x=0,p=0,g=v.length;p<g;p++)x+=v[p].length;for(C=new Uint8Array(x),f=0,p=0,g=v.length;p<g;p++)b=v[p],C.set(b,f),f+=b.length;return C}},h={arraySet:function(v,p,g,x,f){for(var b=0;b<x;b++)v[f+b]=p[g+b]},flattenChunks:function(v){return[].concat.apply([],v)}};e.setTyped=function(v){v?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,c)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,h))},e.setTyped(t)}),"./node_modules/upng-js/node_modules/pako/lib/utils/strings.js":((r,e,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=!0,h=!0;try{String.fromCharCode.apply(null,[0])}catch{c=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{h=!1}for(var v=new o.Buf8(256),p=0;p<256;p++)v[p]=p>=252?6:p>=248?5:p>=240?4:p>=224?3:p>=192?2:1;v[254]=v[254]=1,e.string2buf=function(x){var f,b,C,S,k,l=x.length,s=0;for(S=0;S<l;S++)b=x.charCodeAt(S),(b&64512)===55296&&S+1<l&&(C=x.charCodeAt(S+1),(C&64512)===56320&&(b=65536+(b-55296<<10)+(C-56320),S++)),s+=b<128?1:b<2048?2:b<65536?3:4;for(f=new o.Buf8(s),k=0,S=0;k<s;S++)b=x.charCodeAt(S),(b&64512)===55296&&S+1<l&&(C=x.charCodeAt(S+1),(C&64512)===56320&&(b=65536+(b-55296<<10)+(C-56320),S++)),b<128?f[k++]=b:b<2048?(f[k++]=192|b>>>6,f[k++]=128|b&63):b<65536?(f[k++]=224|b>>>12,f[k++]=128|b>>>6&63,f[k++]=128|b&63):(f[k++]=240|b>>>18,f[k++]=128|b>>>12&63,f[k++]=128|b>>>6&63,f[k++]=128|b&63);return f};function g(x,f){if(f<65534&&(x.subarray&&h||!x.subarray&&c))return String.fromCharCode.apply(null,o.shrinkBuf(x,f));for(var b="",C=0;C<f;C++)b+=String.fromCharCode(x[C]);return b}e.buf2binstring=function(x){return g(x,x.length)},e.binstring2buf=function(x){for(var f=new o.Buf8(x.length),b=0,C=f.length;b<C;b++)f[b]=x.charCodeAt(b);return f},e.buf2string=function(x,f){var b,C,S,k,l=f||x.length,s=new Array(l*2);for(C=0,b=0;b<l;){if(S=x[b++],S<128){s[C++]=S;continue}if(k=v[S],k>4){s[C++]=65533,b+=k-1;continue}for(S&=k===2?31:k===3?15:7;k>1&&b<l;)S=S<<6|x[b++]&63,k--;if(k>1){s[C++]=65533;continue}S<65536?s[C++]=S:(S-=65536,s[C++]=55296|S>>10&1023,s[C++]=56320|S&1023)}return g(s,C)},e.utf8border=function(x,f){var b;for(f=f||x.length,f>x.length&&(f=x.length),b=f-1;b>=0&&(x[b]&192)===128;)b--;return b<0||b===0?f:b+v[x[b]]>f?b:f}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js":(r=>{function e(t,o,c,h){for(var v=t&65535|0,p=t>>>16&65535|0,g=0;c!==0;){g=c>2e3?2e3:c,c-=g;do v=v+o[h++]|0,p=p+v|0;while(--g);v%=65521,p%=65521}return v|p<<16|0}r.exports=e}),"./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js":(r=>{r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js":(r=>{function e(){for(var c,h=[],v=0;v<256;v++){c=v;for(var p=0;p<8;p++)c=c&1?3988292384^c>>>1:c>>>1;h[v]=c}return h}var t=e();function o(c,h,v,p){var g=t,x=p+v;c^=-1;for(var f=p;f<x;f++)c=c>>>8^g[(c^h[f])&255];return c^-1}r.exports=o}),"./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js":((r,e,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js"),h=t("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),v=t("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),p=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),g=0,x=1,f=3,b=4,C=5,S=0,k=1,l=-2,s=-3,y=-5,A=-1,E=1,T=2,u=3,_=4,M=0,R=2,N=8,I=9,L=15,Y=8,B=29,D=256,H=D+1+B,W=30,q=19,V=2*H+1,$=15,O=3,j=258,J=j+O+1,oe=32,ie=42,he=69,de=73,fe=91,ue=103,ye=113,ze=666,$e=1,We=2,Fe=3,me=4,ke=3;function Qe(X,Re){return X.msg=p[Re],Re}function Je(X){return(X<<1)-(X>4?9:0)}function Ye(X){for(var Re=X.length;--Re>=0;)X[Re]=0}function nt(X){var Re=X.state,Ae=Re.pending;Ae>X.avail_out&&(Ae=X.avail_out),Ae!==0&&(o.arraySet(X.output,Re.pending_buf,Re.pending_out,Ae,X.next_out),X.next_out+=Ae,Re.pending_out+=Ae,X.total_out+=Ae,X.avail_out-=Ae,Re.pending-=Ae,Re.pending===0&&(Re.pending_out=0))}function rt(X,Re){c._tr_flush_block(X,X.block_start>=0?X.block_start:-1,X.strstart-X.block_start,Re),X.block_start=X.strstart,nt(X.strm)}function et(X,Re){X.pending_buf[X.pending++]=Re}function Ke(X,Re){X.pending_buf[X.pending++]=Re>>>8&255,X.pending_buf[X.pending++]=Re&255}function Ue(X,Re,Ae,ne){var ve=X.avail_in;return ve>ne&&(ve=ne),ve===0?0:(X.avail_in-=ve,o.arraySet(Re,X.input,X.next_in,ve,Ae),X.state.wrap===1?X.adler=h(X.adler,Re,ve,Ae):X.state.wrap===2&&(X.adler=v(X.adler,Re,ve,Ae)),X.next_in+=ve,X.total_in+=ve,ve)}function He(X,Re){var Ae=X.max_chain_length,ne=X.strstart,ve,Ne,gt=X.prev_length,ft=X.nice_match,vt=X.strstart>X.w_size-J?X.strstart-(X.w_size-J):0,Tt=X.window,xr=X.w_mask,Bt=X.prev,jt=X.strstart+j,qt=Tt[ne+gt-1],mr=Tt[ne+gt];X.prev_length>=X.good_match&&(Ae>>=2),ft>X.lookahead&&(ft=X.lookahead);do if(ve=Re,!(Tt[ve+gt]!==mr||Tt[ve+gt-1]!==qt||Tt[ve]!==Tt[ne]||Tt[++ve]!==Tt[ne+1])){ne+=2,ve++;do;while(Tt[++ne]===Tt[++ve]&&Tt[++ne]===Tt[++ve]&&Tt[++ne]===Tt[++ve]&&Tt[++ne]===Tt[++ve]&&Tt[++ne]===Tt[++ve]&&Tt[++ne]===Tt[++ve]&&Tt[++ne]===Tt[++ve]&&Tt[++ne]===Tt[++ve]&&ne<jt);if(Ne=j-(jt-ne),ne=jt-j,Ne>gt){if(X.match_start=Re,gt=Ne,Ne>=ft)break;qt=Tt[ne+gt-1],mr=Tt[ne+gt]}}while((Re=Bt[Re&xr])>vt&&--Ae!==0);return gt<=X.lookahead?gt:X.lookahead}function mt(X){var Re=X.w_size,Ae,ne,ve,Ne,gt;do{if(Ne=X.window_size-X.lookahead-X.strstart,X.strstart>=Re+(Re-J)){o.arraySet(X.window,X.window,Re,Re,0),X.match_start-=Re,X.strstart-=Re,X.block_start-=Re,ne=X.hash_size,Ae=ne;do ve=X.head[--Ae],X.head[Ae]=ve>=Re?ve-Re:0;while(--ne);ne=Re,Ae=ne;do ve=X.prev[--Ae],X.prev[Ae]=ve>=Re?ve-Re:0;while(--ne);Ne+=Re}if(X.strm.avail_in===0)break;if(ne=Ue(X.strm,X.window,X.strstart+X.lookahead,Ne),X.lookahead+=ne,X.lookahead+X.insert>=O)for(gt=X.strstart-X.insert,X.ins_h=X.window[gt],X.ins_h=(X.ins_h<<X.hash_shift^X.window[gt+1])&X.hash_mask;X.insert&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[gt+O-1])&X.hash_mask,X.prev[gt&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=gt,gt++,X.insert--,!(X.lookahead+X.insert<O)););}while(X.lookahead<J&&X.strm.avail_in!==0)}function ht(X,Re){var Ae=65535;for(Ae>X.pending_buf_size-5&&(Ae=X.pending_buf_size-5);;){if(X.lookahead<=1){if(mt(X),X.lookahead===0&&Re===g)return $e;if(X.lookahead===0)break}X.strstart+=X.lookahead,X.lookahead=0;var ne=X.block_start+Ae;if((X.strstart===0||X.strstart>=ne)&&(X.lookahead=X.strstart-ne,X.strstart=ne,rt(X,!1),X.strm.avail_out===0)||X.strstart-X.block_start>=X.w_size-J&&(rt(X,!1),X.strm.avail_out===0))return $e}return X.insert=0,Re===b?(rt(X,!0),X.strm.avail_out===0?Fe:me):(X.strstart>X.block_start&&(rt(X,!1),X.strm.avail_out),$e)}function te(X,Re){for(var Ae,ne;;){if(X.lookahead<J){if(mt(X),X.lookahead<J&&Re===g)return $e;if(X.lookahead===0)break}if(Ae=0,X.lookahead>=O&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+O-1])&X.hash_mask,Ae=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart),Ae!==0&&X.strstart-Ae<=X.w_size-J&&(X.match_length=He(X,Ae)),X.match_length>=O)if(ne=c._tr_tally(X,X.strstart-X.match_start,X.match_length-O),X.lookahead-=X.match_length,X.match_length<=X.max_lazy_match&&X.lookahead>=O){X.match_length--;do X.strstart++,X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+O-1])&X.hash_mask,Ae=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart;while(--X.match_length!==0);X.strstart++}else X.strstart+=X.match_length,X.match_length=0,X.ins_h=X.window[X.strstart],X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+1])&X.hash_mask;else ne=c._tr_tally(X,0,X.window[X.strstart]),X.lookahead--,X.strstart++;if(ne&&(rt(X,!1),X.strm.avail_out===0))return $e}return X.insert=X.strstart<O-1?X.strstart:O-1,Re===b?(rt(X,!0),X.strm.avail_out===0?Fe:me):X.last_lit&&(rt(X,!1),X.strm.avail_out===0)?$e:We}function se(X,Re){for(var Ae,ne,ve;;){if(X.lookahead<J){if(mt(X),X.lookahead<J&&Re===g)return $e;if(X.lookahead===0)break}if(Ae=0,X.lookahead>=O&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+O-1])&X.hash_mask,Ae=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart),X.prev_length=X.match_length,X.prev_match=X.match_start,X.match_length=O-1,Ae!==0&&X.prev_length<X.max_lazy_match&&X.strstart-Ae<=X.w_size-J&&(X.match_length=He(X,Ae),X.match_length<=5&&(X.strategy===E||X.match_length===O&&X.strstart-X.match_start>4096)&&(X.match_length=O-1)),X.prev_length>=O&&X.match_length<=X.prev_length){ve=X.strstart+X.lookahead-O,ne=c._tr_tally(X,X.strstart-1-X.prev_match,X.prev_length-O),X.lookahead-=X.prev_length-1,X.prev_length-=2;do++X.strstart<=ve&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+O-1])&X.hash_mask,Ae=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart);while(--X.prev_length!==0);if(X.match_available=0,X.match_length=O-1,X.strstart++,ne&&(rt(X,!1),X.strm.avail_out===0))return $e}else if(X.match_available){if(ne=c._tr_tally(X,0,X.window[X.strstart-1]),ne&&rt(X,!1),X.strstart++,X.lookahead--,X.strm.avail_out===0)return $e}else X.match_available=1,X.strstart++,X.lookahead--}return X.match_available&&(ne=c._tr_tally(X,0,X.window[X.strstart-1]),X.match_available=0),X.insert=X.strstart<O-1?X.strstart:O-1,Re===b?(rt(X,!0),X.strm.avail_out===0?Fe:me):X.last_lit&&(rt(X,!1),X.strm.avail_out===0)?$e:We}function le(X,Re){for(var Ae,ne,ve,Ne,gt=X.window;;){if(X.lookahead<=j){if(mt(X),X.lookahead<=j&&Re===g)return $e;if(X.lookahead===0)break}if(X.match_length=0,X.lookahead>=O&&X.strstart>0&&(ve=X.strstart-1,ne=gt[ve],ne===gt[++ve]&&ne===gt[++ve]&&ne===gt[++ve])){Ne=X.strstart+j;do;while(ne===gt[++ve]&&ne===gt[++ve]&&ne===gt[++ve]&&ne===gt[++ve]&&ne===gt[++ve]&&ne===gt[++ve]&&ne===gt[++ve]&&ne===gt[++ve]&&ve<Ne);X.match_length=j-(Ne-ve),X.match_length>X.lookahead&&(X.match_length=X.lookahead)}if(X.match_length>=O?(Ae=c._tr_tally(X,1,X.match_length-O),X.lookahead-=X.match_length,X.strstart+=X.match_length,X.match_length=0):(Ae=c._tr_tally(X,0,X.window[X.strstart]),X.lookahead--,X.strstart++),Ae&&(rt(X,!1),X.strm.avail_out===0))return $e}return X.insert=0,Re===b?(rt(X,!0),X.strm.avail_out===0?Fe:me):X.last_lit&&(rt(X,!1),X.strm.avail_out===0)?$e:We}function Se(X,Re){for(var Ae;;){if(X.lookahead===0&&(mt(X),X.lookahead===0)){if(Re===g)return $e;break}if(X.match_length=0,Ae=c._tr_tally(X,0,X.window[X.strstart]),X.lookahead--,X.strstart++,Ae&&(rt(X,!1),X.strm.avail_out===0))return $e}return X.insert=0,Re===b?(rt(X,!0),X.strm.avail_out===0?Fe:me):X.last_lit&&(rt(X,!1),X.strm.avail_out===0)?$e:We}function we(X,Re,Ae,ne,ve){this.good_length=X,this.max_lazy=Re,this.nice_length=Ae,this.max_chain=ne,this.func=ve}var Xe;Xe=[new we(0,0,0,0,ht),new we(4,4,8,4,te),new we(4,5,16,8,te),new we(4,6,32,32,te),new we(4,4,16,16,se),new we(8,16,32,32,se),new we(8,16,128,128,se),new we(8,32,128,256,se),new we(32,128,258,1024,se),new we(32,258,258,4096,se)];function je(X){X.window_size=2*X.w_size,Ye(X.head),X.max_lazy_match=Xe[X.level].max_lazy,X.good_match=Xe[X.level].good_length,X.nice_match=Xe[X.level].nice_length,X.max_chain_length=Xe[X.level].max_chain,X.strstart=0,X.block_start=0,X.lookahead=0,X.insert=0,X.match_length=X.prev_length=O-1,X.match_available=0,X.ins_h=0}function K(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=N,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(V*2),this.dyn_dtree=new o.Buf16((2*W+1)*2),this.bl_tree=new o.Buf16((2*q+1)*2),Ye(this.dyn_ltree),Ye(this.dyn_dtree),Ye(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16($+1),this.heap=new o.Buf16(2*H+1),Ye(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*H+1),Ye(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function xe(X){var Re;return!X||!X.state?Qe(X,l):(X.total_in=X.total_out=0,X.data_type=R,Re=X.state,Re.pending=0,Re.pending_out=0,Re.wrap<0&&(Re.wrap=-Re.wrap),Re.status=Re.wrap?ie:ye,X.adler=Re.wrap===2?0:1,Re.last_flush=g,c._tr_init(Re),S)}function Me(X){var Re=xe(X);return Re===S&&je(X.state),Re}function Ze(X,Re){return!X||!X.state||X.state.wrap!==2?l:(X.state.gzhead=Re,S)}function _e(X,Re,Ae,ne,ve,Ne){if(!X)return l;var gt=1;if(Re===A&&(Re=6),ne<0?(gt=0,ne=-ne):ne>15&&(gt=2,ne-=16),ve<1||ve>I||Ae!==N||ne<8||ne>15||Re<0||Re>9||Ne<0||Ne>_)return Qe(X,l);ne===8&&(ne=9);var ft=new K;return X.state=ft,ft.strm=X,ft.wrap=gt,ft.gzhead=null,ft.w_bits=ne,ft.w_size=1<<ft.w_bits,ft.w_mask=ft.w_size-1,ft.hash_bits=ve+7,ft.hash_size=1<<ft.hash_bits,ft.hash_mask=ft.hash_size-1,ft.hash_shift=~~((ft.hash_bits+O-1)/O),ft.window=new o.Buf8(ft.w_size*2),ft.head=new o.Buf16(ft.hash_size),ft.prev=new o.Buf16(ft.w_size),ft.lit_bufsize=1<<ve+6,ft.pending_buf_size=ft.lit_bufsize*4,ft.pending_buf=new o.Buf8(ft.pending_buf_size),ft.d_buf=1*ft.lit_bufsize,ft.l_buf=3*ft.lit_bufsize,ft.level=Re,ft.strategy=Ne,ft.method=Ae,Me(X)}function Ve(X,Re){return _e(X,Re,N,L,Y,M)}function ee(X,Re){var Ae,ne,ve,Ne;if(!X||!X.state||Re>C||Re<0)return X?Qe(X,l):l;if(ne=X.state,!X.output||!X.input&&X.avail_in!==0||ne.status===ze&&Re!==b)return Qe(X,X.avail_out===0?y:l);if(ne.strm=X,Ae=ne.last_flush,ne.last_flush=Re,ne.status===ie)if(ne.wrap===2)X.adler=0,et(ne,31),et(ne,139),et(ne,8),ne.gzhead?(et(ne,(ne.gzhead.text?1:0)+(ne.gzhead.hcrc?2:0)+(ne.gzhead.extra?4:0)+(ne.gzhead.name?8:0)+(ne.gzhead.comment?16:0)),et(ne,ne.gzhead.time&255),et(ne,ne.gzhead.time>>8&255),et(ne,ne.gzhead.time>>16&255),et(ne,ne.gzhead.time>>24&255),et(ne,ne.level===9?2:ne.strategy>=T||ne.level<2?4:0),et(ne,ne.gzhead.os&255),ne.gzhead.extra&&ne.gzhead.extra.length&&(et(ne,ne.gzhead.extra.length&255),et(ne,ne.gzhead.extra.length>>8&255)),ne.gzhead.hcrc&&(X.adler=v(X.adler,ne.pending_buf,ne.pending,0)),ne.gzindex=0,ne.status=he):(et(ne,0),et(ne,0),et(ne,0),et(ne,0),et(ne,0),et(ne,ne.level===9?2:ne.strategy>=T||ne.level<2?4:0),et(ne,ke),ne.status=ye);else{var gt=N+(ne.w_bits-8<<4)<<8,ft=-1;ne.strategy>=T||ne.level<2?ft=0:ne.level<6?ft=1:ne.level===6?ft=2:ft=3,gt|=ft<<6,ne.strstart!==0&&(gt|=oe),gt+=31-gt%31,ne.status=ye,Ke(ne,gt),ne.strstart!==0&&(Ke(ne,X.adler>>>16),Ke(ne,X.adler&65535)),X.adler=1}if(ne.status===he)if(ne.gzhead.extra){for(ve=ne.pending;ne.gzindex<(ne.gzhead.extra.length&65535)&&!(ne.pending===ne.pending_buf_size&&(ne.gzhead.hcrc&&ne.pending>ve&&(X.adler=v(X.adler,ne.pending_buf,ne.pending-ve,ve)),nt(X),ve=ne.pending,ne.pending===ne.pending_buf_size));)et(ne,ne.gzhead.extra[ne.gzindex]&255),ne.gzindex++;ne.gzhead.hcrc&&ne.pending>ve&&(X.adler=v(X.adler,ne.pending_buf,ne.pending-ve,ve)),ne.gzindex===ne.gzhead.extra.length&&(ne.gzindex=0,ne.status=de)}else ne.status=de;if(ne.status===de)if(ne.gzhead.name){ve=ne.pending;do{if(ne.pending===ne.pending_buf_size&&(ne.gzhead.hcrc&&ne.pending>ve&&(X.adler=v(X.adler,ne.pending_buf,ne.pending-ve,ve)),nt(X),ve=ne.pending,ne.pending===ne.pending_buf_size)){Ne=1;break}ne.gzindex<ne.gzhead.name.length?Ne=ne.gzhead.name.charCodeAt(ne.gzindex++)&255:Ne=0,et(ne,Ne)}while(Ne!==0);ne.gzhead.hcrc&&ne.pending>ve&&(X.adler=v(X.adler,ne.pending_buf,ne.pending-ve,ve)),Ne===0&&(ne.gzindex=0,ne.status=fe)}else ne.status=fe;if(ne.status===fe)if(ne.gzhead.comment){ve=ne.pending;do{if(ne.pending===ne.pending_buf_size&&(ne.gzhead.hcrc&&ne.pending>ve&&(X.adler=v(X.adler,ne.pending_buf,ne.pending-ve,ve)),nt(X),ve=ne.pending,ne.pending===ne.pending_buf_size)){Ne=1;break}ne.gzindex<ne.gzhead.comment.length?Ne=ne.gzhead.comment.charCodeAt(ne.gzindex++)&255:Ne=0,et(ne,Ne)}while(Ne!==0);ne.gzhead.hcrc&&ne.pending>ve&&(X.adler=v(X.adler,ne.pending_buf,ne.pending-ve,ve)),Ne===0&&(ne.status=ue)}else ne.status=ue;if(ne.status===ue&&(ne.gzhead.hcrc?(ne.pending+2>ne.pending_buf_size&&nt(X),ne.pending+2<=ne.pending_buf_size&&(et(ne,X.adler&255),et(ne,X.adler>>8&255),X.adler=0,ne.status=ye)):ne.status=ye),ne.pending!==0){if(nt(X),X.avail_out===0)return ne.last_flush=-1,S}else if(X.avail_in===0&&Je(Re)<=Je(Ae)&&Re!==b)return Qe(X,y);if(ne.status===ze&&X.avail_in!==0)return Qe(X,y);if(X.avail_in!==0||ne.lookahead!==0||Re!==g&&ne.status!==ze){var vt=ne.strategy===T?Se(ne,Re):ne.strategy===u?le(ne,Re):Xe[ne.level].func(ne,Re);if((vt===Fe||vt===me)&&(ne.status=ze),vt===$e||vt===Fe)return X.avail_out===0&&(ne.last_flush=-1),S;if(vt===We&&(Re===x?c._tr_align(ne):Re!==C&&(c._tr_stored_block(ne,0,0,!1),Re===f&&(Ye(ne.head),ne.lookahead===0&&(ne.strstart=0,ne.block_start=0,ne.insert=0))),nt(X),X.avail_out===0))return ne.last_flush=-1,S}return Re!==b?S:ne.wrap<=0?k:(ne.wrap===2?(et(ne,X.adler&255),et(ne,X.adler>>8&255),et(ne,X.adler>>16&255),et(ne,X.adler>>24&255),et(ne,X.total_in&255),et(ne,X.total_in>>8&255),et(ne,X.total_in>>16&255),et(ne,X.total_in>>24&255)):(Ke(ne,X.adler>>>16),Ke(ne,X.adler&65535)),nt(X),ne.wrap>0&&(ne.wrap=-ne.wrap),ne.pending!==0?S:k)}function Pe(X){var Re;return!X||!X.state?l:(Re=X.state.status,Re!==ie&&Re!==he&&Re!==de&&Re!==fe&&Re!==ue&&Re!==ye&&Re!==ze?Qe(X,l):(X.state=null,Re===ye?Qe(X,s):S))}function at(X,Re){var Ae=Re.length,ne,ve,Ne,gt,ft,vt,Tt,xr;if(!X||!X.state||(ne=X.state,gt=ne.wrap,gt===2||gt===1&&ne.status!==ie||ne.lookahead))return l;for(gt===1&&(X.adler=h(X.adler,Re,Ae,0)),ne.wrap=0,Ae>=ne.w_size&&(gt===0&&(Ye(ne.head),ne.strstart=0,ne.block_start=0,ne.insert=0),xr=new o.Buf8(ne.w_size),o.arraySet(xr,Re,Ae-ne.w_size,ne.w_size,0),Re=xr,Ae=ne.w_size),ft=X.avail_in,vt=X.next_in,Tt=X.input,X.avail_in=Ae,X.next_in=0,X.input=Re,mt(ne);ne.lookahead>=O;){ve=ne.strstart,Ne=ne.lookahead-(O-1);do ne.ins_h=(ne.ins_h<<ne.hash_shift^ne.window[ve+O-1])&ne.hash_mask,ne.prev[ve&ne.w_mask]=ne.head[ne.ins_h],ne.head[ne.ins_h]=ve,ve++;while(--Ne);ne.strstart=ve,ne.lookahead=O-1,mt(ne)}return ne.strstart+=ne.lookahead,ne.block_start=ne.strstart,ne.insert=ne.lookahead,ne.lookahead=0,ne.match_length=ne.prev_length=O-1,ne.match_available=0,X.next_in=vt,X.input=Tt,X.avail_in=ft,ne.wrap=gt,S}e.deflateInit=Ve,e.deflateInit2=_e,e.deflateReset=Me,e.deflateResetKeep=xe,e.deflateSetHeader=Ze,e.deflate=ee,e.deflateEnd=Pe,e.deflateSetDictionary=at,e.deflateInfo="pako deflate (from Nodeca project)"}),"./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js":(r=>{function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}r.exports=e}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js":(r=>{var e=30,t=12;r.exports=function(o,c){var h,v,p,g,x,f,b,C,S,k,l,s,y,A,E,T,u,_,M,R,N,I,L,Y,B;h=o.state,v=o.next_in,Y=o.input,p=v+(o.avail_in-5),g=o.next_out,B=o.output,x=g-(c-o.avail_out),f=g+(o.avail_out-257),b=h.dmax,C=h.wsize,S=h.whave,k=h.wnext,l=h.window,s=h.hold,y=h.bits,A=h.lencode,E=h.distcode,T=(1<<h.lenbits)-1,u=(1<<h.distbits)-1;e:do{y<15&&(s+=Y[v++]<<y,y+=8,s+=Y[v++]<<y,y+=8),_=A[s&T];t:for(;;){if(M=_>>>24,s>>>=M,y-=M,M=_>>>16&255,M===0)B[g++]=_&65535;else if(M&16){R=_&65535,M&=15,M&&(y<M&&(s+=Y[v++]<<y,y+=8),R+=s&(1<<M)-1,s>>>=M,y-=M),y<15&&(s+=Y[v++]<<y,y+=8,s+=Y[v++]<<y,y+=8),_=E[s&u];r:for(;;){if(M=_>>>24,s>>>=M,y-=M,M=_>>>16&255,M&16){if(N=_&65535,M&=15,y<M&&(s+=Y[v++]<<y,y+=8,y<M&&(s+=Y[v++]<<y,y+=8)),N+=s&(1<<M)-1,N>b){o.msg="invalid distance too far back",h.mode=e;break e}if(s>>>=M,y-=M,M=g-x,N>M){if(M=N-M,M>S&&h.sane){o.msg="invalid distance too far back",h.mode=e;break e}if(I=0,L=l,k===0){if(I+=C-M,M<R){R-=M;do B[g++]=l[I++];while(--M);I=g-N,L=B}}else if(k<M){if(I+=C+k-M,M-=k,M<R){R-=M;do B[g++]=l[I++];while(--M);if(I=0,k<R){M=k,R-=M;do B[g++]=l[I++];while(--M);I=g-N,L=B}}}else if(I+=k-M,M<R){R-=M;do B[g++]=l[I++];while(--M);I=g-N,L=B}for(;R>2;)B[g++]=L[I++],B[g++]=L[I++],B[g++]=L[I++],R-=3;R&&(B[g++]=L[I++],R>1&&(B[g++]=L[I++]))}else{I=g-N;do B[g++]=B[I++],B[g++]=B[I++],B[g++]=B[I++],R-=3;while(R>2);R&&(B[g++]=B[I++],R>1&&(B[g++]=B[I++]))}}else if(M&64){o.msg="invalid distance code",h.mode=e;break e}else{_=E[(_&65535)+(s&(1<<M)-1)];continue r}break}}else if(M&64)if(M&32){h.mode=t;break e}else{o.msg="invalid literal/length code",h.mode=e;break e}else{_=A[(_&65535)+(s&(1<<M)-1)];continue t}break}}while(v<p&&g<f);R=y>>3,v-=R,y-=R<<3,s&=(1<<y)-1,o.next_in=v,o.next_out=g,o.avail_in=v<p?5+(p-v):5-(v-p),o.avail_out=g<f?257+(f-g):257-(g-f),h.hold=s,h.bits=y}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js":((r,e,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),h=t("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),v=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js"),p=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js"),g=0,x=1,f=2,b=4,C=5,S=6,k=0,l=1,s=2,y=-2,A=-3,E=-4,T=-5,u=8,_=1,M=2,R=3,N=4,I=5,L=6,Y=7,B=8,D=9,H=10,W=11,q=12,V=13,$=14,O=15,j=16,J=17,oe=18,ie=19,he=20,de=21,fe=22,ue=23,ye=24,ze=25,$e=26,We=27,Fe=28,me=29,ke=30,Qe=31,Je=32,Ye=852,nt=592,rt=15,et=rt;function Ke(_e){return(_e>>>24&255)+(_e>>>8&65280)+((_e&65280)<<8)+((_e&255)<<24)}function Ue(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function He(_e){var Ve;return!_e||!_e.state?y:(Ve=_e.state,_e.total_in=_e.total_out=Ve.total=0,_e.msg="",Ve.wrap&&(_e.adler=Ve.wrap&1),Ve.mode=_,Ve.last=0,Ve.havedict=0,Ve.dmax=32768,Ve.head=null,Ve.hold=0,Ve.bits=0,Ve.lencode=Ve.lendyn=new o.Buf32(Ye),Ve.distcode=Ve.distdyn=new o.Buf32(nt),Ve.sane=1,Ve.back=-1,k)}function mt(_e){var Ve;return!_e||!_e.state?y:(Ve=_e.state,Ve.wsize=0,Ve.whave=0,Ve.wnext=0,He(_e))}function ht(_e,Ve){var ee,Pe;return!_e||!_e.state||(Pe=_e.state,Ve<0?(ee=0,Ve=-Ve):(ee=(Ve>>4)+1,Ve<48&&(Ve&=15)),Ve&&(Ve<8||Ve>15))?y:(Pe.window!==null&&Pe.wbits!==Ve&&(Pe.window=null),Pe.wrap=ee,Pe.wbits=Ve,mt(_e))}function te(_e,Ve){var ee,Pe;return _e?(Pe=new Ue,_e.state=Pe,Pe.window=null,ee=ht(_e,Ve),ee!==k&&(_e.state=null),ee):y}function se(_e){return te(_e,et)}var le=!0,Se,we;function Xe(_e){if(le){var Ve;for(Se=new o.Buf32(512),we=new o.Buf32(32),Ve=0;Ve<144;)_e.lens[Ve++]=8;for(;Ve<256;)_e.lens[Ve++]=9;for(;Ve<280;)_e.lens[Ve++]=7;for(;Ve<288;)_e.lens[Ve++]=8;for(p(x,_e.lens,0,288,Se,0,_e.work,{bits:9}),Ve=0;Ve<32;)_e.lens[Ve++]=5;p(f,_e.lens,0,32,we,0,_e.work,{bits:5}),le=!1}_e.lencode=Se,_e.lenbits=9,_e.distcode=we,_e.distbits=5}function je(_e,Ve,ee,Pe){var at,X=_e.state;return X.window===null&&(X.wsize=1<<X.wbits,X.wnext=0,X.whave=0,X.window=new o.Buf8(X.wsize)),Pe>=X.wsize?(o.arraySet(X.window,Ve,ee-X.wsize,X.wsize,0),X.wnext=0,X.whave=X.wsize):(at=X.wsize-X.wnext,at>Pe&&(at=Pe),o.arraySet(X.window,Ve,ee-Pe,at,X.wnext),Pe-=at,Pe?(o.arraySet(X.window,Ve,ee-Pe,Pe,0),X.wnext=Pe,X.whave=X.wsize):(X.wnext+=at,X.wnext===X.wsize&&(X.wnext=0),X.whave<X.wsize&&(X.whave+=at))),0}function K(_e,Ve){var ee,Pe,at,X,Re,Ae,ne,ve,Ne,gt,ft,vt,Tt,xr,Bt=0,jt,qt,mr,_r,En,Mn,Kt,ar,cr=new o.Buf8(4),Gr,zr,dn=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!_e||!_e.state||!_e.output||!_e.input&&_e.avail_in!==0)return y;ee=_e.state,ee.mode===q&&(ee.mode=V),Re=_e.next_out,at=_e.output,ne=_e.avail_out,X=_e.next_in,Pe=_e.input,Ae=_e.avail_in,ve=ee.hold,Ne=ee.bits,gt=Ae,ft=ne,ar=k;e:for(;;)switch(ee.mode){case _:if(ee.wrap===0){ee.mode=V;break}for(;Ne<16;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}if(ee.wrap&2&&ve===35615){ee.check=0,cr[0]=ve&255,cr[1]=ve>>>8&255,ee.check=h(ee.check,cr,2,0),ve=0,Ne=0,ee.mode=M;break}if(ee.flags=0,ee.head&&(ee.head.done=!1),!(ee.wrap&1)||(((ve&255)<<8)+(ve>>8))%31){_e.msg="incorrect header check",ee.mode=ke;break}if((ve&15)!==u){_e.msg="unknown compression method",ee.mode=ke;break}if(ve>>>=4,Ne-=4,Kt=(ve&15)+8,ee.wbits===0)ee.wbits=Kt;else if(Kt>ee.wbits){_e.msg="invalid window size",ee.mode=ke;break}ee.dmax=1<<Kt,_e.adler=ee.check=1,ee.mode=ve&512?H:q,ve=0,Ne=0;break;case M:for(;Ne<16;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}if(ee.flags=ve,(ee.flags&255)!==u){_e.msg="unknown compression method",ee.mode=ke;break}if(ee.flags&57344){_e.msg="unknown header flags set",ee.mode=ke;break}ee.head&&(ee.head.text=ve>>8&1),ee.flags&512&&(cr[0]=ve&255,cr[1]=ve>>>8&255,ee.check=h(ee.check,cr,2,0)),ve=0,Ne=0,ee.mode=R;case R:for(;Ne<32;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}ee.head&&(ee.head.time=ve),ee.flags&512&&(cr[0]=ve&255,cr[1]=ve>>>8&255,cr[2]=ve>>>16&255,cr[3]=ve>>>24&255,ee.check=h(ee.check,cr,4,0)),ve=0,Ne=0,ee.mode=N;case N:for(;Ne<16;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}ee.head&&(ee.head.xflags=ve&255,ee.head.os=ve>>8),ee.flags&512&&(cr[0]=ve&255,cr[1]=ve>>>8&255,ee.check=h(ee.check,cr,2,0)),ve=0,Ne=0,ee.mode=I;case I:if(ee.flags&1024){for(;Ne<16;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}ee.length=ve,ee.head&&(ee.head.extra_len=ve),ee.flags&512&&(cr[0]=ve&255,cr[1]=ve>>>8&255,ee.check=h(ee.check,cr,2,0)),ve=0,Ne=0}else ee.head&&(ee.head.extra=null);ee.mode=L;case L:if(ee.flags&1024&&(vt=ee.length,vt>Ae&&(vt=Ae),vt&&(ee.head&&(Kt=ee.head.extra_len-ee.length,ee.head.extra||(ee.head.extra=new Array(ee.head.extra_len)),o.arraySet(ee.head.extra,Pe,X,vt,Kt)),ee.flags&512&&(ee.check=h(ee.check,Pe,vt,X)),Ae-=vt,X+=vt,ee.length-=vt),ee.length))break e;ee.length=0,ee.mode=Y;case Y:if(ee.flags&2048){if(Ae===0)break e;vt=0;do Kt=Pe[X+vt++],ee.head&&Kt&&ee.length<65536&&(ee.head.name+=String.fromCharCode(Kt));while(Kt&&vt<Ae);if(ee.flags&512&&(ee.check=h(ee.check,Pe,vt,X)),Ae-=vt,X+=vt,Kt)break e}else ee.head&&(ee.head.name=null);ee.length=0,ee.mode=B;case B:if(ee.flags&4096){if(Ae===0)break e;vt=0;do Kt=Pe[X+vt++],ee.head&&Kt&&ee.length<65536&&(ee.head.comment+=String.fromCharCode(Kt));while(Kt&&vt<Ae);if(ee.flags&512&&(ee.check=h(ee.check,Pe,vt,X)),Ae-=vt,X+=vt,Kt)break e}else ee.head&&(ee.head.comment=null);ee.mode=D;case D:if(ee.flags&512){for(;Ne<16;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}if(ve!==(ee.check&65535)){_e.msg="header crc mismatch",ee.mode=ke;break}ve=0,Ne=0}ee.head&&(ee.head.hcrc=ee.flags>>9&1,ee.head.done=!0),_e.adler=ee.check=0,ee.mode=q;break;case H:for(;Ne<32;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}_e.adler=ee.check=Ke(ve),ve=0,Ne=0,ee.mode=W;case W:if(ee.havedict===0)return _e.next_out=Re,_e.avail_out=ne,_e.next_in=X,_e.avail_in=Ae,ee.hold=ve,ee.bits=Ne,s;_e.adler=ee.check=1,ee.mode=q;case q:if(Ve===C||Ve===S)break e;case V:if(ee.last){ve>>>=Ne&7,Ne-=Ne&7,ee.mode=We;break}for(;Ne<3;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}switch(ee.last=ve&1,ve>>>=1,Ne-=1,ve&3){case 0:ee.mode=$;break;case 1:if(Xe(ee),ee.mode=he,Ve===S){ve>>>=2,Ne-=2;break e}break;case 2:ee.mode=J;break;case 3:_e.msg="invalid block type",ee.mode=ke}ve>>>=2,Ne-=2;break;case $:for(ve>>>=Ne&7,Ne-=Ne&7;Ne<32;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}if((ve&65535)!==(ve>>>16^65535)){_e.msg="invalid stored block lengths",ee.mode=ke;break}if(ee.length=ve&65535,ve=0,Ne=0,ee.mode=O,Ve===S)break e;case O:ee.mode=j;case j:if(vt=ee.length,vt){if(vt>Ae&&(vt=Ae),vt>ne&&(vt=ne),vt===0)break e;o.arraySet(at,Pe,X,vt,Re),Ae-=vt,X+=vt,ne-=vt,Re+=vt,ee.length-=vt;break}ee.mode=q;break;case J:for(;Ne<14;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}if(ee.nlen=(ve&31)+257,ve>>>=5,Ne-=5,ee.ndist=(ve&31)+1,ve>>>=5,Ne-=5,ee.ncode=(ve&15)+4,ve>>>=4,Ne-=4,ee.nlen>286||ee.ndist>30){_e.msg="too many length or distance symbols",ee.mode=ke;break}ee.have=0,ee.mode=oe;case oe:for(;ee.have<ee.ncode;){for(;Ne<3;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}ee.lens[dn[ee.have++]]=ve&7,ve>>>=3,Ne-=3}for(;ee.have<19;)ee.lens[dn[ee.have++]]=0;if(ee.lencode=ee.lendyn,ee.lenbits=7,Gr={bits:ee.lenbits},ar=p(g,ee.lens,0,19,ee.lencode,0,ee.work,Gr),ee.lenbits=Gr.bits,ar){_e.msg="invalid code lengths set",ee.mode=ke;break}ee.have=0,ee.mode=ie;case ie:for(;ee.have<ee.nlen+ee.ndist;){for(;Bt=ee.lencode[ve&(1<<ee.lenbits)-1],jt=Bt>>>24,qt=Bt>>>16&255,mr=Bt&65535,!(jt<=Ne);){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}if(mr<16)ve>>>=jt,Ne-=jt,ee.lens[ee.have++]=mr;else{if(mr===16){for(zr=jt+2;Ne<zr;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}if(ve>>>=jt,Ne-=jt,ee.have===0){_e.msg="invalid bit length repeat",ee.mode=ke;break}Kt=ee.lens[ee.have-1],vt=3+(ve&3),ve>>>=2,Ne-=2}else if(mr===17){for(zr=jt+3;Ne<zr;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}ve>>>=jt,Ne-=jt,Kt=0,vt=3+(ve&7),ve>>>=3,Ne-=3}else{for(zr=jt+7;Ne<zr;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}ve>>>=jt,Ne-=jt,Kt=0,vt=11+(ve&127),ve>>>=7,Ne-=7}if(ee.have+vt>ee.nlen+ee.ndist){_e.msg="invalid bit length repeat",ee.mode=ke;break}for(;vt--;)ee.lens[ee.have++]=Kt}}if(ee.mode===ke)break;if(ee.lens[256]===0){_e.msg="invalid code -- missing end-of-block",ee.mode=ke;break}if(ee.lenbits=9,Gr={bits:ee.lenbits},ar=p(x,ee.lens,0,ee.nlen,ee.lencode,0,ee.work,Gr),ee.lenbits=Gr.bits,ar){_e.msg="invalid literal/lengths set",ee.mode=ke;break}if(ee.distbits=6,ee.distcode=ee.distdyn,Gr={bits:ee.distbits},ar=p(f,ee.lens,ee.nlen,ee.ndist,ee.distcode,0,ee.work,Gr),ee.distbits=Gr.bits,ar){_e.msg="invalid distances set",ee.mode=ke;break}if(ee.mode=he,Ve===S)break e;case he:ee.mode=de;case de:if(Ae>=6&&ne>=258){_e.next_out=Re,_e.avail_out=ne,_e.next_in=X,_e.avail_in=Ae,ee.hold=ve,ee.bits=Ne,v(_e,ft),Re=_e.next_out,at=_e.output,ne=_e.avail_out,X=_e.next_in,Pe=_e.input,Ae=_e.avail_in,ve=ee.hold,Ne=ee.bits,ee.mode===q&&(ee.back=-1);break}for(ee.back=0;Bt=ee.lencode[ve&(1<<ee.lenbits)-1],jt=Bt>>>24,qt=Bt>>>16&255,mr=Bt&65535,!(jt<=Ne);){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}if(qt&&!(qt&240)){for(_r=jt,En=qt,Mn=mr;Bt=ee.lencode[Mn+((ve&(1<<_r+En)-1)>>_r)],jt=Bt>>>24,qt=Bt>>>16&255,mr=Bt&65535,!(_r+jt<=Ne);){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}ve>>>=_r,Ne-=_r,ee.back+=_r}if(ve>>>=jt,Ne-=jt,ee.back+=jt,ee.length=mr,qt===0){ee.mode=$e;break}if(qt&32){ee.back=-1,ee.mode=q;break}if(qt&64){_e.msg="invalid literal/length code",ee.mode=ke;break}ee.extra=qt&15,ee.mode=fe;case fe:if(ee.extra){for(zr=ee.extra;Ne<zr;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}ee.length+=ve&(1<<ee.extra)-1,ve>>>=ee.extra,Ne-=ee.extra,ee.back+=ee.extra}ee.was=ee.length,ee.mode=ue;case ue:for(;Bt=ee.distcode[ve&(1<<ee.distbits)-1],jt=Bt>>>24,qt=Bt>>>16&255,mr=Bt&65535,!(jt<=Ne);){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}if(!(qt&240)){for(_r=jt,En=qt,Mn=mr;Bt=ee.distcode[Mn+((ve&(1<<_r+En)-1)>>_r)],jt=Bt>>>24,qt=Bt>>>16&255,mr=Bt&65535,!(_r+jt<=Ne);){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}ve>>>=_r,Ne-=_r,ee.back+=_r}if(ve>>>=jt,Ne-=jt,ee.back+=jt,qt&64){_e.msg="invalid distance code",ee.mode=ke;break}ee.offset=mr,ee.extra=qt&15,ee.mode=ye;case ye:if(ee.extra){for(zr=ee.extra;Ne<zr;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}ee.offset+=ve&(1<<ee.extra)-1,ve>>>=ee.extra,Ne-=ee.extra,ee.back+=ee.extra}if(ee.offset>ee.dmax){_e.msg="invalid distance too far back",ee.mode=ke;break}ee.mode=ze;case ze:if(ne===0)break e;if(vt=ft-ne,ee.offset>vt){if(vt=ee.offset-vt,vt>ee.whave&&ee.sane){_e.msg="invalid distance too far back",ee.mode=ke;break}vt>ee.wnext?(vt-=ee.wnext,Tt=ee.wsize-vt):Tt=ee.wnext-vt,vt>ee.length&&(vt=ee.length),xr=ee.window}else xr=at,Tt=Re-ee.offset,vt=ee.length;vt>ne&&(vt=ne),ne-=vt,ee.length-=vt;do at[Re++]=xr[Tt++];while(--vt);ee.length===0&&(ee.mode=de);break;case $e:if(ne===0)break e;at[Re++]=ee.length,ne--,ee.mode=de;break;case We:if(ee.wrap){for(;Ne<32;){if(Ae===0)break e;Ae--,ve|=Pe[X++]<<Ne,Ne+=8}if(ft-=ne,_e.total_out+=ft,ee.total+=ft,ft&&(_e.adler=ee.check=ee.flags?h(ee.check,at,ft,Re-ft):c(ee.check,at,ft,Re-ft)),ft=ne,(ee.flags?ve:Ke(ve))!==ee.check){_e.msg="incorrect data check",ee.mode=ke;break}ve=0,Ne=0}ee.mode=Fe;case Fe:if(ee.wrap&&ee.flags){for(;Ne<32;){if(Ae===0)break e;Ae--,ve+=Pe[X++]<<Ne,Ne+=8}if(ve!==(ee.total&4294967295)){_e.msg="incorrect length check",ee.mode=ke;break}ve=0,Ne=0}ee.mode=me;case me:ar=l;break e;case ke:ar=A;break e;case Qe:return E;case Je:default:return y}return _e.next_out=Re,_e.avail_out=ne,_e.next_in=X,_e.avail_in=Ae,ee.hold=ve,ee.bits=Ne,(ee.wsize||ft!==_e.avail_out&&ee.mode<ke&&(ee.mode<We||Ve!==b))&&je(_e,_e.output,_e.next_out,ft-_e.avail_out),gt-=_e.avail_in,ft-=_e.avail_out,_e.total_in+=gt,_e.total_out+=ft,ee.total+=ft,ee.wrap&&ft&&(_e.adler=ee.check=ee.flags?h(ee.check,at,ft,_e.next_out-ft):c(ee.check,at,ft,_e.next_out-ft)),_e.data_type=ee.bits+(ee.last?64:0)+(ee.mode===q?128:0)+(ee.mode===he||ee.mode===O?256:0),(gt===0&&ft===0||Ve===b)&&ar===k&&(ar=T),ar}function xe(_e){if(!_e||!_e.state)return y;var Ve=_e.state;return Ve.window&&(Ve.window=null),_e.state=null,k}function Me(_e,Ve){var ee;return!_e||!_e.state||(ee=_e.state,!(ee.wrap&2))?y:(ee.head=Ve,Ve.done=!1,k)}function Ze(_e,Ve){var ee=Ve.length,Pe,at,X;return!_e||!_e.state||(Pe=_e.state,Pe.wrap!==0&&Pe.mode!==W)?y:Pe.mode===W&&(at=1,at=c(at,Ve,ee,0),at!==Pe.check)?A:(X=je(_e,Ve,ee,ee),X?(Pe.mode=Qe,E):(Pe.havedict=1,k))}e.inflateReset=mt,e.inflateReset2=ht,e.inflateResetKeep=He,e.inflateInit=se,e.inflateInit2=te,e.inflate=K,e.inflateEnd=xe,e.inflateGetHeader=Me,e.inflateSetDictionary=Ze,e.inflateInfo="pako inflate (from Nodeca project)"}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js":((r,e,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=15,h=852,v=592,p=0,g=1,x=2,f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],b=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],S=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(k,l,s,y,A,E,T,u){var _=u.bits,M=0,R=0,N=0,I=0,L=0,Y=0,B=0,D=0,H=0,W=0,q,V,$,O,j,J=null,oe=0,ie,he=new o.Buf16(c+1),de=new o.Buf16(c+1),fe=null,ue=0,ye,ze,$e;for(M=0;M<=c;M++)he[M]=0;for(R=0;R<y;R++)he[l[s+R]]++;for(L=_,I=c;I>=1&&he[I]===0;I--);if(L>I&&(L=I),I===0)return A[E++]=20971520,A[E++]=20971520,u.bits=1,0;for(N=1;N<I&&he[N]===0;N++);for(L<N&&(L=N),D=1,M=1;M<=c;M++)if(D<<=1,D-=he[M],D<0)return-1;if(D>0&&(k===p||I!==1))return-1;for(de[1]=0,M=1;M<c;M++)de[M+1]=de[M]+he[M];for(R=0;R<y;R++)l[s+R]!==0&&(T[de[l[s+R]]++]=R);if(k===p?(J=fe=T,ie=19):k===g?(J=f,oe-=257,fe=b,ue-=257,ie=256):(J=C,fe=S,ie=-1),W=0,R=0,M=N,j=E,Y=L,B=0,$=-1,H=1<<L,O=H-1,k===g&&H>h||k===x&&H>v)return 1;for(;;){ye=M-B,T[R]<ie?(ze=0,$e=T[R]):T[R]>ie?(ze=fe[ue+T[R]],$e=J[oe+T[R]]):(ze=96,$e=0),q=1<<M-B,V=1<<Y,N=V;do V-=q,A[j+(W>>B)+V]=ye<<24|ze<<16|$e|0;while(V!==0);for(q=1<<M-1;W&q;)q>>=1;if(q!==0?(W&=q-1,W+=q):W=0,R++,--he[M]===0){if(M===I)break;M=l[s+T[R]]}if(M>L&&(W&O)!==$){for(B===0&&(B=L),j+=N,Y=M-B,D=1<<Y;Y+B<I&&(D-=he[Y+B],!(D<=0));)Y++,D<<=1;if(H+=1<<Y,k===g&&H>h||k===x&&H>v)return 1;$=W&O,A[$]=L<<24|Y<<16|j-E|0}}return W!==0&&(A[j+W]=M-B<<24|4194304|0),u.bits=L,0}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js":(r=>{r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js":((r,e,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=4,h=0,v=1,p=2;function g(K){for(var xe=K.length;--xe>=0;)K[xe]=0}var x=0,f=1,b=2,C=3,S=258,k=29,l=256,s=l+1+k,y=30,A=19,E=2*s+1,T=15,u=16,_=7,M=256,R=16,N=17,I=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=512,W=new Array((s+2)*2);g(W);var q=new Array(y*2);g(q);var V=new Array(H);g(V);var $=new Array(S-C+1);g($);var O=new Array(k);g(O);var j=new Array(y);g(j);function J(K,xe,Me,Ze,_e){this.static_tree=K,this.extra_bits=xe,this.extra_base=Me,this.elems=Ze,this.max_length=_e,this.has_stree=K&&K.length}var oe,ie,he;function de(K,xe){this.dyn_tree=K,this.max_code=0,this.stat_desc=xe}function fe(K){return K<256?V[K]:V[256+(K>>>7)]}function ue(K,xe){K.pending_buf[K.pending++]=xe&255,K.pending_buf[K.pending++]=xe>>>8&255}function ye(K,xe,Me){K.bi_valid>u-Me?(K.bi_buf|=xe<<K.bi_valid&65535,ue(K,K.bi_buf),K.bi_buf=xe>>u-K.bi_valid,K.bi_valid+=Me-u):(K.bi_buf|=xe<<K.bi_valid&65535,K.bi_valid+=Me)}function ze(K,xe,Me){ye(K,Me[xe*2],Me[xe*2+1])}function $e(K,xe){var Me=0;do Me|=K&1,K>>>=1,Me<<=1;while(--xe>0);return Me>>>1}function We(K){K.bi_valid===16?(ue(K,K.bi_buf),K.bi_buf=0,K.bi_valid=0):K.bi_valid>=8&&(K.pending_buf[K.pending++]=K.bi_buf&255,K.bi_buf>>=8,K.bi_valid-=8)}function Fe(K,xe){var Me=xe.dyn_tree,Ze=xe.max_code,_e=xe.stat_desc.static_tree,Ve=xe.stat_desc.has_stree,ee=xe.stat_desc.extra_bits,Pe=xe.stat_desc.extra_base,at=xe.stat_desc.max_length,X,Re,Ae,ne,ve,Ne,gt=0;for(ne=0;ne<=T;ne++)K.bl_count[ne]=0;for(Me[K.heap[K.heap_max]*2+1]=0,X=K.heap_max+1;X<E;X++)Re=K.heap[X],ne=Me[Me[Re*2+1]*2+1]+1,ne>at&&(ne=at,gt++),Me[Re*2+1]=ne,!(Re>Ze)&&(K.bl_count[ne]++,ve=0,Re>=Pe&&(ve=ee[Re-Pe]),Ne=Me[Re*2],K.opt_len+=Ne*(ne+ve),Ve&&(K.static_len+=Ne*(_e[Re*2+1]+ve)));if(gt!==0){do{for(ne=at-1;K.bl_count[ne]===0;)ne--;K.bl_count[ne]--,K.bl_count[ne+1]+=2,K.bl_count[at]--,gt-=2}while(gt>0);for(ne=at;ne!==0;ne--)for(Re=K.bl_count[ne];Re!==0;)Ae=K.heap[--X],!(Ae>Ze)&&(Me[Ae*2+1]!==ne&&(K.opt_len+=(ne-Me[Ae*2+1])*Me[Ae*2],Me[Ae*2+1]=ne),Re--)}}function me(K,xe,Me){var Ze=new Array(T+1),_e=0,Ve,ee;for(Ve=1;Ve<=T;Ve++)Ze[Ve]=_e=_e+Me[Ve-1]<<1;for(ee=0;ee<=xe;ee++){var Pe=K[ee*2+1];Pe!==0&&(K[ee*2]=$e(Ze[Pe]++,Pe))}}function ke(){var K,xe,Me,Ze,_e,Ve=new Array(T+1);for(Me=0,Ze=0;Ze<k-1;Ze++)for(O[Ze]=Me,K=0;K<1<<L[Ze];K++)$[Me++]=Ze;for($[Me-1]=Ze,_e=0,Ze=0;Ze<16;Ze++)for(j[Ze]=_e,K=0;K<1<<Y[Ze];K++)V[_e++]=Ze;for(_e>>=7;Ze<y;Ze++)for(j[Ze]=_e<<7,K=0;K<1<<Y[Ze]-7;K++)V[256+_e++]=Ze;for(xe=0;xe<=T;xe++)Ve[xe]=0;for(K=0;K<=143;)W[K*2+1]=8,K++,Ve[8]++;for(;K<=255;)W[K*2+1]=9,K++,Ve[9]++;for(;K<=279;)W[K*2+1]=7,K++,Ve[7]++;for(;K<=287;)W[K*2+1]=8,K++,Ve[8]++;for(me(W,s+1,Ve),K=0;K<y;K++)q[K*2+1]=5,q[K*2]=$e(K,5);oe=new J(W,L,l+1,s,T),ie=new J(q,Y,0,y,T),he=new J(new Array(0),B,0,A,_)}function Qe(K){var xe;for(xe=0;xe<s;xe++)K.dyn_ltree[xe*2]=0;for(xe=0;xe<y;xe++)K.dyn_dtree[xe*2]=0;for(xe=0;xe<A;xe++)K.bl_tree[xe*2]=0;K.dyn_ltree[M*2]=1,K.opt_len=K.static_len=0,K.last_lit=K.matches=0}function Je(K){K.bi_valid>8?ue(K,K.bi_buf):K.bi_valid>0&&(K.pending_buf[K.pending++]=K.bi_buf),K.bi_buf=0,K.bi_valid=0}function Ye(K,xe,Me,Ze){Je(K),ue(K,Me),ue(K,~Me),o.arraySet(K.pending_buf,K.window,xe,Me,K.pending),K.pending+=Me}function nt(K,xe,Me,Ze){var _e=xe*2,Ve=Me*2;return K[_e]<K[Ve]||K[_e]===K[Ve]&&Ze[xe]<=Ze[Me]}function rt(K,xe,Me){for(var Ze=K.heap[Me],_e=Me<<1;_e<=K.heap_len&&(_e<K.heap_len&&nt(xe,K.heap[_e+1],K.heap[_e],K.depth)&&_e++,!nt(xe,Ze,K.heap[_e],K.depth));)K.heap[Me]=K.heap[_e],Me=_e,_e<<=1;K.heap[Me]=Ze}function et(K,xe,Me){var Ze,_e,Ve=0,ee,Pe;if(K.last_lit!==0)do Ze=K.pending_buf[K.d_buf+Ve*2]<<8|K.pending_buf[K.d_buf+Ve*2+1],_e=K.pending_buf[K.l_buf+Ve],Ve++,Ze===0?ze(K,_e,xe):(ee=$[_e],ze(K,ee+l+1,xe),Pe=L[ee],Pe!==0&&(_e-=O[ee],ye(K,_e,Pe)),Ze--,ee=fe(Ze),ze(K,ee,Me),Pe=Y[ee],Pe!==0&&(Ze-=j[ee],ye(K,Ze,Pe)));while(Ve<K.last_lit);ze(K,M,xe)}function Ke(K,xe){var Me=xe.dyn_tree,Ze=xe.stat_desc.static_tree,_e=xe.stat_desc.has_stree,Ve=xe.stat_desc.elems,ee,Pe,at=-1,X;for(K.heap_len=0,K.heap_max=E,ee=0;ee<Ve;ee++)Me[ee*2]!==0?(K.heap[++K.heap_len]=at=ee,K.depth[ee]=0):Me[ee*2+1]=0;for(;K.heap_len<2;)X=K.heap[++K.heap_len]=at<2?++at:0,Me[X*2]=1,K.depth[X]=0,K.opt_len--,_e&&(K.static_len-=Ze[X*2+1]);for(xe.max_code=at,ee=K.heap_len>>1;ee>=1;ee--)rt(K,Me,ee);X=Ve;do ee=K.heap[1],K.heap[1]=K.heap[K.heap_len--],rt(K,Me,1),Pe=K.heap[1],K.heap[--K.heap_max]=ee,K.heap[--K.heap_max]=Pe,Me[X*2]=Me[ee*2]+Me[Pe*2],K.depth[X]=(K.depth[ee]>=K.depth[Pe]?K.depth[ee]:K.depth[Pe])+1,Me[ee*2+1]=Me[Pe*2+1]=X,K.heap[1]=X++,rt(K,Me,1);while(K.heap_len>=2);K.heap[--K.heap_max]=K.heap[1],Fe(K,xe),me(Me,at,K.bl_count)}function Ue(K,xe,Me){var Ze,_e=-1,Ve,ee=xe[1],Pe=0,at=7,X=4;for(ee===0&&(at=138,X=3),xe[(Me+1)*2+1]=65535,Ze=0;Ze<=Me;Ze++)Ve=ee,ee=xe[(Ze+1)*2+1],!(++Pe<at&&Ve===ee)&&(Pe<X?K.bl_tree[Ve*2]+=Pe:Ve!==0?(Ve!==_e&&K.bl_tree[Ve*2]++,K.bl_tree[R*2]++):Pe<=10?K.bl_tree[N*2]++:K.bl_tree[I*2]++,Pe=0,_e=Ve,ee===0?(at=138,X=3):Ve===ee?(at=6,X=3):(at=7,X=4))}function He(K,xe,Me){var Ze,_e=-1,Ve,ee=xe[1],Pe=0,at=7,X=4;for(ee===0&&(at=138,X=3),Ze=0;Ze<=Me;Ze++)if(Ve=ee,ee=xe[(Ze+1)*2+1],!(++Pe<at&&Ve===ee)){if(Pe<X)do ze(K,Ve,K.bl_tree);while(--Pe!==0);else Ve!==0?(Ve!==_e&&(ze(K,Ve,K.bl_tree),Pe--),ze(K,R,K.bl_tree),ye(K,Pe-3,2)):Pe<=10?(ze(K,N,K.bl_tree),ye(K,Pe-3,3)):(ze(K,I,K.bl_tree),ye(K,Pe-11,7));Pe=0,_e=Ve,ee===0?(at=138,X=3):Ve===ee?(at=6,X=3):(at=7,X=4)}}function mt(K){var xe;for(Ue(K,K.dyn_ltree,K.l_desc.max_code),Ue(K,K.dyn_dtree,K.d_desc.max_code),Ke(K,K.bl_desc),xe=A-1;xe>=3&&K.bl_tree[D[xe]*2+1]===0;xe--);return K.opt_len+=3*(xe+1)+5+5+4,xe}function ht(K,xe,Me,Ze){var _e;for(ye(K,xe-257,5),ye(K,Me-1,5),ye(K,Ze-4,4),_e=0;_e<Ze;_e++)ye(K,K.bl_tree[D[_e]*2+1],3);He(K,K.dyn_ltree,xe-1),He(K,K.dyn_dtree,Me-1)}function te(K){var xe=4093624447,Me;for(Me=0;Me<=31;Me++,xe>>>=1)if(xe&1&&K.dyn_ltree[Me*2]!==0)return h;if(K.dyn_ltree[18]!==0||K.dyn_ltree[20]!==0||K.dyn_ltree[26]!==0)return v;for(Me=32;Me<l;Me++)if(K.dyn_ltree[Me*2]!==0)return v;return h}var se=!1;function le(K){se||(ke(),se=!0),K.l_desc=new de(K.dyn_ltree,oe),K.d_desc=new de(K.dyn_dtree,ie),K.bl_desc=new de(K.bl_tree,he),K.bi_buf=0,K.bi_valid=0,Qe(K)}function Se(K,xe,Me,Ze){ye(K,(x<<1)+(Ze?1:0),3),Ye(K,xe,Me)}function we(K){ye(K,f<<1,3),ze(K,M,W),We(K)}function Xe(K,xe,Me,Ze){var _e,Ve,ee=0;K.level>0?(K.strm.data_type===p&&(K.strm.data_type=te(K)),Ke(K,K.l_desc),Ke(K,K.d_desc),ee=mt(K),_e=K.opt_len+3+7>>>3,Ve=K.static_len+3+7>>>3,Ve<=_e&&(_e=Ve)):_e=Ve=Me+5,Me+4<=_e&&xe!==-1?Se(K,xe,Me,Ze):K.strategy===c||Ve===_e?(ye(K,(f<<1)+(Ze?1:0),3),et(K,W,q)):(ye(K,(b<<1)+(Ze?1:0),3),ht(K,K.l_desc.max_code+1,K.d_desc.max_code+1,ee+1),et(K,K.dyn_ltree,K.dyn_dtree)),Qe(K),Ze&&Je(K)}function je(K,xe,Me){return K.pending_buf[K.d_buf+K.last_lit*2]=xe>>>8&255,K.pending_buf[K.d_buf+K.last_lit*2+1]=xe&255,K.pending_buf[K.l_buf+K.last_lit]=Me&255,K.last_lit++,xe===0?K.dyn_ltree[Me*2]++:(K.matches++,xe--,K.dyn_ltree[($[Me]+l+1)*2]++,K.dyn_dtree[fe(xe)*2]++),K.last_lit===K.lit_bufsize-1}e._tr_init=le,e._tr_stored_block=Se,e._tr_flush_block=Xe,e._tr_tally=je,e._tr_align=we}),"./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js":(r=>{function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}r.exports=e}),"./src/SurfaceWorker.js":(()=>{$3Dmol.workerString=(function(){self.onmessage=function(r){var e=r.data,t=e.type;if(t<0)self.atomData=e.atoms,self.volume=e.volume,self.ps=new ProteinSurface;else{var o=self.ps;o.initparm(e.expandedExtent,t!=1,self.volume),o.fillvoxels(self.atomData,e.extendedAtoms),o.buildboundary(),(t===4||t===2)&&(o.fastdistancemap(),o.boundingatom(!1),o.fillvoxelswaals(self.atomData,e.extendedAtoms)),o.marchingcube(t);var c=o.getFacesAndVertices(e.atomsToShow);self.postMessage(c)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0}),"./src/exporter.js":(r=>{typeof r.exports=="object"&&(r.exports=window.$3Dmol)}),"./src/vendor/mmtf.js":(function(r,e){(function(t,o){o(e)})(this,function(t){function o(te,se,le){for(var Se=(te.byteLength,0),we=le.length;we>Se;Se++){var Xe=le.charCodeAt(Se);if(128>Xe)te.setUint8(se++,Xe>>>0&127|0);else if(2048>Xe)te.setUint8(se++,Xe>>>6&31|192),te.setUint8(se++,Xe>>>0&63|128);else if(65536>Xe)te.setUint8(se++,Xe>>>12&15|224),te.setUint8(se++,Xe>>>6&63|128),te.setUint8(se++,Xe>>>0&63|128);else{if(!(1114112>Xe))throw new Error("bad codepoint "+Xe);te.setUint8(se++,Xe>>>18&7|240),te.setUint8(se++,Xe>>>12&63|128),te.setUint8(se++,Xe>>>6&63|128),te.setUint8(se++,Xe>>>0&63|128)}}}function c(te){for(var se=0,le=0,Se=te.length;Se>le;le++){var we=te.charCodeAt(le);if(128>we)se+=1;else if(2048>we)se+=2;else if(65536>we)se+=3;else{if(!(1114112>we))throw new Error("bad codepoint "+we);se+=4}}return se}function h(te,se,le){var Se=typeof te;if(Se==="string"){var we=c(te);if(32>we)return se.setUint8(le,160|we),o(se,le+1,te),1+we;if(256>we)return se.setUint8(le,217),se.setUint8(le+1,we),o(se,le+2,te),2+we;if(65536>we)return se.setUint8(le,218),se.setUint16(le+1,we),o(se,le+3,te),3+we;if(4294967296>we)return se.setUint8(le,219),se.setUint32(le+1,we),o(se,le+5,te),5+we}if(te instanceof Uint8Array){var we=te.byteLength,Xe=new Uint8Array(se.buffer);if(256>we)return se.setUint8(le,196),se.setUint8(le+1,we),Xe.set(te,le+2),2+we;if(65536>we)return se.setUint8(le,197),se.setUint16(le+1,we),Xe.set(te,le+3),3+we;if(4294967296>we)return se.setUint8(le,198),se.setUint32(le+1,we),Xe.set(te,le+5),5+we}if(Se==="number"){if(!isFinite(te))throw new Error("Number not finite: "+te);if(Math.floor(te)!==te)return se.setUint8(le,203),se.setFloat64(le+1,te),9;if(te>=0){if(128>te)return se.setUint8(le,te),1;if(256>te)return se.setUint8(le,204),se.setUint8(le+1,te),2;if(65536>te)return se.setUint8(le,205),se.setUint16(le+1,te),3;if(4294967296>te)return se.setUint8(le,206),se.setUint32(le+1,te),5;throw new Error("Number too big 0x"+te.toString(16))}if(te>=-32)return se.setInt8(le,te),1;if(te>=-128)return se.setUint8(le,208),se.setInt8(le+1,te),2;if(te>=-32768)return se.setUint8(le,209),se.setInt16(le+1,te),3;if(te>=-2147483648)return se.setUint8(le,210),se.setInt32(le+1,te),5;throw new Error("Number too small -0x"+(-te).toString(16).substr(1))}if(te===null)return se.setUint8(le,192),1;if(Se==="boolean")return se.setUint8(le,te?195:194),1;if(Se==="object"){var we,xe=0,je=Array.isArray(te);if(je)we=te.length;else{var K=Object.keys(te);we=K.length}var xe;if(16>we?(se.setUint8(le,we|(je?144:128)),xe=1):65536>we?(se.setUint8(le,je?220:222),se.setUint16(le+1,we),xe=3):4294967296>we&&(se.setUint8(le,je?221:223),se.setUint32(le+1,we),xe=5),je)for(var Me=0;we>Me;Me++)xe+=h(te[Me],se,le+xe);else for(var Me=0;we>Me;Me++){var Ze=K[Me];xe+=h(Ze,se,le+xe),xe+=h(te[Ze],se,le+xe)}return xe}throw new Error("Unknown type "+Se)}function v(te){var se=typeof te;if(se==="string"){var le=c(te);if(32>le)return 1+le;if(256>le)return 2+le;if(65536>le)return 3+le;if(4294967296>le)return 5+le}if(te instanceof Uint8Array){var le=te.byteLength;if(256>le)return 2+le;if(65536>le)return 3+le;if(4294967296>le)return 5+le}if(se==="number"){if(Math.floor(te)!==te)return 9;if(te>=0){if(128>te)return 1;if(256>te)return 2;if(65536>te)return 3;if(4294967296>te)return 5;throw new Error("Number too big 0x"+te.toString(16))}if(te>=-32)return 1;if(te>=-128)return 2;if(te>=-32768)return 3;if(te>=-2147483648)return 5;throw new Error("Number too small -0x"+te.toString(16).substr(1))}if(se==="boolean"||te===null)return 1;if(se==="object"){var le,Se=0;if(Array.isArray(te)){le=te.length;for(var we=0;le>we;we++)Se+=v(te[we])}else{var Xe=Object.keys(te);le=Xe.length;for(var we=0;le>we;we++){var je=Xe[we];Se+=v(je)+v(te[je])}}if(16>le)return 1+Se;if(65536>le)return 3+Se;if(4294967296>le)return 5+Se;throw new Error("Array or object too long 0x"+le.toString(16))}throw new Error("Unknown type "+se)}function p(te){var se=new ArrayBuffer(v(te)),le=new DataView(se);return h(te,le,0),new Uint8Array(se)}function g(te,se,le){return se?new te(se.buffer,se.byteOffset,se.byteLength/(le||1)):void 0}function x(te){return g(DataView,te)}function f(te){return g(Uint8Array,te)}function b(te){return g(Int8Array,te)}function C(te){return g(Int32Array,te,4)}function S(te){return g(Float32Array,te,4)}function k(te,se){var le=te.length/2;se||(se=new Int16Array(le));for(var Se=0,we=0;le>Se;++Se,we+=2)se[Se]=te[we]<<8^te[we+1]<<0;return se}function l(te,se){var le=te.length;se||(se=new Uint8Array(2*le));for(var Se=x(se),we=0;le>we;++we)Se.setInt16(2*we,te[we]);return f(se)}function s(te,se){var le=te.length/4;se||(se=new Int32Array(le));for(var Se=0,we=0;le>Se;++Se,we+=4)se[Se]=te[we]<<24^te[we+1]<<16^te[we+2]<<8^te[we+3]<<0;return se}function y(te,se){var le=te.length;se||(se=new Uint8Array(4*le));for(var Se=x(se),we=0;le>we;++we)Se.setInt32(4*we,te[we]);return f(se)}function A(te,se){var le=te.length;se||(se=new Float32Array(le/4));for(var Se=x(se),we=x(te),Xe=0,je=0,K=le/4;K>Xe;++Xe,je+=4)Se.setFloat32(je,we.getFloat32(je),!0);return se}function E(te,se,le){var Se=te.length,we=1/se;le||(le=new Float32Array(Se));for(var Xe=0;Se>Xe;++Xe)le[Xe]=te[Xe]*we;return le}function T(te,se,le){var Se=te.length;le||(le=new Int32Array(Se));for(var we=0;Se>we;++we)le[we]=Math.round(te[we]*se);return le}function u(te,se){var le,Se;if(!se){var we=0;for(le=0,Se=te.length;Se>le;le+=2)we+=te[le+1];se=new te.constructor(we)}var Xe=0;for(le=0,Se=te.length;Se>le;le+=2)for(var je=te[le],K=te[le+1],xe=0;K>xe;++xe)se[Xe]=je,++Xe;return se}function _(te){if(te.length===0)return new Int32Array;var se,le,Se=2;for(se=1,le=te.length;le>se;++se)te[se-1]!==te[se]&&(Se+=2);var we=new Int32Array(Se),Xe=0,je=1;for(se=1,le=te.length;le>se;++se)te[se-1]!==te[se]?(we[Xe]=te[se-1],we[Xe+1]=je,je=1,Xe+=2):++je;return we[Xe]=te[te.length-1],we[Xe+1]=je,we}function M(te,se){var le=te.length;se||(se=new te.constructor(le)),le&&(se[0]=te[0]);for(var Se=1;le>Se;++Se)se[Se]=te[Se]+se[Se-1];return se}function R(te,se){var le=te.length;se||(se=new te.constructor(le)),se[0]=te[0];for(var Se=1;le>Se;++Se)se[Se]=te[Se]-te[Se-1];return se}function N(te,se){var le,Se,we=te instanceof Int8Array?127:32767,Xe=-we-1,je=te.length;if(!se){var K=0;for(le=0;je>le;++le)te[le]<we&&te[le]>Xe&&++K;se=new Int32Array(K)}for(le=0,Se=0;je>le;){for(var xe=0;te[le]===we||te[le]===Xe;)xe+=te[le],++le;xe+=te[le],++le,se[Se]=xe,++Se}return se}function I(te,se){var le,Se=32767,we=-Se-1,Xe=te.length,je=0;for(le=0;Xe>le;++le){var K=te[le];K===0?++je:K>0?(je+=Math.ceil(K/Se),K%Se===0&&(je+=1)):(je+=Math.ceil(K/we),K%we===0&&(je+=1))}var xe=new Int16Array(je),Me=0;for(le=0;Xe>le;++le){var K=te[le];if(K>=0)for(;K>=Se;)xe[Me]=Se,++Me,K-=Se;else for(;we>=K;)xe[Me]=we,++Me,K-=we;xe[Me]=K,++Me}return xe}function L(te,se){return M(u(te),se)}function Y(te){return _(R(te))}function B(te,se,le){return E(u(te,C(le)),se,le)}function D(te,se){return _(T(te,se))}function H(te,se,le){return E(M(te,C(le)),se,le)}function W(te,se,le){return R(T(te,se),le)}function q(te,se,le){return E(N(te,C(le)),se,le)}function V(te,se,le){var Se=N(te,C(le));return H(Se,se,S(Se))}function $(te,se,le){return I(W(te,se))}function O(Xe){var se=x(Xe),le=se.getInt32(0),Se=se.getInt32(4),we=Xe.subarray(8,12),Xe=Xe.subarray(12);return[le,Xe,Se,we]}function j(te,se,le,Se){var we=new ArrayBuffer(12+Se.byteLength),Xe=new Uint8Array(we),je=new DataView(we);return je.setInt32(0,te),je.setInt32(4,se),le&&Xe.set(le,8),Xe.set(Se,12),Xe}function J(te){var se=te.length,le=f(te);return j(2,se,void 0,le)}function oe(te){var se=te.length,le=y(te);return j(4,se,void 0,le)}function ie(te,se){var le=te.length/se,Se=y([se]),we=f(te);return j(5,le,Se,we)}function he(te){var se=te.length,le=y(_(te));return j(6,se,void 0,le)}function de(te){var se=te.length,le=y(Y(te));return j(8,se,void 0,le)}function fe(te,se){var le=te.length,Se=y([se]),we=y(D(te,se));return j(9,le,Se,we)}function ue(te,se){var le=te.length,Se=y([se]),we=l($(te,se));return j(10,le,Se,we)}function ye(te){var se={};return rt.forEach(function(le){te[le]!==void 0&&(se[le]=te[le])}),te.bondAtomList&&(se.bondAtomList=oe(te.bondAtomList)),te.bondOrderList&&(se.bondOrderList=J(te.bondOrderList)),se.xCoordList=ue(te.xCoordList,1e3),se.yCoordList=ue(te.yCoordList,1e3),se.zCoordList=ue(te.zCoordList,1e3),te.bFactorList&&(se.bFactorList=ue(te.bFactorList,100)),te.atomIdList&&(se.atomIdList=de(te.atomIdList)),te.altLocList&&(se.altLocList=he(te.altLocList)),te.occupancyList&&(se.occupancyList=fe(te.occupancyList,100)),se.groupIdList=de(te.groupIdList),se.groupTypeList=oe(te.groupTypeList),te.secStructList&&(se.secStructList=J(te.secStructList)),te.insCodeList&&(se.insCodeList=he(te.insCodeList)),te.sequenceIndexList&&(se.sequenceIndexList=de(te.sequenceIndexList)),se.chainIdList=ie(te.chainIdList,4),te.chainNameList&&(se.chainNameList=ie(te.chainNameList,4)),se}function ze(te){function se(xe){for(var Me={},Ze=0;xe>Ze;Ze++){var _e=Xe();Me[_e]=Xe()}return Me}function le(xe){var Me=te.subarray(je,je+xe);return je+=xe,Me}function Se(xe){var Me=te.subarray(je,je+xe);je+=xe;var Ze=65535;if(xe>Ze){for(var _e=[],Ve=0;Ve<Me.length;Ve+=Ze)_e.push(String.fromCharCode.apply(null,Me.subarray(Ve,Ve+Ze)));return _e.join("")}return String.fromCharCode.apply(null,Me)}function we(xe){for(var Me=new Array(xe),Ze=0;xe>Ze;Ze++)Me[Ze]=Xe();return Me}function Xe(){var xe,Me,Ze=te[je];if(!(128&Ze))return je++,Ze;if((240&Ze)===128)return Me=15&Ze,je++,se(Me);if((240&Ze)===144)return Me=15&Ze,je++,we(Me);if((224&Ze)===160)return Me=31&Ze,je++,Se(Me);if((224&Ze)===224)return xe=K.getInt8(je),je++,xe;switch(Ze){case 192:return je++,null;case 194:return je++,!1;case 195:return je++,!0;case 196:return Me=K.getUint8(je+1),je+=2,le(Me);case 197:return Me=K.getUint16(je+1),je+=3,le(Me);case 198:return Me=K.getUint32(je+1),je+=5,le(Me);case 202:return xe=K.getFloat32(je+1),je+=5,xe;case 203:return xe=K.getFloat64(je+1),je+=9,xe;case 204:return xe=te[je+1],je+=2,xe;case 205:return xe=K.getUint16(je+1),je+=3,xe;case 206:return xe=K.getUint32(je+1),je+=5,xe;case 208:return xe=K.getInt8(je+1),je+=2,xe;case 209:return xe=K.getInt16(je+1),je+=3,xe;case 210:return xe=K.getInt32(je+1),je+=5,xe;case 217:return Me=K.getUint8(je+1),je+=2,Se(Me);case 218:return Me=K.getUint16(je+1),je+=3,Se(Me);case 219:return Me=K.getUint32(je+1),je+=5,Se(Me);case 220:return Me=K.getUint16(je+1),je+=3,we(Me);case 221:return Me=K.getUint32(je+1),je+=5,we(Me);case 222:return Me=K.getUint16(je+1),je+=3,se(Me);case 223:return Me=K.getUint32(je+1),je+=5,se(Me)}throw new Error("Unknown type 0x"+Ze.toString(16))}var je=0,K=new DataView(te.buffer);return Xe()}function $e(te,se,le,Se){switch(te){case 1:return A(se);case 2:return b(se);case 3:return k(se);case 4:return s(se);case 5:return f(se);case 6:return u(s(se),new Uint8Array(le));case 7:return u(s(se));case 8:return L(s(se));case 9:return B(s(se),s(Se)[0]);case 10:return V(k(se),s(Se)[0]);case 11:return E(k(se),s(Se)[0]);case 12:return q(k(se),s(Se)[0]);case 13:return q(b(se),s(Se)[0]);case 14:return N(k(se));case 15:return N(b(se))}}function We(te,se){se=se||{};var le=se.ignoreFields,Se={};return Ke.forEach(function(we){var Xe=le?le.indexOf(we)!==-1:!1,je=te[we];Xe||je===void 0||(je instanceof Uint8Array?Se[we]=$e.apply(null,O(je)):Se[we]=je)}),Se}function Fe(te){return String.fromCharCode.apply(null,te).replace(/\0/g,"")}function me(te,se,le){le=le||{};var Se,we,Xe,je,K,xe,Me=le.firstModelOnly,Ze=se.onModel,_e=se.onChain,Ve=se.onGroup,ee=se.onAtom,Pe=se.onBond,at=0,X=0,Re=0,Ae=0,ne=0,ve=-1,Ne=te.chainNameList,gt=te.secStructList,ft=te.insCodeList,vt=te.sequenceIndexList,Tt=te.atomIdList,xr=te.bFactorList,Bt=te.altLocList,jt=te.occupancyList,qt=te.bondAtomList,mr=te.bondOrderList;for(Se=0,we=te.chainsPerModel.length;we>Se&&!(Me&&at>0);++Se){var _r=te.chainsPerModel[at];for(Ze&&Ze({chainCount:_r,modelIndex:at}),Xe=0;_r>Xe;++Xe){var En=te.groupsPerChain[X];if(_e){var Mn=Fe(te.chainIdList.subarray(4*X,4*X+4)),Kt=null;Ne&&(Kt=Fe(Ne.subarray(4*X,4*X+4))),_e({groupCount:En,chainIndex:X,modelIndex:at,chainId:Mn,chainName:Kt})}for(je=0;En>je;++je){var ar=te.groupList[te.groupTypeList[Re]],cr=ar.atomNameList.length;if(Ve){var Gr=null;gt&&(Gr=gt[Re]);var zr=null;te.insCodeList&&(zr=String.fromCharCode(ft[Re]));var dn=null;vt&&(dn=vt[Re]),Ve({atomCount:cr,groupIndex:Re,chainIndex:X,modelIndex:at,groupId:te.groupIdList[Re],groupType:te.groupTypeList[Re],groupName:ar.groupName,singleLetterCode:ar.singleLetterCode,chemCompType:ar.chemCompType,secStruct:Gr,insCode:zr,sequenceIndex:dn})}for(K=0;cr>K;++K){if(ee){var _i=null;Tt&&(_i=Tt[Ae]);var xi=null;xr&&(xi=xr[Ae]);var wi=null;Bt&&(wi=String.fromCharCode(Bt[Ae]));var ei=null;jt&&(ei=jt[Ae]),ee({atomIndex:Ae,groupIndex:Re,chainIndex:X,modelIndex:at,atomId:_i,element:ar.elementList[K],atomName:ar.atomNameList[K],formalCharge:ar.formalChargeList[K],xCoord:te.xCoordList[Ae],yCoord:te.yCoordList[Ae],zCoord:te.zCoordList[Ae],bFactor:xi,altLoc:wi,occupancy:ei})}Ae+=1}if(Pe){var dr=ar.bondAtomList;for(K=0,xe=ar.bondOrderList.length;xe>K;++K)Pe({atomIndex1:Ae-cr+dr[2*K],atomIndex2:Ae-cr+dr[2*K+1],bondOrder:ar.bondOrderList[K]})}Re+=1}X+=1}if(ne=ve+1,ve=Ae-1,Pe&&qt)for(K=0,xe=qt.length;xe>K;K+=2){var bi=qt[K],$n=qt[K+1];(bi>=ne&&ve>=bi||$n>=ne&&ve>=$n)&&Pe({atomIndex1:bi,atomIndex2:$n,bondOrder:mr?mr[K/2]:null})}at+=1}}function ke(te){return p(ye(te))}function Qe(te,se){te instanceof ArrayBuffer&&(te=new Uint8Array(te));var le;return le=te instanceof Uint8Array?ze(te):te,We(le,se)}function Je(te,se,le,Se){function we(){try{var je=Qe(Xe.response);le(je)}catch(K){Se(K)}}var Xe=new XMLHttpRequest;Xe.addEventListener("load",we,!0),Xe.addEventListener("error",Se,!0),Xe.responseType="arraybuffer",Xe.open("GET",se+te.toUpperCase()),Xe.send()}function Ye(te,se,le){Je(te,mt,se,le)}function nt(te,se,le){Je(te,ht,se,le)}var rt=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],et=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],Ke=rt.concat(et),Ue="v1.0.1",He="//mmtf.rcsb.org/v1.0/",mt=He+"full/",ht=He+"reduced/";t.encode=ke,t.decode=Qe,t.traverse=me,t.fetch=Ye,t.fetchReduced=nt,t.version=Ue,t.fetchUrl=mt,t.fetchReducedUrl=ht,t.encodeMsgpack=p,t.encodeMmtf=ye,t.decodeMsgpack=ze,t.decodeMmtf=We})}),"./node_modules/pako/dist/pako.esm.mjs":((r,e,t)=>{t.r(e),t.d(e,{Deflate:()=>mi,Inflate:()=>Ra,constants:()=>Un,default:()=>ko,deflate:()=>Bi,deflateRaw:()=>Xr,gzip:()=>Ls,inflate:()=>ka,inflateRaw:()=>Ds,ungzip:()=>za});/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const o=4,c=0,h=1,v=2;function p(z){let Q=z.length;for(;--Q>=0;)z[Q]=0}const g=0,x=1,f=2,b=3,C=258,S=29,k=256,l=k+1+S,s=30,y=19,A=2*l+1,E=15,T=16,u=7,_=256,M=16,R=17,N=18,I=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),L=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Y=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),B=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),D=512,H=new Array((l+2)*2);p(H);const W=new Array(s*2);p(W);const q=new Array(D);p(q);const V=new Array(C-b+1);p(V);const $=new Array(S);p($);const O=new Array(s);p(O);function j(z,Q,F,ae,ce){this.static_tree=z,this.extra_bits=Q,this.extra_base=F,this.elems=ae,this.max_length=ce,this.has_stree=z&&z.length}let J,oe,ie;function he(z,Q){this.dyn_tree=z,this.max_code=0,this.stat_desc=Q}const de=z=>z<256?q[z]:q[256+(z>>>7)],fe=(z,Q)=>{z.pending_buf[z.pending++]=Q&255,z.pending_buf[z.pending++]=Q>>>8&255},ue=(z,Q,F)=>{z.bi_valid>T-F?(z.bi_buf|=Q<<z.bi_valid&65535,fe(z,z.bi_buf),z.bi_buf=Q>>T-z.bi_valid,z.bi_valid+=F-T):(z.bi_buf|=Q<<z.bi_valid&65535,z.bi_valid+=F)},ye=(z,Q,F)=>{ue(z,F[Q*2],F[Q*2+1])},ze=(z,Q)=>{let F=0;do F|=z&1,z>>>=1,F<<=1;while(--Q>0);return F>>>1},$e=z=>{z.bi_valid===16?(fe(z,z.bi_buf),z.bi_buf=0,z.bi_valid=0):z.bi_valid>=8&&(z.pending_buf[z.pending++]=z.bi_buf&255,z.bi_buf>>=8,z.bi_valid-=8)},We=(z,Q)=>{const F=Q.dyn_tree,ae=Q.max_code,ce=Q.stat_desc.static_tree,pe=Q.stat_desc.has_stree,Oe=Q.stat_desc.extra_bits,Te=Q.stat_desc.extra_base,wt=Q.stat_desc.max_length;let be,Le,Jt,ut,tt,pr,vr=0;for(ut=0;ut<=E;ut++)z.bl_count[ut]=0;for(F[z.heap[z.heap_max]*2+1]=0,be=z.heap_max+1;be<A;be++)Le=z.heap[be],ut=F[F[Le*2+1]*2+1]+1,ut>wt&&(ut=wt,vr++),F[Le*2+1]=ut,!(Le>ae)&&(z.bl_count[ut]++,tt=0,Le>=Te&&(tt=Oe[Le-Te]),pr=F[Le*2],z.opt_len+=pr*(ut+tt),pe&&(z.static_len+=pr*(ce[Le*2+1]+tt)));if(vr!==0){do{for(ut=wt-1;z.bl_count[ut]===0;)ut--;z.bl_count[ut]--,z.bl_count[ut+1]+=2,z.bl_count[wt]--,vr-=2}while(vr>0);for(ut=wt;ut!==0;ut--)for(Le=z.bl_count[ut];Le!==0;)Jt=z.heap[--be],!(Jt>ae)&&(F[Jt*2+1]!==ut&&(z.opt_len+=(ut-F[Jt*2+1])*F[Jt*2],F[Jt*2+1]=ut),Le--)}},Fe=(z,Q,F)=>{const ae=new Array(E+1);let ce=0,pe,Oe;for(pe=1;pe<=E;pe++)ce=ce+F[pe-1]<<1,ae[pe]=ce;for(Oe=0;Oe<=Q;Oe++){let Te=z[Oe*2+1];Te!==0&&(z[Oe*2]=ze(ae[Te]++,Te))}},me=()=>{let z,Q,F,ae,ce;const pe=new Array(E+1);for(F=0,ae=0;ae<S-1;ae++)for($[ae]=F,z=0;z<1<<I[ae];z++)V[F++]=ae;for(V[F-1]=ae,ce=0,ae=0;ae<16;ae++)for(O[ae]=ce,z=0;z<1<<L[ae];z++)q[ce++]=ae;for(ce>>=7;ae<s;ae++)for(O[ae]=ce<<7,z=0;z<1<<L[ae]-7;z++)q[256+ce++]=ae;for(Q=0;Q<=E;Q++)pe[Q]=0;for(z=0;z<=143;)H[z*2+1]=8,z++,pe[8]++;for(;z<=255;)H[z*2+1]=9,z++,pe[9]++;for(;z<=279;)H[z*2+1]=7,z++,pe[7]++;for(;z<=287;)H[z*2+1]=8,z++,pe[8]++;for(Fe(H,l+1,pe),z=0;z<s;z++)W[z*2+1]=5,W[z*2]=ze(z,5);J=new j(H,I,k+1,l,E),oe=new j(W,L,0,s,E),ie=new j(new Array(0),Y,0,y,u)},ke=z=>{let Q;for(Q=0;Q<l;Q++)z.dyn_ltree[Q*2]=0;for(Q=0;Q<s;Q++)z.dyn_dtree[Q*2]=0;for(Q=0;Q<y;Q++)z.bl_tree[Q*2]=0;z.dyn_ltree[_*2]=1,z.opt_len=z.static_len=0,z.sym_next=z.matches=0},Qe=z=>{z.bi_valid>8?fe(z,z.bi_buf):z.bi_valid>0&&(z.pending_buf[z.pending++]=z.bi_buf),z.bi_buf=0,z.bi_valid=0},Je=(z,Q,F,ae)=>{const ce=Q*2,pe=F*2;return z[ce]<z[pe]||z[ce]===z[pe]&&ae[Q]<=ae[F]},Ye=(z,Q,F)=>{const ae=z.heap[F];let ce=F<<1;for(;ce<=z.heap_len&&(ce<z.heap_len&&Je(Q,z.heap[ce+1],z.heap[ce],z.depth)&&ce++,!Je(Q,ae,z.heap[ce],z.depth));)z.heap[F]=z.heap[ce],F=ce,ce<<=1;z.heap[F]=ae},nt=(z,Q,F)=>{let ae,ce,pe=0,Oe,Te;if(z.sym_next!==0)do ae=z.pending_buf[z.sym_buf+pe++]&255,ae+=(z.pending_buf[z.sym_buf+pe++]&255)<<8,ce=z.pending_buf[z.sym_buf+pe++],ae===0?ye(z,ce,Q):(Oe=V[ce],ye(z,Oe+k+1,Q),Te=I[Oe],Te!==0&&(ce-=$[Oe],ue(z,ce,Te)),ae--,Oe=de(ae),ye(z,Oe,F),Te=L[Oe],Te!==0&&(ae-=O[Oe],ue(z,ae,Te)));while(pe<z.sym_next);ye(z,_,Q)},rt=(z,Q)=>{const F=Q.dyn_tree,ae=Q.stat_desc.static_tree,ce=Q.stat_desc.has_stree,pe=Q.stat_desc.elems;let Oe,Te,wt=-1,be;for(z.heap_len=0,z.heap_max=A,Oe=0;Oe<pe;Oe++)F[Oe*2]!==0?(z.heap[++z.heap_len]=wt=Oe,z.depth[Oe]=0):F[Oe*2+1]=0;for(;z.heap_len<2;)be=z.heap[++z.heap_len]=wt<2?++wt:0,F[be*2]=1,z.depth[be]=0,z.opt_len--,ce&&(z.static_len-=ae[be*2+1]);for(Q.max_code=wt,Oe=z.heap_len>>1;Oe>=1;Oe--)Ye(z,F,Oe);be=pe;do Oe=z.heap[1],z.heap[1]=z.heap[z.heap_len--],Ye(z,F,1),Te=z.heap[1],z.heap[--z.heap_max]=Oe,z.heap[--z.heap_max]=Te,F[be*2]=F[Oe*2]+F[Te*2],z.depth[be]=(z.depth[Oe]>=z.depth[Te]?z.depth[Oe]:z.depth[Te])+1,F[Oe*2+1]=F[Te*2+1]=be,z.heap[1]=be++,Ye(z,F,1);while(z.heap_len>=2);z.heap[--z.heap_max]=z.heap[1],We(z,Q),Fe(F,wt,z.bl_count)},et=(z,Q,F)=>{let ae,ce=-1,pe,Oe=Q[1],Te=0,wt=7,be=4;for(Oe===0&&(wt=138,be=3),Q[(F+1)*2+1]=65535,ae=0;ae<=F;ae++)pe=Oe,Oe=Q[(ae+1)*2+1],!(++Te<wt&&pe===Oe)&&(Te<be?z.bl_tree[pe*2]+=Te:pe!==0?(pe!==ce&&z.bl_tree[pe*2]++,z.bl_tree[M*2]++):Te<=10?z.bl_tree[R*2]++:z.bl_tree[N*2]++,Te=0,ce=pe,Oe===0?(wt=138,be=3):pe===Oe?(wt=6,be=3):(wt=7,be=4))},Ke=(z,Q,F)=>{let ae,ce=-1,pe,Oe=Q[1],Te=0,wt=7,be=4;for(Oe===0&&(wt=138,be=3),ae=0;ae<=F;ae++)if(pe=Oe,Oe=Q[(ae+1)*2+1],!(++Te<wt&&pe===Oe)){if(Te<be)do ye(z,pe,z.bl_tree);while(--Te!==0);else pe!==0?(pe!==ce&&(ye(z,pe,z.bl_tree),Te--),ye(z,M,z.bl_tree),ue(z,Te-3,2)):Te<=10?(ye(z,R,z.bl_tree),ue(z,Te-3,3)):(ye(z,N,z.bl_tree),ue(z,Te-11,7));Te=0,ce=pe,Oe===0?(wt=138,be=3):pe===Oe?(wt=6,be=3):(wt=7,be=4)}},Ue=z=>{let Q;for(et(z,z.dyn_ltree,z.l_desc.max_code),et(z,z.dyn_dtree,z.d_desc.max_code),rt(z,z.bl_desc),Q=y-1;Q>=3&&z.bl_tree[B[Q]*2+1]===0;Q--);return z.opt_len+=3*(Q+1)+5+5+4,Q},He=(z,Q,F,ae)=>{let ce;for(ue(z,Q-257,5),ue(z,F-1,5),ue(z,ae-4,4),ce=0;ce<ae;ce++)ue(z,z.bl_tree[B[ce]*2+1],3);Ke(z,z.dyn_ltree,Q-1),Ke(z,z.dyn_dtree,F-1)},mt=z=>{let Q=4093624447,F;for(F=0;F<=31;F++,Q>>>=1)if(Q&1&&z.dyn_ltree[F*2]!==0)return c;if(z.dyn_ltree[18]!==0||z.dyn_ltree[20]!==0||z.dyn_ltree[26]!==0)return h;for(F=32;F<k;F++)if(z.dyn_ltree[F*2]!==0)return h;return c};let ht=!1;const te=z=>{ht||(me(),ht=!0),z.l_desc=new he(z.dyn_ltree,J),z.d_desc=new he(z.dyn_dtree,oe),z.bl_desc=new he(z.bl_tree,ie),z.bi_buf=0,z.bi_valid=0,ke(z)},se=(z,Q,F,ae)=>{ue(z,(g<<1)+(ae?1:0),3),Qe(z),fe(z,F),fe(z,~F),F&&z.pending_buf.set(z.window.subarray(Q,Q+F),z.pending),z.pending+=F},le=z=>{ue(z,x<<1,3),ye(z,_,H),$e(z)},Se=(z,Q,F,ae)=>{let ce,pe,Oe=0;z.level>0?(z.strm.data_type===v&&(z.strm.data_type=mt(z)),rt(z,z.l_desc),rt(z,z.d_desc),Oe=Ue(z),ce=z.opt_len+3+7>>>3,pe=z.static_len+3+7>>>3,pe<=ce&&(ce=pe)):ce=pe=F+5,F+4<=ce&&Q!==-1?se(z,Q,F,ae):z.strategy===o||pe===ce?(ue(z,(x<<1)+(ae?1:0),3),nt(z,H,W)):(ue(z,(f<<1)+(ae?1:0),3),He(z,z.l_desc.max_code+1,z.d_desc.max_code+1,Oe+1),nt(z,z.dyn_ltree,z.dyn_dtree)),ke(z),ae&&Qe(z)},we=(z,Q,F)=>(z.pending_buf[z.sym_buf+z.sym_next++]=Q,z.pending_buf[z.sym_buf+z.sym_next++]=Q>>8,z.pending_buf[z.sym_buf+z.sym_next++]=F,Q===0?z.dyn_ltree[F*2]++:(z.matches++,Q--,z.dyn_ltree[(V[F]+k+1)*2]++,z.dyn_dtree[de(Q)*2]++),z.sym_next===z.sym_end);var Xe=te,je=se,K=Se,xe=we,Me=le,Ze={_tr_init:Xe,_tr_stored_block:je,_tr_flush_block:K,_tr_tally:xe,_tr_align:Me},_e=(z,Q,F,ae)=>{let ce=z&65535|0,pe=z>>>16&65535|0,Oe=0;for(;F!==0;){Oe=F>2e3?2e3:F,F-=Oe;do ce=ce+Q[ae++]|0,pe=pe+ce|0;while(--Oe);ce%=65521,pe%=65521}return ce|pe<<16|0};const Ve=()=>{let z,Q=[];for(var F=0;F<256;F++){z=F;for(var ae=0;ae<8;ae++)z=z&1?3988292384^z>>>1:z>>>1;Q[F]=z}return Q},ee=new Uint32Array(Ve());var Pe=(z,Q,F,ae)=>{const ce=ee,pe=ae+F;z^=-1;for(let Oe=ae;Oe<pe;Oe++)z=z>>>8^ce[(z^Q[Oe])&255];return z^-1},at={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},X={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Re,_tr_stored_block:Ae,_tr_flush_block:ne,_tr_tally:ve,_tr_align:Ne}=Ze,{Z_NO_FLUSH:gt,Z_PARTIAL_FLUSH:ft,Z_FULL_FLUSH:vt,Z_FINISH:Tt,Z_BLOCK:xr,Z_OK:Bt,Z_STREAM_END:jt,Z_STREAM_ERROR:qt,Z_DATA_ERROR:mr,Z_BUF_ERROR:_r,Z_DEFAULT_COMPRESSION:En,Z_FILTERED:Mn,Z_HUFFMAN_ONLY:Kt,Z_RLE:ar,Z_FIXED:cr,Z_DEFAULT_STRATEGY:Gr,Z_UNKNOWN:zr,Z_DEFLATED:dn}=X,_i=9,xi=15,wi=8,ei=286,dr=30,bi=19,$n=2*ei+1,$s=15,Yt=3,Tn=258,fn=Tn+Yt+1,Wi=32,Ir=42,Si=57,pn=69,jo=73,Vo=91,Wo=103,Dn=113,ri=666,Tr=1,qn=2,Ei=3,Hi=4,Ho=3,ni=(z,Q)=>(z.msg=at[Q],Q),qs=z=>z*2-(z>4?9:0),_n=z=>{let Q=z.length;for(;--Q>=0;)z[Q]=0},nc=z=>{let Q,F,ae,ce=z.w_size;Q=z.hash_size,ae=Q;do F=z.head[--ae],z.head[ae]=F>=ce?F-ce:0;while(--Q);Q=ce,ae=Q;do F=z.prev[--ae],z.prev[ae]=F>=ce?F-ce:0;while(--Q)};let On=(z,Q,F)=>(Q<<z.hash_shift^F)&z.hash_mask;const Vt=z=>{const Q=z.state;let F=Q.pending;F>z.avail_out&&(F=z.avail_out),F!==0&&(z.output.set(Q.pending_buf.subarray(Q.pending_out,Q.pending_out+F),z.next_out),z.next_out+=F,Q.pending_out+=F,z.total_out+=F,z.avail_out-=F,Q.pending-=F,Q.pending===0&&(Q.pending_out=0))},Qr=(z,Q)=>{ne(z,z.block_start>=0?z.block_start:-1,z.strstart-z.block_start,Q),z.block_start=z.strstart,Vt(z.strm)},rr=(z,Q)=>{z.pending_buf[z.pending++]=Q},Ai=(z,Q)=>{z.pending_buf[z.pending++]=Q>>>8&255,z.pending_buf[z.pending++]=Q&255},Xs=(z,Q,F,ae)=>{let ce=z.avail_in;return ce>ae&&(ce=ae),ce===0?0:(z.avail_in-=ce,Q.set(z.input.subarray(z.next_in,z.next_in+ce),F),z.state.wrap===1?z.adler=_e(z.adler,Q,ce,F):z.state.wrap===2&&(z.adler=Pe(z.adler,Q,ce,F)),z.next_in+=ce,z.total_in+=ce,ce)},$o=(z,Q)=>{let F=z.max_chain_length,ae=z.strstart,ce,pe,Oe=z.prev_length,Te=z.nice_match;const wt=z.strstart>z.w_size-fn?z.strstart-(z.w_size-fn):0,be=z.window,Le=z.w_mask,Jt=z.prev,ut=z.strstart+Tn;let tt=be[ae+Oe-1],pr=be[ae+Oe];z.prev_length>=z.good_match&&(F>>=2),Te>z.lookahead&&(Te=z.lookahead);do if(ce=Q,!(be[ce+Oe]!==pr||be[ce+Oe-1]!==tt||be[ce]!==be[ae]||be[++ce]!==be[ae+1])){ae+=2,ce++;do;while(be[++ae]===be[++ce]&&be[++ae]===be[++ce]&&be[++ae]===be[++ce]&&be[++ae]===be[++ce]&&be[++ae]===be[++ce]&&be[++ae]===be[++ce]&&be[++ae]===be[++ce]&&be[++ae]===be[++ce]&&ae<ut);if(pe=Tn-(ut-ae),ae=ut-Tn,pe>Oe){if(z.match_start=Q,Oe=pe,pe>=Te)break;tt=be[ae+Oe-1],pr=be[ae+Oe]}}while((Q=Jt[Q&Le])>wt&&--F!==0);return Oe<=z.lookahead?Oe:z.lookahead},Mi=z=>{const Q=z.w_size;let F,ae,ce;do{if(ae=z.window_size-z.lookahead-z.strstart,z.strstart>=Q+(Q-fn)&&(z.window.set(z.window.subarray(Q,Q+Q-ae),0),z.match_start-=Q,z.strstart-=Q,z.block_start-=Q,z.insert>z.strstart&&(z.insert=z.strstart),nc(z),ae+=Q),z.strm.avail_in===0)break;if(F=Xs(z.strm,z.window,z.strstart+z.lookahead,ae),z.lookahead+=F,z.lookahead+z.insert>=Yt)for(ce=z.strstart-z.insert,z.ins_h=z.window[ce],z.ins_h=On(z,z.ins_h,z.window[ce+1]);z.insert&&(z.ins_h=On(z,z.ins_h,z.window[ce+Yt-1]),z.prev[ce&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=ce,ce++,z.insert--,!(z.lookahead+z.insert<Yt)););}while(z.lookahead<fn&&z.strm.avail_in!==0)},Js=(z,Q)=>{let F=z.pending_buf_size-5>z.w_size?z.w_size:z.pending_buf_size-5,ae,ce,pe,Oe=0,Te=z.strm.avail_in;do{if(ae=65535,pe=z.bi_valid+42>>3,z.strm.avail_out<pe||(pe=z.strm.avail_out-pe,ce=z.strstart-z.block_start,ae>ce+z.strm.avail_in&&(ae=ce+z.strm.avail_in),ae>pe&&(ae=pe),ae<F&&(ae===0&&Q!==Tt||Q===gt||ae!==ce+z.strm.avail_in)))break;Oe=Q===Tt&&ae===ce+z.strm.avail_in?1:0,Ae(z,0,0,Oe),z.pending_buf[z.pending-4]=ae,z.pending_buf[z.pending-3]=ae>>8,z.pending_buf[z.pending-2]=~ae,z.pending_buf[z.pending-1]=~ae>>8,Vt(z.strm),ce&&(ce>ae&&(ce=ae),z.strm.output.set(z.window.subarray(z.block_start,z.block_start+ce),z.strm.next_out),z.strm.next_out+=ce,z.strm.avail_out-=ce,z.strm.total_out+=ce,z.block_start+=ce,ae-=ce),ae&&(Xs(z.strm,z.strm.output,z.strm.next_out,ae),z.strm.next_out+=ae,z.strm.avail_out-=ae,z.strm.total_out+=ae)}while(Oe===0);return Te-=z.strm.avail_in,Te&&(Te>=z.w_size?(z.matches=2,z.window.set(z.strm.input.subarray(z.strm.next_in-z.w_size,z.strm.next_in),0),z.strstart=z.w_size,z.insert=z.strstart):(z.window_size-z.strstart<=Te&&(z.strstart-=z.w_size,z.window.set(z.window.subarray(z.w_size,z.w_size+z.strstart),0),z.matches<2&&z.matches++,z.insert>z.strstart&&(z.insert=z.strstart)),z.window.set(z.strm.input.subarray(z.strm.next_in-Te,z.strm.next_in),z.strstart),z.strstart+=Te,z.insert+=Te>z.w_size-z.insert?z.w_size-z.insert:Te),z.block_start=z.strstart),z.high_water<z.strstart&&(z.high_water=z.strstart),Oe?Hi:Q!==gt&&Q!==Tt&&z.strm.avail_in===0&&z.strstart===z.block_start?qn:(pe=z.window_size-z.strstart,z.strm.avail_in>pe&&z.block_start>=z.w_size&&(z.block_start-=z.w_size,z.strstart-=z.w_size,z.window.set(z.window.subarray(z.w_size,z.w_size+z.strstart),0),z.matches<2&&z.matches++,pe+=z.w_size,z.insert>z.strstart&&(z.insert=z.strstart)),pe>z.strm.avail_in&&(pe=z.strm.avail_in),pe&&(Xs(z.strm,z.window,z.strstart,pe),z.strstart+=pe,z.insert+=pe>z.w_size-z.insert?z.w_size-z.insert:pe),z.high_water<z.strstart&&(z.high_water=z.strstart),pe=z.bi_valid+42>>3,pe=z.pending_buf_size-pe>65535?65535:z.pending_buf_size-pe,F=pe>z.w_size?z.w_size:pe,ce=z.strstart-z.block_start,(ce>=F||(ce||Q===Tt)&&Q!==gt&&z.strm.avail_in===0&&ce<=pe)&&(ae=ce>pe?pe:ce,Oe=Q===Tt&&z.strm.avail_in===0&&ae===ce?1:0,Ae(z,z.block_start,ae,Oe),z.block_start+=ae,Vt(z.strm)),Oe?Ei:Tr)},$i=(z,Q)=>{let F,ae;for(;;){if(z.lookahead<fn){if(Mi(z),z.lookahead<fn&&Q===gt)return Tr;if(z.lookahead===0)break}if(F=0,z.lookahead>=Yt&&(z.ins_h=On(z,z.ins_h,z.window[z.strstart+Yt-1]),F=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),F!==0&&z.strstart-F<=z.w_size-fn&&(z.match_length=$o(z,F)),z.match_length>=Yt)if(ae=ve(z,z.strstart-z.match_start,z.match_length-Yt),z.lookahead-=z.match_length,z.match_length<=z.max_lazy_match&&z.lookahead>=Yt){z.match_length--;do z.strstart++,z.ins_h=On(z,z.ins_h,z.window[z.strstart+Yt-1]),F=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart;while(--z.match_length!==0);z.strstart++}else z.strstart+=z.match_length,z.match_length=0,z.ins_h=z.window[z.strstart],z.ins_h=On(z,z.ins_h,z.window[z.strstart+1]);else ae=ve(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++;if(ae&&(Qr(z,!1),z.strm.avail_out===0))return Tr}return z.insert=z.strstart<Yt-1?z.strstart:Yt-1,Q===Tt?(Qr(z,!0),z.strm.avail_out===0?Ei:Hi):z.sym_next&&(Qr(z,!1),z.strm.avail_out===0)?Tr:qn},mn=(z,Q)=>{let F,ae,ce;for(;;){if(z.lookahead<fn){if(Mi(z),z.lookahead<fn&&Q===gt)return Tr;if(z.lookahead===0)break}if(F=0,z.lookahead>=Yt&&(z.ins_h=On(z,z.ins_h,z.window[z.strstart+Yt-1]),F=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),z.prev_length=z.match_length,z.prev_match=z.match_start,z.match_length=Yt-1,F!==0&&z.prev_length<z.max_lazy_match&&z.strstart-F<=z.w_size-fn&&(z.match_length=$o(z,F),z.match_length<=5&&(z.strategy===Mn||z.match_length===Yt&&z.strstart-z.match_start>4096)&&(z.match_length=Yt-1)),z.prev_length>=Yt&&z.match_length<=z.prev_length){ce=z.strstart+z.lookahead-Yt,ae=ve(z,z.strstart-1-z.prev_match,z.prev_length-Yt),z.lookahead-=z.prev_length-1,z.prev_length-=2;do++z.strstart<=ce&&(z.ins_h=On(z,z.ins_h,z.window[z.strstart+Yt-1]),F=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart);while(--z.prev_length!==0);if(z.match_available=0,z.match_length=Yt-1,z.strstart++,ae&&(Qr(z,!1),z.strm.avail_out===0))return Tr}else if(z.match_available){if(ae=ve(z,0,z.window[z.strstart-1]),ae&&Qr(z,!1),z.strstart++,z.lookahead--,z.strm.avail_out===0)return Tr}else z.match_available=1,z.strstart++,z.lookahead--}return z.match_available&&(ae=ve(z,0,z.window[z.strstart-1]),z.match_available=0),z.insert=z.strstart<Yt-1?z.strstart:Yt-1,Q===Tt?(Qr(z,!0),z.strm.avail_out===0?Ei:Hi):z.sym_next&&(Qr(z,!1),z.strm.avail_out===0)?Tr:qn},ii=(z,Q)=>{let F,ae,ce,pe;const Oe=z.window;for(;;){if(z.lookahead<=Tn){if(Mi(z),z.lookahead<=Tn&&Q===gt)return Tr;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=Yt&&z.strstart>0&&(ce=z.strstart-1,ae=Oe[ce],ae===Oe[++ce]&&ae===Oe[++ce]&&ae===Oe[++ce])){pe=z.strstart+Tn;do;while(ae===Oe[++ce]&&ae===Oe[++ce]&&ae===Oe[++ce]&&ae===Oe[++ce]&&ae===Oe[++ce]&&ae===Oe[++ce]&&ae===Oe[++ce]&&ae===Oe[++ce]&&ce<pe);z.match_length=Tn-(pe-ce),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=Yt?(F=ve(z,1,z.match_length-Yt),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(F=ve(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),F&&(Qr(z,!1),z.strm.avail_out===0))return Tr}return z.insert=0,Q===Tt?(Qr(z,!0),z.strm.avail_out===0?Ei:Hi):z.sym_next&&(Qr(z,!1),z.strm.avail_out===0)?Tr:qn},ai=(z,Q)=>{let F;for(;;){if(z.lookahead===0&&(Mi(z),z.lookahead===0)){if(Q===gt)return Tr;break}if(z.match_length=0,F=ve(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,F&&(Qr(z,!1),z.strm.avail_out===0))return Tr}return z.insert=0,Q===Tt?(Qr(z,!0),z.strm.avail_out===0?Ei:Hi):z.sym_next&&(Qr(z,!1),z.strm.avail_out===0)?Tr:qn};function Kr(z,Q,F,ae,ce){this.good_length=z,this.max_lazy=Q,this.nice_length=F,this.max_chain=ae,this.func=ce}const Yn=[new Kr(0,0,0,0,Js),new Kr(4,4,8,4,$i),new Kr(4,5,16,8,$i),new Kr(4,6,32,32,$i),new Kr(4,4,16,16,mn),new Kr(8,16,32,32,mn),new Kr(8,16,128,128,mn),new Kr(8,32,128,256,mn),new Kr(32,128,258,1024,mn),new Kr(32,258,258,4096,mn)],li=z=>{z.window_size=2*z.w_size,_n(z.head),z.max_lazy_match=Yn[z.level].max_lazy,z.good_match=Yn[z.level].good_length,z.nice_match=Yn[z.level].nice_length,z.max_chain_length=Yn[z.level].max_chain,z.strstart=0,z.block_start=0,z.lookahead=0,z.insert=0,z.match_length=z.prev_length=Yt-1,z.match_available=0,z.ins_h=0};function ic(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=dn,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array($n*2),this.dyn_dtree=new Uint16Array((2*dr+1)*2),this.bl_tree=new Uint16Array((2*bi+1)*2),_n(this.dyn_ltree),_n(this.dyn_dtree),_n(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array($s+1),this.heap=new Uint16Array(2*ei+1),_n(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*ei+1),_n(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const qi=z=>{if(!z)return 1;const Q=z.state;return!Q||Q.strm!==z||Q.status!==Ir&&Q.status!==Si&&Q.status!==pn&&Q.status!==jo&&Q.status!==Vo&&Q.status!==Wo&&Q.status!==Dn&&Q.status!==ri?1:0},Yi=z=>{if(qi(z))return ni(z,qt);z.total_in=z.total_out=0,z.data_type=zr;const Q=z.state;return Q.pending=0,Q.pending_out=0,Q.wrap<0&&(Q.wrap=-Q.wrap),Q.status=Q.wrap===2?Si:Q.wrap?Ir:Dn,z.adler=Q.wrap===2?0:1,Q.last_flush=-2,Re(Q),Bt},$a=z=>{const Q=Yi(z);return Q===Bt&&li(z.state),Q},qa=(z,Q)=>qi(z)||z.state.wrap!==2?qt:(z.state.gzhead=Q,Bt),ws=(z,Q,F,ae,ce,pe)=>{if(!z)return qt;let Oe=1;if(Q===En&&(Q=6),ae<0?(Oe=0,ae=-ae):ae>15&&(Oe=2,ae-=16),ce<1||ce>_i||F!==dn||ae<8||ae>15||Q<0||Q>9||pe<0||pe>cr||ae===8&&Oe!==1)return ni(z,qt);ae===8&&(ae=9);const Te=new ic;return z.state=Te,Te.strm=z,Te.status=Ir,Te.wrap=Oe,Te.gzhead=null,Te.w_bits=ae,Te.w_size=1<<Te.w_bits,Te.w_mask=Te.w_size-1,Te.hash_bits=ce+7,Te.hash_size=1<<Te.hash_bits,Te.hash_mask=Te.hash_size-1,Te.hash_shift=~~((Te.hash_bits+Yt-1)/Yt),Te.window=new Uint8Array(Te.w_size*2),Te.head=new Uint16Array(Te.hash_size),Te.prev=new Uint16Array(Te.w_size),Te.lit_bufsize=1<<ce+6,Te.pending_buf_size=Te.lit_bufsize*4,Te.pending_buf=new Uint8Array(Te.pending_buf_size),Te.sym_buf=Te.lit_bufsize,Te.sym_end=(Te.lit_bufsize-1)*3,Te.level=Q,Te.strategy=pe,Te.method=F,$a(z)},Ya=(z,Q)=>ws(z,Q,dn,xi,wi,Gr),hc=(z,Q)=>{if(qi(z)||Q>xr||Q<0)return z?ni(z,qt):qt;const F=z.state;if(!z.output||z.avail_in!==0&&!z.input||F.status===ri&&Q!==Tt)return ni(z,z.avail_out===0?_r:qt);const ae=F.last_flush;if(F.last_flush=Q,F.pending!==0){if(Vt(z),z.avail_out===0)return F.last_flush=-1,Bt}else if(z.avail_in===0&&qs(Q)<=qs(ae)&&Q!==Tt)return ni(z,_r);if(F.status===ri&&z.avail_in!==0)return ni(z,_r);if(F.status===Ir&&F.wrap===0&&(F.status=Dn),F.status===Ir){let ce=dn+(F.w_bits-8<<4)<<8,pe=-1;if(F.strategy>=Kt||F.level<2?pe=0:F.level<6?pe=1:F.level===6?pe=2:pe=3,ce|=pe<<6,F.strstart!==0&&(ce|=Wi),ce+=31-ce%31,Ai(F,ce),F.strstart!==0&&(Ai(F,z.adler>>>16),Ai(F,z.adler&65535)),z.adler=1,F.status=Dn,Vt(z),F.pending!==0)return F.last_flush=-1,Bt}if(F.status===Si){if(z.adler=0,rr(F,31),rr(F,139),rr(F,8),F.gzhead)rr(F,(F.gzhead.text?1:0)+(F.gzhead.hcrc?2:0)+(F.gzhead.extra?4:0)+(F.gzhead.name?8:0)+(F.gzhead.comment?16:0)),rr(F,F.gzhead.time&255),rr(F,F.gzhead.time>>8&255),rr(F,F.gzhead.time>>16&255),rr(F,F.gzhead.time>>24&255),rr(F,F.level===9?2:F.strategy>=Kt||F.level<2?4:0),rr(F,F.gzhead.os&255),F.gzhead.extra&&F.gzhead.extra.length&&(rr(F,F.gzhead.extra.length&255),rr(F,F.gzhead.extra.length>>8&255)),F.gzhead.hcrc&&(z.adler=Pe(z.adler,F.pending_buf,F.pending,0)),F.gzindex=0,F.status=pn;else if(rr(F,0),rr(F,0),rr(F,0),rr(F,0),rr(F,0),rr(F,F.level===9?2:F.strategy>=Kt||F.level<2?4:0),rr(F,Ho),F.status=Dn,Vt(z),F.pending!==0)return F.last_flush=-1,Bt}if(F.status===pn){if(F.gzhead.extra){let ce=F.pending,pe=(F.gzhead.extra.length&65535)-F.gzindex;for(;F.pending+pe>F.pending_buf_size;){let Te=F.pending_buf_size-F.pending;if(F.pending_buf.set(F.gzhead.extra.subarray(F.gzindex,F.gzindex+Te),F.pending),F.pending=F.pending_buf_size,F.gzhead.hcrc&&F.pending>ce&&(z.adler=Pe(z.adler,F.pending_buf,F.pending-ce,ce)),F.gzindex+=Te,Vt(z),F.pending!==0)return F.last_flush=-1,Bt;ce=0,pe-=Te}let Oe=new Uint8Array(F.gzhead.extra);F.pending_buf.set(Oe.subarray(F.gzindex,F.gzindex+pe),F.pending),F.pending+=pe,F.gzhead.hcrc&&F.pending>ce&&(z.adler=Pe(z.adler,F.pending_buf,F.pending-ce,ce)),F.gzindex=0}F.status=jo}if(F.status===jo){if(F.gzhead.name){let ce=F.pending,pe;do{if(F.pending===F.pending_buf_size){if(F.gzhead.hcrc&&F.pending>ce&&(z.adler=Pe(z.adler,F.pending_buf,F.pending-ce,ce)),Vt(z),F.pending!==0)return F.last_flush=-1,Bt;ce=0}F.gzindex<F.gzhead.name.length?pe=F.gzhead.name.charCodeAt(F.gzindex++)&255:pe=0,rr(F,pe)}while(pe!==0);F.gzhead.hcrc&&F.pending>ce&&(z.adler=Pe(z.adler,F.pending_buf,F.pending-ce,ce)),F.gzindex=0}F.status=Vo}if(F.status===Vo){if(F.gzhead.comment){let ce=F.pending,pe;do{if(F.pending===F.pending_buf_size){if(F.gzhead.hcrc&&F.pending>ce&&(z.adler=Pe(z.adler,F.pending_buf,F.pending-ce,ce)),Vt(z),F.pending!==0)return F.last_flush=-1,Bt;ce=0}F.gzindex<F.gzhead.comment.length?pe=F.gzhead.comment.charCodeAt(F.gzindex++)&255:pe=0,rr(F,pe)}while(pe!==0);F.gzhead.hcrc&&F.pending>ce&&(z.adler=Pe(z.adler,F.pending_buf,F.pending-ce,ce))}F.status=Wo}if(F.status===Wo){if(F.gzhead.hcrc){if(F.pending+2>F.pending_buf_size&&(Vt(z),F.pending!==0))return F.last_flush=-1,Bt;rr(F,z.adler&255),rr(F,z.adler>>8&255),z.adler=0}if(F.status=Dn,Vt(z),F.pending!==0)return F.last_flush=-1,Bt}if(z.avail_in!==0||F.lookahead!==0||Q!==gt&&F.status!==ri){let ce=F.level===0?Js(F,Q):F.strategy===Kt?ai(F,Q):F.strategy===ar?ii(F,Q):Yn[F.level].func(F,Q);if((ce===Ei||ce===Hi)&&(F.status=ri),ce===Tr||ce===Ei)return z.avail_out===0&&(F.last_flush=-1),Bt;if(ce===qn&&(Q===ft?Ne(F):Q!==xr&&(Ae(F,0,0,!1),Q===vt&&(_n(F.head),F.lookahead===0&&(F.strstart=0,F.block_start=0,F.insert=0))),Vt(z),z.avail_out===0))return F.last_flush=-1,Bt}return Q!==Tt?Bt:F.wrap<=0?jt:(F.wrap===2?(rr(F,z.adler&255),rr(F,z.adler>>8&255),rr(F,z.adler>>16&255),rr(F,z.adler>>24&255),rr(F,z.total_in&255),rr(F,z.total_in>>8&255),rr(F,z.total_in>>16&255),rr(F,z.total_in>>24&255)):(Ai(F,z.adler>>>16),Ai(F,z.adler&65535)),Vt(z),F.wrap>0&&(F.wrap=-F.wrap),F.pending!==0?Bt:jt)},bs=z=>{if(qi(z))return qt;const Q=z.state.status;return z.state=null,Q===Dn?ni(z,mr):Bt},Ss=(z,Q)=>{let F=Q.length;if(qi(z))return qt;const ae=z.state,ce=ae.wrap;if(ce===2||ce===1&&ae.status!==Ir||ae.lookahead)return qt;if(ce===1&&(z.adler=_e(z.adler,Q,F,0)),ae.wrap=0,F>=ae.w_size){ce===0&&(_n(ae.head),ae.strstart=0,ae.block_start=0,ae.insert=0);let wt=new Uint8Array(ae.w_size);wt.set(Q.subarray(F-ae.w_size,F),0),Q=wt,F=ae.w_size}const pe=z.avail_in,Oe=z.next_in,Te=z.input;for(z.avail_in=F,z.next_in=0,z.input=Q,Mi(ae);ae.lookahead>=Yt;){let wt=ae.strstart,be=ae.lookahead-(Yt-1);do ae.ins_h=On(ae,ae.ins_h,ae.window[wt+Yt-1]),ae.prev[wt&ae.w_mask]=ae.head[ae.ins_h],ae.head[ae.ins_h]=wt,wt++;while(--be);ae.strstart=wt,ae.lookahead=Yt-1,Mi(ae)}return ae.strstart+=ae.lookahead,ae.block_start=ae.strstart,ae.insert=ae.lookahead,ae.lookahead=0,ae.match_length=ae.prev_length=Yt-1,ae.match_available=0,z.next_in=Oe,z.input=Te,z.avail_in=pe,ae.wrap=ce,Bt};var Xi=Ya,Qs=ws,dc=$a,fc=Yi,qo=qa,Ks=hc,Yo=bs,Xa=Ss,ci="pako deflate (from Nodeca project)",Ti={deflateInit:Xi,deflateInit2:Qs,deflateReset:dc,deflateResetKeep:fc,deflateSetHeader:qo,deflate:Ks,deflateEnd:Yo,deflateSetDictionary:Xa,deflateInfo:ci};const eo=(z,Q)=>Object.prototype.hasOwnProperty.call(z,Q);var Za=function(z){const Q=Array.prototype.slice.call(arguments,1);for(;Q.length;){const F=Q.shift();if(F){if(typeof F!="object")throw new TypeError(F+"must be non-object");for(const ae in F)eo(F,ae)&&(z[ae]=F[ae])}}return z},ro=z=>{let Q=0;for(let ae=0,ce=z.length;ae<ce;ae++)Q+=z[ae].length;const F=new Uint8Array(Q);for(let ae=0,ce=0,pe=z.length;ae<pe;ae++){let Oe=z[ae];F.set(Oe,ce),ce+=Oe.length}return F},ki={assign:Za,flattenChunks:ro};let Xo=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Xo=!1}const Fr=new Uint8Array(256);for(let z=0;z<256;z++)Fr[z]=z>=252?6:z>=248?5:z>=240?4:z>=224?3:z>=192?2:1;Fr[254]=Fr[254]=1;var Zi=z=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(z);let Q,F,ae,ce,pe,Oe=z.length,Te=0;for(ce=0;ce<Oe;ce++)F=z.charCodeAt(ce),(F&64512)===55296&&ce+1<Oe&&(ae=z.charCodeAt(ce+1),(ae&64512)===56320&&(F=65536+(F-55296<<10)+(ae-56320),ce++)),Te+=F<128?1:F<2048?2:F<65536?3:4;for(Q=new Uint8Array(Te),pe=0,ce=0;pe<Te;ce++)F=z.charCodeAt(ce),(F&64512)===55296&&ce+1<Oe&&(ae=z.charCodeAt(ce+1),(ae&64512)===56320&&(F=65536+(F-55296<<10)+(ae-56320),ce++)),F<128?Q[pe++]=F:F<2048?(Q[pe++]=192|F>>>6,Q[pe++]=128|F&63):F<65536?(Q[pe++]=224|F>>>12,Q[pe++]=128|F>>>6&63,Q[pe++]=128|F&63):(Q[pe++]=240|F>>>18,Q[pe++]=128|F>>>12&63,Q[pe++]=128|F>>>6&63,Q[pe++]=128|F&63);return Q};const Zo=(z,Q)=>{if(Q<65534&&z.subarray&&Xo)return String.fromCharCode.apply(null,z.length===Q?z:z.subarray(0,Q));let F="";for(let ae=0;ae<Q;ae++)F+=String.fromCharCode(z[ae]);return F};var Cs=(z,Q)=>{const F=Q||z.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(z.subarray(0,Q));let ae,ce;const pe=new Array(F*2);for(ce=0,ae=0;ae<F;){let Oe=z[ae++];if(Oe<128){pe[ce++]=Oe;continue}let Te=Fr[Oe];if(Te>4){pe[ce++]=65533,ae+=Te-1;continue}for(Oe&=Te===2?31:Te===3?15:7;Te>1&&ae<F;)Oe=Oe<<6|z[ae++]&63,Te--;if(Te>1){pe[ce++]=65533;continue}Oe<65536?pe[ce++]=Oe:(Oe-=65536,pe[ce++]=55296|Oe>>10&1023,pe[ce++]=56320|Oe&1023)}return Zo(pe,ce)},pc=(z,Q)=>{Q=Q||z.length,Q>z.length&&(Q=z.length);let F=Q-1;for(;F>=0&&(z[F]&192)===128;)F--;return F<0||F===0?Q:F+Fr[z[F]]>Q?F:Q},zi={string2buf:Zi,buf2string:Cs,utf8border:pc};function Jo(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Ji=Jo;const Es=Object.prototype.toString,{Z_NO_FLUSH:Ja,Z_SYNC_FLUSH:mc,Z_FULL_FLUSH:gc,Z_FINISH:yc,Z_OK:Qi,Z_STREAM_END:vc,Z_DEFAULT_COMPRESSION:_c,Z_DEFAULT_STRATEGY:xc,Z_DEFLATED:wc}=X;function As(z){this.options=ki.assign({level:_c,method:wc,chunkSize:16384,windowBits:15,memLevel:8,strategy:xc},z||{});let Q=this.options;Q.raw&&Q.windowBits>0?Q.windowBits=-Q.windowBits:Q.gzip&&Q.windowBits>0&&Q.windowBits<16&&(Q.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ji,this.strm.avail_out=0;let F=Ti.deflateInit2(this.strm,Q.level,Q.method,Q.windowBits,Q.memLevel,Q.strategy);if(F!==Qi)throw new Error(at[F]);if(Q.header&&Ti.deflateSetHeader(this.strm,Q.header),Q.dictionary){let ae;if(typeof Q.dictionary=="string"?ae=zi.string2buf(Q.dictionary):Es.call(Q.dictionary)==="[object ArrayBuffer]"?ae=new Uint8Array(Q.dictionary):ae=Q.dictionary,F=Ti.deflateSetDictionary(this.strm,ae),F!==Qi)throw new Error(at[F]);this._dict_set=!0}}As.prototype.push=function(z,Q){const F=this.strm,ae=this.options.chunkSize;let ce,pe;if(this.ended)return!1;for(Q===~~Q?pe=Q:pe=Q===!0?yc:Ja,typeof z=="string"?F.input=zi.string2buf(z):Es.call(z)==="[object ArrayBuffer]"?F.input=new Uint8Array(z):F.input=z,F.next_in=0,F.avail_in=F.input.length;;){if(F.avail_out===0&&(F.output=new Uint8Array(ae),F.next_out=0,F.avail_out=ae),(pe===mc||pe===gc)&&F.avail_out<=6){this.onData(F.output.subarray(0,F.next_out)),F.avail_out=0;continue}if(ce=Ti.deflate(F,pe),ce===vc)return F.next_out>0&&this.onData(F.output.subarray(0,F.next_out)),ce=Ti.deflateEnd(this.strm),this.onEnd(ce),this.ended=!0,ce===Qi;if(F.avail_out===0){this.onData(F.output);continue}if(pe>0&&F.next_out>0){this.onData(F.output.subarray(0,F.next_out)),F.avail_out=0;continue}if(F.avail_in===0)break}return!0},As.prototype.onData=function(z){this.chunks.push(z)},As.prototype.onEnd=function(z){z===Qi&&(this.result=ki.flattenChunks(this.chunks)),this.chunks=[],this.err=z,this.msg=this.strm.msg};function no(z,Q){const F=new As(Q);if(F.push(z,!0),F.err)throw F.msg||at[F.err];return F.result}function bc(z,Q){return Q=Q||{},Q.raw=!0,no(z,Q)}function Cc(z,Q){return Q=Q||{},Q.gzip=!0,no(z,Q)}var Ec=As,Ac=no,Qo=bc,Tc=Cc,Rc={Deflate:Ec,deflate:Ac,deflateRaw:Qo,gzip:Tc};const io=16209,Qa=16191;var kc=function(z,Q){let F,ae,ce,pe,Oe,Te,wt,be,Le,Jt,ut,tt,pr,vr,er,Pt,zt,lt,It,Er,tr,Qt,lr,Lt;const Ht=z.state;F=z.next_in,lr=z.input,ae=F+(z.avail_in-5),ce=z.next_out,Lt=z.output,pe=ce-(Q-z.avail_out),Oe=ce+(z.avail_out-257),Te=Ht.dmax,wt=Ht.wsize,be=Ht.whave,Le=Ht.wnext,Jt=Ht.window,ut=Ht.hold,tt=Ht.bits,pr=Ht.lencode,vr=Ht.distcode,er=(1<<Ht.lenbits)-1,Pt=(1<<Ht.distbits)-1;e:do{tt<15&&(ut+=lr[F++]<<tt,tt+=8,ut+=lr[F++]<<tt,tt+=8),zt=pr[ut&er];t:for(;;){if(lt=zt>>>24,ut>>>=lt,tt-=lt,lt=zt>>>16&255,lt===0)Lt[ce++]=zt&65535;else if(lt&16){It=zt&65535,lt&=15,lt&&(tt<lt&&(ut+=lr[F++]<<tt,tt+=8),It+=ut&(1<<lt)-1,ut>>>=lt,tt-=lt),tt<15&&(ut+=lr[F++]<<tt,tt+=8,ut+=lr[F++]<<tt,tt+=8),zt=vr[ut&Pt];r:for(;;){if(lt=zt>>>24,ut>>>=lt,tt-=lt,lt=zt>>>16&255,lt&16){if(Er=zt&65535,lt&=15,tt<lt&&(ut+=lr[F++]<<tt,tt+=8,tt<lt&&(ut+=lr[F++]<<tt,tt+=8)),Er+=ut&(1<<lt)-1,Er>Te){z.msg="invalid distance too far back",Ht.mode=io;break e}if(ut>>>=lt,tt-=lt,lt=ce-pe,Er>lt){if(lt=Er-lt,lt>be&&Ht.sane){z.msg="invalid distance too far back",Ht.mode=io;break e}if(tr=0,Qt=Jt,Le===0){if(tr+=wt-lt,lt<It){It-=lt;do Lt[ce++]=Jt[tr++];while(--lt);tr=ce-Er,Qt=Lt}}else if(Le<lt){if(tr+=wt+Le-lt,lt-=Le,lt<It){It-=lt;do Lt[ce++]=Jt[tr++];while(--lt);if(tr=0,Le<It){lt=Le,It-=lt;do Lt[ce++]=Jt[tr++];while(--lt);tr=ce-Er,Qt=Lt}}}else if(tr+=Le-lt,lt<It){It-=lt;do Lt[ce++]=Jt[tr++];while(--lt);tr=ce-Er,Qt=Lt}for(;It>2;)Lt[ce++]=Qt[tr++],Lt[ce++]=Qt[tr++],Lt[ce++]=Qt[tr++],It-=3;It&&(Lt[ce++]=Qt[tr++],It>1&&(Lt[ce++]=Qt[tr++]))}else{tr=ce-Er;do Lt[ce++]=Lt[tr++],Lt[ce++]=Lt[tr++],Lt[ce++]=Lt[tr++],It-=3;while(It>2);It&&(Lt[ce++]=Lt[tr++],It>1&&(Lt[ce++]=Lt[tr++]))}}else if(lt&64){z.msg="invalid distance code",Ht.mode=io;break e}else{zt=vr[(zt&65535)+(ut&(1<<lt)-1)];continue r}break}}else if(lt&64)if(lt&32){Ht.mode=Qa;break e}else{z.msg="invalid literal/length code",Ht.mode=io;break e}else{zt=pr[(zt&65535)+(ut&(1<<lt)-1)];continue t}break}}while(F<ae&&ce<Oe);It=tt>>3,F-=It,tt-=It<<3,ut&=(1<<tt)-1,z.next_in=F,z.next_out=ce,z.avail_in=F<ae?5+(ae-F):5-(F-ae),z.avail_out=ce<Oe?257+(Oe-ce):257-(ce-Oe),Ht.hold=ut,Ht.bits=tt};const Ki=15,Ka=852,el=592,tl=0,Ko=1,rl=2,ea=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ms=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),zc=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),nl=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var es=(z,Q,F,ae,ce,pe,Oe,Te)=>{const wt=Te.bits;let be=0,Le=0,Jt=0,ut=0,tt=0,pr=0,vr=0,er=0,Pt=0,zt=0,lt,It,Er,tr,Qt,lr=null,Lt;const Ht=new Uint16Array(Ki+1),Vr=new Uint16Array(Ki+1);let xn=null,zo,No,nn;for(be=0;be<=Ki;be++)Ht[be]=0;for(Le=0;Le<ae;Le++)Ht[Q[F+Le]]++;for(tt=wt,ut=Ki;ut>=1&&Ht[ut]===0;ut--);if(tt>ut&&(tt=ut),ut===0)return ce[pe++]=1<<24|64<<16|0,ce[pe++]=1<<24|64<<16|0,Te.bits=1,0;for(Jt=1;Jt<ut&&Ht[Jt]===0;Jt++);for(tt<Jt&&(tt=Jt),er=1,be=1;be<=Ki;be++)if(er<<=1,er-=Ht[be],er<0)return-1;if(er>0&&(z===tl||ut!==1))return-1;for(Vr[1]=0,be=1;be<Ki;be++)Vr[be+1]=Vr[be]+Ht[be];for(Le=0;Le<ae;Le++)Q[F+Le]!==0&&(Oe[Vr[Q[F+Le]]++]=Le);if(z===tl?(lr=xn=Oe,Lt=20):z===Ko?(lr=ea,xn=Ms,Lt=257):(lr=zc,xn=nl,Lt=0),zt=0,Le=0,be=Jt,Qt=pe,pr=tt,vr=0,Er=-1,Pt=1<<tt,tr=Pt-1,z===Ko&&Pt>Ka||z===rl&&Pt>el)return 1;for(;;){zo=be-vr,Oe[Le]+1<Lt?(No=0,nn=Oe[Le]):Oe[Le]>=Lt?(No=xn[Oe[Le]-Lt],nn=lr[Oe[Le]-Lt]):(No=96,nn=0),lt=1<<be-vr,It=1<<pr,Jt=It;do It-=lt,ce[Qt+(zt>>vr)+It]=zo<<24|No<<16|nn|0;while(It!==0);for(lt=1<<be-1;zt&lt;)lt>>=1;if(lt!==0?(zt&=lt-1,zt+=lt):zt=0,Le++,--Ht[be]===0){if(be===ut)break;be=Q[F+Oe[Le]]}if(be>tt&&(zt&tr)!==Er){for(vr===0&&(vr=tt),Qt+=Jt,pr=be-vr,er=1<<pr;pr+vr<ut&&(er-=Ht[pr+vr],!(er<=0));)pr++,er<<=1;if(Pt+=1<<pr,z===Ko&&Pt>Ka||z===rl&&Pt>el)return 1;Er=zt&tr,ce[Er]=tt<<24|pr<<16|Qt-pe|0}}return zt!==0&&(ce[Qt+zt]=be-vr<<24|64<<16|0),Te.bits=tt,0};const il=0,ta=1,ra=2,{Z_FINISH:Ni,Z_BLOCK:Nc,Z_TREES:so,Z_OK:Ii,Z_STREAM_END:sl,Z_NEED_DICT:ol,Z_STREAM_ERROR:Yr,Z_DATA_ERROR:ts,Z_MEM_ERROR:al,Z_BUF_ERROR:oo,Z_DEFLATED:ll}=X,Ts=16180,ao=16181,lo=16182,na=16183,ia=16184,da=16185,cl=16186,ul=16187,hl=16188,dl=16189,uo=16190,Rr=16191,Fi=16192,fa=16193,po=16194,pa=16195,ma=16196,go=16197,fl=16198,yo=16199,Xn=16200,vo=16201,rs=16202,_o=16203,ga=16204,Rs=16205,ui=16206,xo=16207,ya=16208,ur=16209,va=16210,_a=16211,pl=852,ml=592,gl=15,xa=z=>(z>>>24&255)+(z>>>8&65280)+((z&65280)<<8)+((z&255)<<24);function hi(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Zn=z=>{if(!z)return 1;const Q=z.state;return!Q||Q.strm!==z||Q.mode<Ts||Q.mode>_a?1:0},wo=z=>{if(Zn(z))return Yr;const Q=z.state;return z.total_in=z.total_out=Q.total=0,z.msg="",Q.wrap&&(z.adler=Q.wrap&1),Q.mode=Ts,Q.last=0,Q.havedict=0,Q.flags=-1,Q.dmax=32768,Q.head=null,Q.hold=0,Q.bits=0,Q.lencode=Q.lendyn=new Int32Array(pl),Q.distcode=Q.distdyn=new Int32Array(ml),Q.sane=1,Q.back=-1,Ii},yl=z=>{if(Zn(z))return Yr;const Q=z.state;return Q.wsize=0,Q.whave=0,Q.wnext=0,wo(z)},vl=(z,Q)=>{let F;if(Zn(z))return Yr;const ae=z.state;return Q<0?(F=0,Q=-Q):(F=(Q>>4)+5,Q<48&&(Q&=15)),Q&&(Q<8||Q>15)?Yr:(ae.window!==null&&ae.wbits!==Q&&(ae.window=null),ae.wrap=F,ae.wbits=Q,yl(z))},ss=(z,Q)=>{if(!z)return Yr;const F=new hi;z.state=F,F.strm=z,F.window=null,F.mode=Ts;const ae=vl(z,Q);return ae!==Ii&&(z.state=null),ae},Pc=z=>ss(z,gl);let wa=!0,bo,hr;const ba=z=>{if(wa){bo=new Int32Array(512),hr=new Int32Array(32);let Q=0;for(;Q<144;)z.lens[Q++]=8;for(;Q<256;)z.lens[Q++]=9;for(;Q<280;)z.lens[Q++]=7;for(;Q<288;)z.lens[Q++]=8;for(es(ta,z.lens,0,288,bo,0,z.work,{bits:9}),Q=0;Q<32;)z.lens[Q++]=5;es(ra,z.lens,0,32,hr,0,z.work,{bits:5}),wa=!1}z.lencode=bo,z.lenbits=9,z.distcode=hr,z.distbits=5},ks=(z,Q,F,ae)=>{let ce;const pe=z.state;return pe.window===null&&(pe.wsize=1<<pe.wbits,pe.wnext=0,pe.whave=0,pe.window=new Uint8Array(pe.wsize)),ae>=pe.wsize?(pe.window.set(Q.subarray(F-pe.wsize,F),0),pe.wnext=0,pe.whave=pe.wsize):(ce=pe.wsize-pe.wnext,ce>ae&&(ce=ae),pe.window.set(Q.subarray(F-ae,F-ae+ce),pe.wnext),ae-=ce,ae?(pe.window.set(Q.subarray(F-ae,F),0),pe.wnext=ae,pe.whave=pe.wsize):(pe.wnext+=ce,pe.wnext===pe.wsize&&(pe.wnext=0),pe.whave<pe.wsize&&(pe.whave+=ce))),0},zs=(z,Q)=>{let F,ae,ce,pe,Oe,Te,wt,be,Le,Jt,ut,tt,pr,vr,er=0,Pt,zt,lt,It,Er,tr,Qt,lr;const Lt=new Uint8Array(4);let Ht,Vr;const xn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Zn(z)||!z.output||!z.input&&z.avail_in!==0)return Yr;F=z.state,F.mode===Rr&&(F.mode=Fi),Oe=z.next_out,ce=z.output,wt=z.avail_out,pe=z.next_in,ae=z.input,Te=z.avail_in,be=F.hold,Le=F.bits,Jt=Te,ut=wt,lr=Ii;e:for(;;)switch(F.mode){case Ts:if(F.wrap===0){F.mode=Fi;break}for(;Le<16;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}if(F.wrap&2&&be===35615){F.wbits===0&&(F.wbits=15),F.check=0,Lt[0]=be&255,Lt[1]=be>>>8&255,F.check=Pe(F.check,Lt,2,0),be=0,Le=0,F.mode=ao;break}if(F.head&&(F.head.done=!1),!(F.wrap&1)||(((be&255)<<8)+(be>>8))%31){z.msg="incorrect header check",F.mode=ur;break}if((be&15)!==ll){z.msg="unknown compression method",F.mode=ur;break}if(be>>>=4,Le-=4,Qt=(be&15)+8,F.wbits===0&&(F.wbits=Qt),Qt>15||Qt>F.wbits){z.msg="invalid window size",F.mode=ur;break}F.dmax=1<<F.wbits,F.flags=0,z.adler=F.check=1,F.mode=be&512?dl:Rr,be=0,Le=0;break;case ao:for(;Le<16;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}if(F.flags=be,(F.flags&255)!==ll){z.msg="unknown compression method",F.mode=ur;break}if(F.flags&57344){z.msg="unknown header flags set",F.mode=ur;break}F.head&&(F.head.text=be>>8&1),F.flags&512&&F.wrap&4&&(Lt[0]=be&255,Lt[1]=be>>>8&255,F.check=Pe(F.check,Lt,2,0)),be=0,Le=0,F.mode=lo;case lo:for(;Le<32;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}F.head&&(F.head.time=be),F.flags&512&&F.wrap&4&&(Lt[0]=be&255,Lt[1]=be>>>8&255,Lt[2]=be>>>16&255,Lt[3]=be>>>24&255,F.check=Pe(F.check,Lt,4,0)),be=0,Le=0,F.mode=na;case na:for(;Le<16;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}F.head&&(F.head.xflags=be&255,F.head.os=be>>8),F.flags&512&&F.wrap&4&&(Lt[0]=be&255,Lt[1]=be>>>8&255,F.check=Pe(F.check,Lt,2,0)),be=0,Le=0,F.mode=ia;case ia:if(F.flags&1024){for(;Le<16;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}F.length=be,F.head&&(F.head.extra_len=be),F.flags&512&&F.wrap&4&&(Lt[0]=be&255,Lt[1]=be>>>8&255,F.check=Pe(F.check,Lt,2,0)),be=0,Le=0}else F.head&&(F.head.extra=null);F.mode=da;case da:if(F.flags&1024&&(tt=F.length,tt>Te&&(tt=Te),tt&&(F.head&&(Qt=F.head.extra_len-F.length,F.head.extra||(F.head.extra=new Uint8Array(F.head.extra_len)),F.head.extra.set(ae.subarray(pe,pe+tt),Qt)),F.flags&512&&F.wrap&4&&(F.check=Pe(F.check,ae,tt,pe)),Te-=tt,pe+=tt,F.length-=tt),F.length))break e;F.length=0,F.mode=cl;case cl:if(F.flags&2048){if(Te===0)break e;tt=0;do Qt=ae[pe+tt++],F.head&&Qt&&F.length<65536&&(F.head.name+=String.fromCharCode(Qt));while(Qt&&tt<Te);if(F.flags&512&&F.wrap&4&&(F.check=Pe(F.check,ae,tt,pe)),Te-=tt,pe+=tt,Qt)break e}else F.head&&(F.head.name=null);F.length=0,F.mode=ul;case ul:if(F.flags&4096){if(Te===0)break e;tt=0;do Qt=ae[pe+tt++],F.head&&Qt&&F.length<65536&&(F.head.comment+=String.fromCharCode(Qt));while(Qt&&tt<Te);if(F.flags&512&&F.wrap&4&&(F.check=Pe(F.check,ae,tt,pe)),Te-=tt,pe+=tt,Qt)break e}else F.head&&(F.head.comment=null);F.mode=hl;case hl:if(F.flags&512){for(;Le<16;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}if(F.wrap&4&&be!==(F.check&65535)){z.msg="header crc mismatch",F.mode=ur;break}be=0,Le=0}F.head&&(F.head.hcrc=F.flags>>9&1,F.head.done=!0),z.adler=F.check=0,F.mode=Rr;break;case dl:for(;Le<32;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}z.adler=F.check=xa(be),be=0,Le=0,F.mode=uo;case uo:if(F.havedict===0)return z.next_out=Oe,z.avail_out=wt,z.next_in=pe,z.avail_in=Te,F.hold=be,F.bits=Le,ol;z.adler=F.check=1,F.mode=Rr;case Rr:if(Q===Nc||Q===so)break e;case Fi:if(F.last){be>>>=Le&7,Le-=Le&7,F.mode=ui;break}for(;Le<3;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}switch(F.last=be&1,be>>>=1,Le-=1,be&3){case 0:F.mode=fa;break;case 1:if(ba(F),F.mode=yo,Q===so){be>>>=2,Le-=2;break e}break;case 2:F.mode=ma;break;case 3:z.msg="invalid block type",F.mode=ur}be>>>=2,Le-=2;break;case fa:for(be>>>=Le&7,Le-=Le&7;Le<32;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}if((be&65535)!==(be>>>16^65535)){z.msg="invalid stored block lengths",F.mode=ur;break}if(F.length=be&65535,be=0,Le=0,F.mode=po,Q===so)break e;case po:F.mode=pa;case pa:if(tt=F.length,tt){if(tt>Te&&(tt=Te),tt>wt&&(tt=wt),tt===0)break e;ce.set(ae.subarray(pe,pe+tt),Oe),Te-=tt,pe+=tt,wt-=tt,Oe+=tt,F.length-=tt;break}F.mode=Rr;break;case ma:for(;Le<14;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}if(F.nlen=(be&31)+257,be>>>=5,Le-=5,F.ndist=(be&31)+1,be>>>=5,Le-=5,F.ncode=(be&15)+4,be>>>=4,Le-=4,F.nlen>286||F.ndist>30){z.msg="too many length or distance symbols",F.mode=ur;break}F.have=0,F.mode=go;case go:for(;F.have<F.ncode;){for(;Le<3;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}F.lens[xn[F.have++]]=be&7,be>>>=3,Le-=3}for(;F.have<19;)F.lens[xn[F.have++]]=0;if(F.lencode=F.lendyn,F.lenbits=7,Ht={bits:F.lenbits},lr=es(il,F.lens,0,19,F.lencode,0,F.work,Ht),F.lenbits=Ht.bits,lr){z.msg="invalid code lengths set",F.mode=ur;break}F.have=0,F.mode=fl;case fl:for(;F.have<F.nlen+F.ndist;){for(;er=F.lencode[be&(1<<F.lenbits)-1],Pt=er>>>24,zt=er>>>16&255,lt=er&65535,!(Pt<=Le);){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}if(lt<16)be>>>=Pt,Le-=Pt,F.lens[F.have++]=lt;else{if(lt===16){for(Vr=Pt+2;Le<Vr;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}if(be>>>=Pt,Le-=Pt,F.have===0){z.msg="invalid bit length repeat",F.mode=ur;break}Qt=F.lens[F.have-1],tt=3+(be&3),be>>>=2,Le-=2}else if(lt===17){for(Vr=Pt+3;Le<Vr;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}be>>>=Pt,Le-=Pt,Qt=0,tt=3+(be&7),be>>>=3,Le-=3}else{for(Vr=Pt+7;Le<Vr;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}be>>>=Pt,Le-=Pt,Qt=0,tt=11+(be&127),be>>>=7,Le-=7}if(F.have+tt>F.nlen+F.ndist){z.msg="invalid bit length repeat",F.mode=ur;break}for(;tt--;)F.lens[F.have++]=Qt}}if(F.mode===ur)break;if(F.lens[256]===0){z.msg="invalid code -- missing end-of-block",F.mode=ur;break}if(F.lenbits=9,Ht={bits:F.lenbits},lr=es(ta,F.lens,0,F.nlen,F.lencode,0,F.work,Ht),F.lenbits=Ht.bits,lr){z.msg="invalid literal/lengths set",F.mode=ur;break}if(F.distbits=6,F.distcode=F.distdyn,Ht={bits:F.distbits},lr=es(ra,F.lens,F.nlen,F.ndist,F.distcode,0,F.work,Ht),F.distbits=Ht.bits,lr){z.msg="invalid distances set",F.mode=ur;break}if(F.mode=yo,Q===so)break e;case yo:F.mode=Xn;case Xn:if(Te>=6&&wt>=258){z.next_out=Oe,z.avail_out=wt,z.next_in=pe,z.avail_in=Te,F.hold=be,F.bits=Le,kc(z,ut),Oe=z.next_out,ce=z.output,wt=z.avail_out,pe=z.next_in,ae=z.input,Te=z.avail_in,be=F.hold,Le=F.bits,F.mode===Rr&&(F.back=-1);break}for(F.back=0;er=F.lencode[be&(1<<F.lenbits)-1],Pt=er>>>24,zt=er>>>16&255,lt=er&65535,!(Pt<=Le);){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}if(zt&&!(zt&240)){for(It=Pt,Er=zt,tr=lt;er=F.lencode[tr+((be&(1<<It+Er)-1)>>It)],Pt=er>>>24,zt=er>>>16&255,lt=er&65535,!(It+Pt<=Le);){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}be>>>=It,Le-=It,F.back+=It}if(be>>>=Pt,Le-=Pt,F.back+=Pt,F.length=lt,zt===0){F.mode=Rs;break}if(zt&32){F.back=-1,F.mode=Rr;break}if(zt&64){z.msg="invalid literal/length code",F.mode=ur;break}F.extra=zt&15,F.mode=vo;case vo:if(F.extra){for(Vr=F.extra;Le<Vr;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}F.length+=be&(1<<F.extra)-1,be>>>=F.extra,Le-=F.extra,F.back+=F.extra}F.was=F.length,F.mode=rs;case rs:for(;er=F.distcode[be&(1<<F.distbits)-1],Pt=er>>>24,zt=er>>>16&255,lt=er&65535,!(Pt<=Le);){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}if(!(zt&240)){for(It=Pt,Er=zt,tr=lt;er=F.distcode[tr+((be&(1<<It+Er)-1)>>It)],Pt=er>>>24,zt=er>>>16&255,lt=er&65535,!(It+Pt<=Le);){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}be>>>=It,Le-=It,F.back+=It}if(be>>>=Pt,Le-=Pt,F.back+=Pt,zt&64){z.msg="invalid distance code",F.mode=ur;break}F.offset=lt,F.extra=zt&15,F.mode=_o;case _o:if(F.extra){for(Vr=F.extra;Le<Vr;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}F.offset+=be&(1<<F.extra)-1,be>>>=F.extra,Le-=F.extra,F.back+=F.extra}if(F.offset>F.dmax){z.msg="invalid distance too far back",F.mode=ur;break}F.mode=ga;case ga:if(wt===0)break e;if(tt=ut-wt,F.offset>tt){if(tt=F.offset-tt,tt>F.whave&&F.sane){z.msg="invalid distance too far back",F.mode=ur;break}tt>F.wnext?(tt-=F.wnext,pr=F.wsize-tt):pr=F.wnext-tt,tt>F.length&&(tt=F.length),vr=F.window}else vr=ce,pr=Oe-F.offset,tt=F.length;tt>wt&&(tt=wt),wt-=tt,F.length-=tt;do ce[Oe++]=vr[pr++];while(--tt);F.length===0&&(F.mode=Xn);break;case Rs:if(wt===0)break e;ce[Oe++]=F.length,wt--,F.mode=Xn;break;case ui:if(F.wrap){for(;Le<32;){if(Te===0)break e;Te--,be|=ae[pe++]<<Le,Le+=8}if(ut-=wt,z.total_out+=ut,F.total+=ut,F.wrap&4&&ut&&(z.adler=F.check=F.flags?Pe(F.check,ce,ut,Oe-ut):_e(F.check,ce,ut,Oe-ut)),ut=wt,F.wrap&4&&(F.flags?be:xa(be))!==F.check){z.msg="incorrect data check",F.mode=ur;break}be=0,Le=0}F.mode=xo;case xo:if(F.wrap&&F.flags){for(;Le<32;){if(Te===0)break e;Te--,be+=ae[pe++]<<Le,Le+=8}if(F.wrap&4&&be!==(F.total&4294967295)){z.msg="incorrect length check",F.mode=ur;break}be=0,Le=0}F.mode=ya;case ya:lr=sl;break e;case ur:lr=ts;break e;case va:return al;case _a:default:return Yr}return z.next_out=Oe,z.avail_out=wt,z.next_in=pe,z.avail_in=Te,F.hold=be,F.bits=Le,(F.wsize||ut!==z.avail_out&&F.mode<ur&&(F.mode<ui||Q!==Ni))&&ks(z,z.output,z.next_out,ut-z.avail_out),Jt-=z.avail_in,ut-=z.avail_out,z.total_in+=Jt,z.total_out+=ut,F.total+=ut,F.wrap&4&&ut&&(z.adler=F.check=F.flags?Pe(F.check,ce,ut,z.next_out-ut):_e(F.check,ce,ut,z.next_out-ut)),z.data_type=F.bits+(F.last?64:0)+(F.mode===Rr?128:0)+(F.mode===yo||F.mode===po?256:0),(Jt===0&&ut===0||Q===Ni)&&lr===Ii&&(lr=oo),lr},_l=z=>{if(Zn(z))return Yr;let Q=z.state;return Q.window&&(Q.window=null),z.state=null,Ii},Sa=(z,Q)=>{if(Zn(z))return Yr;const F=z.state;return F.wrap&2?(F.head=Q,Q.done=!1,Ii):Yr},Ns=(z,Q)=>{const F=Q.length;let ae,ce,pe;return Zn(z)||(ae=z.state,ae.wrap!==0&&ae.mode!==uo)?Yr:ae.mode===uo&&(ce=1,ce=_e(ce,Q,F,0),ce!==ae.check)?ts:(pe=ks(z,Q,F,F),pe?(ae.mode=va,al):(ae.havedict=1,Ii))};var So=yl,as=vl,xl=wo,Ic=Pc,Fc=ss,wl=zs,Co=_l,Eo=Sa,Ca=Ns,Ea="pako inflate (from Nodeca project)",kn={inflateReset:So,inflateReset2:as,inflateResetKeep:xl,inflateInit:Ic,inflateInit2:Fc,inflate:wl,inflateEnd:Co,inflateGetHeader:Eo,inflateSetDictionary:Ca,inflateInfo:Ea};function Aa(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Lc=Aa;const Ma=Object.prototype.toString,{Z_NO_FLUSH:Dc,Z_FINISH:Oc,Z_OK:Di,Z_STREAM_END:Bn,Z_NEED_DICT:Mo,Z_STREAM_ERROR:ls,Z_DATA_ERROR:In,Z_MEM_ERROR:Ps}=X;function gn(z){this.options=ki.assign({chunkSize:65536,windowBits:15,to:""},z||{});const Q=this.options;Q.raw&&Q.windowBits>=0&&Q.windowBits<16&&(Q.windowBits=-Q.windowBits,Q.windowBits===0&&(Q.windowBits=-15)),Q.windowBits>=0&&Q.windowBits<16&&!(z&&z.windowBits)&&(Q.windowBits+=32),Q.windowBits>15&&Q.windowBits<48&&(Q.windowBits&15||(Q.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ji,this.strm.avail_out=0;let F=kn.inflateInit2(this.strm,Q.windowBits);if(F!==Di)throw new Error(at[F]);if(this.header=new Lc,kn.inflateGetHeader(this.strm,this.header),Q.dictionary&&(typeof Q.dictionary=="string"?Q.dictionary=zi.string2buf(Q.dictionary):Ma.call(Q.dictionary)==="[object ArrayBuffer]"&&(Q.dictionary=new Uint8Array(Q.dictionary)),Q.raw&&(F=kn.inflateSetDictionary(this.strm,Q.dictionary),F!==Di)))throw new Error(at[F])}gn.prototype.push=function(z,Q){const F=this.strm,ae=this.options.chunkSize,ce=this.options.dictionary;let pe,Oe,Te;if(this.ended)return!1;for(Q===~~Q?Oe=Q:Oe=Q===!0?Oc:Dc,Ma.call(z)==="[object ArrayBuffer]"?F.input=new Uint8Array(z):F.input=z,F.next_in=0,F.avail_in=F.input.length;;){for(F.avail_out===0&&(F.output=new Uint8Array(ae),F.next_out=0,F.avail_out=ae),pe=kn.inflate(F,Oe),pe===Mo&&ce&&(pe=kn.inflateSetDictionary(F,ce),pe===Di?pe=kn.inflate(F,Oe):pe===In&&(pe=Mo));F.avail_in>0&&pe===Bn&&F.state.wrap>0&&z[F.next_in]!==0;)kn.inflateReset(F),pe=kn.inflate(F,Oe);switch(pe){case ls:case In:case Mo:case Ps:return this.onEnd(pe),this.ended=!0,!1}if(Te=F.avail_out,F.next_out&&(F.avail_out===0||pe===Bn))if(this.options.to==="string"){let wt=zi.utf8border(F.output,F.next_out),be=F.next_out-wt,Le=zi.buf2string(F.output,wt);F.next_out=be,F.avail_out=ae-be,be&&F.output.set(F.output.subarray(wt,wt+be),0),this.onData(Le)}else this.onData(F.output.length===F.next_out?F.output:F.output.subarray(0,F.next_out));if(!(pe===Di&&Te===0)){if(pe===Bn)return pe=kn.inflateEnd(this.strm),this.onEnd(pe),this.ended=!0,!0;if(F.avail_in===0)break}}return!0},gn.prototype.onData=function(z){this.chunks.push(z)},gn.prototype.onEnd=function(z){z===Di&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ki.flattenChunks(this.chunks)),this.chunks=[],this.err=z,this.msg=this.strm.msg};function Is(z,Q){const F=new gn(Q);if(F.push(z),F.err)throw F.msg||at[F.err];return F.result}function Bc(z,Q){return Q=Q||{},Q.raw=!0,Is(z,Q)}var Uc=gn,Oi=Is,Fs=Bc,cs=Is,Ro={Inflate:Uc,inflate:Oi,inflateRaw:Fs,ungzip:cs};const{Deflate:Ta,deflate:us,deflateRaw:fi,gzip:gr}=Rc,{Inflate:fr,inflate:pi,inflateRaw:jr,ungzip:rn}=Ro;var mi=Ta,Bi=us,Xr=fi,Ls=gr,Ra=fr,ka=pi,Ds=jr,za=rn,Un=X,ko={Deflate:mi,deflate:Bi,deflateRaw:Xr,gzip:Ls,Inflate:Ra,inflate:ka,inflateRaw:Ds,ungzip:za,constants:Un}})},__webpack_module_cache__={};function __webpack_require__(r){var e=__webpack_module_cache__[r];if(e!==void 0)return e.exports;var t=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r].call(t.exports,t,t.exports,__webpack_require__),t.exports}__webpack_require__.n=r=>{var e=r&&r.__esModule?(()=>r.default):(()=>r);return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(r,e)=>{for(var t in e)__webpack_require__.o(e,t)&&!__webpack_require__.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})},__webpack_require__.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),__webpack_require__.r=r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},__webpack_require__("./src/index.ts"),__webpack_require__("./src/SurfaceWorker.js");var __webpack_exports__=__webpack_require__("./src/exporter.js");return __webpack_exports__})())})(_3Dmol);var _3DmolExports=_3Dmol.exports;const covalentRadii={H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.61,Fe:1.52,Co:1.5,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,Pd:1.39,Ag:1.45,Cd:1.44,In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.75,Hf:1.87,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69};function mod(r,e){return(r%e+e)%e}function setCustomBondLengths(){function r(e,t){_3DmolExports.setBondLength(e,t)}Object.keys(covalentRadii).forEach(e=>{r(e,1.05*covalentRadii[e])})}class Visualizer3dmol extends React.Component{constructor(e){super(e),setCustomBondLengths(),this.viewer=null,this.model=null,this.divId="gldiv-"+(Math.random()+1).toString(36).substring(7)}componentDidMount(){let e={backgroundColor:"white",orthographic:!0};this.viewer=_3DmolExports.createViewer(this.divId,e),this.updateView()}componentDidUpdate(e){(e.viewerParams!=this.props.viewerParams||e.cifText!=this.props.cifText)&&this.updateView()}custom3dmolSetup(){if(this.model=this.viewer.addModel(),this.props.cifText){let e=_3DmolExports.Parsers.CIF(this.props.cifText),t=e[0],o=e.modelData[0].cryst;this.model.setCrystData(o.a,o.b,o.c,o.alpha,o.beta,o.gamma);let c=this.model.modelData.cryst.matrix,h=new _3DmolExports.Matrix3().getInverse3(c),v=[],p=[];t.forEach(f=>{let b=new _3DmolExports.Vector3(f.x,f.y,f.z);if(this.props.viewerParams.packedCell){let C=b.clone().applyMatrix3(h);b=new _3DmolExports.Vector3(mod(C.x,1),mod(C.y,1),mod(C.z,1)).applyMatrix3(c)}p.push({elem:f.elem,x:b.x,y:b.y,z:b.z})});let g=.03,x=this.props.viewerParams.supercell;for(let f=-1;f<x[0]+1;f++)for(let b=-1;b<x[1]+1;b++)for(let C=-1;C<x[2]+1;C++){let S=new _3DmolExports.Vector3(f,b,C);if(S.applyMatrix3(c),f==-1||f==x[0]||b==-1||b==x[1]||C==-1||C==x[2])if(this.props.viewerParams.packedCell)p.forEach(k=>{let l=new _3DmolExports.Vector3(k.x,k.y,k.z);l.add(S);let s=l.clone().applyMatrix3(h);s.x>-g&&s.x<x[0]+g&&s.y>-g&&s.y<x[1]+g&&s.z>-g&&s.z<x[2]+g&&v.push({elem:k.elem,x:l.x,y:l.y,z:l.z})});else continue;else p.forEach(k=>{v.push({elem:k.elem,x:k.x+S.x,y:k.y+S.y,z:k.z+S.z})})}this.model.addAtoms(v)}}updateView(){this.viewer.removeAllModels(),this.custom3dmolSetup();let e={sphere:{scale:.3,colorscheme:"Jmol"}};this.props.viewerParams.vdwRadius&&(e.sphere.scale=1),this.props.viewerParams.bonds&&(e.stick={radius:.15,colorscheme:"Jmol"}),this.viewer.setStyle(e),this.viewer.addUnitCell(this.model),this.model.assignBonds(),this.viewer.removeAllLabels(),this.props.viewerParams.atomLabels&&this.model.atoms.forEach(t=>{this.viewer.addLabel(t.elem,{position:{x:t.x,y:t.y,z:t.z},fontColor:"black",bold:!0,fontSize:18,showBackground:!1,backgroundOpacity:1,inFront:!0},null,!0)}),this.viewer.zoomTo(),this.viewer.zoom(1.4),this.viewer.render()}handleEvent(e,t){e=="camera"&&(t=="x"&&this.viewer.setView([0,0,0,0,-.5,-.5,-.5,.5]),t=="y"&&this.viewer.setView([0,0,0,0,.5,.5,.5,.5]),t=="z"&&this.viewer.setView([0,0,0,0,0,0,0,1]),this.viewer.zoomTo(),this.viewer.zoom(1.4))}render(){return jsxRuntimeExports.jsx("div",{id:this.divId,className:"gldiv",children:"No data!"})}}class StructureWindow extends React.Component{constructor(e){super(e)}render(){let e="structure-window";this.props.mouseEnabled||(e+=" disable-mouse");let t="Click to interact",o="mouse-disabled-note";return this.props.mouseEnabled&&(o="mouse-disabled-note on"),jsxRuntimeExports.jsxs("div",{className:"structure-window-outer",children:[jsxRuntimeExports.jsx("div",{className:"structure-window-click-handler",onClick:()=>this.props.setMouseEnabledState(!0),children:jsxRuntimeExports.jsx("div",{className:e,children:jsxRuntimeExports.jsx(Visualizer3dmol,{ref:this.props.visualizerRef,viewerParams:this.props.viewerParams,cifText:this.props.cifText})})}),jsxRuntimeExports.jsx("div",{className:o,onClick:()=>this.props.setMouseEnabledState(!this.props.mouseEnabled),children:t})]})}}const StructureVisualizer=r=>{const[e,t]=reactExports.useState({supercell:r.initSupercell||[2,2,2],bonds:!0,packedCell:!0,atomLabels:!1,vdwRadius:!1}),[o,c]=reactExports.useState(!1),h=reactExports.useRef(null),v=reactExports.useRef(null);reactExports.useEffect(()=>{const f=b=>{v&&!v.current.contains(b.target)&&c(!1)};return document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[]);const p=f=>{c(f)},g=(f,b)=>{t(C=>({...C,[f]:b}))},x=(f,b)=>{h.current.handleEvent(f,b)};return jsxRuntimeExports.jsxs("div",{ref:v,className:"structure-visualizer",children:[jsxRuntimeExports.jsx(StructureWindow,{visualizerRef:h,viewerParams:e,cifText:r.cifText,mouseEnabled:o,setMouseEnabledState:p}),jsxRuntimeExports.jsx(ControlBox,{viewerParams:e,onViewerParamChange:g,onViewerEvent:x})]})};/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const os="162",to=300,ns=1e3,Nt=1001,is=1002,xt=1003,St=1006,An=1008,un=1009,on=1014,wn=1020,Ft=1023,Rn=1026,si=1027,an="",co=515,Zt=2e3,ir=2001;class Ln{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const o=this._listeners;o[e]===void 0&&(o[e]=[]),o[e].indexOf(t)===-1&&o[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const o=this._listeners;return o[e]!==void 0&&o[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const o=this._listeners[e];if(o!==void 0){const c=o.indexOf(t);c!==-1&&o.splice(c,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const t=this._listeners[e.type];if(t!==void 0){e.target=this;const o=t.slice(0);for(let c=0,h=o.length;c<h;c++)o[c].call(this,e);e.target=null}}}const pt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function oi(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(pt[r&255]+pt[r>>8&255]+pt[r>>16&255]+pt[r>>24&255]+"-"+pt[e&255]+pt[e>>8&255]+"-"+pt[e>>16&15|64]+pt[e>>24&255]+"-"+pt[t&63|128]+pt[t>>8&255]+"-"+pt[t>>16&255]+pt[t>>24&255]+pt[o&255]+pt[o>>8&255]+pt[o>>16&255]+pt[o>>24&255]).toLowerCase()}function _t(r,e,t){return Math.max(e,Math.min(t,r))}class Ie{constructor(e=0,t=0){Ie.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,o=this.y,c=e.elements;return this.x=c[0]*t+c[3]*o+c[6],this.y=c[1]*t+c[4]*o+c[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(t,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const o=this.dot(e)/t;return Math.acos(_t(o,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,o=this.y-e.y;return t*t+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,o){return this.x=e.x+(t.x-e.x)*o,this.y=e.y+(t.y-e.y)*o,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const o=Math.cos(t),c=Math.sin(t),h=this.x-e.x,v=this.y-e.y;return this.x=h*o-v*c+e.x,this.y=h*c+v*o+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ge{constructor(e,t,o,c,h,v,p,g,x){Ge.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,o,c,h,v,p,g,x)}set(e,t,o,c,h,v,p,g,x){const f=this.elements;return f[0]=e,f[1]=c,f[2]=p,f[3]=t,f[4]=h,f[5]=g,f[6]=o,f[7]=v,f[8]=x,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,o=e.elements;return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],this}extractBasis(e,t,o){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const o=e.elements,c=t.elements,h=this.elements,v=o[0],p=o[3],g=o[6],x=o[1],f=o[4],b=o[7],C=o[2],S=o[5],k=o[8],l=c[0],s=c[3],y=c[6],A=c[1],E=c[4],T=c[7],u=c[2],_=c[5],M=c[8];return h[0]=v*l+p*A+g*u,h[3]=v*s+p*E+g*_,h[6]=v*y+p*T+g*M,h[1]=x*l+f*A+b*u,h[4]=x*s+f*E+b*_,h[7]=x*y+f*T+b*M,h[2]=C*l+S*A+k*u,h[5]=C*s+S*E+k*_,h[8]=C*y+S*T+k*M,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],o=e[1],c=e[2],h=e[3],v=e[4],p=e[5],g=e[6],x=e[7],f=e[8];return t*v*f-t*p*x-o*h*f+o*p*g+c*h*x-c*v*g}invert(){const e=this.elements,t=e[0],o=e[1],c=e[2],h=e[3],v=e[4],p=e[5],g=e[6],x=e[7],f=e[8],b=f*v-p*x,C=p*g-f*h,S=x*h-v*g,k=t*b+o*C+c*S;if(k===0)return this.set(0,0,0,0,0,0,0,0,0);const l=1/k;return e[0]=b*l,e[1]=(c*x-f*o)*l,e[2]=(p*o-c*v)*l,e[3]=C*l,e[4]=(f*t-c*g)*l,e[5]=(c*h-p*t)*l,e[6]=S*l,e[7]=(o*g-x*t)*l,e[8]=(v*t-o*h)*l,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,o,c,h,v,p){const g=Math.cos(h),x=Math.sin(h);return this.set(o*g,o*x,-o*(g*v+x*p)+v+e,-c*x,c*g,-c*(-x*v+g*p)+p+t,0,0,1),this}scale(e,t){return this.premultiply(yr.makeScale(e,t)),this}rotate(e){return this.premultiply(yr.makeRotation(-e)),this}translate(e,t){return this.premultiply(yr.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),o=Math.sin(e);return this.set(t,-o,0,o,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,o=e.elements;for(let c=0;c<9;c++)if(t[c]!==o[c])return!1;return!0}fromArray(e,t=0){for(let o=0;o<9;o++)this.elements[o]=e[o+t];return this}toArray(e=[],t=0){const o=this.elements;return e[t]=o[0],e[t+1]=o[1],e[t+2]=o[2],e[t+3]=o[3],e[t+4]=o[4],e[t+5]=o[5],e[t+6]=o[6],e[t+7]=o[7],e[t+8]=o[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const yr=new Ge;function sr(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function ti(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}let Nn;class ho{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Nn===void 0&&(Nn=sr("canvas")),Nn.width=e.width,Nn.height=e.height;const o=Nn.getContext("2d");e instanceof ImageData?o.putImageData(e,0,0):o.drawImage(e,0,0,e.width,e.height),t=Nn}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=sr("canvas");t.width=e.width,t.height=e.height;const o=t.getContext("2d");o.drawImage(e,0,0,e.width,e.height);const c=o.getImageData(0,0,e.width,e.height),h=c.data;for(let v=0;v<h.length;v++)h[v]=ti(h[v]/255)*255;return o.putImageData(c,0,0),t}else if(e.data){const t=e.data.slice(0);for(let o=0;o<t.length;o++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[o]=Math.floor(ti(t[o]/255)*255):t[o]=ti(t[o]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Ql=0;class fo{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Ql++}),this.uuid=oi(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const o={uuid:this.uuid,url:""},c=this.data;if(c!==null){let h;if(Array.isArray(c)){h=[];for(let v=0,p=c.length;v<p;v++)c[v].isDataTexture?h.push(br(c[v].image)):h.push(br(c[v]))}else h=br(c);o.url=h}return t||(e.images[this.uuid]=o),o}}function br(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?ho.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let ec=0;class yt extends Ln{constructor(e=yt.DEFAULT_IMAGE,t=yt.DEFAULT_MAPPING,o=Nt,c=Nt,h=St,v=An,p=Ft,g=un,x=yt.DEFAULT_ANISOTROPY,f=an){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:ec++}),this.uuid=oi(),this.name="",this.source=new fo(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=o,this.wrapT=c,this.magFilter=h,this.minFilter=v,this.anisotropy=x,this.format=p,this.internalFormat=null,this.type=g,this.offset=new Ie(0,0),this.repeat=new Ie(1,1),this.center=new Ie(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ge,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const o={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(o.userData=this.userData),t||(e.textures[this.uuid]=o),o}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==to)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ns:e.x=e.x-Math.floor(e.x);break;case Nt:e.x=e.x<0?0:1;break;case is:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case ns:e.y=e.y-Math.floor(e.y);break;case Nt:e.y=e.y<0?0:1;break;case is:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}yt.DEFAULT_IMAGE=null;yt.DEFAULT_MAPPING=to;yt.DEFAULT_ANISOTROPY=1;class Pn{constructor(e=0,t=0,o=0,c=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=o,this._w=c}static slerpFlat(e,t,o,c,h,v,p){let g=o[c+0],x=o[c+1],f=o[c+2],b=o[c+3];const C=h[v+0],S=h[v+1],k=h[v+2],l=h[v+3];if(p===0){e[t+0]=g,e[t+1]=x,e[t+2]=f,e[t+3]=b;return}if(p===1){e[t+0]=C,e[t+1]=S,e[t+2]=k,e[t+3]=l;return}if(b!==l||g!==C||x!==S||f!==k){let s=1-p;const y=g*C+x*S+f*k+b*l,A=y>=0?1:-1,E=1-y*y;if(E>Number.EPSILON){const u=Math.sqrt(E),_=Math.atan2(u,y*A);s=Math.sin(s*_)/u,p=Math.sin(p*_)/u}const T=p*A;if(g=g*s+C*T,x=x*s+S*T,f=f*s+k*T,b=b*s+l*T,s===1-p){const u=1/Math.sqrt(g*g+x*x+f*f+b*b);g*=u,x*=u,f*=u,b*=u}}e[t]=g,e[t+1]=x,e[t+2]=f,e[t+3]=b}static multiplyQuaternionsFlat(e,t,o,c,h,v){const p=o[c],g=o[c+1],x=o[c+2],f=o[c+3],b=h[v],C=h[v+1],S=h[v+2],k=h[v+3];return e[t]=p*k+f*b+g*S-x*C,e[t+1]=g*k+f*C+x*b-p*S,e[t+2]=x*k+f*S+p*C-g*b,e[t+3]=f*k-p*b-g*C-x*S,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,o,c){return this._x=e,this._y=t,this._z=o,this._w=c,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const o=e._x,c=e._y,h=e._z,v=e._order,p=Math.cos,g=Math.sin,x=p(o/2),f=p(c/2),b=p(h/2),C=g(o/2),S=g(c/2),k=g(h/2);switch(v){case"XYZ":this._x=C*f*b+x*S*k,this._y=x*S*b-C*f*k,this._z=x*f*k+C*S*b,this._w=x*f*b-C*S*k;break;case"YXZ":this._x=C*f*b+x*S*k,this._y=x*S*b-C*f*k,this._z=x*f*k-C*S*b,this._w=x*f*b+C*S*k;break;case"ZXY":this._x=C*f*b-x*S*k,this._y=x*S*b+C*f*k,this._z=x*f*k+C*S*b,this._w=x*f*b-C*S*k;break;case"ZYX":this._x=C*f*b-x*S*k,this._y=x*S*b+C*f*k,this._z=x*f*k-C*S*b,this._w=x*f*b+C*S*k;break;case"YZX":this._x=C*f*b+x*S*k,this._y=x*S*b+C*f*k,this._z=x*f*k-C*S*b,this._w=x*f*b-C*S*k;break;case"XZY":this._x=C*f*b-x*S*k,this._y=x*S*b-C*f*k,this._z=x*f*k+C*S*b,this._w=x*f*b+C*S*k;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+v)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const o=t/2,c=Math.sin(o);return this._x=e.x*c,this._y=e.y*c,this._z=e.z*c,this._w=Math.cos(o),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,o=t[0],c=t[4],h=t[8],v=t[1],p=t[5],g=t[9],x=t[2],f=t[6],b=t[10],C=o+p+b;if(C>0){const S=.5/Math.sqrt(C+1);this._w=.25/S,this._x=(f-g)*S,this._y=(h-x)*S,this._z=(v-c)*S}else if(o>p&&o>b){const S=2*Math.sqrt(1+o-p-b);this._w=(f-g)/S,this._x=.25*S,this._y=(c+v)/S,this._z=(h+x)/S}else if(p>b){const S=2*Math.sqrt(1+p-o-b);this._w=(h-x)/S,this._x=(c+v)/S,this._y=.25*S,this._z=(g+f)/S}else{const S=2*Math.sqrt(1+b-o-p);this._w=(v-c)/S,this._x=(h+x)/S,this._y=(g+f)/S,this._z=.25*S}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let o=e.dot(t)+1;return o<Number.EPSILON?(o=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=o):(this._x=0,this._y=-e.z,this._z=e.y,this._w=o)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=o),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(_t(this.dot(e),-1,1)))}rotateTowards(e,t){const o=this.angleTo(e);if(o===0)return this;const c=Math.min(1,t/o);return this.slerp(e,c),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const o=e._x,c=e._y,h=e._z,v=e._w,p=t._x,g=t._y,x=t._z,f=t._w;return this._x=o*f+v*p+c*x-h*g,this._y=c*f+v*g+h*p-o*x,this._z=h*f+v*x+o*g-c*p,this._w=v*f-o*p-c*g-h*x,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const o=this._x,c=this._y,h=this._z,v=this._w;let p=v*e._w+o*e._x+c*e._y+h*e._z;if(p<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,p=-p):this.copy(e),p>=1)return this._w=v,this._x=o,this._y=c,this._z=h,this;const g=1-p*p;if(g<=Number.EPSILON){const S=1-t;return this._w=S*v+t*this._w,this._x=S*o+t*this._x,this._y=S*c+t*this._y,this._z=S*h+t*this._z,this.normalize(),this}const x=Math.sqrt(g),f=Math.atan2(x,p),b=Math.sin((1-t)*f)/x,C=Math.sin(t*f)/x;return this._w=v*b+this._w*C,this._x=o*b+this._x*C,this._y=c*b+this._y*C,this._z=h*b+this._z*C,this._onChangeCallback(),this}slerpQuaternions(e,t,o){return this.copy(e).slerp(t,o)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),o=Math.random(),c=Math.sqrt(1-o),h=Math.sqrt(o);return this.set(c*Math.sin(e),c*Math.cos(e),h*Math.sin(t),h*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class U{constructor(e=0,t=0,o=0){U.prototype.isVector3=!0,this.x=e,this.y=t,this.z=o}set(e,t,o){return o===void 0&&(o=this.z),this.x=e,this.y=t,this.z=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(sa.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(sa.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,o=this.y,c=this.z,h=e.elements;return this.x=h[0]*t+h[3]*o+h[6]*c,this.y=h[1]*t+h[4]*o+h[7]*c,this.z=h[2]*t+h[5]*o+h[8]*c,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,o=this.y,c=this.z,h=e.elements,v=1/(h[3]*t+h[7]*o+h[11]*c+h[15]);return this.x=(h[0]*t+h[4]*o+h[8]*c+h[12])*v,this.y=(h[1]*t+h[5]*o+h[9]*c+h[13])*v,this.z=(h[2]*t+h[6]*o+h[10]*c+h[14])*v,this}applyQuaternion(e){const t=this.x,o=this.y,c=this.z,h=e.x,v=e.y,p=e.z,g=e.w,x=2*(v*c-p*o),f=2*(p*t-h*c),b=2*(h*o-v*t);return this.x=t+g*x+v*b-p*f,this.y=o+g*f+p*x-h*b,this.z=c+g*b+h*f-v*x,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,o=this.y,c=this.z,h=e.elements;return this.x=h[0]*t+h[4]*o+h[8]*c,this.y=h[1]*t+h[5]*o+h[9]*c,this.z=h[2]*t+h[6]*o+h[10]*c,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(t,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,o){return this.x=e.x+(t.x-e.x)*o,this.y=e.y+(t.y-e.y)*o,this.z=e.z+(t.z-e.z)*o,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const o=e.x,c=e.y,h=e.z,v=t.x,p=t.y,g=t.z;return this.x=c*g-h*p,this.y=h*v-o*g,this.z=o*p-c*v,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const o=e.dot(this)/t;return this.copy(e).multiplyScalar(o)}projectOnPlane(e){return Ar.copy(this).projectOnVector(e),this.sub(Ar)}reflect(e){return this.sub(Ar.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const o=this.dot(e)/t;return Math.acos(_t(o,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,o=this.y-e.y,c=this.z-e.z;return t*t+o*o+c*c}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,o){const c=Math.sin(t)*e;return this.x=c*Math.sin(o),this.y=Math.cos(t)*e,this.z=c*Math.cos(o),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,o){return this.x=e*Math.sin(t),this.y=o,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),o=this.setFromMatrixColumn(e,1).length(),c=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=o,this.z=c,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,o=Math.sqrt(1-t*t);return this.x=o*Math.cos(e),this.y=t,this.z=o*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ar=new U,sa=new Pn,Wt=new U,Cr=new U,Ri=new U,en=new U,Pr=new U,Ci=new U,Lr=new U;class hs{constructor(e=new U,t=new U(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Wt)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const o=t.dot(this.direction);return o<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,o)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Wt.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Wt.copy(this.origin).addScaledVector(this.direction,t),Wt.distanceToSquared(e))}distanceSqToSegment(e,t,o,c){Cr.copy(e).add(t).multiplyScalar(.5),Ri.copy(t).sub(e).normalize(),en.copy(this.origin).sub(Cr);const h=e.distanceTo(t)*.5,v=-this.direction.dot(Ri),p=en.dot(this.direction),g=-en.dot(Ri),x=en.lengthSq(),f=Math.abs(1-v*v);let b,C,S,k;if(f>0)if(b=v*g-p,C=v*p-g,k=h*f,b>=0)if(C>=-k)if(C<=k){const l=1/f;b*=l,C*=l,S=b*(b+v*C+2*p)+C*(v*b+C+2*g)+x}else C=h,b=Math.max(0,-(v*C+p)),S=-b*b+C*(C+2*g)+x;else C=-h,b=Math.max(0,-(v*C+p)),S=-b*b+C*(C+2*g)+x;else C<=-k?(b=Math.max(0,-(-v*h+p)),C=b>0?-h:Math.min(Math.max(-h,-g),h),S=-b*b+C*(C+2*g)+x):C<=k?(b=0,C=Math.min(Math.max(-h,-g),h),S=C*(C+2*g)+x):(b=Math.max(0,-(v*h+p)),C=b>0?h:Math.min(Math.max(-h,-g),h),S=-b*b+C*(C+2*g)+x);else C=v>0?-h:h,b=Math.max(0,-(v*C+p)),S=-b*b+C*(C+2*g)+x;return o&&o.copy(this.origin).addScaledVector(this.direction,b),c&&c.copy(Cr).addScaledVector(Ri,C),S}intersectSphere(e,t){Wt.subVectors(e.center,this.origin);const o=Wt.dot(this.direction),c=Wt.dot(Wt)-o*o,h=e.radius*e.radius;if(c>h)return null;const v=Math.sqrt(h-c),p=o-v,g=o+v;return g<0?null:p<0?this.at(g,t):this.at(p,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const o=-(this.origin.dot(e.normal)+e.constant)/t;return o>=0?o:null}intersectPlane(e,t){const o=this.distanceToPlane(e);return o===null?null:this.at(o,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let o,c,h,v,p,g;const x=1/this.direction.x,f=1/this.direction.y,b=1/this.direction.z,C=this.origin;return x>=0?(o=(e.min.x-C.x)*x,c=(e.max.x-C.x)*x):(o=(e.max.x-C.x)*x,c=(e.min.x-C.x)*x),f>=0?(h=(e.min.y-C.y)*f,v=(e.max.y-C.y)*f):(h=(e.max.y-C.y)*f,v=(e.min.y-C.y)*f),o>v||h>c||((h>o||isNaN(o))&&(o=h),(v<c||isNaN(c))&&(c=v),b>=0?(p=(e.min.z-C.z)*b,g=(e.max.z-C.z)*b):(p=(e.max.z-C.z)*b,g=(e.min.z-C.z)*b),o>g||p>c)||((p>o||o!==o)&&(o=p),(g<c||c!==c)&&(c=g),c<0)?null:this.at(o>=0?o:c,t)}intersectsBox(e){return this.intersectBox(e,Wt)!==null}intersectTriangle(e,t,o,c,h){Pr.subVectors(t,e),Ci.subVectors(o,e),Lr.crossVectors(Pr,Ci);let v=this.direction.dot(Lr),p;if(v>0){if(c)return null;p=1}else if(v<0)p=-1,v=-v;else return null;en.subVectors(this.origin,e);const g=p*this.direction.dot(Ci.crossVectors(en,Ci));if(g<0)return null;const x=p*this.direction.dot(Pr.cross(en));if(x<0||g+x>v)return null;const f=-p*en.dot(Lr);return f<0?null:this.at(f/v,h)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class st{constructor(e,t,o,c,h,v,p,g,x,f,b,C,S,k,l,s){st.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,o,c,h,v,p,g,x,f,b,C,S,k,l,s)}set(e,t,o,c,h,v,p,g,x,f,b,C,S,k,l,s){const y=this.elements;return y[0]=e,y[4]=t,y[8]=o,y[12]=c,y[1]=h,y[5]=v,y[9]=p,y[13]=g,y[2]=x,y[6]=f,y[10]=b,y[14]=C,y[3]=S,y[7]=k,y[11]=l,y[15]=s,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new st().fromArray(this.elements)}copy(e){const t=this.elements,o=e.elements;return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],this}copyPosition(e){const t=this.elements,o=e.elements;return t[12]=o[12],t[13]=o[13],t[14]=o[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,o){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this}makeBasis(e,t,o){return this.set(e.x,t.x,o.x,0,e.y,t.y,o.y,0,e.z,t.z,o.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,o=e.elements,c=1/zn.setFromMatrixColumn(e,0).length(),h=1/zn.setFromMatrixColumn(e,1).length(),v=1/zn.setFromMatrixColumn(e,2).length();return t[0]=o[0]*c,t[1]=o[1]*c,t[2]=o[2]*c,t[3]=0,t[4]=o[4]*h,t[5]=o[5]*h,t[6]=o[6]*h,t[7]=0,t[8]=o[8]*v,t[9]=o[9]*v,t[10]=o[10]*v,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,o=e.x,c=e.y,h=e.z,v=Math.cos(o),p=Math.sin(o),g=Math.cos(c),x=Math.sin(c),f=Math.cos(h),b=Math.sin(h);if(e.order==="XYZ"){const C=v*f,S=v*b,k=p*f,l=p*b;t[0]=g*f,t[4]=-g*b,t[8]=x,t[1]=S+k*x,t[5]=C-l*x,t[9]=-p*g,t[2]=l-C*x,t[6]=k+S*x,t[10]=v*g}else if(e.order==="YXZ"){const C=g*f,S=g*b,k=x*f,l=x*b;t[0]=C+l*p,t[4]=k*p-S,t[8]=v*x,t[1]=v*b,t[5]=v*f,t[9]=-p,t[2]=S*p-k,t[6]=l+C*p,t[10]=v*g}else if(e.order==="ZXY"){const C=g*f,S=g*b,k=x*f,l=x*b;t[0]=C-l*p,t[4]=-v*b,t[8]=k+S*p,t[1]=S+k*p,t[5]=v*f,t[9]=l-C*p,t[2]=-v*x,t[6]=p,t[10]=v*g}else if(e.order==="ZYX"){const C=v*f,S=v*b,k=p*f,l=p*b;t[0]=g*f,t[4]=k*x-S,t[8]=C*x+l,t[1]=g*b,t[5]=l*x+C,t[9]=S*x-k,t[2]=-x,t[6]=p*g,t[10]=v*g}else if(e.order==="YZX"){const C=v*g,S=v*x,k=p*g,l=p*x;t[0]=g*f,t[4]=l-C*b,t[8]=k*b+S,t[1]=b,t[5]=v*f,t[9]=-p*f,t[2]=-x*f,t[6]=S*b+k,t[10]=C-l*b}else if(e.order==="XZY"){const C=v*g,S=v*x,k=p*g,l=p*x;t[0]=g*f,t[4]=-b,t[8]=x*f,t[1]=C*b+l,t[5]=v*f,t[9]=S*b-k,t[2]=k*b-S,t[6]=p*f,t[10]=l*b+C}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(rc,e,sc)}lookAt(e,t,o){const c=this.elements;return At.subVectors(e,t),At.lengthSq()===0&&(At.z=1),At.normalize(),tn.crossVectors(o,At),tn.lengthSq()===0&&(Math.abs(o.z)===1?At.x+=1e-4:At.z+=1e-4,At.normalize(),tn.crossVectors(o,At)),tn.normalize(),Pi.crossVectors(At,tn),c[0]=tn.x,c[4]=Pi.x,c[8]=At.x,c[1]=tn.y,c[5]=Pi.y,c[9]=At.y,c[2]=tn.z,c[6]=Pi.z,c[10]=At.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const o=e.elements,c=t.elements,h=this.elements,v=o[0],p=o[4],g=o[8],x=o[12],f=o[1],b=o[5],C=o[9],S=o[13],k=o[2],l=o[6],s=o[10],y=o[14],A=o[3],E=o[7],T=o[11],u=o[15],_=c[0],M=c[4],R=c[8],N=c[12],I=c[1],L=c[5],Y=c[9],B=c[13],D=c[2],H=c[6],W=c[10],q=c[14],V=c[3],$=c[7],O=c[11],j=c[15];return h[0]=v*_+p*I+g*D+x*V,h[4]=v*M+p*L+g*H+x*$,h[8]=v*R+p*Y+g*W+x*O,h[12]=v*N+p*B+g*q+x*j,h[1]=f*_+b*I+C*D+S*V,h[5]=f*M+b*L+C*H+S*$,h[9]=f*R+b*Y+C*W+S*O,h[13]=f*N+b*B+C*q+S*j,h[2]=k*_+l*I+s*D+y*V,h[6]=k*M+l*L+s*H+y*$,h[10]=k*R+l*Y+s*W+y*O,h[14]=k*N+l*B+s*q+y*j,h[3]=A*_+E*I+T*D+u*V,h[7]=A*M+E*L+T*H+u*$,h[11]=A*R+E*Y+T*W+u*O,h[15]=A*N+E*B+T*q+u*j,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],o=e[4],c=e[8],h=e[12],v=e[1],p=e[5],g=e[9],x=e[13],f=e[2],b=e[6],C=e[10],S=e[14],k=e[3],l=e[7],s=e[11],y=e[15];return k*(+h*g*b-c*x*b-h*p*C+o*x*C+c*p*S-o*g*S)+l*(+t*g*S-t*x*C+h*v*C-c*v*S+c*x*f-h*g*f)+s*(+t*x*b-t*p*S-h*v*b+o*v*S+h*p*f-o*x*f)+y*(-c*p*f-t*g*b+t*p*C+c*v*b-o*v*C+o*g*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,o){const c=this.elements;return e.isVector3?(c[12]=e.x,c[13]=e.y,c[14]=e.z):(c[12]=e,c[13]=t,c[14]=o),this}invert(){const e=this.elements,t=e[0],o=e[1],c=e[2],h=e[3],v=e[4],p=e[5],g=e[6],x=e[7],f=e[8],b=e[9],C=e[10],S=e[11],k=e[12],l=e[13],s=e[14],y=e[15],A=b*s*x-l*C*x+l*g*S-p*s*S-b*g*y+p*C*y,E=k*C*x-f*s*x-k*g*S+v*s*S+f*g*y-v*C*y,T=f*l*x-k*b*x+k*p*S-v*l*S-f*p*y+v*b*y,u=k*b*g-f*l*g-k*p*C+v*l*C+f*p*s-v*b*s,_=t*A+o*E+c*T+h*u;if(_===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const M=1/_;return e[0]=A*M,e[1]=(l*C*h-b*s*h-l*c*S+o*s*S+b*c*y-o*C*y)*M,e[2]=(p*s*h-l*g*h+l*c*x-o*s*x-p*c*y+o*g*y)*M,e[3]=(b*g*h-p*C*h-b*c*x+o*C*x+p*c*S-o*g*S)*M,e[4]=E*M,e[5]=(f*s*h-k*C*h+k*c*S-t*s*S-f*c*y+t*C*y)*M,e[6]=(k*g*h-v*s*h-k*c*x+t*s*x+v*c*y-t*g*y)*M,e[7]=(v*C*h-f*g*h+f*c*x-t*C*x-v*c*S+t*g*S)*M,e[8]=T*M,e[9]=(k*b*h-f*l*h-k*o*S+t*l*S+f*o*y-t*b*y)*M,e[10]=(v*l*h-k*p*h+k*o*x-t*l*x-v*o*y+t*p*y)*M,e[11]=(f*p*h-v*b*h-f*o*x+t*b*x+v*o*S-t*p*S)*M,e[12]=u*M,e[13]=(f*l*c-k*b*c+k*o*C-t*l*C-f*o*s+t*b*s)*M,e[14]=(k*p*c-v*l*c-k*o*g+t*l*g+v*o*s-t*p*s)*M,e[15]=(v*b*c-f*p*c+f*o*g-t*b*g-v*o*C+t*p*C)*M,this}scale(e){const t=this.elements,o=e.x,c=e.y,h=e.z;return t[0]*=o,t[4]*=c,t[8]*=h,t[1]*=o,t[5]*=c,t[9]*=h,t[2]*=o,t[6]*=c,t[10]*=h,t[3]*=o,t[7]*=c,t[11]*=h,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],o=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],c=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,o,c))}makeTranslation(e,t,o){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,o,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),o=Math.sin(e);return this.set(1,0,0,0,0,t,-o,0,0,o,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),o=Math.sin(e);return this.set(t,0,o,0,0,1,0,0,-o,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),o=Math.sin(e);return this.set(t,-o,0,0,o,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const o=Math.cos(t),c=Math.sin(t),h=1-o,v=e.x,p=e.y,g=e.z,x=h*v,f=h*p;return this.set(x*v+o,x*p-c*g,x*g+c*p,0,x*p+c*g,f*p+o,f*g-c*v,0,x*g-c*p,f*g+c*v,h*g*g+o,0,0,0,0,1),this}makeScale(e,t,o){return this.set(e,0,0,0,0,t,0,0,0,0,o,0,0,0,0,1),this}makeShear(e,t,o,c,h,v){return this.set(1,o,h,0,e,1,v,0,t,c,1,0,0,0,0,1),this}compose(e,t,o){const c=this.elements,h=t._x,v=t._y,p=t._z,g=t._w,x=h+h,f=v+v,b=p+p,C=h*x,S=h*f,k=h*b,l=v*f,s=v*b,y=p*b,A=g*x,E=g*f,T=g*b,u=o.x,_=o.y,M=o.z;return c[0]=(1-(l+y))*u,c[1]=(S+T)*u,c[2]=(k-E)*u,c[3]=0,c[4]=(S-T)*_,c[5]=(1-(C+y))*_,c[6]=(s+A)*_,c[7]=0,c[8]=(k+E)*M,c[9]=(s-A)*M,c[10]=(1-(C+l))*M,c[11]=0,c[12]=e.x,c[13]=e.y,c[14]=e.z,c[15]=1,this}decompose(e,t,o){const c=this.elements;let h=zn.set(c[0],c[1],c[2]).length();const v=zn.set(c[4],c[5],c[6]).length(),p=zn.set(c[8],c[9],c[10]).length();this.determinant()<0&&(h=-h),e.x=c[12],e.y=c[13],e.z=c[14],Ut.copy(this);const g=1/h,x=1/v,f=1/p;return Ut.elements[0]*=g,Ut.elements[1]*=g,Ut.elements[2]*=g,Ut.elements[4]*=x,Ut.elements[5]*=x,Ut.elements[6]*=x,Ut.elements[8]*=f,Ut.elements[9]*=f,Ut.elements[10]*=f,t.setFromRotationMatrix(Ut),o.x=h,o.y=v,o.z=p,this}makePerspective(e,t,o,c,h,v,p=Zt){const g=this.elements,x=2*h/(t-e),f=2*h/(o-c),b=(t+e)/(t-e),C=(o+c)/(o-c);let S,k;if(p===Zt)S=-(v+h)/(v-h),k=-2*v*h/(v-h);else if(p===ir)S=-v/(v-h),k=-v*h/(v-h);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+p);return g[0]=x,g[4]=0,g[8]=b,g[12]=0,g[1]=0,g[5]=f,g[9]=C,g[13]=0,g[2]=0,g[6]=0,g[10]=S,g[14]=k,g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this}makeOrthographic(e,t,o,c,h,v,p=Zt){const g=this.elements,x=1/(t-e),f=1/(o-c),b=1/(v-h),C=(t+e)*x,S=(o+c)*f;let k,l;if(p===Zt)k=(v+h)*b,l=-2*b;else if(p===ir)k=h*b,l=-1*b;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+p);return g[0]=2*x,g[4]=0,g[8]=0,g[12]=-C,g[1]=0,g[5]=2*f,g[9]=0,g[13]=-S,g[2]=0,g[6]=0,g[10]=l,g[14]=-k,g[3]=0,g[7]=0,g[11]=0,g[15]=1,this}equals(e){const t=this.elements,o=e.elements;for(let c=0;c<16;c++)if(t[c]!==o[c])return!1;return!0}fromArray(e,t=0){for(let o=0;o<16;o++)this.elements[o]=e[o+t];return this}toArray(e=[],t=0){const o=this.elements;return e[t]=o[0],e[t+1]=o[1],e[t+2]=o[2],e[t+3]=o[3],e[t+4]=o[4],e[t+5]=o[5],e[t+6]=o[6],e[t+7]=o[7],e[t+8]=o[8],e[t+9]=o[9],e[t+10]=o[10],e[t+11]=o[11],e[t+12]=o[12],e[t+13]=o[13],e[t+14]=o[14],e[t+15]=o[15],e}}const zn=new U,Ut=new st,rc=new U(0,0,0),sc=new U(1,1,1),tn=new U,Pi=new U,At=new U,aa=new st,oa=new Pn;class $t{constructor(e=0,t=0,o=0,c=$t.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=o,this._order=c}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,o,c=this._order){return this._x=e,this._y=t,this._z=o,this._order=c,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,o=!0){const c=e.elements,h=c[0],v=c[4],p=c[8],g=c[1],x=c[5],f=c[9],b=c[2],C=c[6],S=c[10];switch(t){case"XYZ":this._y=Math.asin(_t(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-f,S),this._z=Math.atan2(-v,h)):(this._x=Math.atan2(C,x),this._z=0);break;case"YXZ":this._x=Math.asin(-_t(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(p,S),this._z=Math.atan2(g,x)):(this._y=Math.atan2(-b,h),this._z=0);break;case"ZXY":this._x=Math.asin(_t(C,-1,1)),Math.abs(C)<.9999999?(this._y=Math.atan2(-b,S),this._z=Math.atan2(-v,x)):(this._y=0,this._z=Math.atan2(g,h));break;case"ZYX":this._y=Math.asin(-_t(b,-1,1)),Math.abs(b)<.9999999?(this._x=Math.atan2(C,S),this._z=Math.atan2(g,h)):(this._x=0,this._z=Math.atan2(-v,x));break;case"YZX":this._z=Math.asin(_t(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(-f,x),this._y=Math.atan2(-b,h)):(this._x=0,this._y=Math.atan2(p,S));break;case"XZY":this._z=Math.asin(-_t(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(C,x),this._y=Math.atan2(p,h)):(this._x=Math.atan2(-f,S),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,o===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,o){return aa.makeRotationFromQuaternion(e),this.setFromRotationMatrix(aa,t,o)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return oa.setFromEuler(this),this.setFromQuaternion(oa,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}$t.DEFAULT_ORDER="XYZ";class mo{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let ac=0;const la=new U,Gn=new Pn,Xt=new st,Li=new U,di=new U,oc=new U,lc=new Pn,ca=new U(1,0,0),ua=new U(0,1,0),ha=new U(0,0,1),cc={type:"added"},uc={type:"removed"},Dr={type:"childadded",child:null},Ur={type:"childremoved",child:null};class Mt extends Ln{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ac++}),this.uuid=oi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Mt.DEFAULT_UP.clone();const e=new U,t=new $t,o=new Pn,c=new U(1,1,1);function h(){o.setFromEuler(t,!1)}function v(){t.setFromQuaternion(o,void 0,!1)}t._onChange(h),o._onChange(v),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:c},modelViewMatrix:{value:new st},normalMatrix:{value:new Ge}}),this.matrix=new st,this.matrixWorld=new st,this.matrixAutoUpdate=Mt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Mt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new mo,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Gn.setFromAxisAngle(e,t),this.quaternion.multiply(Gn),this}rotateOnWorldAxis(e,t){return Gn.setFromAxisAngle(e,t),this.quaternion.premultiply(Gn),this}rotateX(e){return this.rotateOnAxis(ca,e)}rotateY(e){return this.rotateOnAxis(ua,e)}rotateZ(e){return this.rotateOnAxis(ha,e)}translateOnAxis(e,t){return la.copy(e).applyQuaternion(this.quaternion),this.position.add(la.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(ca,e)}translateY(e){return this.translateOnAxis(ua,e)}translateZ(e){return this.translateOnAxis(ha,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Xt.copy(this.matrixWorld).invert())}lookAt(e,t,o){e.isVector3?Li.copy(e):Li.set(e,t,o);const c=this.parent;this.updateWorldMatrix(!0,!1),di.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Xt.lookAt(di,Li,this.up):Xt.lookAt(Li,di,this.up),this.quaternion.setFromRotationMatrix(Xt),c&&(Xt.extractRotation(c.matrixWorld),Gn.setFromRotationMatrix(Xt),this.quaternion.premultiply(Gn.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(cc),Dr.child=e,this.dispatchEvent(Dr),Dr.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(uc),Ur.child=e,this.dispatchEvent(Ur),Ur.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Xt.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Xt.multiply(e.parent.matrixWorld)),e.applyMatrix4(Xt),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let o=0,c=this.children.length;o<c;o++){const h=this.children[o].getObjectByProperty(e,t);if(h!==void 0)return h}}getObjectsByProperty(e,t,o=[]){this[e]===t&&o.push(this);const c=this.children;for(let h=0,v=c.length;h<v;h++)c[h].getObjectsByProperty(e,t,o);return o}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(di,e,oc),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(di,lc,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let o=0,c=t.length;o<c;o++)t[o].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let o=0,c=t.length;o<c;o++)t[o].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let o=0,c=t.length;o<c;o++){const h=t[o];(h.matrixWorldAutoUpdate===!0||e===!0)&&h.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const o=this.parent;if(e===!0&&o!==null&&o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const c=this.children;for(let h=0,v=c.length;h<v;h++){const p=c[h];p.matrixWorldAutoUpdate===!0&&p.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",o={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},o.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const c={};c.uuid=this.uuid,c.type=this.type,this.name!==""&&(c.name=this.name),this.castShadow===!0&&(c.castShadow=!0),this.receiveShadow===!0&&(c.receiveShadow=!0),this.visible===!1&&(c.visible=!1),this.frustumCulled===!1&&(c.frustumCulled=!1),this.renderOrder!==0&&(c.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(c.userData=this.userData),c.layers=this.layers.mask,c.matrix=this.matrix.toArray(),c.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(c.matrixAutoUpdate=!1),this.isInstancedMesh&&(c.type="InstancedMesh",c.count=this.count,c.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(c.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(c.type="BatchedMesh",c.perObjectFrustumCulled=this.perObjectFrustumCulled,c.sortObjects=this.sortObjects,c.drawRanges=this._drawRanges,c.reservedRanges=this._reservedRanges,c.visibility=this._visibility,c.active=this._active,c.bounds=this._bounds.map(p=>({boxInitialized:p.boxInitialized,boxMin:p.box.min.toArray(),boxMax:p.box.max.toArray(),sphereInitialized:p.sphereInitialized,sphereRadius:p.sphere.radius,sphereCenter:p.sphere.center.toArray()})),c.maxGeometryCount=this._maxGeometryCount,c.maxVertexCount=this._maxVertexCount,c.maxIndexCount=this._maxIndexCount,c.geometryInitialized=this._geometryInitialized,c.geometryCount=this._geometryCount,c.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(c.boundingSphere={center:c.boundingSphere.center.toArray(),radius:c.boundingSphere.radius}),this.boundingBox!==null&&(c.boundingBox={min:c.boundingBox.min.toArray(),max:c.boundingBox.max.toArray()}));function h(p,g){return p[g.uuid]===void 0&&(p[g.uuid]=g.toJSON(e)),g.uuid}if(this.isScene)this.background&&(this.background.isColor?c.background=this.background.toJSON():this.background.isTexture&&(c.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(c.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){c.geometry=h(e.geometries,this.geometry);const p=this.geometry.parameters;if(p!==void 0&&p.shapes!==void 0){const g=p.shapes;if(Array.isArray(g))for(let x=0,f=g.length;x<f;x++){const b=g[x];h(e.shapes,b)}else h(e.shapes,g)}}if(this.isSkinnedMesh&&(c.bindMode=this.bindMode,c.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(h(e.skeletons,this.skeleton),c.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const p=[];for(let g=0,x=this.material.length;g<x;g++)p.push(h(e.materials,this.material[g]));c.material=p}else c.material=h(e.materials,this.material);if(this.children.length>0){c.children=[];for(let p=0;p<this.children.length;p++)c.children.push(this.children[p].toJSON(e).object)}if(this.animations.length>0){c.animations=[];for(let p=0;p<this.animations.length;p++){const g=this.animations[p];c.animations.push(h(e.animations,g))}}if(t){const p=v(e.geometries),g=v(e.materials),x=v(e.textures),f=v(e.images),b=v(e.shapes),C=v(e.skeletons),S=v(e.animations),k=v(e.nodes);p.length>0&&(o.geometries=p),g.length>0&&(o.materials=g),x.length>0&&(o.textures=x),f.length>0&&(o.images=f),b.length>0&&(o.shapes=b),C.length>0&&(o.skeletons=C),S.length>0&&(o.animations=S),k.length>0&&(o.nodes=k)}return o.object=c,o;function v(p){const g=[];for(const x in p){const f=p[x];delete f.metadata,g.push(f)}return g}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let o=0;o<e.children.length;o++){const c=e.children[o];this.add(c.clone())}return this}}Mt.DEFAULT_UP=new U(0,1,0);Mt.DEFAULT_MATRIX_AUTO_UPDATE=!0;Mt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Hr=new U,Mc=new U,Sc=new Ge;class sn{constructor(e=new U(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,o,c){return this.normal.set(e,t,o),this.constant=c,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,o){const c=Hr.subVectors(o,t).cross(Mc.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(c,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const o=e.delta(Hr),c=this.normal.dot(o);if(c===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const h=-(e.start.dot(this.normal)+this.constant)/c;return h<0||h>1?null:t.copy(e.start).addScaledVector(o,h)}intersectsLine(e){const t=this.distanceToPoint(e.start),o=this.distanceToPoint(e.end);return t<0&&o>0||o<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const o=t||Sc.getNormalMatrix(e),c=this.coplanarPoint(Hr).applyMatrix4(e),h=this.normal.applyMatrix3(o).normalize();return this.constant=-c.dot(h),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}class To extends yt{constructor(e,t,o,c,h,v,p,g,x,f){if(f=f!==void 0?f:Rn,f!==Rn&&f!==si)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");o===void 0&&f===Rn&&(o=on),o===void 0&&f===si&&(o=wn),super(null,c,h,v,p,g,f,o,x),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=p!==void 0?p:xt,this.minFilter=g!==void 0?g:xt,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const Ao=new To(1,1);Ao.compareFunction=co;typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:os}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=os);new hs;new sn;function DataTable({title:r,columns:e,data:t,maxHeight:o="300px"}){return!t||t.length<1?null:jsxRuntimeExports$1.jsxs("div",{className:"p-2",children:[jsxRuntimeExports$1.jsx("h2",{className:"text-xl font-semibold mb-2",children:r}),jsxRuntimeExports$1.jsx("div",{className:"overflow-x-auto shadow bg-white",style:{maxHeight:o,overflowY:"auto"},children:jsxRuntimeExports$1.jsxs("table",{className:"min-w-full text-sm text-left",children:[jsxRuntimeExports$1.jsx("thead",{className:"bg-gray-100 text-gray-700",children:jsxRuntimeExports$1.jsx("tr",{children:e.map(c=>jsxRuntimeExports$1.jsx("th",{className:"px-4 py-2 font-medium",children:c},c))})}),jsxRuntimeExports$1.jsx("tbody",{children:t.map((c,h)=>jsxRuntimeExports$1.jsx("tr",{className:h%2===0?"bg-white":"bg-gray-50",children:e.map(v=>jsxRuntimeExports$1.jsx("td",{className:"px-4 py-2 text-gray-800",children:c[v]},v))},h))})]})})]})}function KpointsDataVisualiser({attributes:r,derivedProperties:e}){if(!r)return jsxRuntimeExports$1.jsx("div",{children:"No attributes available"});const t=["x","y","z"],o=(r.cell||[]).map(C=>({x:C[0],y:C[1],z:C[2]})),c=["dimension","value"],h=(r.mesh||[]).map((C,S)=>({dimension:S+1,value:C})),v=["i","x","y","z"],p=(r.offset||[]).map((C,S)=>({i:S+1,x:C[0]??C,y:C[1]??0,z:C[2]??0})),g=["axis","periodic"],x=[{axis:"pbc1",periodic:r.pbc1?"True":"False"},{axis:"pbc2",periodic:r.pbc2?"True":"False"},{axis:"pbc3",periodic:r.pbc3?"True":"False"}],f=["K-point number","x","y","z"],b=e.explicit_kpoints_abs.map((C,S)=>({"K-point number":S+1,x:C[0],y:C[1],z:C[2]}));return jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4 space-y-6 overflow-y-auto",children:[jsxRuntimeExports$1.jsx(DataTable,{title:"Cell",columns:t,data:o}),jsxRuntimeExports$1.jsx(DataTable,{title:"Mesh",columns:c,data:h}),jsxRuntimeExports$1.jsx(DataTable,{title:"Offset",columns:v,data:p}),jsxRuntimeExports$1.jsx(DataTable,{title:"PBC Flags",columns:g,data:x}),jsxRuntimeExports$1.jsx(DataTable,{title:"Explicit K-points (Absolute)",columns:f,data:b},"explicit_kpoints_abs")]})}function VisualiserPane({selectedNode:r}){if(!r)return jsxRuntimeExports$1.jsx("div",{className:"w-full h-full p-4",children:"No node selected"});if(r.data.label==="StructureData"){const e=r.data.download.cifText;return jsxRuntimeExports$1.jsx("div",{className:"w-full h-full p-4",children:jsxRuntimeExports$1.jsx(StructureVisualizer,{cifText:e,initSupercell:[2,2,2]})})}return r.data.label==="KpointsData"?(console.log(r.data),jsxRuntimeExports$1.jsx(KpointsDataVisualiser,{attributes:r.data.attributes,derivedProperties:r.data.derived_properties})):jsxRuntimeExports$1.jsx("div",{className:"w-full h-full p-4",children:jsxRuntimeExports$1.jsx("pre",{children:JSON.stringify(r.data.download||{},null,2)})})}function Breadcrumbs({trail:r,onClick:e,maxItems:t=10}){const o=r.slice(-t);return jsxRuntimeExports$1.jsx("div",{className:"w-full border-t border-gray-300 p-2 flex gap-2 flex-wrap overflow-x-auto",children:o.map((c,h)=>jsxRuntimeExports$1.jsxs(React.Fragment,{children:[jsxRuntimeExports$1.jsx("button",{className:"bg-gray-200 hover:bg-gray-300 text-sm px-2 py-1 rounded",onClick:()=>e(c,h),children:c.data.label}),h<o.length-1&&jsxRuntimeExports$1.jsx("span",{className:"mx-1",children:"→"})]},`${c.id}-${h}`))})}function layoutGraphWithEdges(r,e,t,o={}){const c=o.spacingX||200,h=o.spacingY||80,v=o.centerX||window.innerWidth/2,p=o.centerY||window.innerHeight/2,g=[],x=[];return g.push({...r,position:{x:v,y:p}}),e.sort((f,b)=>Number(f.id)-Number(b.id)),t.sort((f,b)=>Number(f.id)-Number(b.id)),e.forEach((f,b)=>{const C=(b-(e.length-1)/2)*h;g.push({...f,position:{x:v-c,y:p+C}}),x.push({id:`e-${f.id}-${r.id}`,source:f.id,target:r.id,sourcePosition:Position.Right,targetPosition:Position.Left,type:"smoothstep",style:{stroke:"green",strokeWidth:2},markerEnd:{type:"arrow",color:"green",width:20,height:15}})}),t.forEach((f,b)=>{const C=(b-(t.length-1)/2)*h;g.push({...f,position:{x:v+c,y:p+C}}),x.push({id:`e-${r.id}-${f.id}`,source:r.id,sourcePosition:Position.Right,target:f.id,type:"smoothstep",style:{stroke:"orange",strokeWidth:2},markerEnd:{type:"arrow",color:"orange",width:20,height:15}})}),{nodes:g,edges:x}}const BASE_URL="https://aiida.materialscloud.org/mc2d/api/v4";async function fetchNodeById(r){if(!r)return null;try{const e=await fetch(`${BASE_URL}/nodes/${encodeURIComponent(r)}`);return e.ok?e.json():null}catch(e){return console.error("Error fetching node:",e),null}}async function fetchNodeContents(r){if(!r)return null;const e=["attributes","comments","extras","derived_properties"];try{const t=await Promise.all(e.map(async p=>{const g=await fetch(`${BASE_URL}/nodes/${encodeURIComponent(r)}/contents/${p}`);return g.ok?g.json():null})),[o,c,h,v]=t;return{attributes:o?.data?.attributes??o??{},comments:c?.data?.comments??c??{},extras:h?.data?.extras??h??{},derived_properties:v?.data?.derived_properties??{}}}catch(t){return console.error("Error fetching node contents:",t),null}}async function fetchJson(r){if(!r)return{incoming:[],outgoing:[]};try{const e=await fetch(`${BASE_URL}/nodes/${encodeURIComponent(r)}/download?download_format=json`);return e.ok?e.json():null}catch(e){return console.error("Error fetching node:",e),null}}async function fetchCif(r){if(!r)return{cifText:null};try{const e=await fetch(`${BASE_URL}/nodes/${encodeURIComponent(r)}/download?download_format=cif&download=false`);if(!e.ok)return{cifText:null};const t=await e.json();return console.log("r",t.data.download.data),{cifText:t.data.download.data||null}}catch(e){return console.error("Error fetching node:",e),{cifText:null}}}async function fetchLinks(r){if(!r)return{incoming:[],outgoing:[]};try{const[e,t]=await Promise.all([fetch(`${BASE_URL}/nodes/${encodeURIComponent(r)}/links/incoming`),fetch(`${BASE_URL}/nodes/${encodeURIComponent(r)}/links/outgoing`)]),o=e.ok?await e.json():[],c=t.ok?await t.json():[];return{incoming:o,outgoing:c}}catch(e){return console.error("Error fetching links:",e),{incoming:[],outgoing:[]}}}async function fetchGraphByNodeId(r){const t=(await fetchNodeById(r)).data.nodes[0];if(!t)return{nodes:[],edges:[]};const{incoming:o,outgoing:c}=await fetchLinks(r),h=o?.data?.incoming||[],v=c?.data?.outgoing||[];console.log("RN",t);const p=[{id:t.uuid,data:{label:t.node_type.split(".").filter(Boolean).pop(),node_type:t.node_type,pos:"center",aiida:t}},...h.map(f=>({id:f.uuid,data:{label:f.node_type.split(".").filter(Boolean).pop(),node_type:f.node_type,pos:"input",aiida:f}})),...v.map(f=>({id:f.uuid,data:{label:f.node_type.split(".").filter(Boolean).pop(),node_type:f.node_type,pos:"output",aiida:f}}))],{nodes:g,edges:x}=layoutGraphWithEdges(p.find(f=>f.data.pos==="center"),p.filter(f=>f.data.pos==="input"),p.filter(f=>f.data.pos==="output"));return{nodes:g,edges:x}}function Explorer(){const[r,e]=reactExports.useState([]),[t,o]=reactExports.useState([]),[c,h]=reactExports.useState([]),v=20,[p,g]=useSearchParams(),x=p.get("rootNode")||"030bf271-2c94-4d93-8314-7f82f271bd44",[f,b]=reactExports.useState(x),[C,S]=reactExports.useState(null),[k,l]=reactExports.useState({}),[s,y]=reactExports.useState(null);reactExports.useEffect(()=>{let _=!0;async function M(){const R=performance.now(),{nodes:N,edges:I}=await fetchGraphByNodeId(f);if(!_)return;const L=N.map(Y=>({...Y,data:{...Y.data,...k[Y.id]||{}}}));if(e(L),o(I),C){const Y=L.find(B=>B.id===C.id);S(Y||null)}y(performance.now()-R)}return M(),()=>{_=!1}},[f]);const A=async _=>{let M={..._.data};if(k[_.id])M={...M,...k[_.id]};else{const R=await fetchNodeContents(_.id);l(N=>({...N,[_.id]:R})),M={...M,...R}}if(!M.download){let R;_.data.label==="StructureData"?R=await fetchCif(_.id):R=await fetchJson(_.id),M={...M,download:R},l(N=>({...N,[_.id]:{...N[_.id]||{},download:R}}))}return{..._,data:M}},E=async _=>{const M=await A(_);S(M)},T=async _=>{c[c.length-1]?.id!==_.id&&h(R=>[...R,_].slice(-v)),b(_.id),g({rootNode:_.id});const M=await A(_);S(M)},u=async(_,M)=>{h(N=>N.slice(0,M+1)),b(_.id),g({rootNode:_.id});const R=await A(_);S(R)};return jsxRuntimeExports$1.jsxs("div",{className:"flex flex-col h-screen",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[jsxRuntimeExports$1.jsx("div",{className:"flex-1 border-r border-gray-300 h-full min-w-0",children:jsxRuntimeExports$1.jsx(FlowChart,{nodes:r,edges:t,setNodes:e,setEdges:o,selectedNode:C,onNodeSelect:E,onNodeDoubleSelect:T})}),jsxRuntimeExports$1.jsxs("div",{className:"w-[900px] flex flex-col h-full",children:[jsxRuntimeExports$1.jsx("div",{className:"flex-none h-1/4 border-b border-gray-300 overflow-y-auto",children:jsxRuntimeExports$1.jsx(SidePane,{selectedNode:C,timeTaken:s})}),jsxRuntimeExports$1.jsx("div",{className:"flex-1 overflow-y-auto",children:jsxRuntimeExports$1.jsx(VisualiserPane,{selectedNode:C})})]})]}),jsxRuntimeExports$1.jsx("div",{className:"flex-none h-12 border-t border-gray-300",children:jsxRuntimeExports$1.jsx(Breadcrumbs,{trail:c,onClick:u,maxItems:v})})]})}function App(){return jsxRuntimeExports$1.jsx(Explorer,{})}ReactDOM.createRoot(document.getElementById("root")).render(jsxRuntimeExports$1.jsx(React.StrictMode,{children:jsxRuntimeExports$1.jsx(BrowserRouter,{children:jsxRuntimeExports$1.jsx(App,{})})}));
