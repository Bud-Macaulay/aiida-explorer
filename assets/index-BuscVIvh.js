(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const v of u.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&o(v)}).observe(document,{childList:!0,subtree:!0});function t(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(c){if(c.ep)return;c.ep=!0;const u=t(c);fetch(c.href,u)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsxRuntime$1={exports:{}},reactJsxRuntime_production_min$1={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),v=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),_=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),E=Symbol.iterator;function k(G){return G===null||typeof G!="object"?null:(G=E&&G[E]||G["@@iterator"],typeof G=="function"?G:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z=Object.assign,l={};function s(G,V,Z){this.props=G,this.context=V,this.refs=l,this.updater=Z||A}s.prototype.isReactComponent={},s.prototype.setState=function(G,V){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,V,"setState")},s.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function y(){}y.prototype=s.prototype;function w(G,V,Z){this.props=G,this.context=V,this.refs=l,this.updater=Z||A}var S=w.prototype=new y;S.constructor=w,z(S,s.prototype),S.isPureReactComponent=!0;var C=Array.isArray,h=Object.prototype.hasOwnProperty,x={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function M(G,V,Z){var xe,ce={},Ne=null,Pe=null;if(V!=null)for(xe in V.ref!==void 0&&(Pe=V.ref),V.key!==void 0&&(Ne=""+V.key),V)h.call(V,xe)&&!R.hasOwnProperty(xe)&&(ce[xe]=V[xe]);var De=arguments.length-2;if(De===1)ce.children=Z;else if(1<De){for(var Me=Array(De),Be=0;Be<De;Be++)Me[Be]=arguments[Be+2];ce.children=Me}if(G&&G.defaultProps)for(xe in De=G.defaultProps,De)ce[xe]===void 0&&(ce[xe]=De[xe]);return{$$typeof:e,type:G,key:Ne,ref:Pe,props:ce,_owner:x.current}}function P(G,V){return{$$typeof:e,type:G.type,key:V,ref:G.ref,props:G.props,_owner:G._owner}}function D(G){return typeof G=="object"&&G!==null&&G.$$typeof===e}function L(G){var V={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(Z){return V[Z]})}var X=/\/+/g;function B(G,V){return typeof G=="object"&&G!==null&&G.key!=null?L(""+G.key):V.toString(36)}function j(G,V,Z,xe,ce){var Ne=typeof G;(Ne==="undefined"||Ne==="boolean")&&(G=null);var Pe=!1;if(G===null)Pe=!0;else switch(Ne){case"string":case"number":Pe=!0;break;case"object":switch(G.$$typeof){case e:case r:Pe=!0}}if(Pe)return Pe=G,ce=ce(Pe),G=xe===""?"."+B(Pe,0):xe,C(ce)?(Z="",G!=null&&(Z=G.replace(X,"$&/")+"/"),j(ce,V,Z,"",function(Be){return Be})):ce!=null&&(D(ce)&&(ce=P(ce,Z+(!ce.key||Pe&&Pe.key===ce.key?"":(""+ce.key).replace(X,"$&/")+"/")+G)),V.push(ce)),1;if(Pe=0,xe=xe===""?".":xe+":",C(G))for(var De=0;De<G.length;De++){Ne=G[De];var Me=xe+B(Ne,De);Pe+=j(Ne,V,Z,Me,ce)}else if(Me=k(G),typeof Me=="function")for(G=Me.call(G),De=0;!(Ne=G.next()).done;)Ne=Ne.value,Me=xe+B(Ne,De++),Pe+=j(Ne,V,Z,Me,ce);else if(Ne==="object")throw V=String(G),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return Pe}function H(G,V,Z){if(G==null)return G;var xe=[],ce=0;return j(G,xe,"","",function(Ne){return V.call(Z,Ne,ce++)}),xe}function $(G){if(G._status===-1){var V=G._result;V=V(),V.then(function(Z){(G._status===0||G._status===-1)&&(G._status=1,G._result=Z)},function(Z){(G._status===0||G._status===-1)&&(G._status=2,G._result=Z)}),G._status===-1&&(G._status=0,G._result=V)}if(G._status===1)return G._result.default;throw G._result}var q={current:null},W={transition:null},Y={ReactCurrentDispatcher:q,ReactCurrentBatchConfig:W,ReactCurrentOwner:x};return react_production_min.Children={map:H,forEach:function(G,V,Z){H(G,function(){V.apply(this,arguments)},Z)},count:function(G){var V=0;return H(G,function(){V++}),V},toArray:function(G){return H(G,function(V){return V})||[]},only:function(G){if(!D(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},react_production_min.Component=s,react_production_min.Fragment=t,react_production_min.Profiler=c,react_production_min.PureComponent=w,react_production_min.StrictMode=o,react_production_min.Suspense=g,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y,react_production_min.cloneElement=function(G,V,Z){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var xe=z({},G.props),ce=G.key,Ne=G.ref,Pe=G._owner;if(V!=null){if(V.ref!==void 0&&(Ne=V.ref,Pe=x.current),V.key!==void 0&&(ce=""+V.key),G.type&&G.type.defaultProps)var De=G.type.defaultProps;for(Me in V)h.call(V,Me)&&!R.hasOwnProperty(Me)&&(xe[Me]=V[Me]===void 0&&De!==void 0?De[Me]:V[Me])}var Me=arguments.length-2;if(Me===1)xe.children=Z;else if(1<Me){De=Array(Me);for(var Be=0;Be<Me;Be++)De[Be]=arguments[Be+2];xe.children=De}return{$$typeof:e,type:G.type,key:ce,ref:Ne,props:xe,_owner:Pe}},react_production_min.createContext=function(G){return G={$$typeof:v,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:u,_context:G},G.Consumer=G},react_production_min.createElement=M,react_production_min.createFactory=function(G){var V=M.bind(null,G);return V.type=G,V},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(G){return{$$typeof:f,render:G}},react_production_min.isValidElement=D,react_production_min.lazy=function(G){return{$$typeof:p,_payload:{_status:-1,_result:G},_init:$}},react_production_min.memo=function(G,V){return{$$typeof:_,type:G,compare:V===void 0?null:V}},react_production_min.startTransition=function(G){var V=W.transition;W.transition={};try{G()}finally{W.transition=V}},react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},react_production_min.useCallback=function(G,V){return q.current.useCallback(G,V)},react_production_min.useContext=function(G){return q.current.useContext(G)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(G){return q.current.useDeferredValue(G)},react_production_min.useEffect=function(G,V){return q.current.useEffect(G,V)},react_production_min.useId=function(){return q.current.useId()},react_production_min.useImperativeHandle=function(G,V,Z){return q.current.useImperativeHandle(G,V,Z)},react_production_min.useInsertionEffect=function(G,V){return q.current.useInsertionEffect(G,V)},react_production_min.useLayoutEffect=function(G,V){return q.current.useLayoutEffect(G,V)},react_production_min.useMemo=function(G,V){return q.current.useMemo(G,V)},react_production_min.useReducer=function(G,V,Z){return q.current.useReducer(G,V,Z)},react_production_min.useRef=function(G){return q.current.useRef(G)},react_production_min.useState=function(G){return q.current.useState(G)},react_production_min.useSyncExternalStore=function(G,V,Z){return q.current.useSyncExternalStore(G,V,Z)},react_production_min.useTransition=function(){return q.current.useTransition()},react_production_min.version="18.2.0",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min$1;function requireReactJsxRuntime_production_min$1(){if(hasRequiredReactJsxRuntime_production_min$1)return reactJsxRuntime_production_min$1;hasRequiredReactJsxRuntime_production_min$1=1;var e=requireReact(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function v(f,g,_){var p,E={},k=null,A=null;_!==void 0&&(k=""+_),g.key!==void 0&&(k=""+g.key),g.ref!==void 0&&(A=g.ref);for(p in g)o.call(g,p)&&!u.hasOwnProperty(p)&&(E[p]=g[p]);if(f&&f.defaultProps)for(p in g=f.defaultProps,g)E[p]===void 0&&(E[p]=g[p]);return{$$typeof:r,type:f,key:k,ref:A,props:E,_owner:c.current}}return reactJsxRuntime_production_min$1.Fragment=t,reactJsxRuntime_production_min$1.jsx=v,reactJsxRuntime_production_min$1.jsxs=v,reactJsxRuntime_production_min$1}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime$1.exports=requireReactJsxRuntime_production_min$1()),jsxRuntime$1.exports}var jsxRuntimeExports$1=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(e){function r(W,Y){var G=W.length;W.push(Y);e:for(;0<G;){var V=G-1>>>1,Z=W[V];if(0<c(Z,Y))W[V]=Y,W[G]=Z,G=V;else break e}}function t(W){return W.length===0?null:W[0]}function o(W){if(W.length===0)return null;var Y=W[0],G=W.pop();if(G!==Y){W[0]=G;e:for(var V=0,Z=W.length,xe=Z>>>1;V<xe;){var ce=2*(V+1)-1,Ne=W[ce],Pe=ce+1,De=W[Pe];if(0>c(Ne,G))Pe<Z&&0>c(De,Ne)?(W[V]=De,W[Pe]=G,V=Pe):(W[V]=Ne,W[ce]=G,V=ce);else if(Pe<Z&&0>c(De,G))W[V]=De,W[Pe]=G,V=Pe;else break e}}return Y}function c(W,Y){var G=W.sortIndex-Y.sortIndex;return G!==0?G:W.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var u=performance;e.unstable_now=function(){return u.now()}}else{var v=Date,f=v.now();e.unstable_now=function(){return v.now()-f}}var g=[],_=[],p=1,E=null,k=3,A=!1,z=!1,l=!1,s=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var Y=t(_);Y!==null;){if(Y.callback===null)o(_);else if(Y.startTime<=W)o(_),Y.sortIndex=Y.expirationTime,r(g,Y);else break;Y=t(_)}}function C(W){if(l=!1,S(W),!z)if(t(g)!==null)z=!0,$(h);else{var Y=t(_);Y!==null&&q(C,Y.startTime-W)}}function h(W,Y){z=!1,l&&(l=!1,y(M),M=-1),A=!0;var G=k;try{for(S(Y),E=t(g);E!==null&&(!(E.expirationTime>Y)||W&&!L());){var V=E.callback;if(typeof V=="function"){E.callback=null,k=E.priorityLevel;var Z=V(E.expirationTime<=Y);Y=e.unstable_now(),typeof Z=="function"?E.callback=Z:E===t(g)&&o(g),S(Y)}else o(g);E=t(g)}if(E!==null)var xe=!0;else{var ce=t(_);ce!==null&&q(C,ce.startTime-Y),xe=!1}return xe}finally{E=null,k=G,A=!1}}var x=!1,R=null,M=-1,P=5,D=-1;function L(){return!(e.unstable_now()-D<P)}function X(){if(R!==null){var W=e.unstable_now();D=W;var Y=!0;try{Y=R(!0,W)}finally{Y?B():(x=!1,R=null)}}else x=!1}var B;if(typeof w=="function")B=function(){w(X)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,H=j.port2;j.port1.onmessage=X,B=function(){H.postMessage(null)}}else B=function(){s(X,0)};function $(W){R=W,x||(x=!0,B())}function q(W,Y){M=s(function(){W(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){z||A||(z=!0,$(h))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return k},e.unstable_getFirstCallbackNode=function(){return t(g)},e.unstable_next=function(W){switch(k){case 1:case 2:case 3:var Y=3;break;default:Y=k}var G=k;k=Y;try{return W()}finally{k=G}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,Y){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var G=k;k=W;try{return Y()}finally{k=G}},e.unstable_scheduleCallback=function(W,Y,G){var V=e.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?V+G:V):G=V,W){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=G+Z,W={id:p++,callback:Y,priorityLevel:W,startTime:G,expirationTime:Z,sortIndex:-1},G>V?(W.sortIndex=G,r(_,W),t(g)===null&&W===t(_)&&(l?(y(M),M=-1):l=!0,q(C,G-V))):(W.sortIndex=Z,r(g,W),z||A||(z=!0,$(h))),W},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(W){var Y=k;return function(){var G=k;k=Y;try{return W.apply(this,arguments)}finally{k=G}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var e=requireReact(),r=requireScheduler();function t(n){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+n,b=1;b<arguments.length;b++)a+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,c={};function u(n,a){v(n,a),v(n+"Capture",a)}function v(n,a){for(c[n]=a,n=0;n<a.length;n++)o.add(a[n])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),g=Object.prototype.hasOwnProperty,_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},E={};function k(n){return g.call(E,n)?!0:g.call(p,n)?!1:_.test(n)?E[n]=!0:(p[n]=!0,!1)}function A(n,a,b,F){if(b!==null&&b.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return F?!1:b!==null?!b.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function z(n,a,b,F){if(a===null||typeof a>"u"||A(n,a,b,F))return!0;if(F)return!1;if(b!==null)switch(b.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function l(n,a,b,F,U,Q,oe){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=F,this.attributeNamespace=U,this.mustUseProperty=b,this.propertyName=n,this.type=a,this.sanitizeURL=Q,this.removeEmptyString=oe}var s={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){s[n]=new l(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var a=n[0];s[a]=new l(a,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){s[n]=new l(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){s[n]=new l(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){s[n]=new l(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){s[n]=new l(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){s[n]=new l(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){s[n]=new l(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){s[n]=new l(n,5,!1,n.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function w(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var a=n.replace(y,w);s[a]=new l(a,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var a=n.replace(y,w);s[a]=new l(a,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var a=n.replace(y,w);s[a]=new l(a,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){s[n]=new l(n,1,!1,n.toLowerCase(),null,!1,!1)}),s.xlinkHref=new l("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){s[n]=new l(n,1,!1,n.toLowerCase(),null,!0,!0)});function S(n,a,b,F){var U=s.hasOwnProperty(a)?s[a]:null;(U!==null?U.type!==0:F||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(z(a,b,U,F)&&(b=null),F||U===null?k(a)&&(b===null?n.removeAttribute(a):n.setAttribute(a,""+b)):U.mustUseProperty?n[U.propertyName]=b===null?U.type===3?!1:"":b:(a=U.attributeName,F=U.attributeNamespace,b===null?n.removeAttribute(a):(U=U.type,b=U===3||U===4&&b===!0?"":""+b,F?n.setAttributeNS(F,a,b):n.setAttribute(a,b))))}var C=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,h=Symbol.for("react.element"),x=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),L=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),q=Symbol.for("react.offscreen"),W=Symbol.iterator;function Y(n){return n===null||typeof n!="object"?null:(n=W&&n[W]||n["@@iterator"],typeof n=="function"?n:null)}var G=Object.assign,V;function Z(n){if(V===void 0)try{throw Error()}catch(b){var a=b.stack.trim().match(/\n( *(at )?)/);V=a&&a[1]||""}return`
`+V+n}var xe=!1;function ce(n,a){if(!n||xe)return"";xe=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(Vt){var F=Vt}Reflect.construct(n,[],a)}else{try{a.call()}catch(Vt){F=Vt}n.call(a.prototype)}else{try{throw Error()}catch(Vt){F=Vt}n()}}catch(Vt){if(Vt&&F&&typeof Vt.stack=="string"){for(var U=Vt.stack.split(`
`),Q=F.stack.split(`
`),oe=U.length-1,je=Q.length-1;1<=oe&&0<=je&&U[oe]!==Q[je];)je--;for(;1<=oe&&0<=je;oe--,je--)if(U[oe]!==Q[je]){if(oe!==1||je!==1)do if(oe--,je--,0>je||U[oe]!==Q[je]){var st=`
`+U[oe].replace(" at new "," at ");return n.displayName&&st.includes("<anonymous>")&&(st=st.replace("<anonymous>",n.displayName)),st}while(1<=oe&&0<=je);break}}}finally{xe=!1,Error.prepareStackTrace=b}return(n=n?n.displayName||n.name:"")?Z(n):""}function Ne(n){switch(n.tag){case 5:return Z(n.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 2:case 15:return n=ce(n.type,!1),n;case 11:return n=ce(n.type.render,!1),n;case 1:return n=ce(n.type,!0),n;default:return""}}function Pe(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case R:return"Fragment";case x:return"Portal";case P:return"Profiler";case M:return"StrictMode";case B:return"Suspense";case j:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case L:return(n.displayName||"Context")+".Consumer";case D:return(n._context.displayName||"Context")+".Provider";case X:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case H:return a=n.displayName||null,a!==null?a:Pe(n.type)||"Memo";case $:a=n._payload,n=n._init;try{return Pe(n(a))}catch{}}return null}function De(n){var a=n.type;switch(n.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=a.render,n=n.displayName||n.name||"",a.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pe(a);case 8:return a===M?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Me(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Be(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function ft(n){var a=Be(n)?"checked":"value",b=Object.getOwnPropertyDescriptor(n.constructor.prototype,a),F=""+n[a];if(!n.hasOwnProperty(a)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var U=b.get,Q=b.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return U.call(this)},set:function(oe){F=""+oe,Q.call(this,oe)}}),Object.defineProperty(n,a,{enumerable:b.enumerable}),{getValue:function(){return F},setValue:function(oe){F=""+oe},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function jt(n){n._valueTracker||(n._valueTracker=ft(n))}function Gt(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var b=a.getValue(),F="";return n&&(F=Be(n)?n.checked?"true":"false":n.value),n=F,n!==b?(a.setValue(n),!0):!1}function mt(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Fe(n,a){var b=a.checked;return G({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:b??n._wrapperState.initialChecked})}function ht(n,a){var b=a.defaultValue==null?"":a.defaultValue,F=a.checked!=null?a.checked:a.defaultChecked;b=Me(a.value!=null?a.value:b),n._wrapperState={initialChecked:F,initialValue:b,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function Kt(n,a){a=a.checked,a!=null&&S(n,"checked",a,!1)}function Jt(n,a){Kt(n,a);var b=Me(a.value),F=a.type;if(b!=null)F==="number"?(b===0&&n.value===""||n.value!=b)&&(n.value=""+b):n.value!==""+b&&(n.value=""+b);else if(F==="submit"||F==="reset"){n.removeAttribute("value");return}a.hasOwnProperty("value")?Br(n,a.type,b):a.hasOwnProperty("defaultValue")&&Br(n,a.type,Me(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(n.defaultChecked=!!a.defaultChecked)}function Wt(n,a,b){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var F=a.type;if(!(F!=="submit"&&F!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+n._wrapperState.initialValue,b||a===n.value||(n.value=a),n.defaultValue=a}b=n.name,b!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,b!==""&&(n.name=b)}function Br(n,a,b){(a!=="number"||mt(n.ownerDocument)!==n)&&(b==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+b&&(n.defaultValue=""+b))}var zr=Array.isArray;function cr(n,a,b,F){if(n=n.options,a){a={};for(var U=0;U<b.length;U++)a["$"+b[U]]=!0;for(b=0;b<n.length;b++)U=a.hasOwnProperty("$"+n[b].value),n[b].selected!==U&&(n[b].selected=U),U&&F&&(n[b].defaultSelected=!0)}else{for(b=""+Me(b),a=null,U=0;U<n.length;U++){if(n[U].value===b){n[U].selected=!0,F&&(n[U].defaultSelected=!0);return}a!==null||n[U].disabled||(a=n[U])}a!==null&&(a.selected=!0)}}function Nr(n,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return G({},a,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function At(n,a){var b=a.value;if(b==null){if(b=a.children,a=a.defaultValue,b!=null){if(a!=null)throw Error(t(92));if(zr(b)){if(1<b.length)throw Error(t(93));b=b[0]}a=b}a==null&&(a=""),b=a}n._wrapperState={initialValue:Me(b)}}function Mt(n,a){var b=Me(a.value),F=Me(a.defaultValue);b!=null&&(b=""+b,b!==n.value&&(n.value=b),a.defaultValue==null&&n.defaultValue!==b&&(n.defaultValue=b)),F!=null&&(n.defaultValue=""+F)}function Jr(n){var a=n.textContent;a===n._wrapperState.initialValue&&a!==""&&a!==null&&(n.value=a)}function Yr(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ie(n,a){return n==null||n==="http://www.w3.org/1999/xhtml"?Yr(a):n==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var ve,we=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,b,F,U){MSApp.execUnsafeLocalFunction(function(){return n(a,b,F,U)})}:n})(function(n,a){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=a;else{for(ve=ve||document.createElement("div"),ve.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=ve.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;a.firstChild;)n.appendChild(a.firstChild)}});function it(n,a){if(a){var b=n.firstChild;if(b&&b===n.lastChild&&b.nodeType===3){b.nodeValue=a;return}}n.textContent=a}var rt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Yt=["Webkit","ms","Moz","O"];Object.keys(rt).forEach(function(n){Yt.forEach(function(a){a=a+n.charAt(0).toUpperCase()+n.substring(1),rt[a]=rt[n]})});function Ft(n,a,b){return a==null||typeof a=="boolean"||a===""?"":b||typeof a!="number"||a===0||rt.hasOwnProperty(n)&&rt[n]?(""+a).trim():a+"px"}function re(n,a){n=n.style;for(var b in a)if(a.hasOwnProperty(b)){var F=b.indexOf("--")===0,U=Ft(b,a[b],F);b==="float"&&(b="cssFloat"),F?n.setProperty(b,U):n[b]=U}}var tt=G({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lt(n,a){if(a){if(tt[n]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,n));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function ar(n,a){if(n.indexOf("-")===-1)return typeof a.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var et=null;function Ot(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var se=null,xt=null,Vr=null;function J(n){if(n=yc(n)){if(typeof se!="function")throw Error(t(280));var a=n.stateNode;a&&(a=tu(a),se(n.stateNode,n.type,a))}}function ut(n){xt?Vr?Vr.push(n):Vr=[n]:xt=n}function at(){if(xt){var n=xt,a=Vr;if(Vr=xt=null,J(n),a)for(n=0;n<a.length;n++)J(a[n])}}function me(n,a){return n(a)}function Ze(){}var vt=!1;function Qr(n,a,b){if(vt)return n(a,b);vt=!0;try{return me(n,a,b)}finally{vt=!1,(xt!==null||Vr!==null)&&(Ze(),at())}}function Xr(n,a){var b=n.stateNode;if(b===null)return null;var F=tu(b);if(F===null)return null;b=F[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(F=!F.disabled)||(n=n.type,F=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!F;break e;default:n=!1}if(n)return null;if(b&&typeof b!="function")throw Error(t(231,a,typeof b));return b}var Zr=!1;if(f)try{var xn={};Object.defineProperty(xn,"passive",{get:function(){Zr=!0}}),window.addEventListener("test",xn,xn),window.removeEventListener("test",xn,xn)}catch{Zr=!1}function Ei(n,a,b,F,U,Q,oe,je,st){var Vt=Array.prototype.slice.call(arguments,3);try{a.apply(b,Vt)}catch(Ur){this.onError(Ur)}}var zn=!1,Pn=null,On=!1,mi=null,xi={onError:function(n){zn=!0,Pn=n}};function Ca(n,a,b,F,U,Q,oe,je,st){zn=!1,Pn=null,Ei.apply(xi,arguments)}function Aa(n,a,b,F,U,Q,oe,je,st){if(Ca.apply(this,arguments),zn){if(zn){var Vt=Pn;zn=!1,Pn=null}else throw Error(t(198));On||(On=!0,mi=Vt)}}function ei(n){var a=n,b=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(b=a.return),n=a.return;while(n)}return a.tag===3?b:null}function ai(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function ci(n){if(ei(n)!==n)throw Error(t(188))}function Xs(n){var a=n.alternate;if(!a){if(a=ei(n),a===null)throw Error(t(188));return a!==n?null:n}for(var b=n,F=a;;){var U=b.return;if(U===null)break;var Q=U.alternate;if(Q===null){if(F=U.return,F!==null){b=F;continue}break}if(U.child===Q.child){for(Q=U.child;Q;){if(Q===b)return ci(U),n;if(Q===F)return ci(U),a;Q=Q.sibling}throw Error(t(188))}if(b.return!==F.return)b=U,F=Q;else{for(var oe=!1,je=U.child;je;){if(je===b){oe=!0,b=U,F=Q;break}if(je===F){oe=!0,F=U,b=Q;break}je=je.sibling}if(!oe){for(je=Q.child;je;){if(je===b){oe=!0,b=Q,F=U;break}if(je===F){oe=!0,F=Q,b=U;break}je=je.sibling}if(!oe)throw Error(t(189))}}if(b.alternate!==F)throw Error(t(190))}if(b.tag!==3)throw Error(t(188));return b.stateNode.current===b?n:a}function Us(n){return n=Xs(n),n!==null?fa(n):null}function fa(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var a=fa(n);if(a!==null)return a;n=n.sibling}return null}var ll=r.unstable_scheduleCallback,cl=r.unstable_cancelCallback,ul=r.unstable_shouldYield,Ya=r.unstable_requestPaint,hi=r.unstable_now,dl=r.unstable_getCurrentPriorityLevel,ja=r.unstable_ImmediatePriority,kc=r.unstable_UserBlockingPriority,Ln=r.unstable_NormalPriority,Ra=r.unstable_LowPriority,pa=r.unstable_IdlePriority,Tl=null,Ws=null;function hl(n){if(Ws&&typeof Ws.onCommitFiberRoot=="function")try{Ws.onCommitFiberRoot(Tl,n,void 0,(n.current.flags&128)===128)}catch{}}var ma=Math.clz32?Math.clz32:gu,pu=Math.log,mu=Math.LN2;function gu(n){return n>>>=0,n===0?32:31-(pu(n)/mu|0)|0}var Na=64,qa=4194304;function Ns(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ba(n,a){var b=n.pendingLanes;if(b===0)return 0;var F=0,U=n.suspendedLanes,Q=n.pingedLanes,oe=b&268435455;if(oe!==0){var je=oe&~U;je!==0?F=Ns(je):(Q&=oe,Q!==0&&(F=Ns(Q)))}else oe=b&~U,oe!==0?F=Ns(oe):Q!==0&&(F=Ns(Q));if(F===0)return 0;if(a!==0&&a!==F&&(a&U)===0&&(U=F&-F,Q=a&-a,U>=Q||U===16&&(Q&4194240)!==0))return a;if((F&4)!==0&&(F|=b&16),a=n.entangledLanes,a!==0)for(n=n.entanglements,a&=F;0<a;)b=31-ma(a),U=1<<b,F|=n[b],a&=~U;return F}function fl(n,a){switch(n){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ml(n,a){for(var b=n.suspendedLanes,F=n.pingedLanes,U=n.expirationTimes,Q=n.pendingLanes;0<Q;){var oe=31-ma(Q),je=1<<oe,st=U[oe];st===-1?((je&b)===0||(je&F)!==0)&&(U[oe]=fl(je,a)):st<=a&&(n.expiredLanes|=je),Q&=~je}}function yu(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Xa(){var n=Na;return Na<<=1,(Na&4194240)===0&&(Na=64),n}function Tc(n){for(var a=[],b=0;31>b;b++)a.push(n);return a}function _a(n,a,b){n.pendingLanes|=a,a!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,a=31-ma(a),n[a]=b}function bh(n,a){var b=n.pendingLanes&~a;n.pendingLanes=a,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=a,n.mutableReadLanes&=a,n.entangledLanes&=a,a=n.entanglements;var F=n.eventTimes;for(n=n.expirationTimes;0<b;){var U=31-ma(b),Q=1<<U;a[U]=0,F[U]=-1,n[U]=-1,b&=~Q}}function za(n,a){var b=n.entangledLanes|=a;for(n=n.entanglements;b;){var F=31-ma(b),U=1<<F;U&a|n[F]&a&&(n[F]|=a),b&=~U}}var Dn=0;function oa(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var ii,pl,Mc,vu,ml,Nc=!1,Nl=[],ga=null,Ja=null,Qa=null,aa=new Map,Ga=new Map,Za=[],wh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zl(n,a){switch(n){case"focusin":case"focusout":ga=null;break;case"dragenter":case"dragleave":Ja=null;break;case"mouseover":case"mouseout":Qa=null;break;case"pointerover":case"pointerout":aa.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ga.delete(a.pointerId)}}function Il(n,a,b,F,U,Q){return n===null||n.nativeEvent!==Q?(n={blockedOn:a,domEventName:b,eventSystemFlags:F,nativeEvent:Q,targetContainers:[U]},a!==null&&(a=yc(a),a!==null&&pl(a)),n):(n.eventSystemFlags|=F,a=n.targetContainers,U!==null&&a.indexOf(U)===-1&&a.push(U),n)}function fd(n,a,b,F,U){switch(a){case"focusin":return ga=Il(ga,n,a,b,F,U),!0;case"dragenter":return Ja=Il(Ja,n,a,b,F,U),!0;case"mouseover":return Qa=Il(Qa,n,a,b,F,U),!0;case"pointerover":var Q=U.pointerId;return aa.set(Q,Il(aa.get(Q)||null,n,a,b,F,U)),!0;case"gotpointercapture":return Q=U.pointerId,Ga.set(Q,Il(Ga.get(Q)||null,n,a,b,F,U)),!0}return!1}function pd(n){var a=El(n.target);if(a!==null){var b=ei(a);if(b!==null){if(a=b.tag,a===13){if(a=ai(b),a!==null){n.blockedOn=a,ml(n.priority,function(){Mc(b)});return}}else if(a===3&&b.stateNode.current.memoizedState.isDehydrated){n.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}n.blockedOn=null}function rc(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var b=_u(n.domEventName,n.eventSystemFlags,a[0],n.nativeEvent);if(b===null){b=n.nativeEvent;var F=new b.constructor(b.type,b);et=F,b.target.dispatchEvent(F),et=null}else return a=yc(b),a!==null&&pl(a),n.blockedOn=b,!1;a.shift()}return!0}function md(n,a,b){rc(n)&&b.delete(a)}function Eh(){Nc=!1,ga!==null&&rc(ga)&&(ga=null),Ja!==null&&rc(Ja)&&(Ja=null),Qa!==null&&rc(Qa)&&(Qa=null),aa.forEach(md),Ga.forEach(md)}function nc(n,a){n.blockedOn===a&&(n.blockedOn=null,Nc||(Nc=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Eh)))}function ic(n){function a(U){return nc(U,n)}if(0<Nl.length){nc(Nl[0],n);for(var b=1;b<Nl.length;b++){var F=Nl[b];F.blockedOn===n&&(F.blockedOn=null)}}for(ga!==null&&nc(ga,n),Ja!==null&&nc(Ja,n),Qa!==null&&nc(Qa,n),aa.forEach(a),Ga.forEach(a),b=0;b<Za.length;b++)F=Za[b],F.blockedOn===n&&(F.blockedOn=null);for(;0<Za.length&&(b=Za[0],b.blockedOn===null);)pd(b),b.blockedOn===null&&Za.shift()}var Pl=C.ReactCurrentBatchConfig,zc=!0;function Sh(n,a,b,F){var U=Dn,Q=Pl.transition;Pl.transition=null;try{Dn=1,xu(n,a,b,F)}finally{Dn=U,Pl.transition=Q}}function Ch(n,a,b,F){var U=Dn,Q=Pl.transition;Pl.transition=null;try{Dn=4,xu(n,a,b,F)}finally{Dn=U,Pl.transition=Q}}function xu(n,a,b,F){if(zc){var U=_u(n,a,b,F);if(U===null)Vu(n,a,F,Ic,b),zl(n,F);else if(fd(U,n,a,b,F))F.stopPropagation();else if(zl(n,F),a&4&&-1<wh.indexOf(n)){for(;U!==null;){var Q=yc(U);if(Q!==null&&ii(Q),Q=_u(n,a,b,F),Q===null&&Vu(n,a,F,Ic,b),Q===U)break;U=Q}U!==null&&F.stopPropagation()}else Vu(n,a,F,null,b)}}var Ic=null;function _u(n,a,b,F){if(Ic=null,n=Ot(F),n=El(n),n!==null)if(a=ei(n),a===null)n=null;else if(b=a.tag,b===13){if(n=ai(a),n!==null)return n;n=null}else if(b===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null);return Ic=n,null}function gd(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(dl()){case ja:return 1;case kc:return 4;case Ln:case Ra:return 16;case pa:return 536870912;default:return 16}default:return 16}}var Ka=null,gl=null,Pc=null;function yd(){if(Pc)return Pc;var n,a=gl,b=a.length,F,U="value"in Ka?Ka.value:Ka.textContent,Q=U.length;for(n=0;n<b&&a[n]===U[n];n++);var oe=b-n;for(F=1;F<=oe&&a[b-F]===U[Q-F];F++);return Pc=U.slice(n,1<F?1-F:void 0)}function Dc(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function yl(){return!0}function bu(){return!1}function $s(n){function a(b,F,U,Q,oe){this._reactName=b,this._targetInst=U,this.type=F,this.nativeEvent=Q,this.target=oe,this.currentTarget=null;for(var je in n)n.hasOwnProperty(je)&&(b=n[je],this[je]=b?b(Q):Q[je]);return this.isDefaultPrevented=(Q.defaultPrevented!=null?Q.defaultPrevented:Q.returnValue===!1)?yl:bu,this.isPropagationStopped=bu,this}return G(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=yl)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=yl)},persist:function(){},isPersistent:yl}),a}var Dl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wu=$s(Dl),sc=G({},Dl,{view:0,detail:0}),Ah=$s(sc),vl,Eu,Fl,oc=G({},sc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Su,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Fl&&(Fl&&n.type==="mousemove"?(vl=n.screenX-Fl.screenX,Eu=n.screenY-Fl.screenY):Eu=vl=0,Fl=n),vl)},movementY:function(n){return"movementY"in n?n.movementY:Eu}}),vd=$s(oc),Rh=G({},oc,{dataTransfer:0}),kh=$s(Rh),Th=G({},sc,{relatedTarget:0}),Ol=$s(Th),Mh=G({},Dl,{animationName:0,elapsedTime:0,pseudoElement:0}),Nh=$s(Mh),zh=G({},Dl,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ih=$s(zh),ac=G({},Dl,{data:0}),Fc=$s(ac),Ph={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Oh(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=Fh[n])?!!a[n]:!1}function Su(){return Oh}var Lh=G({},sc,{key:function(n){if(n.key){var a=Ph[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=Dc(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Dh[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Su,charCode:function(n){return n.type==="keypress"?Dc(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Dc(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),jh=$s(Lh),Oc=G({},oc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xd=$s(Oc),Bh=G({},sc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Su}),Ll=$s(Bh),_d=G({},Dl,{propertyName:0,elapsedTime:0,pseudoElement:0}),bd=$s(_d),wd=G({},oc,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Cu=$s(wd),Ed=[9,13,27,32],Ru=f&&"CompositionEvent"in window,lc=null;f&&"documentMode"in document&&(lc=document.documentMode);var Gh=f&&"TextEvent"in window&&!lc,Sd=f&&(!Ru||lc&&8<lc&&11>=lc),jl=" ",Cd=!1;function ku(n,a){switch(n){case"keyup":return Ed.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tu(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var xl=!1;function Uh(n,a){switch(n){case"compositionend":return Tu(a);case"keypress":return a.which!==32?null:(Cd=!0,jl);case"textInput":return n=a.data,n===jl&&Cd?null:n;default:return null}}function Lc(n,a){if(xl)return n==="compositionend"||!Ru&&ku(n,a)?(n=yd(),Pc=gl=Ka=null,xl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Sd&&a.locale!=="ko"?null:a.data;default:return null}}var _l={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ad(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!_l[n.type]:a==="textarea"}function Rd(n,a,b,F){ut(F),a=Qc(a,"onChange"),0<a.length&&(b=new wu("onChange","change",null,b,F),n.push({event:b,listeners:a}))}var ra=null,Bl=null;function kd(n){Jc(n,0)}function jc(n){var a=$l(n);if(Gt(a))return n}function Td(n,a){if(n==="change")return a}var uc=!1;if(f){var Bc;if(f){var Gc="oninput"in document;if(!Gc){var Mu=document.createElement("div");Mu.setAttribute("oninput","return;"),Gc=typeof Mu.oninput=="function"}Bc=Gc}else Bc=!1;uc=Bc&&(!document.documentMode||9<document.documentMode)}function Nu(){ra&&(ra.detachEvent("onpropertychange",zu),Bl=ra=null)}function zu(n){if(n.propertyName==="value"&&jc(Bl)){var a=[];Rd(a,Bl,n,Ot(n)),Qr(kd,a)}}function Md(n,a,b){n==="focusin"?(Nu(),ra=a,Bl=b,ra.attachEvent("onpropertychange",zu)):n==="focusout"&&Nu()}function Nd(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return jc(Bl)}function zd(n,a){if(n==="click")return jc(a)}function Id(n,a){if(n==="input"||n==="change")return jc(a)}function Uc(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var Ls=typeof Object.is=="function"?Object.is:Uc;function bl(n,a){if(Ls(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var b=Object.keys(n),F=Object.keys(a);if(b.length!==F.length)return!1;for(F=0;F<b.length;F++){var U=b[F];if(!g.call(a,U)||!Ls(n[U],a[U]))return!1}return!0}function Iu(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Vc(n,a){var b=Iu(n);n=0;for(var F;b;){if(b.nodeType===3){if(F=n+b.textContent.length,n<=a&&F>=a)return{node:b,offset:a-n};n=F}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=Iu(b)}}function Pu(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?Pu(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function Du(){for(var n=window,a=mt();a instanceof n.HTMLIFrameElement;){try{var b=typeof a.contentWindow.location.href=="string"}catch{b=!1}if(b)n=a.contentWindow;else break;a=mt(n.document)}return a}function Wc(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}function Pd(n){var a=Du(),b=n.focusedElem,F=n.selectionRange;if(a!==b&&b&&b.ownerDocument&&Pu(b.ownerDocument.documentElement,b)){if(F!==null&&Wc(b)){if(a=F.start,n=F.end,n===void 0&&(n=a),"selectionStart"in b)b.selectionStart=a,b.selectionEnd=Math.min(n,b.value.length);else if(n=(a=b.ownerDocument||document)&&a.defaultView||window,n.getSelection){n=n.getSelection();var U=b.textContent.length,Q=Math.min(F.start,U);F=F.end===void 0?Q:Math.min(F.end,U),!n.extend&&Q>F&&(U=F,F=Q,Q=U),U=Vc(b,Q);var oe=Vc(b,F);U&&oe&&(n.rangeCount!==1||n.anchorNode!==U.node||n.anchorOffset!==U.offset||n.focusNode!==oe.node||n.focusOffset!==oe.offset)&&(a=a.createRange(),a.setStart(U.node,U.offset),n.removeAllRanges(),Q>F?(n.addRange(a),n.extend(oe.node,oe.offset)):(a.setEnd(oe.node,oe.offset),n.addRange(a)))}}for(a=[],n=b;n=n.parentNode;)n.nodeType===1&&a.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<a.length;b++)n=a[b],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var $c=f&&"documentMode"in document&&11>=document.documentMode,Ua=null,Hc=null,Gl=null,Yc=!1;function Fu(n,a,b){var F=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;Yc||Ua==null||Ua!==mt(F)||(F=Ua,"selectionStart"in F&&Wc(F)?F={start:F.selectionStart,end:F.selectionEnd}:(F=(F.ownerDocument&&F.ownerDocument.defaultView||window).getSelection(),F={anchorNode:F.anchorNode,anchorOffset:F.anchorOffset,focusNode:F.focusNode,focusOffset:F.focusOffset}),Gl&&bl(Gl,F)||(Gl=F,F=Qc(Hc,"onSelect"),0<F.length&&(a=new wu("onSelect","select",null,a,b),n.push({event:a,listeners:F}),a.target=Ua)))}function dc(n,a){var b={};return b[n.toLowerCase()]=a.toLowerCase(),b["Webkit"+n]="webkit"+a,b["Moz"+n]="moz"+a,b}var el={animationend:dc("Animation","AnimationEnd"),animationiteration:dc("Animation","AnimationIteration"),animationstart:dc("Animation","AnimationStart"),transitionend:dc("Transition","TransitionEnd")},qc={},Ou={};f&&(Ou=document.createElement("div").style,"AnimationEvent"in window||(delete el.animationend.animation,delete el.animationiteration.animation,delete el.animationstart.animation),"TransitionEvent"in window||delete el.transitionend.transition);function ui(n){if(qc[n])return qc[n];if(!el[n])return n;var a=el[n],b;for(b in a)if(a.hasOwnProperty(b)&&b in Ou)return qc[n]=a[b];return n}var Lu=ui("animationend"),ju=ui("animationiteration"),Dd=ui("animationstart"),Fd=ui("transitionend"),Od=new Map,Bu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function tl(n,a){Od.set(n,a),u(a,[n])}for(var Va=0;Va<Bu.length;Va++){var Xc=Bu[Va],Ld=Xc.toLowerCase(),jd=Xc[0].toUpperCase()+Xc.slice(1);tl(Ld,"on"+jd)}tl(Lu,"onAnimationEnd"),tl(ju,"onAnimationIteration"),tl(Dd,"onAnimationStart"),tl("dblclick","onDoubleClick"),tl("focusin","onFocus"),tl("focusout","onBlur"),tl(Fd,"onTransitionEnd"),v("onMouseEnter",["mouseout","mouseover"]),v("onMouseLeave",["mouseout","mouseover"]),v("onPointerEnter",["pointerout","pointerover"]),v("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ul="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vh=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ul));function Gu(n,a,b){var F=n.type||"unknown-event";n.currentTarget=b,Aa(F,a,void 0,n),n.currentTarget=null}function Jc(n,a){a=(a&4)!==0;for(var b=0;b<n.length;b++){var F=n[b],U=F.event;F=F.listeners;e:{var Q=void 0;if(a)for(var oe=F.length-1;0<=oe;oe--){var je=F[oe],st=je.instance,Vt=je.currentTarget;if(je=je.listener,st!==Q&&U.isPropagationStopped())break e;Gu(U,je,Vt),Q=st}else for(oe=0;oe<F.length;oe++){if(je=F[oe],st=je.instance,Vt=je.currentTarget,je=je.listener,st!==Q&&U.isPropagationStopped())break e;Gu(U,je,Vt),Q=st}}}if(On)throw n=mi,On=!1,mi=null,n}function di(n,a){var b=a[gc];b===void 0&&(b=a[gc]=new Set);var F=n+"__bubble";b.has(F)||(Bd(a,n,2,!1),b.add(F))}function Uu(n,a,b){var F=0;a&&(F|=4),Bd(b,n,F,a)}var hc="_reactListening"+Math.random().toString(36).slice(2);function fc(n){if(!n[hc]){n[hc]=!0,o.forEach(function(b){b!=="selectionchange"&&(Vh.has(b)||Uu(b,!1,n),Uu(b,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[hc]||(a[hc]=!0,Uu("selectionchange",!1,a))}}function Bd(n,a,b,F){switch(gd(a)){case 1:var U=Sh;break;case 4:U=Ch;break;default:U=xu}b=U.bind(null,a,b,n),U=void 0,!Zr||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(U=!0),F?U!==void 0?n.addEventListener(a,b,{capture:!0,passive:U}):n.addEventListener(a,b,!0):U!==void 0?n.addEventListener(a,b,{passive:U}):n.addEventListener(a,b,!1)}function Vu(n,a,b,F,U){var Q=F;if((a&1)===0&&(a&2)===0&&F!==null)e:for(;;){if(F===null)return;var oe=F.tag;if(oe===3||oe===4){var je=F.stateNode.containerInfo;if(je===U||je.nodeType===8&&je.parentNode===U)break;if(oe===4)for(oe=F.return;oe!==null;){var st=oe.tag;if((st===3||st===4)&&(st=oe.stateNode.containerInfo,st===U||st.nodeType===8&&st.parentNode===U))return;oe=oe.return}for(;je!==null;){if(oe=El(je),oe===null)return;if(st=oe.tag,st===5||st===6){F=Q=oe;continue e}je=je.parentNode}}F=F.return}Qr(function(){var Vt=Q,Ur=Ot(b),$r=[];e:{var Gr=Od.get(n);if(Gr!==void 0){var sn=wu,an=n;switch(n){case"keypress":if(Dc(b)===0)break e;case"keydown":case"keyup":sn=jh;break;case"focusin":an="focus",sn=Ol;break;case"focusout":an="blur",sn=Ol;break;case"beforeblur":case"afterblur":sn=Ol;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":sn=vd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":sn=kh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":sn=Ll;break;case Lu:case ju:case Dd:sn=Nh;break;case Fd:sn=bd;break;case"scroll":sn=Ah;break;case"wheel":sn=Cu;break;case"copy":case"cut":case"paste":sn=Ih;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":sn=xd}var bn=(a&4)!==0,Gs=!bn&&n==="scroll",Et=bn?Gr!==null?Gr+"Capture":null:Gr;bn=[];for(var ot=Vt,Tt;ot!==null;){Tt=ot;var qr=Tt.stateNode;if(Tt.tag===5&&qr!==null&&(Tt=qr,Et!==null&&(qr=Xr(ot,Et),qr!=null&&bn.push(pc(ot,qr,Tt)))),Gs)break;ot=ot.return}0<bn.length&&(Gr=new sn(Gr,an,null,b,Ur),$r.push({event:Gr,listeners:bn}))}}if((a&7)===0){e:{if(Gr=n==="mouseover"||n==="pointerover",sn=n==="mouseout"||n==="pointerout",Gr&&b!==et&&(an=b.relatedTarget||b.fromElement)&&(El(an)||an[ya]))break e;if((sn||Gr)&&(Gr=Ur.window===Ur?Ur:(Gr=Ur.ownerDocument)?Gr.defaultView||Gr.parentWindow:window,sn?(an=b.relatedTarget||b.toElement,sn=Vt,an=an?El(an):null,an!==null&&(Gs=ei(an),an!==Gs||an.tag!==5&&an.tag!==6)&&(an=null)):(sn=null,an=Vt),sn!==an)){if(bn=vd,qr="onMouseLeave",Et="onMouseEnter",ot="mouse",(n==="pointerout"||n==="pointerover")&&(bn=xd,qr="onPointerLeave",Et="onPointerEnter",ot="pointer"),Gs=sn==null?Gr:$l(sn),Tt=an==null?Gr:$l(an),Gr=new bn(qr,ot+"leave",sn,b,Ur),Gr.target=Gs,Gr.relatedTarget=Tt,qr=null,El(Ur)===Vt&&(bn=new bn(Et,ot+"enter",an,b,Ur),bn.target=Tt,bn.relatedTarget=Gs,qr=bn),Gs=qr,sn&&an)t:{for(bn=sn,Et=an,ot=0,Tt=bn;Tt;Tt=Vl(Tt))ot++;for(Tt=0,qr=Et;qr;qr=Vl(qr))Tt++;for(;0<ot-Tt;)bn=Vl(bn),ot--;for(;0<Tt-ot;)Et=Vl(Et),Tt--;for(;ot--;){if(bn===Et||Et!==null&&bn===Et.alternate)break t;bn=Vl(bn),Et=Vl(Et)}bn=null}else bn=null;sn!==null&&Gd($r,Gr,sn,bn,!1),an!==null&&Gs!==null&&Gd($r,Gs,an,bn,!0)}}e:{if(Gr=Vt?$l(Vt):window,sn=Gr.nodeName&&Gr.nodeName.toLowerCase(),sn==="select"||sn==="input"&&Gr.type==="file")var wn=Td;else if(Ad(Gr))if(uc)wn=Id;else{wn=Nd;var kn=Md}else(sn=Gr.nodeName)&&sn.toLowerCase()==="input"&&(Gr.type==="checkbox"||Gr.type==="radio")&&(wn=zd);if(wn&&(wn=wn(n,Vt))){Rd($r,wn,b,Ur);break e}kn&&kn(n,Gr,Vt),n==="focusout"&&(kn=Gr._wrapperState)&&kn.controlled&&Gr.type==="number"&&Br(Gr,"number",Gr.value)}switch(kn=Vt?$l(Vt):window,n){case"focusin":(Ad(kn)||kn.contentEditable==="true")&&(Ua=kn,Hc=Vt,Gl=null);break;case"focusout":Gl=Hc=Ua=null;break;case"mousedown":Yc=!0;break;case"contextmenu":case"mouseup":case"dragend":Yc=!1,Fu($r,b,Ur);break;case"selectionchange":if($c)break;case"keydown":case"keyup":Fu($r,b,Ur)}var Tn;if(Ru)e:{switch(n){case"compositionstart":var In="onCompositionStart";break e;case"compositionend":In="onCompositionEnd";break e;case"compositionupdate":In="onCompositionUpdate";break e}In=void 0}else xl?ku(n,b)&&(In="onCompositionEnd"):n==="keydown"&&b.keyCode===229&&(In="onCompositionStart");In&&(Sd&&b.locale!=="ko"&&(xl||In!=="onCompositionStart"?In==="onCompositionEnd"&&xl&&(Tn=yd()):(Ka=Ur,gl="value"in Ka?Ka.value:Ka.textContent,xl=!0)),kn=Qc(Vt,In),0<kn.length&&(In=new Fc(In,n,null,b,Ur),$r.push({event:In,listeners:kn}),Tn?In.data=Tn:(Tn=Tu(b),Tn!==null&&(In.data=Tn)))),(Tn=Gh?Uh(n,b):Lc(n,b))&&(Vt=Qc(Vt,"onBeforeInput"),0<Vt.length&&(Ur=new Fc("onBeforeInput","beforeinput",null,b,Ur),$r.push({event:Ur,listeners:Vt}),Ur.data=Tn))}Jc($r,a)})}function pc(n,a,b){return{instance:n,listener:a,currentTarget:b}}function Qc(n,a){for(var b=a+"Capture",F=[];n!==null;){var U=n,Q=U.stateNode;U.tag===5&&Q!==null&&(U=Q,Q=Xr(n,b),Q!=null&&F.unshift(pc(n,Q,U)),Q=Xr(n,a),Q!=null&&F.push(pc(n,Q,U))),n=n.return}return F}function Vl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Gd(n,a,b,F,U){for(var Q=a._reactName,oe=[];b!==null&&b!==F;){var je=b,st=je.alternate,Vt=je.stateNode;if(st!==null&&st===F)break;je.tag===5&&Vt!==null&&(je=Vt,U?(st=Xr(b,Q),st!=null&&oe.unshift(pc(b,st,je))):U||(st=Xr(b,Q),st!=null&&oe.push(pc(b,st,je)))),b=b.return}oe.length!==0&&n.push({event:a,listeners:oe})}var Wh=/\r\n?/g,$h=/\u0000|\uFFFD/g;function Ud(n){return(typeof n=="string"?n:""+n).replace(Wh,`
`).replace($h,"")}function Zc(n,a,b){if(a=Ud(a),Ud(n)!==a&&b)throw Error(t(425))}function Kc(){}var Wu=null,$u=null;function ka(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Hu=typeof setTimeout=="function"?setTimeout:void 0,Hh=typeof clearTimeout=="function"?clearTimeout:void 0,Yu=typeof Promise=="function"?Promise:void 0,Yh=typeof queueMicrotask=="function"?queueMicrotask:typeof Yu<"u"?function(n){return Yu.resolve(null).then(n).catch(qh)}:Hu;function qh(n){setTimeout(function(){throw n})}function wl(n,a){var b=a,F=0;do{var U=b.nextSibling;if(n.removeChild(b),U&&U.nodeType===8)if(b=U.data,b==="/$"){if(F===0){n.removeChild(U),ic(a);return}F--}else b!=="$"&&b!=="$?"&&b!=="$!"||F++;b=U}while(b);ic(a)}function Ia(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return n}function eu(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var b=n.data;if(b==="$"||b==="$!"||b==="$?"){if(a===0)return n;a--}else b==="/$"&&a++}n=n.previousSibling}return null}var Wl=Math.random().toString(36).slice(2),Ta="__reactFiber$"+Wl,mc="__reactProps$"+Wl,ya="__reactContainer$"+Wl,gc="__reactEvents$"+Wl,Xh="__reactListeners$"+Wl,Jh="__reactHandles$"+Wl;function El(n){var a=n[Ta];if(a)return a;for(var b=n.parentNode;b;){if(a=b[ya]||b[Ta]){if(b=a.alternate,a.child!==null||b!==null&&b.child!==null)for(n=eu(n);n!==null;){if(b=n[Ta])return b;n=eu(n)}return a}n=b,b=n.parentNode}return null}function yc(n){return n=n[Ta]||n[ya],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function $l(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(t(33))}function tu(n){return n[mc]||null}var qu=[],Hl=-1;function rl(n){return{current:n}}function gi(n){0>Hl||(n.current=qu[Hl],qu[Hl]=null,Hl--)}function fi(n,a){Hl++,qu[Hl]=n.current,n.current=a}var nl={},Js=rl(nl),la=rl(!1),il=nl;function Sl(n,a){var b=n.type.contextTypes;if(!b)return nl;var F=n.stateNode;if(F&&F.__reactInternalMemoizedUnmaskedChildContext===a)return F.__reactInternalMemoizedMaskedChildContext;var U={},Q;for(Q in b)U[Q]=a[Q];return F&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=a,n.__reactInternalMemoizedMaskedChildContext=U),U}function na(n){return n=n.childContextTypes,n!=null}function vc(){gi(la),gi(Js)}function Xu(n,a,b){if(Js.current!==nl)throw Error(t(168));fi(Js,a),fi(la,b)}function Ju(n,a,b){var F=n.stateNode;if(a=a.childContextTypes,typeof F.getChildContext!="function")return b;F=F.getChildContext();for(var U in F)if(!(U in a))throw Error(t(108,De(n)||"Unknown",U));return G({},b,F)}function xc(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||nl,il=Js.current,fi(Js,n),fi(la,la.current),!0}function Qu(n,a,b){var F=n.stateNode;if(!F)throw Error(t(169));b?(n=Ju(n,a,il),F.__reactInternalMemoizedMergedChildContext=n,gi(la),gi(Js),fi(Js,n)):gi(la),fi(la,b)}var Pa=null,ru=!1,I=!1;function K(n){Pa===null?Pa=[n]:Pa.push(n)}function O(n){ru=!0,K(n)}function be(){if(!I&&Pa!==null){I=!0;var n=0,a=Dn;try{var b=Pa;for(Dn=1;n<b.length;n++){var F=b[n];do F=F(!0);while(F!==null)}Pa=null,ru=!1}catch(U){throw Pa!==null&&(Pa=Pa.slice(n+1)),ll(ja,be),U}finally{Dn=a,I=!1}}return null}var Ee=[],Le=0,St=null,ct=0,Kr=[],nt=0,_t=null,jn=1,Hr="";function Lr(n,a){Ee[Le++]=ct,Ee[Le++]=St,St=n,ct=a}function pi(n,a,b){Kr[nt++]=jn,Kr[nt++]=Hr,Kr[nt++]=_t,_t=n;var F=jn;n=Hr;var U=32-ma(F)-1;F&=~(1<<U),b+=1;var Q=32-ma(a)+U;if(30<Q){var oe=U-U%5;Q=(F&(1<<oe)-1).toString(32),F>>=oe,U-=oe,jn=1<<32-ma(a)+U|b<<U|F,Hr=Q+n}else jn=1<<Q|b<<U|F,Hr=n}function vi(n){n.return!==null&&(Lr(n,1),pi(n,1,0))}function ti(n){for(;n===St;)St=Ee[--Le],Ee[Le]=null,ct=Ee[--Le],Ee[Le]=null;for(;n===_t;)_t=Kr[--nt],Kr[nt]=null,Hr=Kr[--nt],Kr[nt]=null,jn=Kr[--nt],Kr[nt]=null}var Cn=null,En=null,Wr=!1,An=null;function ks(n,a){var b=La(5,null,null,0);b.elementType="DELETED",b.stateNode=a,b.return=n,a=n.deletions,a===null?(n.deletions=[b],n.flags|=16):a.push(b)}function ni(n,a){switch(n.tag){case 5:var b=n.type;return a=a.nodeType!==1||b.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(n.stateNode=a,Cn=n,En=Ia(a.firstChild),!0):!1;case 6:return a=n.pendingProps===""||a.nodeType!==3?null:a,a!==null?(n.stateNode=a,Cn=n,En=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(b=_t!==null?{id:jn,overflow:Hr}:null,n.memoizedState={dehydrated:a,treeContext:b,retryLane:1073741824},b=La(18,null,null,0),b.stateNode=a,b.return=n,n.child=b,Cn=n,En=null,!0):!1;default:return!1}}function Bn(n){return(n.mode&1)!==0&&(n.flags&128)===0}function li(n){if(Wr){var a=En;if(a){var b=a;if(!ni(n,a)){if(Bn(n))throw Error(t(418));a=Ia(b.nextSibling);var F=Cn;a&&ni(n,a)?ks(F,b):(n.flags=n.flags&-4097|2,Wr=!1,Cn=n)}}else{if(Bn(n))throw Error(t(418));n.flags=n.flags&-4097|2,Wr=!1,Cn=n}}}function Rn(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Cn=n}function Fn(n){if(n!==Cn)return!1;if(!Wr)return Rn(n),Wr=!0,!1;var a;if((a=n.tag!==3)&&!(a=n.tag!==5)&&(a=n.type,a=a!=="head"&&a!=="body"&&!ka(n.type,n.memoizedProps)),a&&(a=En)){if(Bn(n))throw Qs(),Error(t(418));for(;a;)ks(n,a),a=Ia(a.nextSibling)}if(Rn(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(t(317));e:{for(n=n.nextSibling,a=0;n;){if(n.nodeType===8){var b=n.data;if(b==="/$"){if(a===0){En=Ia(n.nextSibling);break e}a--}else b!=="$"&&b!=="$!"&&b!=="$?"||a++}n=n.nextSibling}En=null}}else En=Cn?Ia(n.stateNode.nextSibling):null;return!0}function Qs(){for(var n=En;n;)n=Ia(n.nextSibling)}function ba(){En=Cn=null,Wr=!1}function nu(n){An===null?An=[n]:An.push(n)}var iu=C.ReactCurrentBatchConfig;function ca(n,a){if(n&&n.defaultProps){a=G({},a),n=n.defaultProps;for(var b in n)a[b]===void 0&&(a[b]=n[b]);return a}return a}var Vd=rl(null),Wd=null,su=null,Qh=null;function Zh(){Qh=su=Wd=null}function Kh(n){var a=Vd.current;gi(Vd),n._currentValue=a}function ef(n,a,b){for(;n!==null;){var F=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,F!==null&&(F.childLanes|=a)):F!==null&&(F.childLanes&a)!==a&&(F.childLanes|=a),n===b)break;n=n.return}}function ou(n,a){Wd=n,Qh=su=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&a)!==0&&(wa=!0),n.firstContext=null)}function Da(n){var a=n._currentValue;if(Qh!==n)if(n={context:n,memoizedValue:a,next:null},su===null){if(Wd===null)throw Error(t(308));su=n,Wd.dependencies={lanes:0,firstContext:n}}else su=su.next=n;return a}var _c=null;function tf(n){_c===null?_c=[n]:_c.push(n)}function qf(n,a,b,F){var U=a.interleaved;return U===null?(b.next=b,tf(a)):(b.next=U.next,U.next=b),a.interleaved=b,Cl(n,F)}function Cl(n,a){n.lanes|=a;var b=n.alternate;for(b!==null&&(b.lanes|=a),b=n,n=n.return;n!==null;)n.childLanes|=a,b=n.alternate,b!==null&&(b.childLanes|=a),b=n,n=n.return;return b.tag===3?b.stateNode:null}var Yl=!1;function rf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Xf(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Al(n,a){return{eventTime:n,lane:a,tag:0,payload:null,callback:null,next:null}}function ql(n,a,b){var F=n.updateQueue;if(F===null)return null;if(F=F.shared,(si&2)!==0){var U=F.pending;return U===null?a.next=a:(a.next=U.next,U.next=a),F.pending=a,Cl(n,b)}return U=F.interleaved,U===null?(a.next=a,tf(F)):(a.next=U.next,U.next=a),F.interleaved=a,Cl(n,b)}function $d(n,a,b){if(a=a.updateQueue,a!==null&&(a=a.shared,(b&4194240)!==0)){var F=a.lanes;F&=n.pendingLanes,b|=F,a.lanes=b,za(n,b)}}function Jf(n,a){var b=n.updateQueue,F=n.alternate;if(F!==null&&(F=F.updateQueue,b===F)){var U=null,Q=null;if(b=b.firstBaseUpdate,b!==null){do{var oe={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};Q===null?U=Q=oe:Q=Q.next=oe,b=b.next}while(b!==null);Q===null?U=Q=a:Q=Q.next=a}else U=Q=a;b={baseState:F.baseState,firstBaseUpdate:U,lastBaseUpdate:Q,shared:F.shared,effects:F.effects},n.updateQueue=b;return}n=b.lastBaseUpdate,n===null?b.firstBaseUpdate=a:n.next=a,b.lastBaseUpdate=a}function Hd(n,a,b,F){var U=n.updateQueue;Yl=!1;var Q=U.firstBaseUpdate,oe=U.lastBaseUpdate,je=U.shared.pending;if(je!==null){U.shared.pending=null;var st=je,Vt=st.next;st.next=null,oe===null?Q=Vt:oe.next=Vt,oe=st;var Ur=n.alternate;Ur!==null&&(Ur=Ur.updateQueue,je=Ur.lastBaseUpdate,je!==oe&&(je===null?Ur.firstBaseUpdate=Vt:je.next=Vt,Ur.lastBaseUpdate=st))}if(Q!==null){var $r=U.baseState;oe=0,Ur=Vt=st=null,je=Q;do{var Gr=je.lane,sn=je.eventTime;if((F&Gr)===Gr){Ur!==null&&(Ur=Ur.next={eventTime:sn,lane:0,tag:je.tag,payload:je.payload,callback:je.callback,next:null});e:{var an=n,bn=je;switch(Gr=a,sn=b,bn.tag){case 1:if(an=bn.payload,typeof an=="function"){$r=an.call(sn,$r,Gr);break e}$r=an;break e;case 3:an.flags=an.flags&-65537|128;case 0:if(an=bn.payload,Gr=typeof an=="function"?an.call(sn,$r,Gr):an,Gr==null)break e;$r=G({},$r,Gr);break e;case 2:Yl=!0}}je.callback!==null&&je.lane!==0&&(n.flags|=64,Gr=U.effects,Gr===null?U.effects=[je]:Gr.push(je))}else sn={eventTime:sn,lane:Gr,tag:je.tag,payload:je.payload,callback:je.callback,next:null},Ur===null?(Vt=Ur=sn,st=$r):Ur=Ur.next=sn,oe|=Gr;if(je=je.next,je===null){if(je=U.shared.pending,je===null)break;Gr=je,je=Gr.next,Gr.next=null,U.lastBaseUpdate=Gr,U.shared.pending=null}}while(!0);if(Ur===null&&(st=$r),U.baseState=st,U.firstBaseUpdate=Vt,U.lastBaseUpdate=Ur,a=U.shared.interleaved,a!==null){U=a;do oe|=U.lane,U=U.next;while(U!==a)}else Q===null&&(U.shared.lanes=0);Ec|=oe,n.lanes=oe,n.memoizedState=$r}}function Qf(n,a,b){if(n=a.effects,a.effects=null,n!==null)for(a=0;a<n.length;a++){var F=n[a],U=F.callback;if(U!==null){if(F.callback=null,F=b,typeof U!="function")throw Error(t(191,U));U.call(F)}}}var Zf=new e.Component().refs;function nf(n,a,b,F){a=n.memoizedState,b=b(F,a),b=b==null?a:G({},a,b),n.memoizedState=b,n.lanes===0&&(n.updateQueue.baseState=b)}var Yd={isMounted:function(n){return(n=n._reactInternals)?ei(n)===n:!1},enqueueSetState:function(n,a,b){n=n._reactInternals;var F=xa(),U=Zl(n),Q=Al(F,U);Q.payload=a,b!=null&&(Q.callback=b),a=ql(n,Q,U),a!==null&&(Ha(a,n,U,F),$d(a,n,U))},enqueueReplaceState:function(n,a,b){n=n._reactInternals;var F=xa(),U=Zl(n),Q=Al(F,U);Q.tag=1,Q.payload=a,b!=null&&(Q.callback=b),a=ql(n,Q,U),a!==null&&(Ha(a,n,U,F),$d(a,n,U))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var b=xa(),F=Zl(n),U=Al(b,F);U.tag=2,a!=null&&(U.callback=a),a=ql(n,U,F),a!==null&&(Ha(a,n,F,b),$d(a,n,F))}};function Kf(n,a,b,F,U,Q,oe){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(F,Q,oe):a.prototype&&a.prototype.isPureReactComponent?!bl(b,F)||!bl(U,Q):!0}function ep(n,a,b){var F=!1,U=nl,Q=a.contextType;return typeof Q=="object"&&Q!==null?Q=Da(Q):(U=na(a)?il:Js.current,F=a.contextTypes,Q=(F=F!=null)?Sl(n,U):nl),a=new a(b,Q),n.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Yd,n.stateNode=a,a._reactInternals=n,F&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=U,n.__reactInternalMemoizedMaskedChildContext=Q),a}function tp(n,a,b,F){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(b,F),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(b,F),a.state!==n&&Yd.enqueueReplaceState(a,a.state,null)}function sf(n,a,b,F){var U=n.stateNode;U.props=b,U.state=n.memoizedState,U.refs=Zf,rf(n);var Q=a.contextType;typeof Q=="object"&&Q!==null?U.context=Da(Q):(Q=na(a)?il:Js.current,U.context=Sl(n,Q)),U.state=n.memoizedState,Q=a.getDerivedStateFromProps,typeof Q=="function"&&(nf(n,a,Q,b),U.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof U.getSnapshotBeforeUpdate=="function"||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(a=U.state,typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount(),a!==U.state&&Yd.enqueueReplaceState(U,U.state,null),Hd(n,b,U,F),U.state=n.memoizedState),typeof U.componentDidMount=="function"&&(n.flags|=4194308)}function Zu(n,a,b){if(n=b.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(t(309));var F=b.stateNode}if(!F)throw Error(t(147,n));var U=F,Q=""+n;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===Q?a.ref:(a=function(oe){var je=U.refs;je===Zf&&(je=U.refs={}),oe===null?delete je[Q]:je[Q]=oe},a._stringRef=Q,a)}if(typeof n!="string")throw Error(t(284));if(!b._owner)throw Error(t(290,n))}return n}function qd(n,a){throw n=Object.prototype.toString.call(a),Error(t(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n))}function rp(n){var a=n._init;return a(n._payload)}function np(n){function a(Et,ot){if(n){var Tt=Et.deletions;Tt===null?(Et.deletions=[ot],Et.flags|=16):Tt.push(ot)}}function b(Et,ot){if(!n)return null;for(;ot!==null;)a(Et,ot),ot=ot.sibling;return null}function F(Et,ot){for(Et=new Map;ot!==null;)ot.key!==null?Et.set(ot.key,ot):Et.set(ot.index,ot),ot=ot.sibling;return Et}function U(Et,ot){return Et=ec(Et,ot),Et.index=0,Et.sibling=null,Et}function Q(Et,ot,Tt){return Et.index=Tt,n?(Tt=Et.alternate,Tt!==null?(Tt=Tt.index,Tt<ot?(Et.flags|=2,ot):Tt):(Et.flags|=2,ot)):(Et.flags|=1048576,ot)}function oe(Et){return n&&Et.alternate===null&&(Et.flags|=2),Et}function je(Et,ot,Tt,qr){return ot===null||ot.tag!==6?(ot=Uf(Tt,Et.mode,qr),ot.return=Et,ot):(ot=U(ot,Tt),ot.return=Et,ot)}function st(Et,ot,Tt,qr){var wn=Tt.type;return wn===R?Ur(Et,ot,Tt.props.children,qr,Tt.key):ot!==null&&(ot.elementType===wn||typeof wn=="object"&&wn!==null&&wn.$$typeof===$&&rp(wn)===ot.type)?(qr=U(ot,Tt.props),qr.ref=Zu(Et,ot,Tt),qr.return=Et,qr):(qr=fh(Tt.type,Tt.key,Tt.props,null,Et.mode,qr),qr.ref=Zu(Et,ot,Tt),qr.return=Et,qr)}function Vt(Et,ot,Tt,qr){return ot===null||ot.tag!==4||ot.stateNode.containerInfo!==Tt.containerInfo||ot.stateNode.implementation!==Tt.implementation?(ot=Vf(Tt,Et.mode,qr),ot.return=Et,ot):(ot=U(ot,Tt.children||[]),ot.return=Et,ot)}function Ur(Et,ot,Tt,qr,wn){return ot===null||ot.tag!==7?(ot=Rc(Tt,Et.mode,qr,wn),ot.return=Et,ot):(ot=U(ot,Tt),ot.return=Et,ot)}function $r(Et,ot,Tt){if(typeof ot=="string"&&ot!==""||typeof ot=="number")return ot=Uf(""+ot,Et.mode,Tt),ot.return=Et,ot;if(typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case h:return Tt=fh(ot.type,ot.key,ot.props,null,Et.mode,Tt),Tt.ref=Zu(Et,null,ot),Tt.return=Et,Tt;case x:return ot=Vf(ot,Et.mode,Tt),ot.return=Et,ot;case $:var qr=ot._init;return $r(Et,qr(ot._payload),Tt)}if(zr(ot)||Y(ot))return ot=Rc(ot,Et.mode,Tt,null),ot.return=Et,ot;qd(Et,ot)}return null}function Gr(Et,ot,Tt,qr){var wn=ot!==null?ot.key:null;if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number")return wn!==null?null:je(Et,ot,""+Tt,qr);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case h:return Tt.key===wn?st(Et,ot,Tt,qr):null;case x:return Tt.key===wn?Vt(Et,ot,Tt,qr):null;case $:return wn=Tt._init,Gr(Et,ot,wn(Tt._payload),qr)}if(zr(Tt)||Y(Tt))return wn!==null?null:Ur(Et,ot,Tt,qr,null);qd(Et,Tt)}return null}function sn(Et,ot,Tt,qr,wn){if(typeof qr=="string"&&qr!==""||typeof qr=="number")return Et=Et.get(Tt)||null,je(ot,Et,""+qr,wn);if(typeof qr=="object"&&qr!==null){switch(qr.$$typeof){case h:return Et=Et.get(qr.key===null?Tt:qr.key)||null,st(ot,Et,qr,wn);case x:return Et=Et.get(qr.key===null?Tt:qr.key)||null,Vt(ot,Et,qr,wn);case $:var kn=qr._init;return sn(Et,ot,Tt,kn(qr._payload),wn)}if(zr(qr)||Y(qr))return Et=Et.get(Tt)||null,Ur(ot,Et,qr,wn,null);qd(ot,qr)}return null}function an(Et,ot,Tt,qr){for(var wn=null,kn=null,Tn=ot,In=ot=0,ta=null;Tn!==null&&In<Tt.length;In++){Tn.index>In?(ta=Tn,Tn=null):ta=Tn.sibling;var oi=Gr(Et,Tn,Tt[In],qr);if(oi===null){Tn===null&&(Tn=ta);break}n&&Tn&&oi.alternate===null&&a(Et,Tn),ot=Q(oi,ot,In),kn===null?wn=oi:kn.sibling=oi,kn=oi,Tn=ta}if(In===Tt.length)return b(Et,Tn),Wr&&Lr(Et,In),wn;if(Tn===null){for(;In<Tt.length;In++)Tn=$r(Et,Tt[In],qr),Tn!==null&&(ot=Q(Tn,ot,In),kn===null?wn=Tn:kn.sibling=Tn,kn=Tn);return Wr&&Lr(Et,In),wn}for(Tn=F(Et,Tn);In<Tt.length;In++)ta=sn(Tn,Et,In,Tt[In],qr),ta!==null&&(n&&ta.alternate!==null&&Tn.delete(ta.key===null?In:ta.key),ot=Q(ta,ot,In),kn===null?wn=ta:kn.sibling=ta,kn=ta);return n&&Tn.forEach(function(tc){return a(Et,tc)}),Wr&&Lr(Et,In),wn}function bn(Et,ot,Tt,qr){var wn=Y(Tt);if(typeof wn!="function")throw Error(t(150));if(Tt=wn.call(Tt),Tt==null)throw Error(t(151));for(var kn=wn=null,Tn=ot,In=ot=0,ta=null,oi=Tt.next();Tn!==null&&!oi.done;In++,oi=Tt.next()){Tn.index>In?(ta=Tn,Tn=null):ta=Tn.sibling;var tc=Gr(Et,Tn,oi.value,qr);if(tc===null){Tn===null&&(Tn=ta);break}n&&Tn&&tc.alternate===null&&a(Et,Tn),ot=Q(tc,ot,In),kn===null?wn=tc:kn.sibling=tc,kn=tc,Tn=ta}if(oi.done)return b(Et,Tn),Wr&&Lr(Et,In),wn;if(Tn===null){for(;!oi.done;In++,oi=Tt.next())oi=$r(Et,oi.value,qr),oi!==null&&(ot=Q(oi,ot,In),kn===null?wn=oi:kn.sibling=oi,kn=oi);return Wr&&Lr(Et,In),wn}for(Tn=F(Et,Tn);!oi.done;In++,oi=Tt.next())oi=sn(Tn,Et,In,oi.value,qr),oi!==null&&(n&&oi.alternate!==null&&Tn.delete(oi.key===null?In:oi.key),ot=Q(oi,ot,In),kn===null?wn=oi:kn.sibling=oi,kn=oi);return n&&Tn.forEach(function(Jm){return a(Et,Jm)}),Wr&&Lr(Et,In),wn}function Gs(Et,ot,Tt,qr){if(typeof Tt=="object"&&Tt!==null&&Tt.type===R&&Tt.key===null&&(Tt=Tt.props.children),typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case h:e:{for(var wn=Tt.key,kn=ot;kn!==null;){if(kn.key===wn){if(wn=Tt.type,wn===R){if(kn.tag===7){b(Et,kn.sibling),ot=U(kn,Tt.props.children),ot.return=Et,Et=ot;break e}}else if(kn.elementType===wn||typeof wn=="object"&&wn!==null&&wn.$$typeof===$&&rp(wn)===kn.type){b(Et,kn.sibling),ot=U(kn,Tt.props),ot.ref=Zu(Et,kn,Tt),ot.return=Et,Et=ot;break e}b(Et,kn);break}else a(Et,kn);kn=kn.sibling}Tt.type===R?(ot=Rc(Tt.props.children,Et.mode,qr,Tt.key),ot.return=Et,Et=ot):(qr=fh(Tt.type,Tt.key,Tt.props,null,Et.mode,qr),qr.ref=Zu(Et,ot,Tt),qr.return=Et,Et=qr)}return oe(Et);case x:e:{for(kn=Tt.key;ot!==null;){if(ot.key===kn)if(ot.tag===4&&ot.stateNode.containerInfo===Tt.containerInfo&&ot.stateNode.implementation===Tt.implementation){b(Et,ot.sibling),ot=U(ot,Tt.children||[]),ot.return=Et,Et=ot;break e}else{b(Et,ot);break}else a(Et,ot);ot=ot.sibling}ot=Vf(Tt,Et.mode,qr),ot.return=Et,Et=ot}return oe(Et);case $:return kn=Tt._init,Gs(Et,ot,kn(Tt._payload),qr)}if(zr(Tt))return an(Et,ot,Tt,qr);if(Y(Tt))return bn(Et,ot,Tt,qr);qd(Et,Tt)}return typeof Tt=="string"&&Tt!==""||typeof Tt=="number"?(Tt=""+Tt,ot!==null&&ot.tag===6?(b(Et,ot.sibling),ot=U(ot,Tt),ot.return=Et,Et=ot):(b(Et,ot),ot=Uf(Tt,Et.mode,qr),ot.return=Et,Et=ot),oe(Et)):b(Et,ot)}return Gs}var au=np(!0),ip=np(!1),Ku={},sl=rl(Ku),ed=rl(Ku),td=rl(Ku);function bc(n){if(n===Ku)throw Error(t(174));return n}function of(n,a){switch(fi(td,a),fi(ed,n),fi(sl,Ku),n=a.nodeType,n){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:ie(null,"");break;default:n=n===8?a.parentNode:a,a=n.namespaceURI||null,n=n.tagName,a=ie(a,n)}gi(sl),fi(sl,a)}function lu(){gi(sl),gi(ed),gi(td)}function sp(n){bc(td.current);var a=bc(sl.current),b=ie(a,n.type);a!==b&&(fi(ed,n),fi(sl,b))}function af(n){ed.current===n&&(gi(sl),gi(ed))}var ls=rl(0);function Xd(n){for(var a=n;a!==null;){if(a.tag===13){var b=a.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||b.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var lf=[];function cf(){for(var n=0;n<lf.length;n++)lf[n]._workInProgressVersionPrimary=null;lf.length=0}var Jd=C.ReactCurrentDispatcher,uf=C.ReactCurrentBatchConfig,wc=0,Ss=null,Hs=null,Ks=null,Qd=!1,rd=!1,nd=0,vm=0;function ua(){throw Error(t(321))}function df(n,a){if(a===null)return!1;for(var b=0;b<a.length&&b<n.length;b++)if(!Ls(n[b],a[b]))return!1;return!0}function hf(n,a,b,F,U,Q){if(wc=Q,Ss=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Jd.current=n===null||n.memoizedState===null?wm:Em,n=b(F,U),rd){Q=0;do{if(rd=!1,nd=0,25<=Q)throw Error(t(301));Q+=1,Ks=Hs=null,a.updateQueue=null,Jd.current=Sm,n=b(F,U)}while(rd)}if(Jd.current=eh,a=Hs!==null&&Hs.next!==null,wc=0,Ks=Hs=Ss=null,Qd=!1,a)throw Error(t(300));return n}function ff(){var n=nd!==0;return nd=0,n}function ol(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ks===null?Ss.memoizedState=Ks=n:Ks=Ks.next=n,Ks}function Fa(){if(Hs===null){var n=Ss.alternate;n=n!==null?n.memoizedState:null}else n=Hs.next;var a=Ks===null?Ss.memoizedState:Ks.next;if(a!==null)Ks=a,Hs=n;else{if(n===null)throw Error(t(310));Hs=n,n={memoizedState:Hs.memoizedState,baseState:Hs.baseState,baseQueue:Hs.baseQueue,queue:Hs.queue,next:null},Ks===null?Ss.memoizedState=Ks=n:Ks=Ks.next=n}return Ks}function sd(n,a){return typeof a=="function"?a(n):a}function pf(n){var a=Fa(),b=a.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=n;var F=Hs,U=F.baseQueue,Q=b.pending;if(Q!==null){if(U!==null){var oe=U.next;U.next=Q.next,Q.next=oe}F.baseQueue=U=Q,b.pending=null}if(U!==null){Q=U.next,F=F.baseState;var je=oe=null,st=null,Vt=Q;do{var Ur=Vt.lane;if((wc&Ur)===Ur)st!==null&&(st=st.next={lane:0,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null}),F=Vt.hasEagerState?Vt.eagerState:n(F,Vt.action);else{var $r={lane:Ur,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null};st===null?(je=st=$r,oe=F):st=st.next=$r,Ss.lanes|=Ur,Ec|=Ur}Vt=Vt.next}while(Vt!==null&&Vt!==Q);st===null?oe=F:st.next=je,Ls(F,a.memoizedState)||(wa=!0),a.memoizedState=F,a.baseState=oe,a.baseQueue=st,b.lastRenderedState=F}if(n=b.interleaved,n!==null){U=n;do Q=U.lane,Ss.lanes|=Q,Ec|=Q,U=U.next;while(U!==n)}else U===null&&(b.lanes=0);return[a.memoizedState,b.dispatch]}function mf(n){var a=Fa(),b=a.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=n;var F=b.dispatch,U=b.pending,Q=a.memoizedState;if(U!==null){b.pending=null;var oe=U=U.next;do Q=n(Q,oe.action),oe=oe.next;while(oe!==U);Ls(Q,a.memoizedState)||(wa=!0),a.memoizedState=Q,a.baseQueue===null&&(a.baseState=Q),b.lastRenderedState=Q}return[Q,F]}function op(){}function ap(n,a){var b=Ss,F=Fa(),U=a(),Q=!Ls(F.memoizedState,U);if(Q&&(F.memoizedState=U,wa=!0),F=F.queue,gf(up.bind(null,b,F,n),[n]),F.getSnapshot!==a||Q||Ks!==null&&Ks.memoizedState.tag&1){if(b.flags|=2048,od(9,cp.bind(null,b,F,U,a),void 0,null),ea===null)throw Error(t(349));(wc&30)!==0||lp(b,a,U)}return U}function lp(n,a,b){n.flags|=16384,n={getSnapshot:a,value:b},a=Ss.updateQueue,a===null?(a={lastEffect:null,stores:null},Ss.updateQueue=a,a.stores=[n]):(b=a.stores,b===null?a.stores=[n]:b.push(n))}function cp(n,a,b,F){a.value=b,a.getSnapshot=F,dp(a)&&hp(n)}function up(n,a,b){return b(function(){dp(a)&&hp(n)})}function dp(n){var a=n.getSnapshot;n=n.value;try{var b=a();return!Ls(n,b)}catch{return!0}}function hp(n){var a=Cl(n,1);a!==null&&Ha(a,n,1,-1)}function fp(n){var a=ol();return typeof n=="function"&&(n=n()),a.memoizedState=a.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sd,lastRenderedState:n},a.queue=n,n=n.dispatch=bm.bind(null,Ss,n),[a.memoizedState,n]}function od(n,a,b,F){return n={tag:n,create:a,destroy:b,deps:F,next:null},a=Ss.updateQueue,a===null?(a={lastEffect:null,stores:null},Ss.updateQueue=a,a.lastEffect=n.next=n):(b=a.lastEffect,b===null?a.lastEffect=n.next=n:(F=b.next,b.next=n,n.next=F,a.lastEffect=n)),n}function pp(){return Fa().memoizedState}function Zd(n,a,b,F){var U=ol();Ss.flags|=n,U.memoizedState=od(1|a,b,void 0,F===void 0?null:F)}function Kd(n,a,b,F){var U=Fa();F=F===void 0?null:F;var Q=void 0;if(Hs!==null){var oe=Hs.memoizedState;if(Q=oe.destroy,F!==null&&df(F,oe.deps)){U.memoizedState=od(a,b,Q,F);return}}Ss.flags|=n,U.memoizedState=od(1|a,b,Q,F)}function mp(n,a){return Zd(8390656,8,n,a)}function gf(n,a){return Kd(2048,8,n,a)}function gp(n,a){return Kd(4,2,n,a)}function yp(n,a){return Kd(4,4,n,a)}function vp(n,a){if(typeof a=="function")return n=n(),a(n),function(){a(null)};if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function xp(n,a,b){return b=b!=null?b.concat([n]):null,Kd(4,4,vp.bind(null,a,n),b)}function yf(){}function _p(n,a){var b=Fa();a=a===void 0?null:a;var F=b.memoizedState;return F!==null&&a!==null&&df(a,F[1])?F[0]:(b.memoizedState=[n,a],n)}function bp(n,a){var b=Fa();a=a===void 0?null:a;var F=b.memoizedState;return F!==null&&a!==null&&df(a,F[1])?F[0]:(n=n(),b.memoizedState=[n,a],n)}function wp(n,a,b){return(wc&21)===0?(n.baseState&&(n.baseState=!1,wa=!0),n.memoizedState=b):(Ls(b,a)||(b=Xa(),Ss.lanes|=b,Ec|=b,n.baseState=!0),a)}function xm(n,a){var b=Dn;Dn=b!==0&&4>b?b:4,n(!0);var F=uf.transition;uf.transition={};try{n(!1),a()}finally{Dn=b,uf.transition=F}}function Ep(){return Fa().memoizedState}function _m(n,a,b){var F=Zl(n);if(b={lane:F,action:b,hasEagerState:!1,eagerState:null,next:null},Sp(n))Cp(a,b);else if(b=qf(n,a,b,F),b!==null){var U=xa();Ha(b,n,F,U),Ap(b,a,F)}}function bm(n,a,b){var F=Zl(n),U={lane:F,action:b,hasEagerState:!1,eagerState:null,next:null};if(Sp(n))Cp(a,U);else{var Q=n.alternate;if(n.lanes===0&&(Q===null||Q.lanes===0)&&(Q=a.lastRenderedReducer,Q!==null))try{var oe=a.lastRenderedState,je=Q(oe,b);if(U.hasEagerState=!0,U.eagerState=je,Ls(je,oe)){var st=a.interleaved;st===null?(U.next=U,tf(a)):(U.next=st.next,st.next=U),a.interleaved=U;return}}catch{}finally{}b=qf(n,a,U,F),b!==null&&(U=xa(),Ha(b,n,F,U),Ap(b,a,F))}}function Sp(n){var a=n.alternate;return n===Ss||a!==null&&a===Ss}function Cp(n,a){rd=Qd=!0;var b=n.pending;b===null?a.next=a:(a.next=b.next,b.next=a),n.pending=a}function Ap(n,a,b){if((b&4194240)!==0){var F=a.lanes;F&=n.pendingLanes,b|=F,a.lanes=b,za(n,b)}}var eh={readContext:Da,useCallback:ua,useContext:ua,useEffect:ua,useImperativeHandle:ua,useInsertionEffect:ua,useLayoutEffect:ua,useMemo:ua,useReducer:ua,useRef:ua,useState:ua,useDebugValue:ua,useDeferredValue:ua,useTransition:ua,useMutableSource:ua,useSyncExternalStore:ua,useId:ua,unstable_isNewReconciler:!1},wm={readContext:Da,useCallback:function(n,a){return ol().memoizedState=[n,a===void 0?null:a],n},useContext:Da,useEffect:mp,useImperativeHandle:function(n,a,b){return b=b!=null?b.concat([n]):null,Zd(4194308,4,vp.bind(null,a,n),b)},useLayoutEffect:function(n,a){return Zd(4194308,4,n,a)},useInsertionEffect:function(n,a){return Zd(4,2,n,a)},useMemo:function(n,a){var b=ol();return a=a===void 0?null:a,n=n(),b.memoizedState=[n,a],n},useReducer:function(n,a,b){var F=ol();return a=b!==void 0?b(a):a,F.memoizedState=F.baseState=a,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:a},F.queue=n,n=n.dispatch=_m.bind(null,Ss,n),[F.memoizedState,n]},useRef:function(n){var a=ol();return n={current:n},a.memoizedState=n},useState:fp,useDebugValue:yf,useDeferredValue:function(n){return ol().memoizedState=n},useTransition:function(){var n=fp(!1),a=n[0];return n=xm.bind(null,n[1]),ol().memoizedState=n,[a,n]},useMutableSource:function(){},useSyncExternalStore:function(n,a,b){var F=Ss,U=ol();if(Wr){if(b===void 0)throw Error(t(407));b=b()}else{if(b=a(),ea===null)throw Error(t(349));(wc&30)!==0||lp(F,a,b)}U.memoizedState=b;var Q={value:b,getSnapshot:a};return U.queue=Q,mp(up.bind(null,F,Q,n),[n]),F.flags|=2048,od(9,cp.bind(null,F,Q,b,a),void 0,null),b},useId:function(){var n=ol(),a=ea.identifierPrefix;if(Wr){var b=Hr,F=jn;b=(F&~(1<<32-ma(F)-1)).toString(32)+b,a=":"+a+"R"+b,b=nd++,0<b&&(a+="H"+b.toString(32)),a+=":"}else b=vm++,a=":"+a+"r"+b.toString(32)+":";return n.memoizedState=a},unstable_isNewReconciler:!1},Em={readContext:Da,useCallback:_p,useContext:Da,useEffect:gf,useImperativeHandle:xp,useInsertionEffect:gp,useLayoutEffect:yp,useMemo:bp,useReducer:pf,useRef:pp,useState:function(){return pf(sd)},useDebugValue:yf,useDeferredValue:function(n){var a=Fa();return wp(a,Hs.memoizedState,n)},useTransition:function(){var n=pf(sd)[0],a=Fa().memoizedState;return[n,a]},useMutableSource:op,useSyncExternalStore:ap,useId:Ep,unstable_isNewReconciler:!1},Sm={readContext:Da,useCallback:_p,useContext:Da,useEffect:gf,useImperativeHandle:xp,useInsertionEffect:gp,useLayoutEffect:yp,useMemo:bp,useReducer:mf,useRef:pp,useState:function(){return mf(sd)},useDebugValue:yf,useDeferredValue:function(n){var a=Fa();return Hs===null?a.memoizedState=n:wp(a,Hs.memoizedState,n)},useTransition:function(){var n=mf(sd)[0],a=Fa().memoizedState;return[n,a]},useMutableSource:op,useSyncExternalStore:ap,useId:Ep,unstable_isNewReconciler:!1};function cu(n,a){try{var b="",F=a;do b+=Ne(F),F=F.return;while(F);var U=b}catch(Q){U=`
Error generating stack: `+Q.message+`
`+Q.stack}return{value:n,source:a,stack:U,digest:null}}function vf(n,a,b){return{value:n,source:null,stack:b??null,digest:a??null}}function xf(n,a){try{console.error(a.value)}catch(b){setTimeout(function(){throw b})}}var Cm=typeof WeakMap=="function"?WeakMap:Map;function Rp(n,a,b){b=Al(-1,b),b.tag=3,b.payload={element:null};var F=a.value;return b.callback=function(){ah||(ah=!0,Pf=F),xf(n,a)},b}function kp(n,a,b){b=Al(-1,b),b.tag=3;var F=n.type.getDerivedStateFromError;if(typeof F=="function"){var U=a.value;b.payload=function(){return F(U)},b.callback=function(){xf(n,a)}}var Q=n.stateNode;return Q!==null&&typeof Q.componentDidCatch=="function"&&(b.callback=function(){xf(n,a),typeof F!="function"&&(Jl===null?Jl=new Set([this]):Jl.add(this));var oe=a.stack;this.componentDidCatch(a.value,{componentStack:oe!==null?oe:""})}),b}function Tp(n,a,b){var F=n.pingCache;if(F===null){F=n.pingCache=new Cm;var U=new Set;F.set(a,U)}else U=F.get(a),U===void 0&&(U=new Set,F.set(a,U));U.has(b)||(U.add(b),n=jm.bind(null,n,a,b),a.then(n,n))}function Mp(n){do{var a;if((a=n.tag===13)&&(a=n.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return n;n=n.return}while(n!==null);return null}function Np(n,a,b,F,U){return(n.mode&1)===0?(n===a?n.flags|=65536:(n.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(a=Al(-1,1),a.tag=2,ql(b,a,1))),b.lanes|=1),n):(n.flags|=65536,n.lanes=U,n)}var Am=C.ReactCurrentOwner,wa=!1;function va(n,a,b,F){a.child=n===null?ip(a,null,b,F):au(a,n.child,b,F)}function zp(n,a,b,F,U){b=b.render;var Q=a.ref;return ou(a,U),F=hf(n,a,b,F,Q,U),b=ff(),n!==null&&!wa?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~U,Rl(n,a,U)):(Wr&&b&&vi(a),a.flags|=1,va(n,a,F,U),a.child)}function Ip(n,a,b,F,U){if(n===null){var Q=b.type;return typeof Q=="function"&&!Gf(Q)&&Q.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(a.tag=15,a.type=Q,Pp(n,a,Q,F,U)):(n=fh(b.type,null,F,a,a.mode,U),n.ref=a.ref,n.return=a,a.child=n)}if(Q=n.child,(n.lanes&U)===0){var oe=Q.memoizedProps;if(b=b.compare,b=b!==null?b:bl,b(oe,F)&&n.ref===a.ref)return Rl(n,a,U)}return a.flags|=1,n=ec(Q,F),n.ref=a.ref,n.return=a,a.child=n}function Pp(n,a,b,F,U){if(n!==null){var Q=n.memoizedProps;if(bl(Q,F)&&n.ref===a.ref)if(wa=!1,a.pendingProps=F=Q,(n.lanes&U)!==0)(n.flags&131072)!==0&&(wa=!0);else return a.lanes=n.lanes,Rl(n,a,U)}return _f(n,a,b,F,U)}function Dp(n,a,b){var F=a.pendingProps,U=F.children,Q=n!==null?n.memoizedState:null;if(F.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},fi(du,Ma),Ma|=b;else{if((b&1073741824)===0)return n=Q!==null?Q.baseLanes|b:b,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:n,cachePool:null,transitions:null},a.updateQueue=null,fi(du,Ma),Ma|=n,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},F=Q!==null?Q.baseLanes:b,fi(du,Ma),Ma|=F}else Q!==null?(F=Q.baseLanes|b,a.memoizedState=null):F=b,fi(du,Ma),Ma|=F;return va(n,a,U,b),a.child}function Fp(n,a){var b=a.ref;(n===null&&b!==null||n!==null&&n.ref!==b)&&(a.flags|=512,a.flags|=2097152)}function _f(n,a,b,F,U){var Q=na(b)?il:Js.current;return Q=Sl(a,Q),ou(a,U),b=hf(n,a,b,F,Q,U),F=ff(),n!==null&&!wa?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~U,Rl(n,a,U)):(Wr&&F&&vi(a),a.flags|=1,va(n,a,b,U),a.child)}function Op(n,a,b,F,U){if(na(b)){var Q=!0;xc(a)}else Q=!1;if(ou(a,U),a.stateNode===null)rh(n,a),ep(a,b,F),sf(a,b,F,U),F=!0;else if(n===null){var oe=a.stateNode,je=a.memoizedProps;oe.props=je;var st=oe.context,Vt=b.contextType;typeof Vt=="object"&&Vt!==null?Vt=Da(Vt):(Vt=na(b)?il:Js.current,Vt=Sl(a,Vt));var Ur=b.getDerivedStateFromProps,$r=typeof Ur=="function"||typeof oe.getSnapshotBeforeUpdate=="function";$r||typeof oe.UNSAFE_componentWillReceiveProps!="function"&&typeof oe.componentWillReceiveProps!="function"||(je!==F||st!==Vt)&&tp(a,oe,F,Vt),Yl=!1;var Gr=a.memoizedState;oe.state=Gr,Hd(a,F,oe,U),st=a.memoizedState,je!==F||Gr!==st||la.current||Yl?(typeof Ur=="function"&&(nf(a,b,Ur,F),st=a.memoizedState),(je=Yl||Kf(a,b,je,F,Gr,st,Vt))?($r||typeof oe.UNSAFE_componentWillMount!="function"&&typeof oe.componentWillMount!="function"||(typeof oe.componentWillMount=="function"&&oe.componentWillMount(),typeof oe.UNSAFE_componentWillMount=="function"&&oe.UNSAFE_componentWillMount()),typeof oe.componentDidMount=="function"&&(a.flags|=4194308)):(typeof oe.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=F,a.memoizedState=st),oe.props=F,oe.state=st,oe.context=Vt,F=je):(typeof oe.componentDidMount=="function"&&(a.flags|=4194308),F=!1)}else{oe=a.stateNode,Xf(n,a),je=a.memoizedProps,Vt=a.type===a.elementType?je:ca(a.type,je),oe.props=Vt,$r=a.pendingProps,Gr=oe.context,st=b.contextType,typeof st=="object"&&st!==null?st=Da(st):(st=na(b)?il:Js.current,st=Sl(a,st));var sn=b.getDerivedStateFromProps;(Ur=typeof sn=="function"||typeof oe.getSnapshotBeforeUpdate=="function")||typeof oe.UNSAFE_componentWillReceiveProps!="function"&&typeof oe.componentWillReceiveProps!="function"||(je!==$r||Gr!==st)&&tp(a,oe,F,st),Yl=!1,Gr=a.memoizedState,oe.state=Gr,Hd(a,F,oe,U);var an=a.memoizedState;je!==$r||Gr!==an||la.current||Yl?(typeof sn=="function"&&(nf(a,b,sn,F),an=a.memoizedState),(Vt=Yl||Kf(a,b,Vt,F,Gr,an,st)||!1)?(Ur||typeof oe.UNSAFE_componentWillUpdate!="function"&&typeof oe.componentWillUpdate!="function"||(typeof oe.componentWillUpdate=="function"&&oe.componentWillUpdate(F,an,st),typeof oe.UNSAFE_componentWillUpdate=="function"&&oe.UNSAFE_componentWillUpdate(F,an,st)),typeof oe.componentDidUpdate=="function"&&(a.flags|=4),typeof oe.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof oe.componentDidUpdate!="function"||je===n.memoizedProps&&Gr===n.memoizedState||(a.flags|=4),typeof oe.getSnapshotBeforeUpdate!="function"||je===n.memoizedProps&&Gr===n.memoizedState||(a.flags|=1024),a.memoizedProps=F,a.memoizedState=an),oe.props=F,oe.state=an,oe.context=st,F=Vt):(typeof oe.componentDidUpdate!="function"||je===n.memoizedProps&&Gr===n.memoizedState||(a.flags|=4),typeof oe.getSnapshotBeforeUpdate!="function"||je===n.memoizedProps&&Gr===n.memoizedState||(a.flags|=1024),F=!1)}return bf(n,a,b,F,Q,U)}function bf(n,a,b,F,U,Q){Fp(n,a);var oe=(a.flags&128)!==0;if(!F&&!oe)return U&&Qu(a,b,!1),Rl(n,a,Q);F=a.stateNode,Am.current=a;var je=oe&&typeof b.getDerivedStateFromError!="function"?null:F.render();return a.flags|=1,n!==null&&oe?(a.child=au(a,n.child,null,Q),a.child=au(a,null,je,Q)):va(n,a,je,Q),a.memoizedState=F.state,U&&Qu(a,b,!0),a.child}function Lp(n){var a=n.stateNode;a.pendingContext?Xu(n,a.pendingContext,a.pendingContext!==a.context):a.context&&Xu(n,a.context,!1),of(n,a.containerInfo)}function jp(n,a,b,F,U){return ba(),nu(U),a.flags|=256,va(n,a,b,F),a.child}var wf={dehydrated:null,treeContext:null,retryLane:0};function Ef(n){return{baseLanes:n,cachePool:null,transitions:null}}function Bp(n,a,b){var F=a.pendingProps,U=ls.current,Q=!1,oe=(a.flags&128)!==0,je;if((je=oe)||(je=n!==null&&n.memoizedState===null?!1:(U&2)!==0),je?(Q=!0,a.flags&=-129):(n===null||n.memoizedState!==null)&&(U|=1),fi(ls,U&1),n===null)return li(a),n=a.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((a.mode&1)===0?a.lanes=1:n.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(oe=F.children,n=F.fallback,Q?(F=a.mode,Q=a.child,oe={mode:"hidden",children:oe},(F&1)===0&&Q!==null?(Q.childLanes=0,Q.pendingProps=oe):Q=ph(oe,F,0,null),n=Rc(n,F,b,null),Q.return=a,n.return=a,Q.sibling=n,a.child=Q,a.child.memoizedState=Ef(b),a.memoizedState=wf,n):Sf(a,oe));if(U=n.memoizedState,U!==null&&(je=U.dehydrated,je!==null))return Rm(n,a,oe,F,je,U,b);if(Q){Q=F.fallback,oe=a.mode,U=n.child,je=U.sibling;var st={mode:"hidden",children:F.children};return(oe&1)===0&&a.child!==U?(F=a.child,F.childLanes=0,F.pendingProps=st,a.deletions=null):(F=ec(U,st),F.subtreeFlags=U.subtreeFlags&14680064),je!==null?Q=ec(je,Q):(Q=Rc(Q,oe,b,null),Q.flags|=2),Q.return=a,F.return=a,F.sibling=Q,a.child=F,F=Q,Q=a.child,oe=n.child.memoizedState,oe=oe===null?Ef(b):{baseLanes:oe.baseLanes|b,cachePool:null,transitions:oe.transitions},Q.memoizedState=oe,Q.childLanes=n.childLanes&~b,a.memoizedState=wf,F}return Q=n.child,n=Q.sibling,F=ec(Q,{mode:"visible",children:F.children}),(a.mode&1)===0&&(F.lanes=b),F.return=a,F.sibling=null,n!==null&&(b=a.deletions,b===null?(a.deletions=[n],a.flags|=16):b.push(n)),a.child=F,a.memoizedState=null,F}function Sf(n,a){return a=ph({mode:"visible",children:a},n.mode,0,null),a.return=n,n.child=a}function th(n,a,b,F){return F!==null&&nu(F),au(a,n.child,null,b),n=Sf(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function Rm(n,a,b,F,U,Q,oe){if(b)return a.flags&256?(a.flags&=-257,F=vf(Error(t(422))),th(n,a,oe,F)):a.memoizedState!==null?(a.child=n.child,a.flags|=128,null):(Q=F.fallback,U=a.mode,F=ph({mode:"visible",children:F.children},U,0,null),Q=Rc(Q,U,oe,null),Q.flags|=2,F.return=a,Q.return=a,F.sibling=Q,a.child=F,(a.mode&1)!==0&&au(a,n.child,null,oe),a.child.memoizedState=Ef(oe),a.memoizedState=wf,Q);if((a.mode&1)===0)return th(n,a,oe,null);if(U.data==="$!"){if(F=U.nextSibling&&U.nextSibling.dataset,F)var je=F.dgst;return F=je,Q=Error(t(419)),F=vf(Q,F,void 0),th(n,a,oe,F)}if(je=(oe&n.childLanes)!==0,wa||je){if(F=ea,F!==null){switch(oe&-oe){case 4:U=2;break;case 16:U=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:U=32;break;case 536870912:U=268435456;break;default:U=0}U=(U&(F.suspendedLanes|oe))!==0?0:U,U!==0&&U!==Q.retryLane&&(Q.retryLane=U,Cl(n,U),Ha(F,n,U,-1))}return Bf(),F=vf(Error(t(421))),th(n,a,oe,F)}return U.data==="$?"?(a.flags|=128,a.child=n.child,a=Bm.bind(null,n),U._reactRetry=a,null):(n=Q.treeContext,En=Ia(U.nextSibling),Cn=a,Wr=!0,An=null,n!==null&&(Kr[nt++]=jn,Kr[nt++]=Hr,Kr[nt++]=_t,jn=n.id,Hr=n.overflow,_t=a),a=Sf(a,F.children),a.flags|=4096,a)}function Gp(n,a,b){n.lanes|=a;var F=n.alternate;F!==null&&(F.lanes|=a),ef(n.return,a,b)}function Cf(n,a,b,F,U){var Q=n.memoizedState;Q===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:F,tail:b,tailMode:U}:(Q.isBackwards=a,Q.rendering=null,Q.renderingStartTime=0,Q.last=F,Q.tail=b,Q.tailMode=U)}function Up(n,a,b){var F=a.pendingProps,U=F.revealOrder,Q=F.tail;if(va(n,a,F.children,b),F=ls.current,(F&2)!==0)F=F&1|2,a.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Gp(n,b,a);else if(n.tag===19)Gp(n,b,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}F&=1}if(fi(ls,F),(a.mode&1)===0)a.memoizedState=null;else switch(U){case"forwards":for(b=a.child,U=null;b!==null;)n=b.alternate,n!==null&&Xd(n)===null&&(U=b),b=b.sibling;b=U,b===null?(U=a.child,a.child=null):(U=b.sibling,b.sibling=null),Cf(a,!1,U,b,Q);break;case"backwards":for(b=null,U=a.child,a.child=null;U!==null;){if(n=U.alternate,n!==null&&Xd(n)===null){a.child=U;break}n=U.sibling,U.sibling=b,b=U,U=n}Cf(a,!0,b,null,Q);break;case"together":Cf(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function rh(n,a){(a.mode&1)===0&&n!==null&&(n.alternate=null,a.alternate=null,a.flags|=2)}function Rl(n,a,b){if(n!==null&&(a.dependencies=n.dependencies),Ec|=a.lanes,(b&a.childLanes)===0)return null;if(n!==null&&a.child!==n.child)throw Error(t(153));if(a.child!==null){for(n=a.child,b=ec(n,n.pendingProps),a.child=b,b.return=a;n.sibling!==null;)n=n.sibling,b=b.sibling=ec(n,n.pendingProps),b.return=a;b.sibling=null}return a.child}function km(n,a,b){switch(a.tag){case 3:Lp(a),ba();break;case 5:sp(a);break;case 1:na(a.type)&&xc(a);break;case 4:of(a,a.stateNode.containerInfo);break;case 10:var F=a.type._context,U=a.memoizedProps.value;fi(Vd,F._currentValue),F._currentValue=U;break;case 13:if(F=a.memoizedState,F!==null)return F.dehydrated!==null?(fi(ls,ls.current&1),a.flags|=128,null):(b&a.child.childLanes)!==0?Bp(n,a,b):(fi(ls,ls.current&1),n=Rl(n,a,b),n!==null?n.sibling:null);fi(ls,ls.current&1);break;case 19:if(F=(b&a.childLanes)!==0,(n.flags&128)!==0){if(F)return Up(n,a,b);a.flags|=128}if(U=a.memoizedState,U!==null&&(U.rendering=null,U.tail=null,U.lastEffect=null),fi(ls,ls.current),F)break;return null;case 22:case 23:return a.lanes=0,Dp(n,a,b)}return Rl(n,a,b)}var Vp,Af,Wp,$p;Vp=function(n,a){for(var b=a.child;b!==null;){if(b.tag===5||b.tag===6)n.appendChild(b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===a)break;for(;b.sibling===null;){if(b.return===null||b.return===a)return;b=b.return}b.sibling.return=b.return,b=b.sibling}},Af=function(){},Wp=function(n,a,b,F){var U=n.memoizedProps;if(U!==F){n=a.stateNode,bc(sl.current);var Q=null;switch(b){case"input":U=Fe(n,U),F=Fe(n,F),Q=[];break;case"select":U=G({},U,{value:void 0}),F=G({},F,{value:void 0}),Q=[];break;case"textarea":U=Nr(n,U),F=Nr(n,F),Q=[];break;default:typeof U.onClick!="function"&&typeof F.onClick=="function"&&(n.onclick=Kc)}lt(b,F);var oe;b=null;for(Vt in U)if(!F.hasOwnProperty(Vt)&&U.hasOwnProperty(Vt)&&U[Vt]!=null)if(Vt==="style"){var je=U[Vt];for(oe in je)je.hasOwnProperty(oe)&&(b||(b={}),b[oe]="")}else Vt!=="dangerouslySetInnerHTML"&&Vt!=="children"&&Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&Vt!=="autoFocus"&&(c.hasOwnProperty(Vt)?Q||(Q=[]):(Q=Q||[]).push(Vt,null));for(Vt in F){var st=F[Vt];if(je=U?.[Vt],F.hasOwnProperty(Vt)&&st!==je&&(st!=null||je!=null))if(Vt==="style")if(je){for(oe in je)!je.hasOwnProperty(oe)||st&&st.hasOwnProperty(oe)||(b||(b={}),b[oe]="");for(oe in st)st.hasOwnProperty(oe)&&je[oe]!==st[oe]&&(b||(b={}),b[oe]=st[oe])}else b||(Q||(Q=[]),Q.push(Vt,b)),b=st;else Vt==="dangerouslySetInnerHTML"?(st=st?st.__html:void 0,je=je?je.__html:void 0,st!=null&&je!==st&&(Q=Q||[]).push(Vt,st)):Vt==="children"?typeof st!="string"&&typeof st!="number"||(Q=Q||[]).push(Vt,""+st):Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&(c.hasOwnProperty(Vt)?(st!=null&&Vt==="onScroll"&&di("scroll",n),Q||je===st||(Q=[])):(Q=Q||[]).push(Vt,st))}b&&(Q=Q||[]).push("style",b);var Vt=Q;(a.updateQueue=Vt)&&(a.flags|=4)}},$p=function(n,a,b,F){b!==F&&(a.flags|=4)};function ad(n,a){if(!Wr)switch(n.tailMode){case"hidden":a=n.tail;for(var b=null;a!==null;)a.alternate!==null&&(b=a),a=a.sibling;b===null?n.tail=null:b.sibling=null;break;case"collapsed":b=n.tail;for(var F=null;b!==null;)b.alternate!==null&&(F=b),b=b.sibling;F===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:F.sibling=null}}function da(n){var a=n.alternate!==null&&n.alternate.child===n.child,b=0,F=0;if(a)for(var U=n.child;U!==null;)b|=U.lanes|U.childLanes,F|=U.subtreeFlags&14680064,F|=U.flags&14680064,U.return=n,U=U.sibling;else for(U=n.child;U!==null;)b|=U.lanes|U.childLanes,F|=U.subtreeFlags,F|=U.flags,U.return=n,U=U.sibling;return n.subtreeFlags|=F,n.childLanes=b,a}function Tm(n,a,b){var F=a.pendingProps;switch(ti(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return da(a),null;case 1:return na(a.type)&&vc(),da(a),null;case 3:return F=a.stateNode,lu(),gi(la),gi(Js),cf(),F.pendingContext&&(F.context=F.pendingContext,F.pendingContext=null),(n===null||n.child===null)&&(Fn(a)?a.flags|=4:n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,An!==null&&(Of(An),An=null))),Af(n,a),da(a),null;case 5:af(a);var U=bc(td.current);if(b=a.type,n!==null&&a.stateNode!=null)Wp(n,a,b,F,U),n.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!F){if(a.stateNode===null)throw Error(t(166));return da(a),null}if(n=bc(sl.current),Fn(a)){F=a.stateNode,b=a.type;var Q=a.memoizedProps;switch(F[Ta]=a,F[mc]=Q,n=(a.mode&1)!==0,b){case"dialog":di("cancel",F),di("close",F);break;case"iframe":case"object":case"embed":di("load",F);break;case"video":case"audio":for(U=0;U<Ul.length;U++)di(Ul[U],F);break;case"source":di("error",F);break;case"img":case"image":case"link":di("error",F),di("load",F);break;case"details":di("toggle",F);break;case"input":ht(F,Q),di("invalid",F);break;case"select":F._wrapperState={wasMultiple:!!Q.multiple},di("invalid",F);break;case"textarea":At(F,Q),di("invalid",F)}lt(b,Q),U=null;for(var oe in Q)if(Q.hasOwnProperty(oe)){var je=Q[oe];oe==="children"?typeof je=="string"?F.textContent!==je&&(Q.suppressHydrationWarning!==!0&&Zc(F.textContent,je,n),U=["children",je]):typeof je=="number"&&F.textContent!==""+je&&(Q.suppressHydrationWarning!==!0&&Zc(F.textContent,je,n),U=["children",""+je]):c.hasOwnProperty(oe)&&je!=null&&oe==="onScroll"&&di("scroll",F)}switch(b){case"input":jt(F),Wt(F,Q,!0);break;case"textarea":jt(F),Jr(F);break;case"select":case"option":break;default:typeof Q.onClick=="function"&&(F.onclick=Kc)}F=U,a.updateQueue=F,F!==null&&(a.flags|=4)}else{oe=U.nodeType===9?U:U.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Yr(b)),n==="http://www.w3.org/1999/xhtml"?b==="script"?(n=oe.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof F.is=="string"?n=oe.createElement(b,{is:F.is}):(n=oe.createElement(b),b==="select"&&(oe=n,F.multiple?oe.multiple=!0:F.size&&(oe.size=F.size))):n=oe.createElementNS(n,b),n[Ta]=a,n[mc]=F,Vp(n,a,!1,!1),a.stateNode=n;e:{switch(oe=ar(b,F),b){case"dialog":di("cancel",n),di("close",n),U=F;break;case"iframe":case"object":case"embed":di("load",n),U=F;break;case"video":case"audio":for(U=0;U<Ul.length;U++)di(Ul[U],n);U=F;break;case"source":di("error",n),U=F;break;case"img":case"image":case"link":di("error",n),di("load",n),U=F;break;case"details":di("toggle",n),U=F;break;case"input":ht(n,F),U=Fe(n,F),di("invalid",n);break;case"option":U=F;break;case"select":n._wrapperState={wasMultiple:!!F.multiple},U=G({},F,{value:void 0}),di("invalid",n);break;case"textarea":At(n,F),U=Nr(n,F),di("invalid",n);break;default:U=F}lt(b,U),je=U;for(Q in je)if(je.hasOwnProperty(Q)){var st=je[Q];Q==="style"?re(n,st):Q==="dangerouslySetInnerHTML"?(st=st?st.__html:void 0,st!=null&&we(n,st)):Q==="children"?typeof st=="string"?(b!=="textarea"||st!=="")&&it(n,st):typeof st=="number"&&it(n,""+st):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(c.hasOwnProperty(Q)?st!=null&&Q==="onScroll"&&di("scroll",n):st!=null&&S(n,Q,st,oe))}switch(b){case"input":jt(n),Wt(n,F,!1);break;case"textarea":jt(n),Jr(n);break;case"option":F.value!=null&&n.setAttribute("value",""+Me(F.value));break;case"select":n.multiple=!!F.multiple,Q=F.value,Q!=null?cr(n,!!F.multiple,Q,!1):F.defaultValue!=null&&cr(n,!!F.multiple,F.defaultValue,!0);break;default:typeof U.onClick=="function"&&(n.onclick=Kc)}switch(b){case"button":case"input":case"select":case"textarea":F=!!F.autoFocus;break e;case"img":F=!0;break e;default:F=!1}}F&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return da(a),null;case 6:if(n&&a.stateNode!=null)$p(n,a,n.memoizedProps,F);else{if(typeof F!="string"&&a.stateNode===null)throw Error(t(166));if(b=bc(td.current),bc(sl.current),Fn(a)){if(F=a.stateNode,b=a.memoizedProps,F[Ta]=a,(Q=F.nodeValue!==b)&&(n=Cn,n!==null))switch(n.tag){case 3:Zc(F.nodeValue,b,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Zc(F.nodeValue,b,(n.mode&1)!==0)}Q&&(a.flags|=4)}else F=(b.nodeType===9?b:b.ownerDocument).createTextNode(F),F[Ta]=a,a.stateNode=F}return da(a),null;case 13:if(gi(ls),F=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Wr&&En!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Qs(),ba(),a.flags|=98560,Q=!1;else if(Q=Fn(a),F!==null&&F.dehydrated!==null){if(n===null){if(!Q)throw Error(t(318));if(Q=a.memoizedState,Q=Q!==null?Q.dehydrated:null,!Q)throw Error(t(317));Q[Ta]=a}else ba(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;da(a),Q=!1}else An!==null&&(Of(An),An=null),Q=!0;if(!Q)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=b,a):(F=F!==null,F!==(n!==null&&n.memoizedState!==null)&&F&&(a.child.flags|=8192,(a.mode&1)!==0&&(n===null||(ls.current&1)!==0?qs===0&&(qs=3):Bf())),a.updateQueue!==null&&(a.flags|=4),da(a),null);case 4:return lu(),Af(n,a),n===null&&fc(a.stateNode.containerInfo),da(a),null;case 10:return Kh(a.type._context),da(a),null;case 17:return na(a.type)&&vc(),da(a),null;case 19:if(gi(ls),Q=a.memoizedState,Q===null)return da(a),null;if(F=(a.flags&128)!==0,oe=Q.rendering,oe===null)if(F)ad(Q,!1);else{if(qs!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(oe=Xd(n),oe!==null){for(a.flags|=128,ad(Q,!1),F=oe.updateQueue,F!==null&&(a.updateQueue=F,a.flags|=4),a.subtreeFlags=0,F=b,b=a.child;b!==null;)Q=b,n=F,Q.flags&=14680066,oe=Q.alternate,oe===null?(Q.childLanes=0,Q.lanes=n,Q.child=null,Q.subtreeFlags=0,Q.memoizedProps=null,Q.memoizedState=null,Q.updateQueue=null,Q.dependencies=null,Q.stateNode=null):(Q.childLanes=oe.childLanes,Q.lanes=oe.lanes,Q.child=oe.child,Q.subtreeFlags=0,Q.deletions=null,Q.memoizedProps=oe.memoizedProps,Q.memoizedState=oe.memoizedState,Q.updateQueue=oe.updateQueue,Q.type=oe.type,n=oe.dependencies,Q.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),b=b.sibling;return fi(ls,ls.current&1|2),a.child}n=n.sibling}Q.tail!==null&&hi()>hu&&(a.flags|=128,F=!0,ad(Q,!1),a.lanes=4194304)}else{if(!F)if(n=Xd(oe),n!==null){if(a.flags|=128,F=!0,b=n.updateQueue,b!==null&&(a.updateQueue=b,a.flags|=4),ad(Q,!0),Q.tail===null&&Q.tailMode==="hidden"&&!oe.alternate&&!Wr)return da(a),null}else 2*hi()-Q.renderingStartTime>hu&&b!==1073741824&&(a.flags|=128,F=!0,ad(Q,!1),a.lanes=4194304);Q.isBackwards?(oe.sibling=a.child,a.child=oe):(b=Q.last,b!==null?b.sibling=oe:a.child=oe,Q.last=oe)}return Q.tail!==null?(a=Q.tail,Q.rendering=a,Q.tail=a.sibling,Q.renderingStartTime=hi(),a.sibling=null,b=ls.current,fi(ls,F?b&1|2:b&1),a):(da(a),null);case 22:case 23:return jf(),F=a.memoizedState!==null,n!==null&&n.memoizedState!==null!==F&&(a.flags|=8192),F&&(a.mode&1)!==0?(Ma&1073741824)!==0&&(da(a),a.subtreeFlags&6&&(a.flags|=8192)):da(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function Mm(n,a){switch(ti(a),a.tag){case 1:return na(a.type)&&vc(),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return lu(),gi(la),gi(Js),cf(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 5:return af(a),null;case 13:if(gi(ls),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(t(340));ba()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return gi(ls),null;case 4:return lu(),null;case 10:return Kh(a.type._context),null;case 22:case 23:return jf(),null;case 24:return null;default:return null}}var nh=!1,ha=!1,Nm=typeof WeakSet=="function"?WeakSet:Set,on=null;function uu(n,a){var b=n.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(F){Ts(n,a,F)}else b.current=null}function Rf(n,a,b){try{b()}catch(F){Ts(n,a,F)}}var Hp=!1;function zm(n,a){if(Wu=zc,n=Du(),Wc(n)){if("selectionStart"in n)var b={start:n.selectionStart,end:n.selectionEnd};else e:{b=(b=n.ownerDocument)&&b.defaultView||window;var F=b.getSelection&&b.getSelection();if(F&&F.rangeCount!==0){b=F.anchorNode;var U=F.anchorOffset,Q=F.focusNode;F=F.focusOffset;try{b.nodeType,Q.nodeType}catch{b=null;break e}var oe=0,je=-1,st=-1,Vt=0,Ur=0,$r=n,Gr=null;t:for(;;){for(var sn;$r!==b||U!==0&&$r.nodeType!==3||(je=oe+U),$r!==Q||F!==0&&$r.nodeType!==3||(st=oe+F),$r.nodeType===3&&(oe+=$r.nodeValue.length),(sn=$r.firstChild)!==null;)Gr=$r,$r=sn;for(;;){if($r===n)break t;if(Gr===b&&++Vt===U&&(je=oe),Gr===Q&&++Ur===F&&(st=oe),(sn=$r.nextSibling)!==null)break;$r=Gr,Gr=$r.parentNode}$r=sn}b=je===-1||st===-1?null:{start:je,end:st}}else b=null}b=b||{start:0,end:0}}else b=null;for($u={focusedElem:n,selectionRange:b},zc=!1,on=a;on!==null;)if(a=on,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,on=n;else for(;on!==null;){a=on;try{var an=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(an!==null){var bn=an.memoizedProps,Gs=an.memoizedState,Et=a.stateNode,ot=Et.getSnapshotBeforeUpdate(a.elementType===a.type?bn:ca(a.type,bn),Gs);Et.__reactInternalSnapshotBeforeUpdate=ot}break;case 3:var Tt=a.stateNode.containerInfo;Tt.nodeType===1?Tt.textContent="":Tt.nodeType===9&&Tt.documentElement&&Tt.removeChild(Tt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(qr){Ts(a,a.return,qr)}if(n=a.sibling,n!==null){n.return=a.return,on=n;break}on=a.return}return an=Hp,Hp=!1,an}function ld(n,a,b){var F=a.updateQueue;if(F=F!==null?F.lastEffect:null,F!==null){var U=F=F.next;do{if((U.tag&n)===n){var Q=U.destroy;U.destroy=void 0,Q!==void 0&&Rf(a,b,Q)}U=U.next}while(U!==F)}}function ih(n,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var b=a=a.next;do{if((b.tag&n)===n){var F=b.create;b.destroy=F()}b=b.next}while(b!==a)}}function kf(n){var a=n.ref;if(a!==null){var b=n.stateNode;switch(n.tag){case 5:n=b;break;default:n=b}typeof a=="function"?a(n):a.current=n}}function Yp(n){var a=n.alternate;a!==null&&(n.alternate=null,Yp(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&(delete a[Ta],delete a[mc],delete a[gc],delete a[Xh],delete a[Jh])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function qp(n){return n.tag===5||n.tag===3||n.tag===4}function Xp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||qp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Tf(n,a,b){var F=n.tag;if(F===5||F===6)n=n.stateNode,a?b.nodeType===8?b.parentNode.insertBefore(n,a):b.insertBefore(n,a):(b.nodeType===8?(a=b.parentNode,a.insertBefore(n,b)):(a=b,a.appendChild(n)),b=b._reactRootContainer,b!=null||a.onclick!==null||(a.onclick=Kc));else if(F!==4&&(n=n.child,n!==null))for(Tf(n,a,b),n=n.sibling;n!==null;)Tf(n,a,b),n=n.sibling}function Mf(n,a,b){var F=n.tag;if(F===5||F===6)n=n.stateNode,a?b.insertBefore(n,a):b.appendChild(n);else if(F!==4&&(n=n.child,n!==null))for(Mf(n,a,b),n=n.sibling;n!==null;)Mf(n,a,b),n=n.sibling}var ia=null,Wa=!1;function Xl(n,a,b){for(b=b.child;b!==null;)Jp(n,a,b),b=b.sibling}function Jp(n,a,b){if(Ws&&typeof Ws.onCommitFiberUnmount=="function")try{Ws.onCommitFiberUnmount(Tl,b)}catch{}switch(b.tag){case 5:ha||uu(b,a);case 6:var F=ia,U=Wa;ia=null,Xl(n,a,b),ia=F,Wa=U,ia!==null&&(Wa?(n=ia,b=b.stateNode,n.nodeType===8?n.parentNode.removeChild(b):n.removeChild(b)):ia.removeChild(b.stateNode));break;case 18:ia!==null&&(Wa?(n=ia,b=b.stateNode,n.nodeType===8?wl(n.parentNode,b):n.nodeType===1&&wl(n,b),ic(n)):wl(ia,b.stateNode));break;case 4:F=ia,U=Wa,ia=b.stateNode.containerInfo,Wa=!0,Xl(n,a,b),ia=F,Wa=U;break;case 0:case 11:case 14:case 15:if(!ha&&(F=b.updateQueue,F!==null&&(F=F.lastEffect,F!==null))){U=F=F.next;do{var Q=U,oe=Q.destroy;Q=Q.tag,oe!==void 0&&((Q&2)!==0||(Q&4)!==0)&&Rf(b,a,oe),U=U.next}while(U!==F)}Xl(n,a,b);break;case 1:if(!ha&&(uu(b,a),F=b.stateNode,typeof F.componentWillUnmount=="function"))try{F.props=b.memoizedProps,F.state=b.memoizedState,F.componentWillUnmount()}catch(je){Ts(b,a,je)}Xl(n,a,b);break;case 21:Xl(n,a,b);break;case 22:b.mode&1?(ha=(F=ha)||b.memoizedState!==null,Xl(n,a,b),ha=F):Xl(n,a,b);break;default:Xl(n,a,b)}}function Qp(n){var a=n.updateQueue;if(a!==null){n.updateQueue=null;var b=n.stateNode;b===null&&(b=n.stateNode=new Nm),a.forEach(function(F){var U=Gm.bind(null,n,F);b.has(F)||(b.add(F),F.then(U,U))})}}function $a(n,a){var b=a.deletions;if(b!==null)for(var F=0;F<b.length;F++){var U=b[F];try{var Q=n,oe=a,je=oe;e:for(;je!==null;){switch(je.tag){case 5:ia=je.stateNode,Wa=!1;break e;case 3:ia=je.stateNode.containerInfo,Wa=!0;break e;case 4:ia=je.stateNode.containerInfo,Wa=!0;break e}je=je.return}if(ia===null)throw Error(t(160));Jp(Q,oe,U),ia=null,Wa=!1;var st=U.alternate;st!==null&&(st.return=null),U.return=null}catch(Vt){Ts(U,a,Vt)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)Zp(a,n),a=a.sibling}function Zp(n,a){var b=n.alternate,F=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if($a(a,n),al(n),F&4){try{ld(3,n,n.return),ih(3,n)}catch(bn){Ts(n,n.return,bn)}try{ld(5,n,n.return)}catch(bn){Ts(n,n.return,bn)}}break;case 1:$a(a,n),al(n),F&512&&b!==null&&uu(b,b.return);break;case 5:if($a(a,n),al(n),F&512&&b!==null&&uu(b,b.return),n.flags&32){var U=n.stateNode;try{it(U,"")}catch(bn){Ts(n,n.return,bn)}}if(F&4&&(U=n.stateNode,U!=null)){var Q=n.memoizedProps,oe=b!==null?b.memoizedProps:Q,je=n.type,st=n.updateQueue;if(n.updateQueue=null,st!==null)try{je==="input"&&Q.type==="radio"&&Q.name!=null&&Kt(U,Q),ar(je,oe);var Vt=ar(je,Q);for(oe=0;oe<st.length;oe+=2){var Ur=st[oe],$r=st[oe+1];Ur==="style"?re(U,$r):Ur==="dangerouslySetInnerHTML"?we(U,$r):Ur==="children"?it(U,$r):S(U,Ur,$r,Vt)}switch(je){case"input":Jt(U,Q);break;case"textarea":Mt(U,Q);break;case"select":var Gr=U._wrapperState.wasMultiple;U._wrapperState.wasMultiple=!!Q.multiple;var sn=Q.value;sn!=null?cr(U,!!Q.multiple,sn,!1):Gr!==!!Q.multiple&&(Q.defaultValue!=null?cr(U,!!Q.multiple,Q.defaultValue,!0):cr(U,!!Q.multiple,Q.multiple?[]:"",!1))}U[mc]=Q}catch(bn){Ts(n,n.return,bn)}}break;case 6:if($a(a,n),al(n),F&4){if(n.stateNode===null)throw Error(t(162));U=n.stateNode,Q=n.memoizedProps;try{U.nodeValue=Q}catch(bn){Ts(n,n.return,bn)}}break;case 3:if($a(a,n),al(n),F&4&&b!==null&&b.memoizedState.isDehydrated)try{ic(a.containerInfo)}catch(bn){Ts(n,n.return,bn)}break;case 4:$a(a,n),al(n);break;case 13:$a(a,n),al(n),U=n.child,U.flags&8192&&(Q=U.memoizedState!==null,U.stateNode.isHidden=Q,!Q||U.alternate!==null&&U.alternate.memoizedState!==null||(If=hi())),F&4&&Qp(n);break;case 22:if(Ur=b!==null&&b.memoizedState!==null,n.mode&1?(ha=(Vt=ha)||Ur,$a(a,n),ha=Vt):$a(a,n),al(n),F&8192){if(Vt=n.memoizedState!==null,(n.stateNode.isHidden=Vt)&&!Ur&&(n.mode&1)!==0)for(on=n,Ur=n.child;Ur!==null;){for($r=on=Ur;on!==null;){switch(Gr=on,sn=Gr.child,Gr.tag){case 0:case 11:case 14:case 15:ld(4,Gr,Gr.return);break;case 1:uu(Gr,Gr.return);var an=Gr.stateNode;if(typeof an.componentWillUnmount=="function"){F=Gr,b=Gr.return;try{a=F,an.props=a.memoizedProps,an.state=a.memoizedState,an.componentWillUnmount()}catch(bn){Ts(F,b,bn)}}break;case 5:uu(Gr,Gr.return);break;case 22:if(Gr.memoizedState!==null){tm($r);continue}}sn!==null?(sn.return=Gr,on=sn):tm($r)}Ur=Ur.sibling}e:for(Ur=null,$r=n;;){if($r.tag===5){if(Ur===null){Ur=$r;try{U=$r.stateNode,Vt?(Q=U.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none"):(je=$r.stateNode,st=$r.memoizedProps.style,oe=st!=null&&st.hasOwnProperty("display")?st.display:null,je.style.display=Ft("display",oe))}catch(bn){Ts(n,n.return,bn)}}}else if($r.tag===6){if(Ur===null)try{$r.stateNode.nodeValue=Vt?"":$r.memoizedProps}catch(bn){Ts(n,n.return,bn)}}else if(($r.tag!==22&&$r.tag!==23||$r.memoizedState===null||$r===n)&&$r.child!==null){$r.child.return=$r,$r=$r.child;continue}if($r===n)break e;for(;$r.sibling===null;){if($r.return===null||$r.return===n)break e;Ur===$r&&(Ur=null),$r=$r.return}Ur===$r&&(Ur=null),$r.sibling.return=$r.return,$r=$r.sibling}}break;case 19:$a(a,n),al(n),F&4&&Qp(n);break;case 21:break;default:$a(a,n),al(n)}}function al(n){var a=n.flags;if(a&2){try{e:{for(var b=n.return;b!==null;){if(qp(b)){var F=b;break e}b=b.return}throw Error(t(160))}switch(F.tag){case 5:var U=F.stateNode;F.flags&32&&(it(U,""),F.flags&=-33);var Q=Xp(n);Mf(n,Q,U);break;case 3:case 4:var oe=F.stateNode.containerInfo,je=Xp(n);Tf(n,je,oe);break;default:throw Error(t(161))}}catch(st){Ts(n,n.return,st)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function Im(n,a,b){on=n,Kp(n)}function Kp(n,a,b){for(var F=(n.mode&1)!==0;on!==null;){var U=on,Q=U.child;if(U.tag===22&&F){var oe=U.memoizedState!==null||nh;if(!oe){var je=U.alternate,st=je!==null&&je.memoizedState!==null||ha;je=nh;var Vt=ha;if(nh=oe,(ha=st)&&!Vt)for(on=U;on!==null;)oe=on,st=oe.child,oe.tag===22&&oe.memoizedState!==null?rm(U):st!==null?(st.return=oe,on=st):rm(U);for(;Q!==null;)on=Q,Kp(Q),Q=Q.sibling;on=U,nh=je,ha=Vt}em(n)}else(U.subtreeFlags&8772)!==0&&Q!==null?(Q.return=U,on=Q):em(n)}}function em(n){for(;on!==null;){var a=on;if((a.flags&8772)!==0){var b=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:ha||ih(5,a);break;case 1:var F=a.stateNode;if(a.flags&4&&!ha)if(b===null)F.componentDidMount();else{var U=a.elementType===a.type?b.memoizedProps:ca(a.type,b.memoizedProps);F.componentDidUpdate(U,b.memoizedState,F.__reactInternalSnapshotBeforeUpdate)}var Q=a.updateQueue;Q!==null&&Qf(a,Q,F);break;case 3:var oe=a.updateQueue;if(oe!==null){if(b=null,a.child!==null)switch(a.child.tag){case 5:b=a.child.stateNode;break;case 1:b=a.child.stateNode}Qf(a,oe,b)}break;case 5:var je=a.stateNode;if(b===null&&a.flags&4){b=je;var st=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":st.autoFocus&&b.focus();break;case"img":st.src&&(b.src=st.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var Vt=a.alternate;if(Vt!==null){var Ur=Vt.memoizedState;if(Ur!==null){var $r=Ur.dehydrated;$r!==null&&ic($r)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ha||a.flags&512&&kf(a)}catch(Gr){Ts(a,a.return,Gr)}}if(a===n){on=null;break}if(b=a.sibling,b!==null){b.return=a.return,on=b;break}on=a.return}}function tm(n){for(;on!==null;){var a=on;if(a===n){on=null;break}var b=a.sibling;if(b!==null){b.return=a.return,on=b;break}on=a.return}}function rm(n){for(;on!==null;){var a=on;try{switch(a.tag){case 0:case 11:case 15:var b=a.return;try{ih(4,a)}catch(st){Ts(a,b,st)}break;case 1:var F=a.stateNode;if(typeof F.componentDidMount=="function"){var U=a.return;try{F.componentDidMount()}catch(st){Ts(a,U,st)}}var Q=a.return;try{kf(a)}catch(st){Ts(a,Q,st)}break;case 5:var oe=a.return;try{kf(a)}catch(st){Ts(a,oe,st)}}}catch(st){Ts(a,a.return,st)}if(a===n){on=null;break}var je=a.sibling;if(je!==null){je.return=a.return,on=je;break}on=a.return}}var Pm=Math.ceil,sh=C.ReactCurrentDispatcher,Nf=C.ReactCurrentOwner,Oa=C.ReactCurrentBatchConfig,si=0,ea=null,Vs=null,sa=0,Ma=0,du=rl(0),qs=0,cd=null,Ec=0,oh=0,zf=0,ud=null,Ea=null,If=0,hu=1/0,kl=null,ah=!1,Pf=null,Jl=null,lh=!1,Ql=null,ch=0,dd=0,Df=null,uh=-1,dh=0;function xa(){return(si&6)!==0?hi():uh!==-1?uh:uh=hi()}function Zl(n){return(n.mode&1)===0?1:(si&2)!==0&&sa!==0?sa&-sa:iu.transition!==null?(dh===0&&(dh=Xa()),dh):(n=Dn,n!==0||(n=window.event,n=n===void 0?16:gd(n.type)),n)}function Ha(n,a,b,F){if(50<dd)throw dd=0,Df=null,Error(t(185));_a(n,b,F),((si&2)===0||n!==ea)&&(n===ea&&((si&2)===0&&(oh|=b),qs===4&&Kl(n,sa)),Sa(n,F),b===1&&si===0&&(a.mode&1)===0&&(hu=hi()+500,ru&&be()))}function Sa(n,a){var b=n.callbackNode;Ml(n,a);var F=Ba(n,n===ea?sa:0);if(F===0)b!==null&&cl(b),n.callbackNode=null,n.callbackPriority=0;else if(a=F&-F,n.callbackPriority!==a){if(b!=null&&cl(b),a===1)n.tag===0?O(im.bind(null,n)):K(im.bind(null,n)),Yh(function(){(si&6)===0&&be()}),b=null;else{switch(oa(F)){case 1:b=ja;break;case 4:b=kc;break;case 16:b=Ln;break;case 536870912:b=pa;break;default:b=Ln}b=hm(b,nm.bind(null,n))}n.callbackPriority=a,n.callbackNode=b}}function nm(n,a){if(uh=-1,dh=0,(si&6)!==0)throw Error(t(327));var b=n.callbackNode;if(fu()&&n.callbackNode!==b)return null;var F=Ba(n,n===ea?sa:0);if(F===0)return null;if((F&30)!==0||(F&n.expiredLanes)!==0||a)a=hh(n,F);else{a=F;var U=si;si|=2;var Q=om();(ea!==n||sa!==a)&&(kl=null,hu=hi()+500,Cc(n,a));do try{Om();break}catch(je){sm(n,je)}while(!0);Zh(),sh.current=Q,si=U,Vs!==null?a=0:(ea=null,sa=0,a=qs)}if(a!==0){if(a===2&&(U=yu(n),U!==0&&(F=U,a=Ff(n,U))),a===1)throw b=cd,Cc(n,0),Kl(n,F),Sa(n,hi()),b;if(a===6)Kl(n,F);else{if(U=n.current.alternate,(F&30)===0&&!Dm(U)&&(a=hh(n,F),a===2&&(Q=yu(n),Q!==0&&(F=Q,a=Ff(n,Q))),a===1))throw b=cd,Cc(n,0),Kl(n,F),Sa(n,hi()),b;switch(n.finishedWork=U,n.finishedLanes=F,a){case 0:case 1:throw Error(t(345));case 2:Ac(n,Ea,kl);break;case 3:if(Kl(n,F),(F&130023424)===F&&(a=If+500-hi(),10<a)){if(Ba(n,0)!==0)break;if(U=n.suspendedLanes,(U&F)!==F){xa(),n.pingedLanes|=n.suspendedLanes&U;break}n.timeoutHandle=Hu(Ac.bind(null,n,Ea,kl),a);break}Ac(n,Ea,kl);break;case 4:if(Kl(n,F),(F&4194240)===F)break;for(a=n.eventTimes,U=-1;0<F;){var oe=31-ma(F);Q=1<<oe,oe=a[oe],oe>U&&(U=oe),F&=~Q}if(F=U,F=hi()-F,F=(120>F?120:480>F?480:1080>F?1080:1920>F?1920:3e3>F?3e3:4320>F?4320:1960*Pm(F/1960))-F,10<F){n.timeoutHandle=Hu(Ac.bind(null,n,Ea,kl),F);break}Ac(n,Ea,kl);break;case 5:Ac(n,Ea,kl);break;default:throw Error(t(329))}}}return Sa(n,hi()),n.callbackNode===b?nm.bind(null,n):null}function Ff(n,a){var b=ud;return n.current.memoizedState.isDehydrated&&(Cc(n,a).flags|=256),n=hh(n,a),n!==2&&(a=Ea,Ea=b,a!==null&&Of(a)),n}function Of(n){Ea===null?Ea=n:Ea.push.apply(Ea,n)}function Dm(n){for(var a=n;;){if(a.flags&16384){var b=a.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var F=0;F<b.length;F++){var U=b[F],Q=U.getSnapshot;U=U.value;try{if(!Ls(Q(),U))return!1}catch{return!1}}}if(b=a.child,a.subtreeFlags&16384&&b!==null)b.return=a,a=b;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Kl(n,a){for(a&=~zf,a&=~oh,n.suspendedLanes|=a,n.pingedLanes&=~a,n=n.expirationTimes;0<a;){var b=31-ma(a),F=1<<b;n[b]=-1,a&=~F}}function im(n){if((si&6)!==0)throw Error(t(327));fu();var a=Ba(n,0);if((a&1)===0)return Sa(n,hi()),null;var b=hh(n,a);if(n.tag!==0&&b===2){var F=yu(n);F!==0&&(a=F,b=Ff(n,F))}if(b===1)throw b=cd,Cc(n,0),Kl(n,a),Sa(n,hi()),b;if(b===6)throw Error(t(345));return n.finishedWork=n.current.alternate,n.finishedLanes=a,Ac(n,Ea,kl),Sa(n,hi()),null}function Lf(n,a){var b=si;si|=1;try{return n(a)}finally{si=b,si===0&&(hu=hi()+500,ru&&be())}}function Sc(n){Ql!==null&&Ql.tag===0&&(si&6)===0&&fu();var a=si;si|=1;var b=Oa.transition,F=Dn;try{if(Oa.transition=null,Dn=1,n)return n()}finally{Dn=F,Oa.transition=b,si=a,(si&6)===0&&be()}}function jf(){Ma=du.current,gi(du)}function Cc(n,a){n.finishedWork=null,n.finishedLanes=0;var b=n.timeoutHandle;if(b!==-1&&(n.timeoutHandle=-1,Hh(b)),Vs!==null)for(b=Vs.return;b!==null;){var F=b;switch(ti(F),F.tag){case 1:F=F.type.childContextTypes,F!=null&&vc();break;case 3:lu(),gi(la),gi(Js),cf();break;case 5:af(F);break;case 4:lu();break;case 13:gi(ls);break;case 19:gi(ls);break;case 10:Kh(F.type._context);break;case 22:case 23:jf()}b=b.return}if(ea=n,Vs=n=ec(n.current,null),sa=Ma=a,qs=0,cd=null,zf=oh=Ec=0,Ea=ud=null,_c!==null){for(a=0;a<_c.length;a++)if(b=_c[a],F=b.interleaved,F!==null){b.interleaved=null;var U=F.next,Q=b.pending;if(Q!==null){var oe=Q.next;Q.next=U,F.next=oe}b.pending=F}_c=null}return n}function sm(n,a){do{var b=Vs;try{if(Zh(),Jd.current=eh,Qd){for(var F=Ss.memoizedState;F!==null;){var U=F.queue;U!==null&&(U.pending=null),F=F.next}Qd=!1}if(wc=0,Ks=Hs=Ss=null,rd=!1,nd=0,Nf.current=null,b===null||b.return===null){qs=1,cd=a,Vs=null;break}e:{var Q=n,oe=b.return,je=b,st=a;if(a=sa,je.flags|=32768,st!==null&&typeof st=="object"&&typeof st.then=="function"){var Vt=st,Ur=je,$r=Ur.tag;if((Ur.mode&1)===0&&($r===0||$r===11||$r===15)){var Gr=Ur.alternate;Gr?(Ur.updateQueue=Gr.updateQueue,Ur.memoizedState=Gr.memoizedState,Ur.lanes=Gr.lanes):(Ur.updateQueue=null,Ur.memoizedState=null)}var sn=Mp(oe);if(sn!==null){sn.flags&=-257,Np(sn,oe,je,Q,a),sn.mode&1&&Tp(Q,Vt,a),a=sn,st=Vt;var an=a.updateQueue;if(an===null){var bn=new Set;bn.add(st),a.updateQueue=bn}else an.add(st);break e}else{if((a&1)===0){Tp(Q,Vt,a),Bf();break e}st=Error(t(426))}}else if(Wr&&je.mode&1){var Gs=Mp(oe);if(Gs!==null){(Gs.flags&65536)===0&&(Gs.flags|=256),Np(Gs,oe,je,Q,a),nu(cu(st,je));break e}}Q=st=cu(st,je),qs!==4&&(qs=2),ud===null?ud=[Q]:ud.push(Q),Q=oe;do{switch(Q.tag){case 3:Q.flags|=65536,a&=-a,Q.lanes|=a;var Et=Rp(Q,st,a);Jf(Q,Et);break e;case 1:je=st;var ot=Q.type,Tt=Q.stateNode;if((Q.flags&128)===0&&(typeof ot.getDerivedStateFromError=="function"||Tt!==null&&typeof Tt.componentDidCatch=="function"&&(Jl===null||!Jl.has(Tt)))){Q.flags|=65536,a&=-a,Q.lanes|=a;var qr=kp(Q,je,a);Jf(Q,qr);break e}}Q=Q.return}while(Q!==null)}lm(b)}catch(wn){a=wn,Vs===b&&b!==null&&(Vs=b=b.return);continue}break}while(!0)}function om(){var n=sh.current;return sh.current=eh,n===null?eh:n}function Bf(){(qs===0||qs===3||qs===2)&&(qs=4),ea===null||(Ec&268435455)===0&&(oh&268435455)===0||Kl(ea,sa)}function hh(n,a){var b=si;si|=2;var F=om();(ea!==n||sa!==a)&&(kl=null,Cc(n,a));do try{Fm();break}catch(U){sm(n,U)}while(!0);if(Zh(),si=b,sh.current=F,Vs!==null)throw Error(t(261));return ea=null,sa=0,qs}function Fm(){for(;Vs!==null;)am(Vs)}function Om(){for(;Vs!==null&&!ul();)am(Vs)}function am(n){var a=dm(n.alternate,n,Ma);n.memoizedProps=n.pendingProps,a===null?lm(n):Vs=a,Nf.current=null}function lm(n){var a=n;do{var b=a.alternate;if(n=a.return,(a.flags&32768)===0){if(b=Tm(b,a,Ma),b!==null){Vs=b;return}}else{if(b=Mm(b,a),b!==null){b.flags&=32767,Vs=b;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{qs=6,Vs=null;return}}if(a=a.sibling,a!==null){Vs=a;return}Vs=a=n}while(a!==null);qs===0&&(qs=5)}function Ac(n,a,b){var F=Dn,U=Oa.transition;try{Oa.transition=null,Dn=1,Lm(n,a,b,F)}finally{Oa.transition=U,Dn=F}return null}function Lm(n,a,b,F){do fu();while(Ql!==null);if((si&6)!==0)throw Error(t(327));b=n.finishedWork;var U=n.finishedLanes;if(b===null)return null;if(n.finishedWork=null,n.finishedLanes=0,b===n.current)throw Error(t(177));n.callbackNode=null,n.callbackPriority=0;var Q=b.lanes|b.childLanes;if(bh(n,Q),n===ea&&(Vs=ea=null,sa=0),(b.subtreeFlags&2064)===0&&(b.flags&2064)===0||lh||(lh=!0,hm(Ln,function(){return fu(),null})),Q=(b.flags&15990)!==0,(b.subtreeFlags&15990)!==0||Q){Q=Oa.transition,Oa.transition=null;var oe=Dn;Dn=1;var je=si;si|=4,Nf.current=null,zm(n,b),Zp(b,n),Pd($u),zc=!!Wu,$u=Wu=null,n.current=b,Im(b),Ya(),si=je,Dn=oe,Oa.transition=Q}else n.current=b;if(lh&&(lh=!1,Ql=n,ch=U),Q=n.pendingLanes,Q===0&&(Jl=null),hl(b.stateNode),Sa(n,hi()),a!==null)for(F=n.onRecoverableError,b=0;b<a.length;b++)U=a[b],F(U.value,{componentStack:U.stack,digest:U.digest});if(ah)throw ah=!1,n=Pf,Pf=null,n;return(ch&1)!==0&&n.tag!==0&&fu(),Q=n.pendingLanes,(Q&1)!==0?n===Df?dd++:(dd=0,Df=n):dd=0,be(),null}function fu(){if(Ql!==null){var n=oa(ch),a=Oa.transition,b=Dn;try{if(Oa.transition=null,Dn=16>n?16:n,Ql===null)var F=!1;else{if(n=Ql,Ql=null,ch=0,(si&6)!==0)throw Error(t(331));var U=si;for(si|=4,on=n.current;on!==null;){var Q=on,oe=Q.child;if((on.flags&16)!==0){var je=Q.deletions;if(je!==null){for(var st=0;st<je.length;st++){var Vt=je[st];for(on=Vt;on!==null;){var Ur=on;switch(Ur.tag){case 0:case 11:case 15:ld(8,Ur,Q)}var $r=Ur.child;if($r!==null)$r.return=Ur,on=$r;else for(;on!==null;){Ur=on;var Gr=Ur.sibling,sn=Ur.return;if(Yp(Ur),Ur===Vt){on=null;break}if(Gr!==null){Gr.return=sn,on=Gr;break}on=sn}}}var an=Q.alternate;if(an!==null){var bn=an.child;if(bn!==null){an.child=null;do{var Gs=bn.sibling;bn.sibling=null,bn=Gs}while(bn!==null)}}on=Q}}if((Q.subtreeFlags&2064)!==0&&oe!==null)oe.return=Q,on=oe;else e:for(;on!==null;){if(Q=on,(Q.flags&2048)!==0)switch(Q.tag){case 0:case 11:case 15:ld(9,Q,Q.return)}var Et=Q.sibling;if(Et!==null){Et.return=Q.return,on=Et;break e}on=Q.return}}var ot=n.current;for(on=ot;on!==null;){oe=on;var Tt=oe.child;if((oe.subtreeFlags&2064)!==0&&Tt!==null)Tt.return=oe,on=Tt;else e:for(oe=ot;on!==null;){if(je=on,(je.flags&2048)!==0)try{switch(je.tag){case 0:case 11:case 15:ih(9,je)}}catch(wn){Ts(je,je.return,wn)}if(je===oe){on=null;break e}var qr=je.sibling;if(qr!==null){qr.return=je.return,on=qr;break e}on=je.return}}if(si=U,be(),Ws&&typeof Ws.onPostCommitFiberRoot=="function")try{Ws.onPostCommitFiberRoot(Tl,n)}catch{}F=!0}return F}finally{Dn=b,Oa.transition=a}}return!1}function cm(n,a,b){a=cu(b,a),a=Rp(n,a,1),n=ql(n,a,1),a=xa(),n!==null&&(_a(n,1,a),Sa(n,a))}function Ts(n,a,b){if(n.tag===3)cm(n,n,b);else for(;a!==null;){if(a.tag===3){cm(a,n,b);break}else if(a.tag===1){var F=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof F.componentDidCatch=="function"&&(Jl===null||!Jl.has(F))){n=cu(b,n),n=kp(a,n,1),a=ql(a,n,1),n=xa(),a!==null&&(_a(a,1,n),Sa(a,n));break}}a=a.return}}function jm(n,a,b){var F=n.pingCache;F!==null&&F.delete(a),a=xa(),n.pingedLanes|=n.suspendedLanes&b,ea===n&&(sa&b)===b&&(qs===4||qs===3&&(sa&130023424)===sa&&500>hi()-If?Cc(n,0):zf|=b),Sa(n,a)}function um(n,a){a===0&&((n.mode&1)===0?a=1:(a=qa,qa<<=1,(qa&130023424)===0&&(qa=4194304)));var b=xa();n=Cl(n,a),n!==null&&(_a(n,a,b),Sa(n,b))}function Bm(n){var a=n.memoizedState,b=0;a!==null&&(b=a.retryLane),um(n,b)}function Gm(n,a){var b=0;switch(n.tag){case 13:var F=n.stateNode,U=n.memoizedState;U!==null&&(b=U.retryLane);break;case 19:F=n.stateNode;break;default:throw Error(t(314))}F!==null&&F.delete(a),um(n,b)}var dm;dm=function(n,a,b){if(n!==null)if(n.memoizedProps!==a.pendingProps||la.current)wa=!0;else{if((n.lanes&b)===0&&(a.flags&128)===0)return wa=!1,km(n,a,b);wa=(n.flags&131072)!==0}else wa=!1,Wr&&(a.flags&1048576)!==0&&pi(a,ct,a.index);switch(a.lanes=0,a.tag){case 2:var F=a.type;rh(n,a),n=a.pendingProps;var U=Sl(a,Js.current);ou(a,b),U=hf(null,a,F,n,U,b);var Q=ff();return a.flags|=1,typeof U=="object"&&U!==null&&typeof U.render=="function"&&U.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,na(F)?(Q=!0,xc(a)):Q=!1,a.memoizedState=U.state!==null&&U.state!==void 0?U.state:null,rf(a),U.updater=Yd,a.stateNode=U,U._reactInternals=a,sf(a,F,n,b),a=bf(null,a,F,!0,Q,b)):(a.tag=0,Wr&&Q&&vi(a),va(null,a,U,b),a=a.child),a;case 16:F=a.elementType;e:{switch(rh(n,a),n=a.pendingProps,U=F._init,F=U(F._payload),a.type=F,U=a.tag=Vm(F),n=ca(F,n),U){case 0:a=_f(null,a,F,n,b);break e;case 1:a=Op(null,a,F,n,b);break e;case 11:a=zp(null,a,F,n,b);break e;case 14:a=Ip(null,a,F,ca(F.type,n),b);break e}throw Error(t(306,F,""))}return a;case 0:return F=a.type,U=a.pendingProps,U=a.elementType===F?U:ca(F,U),_f(n,a,F,U,b);case 1:return F=a.type,U=a.pendingProps,U=a.elementType===F?U:ca(F,U),Op(n,a,F,U,b);case 3:e:{if(Lp(a),n===null)throw Error(t(387));F=a.pendingProps,Q=a.memoizedState,U=Q.element,Xf(n,a),Hd(a,F,null,b);var oe=a.memoizedState;if(F=oe.element,Q.isDehydrated)if(Q={element:F,isDehydrated:!1,cache:oe.cache,pendingSuspenseBoundaries:oe.pendingSuspenseBoundaries,transitions:oe.transitions},a.updateQueue.baseState=Q,a.memoizedState=Q,a.flags&256){U=cu(Error(t(423)),a),a=jp(n,a,F,b,U);break e}else if(F!==U){U=cu(Error(t(424)),a),a=jp(n,a,F,b,U);break e}else for(En=Ia(a.stateNode.containerInfo.firstChild),Cn=a,Wr=!0,An=null,b=ip(a,null,F,b),a.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(ba(),F===U){a=Rl(n,a,b);break e}va(n,a,F,b)}a=a.child}return a;case 5:return sp(a),n===null&&li(a),F=a.type,U=a.pendingProps,Q=n!==null?n.memoizedProps:null,oe=U.children,ka(F,U)?oe=null:Q!==null&&ka(F,Q)&&(a.flags|=32),Fp(n,a),va(n,a,oe,b),a.child;case 6:return n===null&&li(a),null;case 13:return Bp(n,a,b);case 4:return of(a,a.stateNode.containerInfo),F=a.pendingProps,n===null?a.child=au(a,null,F,b):va(n,a,F,b),a.child;case 11:return F=a.type,U=a.pendingProps,U=a.elementType===F?U:ca(F,U),zp(n,a,F,U,b);case 7:return va(n,a,a.pendingProps,b),a.child;case 8:return va(n,a,a.pendingProps.children,b),a.child;case 12:return va(n,a,a.pendingProps.children,b),a.child;case 10:e:{if(F=a.type._context,U=a.pendingProps,Q=a.memoizedProps,oe=U.value,fi(Vd,F._currentValue),F._currentValue=oe,Q!==null)if(Ls(Q.value,oe)){if(Q.children===U.children&&!la.current){a=Rl(n,a,b);break e}}else for(Q=a.child,Q!==null&&(Q.return=a);Q!==null;){var je=Q.dependencies;if(je!==null){oe=Q.child;for(var st=je.firstContext;st!==null;){if(st.context===F){if(Q.tag===1){st=Al(-1,b&-b),st.tag=2;var Vt=Q.updateQueue;if(Vt!==null){Vt=Vt.shared;var Ur=Vt.pending;Ur===null?st.next=st:(st.next=Ur.next,Ur.next=st),Vt.pending=st}}Q.lanes|=b,st=Q.alternate,st!==null&&(st.lanes|=b),ef(Q.return,b,a),je.lanes|=b;break}st=st.next}}else if(Q.tag===10)oe=Q.type===a.type?null:Q.child;else if(Q.tag===18){if(oe=Q.return,oe===null)throw Error(t(341));oe.lanes|=b,je=oe.alternate,je!==null&&(je.lanes|=b),ef(oe,b,a),oe=Q.sibling}else oe=Q.child;if(oe!==null)oe.return=Q;else for(oe=Q;oe!==null;){if(oe===a){oe=null;break}if(Q=oe.sibling,Q!==null){Q.return=oe.return,oe=Q;break}oe=oe.return}Q=oe}va(n,a,U.children,b),a=a.child}return a;case 9:return U=a.type,F=a.pendingProps.children,ou(a,b),U=Da(U),F=F(U),a.flags|=1,va(n,a,F,b),a.child;case 14:return F=a.type,U=ca(F,a.pendingProps),U=ca(F.type,U),Ip(n,a,F,U,b);case 15:return Pp(n,a,a.type,a.pendingProps,b);case 17:return F=a.type,U=a.pendingProps,U=a.elementType===F?U:ca(F,U),rh(n,a),a.tag=1,na(F)?(n=!0,xc(a)):n=!1,ou(a,b),ep(a,F,U),sf(a,F,U,b),bf(null,a,F,!0,n,b);case 19:return Up(n,a,b);case 22:return Dp(n,a,b)}throw Error(t(156,a.tag))};function hm(n,a){return ll(n,a)}function Um(n,a,b,F){this.tag=n,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=F,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function La(n,a,b,F){return new Um(n,a,b,F)}function Gf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Vm(n){if(typeof n=="function")return Gf(n)?1:0;if(n!=null){if(n=n.$$typeof,n===X)return 11;if(n===H)return 14}return 2}function ec(n,a){var b=n.alternate;return b===null?(b=La(n.tag,a,n.key,n.mode),b.elementType=n.elementType,b.type=n.type,b.stateNode=n.stateNode,b.alternate=n,n.alternate=b):(b.pendingProps=a,b.type=n.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=n.flags&14680064,b.childLanes=n.childLanes,b.lanes=n.lanes,b.child=n.child,b.memoizedProps=n.memoizedProps,b.memoizedState=n.memoizedState,b.updateQueue=n.updateQueue,a=n.dependencies,b.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},b.sibling=n.sibling,b.index=n.index,b.ref=n.ref,b}function fh(n,a,b,F,U,Q){var oe=2;if(F=n,typeof n=="function")Gf(n)&&(oe=1);else if(typeof n=="string")oe=5;else e:switch(n){case R:return Rc(b.children,U,Q,a);case M:oe=8,U|=8;break;case P:return n=La(12,b,a,U|2),n.elementType=P,n.lanes=Q,n;case B:return n=La(13,b,a,U),n.elementType=B,n.lanes=Q,n;case j:return n=La(19,b,a,U),n.elementType=j,n.lanes=Q,n;case q:return ph(b,U,Q,a);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case D:oe=10;break e;case L:oe=9;break e;case X:oe=11;break e;case H:oe=14;break e;case $:oe=16,F=null;break e}throw Error(t(130,n==null?n:typeof n,""))}return a=La(oe,b,a,U),a.elementType=n,a.type=F,a.lanes=Q,a}function Rc(n,a,b,F){return n=La(7,n,F,a),n.lanes=b,n}function ph(n,a,b,F){return n=La(22,n,F,a),n.elementType=q,n.lanes=b,n.stateNode={isHidden:!1},n}function Uf(n,a,b){return n=La(6,n,null,a),n.lanes=b,n}function Vf(n,a,b){return a=La(4,n.children!==null?n.children:[],n.key,a),a.lanes=b,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}function Wm(n,a,b,F,U){this.tag=a,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tc(0),this.expirationTimes=Tc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tc(0),this.identifierPrefix=F,this.onRecoverableError=U,this.mutableSourceEagerHydrationData=null}function Wf(n,a,b,F,U,Q,oe,je,st){return n=new Wm(n,a,b,je,st),a===1?(a=1,Q===!0&&(a|=8)):a=0,Q=La(3,null,null,a),n.current=Q,Q.stateNode=n,Q.memoizedState={element:F,isDehydrated:b,cache:null,transitions:null,pendingSuspenseBoundaries:null},rf(Q),n}function $m(n,a,b){var F=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:x,key:F==null?null:""+F,children:n,containerInfo:a,implementation:b}}function fm(n){if(!n)return nl;n=n._reactInternals;e:{if(ei(n)!==n||n.tag!==1)throw Error(t(170));var a=n;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(na(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(n.tag===1){var b=n.type;if(na(b))return Ju(n,b,a)}return a}function pm(n,a,b,F,U,Q,oe,je,st){return n=Wf(b,F,!0,n,U,Q,oe,je,st),n.context=fm(null),b=n.current,F=xa(),U=Zl(b),Q=Al(F,U),Q.callback=a??null,ql(b,Q,U),n.current.lanes=U,_a(n,U,F),Sa(n,F),n}function mh(n,a,b,F){var U=a.current,Q=xa(),oe=Zl(U);return b=fm(b),a.context===null?a.context=b:a.pendingContext=b,a=Al(Q,oe),a.payload={element:n},F=F===void 0?null:F,F!==null&&(a.callback=F),n=ql(U,a,oe),n!==null&&(Ha(n,U,oe,Q),$d(n,U,oe)),oe}function gh(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function mm(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var b=n.retryLane;n.retryLane=b!==0&&b<a?b:a}}function $f(n,a){mm(n,a),(n=n.alternate)&&mm(n,a)}function Hm(){return null}var gm=typeof reportError=="function"?reportError:function(n){console.error(n)};function Hf(n){this._internalRoot=n}yh.prototype.render=Hf.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(t(409));mh(n,a,null,null)},yh.prototype.unmount=Hf.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;Sc(function(){mh(null,n,null,null)}),a[ya]=null}};function yh(n){this._internalRoot=n}yh.prototype.unstable_scheduleHydration=function(n){if(n){var a=vu();n={blockedOn:null,target:n,priority:a};for(var b=0;b<Za.length&&a!==0&&a<Za[b].priority;b++);Za.splice(b,0,n),b===0&&pd(n)}};function Yf(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function vh(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function ym(){}function Ym(n,a,b,F,U){if(U){if(typeof F=="function"){var Q=F;F=function(){var Vt=gh(oe);Q.call(Vt)}}var oe=pm(a,F,n,0,null,!1,!1,"",ym);return n._reactRootContainer=oe,n[ya]=oe.current,fc(n.nodeType===8?n.parentNode:n),Sc(),oe}for(;U=n.lastChild;)n.removeChild(U);if(typeof F=="function"){var je=F;F=function(){var Vt=gh(st);je.call(Vt)}}var st=Wf(n,0,!1,null,null,!1,!1,"",ym);return n._reactRootContainer=st,n[ya]=st.current,fc(n.nodeType===8?n.parentNode:n),Sc(function(){mh(a,st,b,F)}),st}function xh(n,a,b,F,U){var Q=b._reactRootContainer;if(Q){var oe=Q;if(typeof U=="function"){var je=U;U=function(){var st=gh(oe);je.call(st)}}mh(a,oe,n,U)}else oe=Ym(b,a,n,U,F);return gh(oe)}ii=function(n){switch(n.tag){case 3:var a=n.stateNode;if(a.current.memoizedState.isDehydrated){var b=Ns(a.pendingLanes);b!==0&&(za(a,b|1),Sa(a,hi()),(si&6)===0&&(hu=hi()+500,be()))}break;case 13:Sc(function(){var F=Cl(n,1);if(F!==null){var U=xa();Ha(F,n,1,U)}}),$f(n,1)}},pl=function(n){if(n.tag===13){var a=Cl(n,134217728);if(a!==null){var b=xa();Ha(a,n,134217728,b)}$f(n,134217728)}},Mc=function(n){if(n.tag===13){var a=Zl(n),b=Cl(n,a);if(b!==null){var F=xa();Ha(b,n,a,F)}$f(n,a)}},vu=function(){return Dn},ml=function(n,a){var b=Dn;try{return Dn=n,a()}finally{Dn=b}},se=function(n,a,b){switch(a){case"input":if(Jt(n,b),a=b.name,b.type==="radio"&&a!=null){for(b=n;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<b.length;a++){var F=b[a];if(F!==n&&F.form===n.form){var U=tu(F);if(!U)throw Error(t(90));Gt(F),Jt(F,U)}}}break;case"textarea":Mt(n,b);break;case"select":a=b.value,a!=null&&cr(n,!!b.multiple,a,!1)}},me=Lf,Ze=Sc;var qm={usingClientEntryPoint:!1,Events:[yc,$l,tu,ut,at,Lf]},hd={findFiberByHostInstance:El,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Xm={bundleType:hd.bundleType,version:hd.version,rendererPackageName:hd.rendererPackageName,rendererConfig:hd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Us(n),n===null?null:n.stateNode},findFiberByHostInstance:hd.findFiberByHostInstance||Hm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_h.isDisabled&&_h.supportsFiber)try{Tl=_h.inject(Xm),Ws=_h}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qm,reactDom_production_min.createPortal=function(n,a){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yf(a))throw Error(t(200));return $m(n,a,null,b)},reactDom_production_min.createRoot=function(n,a){if(!Yf(n))throw Error(t(299));var b=!1,F="",U=gm;return a!=null&&(a.unstable_strictMode===!0&&(b=!0),a.identifierPrefix!==void 0&&(F=a.identifierPrefix),a.onRecoverableError!==void 0&&(U=a.onRecoverableError)),a=Wf(n,1,!1,null,null,b,!1,F,U),n[ya]=a.current,fc(n.nodeType===8?n.parentNode:n),new Hf(a)},reactDom_production_min.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(t(188)):(n=Object.keys(n).join(","),Error(t(268,n)));return n=Us(a),n=n===null?null:n.stateNode,n},reactDom_production_min.flushSync=function(n){return Sc(n)},reactDom_production_min.hydrate=function(n,a,b){if(!vh(a))throw Error(t(200));return xh(null,n,a,!0,b)},reactDom_production_min.hydrateRoot=function(n,a,b){if(!Yf(n))throw Error(t(405));var F=b!=null&&b.hydratedSources||null,U=!1,Q="",oe=gm;if(b!=null&&(b.unstable_strictMode===!0&&(U=!0),b.identifierPrefix!==void 0&&(Q=b.identifierPrefix),b.onRecoverableError!==void 0&&(oe=b.onRecoverableError)),a=pm(a,null,n,1,b??null,U,!1,Q,oe),n[ya]=a.current,fc(n),F)for(n=0;n<F.length;n++)b=F[n],U=b._getVersion,U=U(b._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[b,U]:a.mutableSourceEagerHydrationData.push(b,U);return new yh(a)},reactDom_production_min.render=function(n,a,b){if(!vh(a))throw Error(t(200));return xh(null,n,a,!1,b)},reactDom_production_min.unmountComponentAtNode=function(n){if(!vh(n))throw Error(t(40));return n._reactRootContainer?(Sc(function(){xh(null,null,n,!1,function(){n._reactRootContainer=null,n[ya]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=Lf,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(n,a,b,F){if(!vh(b))throw Error(t(200));if(n==null||n._reactInternals===void 0)throw Error(t(38));return xh(n,a,b,!1,F)},reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var e=requireReactDom();return client.createRoot=e.createRoot,client.hydrateRoot=e.hydrateRoot,client}var clientExports=requireClient();const ReactDOM$1=getDefaultExportFromCjs(clientExports);/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createBrowserHistory(e={}){function r(o,c){let{pathname:u,search:v,hash:f}=o.location;return createLocation("",{pathname:u,search:v,hash:f},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function t(o,c){return typeof c=="string"?c:createPath(c)}return getUrlBasedHistory(r,t,null,e)}function invariant(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function warning(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(e,r){return{usr:e.state,key:e.key,idx:r}}function createLocation(e,r,t=null,o){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof r=="string"?parsePath(r):r,state:t,key:r&&r.key||o||createKey()}}function createPath({pathname:e="/",search:r="",hash:t=""}){return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function parsePath(e){let r={};if(e){let t=e.indexOf("#");t>=0&&(r.hash=e.substring(t),e=e.substring(0,t));let o=e.indexOf("?");o>=0&&(r.search=e.substring(o),e=e.substring(0,o)),e&&(r.pathname=e)}return r}function getUrlBasedHistory(e,r,t,o={}){let{window:c=document.defaultView,v5Compat:u=!1}=o,v=c.history,f="POP",g=null,_=p();_==null&&(_=0,v.replaceState({...v.state,idx:_},""));function p(){return(v.state||{idx:null}).idx}function E(){f="POP";let s=p(),y=s==null?null:s-_;_=s,g&&g({action:f,location:l.location,delta:y})}function k(s,y){f="PUSH";let w=createLocation(l.location,s,y);_=p()+1;let S=getHistoryState(w,_),C=l.createHref(w);try{v.pushState(S,"",C)}catch(h){if(h instanceof DOMException&&h.name==="DataCloneError")throw h;c.location.assign(C)}u&&g&&g({action:f,location:l.location,delta:1})}function A(s,y){f="REPLACE";let w=createLocation(l.location,s,y);_=p();let S=getHistoryState(w,_),C=l.createHref(w);v.replaceState(S,"",C),u&&g&&g({action:f,location:l.location,delta:0})}function z(s){return createBrowserURLImpl(s)}let l={get action(){return f},get location(){return e(c,v)},listen(s){if(g)throw new Error("A history only accepts one active listener");return c.addEventListener(PopStateEventType,E),g=s,()=>{c.removeEventListener(PopStateEventType,E),g=null}},createHref(s){return r(c,s)},createURL:z,encodeLocation(s){let y=z(s);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:k,replace:A,go(s){return v.go(s)}};return l}function createBrowserURLImpl(e,r=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),invariant(t,"No window.location.(origin|href) available to create URL");let o=typeof e=="string"?e:createPath(e);return o=o.replace(/ $/,"%20"),!r&&o.startsWith("//")&&(o=t+o),new URL(o,t)}function matchRoutes(e,r,t="/"){return matchRoutesImpl(e,r,t,!1)}function matchRoutesImpl(e,r,t,o){let c=typeof r=="string"?parsePath(r):r,u=stripBasename(c.pathname||"/",t);if(u==null)return null;let v=flattenRoutes(e);rankRouteBranches(v);let f=null;for(let g=0;f==null&&g<v.length;++g){let _=decodePath(u);f=matchRouteBranch(v[g],_,o)}return f}function flattenRoutes(e,r=[],t=[],o="",c=!1){let u=(v,f,g=c,_)=>{let p={relativePath:_===void 0?v.path||"":_,caseSensitive:v.caseSensitive===!0,childrenIndex:f,route:v};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(o)&&g)return;invariant(p.relativePath.startsWith(o),`Absolute route path "${p.relativePath}" nested under path "${o}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(o.length)}let E=joinPaths([o,p.relativePath]),k=t.concat(p);v.children&&v.children.length>0&&(invariant(v.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${E}".`),flattenRoutes(v.children,r,k,E,g)),!(v.path==null&&!v.index)&&r.push({path:E,score:computeScore(E,v.index),routesMeta:k})};return e.forEach((v,f)=>{if(v.path===""||!v.path?.includes("?"))u(v,f);else for(let g of explodeOptionalSegments(v.path))u(v,f,!0,g)}),r}function explodeOptionalSegments(e){let r=e.split("/");if(r.length===0)return[];let[t,...o]=r,c=t.endsWith("?"),u=t.replace(/\?$/,"");if(o.length===0)return c?[u,""]:[u];let v=explodeOptionalSegments(o.join("/")),f=[];return f.push(...v.map(g=>g===""?u:[u,g].join("/"))),c&&f.push(...v),f.map(g=>e.startsWith("/")&&g===""?"/":g)}function rankRouteBranches(e){e.sort((r,t)=>r.score!==t.score?t.score-r.score:compareIndexes(r.routesMeta.map(o=>o.childrenIndex),t.routesMeta.map(o=>o.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,r){let t=e.split("/"),o=t.length;return t.some(isSplat)&&(o+=splatPenalty),r&&(o+=indexRouteValue),t.filter(c=>!isSplat(c)).reduce((c,u)=>c+(paramRe.test(u)?dynamicSegmentValue:u===""?emptySegmentValue:staticSegmentValue),o)}function compareIndexes(e,r){return e.length===r.length&&e.slice(0,-1).every((o,c)=>o===r[c])?e[e.length-1]-r[r.length-1]:0}function matchRouteBranch(e,r,t=!1){let{routesMeta:o}=e,c={},u="/",v=[];for(let f=0;f<o.length;++f){let g=o[f],_=f===o.length-1,p=u==="/"?r:r.slice(u.length)||"/",E=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:_},p),k=g.route;if(!E&&_&&t&&!o[o.length-1].route.index&&(E=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},p)),!E)return null;Object.assign(c,E.params),v.push({params:c,pathname:joinPaths([u,E.pathname]),pathnameBase:normalizePathname(joinPaths([u,E.pathnameBase])),route:k}),E.pathnameBase!=="/"&&(u=joinPaths([u,E.pathnameBase]))}return v}function matchPath(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,o]=compilePath(e.path,e.caseSensitive,e.end),c=r.match(t);if(!c)return null;let u=c[0],v=u.replace(/(.)\/+$/,"$1"),f=c.slice(1);return{params:o.reduce((_,{paramName:p,isOptional:E},k)=>{if(p==="*"){let z=f[k]||"";v=u.slice(0,u.length-z.length).replace(/(.)\/+$/,"$1")}const A=f[k];return E&&!A?_[p]=void 0:_[p]=(A||"").replace(/%2F/g,"/"),_},{}),pathname:u,pathnameBase:v,pattern:e}}function compilePath(e,r=!1,t=!0){warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let o=[],c="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(v,f,g)=>(o.push({paramName:f,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(o.push({paramName:"*"}),c+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?c+="\\/*$":e!==""&&e!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,r?void 0:"i"),o]}function decodePath(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return warning(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),e}}function stripBasename(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let t=r.endsWith("/")?r.length-1:r.length,o=e.charAt(t);return o&&o!=="/"?null:e.slice(t)||"/"}function resolvePath(e,r="/"){let{pathname:t,search:o="",hash:c=""}=typeof e=="string"?parsePath(e):e;return{pathname:t?t.startsWith("/")?t:resolvePathname(t,r):r,search:normalizeSearch(o),hash:normalizeHash(c)}}function resolvePathname(e,r){let t=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(c=>{c===".."?t.length>1&&t.pop():c!=="."&&t.push(c)}),t.length>1?t.join("/"):"/"}function getInvalidPathError(e,r,t,o){return`Cannot include a '${e}' character in a manually specified \`to.${r}\` field [${JSON.stringify(o)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(e){return e.filter((r,t)=>t===0||r.route.path&&r.route.path.length>0)}function getResolveToMatches(e){let r=getPathContributingMatches(e);return r.map((t,o)=>o===r.length-1?t.pathname:t.pathnameBase)}function resolveTo(e,r,t,o=!1){let c;typeof e=="string"?c=parsePath(e):(c={...e},invariant(!c.pathname||!c.pathname.includes("?"),getInvalidPathError("?","pathname","search",c)),invariant(!c.pathname||!c.pathname.includes("#"),getInvalidPathError("#","pathname","hash",c)),invariant(!c.search||!c.search.includes("#"),getInvalidPathError("#","search","hash",c)));let u=e===""||c.pathname==="",v=u?"/":c.pathname,f;if(v==null)f=t;else{let E=r.length-1;if(!o&&v.startsWith("..")){let k=v.split("/");for(;k[0]==="..";)k.shift(),E-=1;c.pathname=k.join("/")}f=E>=0?r[E]:"/"}let g=resolvePath(c,f),_=v&&v!=="/"&&v.endsWith("/"),p=(u||v===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(_||p)&&(g.pathname+="/"),g}var joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";reactExports.createContext(!1);var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(e,{relative:r}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:o}=reactExports.useContext(NavigationContext),{hash:c,pathname:u,search:v}=useResolvedPath(e,{relative:r}),f=u;return t!=="/"&&(f=u==="/"?t:joinPaths([t,u])),o.createHref({pathname:f,search:v,hash:c})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(e){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let e=reactExports.useContext(DataRouterContext),{basename:r,navigator:t}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),u=JSON.stringify(getResolveToMatches(o)),v=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{v.current=!0}),reactExports.useCallback((g,_={})=>{if(warning(v.current,navigateEffectWarning),!v.current)return;if(typeof g=="number"){t.go(g);return}let p=resolveTo(g,JSON.parse(u),c,_.relative==="path");e==null&&r!=="/"&&(p.pathname=p.pathname==="/"?r:joinPaths([r,p.pathname])),(_.replace?t.replace:t.push)(p,_.state,_)},[r,t,u,c,e])}reactExports.createContext(null);function useResolvedPath(e,{relative:r}={}){let{matches:t}=reactExports.useContext(RouteContext),{pathname:o}=useLocation(),c=JSON.stringify(getResolveToMatches(t));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(c),o,r==="path"),[e,c,o,r])}function useRoutesImpl(e,r,t,o,c){invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=reactExports.useContext(NavigationContext),{matches:v}=reactExports.useContext(RouteContext),f=v[v.length-1],g=f?f.params:{},_=f?f.pathname:"/",p=f?f.pathnameBase:"/",E=f&&f.route;{let w=E&&E.path||"";warningOnce(_,!E||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${_}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let k=useLocation(),A;A=k;let z=A.pathname||"/",l=z;if(p!=="/"){let w=p.replace(/^\//,"").split("/");l="/"+z.replace(/^\//,"").split("/").slice(w.length).join("/")}let s=matchRoutes(e,{pathname:l});return warning(E||s!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),warning(s==null||s[s.length-1].route.element!==void 0||s[s.length-1].route.Component!==void 0||s[s.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),_renderMatches(s&&s.map(w=>Object.assign({},w,{params:Object.assign({},g,w.params),pathname:joinPaths([p,u.encodeLocation?u.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?p:joinPaths([p,u.encodeLocation?u.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),v,t,o,c)}function DefaultErrorComponent(){let e=useRouteError(),r=isRouteErrorResponse(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,o="rgba(200,200,200, 0.5)",c={padding:"0.5rem",backgroundColor:o},u={padding:"2px 4px",backgroundColor:o},v=null;return console.error("Error handled by React Router default ErrorBoundary:",e),v=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null,"💿 Hey developer 👋"),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:u},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:u},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},r),t?reactExports.createElement("pre",{style:c},t):null,v)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){this.props.unstable_onError?this.props.unstable_onError(e,r):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:e,match:r,children:t}){let o=reactExports.useContext(DataRouterContext);return o&&o.static&&o.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=r.route.id),reactExports.createElement(RouteContext.Provider,{value:e},t)}function _renderMatches(e,r=[],t=null,o=null,c=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(r.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let u=e,v=t?.errors;if(v!=null){let _=u.findIndex(p=>p.route.id&&v?.[p.route.id]!==void 0);invariant(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(v).join(",")}`),u=u.slice(0,Math.min(u.length,_+1))}let f=!1,g=-1;if(t)for(let _=0;_<u.length;_++){let p=u[_];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(g=_),p.route.id){let{loaderData:E,errors:k}=t,A=p.route.loader&&!E.hasOwnProperty(p.route.id)&&(!k||k[p.route.id]===void 0);if(p.route.lazy||A){f=!0,g>=0?u=u.slice(0,g+1):u=[u[0]];break}}}return u.reduceRight((_,p,E)=>{let k,A=!1,z=null,l=null;t&&(k=v&&p.route.id?v[p.route.id]:void 0,z=p.route.errorElement||defaultErrorElement,f&&(g<0&&E===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,l=null):g===E&&(A=!0,l=p.route.hydrateFallbackElement||null)));let s=r.concat(u.slice(0,E+1)),y=()=>{let w;return k?w=z:A?w=l:p.route.Component?w=reactExports.createElement(p.route.Component,null):p.route.element?w=p.route.element:w=_,reactExports.createElement(RenderedRoute,{match:p,routeContext:{outlet:_,matches:s,isDataRoute:t!=null},children:w})};return t&&(p.route.ErrorBoundary||p.route.errorElement||E===0)?reactExports.createElement(RenderErrorBoundary,{location:t.location,revalidation:t.revalidation,component:z,error:k,children:y(),routeContext:{outlet:null,matches:s,isDataRoute:!0},unstable_onError:o}):y()},null)}function getDataRouterConsoleError(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(e){let r=reactExports.useContext(DataRouterContext);return invariant(r,getDataRouterConsoleError(e)),r}function useDataRouterState(e){let r=reactExports.useContext(DataRouterStateContext);return invariant(r,getDataRouterConsoleError(e)),r}function useRouteContext(e){let r=reactExports.useContext(RouteContext);return invariant(r,getDataRouterConsoleError(e)),r}function useCurrentRouteId(e){let r=useRouteContext(e),t=r.matches[r.matches.length-1];return invariant(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){let e=reactExports.useContext(RouteErrorContext),r=useDataRouterState("useRouteError"),t=useCurrentRouteId("useRouteError");return e!==void 0?e:r.errors?.[t]}function useNavigateStable(){let{router:e}=useDataRouterContext("useNavigate"),r=useCurrentRouteId("useNavigate"),t=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{t.current=!0}),reactExports.useCallback(async(c,u={})=>{warning(t.current,navigateEffectWarning),t.current&&(typeof c=="number"?e.navigate(c):await e.navigate(c,{fromRouteId:r,...u}))},[e,r])}var alreadyWarned={};function warningOnce(e,r,t){!r&&!alreadyWarned[e]&&(alreadyWarned[e]=!0,warning(!1,t))}reactExports.memo(DataRoutes);function DataRoutes({routes:e,future:r,state:t,unstable_onError:o}){return useRoutesImpl(e,void 0,t,o,r)}function Router({basename:e="/",children:r=null,location:t,navigationType:o="POP",navigator:c,static:u=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let v=e.replace(/^\/*/,"/"),f=reactExports.useMemo(()=>({basename:v,navigator:c,static:u,future:{}}),[v,c,u]);typeof t=="string"&&(t=parsePath(t));let{pathname:g="/",search:_="",hash:p="",state:E=null,key:k="default"}=t,A=reactExports.useMemo(()=>{let z=stripBasename(g,v);return z==null?null:{location:{pathname:z,search:_,hash:p,state:E,key:k},navigationType:o}},[v,g,_,p,E,k,o]);return warning(A!=null,`<Router basename="${v}"> is not able to match the URL "${g}${_}${p}" because it does not start with the basename, so the <Router> won't render anything.`),A==null?null:reactExports.createElement(NavigationContext.Provider,{value:f},reactExports.createElement(LocationContext.Provider,{children:r,value:A}))}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(e){return e!=null&&typeof e.tagName=="string"}function isButtonElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="button"}function isFormElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="form"}function isInputElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="input"}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,r){return e.button===0&&(!r||r==="_self")&&!isModifiedEvent(e)}function createSearchParams(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((r,t)=>{let o=e[t];return r.concat(Array.isArray(o)?o.map(c=>[t,c]):[[t,o]])},[]))}function getSearchParamsForLocation(e,r){let t=createSearchParams(e);return r&&r.forEach((o,c)=>{t.has(c)||r.getAll(c).forEach(u=>{t.append(c,u)})}),t}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(e){return e!=null&&!supportedFormEncTypes.has(e)?(warning(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):e}function getFormSubmissionInfo(e,r){let t,o,c,u,v;if(isFormElement(e)){let f=e.getAttribute("action");o=f?stripBasename(f,r):null,t=e.getAttribute("method")||defaultMethod,c=getFormEncType(e.getAttribute("enctype"))||defaultEncType,u=new FormData(e)}else if(isButtonElement(e)||isInputElement(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=e.getAttribute("formaction")||f.getAttribute("action");if(o=g?stripBasename(g,r):null,t=e.getAttribute("formmethod")||f.getAttribute("method")||defaultMethod,c=getFormEncType(e.getAttribute("formenctype"))||getFormEncType(f.getAttribute("enctype"))||defaultEncType,u=new FormData(f,e),!isFormDataSubmitterSupported()){let{name:_,type:p,value:E}=e;if(p==="image"){let k=_?`${_}.`:"";u.append(`${k}x`,"0"),u.append(`${k}y`,"0")}else _&&u.append(_,E)}}else{if(isHtmlElement(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=defaultMethod,o=null,c=defaultEncType,v=e}return u&&c==="text/plain"&&(v=u,u=void 0),{action:o,method:t.toLowerCase(),encType:c,formData:u,body:v}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function invariant2(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function singleFetchUrl(e,r,t){let o=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return o.pathname==="/"?o.pathname=`_root.${t}`:r&&stripBasename(o.pathname,r)==="/"?o.pathname=`${r.replace(/\/$/,"")}/_root.${t}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${t}`,o}async function loadRouteModule(e,r){if(e.id in r)return r[e.id];try{let t=await import(e.module);return r[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function getKeyedPrefetchLinks(e,r,t){let o=await Promise.all(e.map(async c=>{let u=r.routes[c.route.id];if(u){let v=await loadRouteModule(u,t);return v.links?v.links():[]}return[]}));return dedupeLinkDescriptors(o.flat(1).filter(isHtmlLinkDescriptor).filter(c=>c.rel==="stylesheet"||c.rel==="preload").map(c=>c.rel==="stylesheet"?{...c,rel:"prefetch",as:"style"}:{...c,rel:"prefetch"}))}function getNewMatchesForLinks(e,r,t,o,c,u){let v=(g,_)=>t[_]?g.route.id!==t[_].route.id:!0,f=(g,_)=>t[_].pathname!==g.pathname||t[_].route.path?.endsWith("*")&&t[_].params["*"]!==g.params["*"];return u==="assets"?r.filter((g,_)=>v(g,_)||f(g,_)):u==="data"?r.filter((g,_)=>{let p=o.routes[g.route.id];if(!p||!p.hasLoader)return!1;if(v(g,_)||f(g,_))return!0;if(g.route.shouldRevalidate){let E=g.route.shouldRevalidate({currentUrl:new URL(c.pathname+c.search+c.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof E=="boolean")return E}return!0}):[]}function getModuleLinkHrefs(e,r,{includeHydrateFallback:t}={}){return dedupeHrefs(e.map(o=>{let c=r.routes[o.route.id];if(!c)return[];let u=[c.module];return c.clientActionModule&&(u=u.concat(c.clientActionModule)),c.clientLoaderModule&&(u=u.concat(c.clientLoaderModule)),t&&c.hydrateFallbackModule&&(u=u.concat(c.hydrateFallbackModule)),c.imports&&(u=u.concat(c.imports)),u}).flat(1))}function dedupeHrefs(e){return[...new Set(e)]}function sortKeys(e){let r={},t=Object.keys(e).sort();for(let o of t)r[o]=e[o];return r}function dedupeLinkDescriptors(e,r){let t=new Set;return new Set(r),e.reduce((o,c)=>{let u=JSON.stringify(sortKeys(c));return t.has(u)||(t.add(u),o.push({key:u,link:c})),o},[])}function useDataRouterContext2(){let e=reactExports.useContext(DataRouterContext);return invariant2(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function useDataRouterStateContext(){let e=reactExports.useContext(DataRouterStateContext);return invariant2(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let e=reactExports.useContext(FrameworkContext);return invariant2(e,"You must render this element inside a <HydratedRouter> element"),e}function usePrefetchBehavior(e,r){let t=reactExports.useContext(FrameworkContext),[o,c]=reactExports.useState(!1),[u,v]=reactExports.useState(!1),{onFocus:f,onBlur:g,onMouseEnter:_,onMouseLeave:p,onTouchStart:E}=r,k=reactExports.useRef(null);reactExports.useEffect(()=>{if(e==="render"&&v(!0),e==="viewport"){let l=y=>{y.forEach(w=>{v(w.isIntersecting)})},s=new IntersectionObserver(l,{threshold:.5});return k.current&&s.observe(k.current),()=>{s.disconnect()}}},[e]),reactExports.useEffect(()=>{if(o){let l=setTimeout(()=>{v(!0)},100);return()=>{clearTimeout(l)}}},[o]);let A=()=>{c(!0)},z=()=>{c(!1),v(!1)};return t?e!=="intent"?[u,k,{}]:[u,k,{onFocus:composeEventHandlers(f,A),onBlur:composeEventHandlers(g,z),onMouseEnter:composeEventHandlers(_,A),onMouseLeave:composeEventHandlers(p,z),onTouchStart:composeEventHandlers(E,A)}]:[!1,k,{}]}function composeEventHandlers(e,r){return t=>{e&&e(t),t.defaultPrevented||r(t)}}function PrefetchPageLinks({page:e,...r}){let{router:t}=useDataRouterContext2(),o=reactExports.useMemo(()=>matchRoutes(t.routes,e,t.basename),[t.routes,e,t.basename]);return o?reactExports.createElement(PrefetchPageLinksImpl,{page:e,matches:o,...r}):null}function useKeyedPrefetchLinks(e){let{manifest:r,routeModules:t}=useFrameworkContext(),[o,c]=reactExports.useState([]);return reactExports.useEffect(()=>{let u=!1;return getKeyedPrefetchLinks(e,r,t).then(v=>{u||c(v)}),()=>{u=!0}},[e,r,t]),o}function PrefetchPageLinksImpl({page:e,matches:r,...t}){let o=useLocation(),{manifest:c,routeModules:u}=useFrameworkContext(),{basename:v}=useDataRouterContext2(),{loaderData:f,matches:g}=useDataRouterStateContext(),_=reactExports.useMemo(()=>getNewMatchesForLinks(e,r,g,c,o,"data"),[e,r,g,c,o]),p=reactExports.useMemo(()=>getNewMatchesForLinks(e,r,g,c,o,"assets"),[e,r,g,c,o]),E=reactExports.useMemo(()=>{if(e===o.pathname+o.search+o.hash)return[];let z=new Set,l=!1;if(r.forEach(y=>{let w=c.routes[y.route.id];!w||!w.hasLoader||(!_.some(S=>S.route.id===y.route.id)&&y.route.id in f&&u[y.route.id]?.shouldRevalidate||w.hasClientLoader?l=!0:z.add(y.route.id))}),z.size===0)return[];let s=singleFetchUrl(e,v,"data");return l&&z.size>0&&s.searchParams.set("_routes",r.filter(y=>z.has(y.route.id)).map(y=>y.route.id).join(",")),[s.pathname+s.search]},[v,f,o,c,_,r,e,u]),k=reactExports.useMemo(()=>getModuleLinkHrefs(p,c),[p,c]),A=useKeyedPrefetchLinks(p);return reactExports.createElement(reactExports.Fragment,null,E.map(z=>reactExports.createElement("link",{key:z,rel:"prefetch",as:"fetch",href:z,...t})),k.map(z=>reactExports.createElement("link",{key:z,rel:"modulepreload",href:z,...t})),A.map(({key:z,link:l})=>reactExports.createElement("link",{key:z,nonce:t.nonce,...l})))}function mergeRefs(...e){return r=>{e.forEach(t=>{typeof t=="function"?t(r):t!=null&&(t.current=r)})}}var isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser&&(window.__reactRouterVersion="7.8.2")}catch{}function BrowserRouter({basename:e,children:r,window:t}){let o=reactExports.useRef();o.current==null&&(o.current=createBrowserHistory({window:t,v5Compat:!0}));let c=o.current,[u,v]=reactExports.useState({action:c.action,location:c.location}),f=reactExports.useCallback(g=>{reactExports.startTransition(()=>v(g))},[v]);return reactExports.useLayoutEffect(()=>c.listen(f),[c,f]),reactExports.createElement(Router,{basename:e,children:r,location:u.location,navigationType:u.action,navigator:c})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:r,discover:t="render",prefetch:o="none",relative:c,reloadDocument:u,replace:v,state:f,target:g,to:_,preventScrollReset:p,viewTransition:E,...k},A){let{basename:z}=reactExports.useContext(NavigationContext),l=typeof _=="string"&&ABSOLUTE_URL_REGEX2.test(_),s,y=!1;if(typeof _=="string"&&l&&(s=_,isBrowser))try{let P=new URL(window.location.href),D=_.startsWith("//")?new URL(P.protocol+_):new URL(_),L=stripBasename(D.pathname,z);D.origin===P.origin&&L!=null?_=L+D.search+D.hash:y=!0}catch{warning(!1,`<Link to="${_}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=useHref(_,{relative:c}),[S,C,h]=usePrefetchBehavior(o,k),x=useLinkClickHandler(_,{replace:v,state:f,target:g,preventScrollReset:p,relative:c,viewTransition:E});function R(P){r&&r(P),P.defaultPrevented||x(P)}let M=reactExports.createElement("a",{...k,...h,href:s||w,onClick:y||u?r:R,ref:mergeRefs(A,C),target:g,"data-discover":!l&&t==="render"?"true":void 0});return S&&!l?reactExports.createElement(reactExports.Fragment,null,M,reactExports.createElement(PrefetchPageLinks,{page:w})):M});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":r="page",caseSensitive:t=!1,className:o="",end:c=!1,style:u,to:v,viewTransition:f,children:g,..._},p){let E=useResolvedPath(v,{relative:_.relative}),k=useLocation(),A=reactExports.useContext(DataRouterStateContext),{navigator:z,basename:l}=reactExports.useContext(NavigationContext),s=A!=null&&useViewTransitionState(E)&&f===!0,y=z.encodeLocation?z.encodeLocation(E).pathname:E.pathname,w=k.pathname,S=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;t||(w=w.toLowerCase(),S=S?S.toLowerCase():null,y=y.toLowerCase()),S&&l&&(S=stripBasename(S,l)||S);const C=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let h=w===y||!c&&w.startsWith(y)&&w.charAt(C)==="/",x=S!=null&&(S===y||!c&&S.startsWith(y)&&S.charAt(y.length)==="/"),R={isActive:h,isPending:x,isTransitioning:s},M=h?r:void 0,P;typeof o=="function"?P=o(R):P=[o,h?"active":null,x?"pending":null,s?"transitioning":null].filter(Boolean).join(" ");let D=typeof u=="function"?u(R):u;return reactExports.createElement(Link,{..._,"aria-current":M,className:P,ref:p,style:D,to:v,viewTransition:f},typeof g=="function"?g(R):g)});NavLink.displayName="NavLink";var Form$2=reactExports.forwardRef(({discover:e="render",fetcherKey:r,navigate:t,reloadDocument:o,replace:c,state:u,method:v=defaultMethod,action:f,onSubmit:g,relative:_,preventScrollReset:p,viewTransition:E,...k},A)=>{let z=useSubmit(),l=useFormAction(f,{relative:_}),s=v.toLowerCase()==="get"?"get":"post",y=typeof f=="string"&&ABSOLUTE_URL_REGEX2.test(f),w=S=>{if(g&&g(S),S.defaultPrevented)return;S.preventDefault();let C=S.nativeEvent.submitter,h=C?.getAttribute("formmethod")||v;z(C||S.currentTarget,{fetcherKey:r,method:h,navigate:t,replace:c,state:u,relative:_,preventScrollReset:p,viewTransition:E})};return reactExports.createElement("form",{ref:A,method:s,action:l,onSubmit:o?g:w,...k,"data-discover":!y&&e==="render"?"true":void 0})});Form$2.displayName="Form";function getDataRouterConsoleError2(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(e){let r=reactExports.useContext(DataRouterContext);return invariant(r,getDataRouterConsoleError2(e)),r}function useLinkClickHandler(e,{target:r,replace:t,state:o,preventScrollReset:c,relative:u,viewTransition:v}={}){let f=useNavigate(),g=useLocation(),_=useResolvedPath(e,{relative:u});return reactExports.useCallback(p=>{if(shouldProcessLinkClick(p,r)){p.preventDefault();let E=t!==void 0?t:createPath(g)===createPath(_);f(e,{replace:E,state:o,preventScrollReset:c,relative:u,viewTransition:v})}},[g,f,_,t,o,r,e,c,u,v])}function useSearchParams(e){warning(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let r=reactExports.useRef(createSearchParams(e)),t=reactExports.useRef(!1),o=useLocation(),c=reactExports.useMemo(()=>getSearchParamsForLocation(o.search,t.current?null:r.current),[o.search]),u=useNavigate(),v=reactExports.useCallback((f,g)=>{const _=createSearchParams(typeof f=="function"?f(new URLSearchParams(c)):f);t.current=!0,u("?"+_,g)},[u,c]);return[c,v]}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:e}=useDataRouterContext3("useSubmit"),{basename:r}=reactExports.useContext(NavigationContext),t=useRouteId();return reactExports.useCallback(async(o,c={})=>{let{action:u,method:v,encType:f,formData:g,body:_}=getFormSubmissionInfo(o,r);if(c.navigate===!1){let p=c.fetcherKey||getUniqueFetcherId();await e.fetch(p,t,c.action||u,{preventScrollReset:c.preventScrollReset,formData:g,body:_,formMethod:c.method||v,formEncType:c.encType||f,flushSync:c.flushSync})}else await e.navigate(c.action||u,{preventScrollReset:c.preventScrollReset,formData:g,body:_,formMethod:c.method||v,formEncType:c.encType||f,replace:c.replace,state:c.state,fromRouteId:t,flushSync:c.flushSync,viewTransition:c.viewTransition})},[e,r,t])}function useFormAction(e,{relative:r}={}){let{basename:t}=reactExports.useContext(NavigationContext),o=reactExports.useContext(RouteContext);invariant(o,"useFormAction must be used inside a RouteContext");let[c]=o.matches.slice(-1),u={...useResolvedPath(e||".",{relative:r})},v=useLocation();if(e==null){u.search=v.search;let f=new URLSearchParams(u.search),g=f.getAll("index");if(g.some(p=>p==="")){f.delete("index"),g.filter(E=>E).forEach(E=>f.append("index",E));let p=f.toString();u.search=p?`?${p}`:""}}return(!e||e===".")&&c.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(u.pathname=u.pathname==="/"?t:joinPaths([t,u.pathname])),createPath(u)}function useViewTransitionState(e,{relative:r}={}){let t=reactExports.useContext(ViewTransitionContext);invariant(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:o}=useDataRouterContext3("useViewTransitionState"),c=useResolvedPath(e,{relative:r});if(!t.isTransitioning)return!1;let u=stripBasename(t.currentLocation.pathname,o)||t.currentLocation.pathname,v=stripBasename(t.nextLocation.pathname,o)||t.nextLocation.pathname;return matchPath(c.pathname,v)!=null||matchPath(c.pathname,u)!=null}var reactDomExports=requireReactDom();const ReactDOM=getDefaultExportFromCjs(reactDomExports);function cc(e){if(typeof e=="string"||typeof e=="number")return""+e;let r="";if(Array.isArray(e))for(let t=0,o;t<e.length;t++)(o=cc(e[t]))!==""&&(r+=(r&&" ")+o);else for(let t in e)e[t]&&(r+=(r&&" ")+t);return r}var withSelector={exports:{}},withSelector_production={},shim={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredUseSyncExternalStoreShim_production;function requireUseSyncExternalStoreShim_production(){if(hasRequiredUseSyncExternalStoreShim_production)return useSyncExternalStoreShim_production;hasRequiredUseSyncExternalStoreShim_production=1;var e=requireReact();function r(E,k){return E===k&&(E!==0||1/E===1/k)||E!==E&&k!==k}var t=typeof Object.is=="function"?Object.is:r,o=e.useState,c=e.useEffect,u=e.useLayoutEffect,v=e.useDebugValue;function f(E,k){var A=k(),z=o({inst:{value:A,getSnapshot:k}}),l=z[0].inst,s=z[1];return u(function(){l.value=A,l.getSnapshot=k,g(l)&&s({inst:l})},[E,A,k]),c(function(){return g(l)&&s({inst:l}),E(function(){g(l)&&s({inst:l})})},[E]),v(A),A}function g(E){var k=E.getSnapshot;E=E.value;try{var A=k();return!t(E,A)}catch{return!0}}function _(E,k){return k()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_:f;return useSyncExternalStoreShim_production.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:p,useSyncExternalStoreShim_production}var hasRequiredShim;function requireShim(){return hasRequiredShim||(hasRequiredShim=1,shim.exports=requireUseSyncExternalStoreShim_production()),shim.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredWithSelector_production;function requireWithSelector_production(){if(hasRequiredWithSelector_production)return withSelector_production;hasRequiredWithSelector_production=1;var e=requireReact(),r=requireShim();function t(_,p){return _===p&&(_!==0||1/_===1/p)||_!==_&&p!==p}var o=typeof Object.is=="function"?Object.is:t,c=r.useSyncExternalStore,u=e.useRef,v=e.useEffect,f=e.useMemo,g=e.useDebugValue;return withSelector_production.useSyncExternalStoreWithSelector=function(_,p,E,k,A){var z=u(null);if(z.current===null){var l={hasValue:!1,value:null};z.current=l}else l=z.current;z=f(function(){function y(x){if(!w){if(w=!0,S=x,x=k(x),A!==void 0&&l.hasValue){var R=l.value;if(A(R,x))return C=R}return C=x}if(R=C,o(S,x))return R;var M=k(x);return A!==void 0&&A(R,M)?(S=x,R):(S=x,C=M)}var w=!1,S,C,h=E===void 0?null:E;return[function(){return y(p())},h===null?void 0:function(){return y(h())}]},[p,E,k,A]);var s=c(_,z[0],z[1]);return v(function(){l.hasValue=!0,l.value=s},[s]),g(s),s},withSelector_production}var hasRequiredWithSelector;function requireWithSelector(){return hasRequiredWithSelector||(hasRequiredWithSelector=1,withSelector.exports=requireWithSelector_production()),withSelector.exports}var withSelectorExports=requireWithSelector();const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports),__vite_import_meta_env__={},createStoreImpl=e=>{let r;const t=new Set,o=(p,E)=>{const k=typeof p=="function"?p(r):p;if(!Object.is(k,r)){const A=r;r=E??(typeof k!="object"||k===null)?k:Object.assign({},r,k),t.forEach(z=>z(r,A))}},c=()=>r,g={setState:o,getState:c,getInitialState:()=>_,subscribe:p=>(t.add(p),()=>t.delete(p)),destroy:()=>{(__vite_import_meta_env__?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},_=r=e(o,c,g);return g},createStore=e=>e?createStoreImpl(e):createStoreImpl,{useDebugValue}=React,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports,identity$2=e=>e;function useStoreWithEqualityFn(e,r=identity$2,t){const o=useSyncExternalStoreWithSelector(e.subscribe,e.getState,e.getServerState||e.getInitialState,r,t);return useDebugValue(o),o}const createWithEqualityFnImpl=(e,r)=>{const t=createStore(e),o=(c,u=r)=>useStoreWithEqualityFn(t,c,u);return Object.assign(o,t),o},createWithEqualityFn=(e,r)=>e?createWithEqualityFnImpl(e,r):createWithEqualityFnImpl;function shallow$1(e,r){if(Object.is(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;if(e instanceof Map&&r instanceof Map){if(e.size!==r.size)return!1;for(const[o,c]of e)if(!Object.is(c,r.get(o)))return!1;return!0}if(e instanceof Set&&r instanceof Set){if(e.size!==r.size)return!1;for(const o of e)if(!r.has(o))return!1;return!0}const t=Object.keys(e);if(t.length!==Object.keys(r).length)return!1;for(const o of t)if(!Object.prototype.hasOwnProperty.call(r,o)||!Object.is(e[o],r[o]))return!1;return!0}var noop$1={value:()=>{}};function dispatch(){for(var e=0,r=arguments.length,t={},o;e<r;++e){if(!(o=arguments[e]+"")||o in t||/[\s.]/.test(o))throw new Error("illegal type: "+o);t[o]=[]}return new Dispatch(t)}function Dispatch(e){this._=e}function parseTypenames$1(e,r){return e.trim().split(/^|\s+/).map(function(t){var o="",c=t.indexOf(".");if(c>=0&&(o=t.slice(c+1),t=t.slice(0,c)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:o}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(e,r){var t=this._,o=parseTypenames$1(e+"",t),c,u=-1,v=o.length;if(arguments.length<2){for(;++u<v;)if((c=(e=o[u]).type)&&(c=get$1(t[c],e.name)))return c;return}if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++u<v;)if(c=(e=o[u]).type)t[c]=set$1(t[c],e.name,r);else if(r==null)for(c in t)t[c]=set$1(t[c],e.name,null);return this},copy:function(){var e={},r=this._;for(var t in r)e[t]=r[t].slice();return new Dispatch(e)},call:function(e,r){if((c=arguments.length-2)>0)for(var t=new Array(c),o=0,c,u;o<c;++o)t[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(u=this._[e],o=0,c=u.length;o<c;++o)u[o].value.apply(r,t)},apply:function(e,r,t){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],c=0,u=o.length;c<u;++c)o[c].value.apply(r,t)}};function get$1(e,r){for(var t=0,o=e.length,c;t<o;++t)if((c=e[t]).name===r)return c.value}function set$1(e,r,t){for(var o=0,c=e.length;o<c;++o)if(e[o].name===r){e[o]=noop$1,e=e.slice(0,o).concat(e.slice(o+1));break}return t!=null&&e.push({name:r,value:t}),e}var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(e){var r=e+="",t=r.indexOf(":");return t>=0&&(r=e.slice(0,t))!=="xmlns"&&(e=e.slice(t+1)),namespaces.hasOwnProperty(r)?{space:namespaces[r],local:e}:e}function creatorInherit(e){return function(){var r=this.ownerDocument,t=this.namespaceURI;return t===xhtml&&r.documentElement.namespaceURI===xhtml?r.createElement(e):r.createElementNS(t,e)}}function creatorFixed(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function creator(e){var r=namespace(e);return(r.local?creatorFixed:creatorInherit)(r)}function none(){}function selector$h(e){return e==null?none:function(){return this.querySelector(e)}}function selection_select(e){typeof e!="function"&&(e=selector$h(e));for(var r=this._groups,t=r.length,o=new Array(t),c=0;c<t;++c)for(var u=r[c],v=u.length,f=o[c]=new Array(v),g,_,p=0;p<v;++p)(g=u[p])&&(_=e.call(g,g.__data__,p,u))&&("__data__"in g&&(_.__data__=g.__data__),f[p]=_);return new Selection$1(o,this._parents)}function array(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function empty(){return[]}function selectorAll(e){return e==null?empty:function(){return this.querySelectorAll(e)}}function arrayAll(e){return function(){return array(e.apply(this,arguments))}}function selection_selectAll(e){typeof e=="function"?e=arrayAll(e):e=selectorAll(e);for(var r=this._groups,t=r.length,o=[],c=[],u=0;u<t;++u)for(var v=r[u],f=v.length,g,_=0;_<f;++_)(g=v[_])&&(o.push(e.call(g,g.__data__,_,v)),c.push(g));return new Selection$1(o,c)}function matcher(e){return function(){return this.matches(e)}}function childMatcher(e){return function(r){return r.matches(e)}}var find=Array.prototype.find;function childFind(e){return function(){return find.call(this.children,e)}}function childFirst(){return this.firstElementChild}function selection_selectChild(e){return this.select(e==null?childFirst:childFind(typeof e=="function"?e:childMatcher(e)))}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(e){return function(){return filter.call(this.children,e)}}function selection_selectChildren(e){return this.selectAll(e==null?children:childrenFilter(typeof e=="function"?e:childMatcher(e)))}function selection_filter(e){typeof e!="function"&&(e=matcher(e));for(var r=this._groups,t=r.length,o=new Array(t),c=0;c<t;++c)for(var u=r[c],v=u.length,f=o[c]=[],g,_=0;_<v;++_)(g=u[_])&&e.call(g,g.__data__,_,u)&&f.push(g);return new Selection$1(o,this._parents)}function sparse(e){return new Array(e.length)}function selection_enter(){return new Selection$1(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(e,r){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=r}EnterNode.prototype={constructor:EnterNode,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,r){return this._parent.insertBefore(e,r)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function constant$3(e){return function(){return e}}function bindIndex(e,r,t,o,c,u){for(var v=0,f,g=r.length,_=u.length;v<_;++v)(f=r[v])?(f.__data__=u[v],o[v]=f):t[v]=new EnterNode(e,u[v]);for(;v<g;++v)(f=r[v])&&(c[v]=f)}function bindKey(e,r,t,o,c,u,v){var f,g,_=new Map,p=r.length,E=u.length,k=new Array(p),A;for(f=0;f<p;++f)(g=r[f])&&(k[f]=A=v.call(g,g.__data__,f,r)+"",_.has(A)?c[f]=g:_.set(A,g));for(f=0;f<E;++f)A=v.call(e,u[f],f,u)+"",(g=_.get(A))?(o[f]=g,g.__data__=u[f],_.delete(A)):t[f]=new EnterNode(e,u[f]);for(f=0;f<p;++f)(g=r[f])&&_.get(k[f])===g&&(c[f]=g)}function datum(e){return e.__data__}function selection_data(e,r){if(!arguments.length)return Array.from(this,datum);var t=r?bindKey:bindIndex,o=this._parents,c=this._groups;typeof e!="function"&&(e=constant$3(e));for(var u=c.length,v=new Array(u),f=new Array(u),g=new Array(u),_=0;_<u;++_){var p=o[_],E=c[_],k=E.length,A=arraylike(e.call(p,p&&p.__data__,_,o)),z=A.length,l=f[_]=new Array(z),s=v[_]=new Array(z),y=g[_]=new Array(k);t(p,E,l,s,y,A,r);for(var w=0,S=0,C,h;w<z;++w)if(C=l[w]){for(w>=S&&(S=w+1);!(h=s[S])&&++S<z;);C._next=h||null}}return v=new Selection$1(v,o),v._enter=f,v._exit=g,v}function arraylike(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function selection_exit(){return new Selection$1(this._exit||this._groups.map(sparse),this._parents)}function selection_join(e,r,t){var o=this.enter(),c=this,u=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),r!=null&&(c=r(c),c&&(c=c.selection())),t==null?u.remove():t(u),o&&c?o.merge(c).order():c}function selection_merge(e){for(var r=e.selection?e.selection():e,t=this._groups,o=r._groups,c=t.length,u=o.length,v=Math.min(c,u),f=new Array(c),g=0;g<v;++g)for(var _=t[g],p=o[g],E=_.length,k=f[g]=new Array(E),A,z=0;z<E;++z)(A=_[z]||p[z])&&(k[z]=A);for(;g<c;++g)f[g]=t[g];return new Selection$1(f,this._parents)}function selection_order(){for(var e=this._groups,r=-1,t=e.length;++r<t;)for(var o=e[r],c=o.length-1,u=o[c],v;--c>=0;)(v=o[c])&&(u&&v.compareDocumentPosition(u)^4&&u.parentNode.insertBefore(v,u),u=v);return this}function selection_sort(e){e||(e=ascending);function r(E,k){return E&&k?e(E.__data__,k.__data__):!E-!k}for(var t=this._groups,o=t.length,c=new Array(o),u=0;u<o;++u){for(var v=t[u],f=v.length,g=c[u]=new Array(f),_,p=0;p<f;++p)(_=v[p])&&(g[p]=_);g.sort(r)}return new Selection$1(c,this._parents).order()}function ascending(e,r){return e<r?-1:e>r?1:e>=r?0:NaN}function selection_call(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var e=this._groups,r=0,t=e.length;r<t;++r)for(var o=e[r],c=0,u=o.length;c<u;++c){var v=o[c];if(v)return v}return null}function selection_size(){let e=0;for(const r of this)++e;return e}function selection_empty(){return!this.node()}function selection_each(e){for(var r=this._groups,t=0,o=r.length;t<o;++t)for(var c=r[t],u=0,v=c.length,f;u<v;++u)(f=c[u])&&e.call(f,f.__data__,u,c);return this}function attrRemove$1(e){return function(){this.removeAttribute(e)}}function attrRemoveNS$1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant$1(e,r){return function(){this.setAttribute(e,r)}}function attrConstantNS$1(e,r){return function(){this.setAttributeNS(e.space,e.local,r)}}function attrFunction$1(e,r){return function(){var t=r.apply(this,arguments);t==null?this.removeAttribute(e):this.setAttribute(e,t)}}function attrFunctionNS$1(e,r){return function(){var t=r.apply(this,arguments);t==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}function selection_attr(e,r){var t=namespace(e);if(arguments.length<2){var o=this.node();return t.local?o.getAttributeNS(t.space,t.local):o.getAttribute(t)}return this.each((r==null?t.local?attrRemoveNS$1:attrRemove$1:typeof r=="function"?t.local?attrFunctionNS$1:attrFunction$1:t.local?attrConstantNS$1:attrConstant$1)(t,r))}function defaultView(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function styleRemove$1(e){return function(){this.style.removeProperty(e)}}function styleConstant$1(e,r,t){return function(){this.style.setProperty(e,r,t)}}function styleFunction$1(e,r,t){return function(){var o=r.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,t)}}function selection_style(e,r,t){return arguments.length>1?this.each((r==null?styleRemove$1:typeof r=="function"?styleFunction$1:styleConstant$1)(e,r,t??"")):styleValue(this.node(),e)}function styleValue(e,r){return e.style.getPropertyValue(r)||defaultView(e).getComputedStyle(e,null).getPropertyValue(r)}function propertyRemove(e){return function(){delete this[e]}}function propertyConstant(e,r){return function(){this[e]=r}}function propertyFunction(e,r){return function(){var t=r.apply(this,arguments);t==null?delete this[e]:this[e]=t}}function selection_property(e,r){return arguments.length>1?this.each((r==null?propertyRemove:typeof r=="function"?propertyFunction:propertyConstant)(e,r)):this.node()[e]}function classArray(e){return e.trim().split(/^|\s+/)}function classList(e){return e.classList||new ClassList(e)}function ClassList(e){this._node=e,this._names=classArray(e.getAttribute("class")||"")}ClassList.prototype={add:function(e){var r=this._names.indexOf(e);r<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var r=this._names.indexOf(e);r>=0&&(this._names.splice(r,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function classedAdd(e,r){for(var t=classList(e),o=-1,c=r.length;++o<c;)t.add(r[o])}function classedRemove(e,r){for(var t=classList(e),o=-1,c=r.length;++o<c;)t.remove(r[o])}function classedTrue(e){return function(){classedAdd(this,e)}}function classedFalse(e){return function(){classedRemove(this,e)}}function classedFunction(e,r){return function(){(r.apply(this,arguments)?classedAdd:classedRemove)(this,e)}}function selection_classed(e,r){var t=classArray(e+"");if(arguments.length<2){for(var o=classList(this.node()),c=-1,u=t.length;++c<u;)if(!o.contains(t[c]))return!1;return!0}return this.each((typeof r=="function"?classedFunction:r?classedTrue:classedFalse)(t,r))}function textRemove(){this.textContent=""}function textConstant$1(e){return function(){this.textContent=e}}function textFunction$1(e){return function(){var r=e.apply(this,arguments);this.textContent=r??""}}function selection_text(e){return arguments.length?this.each(e==null?textRemove:(typeof e=="function"?textFunction$1:textConstant$1)(e)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(e){return function(){this.innerHTML=e}}function htmlFunction(e){return function(){var r=e.apply(this,arguments);this.innerHTML=r??""}}function selection_html(e){return arguments.length?this.each(e==null?htmlRemove:(typeof e=="function"?htmlFunction:htmlConstant)(e)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(e){var r=typeof e=="function"?e:creator(e);return this.select(function(){return this.appendChild(r.apply(this,arguments))})}function constantNull(){return null}function selection_insert(e,r){var t=typeof e=="function"?e:creator(e),o=r==null?constantNull:typeof r=="function"?r:selector$h(r);return this.select(function(){return this.insertBefore(t.apply(this,arguments),o.apply(this,arguments)||null)})}function remove(){var e=this.parentNode;e&&e.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var e=this.cloneNode(!1),r=this.parentNode;return r?r.insertBefore(e,this.nextSibling):e}function selection_cloneDeep(){var e=this.cloneNode(!0),r=this.parentNode;return r?r.insertBefore(e,this.nextSibling):e}function selection_clone(e){return this.select(e?selection_cloneDeep:selection_cloneShallow)}function selection_datum(e){return arguments.length?this.property("__data__",e):this.node().__data__}function contextListener(e){return function(r){e.call(this,r,this.__data__)}}function parseTypenames(e){return e.trim().split(/^|\s+/).map(function(r){var t="",o=r.indexOf(".");return o>=0&&(t=r.slice(o+1),r=r.slice(0,o)),{type:r,name:t}})}function onRemove(e){return function(){var r=this.__on;if(r){for(var t=0,o=-1,c=r.length,u;t<c;++t)u=r[t],(!e.type||u.type===e.type)&&u.name===e.name?this.removeEventListener(u.type,u.listener,u.options):r[++o]=u;++o?r.length=o:delete this.__on}}}function onAdd(e,r,t){return function(){var o=this.__on,c,u=contextListener(r);if(o){for(var v=0,f=o.length;v<f;++v)if((c=o[v]).type===e.type&&c.name===e.name){this.removeEventListener(c.type,c.listener,c.options),this.addEventListener(c.type,c.listener=u,c.options=t),c.value=r;return}}this.addEventListener(e.type,u,t),c={type:e.type,name:e.name,value:r,listener:u,options:t},o?o.push(c):this.__on=[c]}}function selection_on(e,r,t){var o=parseTypenames(e+""),c,u=o.length,v;if(arguments.length<2){var f=this.node().__on;if(f){for(var g=0,_=f.length,p;g<_;++g)for(c=0,p=f[g];c<u;++c)if((v=o[c]).type===p.type&&v.name===p.name)return p.value}return}for(f=r?onAdd:onRemove,c=0;c<u;++c)this.each(f(o[c],r,t));return this}function dispatchEvent(e,r,t){var o=defaultView(e),c=o.CustomEvent;typeof c=="function"?c=new c(r,t):(c=o.document.createEvent("Event"),t?(c.initEvent(r,t.bubbles,t.cancelable),c.detail=t.detail):c.initEvent(r,!1,!1)),e.dispatchEvent(c)}function dispatchConstant(e,r){return function(){return dispatchEvent(this,e,r)}}function dispatchFunction(e,r){return function(){return dispatchEvent(this,e,r.apply(this,arguments))}}function selection_dispatch(e,r){return this.each((typeof r=="function"?dispatchFunction:dispatchConstant)(e,r))}function*selection_iterator(){for(var e=this._groups,r=0,t=e.length;r<t;++r)for(var o=e[r],c=0,u=o.length,v;c<u;++c)(v=o[c])&&(yield v)}var root=[null];function Selection$1(e,r){this._groups=e,this._parents=r}function selection(){return new Selection$1([[document.documentElement]],root)}function selection_selection(){return this}Selection$1.prototype=selection.prototype={constructor:Selection$1,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};function select(e){return typeof e=="string"?new Selection$1([[document.querySelector(e)]],[document.documentElement]):new Selection$1([[e]],root)}function sourceEvent(e){let r;for(;r=e.sourceEvent;)e=r;return e}function pointer(e,r){if(e=sourceEvent(e),r===void 0&&(r=e.currentTarget),r){var t=r.ownerSVGElement||r;if(t.createSVGPoint){var o=t.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(r.getScreenCTM().inverse()),[o.x,o.y]}if(r.getBoundingClientRect){var c=r.getBoundingClientRect();return[e.clientX-c.left-r.clientLeft,e.clientY-c.top-r.clientTop]}}return[e.pageX,e.pageY]}const nonpassive={passive:!1},nonpassivecapture={capture:!0,passive:!1};function nopropagation$1(e){e.stopImmediatePropagation()}function noevent$1(e){e.preventDefault(),e.stopImmediatePropagation()}function dragDisable(e){var r=e.document.documentElement,t=select(e).on("dragstart.drag",noevent$1,nonpassivecapture);"onselectstart"in r?t.on("selectstart.drag",noevent$1,nonpassivecapture):(r.__noselect=r.style.MozUserSelect,r.style.MozUserSelect="none")}function yesdrag(e,r){var t=e.document.documentElement,o=select(e).on("dragstart.drag",null);r&&(o.on("click.drag",noevent$1,nonpassivecapture),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in t?o.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const constant$2=e=>()=>e;function DragEvent(e,{sourceEvent:r,subject:t,target:o,identifier:c,active:u,x:v,y:f,dx:g,dy:_,dispatch:p}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:r,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:c,enumerable:!0,configurable:!0},active:{value:u,enumerable:!0,configurable:!0},x:{value:v,enumerable:!0,configurable:!0},y:{value:f,enumerable:!0,configurable:!0},dx:{value:g,enumerable:!0,configurable:!0},dy:{value:_,enumerable:!0,configurable:!0},_:{value:p}})}DragEvent.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function defaultFilter$1(e){return!e.ctrlKey&&!e.button}function defaultContainer(){return this.parentNode}function defaultSubject(e,r){return r??{x:e.x,y:e.y}}function defaultTouchable$1(){return navigator.maxTouchPoints||"ontouchstart"in this}function drag(){var e=defaultFilter$1,r=defaultContainer,t=defaultSubject,o=defaultTouchable$1,c={},u=dispatch("start","drag","end"),v=0,f,g,_,p,E=0;function k(C){C.on("mousedown.drag",A).filter(o).on("touchstart.drag",s).on("touchmove.drag",y,nonpassive).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function A(C,h){if(!(p||!e.call(this,C,h))){var x=S(this,r.call(this,C,h),C,h,"mouse");x&&(select(C.view).on("mousemove.drag",z,nonpassivecapture).on("mouseup.drag",l,nonpassivecapture),dragDisable(C.view),nopropagation$1(C),_=!1,f=C.clientX,g=C.clientY,x("start",C))}}function z(C){if(noevent$1(C),!_){var h=C.clientX-f,x=C.clientY-g;_=h*h+x*x>E}c.mouse("drag",C)}function l(C){select(C.view).on("mousemove.drag mouseup.drag",null),yesdrag(C.view,_),noevent$1(C),c.mouse("end",C)}function s(C,h){if(e.call(this,C,h)){var x=C.changedTouches,R=r.call(this,C,h),M=x.length,P,D;for(P=0;P<M;++P)(D=S(this,R,C,h,x[P].identifier,x[P]))&&(nopropagation$1(C),D("start",C,x[P]))}}function y(C){var h=C.changedTouches,x=h.length,R,M;for(R=0;R<x;++R)(M=c[h[R].identifier])&&(noevent$1(C),M("drag",C,h[R]))}function w(C){var h=C.changedTouches,x=h.length,R,M;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),R=0;R<x;++R)(M=c[h[R].identifier])&&(nopropagation$1(C),M("end",C,h[R]))}function S(C,h,x,R,M,P){var D=u.copy(),L=pointer(P||x,h),X,B,j;if((j=t.call(C,new DragEvent("beforestart",{sourceEvent:x,target:k,identifier:M,active:v,x:L[0],y:L[1],dx:0,dy:0,dispatch:D}),R))!=null)return X=j.x-L[0]||0,B=j.y-L[1]||0,function H($,q,W){var Y=L,G;switch($){case"start":c[M]=H,G=v++;break;case"end":delete c[M],--v;case"drag":L=pointer(W||q,h),G=v;break}D.call($,C,new DragEvent($,{sourceEvent:q,subject:j,target:k,identifier:M,active:G,x:L[0]+X,y:L[1]+B,dx:L[0]-Y[0],dy:L[1]-Y[1],dispatch:D}),R)}}return k.filter=function(C){return arguments.length?(e=typeof C=="function"?C:constant$2(!!C),k):e},k.container=function(C){return arguments.length?(r=typeof C=="function"?C:constant$2(C),k):r},k.subject=function(C){return arguments.length?(t=typeof C=="function"?C:constant$2(C),k):t},k.touchable=function(C){return arguments.length?(o=typeof C=="function"?C:constant$2(!!C),k):o},k.on=function(){var C=u.on.apply(u,arguments);return C===u?k:C},k.clickDistance=function(C){return arguments.length?(E=(C=+C)*C,k):Math.sqrt(E)},k}function define(e,r,t){e.prototype=r.prototype=t,t.constructor=e}function extend(e,r){var t=Object.create(e.prototype);for(var o in r)t[o]=r[o];return t}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(e){var r,t;return e=(e+"").trim().toLowerCase(),(r=reHex.exec(e))?(t=r[1].length,r=parseInt(r[1],16),t===6?rgbn(r):t===3?new Rgb(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):t===8?rgba(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):t===4?rgba(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=reRgbInteger.exec(e))?new Rgb(r[1],r[2],r[3],1):(r=reRgbPercent.exec(e))?new Rgb(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=reRgbaInteger.exec(e))?rgba(r[1],r[2],r[3],r[4]):(r=reRgbaPercent.exec(e))?rgba(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=reHslPercent.exec(e))?hsla(r[1],r[2]/100,r[3]/100,1):(r=reHslaPercent.exec(e))?hsla(r[1],r[2]/100,r[3]/100,r[4]):named.hasOwnProperty(e)?rgbn(named[e]):e==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,e&255,1)}function rgba(e,r,t,o){return o<=0&&(e=r=t=NaN),new Rgb(e,r,t,o)}function rgbConvert(e){return e instanceof Color||(e=color(e)),e?(e=e.rgb(),new Rgb(e.r,e.g,e.b,e.opacity)):new Rgb}function rgb(e,r,t,o){return arguments.length===1?rgbConvert(e):new Rgb(e,r,t,o??1)}function Rgb(e,r,t,o){this.r=+e,this.g=+r,this.b=+t,this.opacity=+o}define(Rgb,rgb,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const e=clampa(this.opacity);return`${e===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${e===1?")":`, ${e})`}`}function clampa(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function clampi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hex(e){return e=clampi(e),(e<16?"0":"")+e.toString(16)}function hsla(e,r,t,o){return o<=0?e=r=t=NaN:t<=0||t>=1?e=r=NaN:r<=0&&(e=NaN),new Hsl(e,r,t,o)}function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color||(e=color(e)),!e)return new Hsl;if(e instanceof Hsl)return e;e=e.rgb();var r=e.r/255,t=e.g/255,o=e.b/255,c=Math.min(r,t,o),u=Math.max(r,t,o),v=NaN,f=u-c,g=(u+c)/2;return f?(r===u?v=(t-o)/f+(t<o)*6:t===u?v=(o-r)/f+2:v=(r-t)/f+4,f/=g<.5?u+c:2-u-c,v*=60):f=g>0&&g<1?0:v,new Hsl(v,f,g,e.opacity)}function hsl(e,r,t,o){return arguments.length===1?hslConvert(e):new Hsl(e,r,t,o??1)}function Hsl(e,r,t,o){this.h=+e,this.s=+r,this.l=+t,this.opacity=+o}define(Hsl,hsl,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,o=t+(t<.5?t:1-t)*r,c=2*t-o;return new Rgb(hsl2rgb(e>=240?e-240:e+120,c,o),hsl2rgb(e,c,o),hsl2rgb(e<120?e+240:e-120,c,o),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=clampa(this.opacity);return`${e===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function clamph(e){return e=(e||0)%360,e<0?e+360:e}function clampt(e){return Math.max(0,Math.min(1,e||0))}function hsl2rgb(e,r,t){return(e<60?r+(t-r)*e/60:e<180?t:e<240?r+(t-r)*(240-e)/60:r)*255}const constant$1=e=>()=>e;function linear(e,r){return function(t){return e+t*r}}function exponential(e,r,t){return e=Math.pow(e,t),r=Math.pow(r,t)-e,t=1/t,function(o){return Math.pow(e+o*r,t)}}function gamma(e){return(e=+e)==1?nogamma:function(r,t){return t-r?exponential(r,t,e):constant$1(isNaN(r)?t:r)}}function nogamma(e,r){var t=r-e;return t?linear(e,t):constant$1(isNaN(e)?r:e)}const interpolateRgb=(function e(r){var t=gamma(r);function o(c,u){var v=t((c=rgb(c)).r,(u=rgb(u)).r),f=t(c.g,u.g),g=t(c.b,u.b),_=nogamma(c.opacity,u.opacity);return function(p){return c.r=v(p),c.g=f(p),c.b=g(p),c.opacity=_(p),c+""}}return o.gamma=e,o})(1);function interpolateNumber(e,r){return e=+e,r=+r,function(t){return e*(1-t)+r*t}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(e){return function(){return e}}function one(e){return function(r){return e(r)+""}}function interpolateString(e,r){var t=reA.lastIndex=reB.lastIndex=0,o,c,u,v=-1,f=[],g=[];for(e=e+"",r=r+"";(o=reA.exec(e))&&(c=reB.exec(r));)(u=c.index)>t&&(u=r.slice(t,u),f[v]?f[v]+=u:f[++v]=u),(o=o[0])===(c=c[0])?f[v]?f[v]+=c:f[++v]=c:(f[++v]=null,g.push({i:v,x:interpolateNumber(o,c)})),t=reB.lastIndex;return t<r.length&&(u=r.slice(t),f[v]?f[v]+=u:f[++v]=u),f.length<2?g[0]?one(g[0].x):zero(r):(r=g.length,function(_){for(var p=0,E;p<r;++p)f[(E=g[p]).i]=E.x(_);return f.join("")})}var degrees=180/Math.PI,identity$1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(e,r,t,o,c,u){var v,f,g;return(v=Math.sqrt(e*e+r*r))&&(e/=v,r/=v),(g=e*t+r*o)&&(t-=e*g,o-=r*g),(f=Math.sqrt(t*t+o*o))&&(t/=f,o/=f,g/=f),e*o<r*t&&(e=-e,r=-r,g=-g,v=-v),{translateX:c,translateY:u,rotate:Math.atan2(r,e)*degrees,skewX:Math.atan(g)*degrees,scaleX:v,scaleY:f}}var svgNode;function parseCss(e){const r=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return r.isIdentity?identity$1:decompose(r.a,r.b,r.c,r.d,r.e,r.f)}function parseSvg(e){return e==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",e),!(e=svgNode.transform.baseVal.consolidate()))?identity$1:(e=e.matrix,decompose(e.a,e.b,e.c,e.d,e.e,e.f))}function interpolateTransform(e,r,t,o){function c(_){return _.length?_.pop()+" ":""}function u(_,p,E,k,A,z){if(_!==E||p!==k){var l=A.push("translate(",null,r,null,t);z.push({i:l-4,x:interpolateNumber(_,E)},{i:l-2,x:interpolateNumber(p,k)})}else(E||k)&&A.push("translate("+E+r+k+t)}function v(_,p,E,k){_!==p?(_-p>180?p+=360:p-_>180&&(_+=360),k.push({i:E.push(c(E)+"rotate(",null,o)-2,x:interpolateNumber(_,p)})):p&&E.push(c(E)+"rotate("+p+o)}function f(_,p,E,k){_!==p?k.push({i:E.push(c(E)+"skewX(",null,o)-2,x:interpolateNumber(_,p)}):p&&E.push(c(E)+"skewX("+p+o)}function g(_,p,E,k,A,z){if(_!==E||p!==k){var l=A.push(c(A)+"scale(",null,",",null,")");z.push({i:l-4,x:interpolateNumber(_,E)},{i:l-2,x:interpolateNumber(p,k)})}else(E!==1||k!==1)&&A.push(c(A)+"scale("+E+","+k+")")}return function(_,p){var E=[],k=[];return _=e(_),p=e(p),u(_.translateX,_.translateY,p.translateX,p.translateY,E,k),v(_.rotate,p.rotate,E,k),f(_.skewX,p.skewX,E,k),g(_.scaleX,_.scaleY,p.scaleX,p.scaleY,E,k),_=p=null,function(A){for(var z=-1,l=k.length,s;++z<l;)E[(s=k[z]).i]=s.x(A);return E.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),epsilon2=1e-12;function cosh(e){return((e=Math.exp(e))+1/e)/2}function sinh(e){return((e=Math.exp(e))-1/e)/2}function tanh(e){return((e=Math.exp(2*e))-1)/(e+1)}const interpolateZoom=(function e(r,t,o){function c(u,v){var f=u[0],g=u[1],_=u[2],p=v[0],E=v[1],k=v[2],A=p-f,z=E-g,l=A*A+z*z,s,y;if(l<epsilon2)y=Math.log(k/_)/r,s=function(R){return[f+R*A,g+R*z,_*Math.exp(r*R*y)]};else{var w=Math.sqrt(l),S=(k*k-_*_+o*l)/(2*_*t*w),C=(k*k-_*_-o*l)/(2*k*t*w),h=Math.log(Math.sqrt(S*S+1)-S),x=Math.log(Math.sqrt(C*C+1)-C);y=(x-h)/r,s=function(R){var M=R*y,P=cosh(h),D=_/(t*w)*(P*tanh(r*M+h)-sinh(h));return[f+D*A,g+D*z,_*P/cosh(r*M+h)]}}return s.duration=y*1e3*r/Math.SQRT2,s}return c.rho=function(u){var v=Math.max(.001,+u),f=v*v,g=f*f;return e(v,f,g)},c})(Math.SQRT2,2,4);var frame=0,timeout$1=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(e,r,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?now():+t)+(r==null?0:+r),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=e,this._time=t,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(e,r,t){var o=new Timer;return o.restart(e,r,t),o}function timerFlush(){now(),++frame;for(var e=taskHead,r;e;)(r=clockNow-e._time)>=0&&e._call.call(void 0,r),e=e._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var e=clock.now(),r=e-clockLast;r>pokeDelay&&(clockSkew-=r,clockLast=e)}function nap(){for(var e,r=taskHead,t,o=1/0;r;)r._call?(o>r._time&&(o=r._time),e=r,r=r._next):(t=r._next,r._next=null,r=e?e._next=t:taskHead=t);taskTail=e,sleep(o)}function sleep(e){if(!frame){timeout$1&&(timeout$1=clearTimeout(timeout$1));var r=e-clockNow;r>24?(e<1/0&&(timeout$1=setTimeout(wake,e-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout(e,r,t){var o=new Timer;return r=r==null?0:+r,o.restart(c=>{o.stop(),e(c+r)},r,t),o}var emptyOn=dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(e,r,t,o,c,u){var v=e.__transition;if(!v)e.__transition={};else if(t in v)return;create(e,t,{name:r,index:o,group:c,on:emptyOn,tween:emptyTween,time:u.time,delay:u.delay,duration:u.duration,ease:u.ease,timer:null,state:CREATED})}function init(e,r){var t=get(e,r);if(t.state>CREATED)throw new Error("too late; already scheduled");return t}function set(e,r){var t=get(e,r);if(t.state>STARTED)throw new Error("too late; already running");return t}function get(e,r){var t=e.__transition;if(!t||!(t=t[r]))throw new Error("transition not found");return t}function create(e,r,t){var o=e.__transition,c;o[r]=t,t.timer=timer(u,0,t.time);function u(_){t.state=SCHEDULED,t.timer.restart(v,t.delay,t.time),t.delay<=_&&v(_-t.delay)}function v(_){var p,E,k,A;if(t.state!==SCHEDULED)return g();for(p in o)if(A=o[p],A.name===t.name){if(A.state===STARTED)return timeout(v);A.state===RUNNING?(A.state=ENDED,A.timer.stop(),A.on.call("interrupt",e,e.__data__,A.index,A.group),delete o[p]):+p<r&&(A.state=ENDED,A.timer.stop(),A.on.call("cancel",e,e.__data__,A.index,A.group),delete o[p])}if(timeout(function(){t.state===STARTED&&(t.state=RUNNING,t.timer.restart(f,t.delay,t.time),f(_))}),t.state=STARTING,t.on.call("start",e,e.__data__,t.index,t.group),t.state===STARTING){for(t.state=STARTED,c=new Array(k=t.tween.length),p=0,E=-1;p<k;++p)(A=t.tween[p].value.call(e,e.__data__,t.index,t.group))&&(c[++E]=A);c.length=E+1}}function f(_){for(var p=_<t.duration?t.ease.call(null,_/t.duration):(t.timer.restart(g),t.state=ENDING,1),E=-1,k=c.length;++E<k;)c[E].call(e,p);t.state===ENDING&&(t.on.call("end",e,e.__data__,t.index,t.group),g())}function g(){t.state=ENDED,t.timer.stop(),delete o[r];for(var _ in o)return;delete e.__transition}}function interrupt(e,r){var t=e.__transition,o,c,u=!0,v;if(t){r=r==null?null:r+"";for(v in t){if((o=t[v]).name!==r){u=!1;continue}c=o.state>STARTING&&o.state<ENDING,o.state=ENDED,o.timer.stop(),o.on.call(c?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete t[v]}u&&delete e.__transition}}function selection_interrupt(e){return this.each(function(){interrupt(this,e)})}function tweenRemove(e,r){var t,o;return function(){var c=set(this,e),u=c.tween;if(u!==t){o=t=u;for(var v=0,f=o.length;v<f;++v)if(o[v].name===r){o=o.slice(),o.splice(v,1);break}}c.tween=o}}function tweenFunction(e,r,t){var o,c;if(typeof t!="function")throw new Error;return function(){var u=set(this,e),v=u.tween;if(v!==o){c=(o=v).slice();for(var f={name:r,value:t},g=0,_=c.length;g<_;++g)if(c[g].name===r){c[g]=f;break}g===_&&c.push(f)}u.tween=c}}function transition_tween(e,r){var t=this._id;if(e+="",arguments.length<2){for(var o=get(this.node(),t).tween,c=0,u=o.length,v;c<u;++c)if((v=o[c]).name===e)return v.value;return null}return this.each((r==null?tweenRemove:tweenFunction)(t,e,r))}function tweenValue(e,r,t){var o=e._id;return e.each(function(){var c=set(this,o);(c.value||(c.value={}))[r]=t.apply(this,arguments)}),function(c){return get(c,o).value[r]}}function interpolate(e,r){var t;return(typeof r=="number"?interpolateNumber:r instanceof color?interpolateRgb:(t=color(r))?(r=t,interpolateRgb):interpolateString)(e,r)}function attrRemove(e){return function(){this.removeAttribute(e)}}function attrRemoveNS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant(e,r,t){var o,c=t+"",u;return function(){var v=this.getAttribute(e);return v===c?null:v===o?u:u=r(o=v,t)}}function attrConstantNS(e,r,t){var o,c=t+"",u;return function(){var v=this.getAttributeNS(e.space,e.local);return v===c?null:v===o?u:u=r(o=v,t)}}function attrFunction(e,r,t){var o,c,u;return function(){var v,f=t(this),g;return f==null?void this.removeAttribute(e):(v=this.getAttribute(e),g=f+"",v===g?null:v===o&&g===c?u:(c=g,u=r(o=v,f)))}}function attrFunctionNS(e,r,t){var o,c,u;return function(){var v,f=t(this),g;return f==null?void this.removeAttributeNS(e.space,e.local):(v=this.getAttributeNS(e.space,e.local),g=f+"",v===g?null:v===o&&g===c?u:(c=g,u=r(o=v,f)))}}function transition_attr(e,r){var t=namespace(e),o=t==="transform"?interpolateTransformSvg:interpolate;return this.attrTween(e,typeof r=="function"?(t.local?attrFunctionNS:attrFunction)(t,o,tweenValue(this,"attr."+e,r)):r==null?(t.local?attrRemoveNS:attrRemove)(t):(t.local?attrConstantNS:attrConstant)(t,o,r))}function attrInterpolate(e,r){return function(t){this.setAttribute(e,r.call(this,t))}}function attrInterpolateNS(e,r){return function(t){this.setAttributeNS(e.space,e.local,r.call(this,t))}}function attrTweenNS(e,r){var t,o;function c(){var u=r.apply(this,arguments);return u!==o&&(t=(o=u)&&attrInterpolateNS(e,u)),t}return c._value=r,c}function attrTween(e,r){var t,o;function c(){var u=r.apply(this,arguments);return u!==o&&(t=(o=u)&&attrInterpolate(e,u)),t}return c._value=r,c}function transition_attrTween(e,r){var t="attr."+e;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(r==null)return this.tween(t,null);if(typeof r!="function")throw new Error;var o=namespace(e);return this.tween(t,(o.local?attrTweenNS:attrTween)(o,r))}function delayFunction(e,r){return function(){init(this,e).delay=+r.apply(this,arguments)}}function delayConstant(e,r){return r=+r,function(){init(this,e).delay=r}}function transition_delay(e){var r=this._id;return arguments.length?this.each((typeof e=="function"?delayFunction:delayConstant)(r,e)):get(this.node(),r).delay}function durationFunction(e,r){return function(){set(this,e).duration=+r.apply(this,arguments)}}function durationConstant(e,r){return r=+r,function(){set(this,e).duration=r}}function transition_duration(e){var r=this._id;return arguments.length?this.each((typeof e=="function"?durationFunction:durationConstant)(r,e)):get(this.node(),r).duration}function easeConstant(e,r){if(typeof r!="function")throw new Error;return function(){set(this,e).ease=r}}function transition_ease(e){var r=this._id;return arguments.length?this.each(easeConstant(r,e)):get(this.node(),r).ease}function easeVarying(e,r){return function(){var t=r.apply(this,arguments);if(typeof t!="function")throw new Error;set(this,e).ease=t}}function transition_easeVarying(e){if(typeof e!="function")throw new Error;return this.each(easeVarying(this._id,e))}function transition_filter(e){typeof e!="function"&&(e=matcher(e));for(var r=this._groups,t=r.length,o=new Array(t),c=0;c<t;++c)for(var u=r[c],v=u.length,f=o[c]=[],g,_=0;_<v;++_)(g=u[_])&&e.call(g,g.__data__,_,u)&&f.push(g);return new Transition(o,this._parents,this._name,this._id)}function transition_merge(e){if(e._id!==this._id)throw new Error;for(var r=this._groups,t=e._groups,o=r.length,c=t.length,u=Math.min(o,c),v=new Array(o),f=0;f<u;++f)for(var g=r[f],_=t[f],p=g.length,E=v[f]=new Array(p),k,A=0;A<p;++A)(k=g[A]||_[A])&&(E[A]=k);for(;f<o;++f)v[f]=r[f];return new Transition(v,this._parents,this._name,this._id)}function start(e){return(e+"").trim().split(/^|\s+/).every(function(r){var t=r.indexOf(".");return t>=0&&(r=r.slice(0,t)),!r||r==="start"})}function onFunction(e,r,t){var o,c,u=start(r)?init:set;return function(){var v=u(this,e),f=v.on;f!==o&&(c=(o=f).copy()).on(r,t),v.on=c}}function transition_on(e,r){var t=this._id;return arguments.length<2?get(this.node(),t).on.on(e):this.each(onFunction(t,e,r))}function removeFunction(e){return function(){var r=this.parentNode;for(var t in this.__transition)if(+t!==e)return;r&&r.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(e){var r=this._name,t=this._id;typeof e!="function"&&(e=selector$h(e));for(var o=this._groups,c=o.length,u=new Array(c),v=0;v<c;++v)for(var f=o[v],g=f.length,_=u[v]=new Array(g),p,E,k=0;k<g;++k)(p=f[k])&&(E=e.call(p,p.__data__,k,f))&&("__data__"in p&&(E.__data__=p.__data__),_[k]=E,schedule(_[k],r,t,k,_,get(p,t)));return new Transition(u,this._parents,r,t)}function transition_selectAll(e){var r=this._name,t=this._id;typeof e!="function"&&(e=selectorAll(e));for(var o=this._groups,c=o.length,u=[],v=[],f=0;f<c;++f)for(var g=o[f],_=g.length,p,E=0;E<_;++E)if(p=g[E]){for(var k=e.call(p,p.__data__,E,g),A,z=get(p,t),l=0,s=k.length;l<s;++l)(A=k[l])&&schedule(A,r,t,l,k,z);u.push(k),v.push(p)}return new Transition(u,v,r,t)}var Selection=selection.prototype.constructor;function transition_selection(){return new Selection(this._groups,this._parents)}function styleNull(e,r){var t,o,c;return function(){var u=styleValue(this,e),v=(this.style.removeProperty(e),styleValue(this,e));return u===v?null:u===t&&v===o?c:c=r(t=u,o=v)}}function styleRemove(e){return function(){this.style.removeProperty(e)}}function styleConstant(e,r,t){var o,c=t+"",u;return function(){var v=styleValue(this,e);return v===c?null:v===o?u:u=r(o=v,t)}}function styleFunction(e,r,t){var o,c,u;return function(){var v=styleValue(this,e),f=t(this),g=f+"";return f==null&&(g=f=(this.style.removeProperty(e),styleValue(this,e))),v===g?null:v===o&&g===c?u:(c=g,u=r(o=v,f))}}function styleMaybeRemove(e,r){var t,o,c,u="style."+r,v="end."+u,f;return function(){var g=set(this,e),_=g.on,p=g.value[u]==null?f||(f=styleRemove(r)):void 0;(_!==t||c!==p)&&(o=(t=_).copy()).on(v,c=p),g.on=o}}function transition_style(e,r,t){var o=(e+="")=="transform"?interpolateTransformCss:interpolate;return r==null?this.styleTween(e,styleNull(e,o)).on("end.style."+e,styleRemove(e)):typeof r=="function"?this.styleTween(e,styleFunction(e,o,tweenValue(this,"style."+e,r))).each(styleMaybeRemove(this._id,e)):this.styleTween(e,styleConstant(e,o,r),t).on("end.style."+e,null)}function styleInterpolate(e,r,t){return function(o){this.style.setProperty(e,r.call(this,o),t)}}function styleTween(e,r,t){var o,c;function u(){var v=r.apply(this,arguments);return v!==c&&(o=(c=v)&&styleInterpolate(e,v,t)),o}return u._value=r,u}function transition_styleTween(e,r,t){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(r==null)return this.tween(o,null);if(typeof r!="function")throw new Error;return this.tween(o,styleTween(e,r,t??""))}function textConstant(e){return function(){this.textContent=e}}function textFunction(e){return function(){var r=e(this);this.textContent=r??""}}function transition_text(e){return this.tween("text",typeof e=="function"?textFunction(tweenValue(this,"text",e)):textConstant(e==null?"":e+""))}function textInterpolate(e){return function(r){this.textContent=e.call(this,r)}}function textTween(e){var r,t;function o(){var c=e.apply(this,arguments);return c!==t&&(r=(t=c)&&textInterpolate(c)),r}return o._value=e,o}function transition_textTween(e){var r="text";if(arguments.length<1)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,textTween(e))}function transition_transition(){for(var e=this._name,r=this._id,t=newId(),o=this._groups,c=o.length,u=0;u<c;++u)for(var v=o[u],f=v.length,g,_=0;_<f;++_)if(g=v[_]){var p=get(g,r);schedule(g,e,t,_,v,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new Transition(o,this._parents,e,t)}function transition_end(){var e,r,t=this,o=t._id,c=t.size();return new Promise(function(u,v){var f={value:v},g={value:function(){--c===0&&u()}};t.each(function(){var _=set(this,o),p=_.on;p!==e&&(r=(e=p).copy(),r._.cancel.push(f),r._.interrupt.push(f),r._.end.push(g)),_.on=r}),c===0&&u()})}var id=0;function Transition(e,r,t,o){this._groups=e,this._parents=r,this._name=t,this._id=o}function newId(){return++id}var selection_prototype=selection.prototype;Transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,easeVarying:transition_easeVarying,end:transition_end,[Symbol.iterator]:selection_prototype[Symbol.iterator]};function cubicInOut(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(e,r){for(var t;!(t=e.__transition)||!(t=t[r]);)if(!(e=e.parentNode))throw new Error(`transition ${r} not found`);return t}function selection_transition(e){var r,t;e instanceof Transition?(r=e._id,e=e._name):(r=newId(),(t=defaultTiming).time=now(),e=e==null?null:e+"");for(var o=this._groups,c=o.length,u=0;u<c;++u)for(var v=o[u],f=v.length,g,_=0;_<f;++_)(g=v[_])&&schedule(g,e,r,_,v,t||inherit(g,r));return new Transition(o,this._parents,e,r)}selection.prototype.interrupt=selection_interrupt;selection.prototype.transition=selection_transition;const constant=e=>()=>e;function ZoomEvent(e,{sourceEvent:r,target:t,transform:o,dispatch:c}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:r,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:c}})}function Transform(e,r,t){this.k=e,this.x=r,this.y=t}Transform.prototype={constructor:Transform,scale:function(e){return e===1?this:new Transform(this.k*e,this.x,this.y)},translate:function(e,r){return e===0&r===0?this:new Transform(this.k,this.x+this.k*e,this.y+this.k*r)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity=new Transform(1,0,0);Transform.prototype;function nopropagation(e){e.stopImmediatePropagation()}function noevent(e){e.preventDefault(),e.stopImmediatePropagation()}function defaultFilter(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function defaultExtent(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function defaultTransform(){return this.__zoom||identity}function defaultWheelDelta(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function defaultConstrain(e,r,t){var o=e.invertX(r[0][0])-t[0][0],c=e.invertX(r[1][0])-t[1][0],u=e.invertY(r[0][1])-t[0][1],v=e.invertY(r[1][1])-t[1][1];return e.translate(c>o?(o+c)/2:Math.min(0,o)||Math.max(0,c),v>u?(u+v)/2:Math.min(0,u)||Math.max(0,v))}function zoom(){var e=defaultFilter,r=defaultExtent,t=defaultConstrain,o=defaultWheelDelta,c=defaultTouchable,u=[0,1/0],v=[[-1/0,-1/0],[1/0,1/0]],f=250,g=interpolateZoom,_=dispatch("start","zoom","end"),p,E,k,A=500,z=150,l=0,s=10;function y(j){j.property("__zoom",defaultTransform).on("wheel.zoom",M,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",D).filter(c).on("touchstart.zoom",L).on("touchmove.zoom",X).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(j,H,$,q){var W=j.selection?j.selection():j;W.property("__zoom",defaultTransform),j!==W?h(j,H,$,q):W.interrupt().each(function(){x(this,arguments).event(q).start().zoom(null,typeof H=="function"?H.apply(this,arguments):H).end()})},y.scaleBy=function(j,H,$,q){y.scaleTo(j,function(){var W=this.__zoom.k,Y=typeof H=="function"?H.apply(this,arguments):H;return W*Y},$,q)},y.scaleTo=function(j,H,$,q){y.transform(j,function(){var W=r.apply(this,arguments),Y=this.__zoom,G=$==null?C(W):typeof $=="function"?$.apply(this,arguments):$,V=Y.invert(G),Z=typeof H=="function"?H.apply(this,arguments):H;return t(S(w(Y,Z),G,V),W,v)},$,q)},y.translateBy=function(j,H,$,q){y.transform(j,function(){return t(this.__zoom.translate(typeof H=="function"?H.apply(this,arguments):H,typeof $=="function"?$.apply(this,arguments):$),r.apply(this,arguments),v)},null,q)},y.translateTo=function(j,H,$,q,W){y.transform(j,function(){var Y=r.apply(this,arguments),G=this.__zoom,V=q==null?C(Y):typeof q=="function"?q.apply(this,arguments):q;return t(identity.translate(V[0],V[1]).scale(G.k).translate(typeof H=="function"?-H.apply(this,arguments):-H,typeof $=="function"?-$.apply(this,arguments):-$),Y,v)},q,W)};function w(j,H){return H=Math.max(u[0],Math.min(u[1],H)),H===j.k?j:new Transform(H,j.x,j.y)}function S(j,H,$){var q=H[0]-$[0]*j.k,W=H[1]-$[1]*j.k;return q===j.x&&W===j.y?j:new Transform(j.k,q,W)}function C(j){return[(+j[0][0]+ +j[1][0])/2,(+j[0][1]+ +j[1][1])/2]}function h(j,H,$,q){j.on("start.zoom",function(){x(this,arguments).event(q).start()}).on("interrupt.zoom end.zoom",function(){x(this,arguments).event(q).end()}).tween("zoom",function(){var W=this,Y=arguments,G=x(W,Y).event(q),V=r.apply(W,Y),Z=$==null?C(V):typeof $=="function"?$.apply(W,Y):$,xe=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),ce=W.__zoom,Ne=typeof H=="function"?H.apply(W,Y):H,Pe=g(ce.invert(Z).concat(xe/ce.k),Ne.invert(Z).concat(xe/Ne.k));return function(De){if(De===1)De=Ne;else{var Me=Pe(De),Be=xe/Me[2];De=new Transform(Be,Z[0]-Me[0]*Be,Z[1]-Me[1]*Be)}G.zoom(null,De)}})}function x(j,H,$){return!$&&j.__zooming||new R(j,H)}function R(j,H){this.that=j,this.args=H,this.active=0,this.sourceEvent=null,this.extent=r.apply(j,H),this.taps=0}R.prototype={event:function(j){return j&&(this.sourceEvent=j),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(j,H){return this.mouse&&j!=="mouse"&&(this.mouse[1]=H.invert(this.mouse[0])),this.touch0&&j!=="touch"&&(this.touch0[1]=H.invert(this.touch0[0])),this.touch1&&j!=="touch"&&(this.touch1[1]=H.invert(this.touch1[0])),this.that.__zoom=H,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(j){var H=select(this.that).datum();_.call(j,this.that,new ZoomEvent(j,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:_}),H)}};function M(j,...H){if(!e.apply(this,arguments))return;var $=x(this,H).event(j),q=this.__zoom,W=Math.max(u[0],Math.min(u[1],q.k*Math.pow(2,o.apply(this,arguments)))),Y=pointer(j);if($.wheel)($.mouse[0][0]!==Y[0]||$.mouse[0][1]!==Y[1])&&($.mouse[1]=q.invert($.mouse[0]=Y)),clearTimeout($.wheel);else{if(q.k===W)return;$.mouse=[Y,q.invert(Y)],interrupt(this),$.start()}noevent(j),$.wheel=setTimeout(G,z),$.zoom("mouse",t(S(w(q,W),$.mouse[0],$.mouse[1]),$.extent,v));function G(){$.wheel=null,$.end()}}function P(j,...H){if(k||!e.apply(this,arguments))return;var $=j.currentTarget,q=x(this,H,!0).event(j),W=select(j.view).on("mousemove.zoom",Z,!0).on("mouseup.zoom",xe,!0),Y=pointer(j,$),G=j.clientX,V=j.clientY;dragDisable(j.view),nopropagation(j),q.mouse=[Y,this.__zoom.invert(Y)],interrupt(this),q.start();function Z(ce){if(noevent(ce),!q.moved){var Ne=ce.clientX-G,Pe=ce.clientY-V;q.moved=Ne*Ne+Pe*Pe>l}q.event(ce).zoom("mouse",t(S(q.that.__zoom,q.mouse[0]=pointer(ce,$),q.mouse[1]),q.extent,v))}function xe(ce){W.on("mousemove.zoom mouseup.zoom",null),yesdrag(ce.view,q.moved),noevent(ce),q.event(ce).end()}}function D(j,...H){if(e.apply(this,arguments)){var $=this.__zoom,q=pointer(j.changedTouches?j.changedTouches[0]:j,this),W=$.invert(q),Y=$.k*(j.shiftKey?.5:2),G=t(S(w($,Y),q,W),r.apply(this,H),v);noevent(j),f>0?select(this).transition().duration(f).call(h,G,q,j):select(this).call(y.transform,G,q,j)}}function L(j,...H){if(e.apply(this,arguments)){var $=j.touches,q=$.length,W=x(this,H,j.changedTouches.length===q).event(j),Y,G,V,Z;for(nopropagation(j),G=0;G<q;++G)V=$[G],Z=pointer(V,this),Z=[Z,this.__zoom.invert(Z),V.identifier],W.touch0?!W.touch1&&W.touch0[2]!==Z[2]&&(W.touch1=Z,W.taps=0):(W.touch0=Z,Y=!0,W.taps=1+!!p);p&&(p=clearTimeout(p)),Y&&(W.taps<2&&(E=Z[0],p=setTimeout(function(){p=null},A)),interrupt(this),W.start())}}function X(j,...H){if(this.__zooming){var $=x(this,H).event(j),q=j.changedTouches,W=q.length,Y,G,V,Z;for(noevent(j),Y=0;Y<W;++Y)G=q[Y],V=pointer(G,this),$.touch0&&$.touch0[2]===G.identifier?$.touch0[0]=V:$.touch1&&$.touch1[2]===G.identifier&&($.touch1[0]=V);if(G=$.that.__zoom,$.touch1){var xe=$.touch0[0],ce=$.touch0[1],Ne=$.touch1[0],Pe=$.touch1[1],De=(De=Ne[0]-xe[0])*De+(De=Ne[1]-xe[1])*De,Me=(Me=Pe[0]-ce[0])*Me+(Me=Pe[1]-ce[1])*Me;G=w(G,Math.sqrt(De/Me)),V=[(xe[0]+Ne[0])/2,(xe[1]+Ne[1])/2],Z=[(ce[0]+Pe[0])/2,(ce[1]+Pe[1])/2]}else if($.touch0)V=$.touch0[0],Z=$.touch0[1];else return;$.zoom("touch",t(S(G,V,Z),$.extent,v))}}function B(j,...H){if(this.__zooming){var $=x(this,H).event(j),q=j.changedTouches,W=q.length,Y,G;for(nopropagation(j),k&&clearTimeout(k),k=setTimeout(function(){k=null},A),Y=0;Y<W;++Y)G=q[Y],$.touch0&&$.touch0[2]===G.identifier?delete $.touch0:$.touch1&&$.touch1[2]===G.identifier&&delete $.touch1;if($.touch1&&!$.touch0&&($.touch0=$.touch1,delete $.touch1),$.touch0)$.touch0[1]=this.__zoom.invert($.touch0[0]);else if($.end(),$.taps===2&&(G=pointer(G,this),Math.hypot(E[0]-G[0],E[1]-G[1])<s)){var V=select(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return y.wheelDelta=function(j){return arguments.length?(o=typeof j=="function"?j:constant(+j),y):o},y.filter=function(j){return arguments.length?(e=typeof j=="function"?j:constant(!!j),y):e},y.touchable=function(j){return arguments.length?(c=typeof j=="function"?j:constant(!!j),y):c},y.extent=function(j){return arguments.length?(r=typeof j=="function"?j:constant([[+j[0][0],+j[0][1]],[+j[1][0],+j[1][1]]]),y):r},y.scaleExtent=function(j){return arguments.length?(u[0]=+j[0],u[1]=+j[1],y):[u[0],u[1]]},y.translateExtent=function(j){return arguments.length?(v[0][0]=+j[0][0],v[1][0]=+j[1][0],v[0][1]=+j[0][1],v[1][1]=+j[1][1],y):[[v[0][0],v[0][1]],[v[1][0],v[1][1]]]},y.constrain=function(j){return arguments.length?(t=j,y):t},y.duration=function(j){return arguments.length?(f=+j,y):f},y.interpolate=function(j){return arguments.length?(g=j,y):g},y.on=function(){var j=_.on.apply(_,arguments);return j===_?y:j},y.clickDistance=function(j){return arguments.length?(l=(j=+j)*j,y):Math.sqrt(l)},y.tapDistance=function(j){return arguments.length?(s=+j,y):s},y}const StoreContext=reactExports.createContext(null),Provider$1=StoreContext.Provider,errorMessages={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,r)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?r.targetHandle:r.sourceHandle}", edge id: ${r.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},zustandErrorMessage=errorMessages.error001();function useStore(e,r){const t=reactExports.useContext(StoreContext);if(t===null)throw new Error(zustandErrorMessage);return useStoreWithEqualityFn(t,e,r)}const useStoreApi=()=>{const e=reactExports.useContext(StoreContext);if(e===null)throw new Error(zustandErrorMessage);return reactExports.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},selector$g=e=>e.userSelectionActive?"none":"all";function Panel({position:e,children:r,className:t,style:o,...c}){const u=useStore(selector$g),v=`${e}`.split("-");return React.createElement("div",{className:cc(["react-flow__panel",t,...v]),style:{...o,pointerEvents:u},...c},r)}function Attribution({proOptions:e,position:r="bottom-right"}){return e?.hideAttribution?null:React.createElement(Panel,{position:r,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},React.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const EdgeText=({x:e,y:r,label:t,labelStyle:o={},labelShowBg:c=!0,labelBgStyle:u={},labelBgPadding:v=[2,4],labelBgBorderRadius:f=2,children:g,className:_,...p})=>{const E=reactExports.useRef(null),[k,A]=reactExports.useState({x:0,y:0,width:0,height:0}),z=cc(["react-flow__edge-textwrapper",_]);return reactExports.useEffect(()=>{if(E.current){const l=E.current.getBBox();A({x:l.x,y:l.y,width:l.width,height:l.height})}},[t]),typeof t>"u"||!t?null:React.createElement("g",{transform:`translate(${e-k.width/2} ${r-k.height/2})`,className:z,visibility:k.width?"visible":"hidden",...p},c&&React.createElement("rect",{width:k.width+2*v[0],x:-v[0],y:-v[1],height:k.height+2*v[1],className:"react-flow__edge-textbg",style:u,rx:f,ry:f}),React.createElement("text",{className:"react-flow__edge-text",y:k.height/2,dy:"0.3em",ref:E,style:o},t),g)};var EdgeText$1=reactExports.memo(EdgeText);const getDimensions=e=>({width:e.offsetWidth,height:e.offsetHeight}),clamp=(e,r=0,t=1)=>Math.min(Math.max(e,r),t),clampPosition=(e={x:0,y:0},r)=>({x:clamp(e.x,r[0][0],r[1][0]),y:clamp(e.y,r[0][1],r[1][1])}),calcAutoPanVelocity=(e,r,t)=>e<r?clamp(Math.abs(e-r),1,50)/50:e>t?-clamp(Math.abs(e-t),1,50)/50:0,calcAutoPan=(e,r)=>{const t=calcAutoPanVelocity(e.x,35,r.width-35)*20,o=calcAutoPanVelocity(e.y,35,r.height-35)*20;return[t,o]},getHostForElement=e=>e.getRootNode?.()||window?.document,getBoundsOfBoxes=(e,r)=>({x:Math.min(e.x,r.x),y:Math.min(e.y,r.y),x2:Math.max(e.x2,r.x2),y2:Math.max(e.y2,r.y2)}),rectToBox=({x:e,y:r,width:t,height:o})=>({x:e,y:r,x2:e+t,y2:r+o}),boxToRect=({x:e,y:r,x2:t,y2:o})=>({x:e,y:r,width:t-e,height:o-r}),nodeToRect=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),getOverlappingArea=(e,r)=>{const t=Math.max(0,Math.min(e.x+e.width,r.x+r.width)-Math.max(e.x,r.x)),o=Math.max(0,Math.min(e.y+e.height,r.y+r.height)-Math.max(e.y,r.y));return Math.ceil(t*o)},isRectObject=e=>isNumeric(e.width)&&isNumeric(e.height)&&isNumeric(e.x)&&isNumeric(e.y),isNumeric=e=>!isNaN(e)&&isFinite(e),internalsSymbol=Symbol.for("internals"),elementSelectionKeys=["Enter"," ","Escape"],devWarn=(e,r)=>{},isReactKeyboardEvent=e=>"nativeEvent"in e;function isInputDOMNode(e){const t=(isReactKeyboardEvent(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(t?.nodeName)||t?.hasAttribute("contenteditable")||!!t?.closest(".nokey")}const isMouseEvent=e=>"clientX"in e,getEventPosition=(e,r)=>{const t=isMouseEvent(e),o=t?e.clientX:e.touches?.[0].clientX,c=t?e.clientY:e.touches?.[0].clientY;return{x:o-(r?.left??0),y:c-(r?.top??0)}},isMacOs=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,BaseEdge=({id:e,path:r,labelX:t,labelY:o,label:c,labelStyle:u,labelShowBg:v,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:_,style:p,markerEnd:E,markerStart:k,interactionWidth:A=20})=>React.createElement(React.Fragment,null,React.createElement("path",{id:e,style:p,d:r,fill:"none",className:"react-flow__edge-path",markerEnd:E,markerStart:k}),A&&React.createElement("path",{d:r,fill:"none",strokeOpacity:0,strokeWidth:A,className:"react-flow__edge-interaction"}),c&&isNumeric(t)&&isNumeric(o)?React.createElement(EdgeText$1,{x:t,y:o,label:c,labelStyle:u,labelShowBg:v,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:_}):null);BaseEdge.displayName="BaseEdge";function getMouseHandler$1(e,r,t){return t===void 0?t:o=>{const c=r().edges.find(u=>u.id===e);c&&t(o,{...c})}}function getEdgeCenter({sourceX:e,sourceY:r,targetX:t,targetY:o}){const c=Math.abs(t-e)/2,u=t<e?t+c:t-c,v=Math.abs(o-r)/2,f=o<r?o+v:o-v;return[u,f,c,v]}function getBezierEdgeCenter({sourceX:e,sourceY:r,targetX:t,targetY:o,sourceControlX:c,sourceControlY:u,targetControlX:v,targetControlY:f}){const g=e*.125+c*.375+v*.375+t*.125,_=r*.125+u*.375+f*.375+o*.125,p=Math.abs(g-e),E=Math.abs(_-r);return[g,_,p,E]}var ConnectionMode;(function(e){e.Strict="strict",e.Loose="loose"})(ConnectionMode||(ConnectionMode={}));var PanOnScrollMode;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(PanOnScrollMode||(PanOnScrollMode={}));var SelectionMode;(function(e){e.Partial="partial",e.Full="full"})(SelectionMode||(SelectionMode={}));var ConnectionLineType;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ConnectionLineType||(ConnectionLineType={}));var MarkerType;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(MarkerType||(MarkerType={}));var Position;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Position||(Position={}));function getControl({pos:e,x1:r,y1:t,x2:o,y2:c}){return e===Position.Left||e===Position.Right?[.5*(r+o),t]:[r,.5*(t+c)]}function getSimpleBezierPath({sourceX:e,sourceY:r,sourcePosition:t=Position.Bottom,targetX:o,targetY:c,targetPosition:u=Position.Top}){const[v,f]=getControl({pos:t,x1:e,y1:r,x2:o,y2:c}),[g,_]=getControl({pos:u,x1:o,y1:c,x2:e,y2:r}),[p,E,k,A]=getBezierEdgeCenter({sourceX:e,sourceY:r,targetX:o,targetY:c,sourceControlX:v,sourceControlY:f,targetControlX:g,targetControlY:_});return[`M${e},${r} C${v},${f} ${g},${_} ${o},${c}`,p,E,k,A]}const SimpleBezierEdge=reactExports.memo(({sourceX:e,sourceY:r,targetX:t,targetY:o,sourcePosition:c=Position.Bottom,targetPosition:u=Position.Top,label:v,labelStyle:f,labelShowBg:g,labelBgStyle:_,labelBgPadding:p,labelBgBorderRadius:E,style:k,markerEnd:A,markerStart:z,interactionWidth:l})=>{const[s,y,w]=getSimpleBezierPath({sourceX:e,sourceY:r,sourcePosition:c,targetX:t,targetY:o,targetPosition:u});return React.createElement(BaseEdge,{path:s,labelX:y,labelY:w,label:v,labelStyle:f,labelShowBg:g,labelBgStyle:_,labelBgPadding:p,labelBgBorderRadius:E,style:k,markerEnd:A,markerStart:z,interactionWidth:l})});SimpleBezierEdge.displayName="SimpleBezierEdge";const handleDirections={[Position.Left]:{x:-1,y:0},[Position.Right]:{x:1,y:0},[Position.Top]:{x:0,y:-1},[Position.Bottom]:{x:0,y:1}},getDirection=({source:e,sourcePosition:r=Position.Bottom,target:t})=>r===Position.Left||r===Position.Right?e.x<t.x?{x:1,y:0}:{x:-1,y:0}:e.y<t.y?{x:0,y:1}:{x:0,y:-1},distance=(e,r)=>Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));function getPoints({source:e,sourcePosition:r=Position.Bottom,target:t,targetPosition:o=Position.Top,center:c,offset:u}){const v=handleDirections[r],f=handleDirections[o],g={x:e.x+v.x*u,y:e.y+v.y*u},_={x:t.x+f.x*u,y:t.y+f.y*u},p=getDirection({source:g,sourcePosition:r,target:_}),E=p.x!==0?"x":"y",k=p[E];let A=[],z,l;const s={x:0,y:0},y={x:0,y:0},[w,S,C,h]=getEdgeCenter({sourceX:e.x,sourceY:e.y,targetX:t.x,targetY:t.y});if(v[E]*f[E]===-1){z=c.x??w,l=c.y??S;const R=[{x:z,y:g.y},{x:z,y:_.y}],M=[{x:g.x,y:l},{x:_.x,y:l}];v[E]===k?A=E==="x"?R:M:A=E==="x"?M:R}else{const R=[{x:g.x,y:_.y}],M=[{x:_.x,y:g.y}];if(E==="x"?A=v.x===k?M:R:A=v.y===k?R:M,r===o){const B=Math.abs(e[E]-t[E]);if(B<=u){const j=Math.min(u-1,u-B);v[E]===k?s[E]=(g[E]>e[E]?-1:1)*j:y[E]=(_[E]>t[E]?-1:1)*j}}if(r!==o){const B=E==="x"?"y":"x",j=v[E]===f[B],H=g[B]>_[B],$=g[B]<_[B];(v[E]===1&&(!j&&H||j&&$)||v[E]!==1&&(!j&&$||j&&H))&&(A=E==="x"?R:M)}const P={x:g.x+s.x,y:g.y+s.y},D={x:_.x+y.x,y:_.y+y.y},L=Math.max(Math.abs(P.x-A[0].x),Math.abs(D.x-A[0].x)),X=Math.max(Math.abs(P.y-A[0].y),Math.abs(D.y-A[0].y));L>=X?(z=(P.x+D.x)/2,l=A[0].y):(z=A[0].x,l=(P.y+D.y)/2)}return[[e,{x:g.x+s.x,y:g.y+s.y},...A,{x:_.x+y.x,y:_.y+y.y},t],z,l,C,h]}function getBend(e,r,t,o){const c=Math.min(distance(e,r)/2,distance(r,t)/2,o),{x:u,y:v}=r;if(e.x===u&&u===t.x||e.y===v&&v===t.y)return`L${u} ${v}`;if(e.y===v){const _=e.x<t.x?-1:1,p=e.y<t.y?1:-1;return`L ${u+c*_},${v}Q ${u},${v} ${u},${v+c*p}`}const f=e.x<t.x?1:-1,g=e.y<t.y?-1:1;return`L ${u},${v+c*g}Q ${u},${v} ${u+c*f},${v}`}function getSmoothStepPath({sourceX:e,sourceY:r,sourcePosition:t=Position.Bottom,targetX:o,targetY:c,targetPosition:u=Position.Top,borderRadius:v=5,centerX:f,centerY:g,offset:_=20}){const[p,E,k,A,z]=getPoints({source:{x:e,y:r},sourcePosition:t,target:{x:o,y:c},targetPosition:u,center:{x:f,y:g},offset:_});return[p.reduce((s,y,w)=>{let S="";return w>0&&w<p.length-1?S=getBend(p[w-1],y,p[w+1],v):S=`${w===0?"M":"L"}${y.x} ${y.y}`,s+=S,s},""),E,k,A,z]}const SmoothStepEdge=reactExports.memo(({sourceX:e,sourceY:r,targetX:t,targetY:o,label:c,labelStyle:u,labelShowBg:v,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:_,style:p,sourcePosition:E=Position.Bottom,targetPosition:k=Position.Top,markerEnd:A,markerStart:z,pathOptions:l,interactionWidth:s})=>{const[y,w,S]=getSmoothStepPath({sourceX:e,sourceY:r,sourcePosition:E,targetX:t,targetY:o,targetPosition:k,borderRadius:l?.borderRadius,offset:l?.offset});return React.createElement(BaseEdge,{path:y,labelX:w,labelY:S,label:c,labelStyle:u,labelShowBg:v,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:_,style:p,markerEnd:A,markerStart:z,interactionWidth:s})});SmoothStepEdge.displayName="SmoothStepEdge";const StepEdge=reactExports.memo(e=>React.createElement(SmoothStepEdge,{...e,pathOptions:reactExports.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));StepEdge.displayName="StepEdge";function getStraightPath({sourceX:e,sourceY:r,targetX:t,targetY:o}){const[c,u,v,f]=getEdgeCenter({sourceX:e,sourceY:r,targetX:t,targetY:o});return[`M ${e},${r}L ${t},${o}`,c,u,v,f]}const StraightEdge=reactExports.memo(({sourceX:e,sourceY:r,targetX:t,targetY:o,label:c,labelStyle:u,labelShowBg:v,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:_,style:p,markerEnd:E,markerStart:k,interactionWidth:A})=>{const[z,l,s]=getStraightPath({sourceX:e,sourceY:r,targetX:t,targetY:o});return React.createElement(BaseEdge,{path:z,labelX:l,labelY:s,label:c,labelStyle:u,labelShowBg:v,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:_,style:p,markerEnd:E,markerStart:k,interactionWidth:A})});StraightEdge.displayName="StraightEdge";function calculateControlOffset(e,r){return e>=0?.5*e:r*25*Math.sqrt(-e)}function getControlWithCurvature({pos:e,x1:r,y1:t,x2:o,y2:c,c:u}){switch(e){case Position.Left:return[r-calculateControlOffset(r-o,u),t];case Position.Right:return[r+calculateControlOffset(o-r,u),t];case Position.Top:return[r,t-calculateControlOffset(t-c,u)];case Position.Bottom:return[r,t+calculateControlOffset(c-t,u)]}}function getBezierPath({sourceX:e,sourceY:r,sourcePosition:t=Position.Bottom,targetX:o,targetY:c,targetPosition:u=Position.Top,curvature:v=.25}){const[f,g]=getControlWithCurvature({pos:t,x1:e,y1:r,x2:o,y2:c,c:v}),[_,p]=getControlWithCurvature({pos:u,x1:o,y1:c,x2:e,y2:r,c:v}),[E,k,A,z]=getBezierEdgeCenter({sourceX:e,sourceY:r,targetX:o,targetY:c,sourceControlX:f,sourceControlY:g,targetControlX:_,targetControlY:p});return[`M${e},${r} C${f},${g} ${_},${p} ${o},${c}`,E,k,A,z]}const BezierEdge=reactExports.memo(({sourceX:e,sourceY:r,targetX:t,targetY:o,sourcePosition:c=Position.Bottom,targetPosition:u=Position.Top,label:v,labelStyle:f,labelShowBg:g,labelBgStyle:_,labelBgPadding:p,labelBgBorderRadius:E,style:k,markerEnd:A,markerStart:z,pathOptions:l,interactionWidth:s})=>{const[y,w,S]=getBezierPath({sourceX:e,sourceY:r,sourcePosition:c,targetX:t,targetY:o,targetPosition:u,curvature:l?.curvature});return React.createElement(BaseEdge,{path:y,labelX:w,labelY:S,label:v,labelStyle:f,labelShowBg:g,labelBgStyle:_,labelBgPadding:p,labelBgBorderRadius:E,style:k,markerEnd:A,markerStart:z,interactionWidth:s})});BezierEdge.displayName="BezierEdge";const NodeIdContext=reactExports.createContext(null),Provider$2=NodeIdContext.Provider;NodeIdContext.Consumer;const useNodeId=()=>reactExports.useContext(NodeIdContext),isEdge=e=>"id"in e&&"source"in e&&"target"in e,getEdgeId=({source:e,sourceHandle:r,target:t,targetHandle:o})=>`reactflow__edge-${e}${r||""}-${t}${o||""}`,getMarkerId=(e,r)=>typeof e>"u"?"":typeof e=="string"?e:`${r?`${r}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,connectionExists=(e,r)=>r.some(t=>t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle)),addEdge=(e,r)=>{if(!e.source||!e.target)return r;let t;return isEdge(e)?t={...e}:t={...e,id:getEdgeId(e)},connectionExists(t,r)?r:r.concat(t)},pointToRendererPoint=({x:e,y:r},[t,o,c],u,[v,f])=>{const g={x:(e-t)/c,y:(r-o)/c};return u?{x:v*Math.round(g.x/v),y:f*Math.round(g.y/f)}:g},rendererPointToPoint=({x:e,y:r},[t,o,c])=>({x:e*c+t,y:r*c+o}),getNodePositionWithOrigin=(e,r=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const t=(e.width??0)*r[0],o=(e.height??0)*r[1],c={x:e.position.x-t,y:e.position.y-o};return{...c,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-t,y:e.positionAbsolute.y-o}:c}},getNodesBounds=(e,r=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const t=e.reduce((o,c)=>{const{x:u,y:v}=getNodePositionWithOrigin(c,r).positionAbsolute;return getBoundsOfBoxes(o,rectToBox({x:u,y:v,width:c.width||0,height:c.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return boxToRect(t)},getNodesInside=(e,r,[t,o,c]=[0,0,1],u=!1,v=!1,f=[0,0])=>{const g={x:(r.x-t)/c,y:(r.y-o)/c,width:r.width/c,height:r.height/c},_=[];return e.forEach(p=>{const{width:E,height:k,selectable:A=!0,hidden:z=!1}=p;if(v&&!A||z)return!1;const{positionAbsolute:l}=getNodePositionWithOrigin(p,f),s={x:l.x,y:l.y,width:E||0,height:k||0},y=getOverlappingArea(g,s),w=typeof E>"u"||typeof k>"u"||E===null||k===null,S=u&&y>0,C=(E||0)*(k||0);(w||S||y>=C||p.dragging)&&_.push(p)}),_},getConnectedEdges=(e,r)=>{const t=e.map(o=>o.id);return r.filter(o=>t.includes(o.source)||t.includes(o.target))},getViewportForBounds=(e,r,t,o,c,u=.1)=>{const v=r/(e.width*(1+u)),f=t/(e.height*(1+u)),g=Math.min(v,f),_=clamp(g,o,c),p=e.x+e.width/2,E=e.y+e.height/2,k=r/2-p*_,A=t/2-E*_;return{x:k,y:A,zoom:_}},getD3Transition=(e,r=0)=>e.transition().duration(r);function getHandles(e,r,t,o){return(r[t]||[]).reduce((c,u)=>(`${e.id}-${u.id}-${t}`!==o&&c.push({id:u.id||null,type:t,nodeId:e.id,x:(e.positionAbsolute?.x??0)+u.x+u.width/2,y:(e.positionAbsolute?.y??0)+u.y+u.height/2}),c),[])}function getClosestHandle(e,r,t,o,c,u){const{x:v,y:f}=getEventPosition(e),_=r.elementsFromPoint(v,f).find(z=>z.classList.contains("react-flow__handle"));if(_){const z=_.getAttribute("data-nodeid");if(z){const l=getHandleType(void 0,_),s=_.getAttribute("data-handleid"),y=u({nodeId:z,id:s,type:l});if(y){const w=c.find(S=>S.nodeId===z&&S.type===l&&S.id===s);return{handle:{id:s,type:l,nodeId:z,x:w?.x||t.x,y:w?.y||t.y},validHandleResult:y}}}}let p=[],E=1/0;if(c.forEach(z=>{const l=Math.sqrt((z.x-t.x)**2+(z.y-t.y)**2);if(l<=o){const s=u(z);l<=E&&(l<E?p=[{handle:z,validHandleResult:s}]:l===E&&p.push({handle:z,validHandleResult:s}),E=l)}}),!p.length)return{handle:null,validHandleResult:defaultResult()};if(p.length===1)return p[0];const k=p.some(({validHandleResult:z})=>z.isValid),A=p.some(({handle:z})=>z.type==="target");return p.find(({handle:z,validHandleResult:l})=>A?z.type==="target":k?l.isValid:!0)||p[0]}const nullConnection={source:null,target:null,sourceHandle:null,targetHandle:null},defaultResult=()=>({handleDomNode:null,isValid:!1,connection:nullConnection,endHandle:null});function isValidHandle(e,r,t,o,c,u,v){const f=c==="target",g=v.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),_={...defaultResult(),handleDomNode:g};if(g){const p=getHandleType(void 0,g),E=g.getAttribute("data-nodeid"),k=g.getAttribute("data-handleid"),A=g.classList.contains("connectable"),z=g.classList.contains("connectableend"),l={source:f?E:t,sourceHandle:f?k:o,target:f?t:E,targetHandle:f?o:k};_.connection=l,A&&z&&(r===ConnectionMode.Strict?f&&p==="source"||!f&&p==="target":E!==t||k!==o)&&(_.endHandle={nodeId:E,handleId:k,type:p},_.isValid=u(l))}return _}function getHandleLookup({nodes:e,nodeId:r,handleId:t,handleType:o}){return e.reduce((c,u)=>{if(u[internalsSymbol]){const{handleBounds:v}=u[internalsSymbol];let f=[],g=[];v&&(f=getHandles(u,v,"source",`${r}-${t}-${o}`),g=getHandles(u,v,"target",`${r}-${t}-${o}`)),c.push(...f,...g)}return c},[])}function getHandleType(e,r){return e||(r?.classList.contains("target")?"target":r?.classList.contains("source")?"source":null)}function resetRecentHandle(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function getConnectionStatus(e,r){let t=null;return r?t="valid":e&&!r&&(t="invalid"),t}function handlePointerDown({event:e,handleId:r,nodeId:t,onConnect:o,isTarget:c,getState:u,setState:v,isValidConnection:f,edgeUpdaterType:g,onReconnectEnd:_}){const p=getHostForElement(e.target),{connectionMode:E,domNode:k,autoPanOnConnect:A,connectionRadius:z,onConnectStart:l,panBy:s,getNodes:y,cancelConnection:w}=u();let S=0,C;const{x:h,y:x}=getEventPosition(e),R=p?.elementFromPoint(h,x),M=getHandleType(g,R),P=k?.getBoundingClientRect();if(!P||!M)return;let D,L=getEventPosition(e,P),X=!1,B=null,j=!1,H=null;const $=getHandleLookup({nodes:y(),nodeId:t,handleId:r,handleType:M}),q=()=>{if(!A)return;const[G,V]=calcAutoPan(L,P);s({x:G,y:V}),S=requestAnimationFrame(q)};v({connectionPosition:L,connectionStatus:null,connectionNodeId:t,connectionHandleId:r,connectionHandleType:M,connectionStartHandle:{nodeId:t,handleId:r,type:M},connectionEndHandle:null}),l?.(e,{nodeId:t,handleId:r,handleType:M});function W(G){const{transform:V}=u();L=getEventPosition(G,P);const{handle:Z,validHandleResult:xe}=getClosestHandle(G,p,pointToRendererPoint(L,V,!1,[1,1]),z,$,ce=>isValidHandle(ce,E,t,r,c?"target":"source",f,p));if(C=Z,X||(q(),X=!0),H=xe.handleDomNode,B=xe.connection,j=xe.isValid,v({connectionPosition:C&&j?rendererPointToPoint({x:C.x,y:C.y},V):L,connectionStatus:getConnectionStatus(!!C,j),connectionEndHandle:xe.endHandle}),!C&&!j&&!H)return resetRecentHandle(D);B.source!==B.target&&H&&(resetRecentHandle(D),D=H,H.classList.add("connecting","react-flow__handle-connecting"),H.classList.toggle("valid",j),H.classList.toggle("react-flow__handle-valid",j))}function Y(G){(C||H)&&B&&j&&o?.(B),u().onConnectEnd?.(G),g&&_?.(G),resetRecentHandle(D),w(),cancelAnimationFrame(S),X=!1,j=!1,B=null,H=null,p.removeEventListener("mousemove",W),p.removeEventListener("mouseup",Y),p.removeEventListener("touchmove",W),p.removeEventListener("touchend",Y)}p.addEventListener("mousemove",W),p.addEventListener("mouseup",Y),p.addEventListener("touchmove",W),p.addEventListener("touchend",Y)}const alwaysValid=()=>!0,selector$f=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),connectingSelector=(e,r,t)=>o=>{const{connectionStartHandle:c,connectionEndHandle:u,connectionClickStartHandle:v}=o;return{connecting:c?.nodeId===e&&c?.handleId===r&&c?.type===t||u?.nodeId===e&&u?.handleId===r&&u?.type===t,clickConnecting:v?.nodeId===e&&v?.handleId===r&&v?.type===t}},Handle=reactExports.forwardRef(({type:e="source",position:r=Position.Top,isValidConnection:t,isConnectable:o=!0,isConnectableStart:c=!0,isConnectableEnd:u=!0,id:v,onConnect:f,children:g,className:_,onMouseDown:p,onTouchStart:E,...k},A)=>{const z=v||null,l=e==="target",s=useStoreApi(),y=useNodeId(),{connectOnClick:w,noPanClassName:S}=useStore(selector$f,shallow$1),{connecting:C,clickConnecting:h}=useStore(connectingSelector(y,z,e),shallow$1);y||s.getState().onError?.("010",errorMessages.error010());const x=P=>{const{defaultEdgeOptions:D,onConnect:L,hasDefaultEdges:X}=s.getState(),B={...D,...P};if(X){const{edges:j,setEdges:H}=s.getState();H(addEdge(B,j))}L?.(B),f?.(B)},R=P=>{if(!y)return;const D=isMouseEvent(P);c&&(D&&P.button===0||!D)&&handlePointerDown({event:P,handleId:z,nodeId:y,onConnect:x,isTarget:l,getState:s.getState,setState:s.setState,isValidConnection:t||s.getState().isValidConnection||alwaysValid}),D?p?.(P):E?.(P)},M=P=>{const{onClickConnectStart:D,onClickConnectEnd:L,connectionClickStartHandle:X,connectionMode:B,isValidConnection:j}=s.getState();if(!y||!X&&!c)return;if(!X){D?.(P,{nodeId:y,handleId:z,handleType:e}),s.setState({connectionClickStartHandle:{nodeId:y,type:e,handleId:z}});return}const H=getHostForElement(P.target),$=t||j||alwaysValid,{connection:q,isValid:W}=isValidHandle({nodeId:y,id:z,type:e},B,X.nodeId,X.handleId||null,X.type,$,H);W&&x(q),L?.(P),s.setState({connectionClickStartHandle:null})};return React.createElement("div",{"data-handleid":z,"data-nodeid":y,"data-handlepos":r,"data-id":`${y}-${z}-${e}`,className:cc(["react-flow__handle",`react-flow__handle-${r}`,"nodrag",S,_,{source:!l,target:l,connectable:o,connectablestart:c,connectableend:u,connecting:h,connectionindicator:o&&(c&&!C||u&&C)}]),onMouseDown:R,onTouchStart:R,onClick:w?M:void 0,ref:A,...k},g)});Handle.displayName="Handle";var Handle$1=reactExports.memo(Handle);const DefaultNode=({data:e,isConnectable:r,targetPosition:t=Position.Top,sourcePosition:o=Position.Bottom})=>React.createElement(React.Fragment,null,React.createElement(Handle$1,{type:"target",position:t,isConnectable:r}),e?.label,React.createElement(Handle$1,{type:"source",position:o,isConnectable:r}));DefaultNode.displayName="DefaultNode";var DefaultNode$1=reactExports.memo(DefaultNode);const InputNode=({data:e,isConnectable:r,sourcePosition:t=Position.Bottom})=>React.createElement(React.Fragment,null,e?.label,React.createElement(Handle$1,{type:"source",position:t,isConnectable:r}));InputNode.displayName="InputNode";var InputNode$1=reactExports.memo(InputNode);const OutputNode=({data:e,isConnectable:r,targetPosition:t=Position.Top})=>React.createElement(React.Fragment,null,React.createElement(Handle$1,{type:"target",position:t,isConnectable:r}),e?.label);OutputNode.displayName="OutputNode";var OutputNode$1=reactExports.memo(OutputNode);const GroupNode=()=>null;GroupNode.displayName="GroupNode";const selector$e=e=>({selectedNodes:e.getNodes().filter(r=>r.selected),selectedEdges:e.edges.filter(r=>r.selected).map(r=>({...r}))}),selectId=e=>e.id;function areEqual(e,r){return shallow$1(e.selectedNodes.map(selectId),r.selectedNodes.map(selectId))&&shallow$1(e.selectedEdges.map(selectId),r.selectedEdges.map(selectId))}const SelectionListener=reactExports.memo(({onSelectionChange:e})=>{const r=useStoreApi(),{selectedNodes:t,selectedEdges:o}=useStore(selector$e,areEqual);return reactExports.useEffect(()=>{const c={nodes:t,edges:o};e?.(c),r.getState().onSelectionChange.forEach(u=>u(c))},[t,o,e]),null});SelectionListener.displayName="SelectionListener";const changeSelector=e=>!!e.onSelectionChange;function Wrapper$1({onSelectionChange:e}){const r=useStore(changeSelector);return e||r?React.createElement(SelectionListener,{onSelectionChange:e}):null}const selector$d=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function useStoreUpdater(e,r){reactExports.useEffect(()=>{typeof e<"u"&&r(e)},[e])}function useDirectStoreUpdater(e,r,t){reactExports.useEffect(()=>{typeof r<"u"&&t({[e]:r})},[r])}const StoreUpdater=({nodes:e,edges:r,defaultNodes:t,defaultEdges:o,onConnect:c,onConnectStart:u,onConnectEnd:v,onClickConnectStart:f,onClickConnectEnd:g,nodesDraggable:_,nodesConnectable:p,nodesFocusable:E,edgesFocusable:k,edgesUpdatable:A,elevateNodesOnSelect:z,minZoom:l,maxZoom:s,nodeExtent:y,onNodesChange:w,onEdgesChange:S,elementsSelectable:C,connectionMode:h,snapGrid:x,snapToGrid:R,translateExtent:M,connectOnClick:P,defaultEdgeOptions:D,fitView:L,fitViewOptions:X,onNodesDelete:B,onEdgesDelete:j,onNodeDrag:H,onNodeDragStart:$,onNodeDragStop:q,onSelectionDrag:W,onSelectionDragStart:Y,onSelectionDragStop:G,noPanClassName:V,nodeOrigin:Z,rfId:xe,autoPanOnConnect:ce,autoPanOnNodeDrag:Ne,onError:Pe,connectionRadius:De,isValidConnection:Me,nodeDragThreshold:Be})=>{const{setNodes:ft,setEdges:jt,setDefaultNodesAndEdges:Gt,setMinZoom:mt,setMaxZoom:Fe,setTranslateExtent:ht,setNodeExtent:Kt,reset:Jt}=useStore(selector$d,shallow$1),Wt=useStoreApi();return reactExports.useEffect(()=>{const Br=o?.map(zr=>({...zr,...D}));return Gt(t,Br),()=>{Jt()}},[]),useDirectStoreUpdater("defaultEdgeOptions",D,Wt.setState),useDirectStoreUpdater("connectionMode",h,Wt.setState),useDirectStoreUpdater("onConnect",c,Wt.setState),useDirectStoreUpdater("onConnectStart",u,Wt.setState),useDirectStoreUpdater("onConnectEnd",v,Wt.setState),useDirectStoreUpdater("onClickConnectStart",f,Wt.setState),useDirectStoreUpdater("onClickConnectEnd",g,Wt.setState),useDirectStoreUpdater("nodesDraggable",_,Wt.setState),useDirectStoreUpdater("nodesConnectable",p,Wt.setState),useDirectStoreUpdater("nodesFocusable",E,Wt.setState),useDirectStoreUpdater("edgesFocusable",k,Wt.setState),useDirectStoreUpdater("edgesUpdatable",A,Wt.setState),useDirectStoreUpdater("elementsSelectable",C,Wt.setState),useDirectStoreUpdater("elevateNodesOnSelect",z,Wt.setState),useDirectStoreUpdater("snapToGrid",R,Wt.setState),useDirectStoreUpdater("snapGrid",x,Wt.setState),useDirectStoreUpdater("onNodesChange",w,Wt.setState),useDirectStoreUpdater("onEdgesChange",S,Wt.setState),useDirectStoreUpdater("connectOnClick",P,Wt.setState),useDirectStoreUpdater("fitViewOnInit",L,Wt.setState),useDirectStoreUpdater("fitViewOnInitOptions",X,Wt.setState),useDirectStoreUpdater("onNodesDelete",B,Wt.setState),useDirectStoreUpdater("onEdgesDelete",j,Wt.setState),useDirectStoreUpdater("onNodeDrag",H,Wt.setState),useDirectStoreUpdater("onNodeDragStart",$,Wt.setState),useDirectStoreUpdater("onNodeDragStop",q,Wt.setState),useDirectStoreUpdater("onSelectionDrag",W,Wt.setState),useDirectStoreUpdater("onSelectionDragStart",Y,Wt.setState),useDirectStoreUpdater("onSelectionDragStop",G,Wt.setState),useDirectStoreUpdater("noPanClassName",V,Wt.setState),useDirectStoreUpdater("nodeOrigin",Z,Wt.setState),useDirectStoreUpdater("rfId",xe,Wt.setState),useDirectStoreUpdater("autoPanOnConnect",ce,Wt.setState),useDirectStoreUpdater("autoPanOnNodeDrag",Ne,Wt.setState),useDirectStoreUpdater("onError",Pe,Wt.setState),useDirectStoreUpdater("connectionRadius",De,Wt.setState),useDirectStoreUpdater("isValidConnection",Me,Wt.setState),useDirectStoreUpdater("nodeDragThreshold",Be,Wt.setState),useStoreUpdater(e,ft),useStoreUpdater(r,jt),useStoreUpdater(l,mt),useStoreUpdater(s,Fe),useStoreUpdater(M,ht),useStoreUpdater(y,Kt),null},style={display:"none"},ariaLiveStyle={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ARIA_NODE_DESC_KEY="react-flow__node-desc",ARIA_EDGE_DESC_KEY="react-flow__edge-desc",ARIA_LIVE_MESSAGE="react-flow__aria-live",selector$c=e=>e.ariaLiveMessage;function AriaLiveMessage({rfId:e}){const r=useStore(selector$c);return React.createElement("div",{id:`${ARIA_LIVE_MESSAGE}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:ariaLiveStyle},r)}function A11yDescriptions({rfId:e,disableKeyboardA11y:r}){return React.createElement(React.Fragment,null,React.createElement("div",{id:`${ARIA_NODE_DESC_KEY}-${e}`,style},"Press enter or space to select a node.",!r&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),React.createElement("div",{id:`${ARIA_EDGE_DESC_KEY}-${e}`,style},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!r&&React.createElement(AriaLiveMessage,{rfId:e}))}var useKeyPress=(e=null,r={actInsideInputWithModifier:!0})=>{const[t,o]=reactExports.useState(!1),c=reactExports.useRef(!1),u=reactExports.useRef(new Set([])),[v,f]=reactExports.useMemo(()=>{if(e!==null){const _=(Array.isArray(e)?e:[e]).filter(E=>typeof E=="string").map(E=>E.split("+")),p=_.reduce((E,k)=>E.concat(...k),[]);return[_,p]}return[[],[]]},[e]);return reactExports.useEffect(()=>{const g=typeof document<"u"?document:null,_=r?.target||g;if(e!==null){const p=A=>{if(c.current=A.ctrlKey||A.metaKey||A.shiftKey,(!c.current||c.current&&!r.actInsideInputWithModifier)&&isInputDOMNode(A))return!1;const l=useKeyOrCode(A.code,f);u.current.add(A[l]),isMatchingKey(v,u.current,!1)&&(A.preventDefault(),o(!0))},E=A=>{if((!c.current||c.current&&!r.actInsideInputWithModifier)&&isInputDOMNode(A))return!1;const l=useKeyOrCode(A.code,f);isMatchingKey(v,u.current,!0)?(o(!1),u.current.clear()):u.current.delete(A[l]),A.key==="Meta"&&u.current.clear(),c.current=!1},k=()=>{u.current.clear(),o(!1)};return _?.addEventListener("keydown",p),_?.addEventListener("keyup",E),window.addEventListener("blur",k),()=>{_?.removeEventListener("keydown",p),_?.removeEventListener("keyup",E),window.removeEventListener("blur",k)}}},[e,o]),t};function isMatchingKey(e,r,t){return e.filter(o=>t||o.length===r.size).some(o=>o.every(c=>r.has(c)))}function useKeyOrCode(e,r){return r.includes(e)?"code":"key"}function calculateXYZPosition(e,r,t,o){const c=e.parentNode||e.parentId;if(!c)return t;const u=r.get(c),v=getNodePositionWithOrigin(u,o);return calculateXYZPosition(u,r,{x:(t.x??0)+v.x,y:(t.y??0)+v.y,z:(u[internalsSymbol]?.z??0)>(t.z??0)?u[internalsSymbol]?.z??0:t.z??0},o)}function updateAbsoluteNodePositions(e,r,t){e.forEach(o=>{const c=o.parentNode||o.parentId;if(c&&!e.has(c))throw new Error(`Parent node ${c} not found`);if(c||t?.[o.id]){const{x:u,y:v,z:f}=calculateXYZPosition(o,e,{...o.position,z:o[internalsSymbol]?.z??0},r);o.positionAbsolute={x:u,y:v},o[internalsSymbol].z=f,t?.[o.id]&&(o[internalsSymbol].isParent=!0)}})}function createNodeInternals(e,r,t,o){const c=new Map,u={},v=o?1e3:0;return e.forEach(f=>{const g=(isNumeric(f.zIndex)?f.zIndex:0)+(f.selected?v:0),_=r.get(f.id),p={...f,positionAbsolute:{x:f.position.x,y:f.position.y}},E=f.parentNode||f.parentId;E&&(u[E]=!0);const k=_?.type&&_?.type!==f.type;Object.defineProperty(p,internalsSymbol,{enumerable:!1,value:{handleBounds:k?void 0:_?.[internalsSymbol]?.handleBounds,z:g}}),c.set(f.id,p)}),updateAbsoluteNodePositions(c,t,u),c}function fitView(e,r={}){const{getNodes:t,width:o,height:c,minZoom:u,maxZoom:v,d3Zoom:f,d3Selection:g,fitViewOnInitDone:_,fitViewOnInit:p,nodeOrigin:E}=e(),k=r.initial&&!_&&p;if(f&&g&&(k||!r.initial)){const z=t().filter(s=>{const y=r.includeHiddenNodes?s.width&&s.height:!s.hidden;return r.nodes?.length?y&&r.nodes.some(w=>w.id===s.id):y}),l=z.every(s=>s.width&&s.height);if(z.length>0&&l){const s=getNodesBounds(z,E),{x:y,y:w,zoom:S}=getViewportForBounds(s,o,c,r.minZoom??u,r.maxZoom??v,r.padding??.1),C=identity.translate(y,w).scale(S);return typeof r.duration=="number"&&r.duration>0?f.transform(getD3Transition(g,r.duration),C):f.transform(g,C),!0}}return!1}function handleControlledNodeSelectionChange(e,r){return e.forEach(t=>{const o=r.get(t.id);o&&r.set(o.id,{...o,[internalsSymbol]:o[internalsSymbol],selected:t.selected})}),new Map(r)}function handleControlledEdgeSelectionChange(e,r){return r.map(t=>{const o=e.find(c=>c.id===t.id);return o&&(t.selected=o.selected),t})}function updateNodesAndEdgesSelections({changedNodes:e,changedEdges:r,get:t,set:o}){const{nodeInternals:c,edges:u,onNodesChange:v,onEdgesChange:f,hasDefaultNodes:g,hasDefaultEdges:_}=t();e?.length&&(g&&o({nodeInternals:handleControlledNodeSelectionChange(e,c)}),v?.(e)),r?.length&&(_&&o({edges:handleControlledEdgeSelectionChange(r,u)}),f?.(r))}const noop=()=>{},initialViewportHelper={zoomIn:noop,zoomOut:noop,zoomTo:noop,getZoom:()=>1,setViewport:noop,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:noop,fitBounds:noop,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},selector$b=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),useViewportHelper=()=>{const e=useStoreApi(),{d3Zoom:r,d3Selection:t}=useStore(selector$b,shallow$1);return reactExports.useMemo(()=>t&&r?{zoomIn:c=>r.scaleBy(getD3Transition(t,c?.duration),1.2),zoomOut:c=>r.scaleBy(getD3Transition(t,c?.duration),1/1.2),zoomTo:(c,u)=>r.scaleTo(getD3Transition(t,u?.duration),c),getZoom:()=>e.getState().transform[2],setViewport:(c,u)=>{const[v,f,g]=e.getState().transform,_=identity.translate(c.x??v,c.y??f).scale(c.zoom??g);r.transform(getD3Transition(t,u?.duration),_)},getViewport:()=>{const[c,u,v]=e.getState().transform;return{x:c,y:u,zoom:v}},fitView:c=>fitView(e.getState,c),setCenter:(c,u,v)=>{const{width:f,height:g,maxZoom:_}=e.getState(),p=typeof v?.zoom<"u"?v.zoom:_,E=f/2-c*p,k=g/2-u*p,A=identity.translate(E,k).scale(p);r.transform(getD3Transition(t,v?.duration),A)},fitBounds:(c,u)=>{const{width:v,height:f,minZoom:g,maxZoom:_}=e.getState(),{x:p,y:E,zoom:k}=getViewportForBounds(c,v,f,g,_,u?.padding??.1),A=identity.translate(p,E).scale(k);r.transform(getD3Transition(t,u?.duration),A)},project:c=>{const{transform:u,snapToGrid:v,snapGrid:f}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),pointToRendererPoint(c,u,v,f)},screenToFlowPosition:c=>{const{transform:u,snapToGrid:v,snapGrid:f,domNode:g}=e.getState();if(!g)return c;const{x:_,y:p}=g.getBoundingClientRect(),E={x:c.x-_,y:c.y-p};return pointToRendererPoint(E,u,v,f)},flowToScreenPosition:c=>{const{transform:u,domNode:v}=e.getState();if(!v)return c;const{x:f,y:g}=v.getBoundingClientRect(),_=rendererPointToPoint(c,u);return{x:_.x+f,y:_.y+g}},viewportInitialized:!0}:initialViewportHelper,[r,t])};function useReactFlow(){const e=useViewportHelper(),r=useStoreApi(),t=reactExports.useCallback(()=>r.getState().getNodes().map(l=>({...l})),[]),o=reactExports.useCallback(l=>r.getState().nodeInternals.get(l),[]),c=reactExports.useCallback(()=>{const{edges:l=[]}=r.getState();return l.map(s=>({...s}))},[]),u=reactExports.useCallback(l=>{const{edges:s=[]}=r.getState();return s.find(y=>y.id===l)},[]),v=reactExports.useCallback(l=>{const{getNodes:s,setNodes:y,hasDefaultNodes:w,onNodesChange:S}=r.getState(),C=s(),h=typeof l=="function"?l(C):l;if(w)y(h);else if(S){const x=h.length===0?C.map(R=>({type:"remove",id:R.id})):h.map(R=>({item:R,type:"reset"}));S(x)}},[]),f=reactExports.useCallback(l=>{const{edges:s=[],setEdges:y,hasDefaultEdges:w,onEdgesChange:S}=r.getState(),C=typeof l=="function"?l(s):l;if(w)y(C);else if(S){const h=C.length===0?s.map(x=>({type:"remove",id:x.id})):C.map(x=>({item:x,type:"reset"}));S(h)}},[]),g=reactExports.useCallback(l=>{const s=Array.isArray(l)?l:[l],{getNodes:y,setNodes:w,hasDefaultNodes:S,onNodesChange:C}=r.getState();if(S){const x=[...y(),...s];w(x)}else if(C){const h=s.map(x=>({item:x,type:"add"}));C(h)}},[]),_=reactExports.useCallback(l=>{const s=Array.isArray(l)?l:[l],{edges:y=[],setEdges:w,hasDefaultEdges:S,onEdgesChange:C}=r.getState();if(S)w([...y,...s]);else if(C){const h=s.map(x=>({item:x,type:"add"}));C(h)}},[]),p=reactExports.useCallback(()=>{const{getNodes:l,edges:s=[],transform:y}=r.getState(),[w,S,C]=y;return{nodes:l().map(h=>({...h})),edges:s.map(h=>({...h})),viewport:{x:w,y:S,zoom:C}}},[]),E=reactExports.useCallback(({nodes:l,edges:s})=>{const{nodeInternals:y,getNodes:w,edges:S,hasDefaultNodes:C,hasDefaultEdges:h,onNodesDelete:x,onEdgesDelete:R,onNodesChange:M,onEdgesChange:P}=r.getState(),D=(l||[]).map(H=>H.id),L=(s||[]).map(H=>H.id),X=w().reduce((H,$)=>{const q=$.parentNode||$.parentId,W=!D.includes($.id)&&q&&H.find(G=>G.id===q);return(typeof $.deletable=="boolean"?$.deletable:!0)&&(D.includes($.id)||W)&&H.push($),H},[]),B=S.filter(H=>typeof H.deletable=="boolean"?H.deletable:!0),j=B.filter(H=>L.includes(H.id));if(X||j){const H=getConnectedEdges(X,B),$=[...j,...H],q=$.reduce((W,Y)=>(W.includes(Y.id)||W.push(Y.id),W),[]);if((h||C)&&(h&&r.setState({edges:S.filter(W=>!q.includes(W.id))}),C&&(X.forEach(W=>{y.delete(W.id)}),r.setState({nodeInternals:new Map(y)}))),q.length>0&&(R?.($),P&&P(q.map(W=>({id:W,type:"remove"})))),X.length>0&&(x?.(X),M)){const W=X.map(Y=>({id:Y.id,type:"remove"}));M(W)}}},[]),k=reactExports.useCallback(l=>{const s=isRectObject(l),y=s?null:r.getState().nodeInternals.get(l.id);return!s&&!y?[null,null,s]:[s?l:nodeToRect(y),y,s]},[]),A=reactExports.useCallback((l,s=!0,y)=>{const[w,S,C]=k(l);return w?(y||r.getState().getNodes()).filter(h=>{if(!C&&(h.id===S.id||!h.positionAbsolute))return!1;const x=nodeToRect(h),R=getOverlappingArea(x,w);return s&&R>0||R>=w.width*w.height}):[]},[]),z=reactExports.useCallback((l,s,y=!0)=>{const[w]=k(l);if(!w)return!1;const S=getOverlappingArea(w,s);return y&&S>0||S>=w.width*w.height},[]);return reactExports.useMemo(()=>({...e,getNodes:t,getNode:o,getEdges:c,getEdge:u,setNodes:v,setEdges:f,addNodes:g,addEdges:_,toObject:p,deleteElements:E,getIntersectingNodes:A,isNodeIntersecting:z}),[e,t,o,c,u,v,f,g,_,p,E,A,z])}const deleteKeyOptions={actInsideInputWithModifier:!1};var useGlobalKeyHandler=({deleteKeyCode:e,multiSelectionKeyCode:r})=>{const t=useStoreApi(),{deleteElements:o}=useReactFlow(),c=useKeyPress(e,deleteKeyOptions),u=useKeyPress(r);reactExports.useEffect(()=>{if(c){const{edges:v,getNodes:f}=t.getState(),g=f().filter(p=>p.selected),_=v.filter(p=>p.selected);o({nodes:g,edges:_}),t.setState({nodesSelectionActive:!1})}},[c]),reactExports.useEffect(()=>{t.setState({multiSelectionActive:u})},[u])};function useResizeHandler(e){const r=useStoreApi();reactExports.useEffect(()=>{let t;const o=()=>{if(!e.current)return;const c=getDimensions(e.current);(c.height===0||c.width===0)&&r.getState().onError?.("004",errorMessages.error004()),r.setState({width:c.width||500,height:c.height||500})};return o(),window.addEventListener("resize",o),e.current&&(t=new ResizeObserver(()=>o()),t.observe(e.current)),()=>{window.removeEventListener("resize",o),t&&e.current&&t.unobserve(e.current)}},[])}const containerStyle={position:"absolute",width:"100%",height:"100%",top:0,left:0},viewChanged=(e,r)=>e.x!==r.x||e.y!==r.y||e.zoom!==r.k,eventToFlowTransform=e=>({x:e.x,y:e.y,zoom:e.k}),isWrappedWithClass=(e,r)=>e.target.closest(`.${r}`),isRightClickPan=(e,r)=>r===2&&Array.isArray(e)&&e.includes(2),wheelDelta=e=>{const r=e.ctrlKey&&isMacOs()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*r},selector$a=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),ZoomPane=({onMove:e,onMoveStart:r,onMoveEnd:t,onPaneContextMenu:o,zoomOnScroll:c=!0,zoomOnPinch:u=!0,panOnScroll:v=!1,panOnScrollSpeed:f=.5,panOnScrollMode:g=PanOnScrollMode.Free,zoomOnDoubleClick:_=!0,elementsSelectable:p,panOnDrag:E=!0,defaultViewport:k,translateExtent:A,minZoom:z,maxZoom:l,zoomActivationKeyCode:s,preventScrolling:y=!0,children:w,noWheelClassName:S,noPanClassName:C})=>{const h=reactExports.useRef(),x=useStoreApi(),R=reactExports.useRef(!1),M=reactExports.useRef(!1),P=reactExports.useRef(null),D=reactExports.useRef({x:0,y:0,zoom:0}),{d3Zoom:L,d3Selection:X,d3ZoomHandler:B,userSelectionActive:j}=useStore(selector$a,shallow$1),H=useKeyPress(s),$=reactExports.useRef(0),q=reactExports.useRef(!1),W=reactExports.useRef();return useResizeHandler(P),reactExports.useEffect(()=>{if(P.current){const Y=P.current.getBoundingClientRect(),G=zoom().scaleExtent([z,l]).translateExtent(A),V=select(P.current).call(G),Z=identity.translate(k.x,k.y).scale(clamp(k.zoom,z,l)),xe=[[0,0],[Y.width,Y.height]],ce=G.constrain()(Z,xe,A);G.transform(V,ce),G.wheelDelta(wheelDelta),x.setState({d3Zoom:G,d3Selection:V,d3ZoomHandler:V.on("wheel.zoom"),transform:[ce.x,ce.y,ce.k],domNode:P.current.closest(".react-flow")})}},[]),reactExports.useEffect(()=>{X&&L&&(v&&!H&&!j?X.on("wheel.zoom",Y=>{if(isWrappedWithClass(Y,S))return!1;Y.preventDefault(),Y.stopImmediatePropagation();const G=X.property("__zoom").k||1;if(Y.ctrlKey&&u){const Me=pointer(Y),Be=wheelDelta(Y),ft=G*Math.pow(2,Be);L.scaleTo(X,ft,Me,Y);return}const V=Y.deltaMode===1?20:1;let Z=g===PanOnScrollMode.Vertical?0:Y.deltaX*V,xe=g===PanOnScrollMode.Horizontal?0:Y.deltaY*V;!isMacOs()&&Y.shiftKey&&g!==PanOnScrollMode.Vertical&&(Z=Y.deltaY*V,xe=0),L.translateBy(X,-(Z/G)*f,-(xe/G)*f,{internal:!0});const ce=eventToFlowTransform(X.property("__zoom")),{onViewportChangeStart:Ne,onViewportChange:Pe,onViewportChangeEnd:De}=x.getState();clearTimeout(W.current),q.current||(q.current=!0,r?.(Y,ce),Ne?.(ce)),q.current&&(e?.(Y,ce),Pe?.(ce),W.current=setTimeout(()=>{t?.(Y,ce),De?.(ce),q.current=!1},150))},{passive:!1}):typeof B<"u"&&X.on("wheel.zoom",function(Y,G){if(!y&&Y.type==="wheel"&&!Y.ctrlKey||isWrappedWithClass(Y,S))return null;Y.preventDefault(),B.call(this,Y,G)},{passive:!1}))},[j,v,g,X,L,B,H,u,y,S,r,e,t]),reactExports.useEffect(()=>{L&&L.on("start",Y=>{if(!Y.sourceEvent||Y.sourceEvent.internal)return null;$.current=Y.sourceEvent?.button;const{onViewportChangeStart:G}=x.getState(),V=eventToFlowTransform(Y.transform);R.current=!0,D.current=V,Y.sourceEvent?.type==="mousedown"&&x.setState({paneDragging:!0}),G?.(V),r?.(Y.sourceEvent,V)})},[L,r]),reactExports.useEffect(()=>{L&&(j&&!R.current?L.on("zoom",null):j||L.on("zoom",Y=>{const{onViewportChange:G}=x.getState();if(x.setState({transform:[Y.transform.x,Y.transform.y,Y.transform.k]}),M.current=!!(o&&isRightClickPan(E,$.current??0)),(e||G)&&!Y.sourceEvent?.internal){const V=eventToFlowTransform(Y.transform);G?.(V),e?.(Y.sourceEvent,V)}}))},[j,L,e,E,o]),reactExports.useEffect(()=>{L&&L.on("end",Y=>{if(!Y.sourceEvent||Y.sourceEvent.internal)return null;const{onViewportChangeEnd:G}=x.getState();if(R.current=!1,x.setState({paneDragging:!1}),o&&isRightClickPan(E,$.current??0)&&!M.current&&o(Y.sourceEvent),M.current=!1,(t||G)&&viewChanged(D.current,Y.transform)){const V=eventToFlowTransform(Y.transform);D.current=V,clearTimeout(h.current),h.current=setTimeout(()=>{G?.(V),t?.(Y.sourceEvent,V)},v?150:0)}})},[L,v,E,t,o]),reactExports.useEffect(()=>{L&&L.filter(Y=>{const G=H||c,V=u&&Y.ctrlKey;if((E===!0||Array.isArray(E)&&E.includes(1))&&Y.button===1&&Y.type==="mousedown"&&(isWrappedWithClass(Y,"react-flow__node")||isWrappedWithClass(Y,"react-flow__edge")))return!0;if(!E&&!G&&!v&&!_&&!u||j||!_&&Y.type==="dblclick"||isWrappedWithClass(Y,S)&&Y.type==="wheel"||isWrappedWithClass(Y,C)&&(Y.type!=="wheel"||v&&Y.type==="wheel"&&!H)||!u&&Y.ctrlKey&&Y.type==="wheel"||!G&&!v&&!V&&Y.type==="wheel"||!E&&(Y.type==="mousedown"||Y.type==="touchstart")||Array.isArray(E)&&!E.includes(Y.button)&&Y.type==="mousedown")return!1;const Z=Array.isArray(E)&&E.includes(Y.button)||!Y.button||Y.button<=1;return(!Y.ctrlKey||Y.type==="wheel")&&Z})},[j,L,c,u,v,_,E,p,H]),React.createElement("div",{className:"react-flow__renderer",ref:P,style:containerStyle},w)},selector$9=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function UserSelection(){const{userSelectionActive:e,userSelectionRect:r}=useStore(selector$9,shallow$1);return e&&r?React.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:r.width,height:r.height,transform:`translate(${r.x}px, ${r.y}px)`}}):null}function handleParentExpand(e,r){const t=r.parentNode||r.parentId,o=e.find(c=>c.id===t);if(o){const c=r.position.x+r.width-o.width,u=r.position.y+r.height-o.height;if(c>0||u>0||r.position.x<0||r.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,c>0&&(o.style.width+=c),u>0&&(o.style.height+=u),r.position.x<0){const v=Math.abs(r.position.x);o.position.x=o.position.x-v,o.style.width+=v,r.position.x=0}if(r.position.y<0){const v=Math.abs(r.position.y);o.position.y=o.position.y-v,o.style.height+=v,r.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function applyChanges(e,r){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const t=e.filter(o=>o.type==="add").map(o=>o.item);return r.reduce((o,c)=>{const u=e.filter(f=>f.id===c.id);if(u.length===0)return o.push(c),o;const v={...c};for(const f of u)if(f)switch(f.type){case"select":{v.selected=f.selected;break}case"position":{typeof f.position<"u"&&(v.position=f.position),typeof f.positionAbsolute<"u"&&(v.positionAbsolute=f.positionAbsolute),typeof f.dragging<"u"&&(v.dragging=f.dragging),v.expandParent&&handleParentExpand(o,v);break}case"dimensions":{typeof f.dimensions<"u"&&(v.width=f.dimensions.width,v.height=f.dimensions.height),typeof f.updateStyle<"u"&&(v.style={...v.style||{},...f.dimensions}),typeof f.resizing=="boolean"&&(v.resizing=f.resizing),v.expandParent&&handleParentExpand(o,v);break}case"remove":return o}return o.push(v),o},t)}function applyNodeChanges(e,r){return applyChanges(e,r)}function applyEdgeChanges(e,r){return applyChanges(e,r)}const createSelectionChange=(e,r)=>({id:e,type:"select",selected:r});function getSelectionChanges(e,r){return e.reduce((t,o)=>{const c=r.includes(o.id);return!o.selected&&c?(o.selected=!0,t.push(createSelectionChange(o.id,!0))):o.selected&&!c&&(o.selected=!1,t.push(createSelectionChange(o.id,!1))),t},[])}const wrapHandler=(e,r)=>t=>{t.target===r.current&&e?.(t)},selector$8=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Pane=reactExports.memo(({isSelecting:e,selectionMode:r=SelectionMode.Full,panOnDrag:t,onSelectionStart:o,onSelectionEnd:c,onPaneClick:u,onPaneContextMenu:v,onPaneScroll:f,onPaneMouseEnter:g,onPaneMouseMove:_,onPaneMouseLeave:p,children:E})=>{const k=reactExports.useRef(null),A=useStoreApi(),z=reactExports.useRef(0),l=reactExports.useRef(0),s=reactExports.useRef(),{userSelectionActive:y,elementsSelectable:w,dragging:S}=useStore(selector$8,shallow$1),C=()=>{A.setState({userSelectionActive:!1,userSelectionRect:null}),z.current=0,l.current=0},h=B=>{u?.(B),A.getState().resetSelectedElements(),A.setState({nodesSelectionActive:!1})},x=B=>{if(Array.isArray(t)&&t?.includes(2)){B.preventDefault();return}v?.(B)},R=f?B=>f(B):void 0,M=B=>{const{resetSelectedElements:j,domNode:H}=A.getState();if(s.current=H?.getBoundingClientRect(),!w||!e||B.button!==0||B.target!==k.current||!s.current)return;const{x:$,y:q}=getEventPosition(B,s.current);j(),A.setState({userSelectionRect:{width:0,height:0,startX:$,startY:q,x:$,y:q}}),o?.(B)},P=B=>{const{userSelectionRect:j,nodeInternals:H,edges:$,transform:q,onNodesChange:W,onEdgesChange:Y,nodeOrigin:G,getNodes:V}=A.getState();if(!e||!s.current||!j)return;A.setState({userSelectionActive:!0,nodesSelectionActive:!1});const Z=getEventPosition(B,s.current),xe=j.startX??0,ce=j.startY??0,Ne={...j,x:Z.x<xe?Z.x:xe,y:Z.y<ce?Z.y:ce,width:Math.abs(Z.x-xe),height:Math.abs(Z.y-ce)},Pe=V(),De=getNodesInside(H,Ne,q,r===SelectionMode.Partial,!0,G),Me=getConnectedEdges(De,$).map(ft=>ft.id),Be=De.map(ft=>ft.id);if(z.current!==Be.length){z.current=Be.length;const ft=getSelectionChanges(Pe,Be);ft.length&&W?.(ft)}if(l.current!==Me.length){l.current=Me.length;const ft=getSelectionChanges($,Me);ft.length&&Y?.(ft)}A.setState({userSelectionRect:Ne})},D=B=>{if(B.button!==0)return;const{userSelectionRect:j}=A.getState();!y&&j&&B.target===k.current&&h?.(B),A.setState({nodesSelectionActive:z.current>0}),C(),c?.(B)},L=B=>{y&&(A.setState({nodesSelectionActive:z.current>0}),c?.(B)),C()},X=w&&(e||y);return React.createElement("div",{className:cc(["react-flow__pane",{dragging:S,selection:e}]),onClick:X?void 0:wrapHandler(h,k),onContextMenu:wrapHandler(x,k),onWheel:wrapHandler(R,k),onMouseEnter:X?void 0:g,onMouseDown:X?M:void 0,onMouseMove:X?P:_,onMouseUp:X?D:void 0,onMouseLeave:X?L:p,ref:k,style:containerStyle},E,React.createElement(UserSelection,null))});Pane.displayName="Pane";function isParentSelected(e,r){const t=e.parentNode||e.parentId;if(!t)return!1;const o=r.get(t);return o?o.selected?!0:isParentSelected(o,r):!1}function hasSelector(e,r,t){let o=e;do{if(o?.matches(r))return!0;if(o===t.current)return!1;o=o.parentElement}while(o);return!1}function getDragItems(e,r,t,o){return Array.from(e.values()).filter(c=>(c.selected||c.id===o)&&(!c.parentNode||c.parentId||!isParentSelected(c,e))&&(c.draggable||r&&typeof c.draggable>"u")).map(c=>({id:c.id,position:c.position||{x:0,y:0},positionAbsolute:c.positionAbsolute||{x:0,y:0},distance:{x:t.x-(c.positionAbsolute?.x??0),y:t.y-(c.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:c.extent,parentNode:c.parentNode||c.parentId,parentId:c.parentNode||c.parentId,width:c.width,height:c.height,expandParent:c.expandParent}))}function clampNodeExtent(e,r){return!r||r==="parent"?r:[r[0],[r[1][0]-(e.width||0),r[1][1]-(e.height||0)]]}function calcNextPosition(e,r,t,o,c=[0,0],u){const v=clampNodeExtent(e,e.extent||o);let f=v;const g=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(g&&e.width&&e.height){const E=t.get(g),{x:k,y:A}=getNodePositionWithOrigin(E,c).positionAbsolute;f=E&&isNumeric(k)&&isNumeric(A)&&isNumeric(E.width)&&isNumeric(E.height)?[[k+e.width*c[0],A+e.height*c[1]],[k+E.width-e.width+e.width*c[0],A+E.height-e.height+e.height*c[1]]]:f}else u?.("005",errorMessages.error005()),f=v;else if(e.extent&&g&&e.extent!=="parent"){const E=t.get(g),{x:k,y:A}=getNodePositionWithOrigin(E,c).positionAbsolute;f=[[e.extent[0][0]+k,e.extent[0][1]+A],[e.extent[1][0]+k,e.extent[1][1]+A]]}let _={x:0,y:0};if(g){const E=t.get(g);_=getNodePositionWithOrigin(E,c).positionAbsolute}const p=f&&f!=="parent"?clampPosition(r,f):r;return{position:{x:p.x-_.x,y:p.y-_.y},positionAbsolute:p}}function getEventHandlerParams({nodeId:e,dragItems:r,nodeInternals:t}){const o=r.map(c=>({...t.get(c.id),position:c.position,positionAbsolute:c.positionAbsolute}));return[e?o.find(c=>c.id===e):o[0],o]}const getHandleBounds=(e,r,t,o)=>{const c=r.querySelectorAll(e);if(!c||!c.length)return null;const u=Array.from(c),v=r.getBoundingClientRect(),f={x:v.width*o[0],y:v.height*o[1]};return u.map(g=>{const _=g.getBoundingClientRect();return{id:g.getAttribute("data-handleid"),position:g.getAttribute("data-handlepos"),x:(_.left-v.left-f.x)/t,y:(_.top-v.top-f.y)/t,...getDimensions(g)}})};function getMouseHandler(e,r,t){return t===void 0?t:o=>{const c=r().nodeInternals.get(e);c&&t(o,{...c})}}function handleNodeClick({id:e,store:r,unselect:t=!1,nodeRef:o}){const{addSelectedNodes:c,unselectNodesAndEdges:u,multiSelectionActive:v,nodeInternals:f,onError:g}=r.getState(),_=f.get(e);if(!_){g?.("012",errorMessages.error012(e));return}r.setState({nodesSelectionActive:!1}),_.selected?(t||_.selected&&v)&&(u({nodes:[_],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):c([e])}function useGetPointerPosition(){const e=useStoreApi();return reactExports.useCallback(({sourceEvent:t})=>{const{transform:o,snapGrid:c,snapToGrid:u}=e.getState(),v=t.touches?t.touches[0].clientX:t.clientX,f=t.touches?t.touches[0].clientY:t.clientY,g={x:(v-o[0])/o[2],y:(f-o[1])/o[2]};return{xSnapped:u?c[0]*Math.round(g.x/c[0]):g.x,ySnapped:u?c[1]*Math.round(g.y/c[1]):g.y,...g}},[])}function wrapSelectionDragFunc(e){return(r,t,o)=>e?.(r,o)}function useDrag({nodeRef:e,disabled:r=!1,noDragClassName:t,handleSelector:o,nodeId:c,isSelectable:u,selectNodesOnDrag:v}){const f=useStoreApi(),[g,_]=reactExports.useState(!1),p=reactExports.useRef([]),E=reactExports.useRef({x:null,y:null}),k=reactExports.useRef(0),A=reactExports.useRef(null),z=reactExports.useRef({x:0,y:0}),l=reactExports.useRef(null),s=reactExports.useRef(!1),y=reactExports.useRef(!1),w=reactExports.useRef(!1),S=useGetPointerPosition();return reactExports.useEffect(()=>{if(e?.current){const C=select(e.current),h=({x:M,y:P})=>{const{nodeInternals:D,onNodeDrag:L,onSelectionDrag:X,updateNodePositions:B,nodeExtent:j,snapGrid:H,snapToGrid:$,nodeOrigin:q,onError:W}=f.getState();E.current={x:M,y:P};let Y=!1,G={x:0,y:0,x2:0,y2:0};if(p.current.length>1&&j){const Z=getNodesBounds(p.current,q);G=rectToBox(Z)}if(p.current=p.current.map(Z=>{const xe={x:M-Z.distance.x,y:P-Z.distance.y};$&&(xe.x=H[0]*Math.round(xe.x/H[0]),xe.y=H[1]*Math.round(xe.y/H[1]));const ce=[[j[0][0],j[0][1]],[j[1][0],j[1][1]]];p.current.length>1&&j&&!Z.extent&&(ce[0][0]=Z.positionAbsolute.x-G.x+j[0][0],ce[1][0]=Z.positionAbsolute.x+(Z.width??0)-G.x2+j[1][0],ce[0][1]=Z.positionAbsolute.y-G.y+j[0][1],ce[1][1]=Z.positionAbsolute.y+(Z.height??0)-G.y2+j[1][1]);const Ne=calcNextPosition(Z,xe,D,ce,q,W);return Y=Y||Z.position.x!==Ne.position.x||Z.position.y!==Ne.position.y,Z.position=Ne.position,Z.positionAbsolute=Ne.positionAbsolute,Z}),!Y)return;B(p.current,!0,!0),_(!0);const V=c?L:wrapSelectionDragFunc(X);if(V&&l.current){const[Z,xe]=getEventHandlerParams({nodeId:c,dragItems:p.current,nodeInternals:D});V(l.current,Z,xe)}},x=()=>{if(!A.current)return;const[M,P]=calcAutoPan(z.current,A.current);if(M!==0||P!==0){const{transform:D,panBy:L}=f.getState();E.current.x=(E.current.x??0)-M/D[2],E.current.y=(E.current.y??0)-P/D[2],L({x:M,y:P})&&h(E.current)}k.current=requestAnimationFrame(x)},R=M=>{const{nodeInternals:P,multiSelectionActive:D,nodesDraggable:L,unselectNodesAndEdges:X,onNodeDragStart:B,onSelectionDragStart:j}=f.getState();y.current=!0;const H=c?B:wrapSelectionDragFunc(j);(!v||!u)&&!D&&c&&(P.get(c)?.selected||X()),c&&u&&v&&handleNodeClick({id:c,store:f,nodeRef:e});const $=S(M);if(E.current=$,p.current=getDragItems(P,L,$,c),H&&p.current){const[q,W]=getEventHandlerParams({nodeId:c,dragItems:p.current,nodeInternals:P});H(M.sourceEvent,q,W)}};if(r)C.on(".drag",null);else{const M=drag().on("start",P=>{const{domNode:D,nodeDragThreshold:L}=f.getState();L===0&&R(P),w.current=!1;const X=S(P);E.current=X,A.current=D?.getBoundingClientRect()||null,z.current=getEventPosition(P.sourceEvent,A.current)}).on("drag",P=>{const D=S(P),{autoPanOnNodeDrag:L,nodeDragThreshold:X}=f.getState();if(P.sourceEvent.type==="touchmove"&&P.sourceEvent.touches.length>1&&(w.current=!0),!w.current){if(!s.current&&y.current&&L&&(s.current=!0,x()),!y.current){const B=D.xSnapped-(E?.current?.x??0),j=D.ySnapped-(E?.current?.y??0);Math.sqrt(B*B+j*j)>X&&R(P)}(E.current.x!==D.xSnapped||E.current.y!==D.ySnapped)&&p.current&&y.current&&(l.current=P.sourceEvent,z.current=getEventPosition(P.sourceEvent,A.current),h(D))}}).on("end",P=>{if(!(!y.current||w.current)&&(_(!1),s.current=!1,y.current=!1,cancelAnimationFrame(k.current),p.current)){const{updateNodePositions:D,nodeInternals:L,onNodeDragStop:X,onSelectionDragStop:B}=f.getState(),j=c?X:wrapSelectionDragFunc(B);if(D(p.current,!1,!1),j){const[H,$]=getEventHandlerParams({nodeId:c,dragItems:p.current,nodeInternals:L});j(P.sourceEvent,H,$)}}}).filter(P=>{const D=P.target;return!P.button&&(!t||!hasSelector(D,`.${t}`,e))&&(!o||hasSelector(D,o,e))});return C.call(M),()=>{C.on(".drag",null)}}}},[e,r,t,o,u,f,c,v,S]),g}function useUpdateNodePositions(){const e=useStoreApi();return reactExports.useCallback(t=>{const{nodeInternals:o,nodeExtent:c,updateNodePositions:u,getNodes:v,snapToGrid:f,snapGrid:g,onError:_,nodesDraggable:p}=e.getState(),E=v().filter(w=>w.selected&&(w.draggable||p&&typeof w.draggable>"u")),k=f?g[0]:5,A=f?g[1]:5,z=t.isShiftPressed?4:1,l=t.x*k*z,s=t.y*A*z,y=E.map(w=>{if(w.positionAbsolute){const S={x:w.positionAbsolute.x+l,y:w.positionAbsolute.y+s};f&&(S.x=g[0]*Math.round(S.x/g[0]),S.y=g[1]*Math.round(S.y/g[1]));const{positionAbsolute:C,position:h}=calcNextPosition(w,S,o,c,void 0,_);w.position=h,w.positionAbsolute=C}return w});u(y,!0,!1)},[])}const arrowKeyDiffs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var wrapNode=e=>{const r=({id:t,type:o,data:c,xPos:u,yPos:v,xPosOrigin:f,yPosOrigin:g,selected:_,onClick:p,onMouseEnter:E,onMouseMove:k,onMouseLeave:A,onContextMenu:z,onDoubleClick:l,style:s,className:y,isDraggable:w,isSelectable:S,isConnectable:C,isFocusable:h,selectNodesOnDrag:x,sourcePosition:R,targetPosition:M,hidden:P,resizeObserver:D,dragHandle:L,zIndex:X,isParent:B,noDragClassName:j,noPanClassName:H,initialized:$,disableKeyboardA11y:q,ariaLabel:W,rfId:Y,hasHandleBounds:G})=>{const V=useStoreApi(),Z=reactExports.useRef(null),xe=reactExports.useRef(null),ce=reactExports.useRef(R),Ne=reactExports.useRef(M),Pe=reactExports.useRef(o),De=S||w||p||E||k||A,Me=useUpdateNodePositions(),Be=getMouseHandler(t,V.getState,E),ft=getMouseHandler(t,V.getState,k),jt=getMouseHandler(t,V.getState,A),Gt=getMouseHandler(t,V.getState,z),mt=getMouseHandler(t,V.getState,l),Fe=Jt=>{const{nodeDragThreshold:Wt}=V.getState();if(S&&(!x||!w||Wt>0)&&handleNodeClick({id:t,store:V,nodeRef:Z}),p){const Br=V.getState().nodeInternals.get(t);Br&&p(Jt,{...Br})}},ht=Jt=>{if(!isInputDOMNode(Jt)&&!q)if(elementSelectionKeys.includes(Jt.key)&&S){const Wt=Jt.key==="Escape";handleNodeClick({id:t,store:V,unselect:Wt,nodeRef:Z})}else w&&_&&Object.prototype.hasOwnProperty.call(arrowKeyDiffs,Jt.key)&&(V.setState({ariaLiveMessage:`Moved selected node ${Jt.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~u}, y: ${~~v}`}),Me({x:arrowKeyDiffs[Jt.key].x,y:arrowKeyDiffs[Jt.key].y,isShiftPressed:Jt.shiftKey}))};reactExports.useEffect(()=>()=>{xe.current&&(D?.unobserve(xe.current),xe.current=null)},[]),reactExports.useEffect(()=>{if(Z.current&&!P){const Jt=Z.current;(!$||!G||xe.current!==Jt)&&(xe.current&&D?.unobserve(xe.current),D?.observe(Jt),xe.current=Jt)}},[P,$,G]),reactExports.useEffect(()=>{const Jt=Pe.current!==o,Wt=ce.current!==R,Br=Ne.current!==M;Z.current&&(Jt||Wt||Br)&&(Jt&&(Pe.current=o),Wt&&(ce.current=R),Br&&(Ne.current=M),V.getState().updateNodeDimensions([{id:t,nodeElement:Z.current,forceUpdate:!0}]))},[t,o,R,M]);const Kt=useDrag({nodeRef:Z,disabled:P||!w,noDragClassName:j,handleSelector:L,nodeId:t,isSelectable:S,selectNodesOnDrag:x});return P?null:React.createElement("div",{className:cc(["react-flow__node",`react-flow__node-${o}`,{[H]:w},y,{selected:_,selectable:S,parent:B,dragging:Kt}]),ref:Z,style:{zIndex:X,transform:`translate(${f}px,${g}px)`,pointerEvents:De?"all":"none",visibility:$?"visible":"hidden",...s},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:Be,onMouseMove:ft,onMouseLeave:jt,onContextMenu:Gt,onClick:Fe,onDoubleClick:mt,onKeyDown:h?ht:void 0,tabIndex:h?0:void 0,role:h?"button":void 0,"aria-describedby":q?void 0:`${ARIA_NODE_DESC_KEY}-${Y}`,"aria-label":W},React.createElement(Provider$2,{value:t},React.createElement(e,{id:t,data:c,type:o,xPos:u,yPos:v,selected:_,isConnectable:C,sourcePosition:R,targetPosition:M,dragging:Kt,dragHandle:L,zIndex:X})))};return r.displayName="NodeWrapper",reactExports.memo(r)};const selector$7=e=>{const r=e.getNodes().filter(t=>t.selected);return{...getNodesBounds(r,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function NodesSelection({onSelectionContextMenu:e,noPanClassName:r,disableKeyboardA11y:t}){const o=useStoreApi(),{width:c,height:u,x:v,y:f,transformString:g,userSelectionActive:_}=useStore(selector$7,shallow$1),p=useUpdateNodePositions(),E=reactExports.useRef(null);if(reactExports.useEffect(()=>{t||E.current?.focus({preventScroll:!0})},[t]),useDrag({nodeRef:E}),_||!c||!u)return null;const k=e?z=>{const l=o.getState().getNodes().filter(s=>s.selected);e(z,l)}:void 0,A=z=>{Object.prototype.hasOwnProperty.call(arrowKeyDiffs,z.key)&&p({x:arrowKeyDiffs[z.key].x,y:arrowKeyDiffs[z.key].y,isShiftPressed:z.shiftKey})};return React.createElement("div",{className:cc(["react-flow__nodesselection","react-flow__container",r]),style:{transform:g}},React.createElement("div",{ref:E,className:"react-flow__nodesselection-rect",onContextMenu:k,tabIndex:t?void 0:-1,onKeyDown:t?void 0:A,style:{width:c,height:u,top:f,left:v}}))}var NodesSelection$1=reactExports.memo(NodesSelection);const selector$6=e=>e.nodesSelectionActive,FlowRenderer=({children:e,onPaneClick:r,onPaneMouseEnter:t,onPaneMouseMove:o,onPaneMouseLeave:c,onPaneContextMenu:u,onPaneScroll:v,deleteKeyCode:f,onMove:g,onMoveStart:_,onMoveEnd:p,selectionKeyCode:E,selectionOnDrag:k,selectionMode:A,onSelectionStart:z,onSelectionEnd:l,multiSelectionKeyCode:s,panActivationKeyCode:y,zoomActivationKeyCode:w,elementsSelectable:S,zoomOnScroll:C,zoomOnPinch:h,panOnScroll:x,panOnScrollSpeed:R,panOnScrollMode:M,zoomOnDoubleClick:P,panOnDrag:D,defaultViewport:L,translateExtent:X,minZoom:B,maxZoom:j,preventScrolling:H,onSelectionContextMenu:$,noWheelClassName:q,noPanClassName:W,disableKeyboardA11y:Y})=>{const G=useStore(selector$6),V=useKeyPress(E),Z=useKeyPress(y),xe=Z||D,ce=Z||x,Ne=V||k&&xe!==!0;return useGlobalKeyHandler({deleteKeyCode:f,multiSelectionKeyCode:s}),React.createElement(ZoomPane,{onMove:g,onMoveStart:_,onMoveEnd:p,onPaneContextMenu:u,elementsSelectable:S,zoomOnScroll:C,zoomOnPinch:h,panOnScroll:ce,panOnScrollSpeed:R,panOnScrollMode:M,zoomOnDoubleClick:P,panOnDrag:!V&&xe,defaultViewport:L,translateExtent:X,minZoom:B,maxZoom:j,zoomActivationKeyCode:w,preventScrolling:H,noWheelClassName:q,noPanClassName:W},React.createElement(Pane,{onSelectionStart:z,onSelectionEnd:l,onPaneClick:r,onPaneMouseEnter:t,onPaneMouseMove:o,onPaneMouseLeave:c,onPaneContextMenu:u,onPaneScroll:v,panOnDrag:xe,isSelecting:!!Ne,selectionMode:A},e,G&&React.createElement(NodesSelection$1,{onSelectionContextMenu:$,noPanClassName:W,disableKeyboardA11y:Y})))};FlowRenderer.displayName="FlowRenderer";var FlowRenderer$1=reactExports.memo(FlowRenderer);function useVisibleNodes(e){return useStore(reactExports.useCallback(t=>e?getNodesInside(t.nodeInternals,{x:0,y:0,width:t.width,height:t.height},t.transform,!0):t.getNodes(),[e]))}function createNodeTypes(e){const r={input:wrapNode(e.input||InputNode$1),default:wrapNode(e.default||DefaultNode$1),output:wrapNode(e.output||OutputNode$1),group:wrapNode(e.group||GroupNode)},t={},o=Object.keys(e).filter(c=>!["input","default","output","group"].includes(c)).reduce((c,u)=>(c[u]=wrapNode(e[u]||DefaultNode$1),c),t);return{...r,...o}}const getPositionWithOrigin=({x:e,y:r,width:t,height:o,origin:c})=>!t||!o?{x:e,y:r}:c[0]<0||c[1]<0||c[0]>1||c[1]>1?{x:e,y:r}:{x:e-t*c[0],y:r-o*c[1]},selector$5=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),NodeRenderer=e=>{const{nodesDraggable:r,nodesConnectable:t,nodesFocusable:o,elementsSelectable:c,updateNodeDimensions:u,onError:v}=useStore(selector$5,shallow$1),f=useVisibleNodes(e.onlyRenderVisibleElements),g=reactExports.useRef(),_=reactExports.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const p=new ResizeObserver(E=>{const k=E.map(A=>({id:A.target.getAttribute("data-id"),nodeElement:A.target,forceUpdate:!0}));u(k)});return g.current=p,p},[]);return reactExports.useEffect(()=>()=>{g?.current?.disconnect()},[]),React.createElement("div",{className:"react-flow__nodes",style:containerStyle},f.map(p=>{let E=p.type||"default";e.nodeTypes[E]||(v?.("003",errorMessages.error003(E)),E="default");const k=e.nodeTypes[E]||e.nodeTypes.default,A=!!(p.draggable||r&&typeof p.draggable>"u"),z=!!(p.selectable||c&&typeof p.selectable>"u"),l=!!(p.connectable||t&&typeof p.connectable>"u"),s=!!(p.focusable||o&&typeof p.focusable>"u"),y=e.nodeExtent?clampPosition(p.positionAbsolute,e.nodeExtent):p.positionAbsolute,w=y?.x??0,S=y?.y??0,C=getPositionWithOrigin({x:w,y:S,width:p.width??0,height:p.height??0,origin:e.nodeOrigin});return React.createElement(k,{key:p.id,id:p.id,className:p.className,style:p.style,type:E,data:p.data,sourcePosition:p.sourcePosition||Position.Bottom,targetPosition:p.targetPosition||Position.Top,hidden:p.hidden,xPos:w,yPos:S,xPosOrigin:C.x,yPosOrigin:C.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!p.selected,isDraggable:A,isSelectable:z,isConnectable:l,isFocusable:s,resizeObserver:_,dragHandle:p.dragHandle,zIndex:p[internalsSymbol]?.z??0,isParent:!!p[internalsSymbol]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!p.width&&!!p.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:p.ariaLabel,hasHandleBounds:!!p[internalsSymbol]?.handleBounds})}))};NodeRenderer.displayName="NodeRenderer";var NodeRenderer$1=reactExports.memo(NodeRenderer);const shiftX=(e,r,t)=>t===Position.Left?e-r:t===Position.Right?e+r:e,shiftY=(e,r,t)=>t===Position.Top?e-r:t===Position.Bottom?e+r:e,EdgeUpdaterClassName="react-flow__edgeupdater",EdgeAnchor=({position:e,centerX:r,centerY:t,radius:o=10,onMouseDown:c,onMouseEnter:u,onMouseOut:v,type:f})=>React.createElement("circle",{onMouseDown:c,onMouseEnter:u,onMouseOut:v,className:cc([EdgeUpdaterClassName,`${EdgeUpdaterClassName}-${f}`]),cx:shiftX(r,o,e),cy:shiftY(t,o,e),r:o,stroke:"transparent",fill:"transparent"}),alwaysValidConnection=()=>!0;var wrapEdge=e=>{const r=({id:t,className:o,type:c,data:u,onClick:v,onEdgeDoubleClick:f,selected:g,animated:_,label:p,labelStyle:E,labelShowBg:k,labelBgStyle:A,labelBgPadding:z,labelBgBorderRadius:l,style:s,source:y,target:w,sourceX:S,sourceY:C,targetX:h,targetY:x,sourcePosition:R,targetPosition:M,elementsSelectable:P,hidden:D,sourceHandleId:L,targetHandleId:X,onContextMenu:B,onMouseEnter:j,onMouseMove:H,onMouseLeave:$,reconnectRadius:q,onReconnect:W,onReconnectStart:Y,onReconnectEnd:G,markerEnd:V,markerStart:Z,rfId:xe,ariaLabel:ce,isFocusable:Ne,isReconnectable:Pe,pathOptions:De,interactionWidth:Me,disableKeyboardA11y:Be})=>{const ft=reactExports.useRef(null),[jt,Gt]=reactExports.useState(!1),[mt,Fe]=reactExports.useState(!1),ht=useStoreApi(),Kt=reactExports.useMemo(()=>`url('#${getMarkerId(Z,xe)}')`,[Z,xe]),Jt=reactExports.useMemo(()=>`url('#${getMarkerId(V,xe)}')`,[V,xe]);if(D)return null;const Wt=rt=>{const{edges:Yt,addSelectedEdges:Ft,unselectNodesAndEdges:re,multiSelectionActive:tt}=ht.getState(),lt=Yt.find(ar=>ar.id===t);lt&&(P&&(ht.setState({nodesSelectionActive:!1}),lt.selected&&tt?(re({nodes:[],edges:[lt]}),ft.current?.blur()):Ft([t])),v&&v(rt,lt))},Br=getMouseHandler$1(t,ht.getState,f),zr=getMouseHandler$1(t,ht.getState,B),cr=getMouseHandler$1(t,ht.getState,j),Nr=getMouseHandler$1(t,ht.getState,H),At=getMouseHandler$1(t,ht.getState,$),Mt=(rt,Yt)=>{if(rt.button!==0)return;const{edges:Ft,isValidConnection:re}=ht.getState(),tt=Yt?w:y,lt=(Yt?X:L)||null,ar=Yt?"target":"source",et=re||alwaysValidConnection,Ot=Yt,se=Ft.find(J=>J.id===t);Fe(!0),Y?.(rt,se,ar);const xt=J=>{Fe(!1),G?.(J,se,ar)};handlePointerDown({event:rt,handleId:lt,nodeId:tt,onConnect:J=>W?.(se,J),isTarget:Ot,getState:ht.getState,setState:ht.setState,isValidConnection:et,edgeUpdaterType:ar,onReconnectEnd:xt})},Jr=rt=>Mt(rt,!0),Yr=rt=>Mt(rt,!1),ie=()=>Gt(!0),ve=()=>Gt(!1),we=!P&&!v,it=rt=>{if(!Be&&elementSelectionKeys.includes(rt.key)&&P){const{unselectNodesAndEdges:Yt,addSelectedEdges:Ft,edges:re}=ht.getState();rt.key==="Escape"?(ft.current?.blur(),Yt({edges:[re.find(lt=>lt.id===t)]})):Ft([t])}};return React.createElement("g",{className:cc(["react-flow__edge",`react-flow__edge-${c}`,o,{selected:g,animated:_,inactive:we,updating:jt}]),onClick:Wt,onDoubleClick:Br,onContextMenu:zr,onMouseEnter:cr,onMouseMove:Nr,onMouseLeave:At,onKeyDown:Ne?it:void 0,tabIndex:Ne?0:void 0,role:Ne?"button":"img","data-testid":`rf__edge-${t}`,"aria-label":ce===null?void 0:ce||`Edge from ${y} to ${w}`,"aria-describedby":Ne?`${ARIA_EDGE_DESC_KEY}-${xe}`:void 0,ref:ft},!mt&&React.createElement(e,{id:t,source:y,target:w,selected:g,animated:_,label:p,labelStyle:E,labelShowBg:k,labelBgStyle:A,labelBgPadding:z,labelBgBorderRadius:l,data:u,style:s,sourceX:S,sourceY:C,targetX:h,targetY:x,sourcePosition:R,targetPosition:M,sourceHandleId:L,targetHandleId:X,markerStart:Kt,markerEnd:Jt,pathOptions:De,interactionWidth:Me}),Pe&&React.createElement(React.Fragment,null,(Pe==="source"||Pe===!0)&&React.createElement(EdgeAnchor,{position:R,centerX:S,centerY:C,radius:q,onMouseDown:Jr,onMouseEnter:ie,onMouseOut:ve,type:"source"}),(Pe==="target"||Pe===!0)&&React.createElement(EdgeAnchor,{position:M,centerX:h,centerY:x,radius:q,onMouseDown:Yr,onMouseEnter:ie,onMouseOut:ve,type:"target"})))};return r.displayName="EdgeWrapper",reactExports.memo(r)};function createEdgeTypes(e){const r={default:wrapEdge(e.default||BezierEdge),straight:wrapEdge(e.bezier||StraightEdge),step:wrapEdge(e.step||StepEdge),smoothstep:wrapEdge(e.step||SmoothStepEdge),simplebezier:wrapEdge(e.simplebezier||SimpleBezierEdge)},t={},o=Object.keys(e).filter(c=>!["default","bezier"].includes(c)).reduce((c,u)=>(c[u]=wrapEdge(e[u]||BezierEdge),c),t);return{...r,...o}}function getHandlePosition(e,r,t=null){const o=(t?.x||0)+r.x,c=(t?.y||0)+r.y,u=t?.width||r.width,v=t?.height||r.height;switch(e){case Position.Top:return{x:o+u/2,y:c};case Position.Right:return{x:o+u,y:c+v/2};case Position.Bottom:return{x:o+u/2,y:c+v};case Position.Left:return{x:o,y:c+v/2}}}function getHandle(e,r){return e?e.length===1||!r?e[0]:r&&e.find(t=>t.id===r)||null:null}const getEdgePositions=(e,r,t,o,c,u)=>{const v=getHandlePosition(t,e,r),f=getHandlePosition(u,o,c);return{sourceX:v.x,sourceY:v.y,targetX:f.x,targetY:f.y}};function isEdgeVisible({sourcePos:e,targetPos:r,sourceWidth:t,sourceHeight:o,targetWidth:c,targetHeight:u,width:v,height:f,transform:g}){const _={x:Math.min(e.x,r.x),y:Math.min(e.y,r.y),x2:Math.max(e.x+t,r.x+c),y2:Math.max(e.y+o,r.y+u)};_.x===_.x2&&(_.x2+=1),_.y===_.y2&&(_.y2+=1);const p=rectToBox({x:(0-g[0])/g[2],y:(0-g[1])/g[2],width:v/g[2],height:f/g[2]}),E=Math.max(0,Math.min(p.x2,_.x2)-Math.max(p.x,_.x)),k=Math.max(0,Math.min(p.y2,_.y2)-Math.max(p.y,_.y));return Math.ceil(E*k)>0}function getNodeData(e){const r=e?.[internalsSymbol]?.handleBounds||null,t=r&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},r,!!t]}const defaultEdgeTree=[{level:0,isMaxLevel:!0,edges:[]}];function groupEdgesByZLevel(e,r,t=!1){let o=-1;const c=e.reduce((v,f)=>{const g=isNumeric(f.zIndex);let _=g?f.zIndex:0;if(t){const p=r.get(f.target),E=r.get(f.source),k=f.selected||p?.selected||E?.selected,A=Math.max(E?.[internalsSymbol]?.z||0,p?.[internalsSymbol]?.z||0,1e3);_=(g?f.zIndex:0)+(k?A:0)}return v[_]?v[_].push(f):v[_]=[f],o=_>o?_:o,v},{}),u=Object.entries(c).map(([v,f])=>{const g=+v;return{edges:f,level:g,isMaxLevel:g===o}});return u.length===0?defaultEdgeTree:u}function useVisibleEdges(e,r,t){const o=useStore(reactExports.useCallback(c=>e?c.edges.filter(u=>{const v=r.get(u.source),f=r.get(u.target);return v?.width&&v?.height&&f?.width&&f?.height&&isEdgeVisible({sourcePos:v.positionAbsolute||{x:0,y:0},targetPos:f.positionAbsolute||{x:0,y:0},sourceWidth:v.width,sourceHeight:v.height,targetWidth:f.width,targetHeight:f.height,width:c.width,height:c.height,transform:c.transform})}):c.edges,[e,r]));return groupEdgesByZLevel(o,r,t)}const ArrowSymbol=({color:e="none",strokeWidth:r=1})=>React.createElement("polyline",{style:{stroke:e,strokeWidth:r},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),ArrowClosedSymbol=({color:e="none",strokeWidth:r=1})=>React.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:r},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),MarkerSymbols={[MarkerType.Arrow]:ArrowSymbol,[MarkerType.ArrowClosed]:ArrowClosedSymbol};function useMarkerSymbol(e){const r=useStoreApi();return reactExports.useMemo(()=>Object.prototype.hasOwnProperty.call(MarkerSymbols,e)?MarkerSymbols[e]:(r.getState().onError?.("009",errorMessages.error009(e)),null),[e])}const Marker=({id:e,type:r,color:t,width:o=12.5,height:c=12.5,markerUnits:u="strokeWidth",strokeWidth:v,orient:f="auto-start-reverse"})=>{const g=useMarkerSymbol(r);return g?React.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${c}`,viewBox:"-10 -10 20 20",markerUnits:u,orient:f,refX:"0",refY:"0"},React.createElement(g,{color:t,strokeWidth:v})):null},markerSelector=({defaultColor:e,rfId:r})=>t=>{const o=[];return t.edges.reduce((c,u)=>([u.markerStart,u.markerEnd].forEach(v=>{if(v&&typeof v=="object"){const f=getMarkerId(v,r);o.includes(f)||(c.push({id:f,color:v.color||e,...v}),o.push(f))}}),c),[]).sort((c,u)=>c.id.localeCompare(u.id))},MarkerDefinitions=({defaultColor:e,rfId:r})=>{const t=useStore(reactExports.useCallback(markerSelector({defaultColor:e,rfId:r}),[e,r]),(o,c)=>!(o.length!==c.length||o.some((u,v)=>u.id!==c[v].id)));return React.createElement("defs",null,t.map(o=>React.createElement(Marker,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};MarkerDefinitions.displayName="MarkerDefinitions";var MarkerDefinitions$1=reactExports.memo(MarkerDefinitions);const selector$4=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),EdgeRenderer=({defaultMarkerColor:e,onlyRenderVisibleElements:r,elevateEdgesOnSelect:t,rfId:o,edgeTypes:c,noPanClassName:u,onEdgeContextMenu:v,onEdgeMouseEnter:f,onEdgeMouseMove:g,onEdgeMouseLeave:_,onEdgeClick:p,onEdgeDoubleClick:E,onReconnect:k,onReconnectStart:A,onReconnectEnd:z,reconnectRadius:l,children:s,disableKeyboardA11y:y})=>{const{edgesFocusable:w,edgesUpdatable:S,elementsSelectable:C,width:h,height:x,connectionMode:R,nodeInternals:M,onError:P}=useStore(selector$4,shallow$1),D=useVisibleEdges(r,M,t);return h?React.createElement(React.Fragment,null,D.map(({level:L,edges:X,isMaxLevel:B})=>React.createElement("svg",{key:L,style:{zIndex:L},width:h,height:x,className:"react-flow__edges react-flow__container"},B&&React.createElement(MarkerDefinitions$1,{defaultColor:e,rfId:o}),React.createElement("g",null,X.map(j=>{const[H,$,q]=getNodeData(M.get(j.source)),[W,Y,G]=getNodeData(M.get(j.target));if(!q||!G)return null;let V=j.type||"default";c[V]||(P?.("011",errorMessages.error011(V)),V="default");const Z=c[V]||c.default,xe=R===ConnectionMode.Strict?Y.target:(Y.target??[]).concat(Y.source??[]),ce=getHandle($.source,j.sourceHandle),Ne=getHandle(xe,j.targetHandle),Pe=ce?.position||Position.Bottom,De=Ne?.position||Position.Top,Me=!!(j.focusable||w&&typeof j.focusable>"u"),Be=j.reconnectable||j.updatable,ft=typeof k<"u"&&(Be||S&&typeof Be>"u");if(!ce||!Ne)return P?.("008",errorMessages.error008(ce,j)),null;const{sourceX:jt,sourceY:Gt,targetX:mt,targetY:Fe}=getEdgePositions(H,ce,Pe,W,Ne,De);return React.createElement(Z,{key:j.id,id:j.id,className:cc([j.className,u]),type:V,data:j.data,selected:!!j.selected,animated:!!j.animated,hidden:!!j.hidden,label:j.label,labelStyle:j.labelStyle,labelShowBg:j.labelShowBg,labelBgStyle:j.labelBgStyle,labelBgPadding:j.labelBgPadding,labelBgBorderRadius:j.labelBgBorderRadius,style:j.style,source:j.source,target:j.target,sourceHandleId:j.sourceHandle,targetHandleId:j.targetHandle,markerEnd:j.markerEnd,markerStart:j.markerStart,sourceX:jt,sourceY:Gt,targetX:mt,targetY:Fe,sourcePosition:Pe,targetPosition:De,elementsSelectable:C,onContextMenu:v,onMouseEnter:f,onMouseMove:g,onMouseLeave:_,onClick:p,onEdgeDoubleClick:E,onReconnect:k,onReconnectStart:A,onReconnectEnd:z,reconnectRadius:l,rfId:o,ariaLabel:j.ariaLabel,isFocusable:Me,isReconnectable:ft,pathOptions:"pathOptions"in j?j.pathOptions:void 0,interactionWidth:j.interactionWidth,disableKeyboardA11y:y})})))),s):null};EdgeRenderer.displayName="EdgeRenderer";var EdgeRenderer$1=reactExports.memo(EdgeRenderer);const selector$3=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Viewport({children:e}){const r=useStore(selector$3);return React.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:r}},e)}function useOnInitHandler(e){const r=useReactFlow(),t=reactExports.useRef(!1);reactExports.useEffect(()=>{!t.current&&r.viewportInitialized&&e&&(setTimeout(()=>e(r),1),t.current=!0)},[e,r.viewportInitialized])}const oppositePosition={[Position.Left]:Position.Right,[Position.Right]:Position.Left,[Position.Top]:Position.Bottom,[Position.Bottom]:Position.Top},ConnectionLine=({nodeId:e,handleType:r,style:t,type:o=ConnectionLineType.Bezier,CustomComponent:c,connectionStatus:u})=>{const{fromNode:v,handleId:f,toX:g,toY:_,connectionMode:p}=useStore(reactExports.useCallback(x=>({fromNode:x.nodeInternals.get(e),handleId:x.connectionHandleId,toX:(x.connectionPosition.x-x.transform[0])/x.transform[2],toY:(x.connectionPosition.y-x.transform[1])/x.transform[2],connectionMode:x.connectionMode}),[e]),shallow$1),E=v?.[internalsSymbol]?.handleBounds;let k=E?.[r];if(p===ConnectionMode.Loose&&(k=k||E?.[r==="source"?"target":"source"]),!v||!k)return null;const A=f?k.find(x=>x.id===f):k[0],z=A?A.x+A.width/2:(v.width??0)/2,l=A?A.y+A.height/2:v.height??0,s=(v.positionAbsolute?.x??0)+z,y=(v.positionAbsolute?.y??0)+l,w=A?.position,S=w?oppositePosition[w]:null;if(!w||!S)return null;if(c)return React.createElement(c,{connectionLineType:o,connectionLineStyle:t,fromNode:v,fromHandle:A,fromX:s,fromY:y,toX:g,toY:_,fromPosition:w,toPosition:S,connectionStatus:u});let C="";const h={sourceX:s,sourceY:y,sourcePosition:w,targetX:g,targetY:_,targetPosition:S};return o===ConnectionLineType.Bezier?[C]=getBezierPath(h):o===ConnectionLineType.Step?[C]=getSmoothStepPath({...h,borderRadius:0}):o===ConnectionLineType.SmoothStep?[C]=getSmoothStepPath(h):o===ConnectionLineType.SimpleBezier?[C]=getSimpleBezierPath(h):C=`M${s},${y} ${g},${_}`,React.createElement("path",{d:C,fill:"none",className:"react-flow__connection-path",style:t})};ConnectionLine.displayName="ConnectionLine";const selector$2=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function ConnectionLineWrapper({containerStyle:e,style:r,type:t,component:o}){const{nodeId:c,handleType:u,nodesConnectable:v,width:f,height:g,connectionStatus:_}=useStore(selector$2,shallow$1);return!(c&&u&&f&&v)?null:React.createElement("svg",{style:e,width:f,height:g,className:"react-flow__edges react-flow__connectionline react-flow__container"},React.createElement("g",{className:cc(["react-flow__connection",_])},React.createElement(ConnectionLine,{nodeId:c,handleType:u,style:r,type:t,CustomComponent:o,connectionStatus:_})))}function useNodeOrEdgeTypes(e,r){return reactExports.useRef(null),useStoreApi(),reactExports.useMemo(()=>r(e),[e])}const GraphView=({nodeTypes:e,edgeTypes:r,onMove:t,onMoveStart:o,onMoveEnd:c,onInit:u,onNodeClick:v,onEdgeClick:f,onNodeDoubleClick:g,onEdgeDoubleClick:_,onNodeMouseEnter:p,onNodeMouseMove:E,onNodeMouseLeave:k,onNodeContextMenu:A,onSelectionContextMenu:z,onSelectionStart:l,onSelectionEnd:s,connectionLineType:y,connectionLineStyle:w,connectionLineComponent:S,connectionLineContainerStyle:C,selectionKeyCode:h,selectionOnDrag:x,selectionMode:R,multiSelectionKeyCode:M,panActivationKeyCode:P,zoomActivationKeyCode:D,deleteKeyCode:L,onlyRenderVisibleElements:X,elementsSelectable:B,selectNodesOnDrag:j,defaultViewport:H,translateExtent:$,minZoom:q,maxZoom:W,preventScrolling:Y,defaultMarkerColor:G,zoomOnScroll:V,zoomOnPinch:Z,panOnScroll:xe,panOnScrollSpeed:ce,panOnScrollMode:Ne,zoomOnDoubleClick:Pe,panOnDrag:De,onPaneClick:Me,onPaneMouseEnter:Be,onPaneMouseMove:ft,onPaneMouseLeave:jt,onPaneScroll:Gt,onPaneContextMenu:mt,onEdgeContextMenu:Fe,onEdgeMouseEnter:ht,onEdgeMouseMove:Kt,onEdgeMouseLeave:Jt,onReconnect:Wt,onReconnectStart:Br,onReconnectEnd:zr,reconnectRadius:cr,noDragClassName:Nr,noWheelClassName:At,noPanClassName:Mt,elevateEdgesOnSelect:Jr,disableKeyboardA11y:Yr,nodeOrigin:ie,nodeExtent:ve,rfId:we})=>{const it=useNodeOrEdgeTypes(e,createNodeTypes),rt=useNodeOrEdgeTypes(r,createEdgeTypes);return useOnInitHandler(u),React.createElement(FlowRenderer$1,{onPaneClick:Me,onPaneMouseEnter:Be,onPaneMouseMove:ft,onPaneMouseLeave:jt,onPaneContextMenu:mt,onPaneScroll:Gt,deleteKeyCode:L,selectionKeyCode:h,selectionOnDrag:x,selectionMode:R,onSelectionStart:l,onSelectionEnd:s,multiSelectionKeyCode:M,panActivationKeyCode:P,zoomActivationKeyCode:D,elementsSelectable:B,onMove:t,onMoveStart:o,onMoveEnd:c,zoomOnScroll:V,zoomOnPinch:Z,zoomOnDoubleClick:Pe,panOnScroll:xe,panOnScrollSpeed:ce,panOnScrollMode:Ne,panOnDrag:De,defaultViewport:H,translateExtent:$,minZoom:q,maxZoom:W,onSelectionContextMenu:z,preventScrolling:Y,noDragClassName:Nr,noWheelClassName:At,noPanClassName:Mt,disableKeyboardA11y:Yr},React.createElement(Viewport,null,React.createElement(EdgeRenderer$1,{edgeTypes:rt,onEdgeClick:f,onEdgeDoubleClick:_,onlyRenderVisibleElements:X,onEdgeContextMenu:Fe,onEdgeMouseEnter:ht,onEdgeMouseMove:Kt,onEdgeMouseLeave:Jt,onReconnect:Wt,onReconnectStart:Br,onReconnectEnd:zr,reconnectRadius:cr,defaultMarkerColor:G,noPanClassName:Mt,elevateEdgesOnSelect:!!Jr,disableKeyboardA11y:Yr,rfId:we},React.createElement(ConnectionLineWrapper,{style:w,type:y,component:S,containerStyle:C})),React.createElement("div",{className:"react-flow__edgelabel-renderer"}),React.createElement(NodeRenderer$1,{nodeTypes:it,onNodeClick:v,onNodeDoubleClick:g,onNodeMouseEnter:p,onNodeMouseMove:E,onNodeMouseLeave:k,onNodeContextMenu:A,selectNodesOnDrag:j,onlyRenderVisibleElements:X,noPanClassName:Mt,noDragClassName:Nr,disableKeyboardA11y:Yr,nodeOrigin:ie,nodeExtent:ve,rfId:we})))};GraphView.displayName="GraphView";var GraphView$1=reactExports.memo(GraphView);const infiniteExtent=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],initialState={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:infiniteExtent,nodeExtent:infiniteExtent,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:ConnectionMode.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:devWarn,isValidConnection:void 0},createRFStore=()=>createWithEqualityFn((e,r)=>({...initialState,setNodes:t=>{const{nodeInternals:o,nodeOrigin:c,elevateNodesOnSelect:u}=r();e({nodeInternals:createNodeInternals(t,o,c,u)})},getNodes:()=>Array.from(r().nodeInternals.values()),setEdges:t=>{const{defaultEdgeOptions:o={}}=r();e({edges:t.map(c=>({...o,...c}))})},setDefaultNodesAndEdges:(t,o)=>{const c=typeof t<"u",u=typeof o<"u",v=c?createNodeInternals(t,new Map,r().nodeOrigin,r().elevateNodesOnSelect):new Map;e({nodeInternals:v,edges:u?o:[],hasDefaultNodes:c,hasDefaultEdges:u})},updateNodeDimensions:t=>{const{onNodesChange:o,nodeInternals:c,fitViewOnInit:u,fitViewOnInitDone:v,fitViewOnInitOptions:f,domNode:g,nodeOrigin:_}=r(),p=g?.querySelector(".react-flow__viewport");if(!p)return;const E=window.getComputedStyle(p),{m22:k}=new window.DOMMatrixReadOnly(E.transform),A=t.reduce((l,s)=>{const y=c.get(s.id);if(y?.hidden)c.set(y.id,{...y,[internalsSymbol]:{...y[internalsSymbol],handleBounds:void 0}});else if(y){const w=getDimensions(s.nodeElement);!!(w.width&&w.height&&(y.width!==w.width||y.height!==w.height||s.forceUpdate))&&(c.set(y.id,{...y,[internalsSymbol]:{...y[internalsSymbol],handleBounds:{source:getHandleBounds(".source",s.nodeElement,k,_),target:getHandleBounds(".target",s.nodeElement,k,_)}},...w}),l.push({id:y.id,type:"dimensions",dimensions:w}))}return l},[]);updateAbsoluteNodePositions(c,_);const z=v||u&&!v&&fitView(r,{initial:!0,...f});e({nodeInternals:new Map(c),fitViewOnInitDone:z}),A?.length>0&&o?.(A)},updateNodePositions:(t,o=!0,c=!1)=>{const{triggerNodeChanges:u}=r(),v=t.map(f=>{const g={id:f.id,type:"position",dragging:c};return o&&(g.positionAbsolute=f.positionAbsolute,g.position=f.position),g});u(v)},triggerNodeChanges:t=>{const{onNodesChange:o,nodeInternals:c,hasDefaultNodes:u,nodeOrigin:v,getNodes:f,elevateNodesOnSelect:g}=r();if(t?.length){if(u){const _=applyNodeChanges(t,f()),p=createNodeInternals(_,c,v,g);e({nodeInternals:p})}o?.(t)}},addSelectedNodes:t=>{const{multiSelectionActive:o,edges:c,getNodes:u}=r();let v,f=null;o?v=t.map(g=>createSelectionChange(g,!0)):(v=getSelectionChanges(u(),t),f=getSelectionChanges(c,[])),updateNodesAndEdgesSelections({changedNodes:v,changedEdges:f,get:r,set:e})},addSelectedEdges:t=>{const{multiSelectionActive:o,edges:c,getNodes:u}=r();let v,f=null;o?v=t.map(g=>createSelectionChange(g,!0)):(v=getSelectionChanges(c,t),f=getSelectionChanges(u(),[])),updateNodesAndEdgesSelections({changedNodes:f,changedEdges:v,get:r,set:e})},unselectNodesAndEdges:({nodes:t,edges:o}={})=>{const{edges:c,getNodes:u}=r(),v=t||u(),f=o||c,g=v.map(p=>(p.selected=!1,createSelectionChange(p.id,!1))),_=f.map(p=>createSelectionChange(p.id,!1));updateNodesAndEdgesSelections({changedNodes:g,changedEdges:_,get:r,set:e})},setMinZoom:t=>{const{d3Zoom:o,maxZoom:c}=r();o?.scaleExtent([t,c]),e({minZoom:t})},setMaxZoom:t=>{const{d3Zoom:o,minZoom:c}=r();o?.scaleExtent([c,t]),e({maxZoom:t})},setTranslateExtent:t=>{r().d3Zoom?.translateExtent(t),e({translateExtent:t})},resetSelectedElements:()=>{const{edges:t,getNodes:o}=r(),u=o().filter(f=>f.selected).map(f=>createSelectionChange(f.id,!1)),v=t.filter(f=>f.selected).map(f=>createSelectionChange(f.id,!1));updateNodesAndEdgesSelections({changedNodes:u,changedEdges:v,get:r,set:e})},setNodeExtent:t=>{const{nodeInternals:o}=r();o.forEach(c=>{c.positionAbsolute=clampPosition(c.position,t)}),e({nodeExtent:t,nodeInternals:new Map(o)})},panBy:t=>{const{transform:o,width:c,height:u,d3Zoom:v,d3Selection:f,translateExtent:g}=r();if(!v||!f||!t.x&&!t.y)return!1;const _=identity.translate(o[0]+t.x,o[1]+t.y).scale(o[2]),p=[[0,0],[c,u]],E=v?.constrain()(_,p,g);return v.transform(f,E),o[0]!==E.x||o[1]!==E.y||o[2]!==E.k},cancelConnection:()=>e({connectionNodeId:initialState.connectionNodeId,connectionHandleId:initialState.connectionHandleId,connectionHandleType:initialState.connectionHandleType,connectionStatus:initialState.connectionStatus,connectionStartHandle:initialState.connectionStartHandle,connectionEndHandle:initialState.connectionEndHandle}),reset:()=>e({...initialState})}),Object.is),ReactFlowProvider=({children:e})=>{const r=reactExports.useRef(null);return r.current||(r.current=createRFStore()),React.createElement(Provider$1,{value:r.current},e)};ReactFlowProvider.displayName="ReactFlowProvider";const Wrapper=({children:e})=>reactExports.useContext(StoreContext)?React.createElement(React.Fragment,null,e):React.createElement(ReactFlowProvider,null,e);Wrapper.displayName="ReactFlowWrapper";const defaultNodeTypes={input:InputNode$1,default:DefaultNode$1,output:OutputNode$1,group:GroupNode},defaultEdgeTypes={default:BezierEdge,straight:StraightEdge,step:StepEdge,smoothstep:SmoothStepEdge,simplebezier:SimpleBezierEdge},initNodeOrigin=[0,0],initSnapGrid=[15,15],initDefaultViewport={x:0,y:0,zoom:1},wrapperStyle={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ReactFlow=reactExports.forwardRef(({nodes:e,edges:r,defaultNodes:t,defaultEdges:o,className:c,nodeTypes:u=defaultNodeTypes,edgeTypes:v=defaultEdgeTypes,onNodeClick:f,onEdgeClick:g,onInit:_,onMove:p,onMoveStart:E,onMoveEnd:k,onConnect:A,onConnectStart:z,onConnectEnd:l,onClickConnectStart:s,onClickConnectEnd:y,onNodeMouseEnter:w,onNodeMouseMove:S,onNodeMouseLeave:C,onNodeContextMenu:h,onNodeDoubleClick:x,onNodeDragStart:R,onNodeDrag:M,onNodeDragStop:P,onNodesDelete:D,onEdgesDelete:L,onSelectionChange:X,onSelectionDragStart:B,onSelectionDrag:j,onSelectionDragStop:H,onSelectionContextMenu:$,onSelectionStart:q,onSelectionEnd:W,connectionMode:Y=ConnectionMode.Strict,connectionLineType:G=ConnectionLineType.Bezier,connectionLineStyle:V,connectionLineComponent:Z,connectionLineContainerStyle:xe,deleteKeyCode:ce="Backspace",selectionKeyCode:Ne="Shift",selectionOnDrag:Pe=!1,selectionMode:De=SelectionMode.Full,panActivationKeyCode:Me="Space",multiSelectionKeyCode:Be=isMacOs()?"Meta":"Control",zoomActivationKeyCode:ft=isMacOs()?"Meta":"Control",snapToGrid:jt=!1,snapGrid:Gt=initSnapGrid,onlyRenderVisibleElements:mt=!1,selectNodesOnDrag:Fe=!0,nodesDraggable:ht,nodesConnectable:Kt,nodesFocusable:Jt,nodeOrigin:Wt=initNodeOrigin,edgesFocusable:Br,edgesUpdatable:zr,elementsSelectable:cr,defaultViewport:Nr=initDefaultViewport,minZoom:At=.5,maxZoom:Mt=2,translateExtent:Jr=infiniteExtent,preventScrolling:Yr=!0,nodeExtent:ie,defaultMarkerColor:ve="#b1b1b7",zoomOnScroll:we=!0,zoomOnPinch:it=!0,panOnScroll:rt=!1,panOnScrollSpeed:Yt=.5,panOnScrollMode:Ft=PanOnScrollMode.Free,zoomOnDoubleClick:re=!0,panOnDrag:tt=!0,onPaneClick:lt,onPaneMouseEnter:ar,onPaneMouseMove:et,onPaneMouseLeave:Ot,onPaneScroll:se,onPaneContextMenu:xt,children:Vr,onEdgeContextMenu:J,onEdgeDoubleClick:ut,onEdgeMouseEnter:at,onEdgeMouseMove:me,onEdgeMouseLeave:Ze,onEdgeUpdate:vt,onEdgeUpdateStart:Qr,onEdgeUpdateEnd:Xr,onReconnect:Zr,onReconnectStart:xn,onReconnectEnd:Ei,reconnectRadius:zn=10,edgeUpdaterRadius:Pn=10,onNodesChange:On,onEdgesChange:mi,noDragClassName:xi="nodrag",noWheelClassName:Ca="nowheel",noPanClassName:Aa="nopan",fitView:ei=!1,fitViewOptions:ai,connectOnClick:ci=!0,attributionPosition:Xs,proOptions:Us,defaultEdgeOptions:fa,elevateNodesOnSelect:ll=!0,elevateEdgesOnSelect:cl=!1,disableKeyboardA11y:ul=!1,autoPanOnConnect:Ya=!0,autoPanOnNodeDrag:hi=!0,connectionRadius:dl=20,isValidConnection:ja,onError:kc,style:Ln,id:Ra,nodeDragThreshold:pa,...Tl},Ws)=>{const hl=Ra||"1";return React.createElement("div",{...Tl,style:{...Ln,...wrapperStyle},ref:Ws,className:cc(["react-flow",c]),"data-testid":"rf__wrapper",id:Ra},React.createElement(Wrapper,null,React.createElement(GraphView$1,{onInit:_,onMove:p,onMoveStart:E,onMoveEnd:k,onNodeClick:f,onEdgeClick:g,onNodeMouseEnter:w,onNodeMouseMove:S,onNodeMouseLeave:C,onNodeContextMenu:h,onNodeDoubleClick:x,nodeTypes:u,edgeTypes:v,connectionLineType:G,connectionLineStyle:V,connectionLineComponent:Z,connectionLineContainerStyle:xe,selectionKeyCode:Ne,selectionOnDrag:Pe,selectionMode:De,deleteKeyCode:ce,multiSelectionKeyCode:Be,panActivationKeyCode:Me,zoomActivationKeyCode:ft,onlyRenderVisibleElements:mt,selectNodesOnDrag:Fe,defaultViewport:Nr,translateExtent:Jr,minZoom:At,maxZoom:Mt,preventScrolling:Yr,zoomOnScroll:we,zoomOnPinch:it,zoomOnDoubleClick:re,panOnScroll:rt,panOnScrollSpeed:Yt,panOnScrollMode:Ft,panOnDrag:tt,onPaneClick:lt,onPaneMouseEnter:ar,onPaneMouseMove:et,onPaneMouseLeave:Ot,onPaneScroll:se,onPaneContextMenu:xt,onSelectionContextMenu:$,onSelectionStart:q,onSelectionEnd:W,onEdgeContextMenu:J,onEdgeDoubleClick:ut,onEdgeMouseEnter:at,onEdgeMouseMove:me,onEdgeMouseLeave:Ze,onReconnect:Zr??vt,onReconnectStart:xn??Qr,onReconnectEnd:Ei??Xr,reconnectRadius:zn??Pn,defaultMarkerColor:ve,noDragClassName:xi,noWheelClassName:Ca,noPanClassName:Aa,elevateEdgesOnSelect:cl,rfId:hl,disableKeyboardA11y:ul,nodeOrigin:Wt,nodeExtent:ie}),React.createElement(StoreUpdater,{nodes:e,edges:r,defaultNodes:t,defaultEdges:o,onConnect:A,onConnectStart:z,onConnectEnd:l,onClickConnectStart:s,onClickConnectEnd:y,nodesDraggable:ht,nodesConnectable:Kt,nodesFocusable:Jt,edgesFocusable:Br,edgesUpdatable:zr,elementsSelectable:cr,elevateNodesOnSelect:ll,minZoom:At,maxZoom:Mt,nodeExtent:ie,onNodesChange:On,onEdgesChange:mi,snapToGrid:jt,snapGrid:Gt,connectionMode:Y,translateExtent:Jr,connectOnClick:ci,defaultEdgeOptions:fa,fitView:ei,fitViewOptions:ai,onNodesDelete:D,onEdgesDelete:L,onNodeDragStart:R,onNodeDrag:M,onNodeDragStop:P,onSelectionDrag:j,onSelectionDragStart:B,onSelectionDragStop:H,noPanClassName:Aa,nodeOrigin:Wt,rfId:hl,autoPanOnConnect:Ya,autoPanOnNodeDrag:hi,onError:kc,connectionRadius:dl,isValidConnection:ja,nodeDragThreshold:pa}),React.createElement(Wrapper$1,{onSelectionChange:X}),Vr,React.createElement(Attribution,{proOptions:Us,position:Xs}),React.createElement(A11yDescriptions,{rfId:hl,disableKeyboardA11y:ul})))});ReactFlow.displayName="ReactFlow";const viewportSelector=e=>({x:e.transform[0],y:e.transform[1],zoom:e.transform[2]});function useViewport(){return useStore(viewportSelector,shallow$1)}function PlusIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},React.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function MinusIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},React.createElement("path",{d:"M0 0h32v4.2H0z"}))}function FitViewIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},React.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function LockIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},React.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function UnlockIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},React.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const ControlButton=({children:e,className:r,...t})=>React.createElement("button",{type:"button",className:cc(["react-flow__controls-button",r]),...t},e);ControlButton.displayName="ControlButton";const selector$1=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Controls=({style:e,showZoom:r=!0,showFitView:t=!0,showInteractive:o=!0,fitViewOptions:c,onZoomIn:u,onZoomOut:v,onFitView:f,onInteractiveChange:g,className:_,children:p,position:E="bottom-left"})=>{const k=useStoreApi(),[A,z]=reactExports.useState(!1),{isInteractive:l,minZoomReached:s,maxZoomReached:y}=useStore(selector$1,shallow$1),{zoomIn:w,zoomOut:S,fitView:C}=useReactFlow();if(reactExports.useEffect(()=>{z(!0)},[]),!A)return null;const h=()=>{w(),u?.()},x=()=>{S(),v?.()},R=()=>{C(c),f?.()},M=()=>{k.setState({nodesDraggable:!l,nodesConnectable:!l,elementsSelectable:!l}),g?.(!l)};return React.createElement(Panel,{className:cc(["react-flow__controls",_]),position:E,style:e,"data-testid":"rf__controls"},r&&React.createElement(React.Fragment,null,React.createElement(ControlButton,{onClick:h,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:y},React.createElement(PlusIcon,null)),React.createElement(ControlButton,{onClick:x,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:s},React.createElement(MinusIcon,null))),t&&React.createElement(ControlButton,{className:"react-flow__controls-fitview",onClick:R,title:"fit view","aria-label":"fit view"},React.createElement(FitViewIcon,null)),o&&React.createElement(ControlButton,{className:"react-flow__controls-interactive",onClick:M,title:"toggle interactivity","aria-label":"toggle interactivity"},l?React.createElement(UnlockIcon,null):React.createElement(LockIcon,null)),p)};Controls.displayName="Controls";var Controls$1=reactExports.memo(Controls),BackgroundVariant;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(BackgroundVariant||(BackgroundVariant={}));function LinePattern({color:e,dimensions:r,lineWidth:t}){return React.createElement("path",{stroke:e,strokeWidth:t,d:`M${r[0]/2} 0 V${r[1]} M0 ${r[1]/2} H${r[0]}`})}function DotPattern({color:e,radius:r}){return React.createElement("circle",{cx:r,cy:r,r,fill:e})}const defaultColor={[BackgroundVariant.Dots]:"#91919a",[BackgroundVariant.Lines]:"#eee",[BackgroundVariant.Cross]:"#e2e2e2"},defaultSize={[BackgroundVariant.Dots]:1,[BackgroundVariant.Lines]:1,[BackgroundVariant.Cross]:6},selector=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Background({id:e,variant:r=BackgroundVariant.Dots,gap:t=20,size:o,lineWidth:c=1,offset:u=2,color:v,style:f,className:g}){const _=reactExports.useRef(null),{transform:p,patternId:E}=useStore(selector,shallow$1),k=v||defaultColor[r],A=o||defaultSize[r],z=r===BackgroundVariant.Dots,l=r===BackgroundVariant.Cross,s=Array.isArray(t)?t:[t,t],y=[s[0]*p[2]||1,s[1]*p[2]||1],w=A*p[2],S=l?[w,w]:y,C=z?[w/u,w/u]:[S[0]/u,S[1]/u];return React.createElement("svg",{className:cc(["react-flow__background",g]),style:{...f,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:_,"data-testid":"rf__background"},React.createElement("pattern",{id:E+e,x:p[0]%y[0],y:p[1]%y[1],width:y[0],height:y[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${C[0]},-${C[1]})`},z?React.createElement(DotPattern,{color:k,radius:w/u}):React.createElement(LinePattern,{dimensions:S,color:k,lineWidth:c})),React.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${E+e})`}))}Background.displayName="Background";var Background$1=reactExports.memo(Background);function getNodeDisplay(e){`${e.aiida.uuid.split("-")[0]}`;const r=" ";switch(e.label){case"Int":case"Float":return e.attributes?.value!==void 0?`Value: ${e.attributes.value}`:r;case"Str":return r;case"Bool":return e.attributes?.value!==void 0?`Value: ${e.attributes.value}`:r;case"List":return e.attributes?.value!==void 0?`Length: ${e.attributes.list.length}`:r;case"KpointsData":if(e.attributes?.mesh){const[c,u,v]=e.attributes.mesh;return`Grid: ${c} × ${u} × ${v}`}return e.attributes?.labels&&e.attributes?.label_numbers?`Path: ${e.attributes.labels.join(" → ")}`:r;case"StructureData":{let c=function(u,v=22){const f={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉"},g=u.replace(/\d/g,_=>f[_]||_);return g.length>v?g.slice(0,v-3)+"...":g};var t=c;return e.extras?.formula_hill?`${c(e.extras.formula_hill)}`:e.derived_properties?.formula?`${c(e.derived_properties?.formula)}`:r}case"UpfData":{const c=e.download?.pseudo_potential?.header?.element,u=e.download?.pseudo_potential?.header?.pseudo_type,v=e.download?.pseudo_potential?.header?.original_upf_file;return c&&u?`${v}`:r}case"BandsData":const o=e.attributes?.["array|bands"];return o?.[1]!==void 0?`No. Bands: ${o[1]}`:r;case"Dict":return r;case"EnumData":return r;case"JsonableData":return r;case"ArrayData":return r;case"XyData":return r;case"SinglefileData":return r;case"FolderData":return r;case"RemoteData":return r;case"AbstractCode":return r;case"Code":return r;case"InstalledCode":return r;case"PortableCode":return r;case"ContainerizedCode":return r;default:return r}}function getNodeColorClasses(e,r=!1){let t="bg-gray-200",o="text-black",c="transition-all";return e?.startsWith("process.workflow")?(t="bg-orange-300",c="border-orange-400 shadow-md"):e?.startsWith("process")?(t="bg-red-300",c="border-red-400 shadow-md"):e?.startsWith("data")&&(t="bg-green-300",c="border-green-400 shadow-md"),r&&(c="border-2 border-blue-600 shadow-md rounded-md transition duration-700",t="bg-blue-100 glow-4",o="text-black font-semibold"),{bgClass:t,textClass:o,borderStyle:c}}function HorizontalNode({data:e,selected:r}){const{zoom:t}=useViewport(),o="min-w-[120px] text-center p-1.5 px-3 rounded border-3",c=`absolute -translate-y-1/4
   whitespace-nowrap opacity-90
   bg-slate-200 border border-gray-300
   rounded-md px-1 py-0.5 text-gray-700 `,u=`${c} left-full ml-1 text-left`,v=`${c} right-full mr-1 text-right`,f=t>1.2,_=`
  absolute
  top-1/3
  bottom-1/3
  flex
  items-center
  ${f?"text-[8px]":"text-[10px]"}
  text-slate-600
  font-light
  ${f?"":"hidden"}
`,p=`${_} left-0 ml-0.5 pr-1 pl-0.5
   bg-gray-400 bg-opacity-40 rounded-r-md`,E=`${_} right-0 mr-0.5 pl-1 pr-0.5
   bg-gray-400 bg-opacity-40 rounded-l-md`,{bgClass:k,textClass:A,borderStyle:z}=getNodeColorClasses(e.node_type,r,e.pos),l=e.aiida.uuid.split("-")[0],s=getNodeDisplay(e),y=t>1.2?"text-[12px]":"text-[14px]",w=t>1.2?"text-[9px] px-2 py-1":"text-[12px] px-2 py-1",S=jsxRuntimeExports$1.jsxs("div",{className:`${y}`,children:[e.label,t>1.2&&jsxRuntimeExports$1.jsx("br",{}),t>1.2&&jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("div",{className:"text-[8px] opacity-80",children:`uuid: ${l}`}),jsxRuntimeExports$1.jsx("div",{className:"text-[8px] opacity-80 ",children:`${s}`})]})]}),C=e.aiida?.link_label&&e.pos!==0?jsxRuntimeExports$1.jsx("div",{className:`${e.pos===1?u:v} ${w}`,children:e.aiida.link_label.length>21?`${e.aiida.link_label.slice(0,18)}...`:e.aiida.link_label}):null;return jsxRuntimeExports$1.jsxs("div",{className:`${o} ${k} ${A} ${z}`,children:[C,jsxRuntimeExports$1.jsx("div",{className:p,children:e.parentCount??""}),jsxRuntimeExports$1.jsx("div",{className:E,children:e.childCount??""}),S,jsxRuntimeExports$1.jsx(Handle$1,{type:"target",position:Position.Left,style:{pointerEvents:"none",opacity:0,marginLeft:"4px"}}),jsxRuntimeExports$1.jsx(Handle$1,{type:"source",position:Position.Right,style:{pointerEvents:"none",opacity:0,marginRight:"4px"}})]})}const nodeTypes={custom:HorizontalNode};function FlowChart({nodes:e,edges:r,setNodes:t,setEdges:o,selectedNode:c,onNodeSelect:u,onNodeDoubleSelect:v}){const f=reactExports.useCallback((p,E)=>{u&&u(E)},[u]),g=reactExports.useCallback((p,E)=>{v&&v(E)},[v]),_=e.map(p=>({...p,type:"custom",selected:c?.id===p.id}));return jsxRuntimeExports$1.jsx("div",{className:"w-full h-full",children:jsxRuntimeExports$1.jsxs(ReactFlow,{className:"bg-slate-50",nodes:_,edges:r,nodeTypes,onNodesChange:p=>t(E=>applyNodeChanges(p,E)),onEdgesChange:p=>o(E=>applyEdgeChanges(p,E)),onNodeClick:f,onNodeDoubleClick:g,fitView:!0,nodesDraggable:!0,nodesConnectable:!1,children:[jsxRuntimeExports$1.jsx(Controls$1,{}),jsxRuntimeExports$1.jsx(Background$1,{variant:"dots",gap:12,size:1})]})})}function DebugPane({selectedNode:e}){return jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4",children:[jsxRuntimeExports$1.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Node Info"}),e?jsxRuntimeExports$1.jsxs("pre",{className:"bg-gray-100 p-2 rounded overflow-x-auto",children:[" ",JSON.stringify(e.data,null,2)]}):jsxRuntimeExports$1.jsx("p",{children:"Click a node to see top level details. Double click fetch the node and get all the details."})]})}function SortIcon({direction:e="asc",size:r=14,className:t=""}){return jsxRuntimeExports$1.jsx("svg",{width:r,height:r,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",className:`${t} transform ${e==="asc"?"rotate-180":""}`,children:jsxRuntimeExports$1.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"})})}function DataTable({title:e,columns:r,data:t=[],maxWidth:o="1500px",sortableCols:c=!0,renderIfMissing:u=!1}){const[v,f]=reactExports.useState({key:null,direction:"asc"});if(!u&&(!t||t.length===0))return null;const g=reactExports.useMemo(()=>{if(!v.key)return t;const _=[...t].sort((p,E)=>{const k=p[v.key],A=E[v.key];return!isNaN(k)&&!isNaN(A)?k-A:String(k).localeCompare(String(A))});return v.direction==="asc"?_:_.reverse()},[t,v]);return jsxRuntimeExports$1.jsxs("div",{className:"p-2",style:{maxWidth:o},children:[jsxRuntimeExports$1.jsx("h2",{className:"text-xl font-semibold mb-2",children:e}),jsxRuntimeExports$1.jsx("div",{className:"overflow-x-auto shadow bg-white",children:jsxRuntimeExports$1.jsxs("table",{className:"min-w-full text-sm text-left",children:[jsxRuntimeExports$1.jsx("thead",{className:"bg-gray-100 text-gray-700",children:jsxRuntimeExports$1.jsx("tr",{children:r.map(_=>{const p=Array.isArray(c)?c.includes(_):c;return jsxRuntimeExports$1.jsx("th",{className:`px-4 py-2 font-medium ${p?"cursor-pointer select-none":""}`,onClick:()=>p&&f(E=>({key:_,direction:E.key===_&&E.direction==="asc"?"desc":"asc"})),children:jsxRuntimeExports$1.jsxs("div",{className:"flex items-center gap-1",children:[_,p&&v.key===_&&jsxRuntimeExports$1.jsx(SortIcon,{direction:v.direction,size:14,className:"ml-1 text-gray-500"})]})},_)})})}),jsxRuntimeExports$1.jsx("tbody",{children:g.map((_,p)=>jsxRuntimeExports$1.jsx("tr",{className:p%2===0?"bg-white":"bg-gray-50",children:r.map(E=>jsxRuntimeExports$1.jsx("td",{className:"px-4 py-2 text-gray-800",children:_[E]},E))},_.id||p))})]})})]})}function TreeDropdown({data:e,onSelect:r,openNodes:t,toggleNode:o,arrowClassName:c="w-8 h-8 text-blue-500 transform transition-transform duration-300"}){if(!e)return null;const u=({node:v})=>{const f=v.subspaces&&v.subspaces.length>0,g=!!t[v.full_type];return jsxRuntimeExports$1.jsxs("div",{className:"ml-2",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex items-center gap-1",children:[f&&jsxRuntimeExports$1.jsx("div",{className:"cursor-pointer",onClick:()=>o(v.full_type),children:jsxRuntimeExports$1.jsx("svg",{className:`${c} ${g?"rotate-90":""}`,viewBox:"0 0 20 20",fill:"currentColor",children:jsxRuntimeExports$1.jsx("path",{d:"M6 6L14 10L6 14V6Z"})})}),jsxRuntimeExports$1.jsx("div",{className:"cursor-pointer text-gray-800 hover:bg-gray-100 p-1 rounded flex-1",onClick:()=>r&&r(v),children:v.label})]}),f&&jsxRuntimeExports$1.jsx("div",{className:"overflow-hidden transition-all duration-300 origin-top",style:{maxHeight:g?"1000px":"0"},children:v.subspaces.map(_=>jsxRuntimeExports$1.jsx(u,{node:_},_.full_type))})]})};return jsxRuntimeExports$1.jsx("div",{className:"border rounded p-2 bg-white shadow max-w-md",children:jsxRuntimeExports$1.jsx(u,{node:e})})}function layoutDefaults(e){return{spacingX:e.spacingX||310,spacingY:e.spacingY||90,groupGapY:e.groupGapY||150,centerX:e.centerX||window.innerWidth/2,centerY:e.centerY||window.innerHeight/2,edgeStyle:{stroke:"grey",strokeWidth:2}}}function edgeStyleFor(e,r){const t=e.data?.node_type||"";return t.includes("workflow")||t.includes("process")?{...r,strokeDasharray:"5,5"}:r}function arrangeDataCenterNode(e,r,t,o={}){const{spacingX:c,spacingY:u,groupGapY:v,centerX:f,centerY:g,edgeStyle:_}=layoutDefaults(o),p=[],E=[];p.push({...e,position:{x:f,y:g}});const k=r.filter(x=>x.data?.node_type.includes("calculation")),A=r.filter(x=>x.data?.node_type.includes("workflow")).sort((x,R)=>new Date(R.data.aiida.ctime)-new Date(x.data.aiida.ctime)),z=t.filter(x=>x.data?.node_type.includes("calculation")).sort((x,R)=>new Date(R.data.aiida.ctime)-new Date(x.data.aiida.ctime)),l=t.filter(x=>x.data?.node_type.includes("workflow")).sort((x,R)=>new Date(R.data.aiida.ctime)-new Date(x.data.aiida.ctime)),s=g-(k.length-1)/2*u;k.forEach((x,R)=>{const M=s+R*u;p.push({...x,position:{x:f-c,y:M}}),E.push({id:`e-${x.id}->${e.id}`,source:x.id,target:e.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(x,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});let y=k.length>0?v:0;const w=s-y-(A.length-1)*u;A.forEach((x,R)=>{const M=w+R*u;p.push({...x,position:{x:f-c,y:M}}),E.push({id:`e-${x.id}->${e.id}`,source:x.id,target:e.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(x,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const S=g-(z.length-1)/2*u;z.forEach((x,R)=>{const M=S+R*u;p.push({...x,position:{x:f+c,y:M}}),E.push({id:`e-${e.id}->${x.id}`,source:e.id,target:x.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(x,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});let C=z.length>0?v:0,h=S-C-(l.length-1)*u;return l.forEach((x,R)=>{const M=h+R*u;p.push({...x,position:{x:f+c,y:M}}),E.push({id:`e-${e.id}->${x.id}`,source:e.id,target:x.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(x,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})}),{nodes:p,edges:E}}function arrangeCalculationCenterNode(e,r,t,o={}){const{spacingX:c,spacingY:u,groupGapY:v,centerX:f,centerY:g,edgeStyle:_}=layoutDefaults(o),p=[],E=[];p.push({...e,position:{x:f,y:g}});const k=r.filter(C=>C.data?.node_type.includes("data")).sort((C,h)=>C.data.label.localeCompare(h.data.label)),A=r.filter(C=>C.data?.node_type.includes("workflow")).sort((C,h)=>new Date(h.data.aiida.ctime)-new Date(C.data.aiida.ctime)),z=t.filter(C=>C.data?.node_type.startsWith("data")).sort((C,h)=>C.data.label.localeCompare(h.data.label)),l=t.filter(C=>C.data?.node_type.includes("workflow")).sort((C,h)=>new Date(h.data.aiida.ctime)-new Date(C.data.aiida.ctime)),s=g-(k.length-1)/2*u;k.forEach((C,h)=>{const x=s+h*u;p.push({...C,position:{x:f-c,y:x}}),E.push({id:`e-${C.id}->${e.id}`,source:C.id,target:e.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const y=s-v-(A.length-1)*u;A.forEach((C,h)=>{const x=y+h*u;p.push({...C,position:{x:f-c,y:x}}),E.push({id:`e-${C.id}->${e.id}`,source:C.id,target:e.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const w=g-(z.length-1)/2*u;z.forEach((C,h)=>{const x=w+h*u;p.push({...C,position:{x:f+c,y:x}}),E.push({id:`e-${e.id}->${C.id}`,source:e.id,target:C.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const S=w-v-(l.length-1)*u;return l.forEach((C,h)=>{const x=S+h*u;p.push({...C,position:{x:f+c,y:x}}),E.push({id:`e-${e.id}->${C.id}`,source:e.id,target:C.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})}),{nodes:p,edges:E}}function arrangeWorkflowCenterNode(e,r,t,o={}){const{spacingX:c,spacingY:u,groupGapY:v,centerX:f,centerY:g,edgeStyle:_}=layoutDefaults(o),p=[],E=[];p.push({...e,position:{x:f,y:g}});const k=r.filter(C=>C.data?.node_type.startsWith("data")),A=r.filter(C=>["calculation","workflow","process"].includes(C.data?.node_type.split(".")[1])),z=t.filter(C=>C.data?.node_type.startsWith("data")),l=t.filter(C=>["calculation","workflow","process"].includes(C.data?.node_type.split(".")[1])),s=g-(k.length-1)/2*u;k.forEach((C,h)=>{const x=s+h*u;p.push({...C,position:{x:f-c,y:x}}),E.push({id:`e-${C.id}->${e.id}`,source:C.id,target:e.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const y=s-v-(A.length-1)*u;A.forEach((C,h)=>{const x=y+h*u;p.push({...C,position:{x:f-c,y:x}}),E.push({id:`e-${C.id}->${e.id}`,source:C.id,target:e.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const w=g-(z.length-1)/2*u;z.forEach((C,h)=>{const x=w+h*u;p.push({...C,position:{x:f+c,y:x}}),E.push({id:`e-${e.id}->${C.id}`,source:e.id,target:C.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})});const S=w-v-(l.length-1)*u;return l.forEach((C,h)=>{const x=S+h*u;p.push({...C,position:{x:f+c,y:x}}),E.push({id:`e-${e.id}->${C.id}`,source:e.id,target:C.id,sourcePosition:"right",targetPosition:"left",type:"smoothstep",style:edgeStyleFor(C,_),markerEnd:{type:"arrow",color:"grey",width:20,height:15}})}),{nodes:p,edges:E}}function layoutGraphDefault(e,r,t,o={}){const c=e.data?.node_type.split(".")[0],u=e.data?.node_type.split(".")[1],v={data:arrangeDataCenterNode,calculation:arrangeCalculationCenterNode,workflow:arrangeWorkflowCenterNode},f=v[c]||v[u];return f?f(e,r,t,o):(console.warn("No arranger found for node type:",e.data?.node_type),{nodes:[e],edges:[]})}async function fetchUsers(e){try{const r=await fetch(`${e}/users/`);if(!r.ok)return null;const o=(await r.json()).data;return console.log("users",o),o}catch(r){return console.error("Error fetching node:",r),null}}async function fetchDownloadFormats(e){try{const r=await fetch(`${e}/nodes/download_formats/`);if(!r.ok)return null;const o=(await r.json()).data;return console.log("download_formats",o),o}catch(r){return console.error("Error fetching node:",r),null}}async function fetchNodeById(e,r){if(!r)return null;try{const t=await fetch(`${e}/nodes/${encodeURIComponent(r)}`);return t.ok?t.json():null}catch(t){return console.error("Error fetching node:",t),null}}async function fetchNodeContents(e,r){if(!r)return null;const t=["attributes","comments","extras","derived_properties"],o={};for(const c of t)try{const u=await fetch(`${e}/nodes/${encodeURIComponent(r)}/contents/${c}`);if(!u.ok){u.status!==404&&console.warn(`Endpoint ${c} failed for node ${r}:`,u.status);continue}const v=await u.json();o[c]=v?.data?.[c]??v??{}}catch(u){console.error(`Error fetching ${c} for node ${r}:`,u)}return o}async function fetchNodeRepoList(e,r){if(!r)return null;try{const t=await fetch(`${e}/nodes/${encodeURIComponent(r)}/repo/list`);return t.ok?t.json():null}catch(t){return console.error("Error fetching node:",t),null}}async function fetchAPIFullTypes(e){try{const r=await fetch(`${e}/nodes/full_types`);return r.ok?r.json():null}catch(r){return console.error("Error fetching node:",r),null}}async function fetchRetrievedUUID(e,r){if(!r)return null;try{const t=await fetch(`${e}/nodes/${encodeURIComponent(r)}/links/outgoing/`);if(!t.ok)return null;const o=await t.json();return console.log("d",o),(o?.data?.outgoing||[]).find(v=>v.link_label==="retrieved")?.uuid||null}catch(t){return console.error("Error fetching node:",t),null}}async function fetchFiles(e,r,t){if(!r)return null;const o=["input_files","output_files"],c={};for(const u of o)try{const v=`${e}/calcjobs/${encodeURIComponent(r)}/${u}`,f=await fetch(v);if(!f.ok){f.status!==404&&console.warn(`Endpoint ${u} failed for node ${r}:`,f.status);continue}const g=await f.json(),_=Array.isArray(g.data?.[u])?g.data[u]:Array.isArray(g.data)?g.data:[];console.log(r);const p=u==="input_files"?r:t,E=_.filter(k=>k.type==="FILE").map(k=>({...k,downloadUrl:`${e}/nodes/${encodeURIComponent(p)}/repo/contents?filename=%22${encodeURIComponent(k.name)}%22`}));c[u]=E}catch(v){console.error(`Error fetching ${u} for node ${r}:`,v)}return c}async function fetchJson(e,r){if(!r)return{incoming:[],outgoing:[]};try{const t=await fetch(`${e}/nodes/${encodeURIComponent(r)}/download?download_format=json`);return t.ok?t.json():null}catch(t){return console.error("Error fetching node:",t),null}}async function fetchCif(e,r){if(!r)return{cifText:null};try{const t=await fetch(`${e}/nodes/${encodeURIComponent(r)}/download?download_format=cif&download=false`);return t.ok?{cifText:(await t.json()).data.download.data||null}:{cifText:null}}catch(t){return console.error("Error fetching node:",t),{cifText:null}}}async function fetchGroups(e){try{const r=await fetch(`${e}/groups`);return r.ok?(await r.json())?.data?.groups||[]:null}catch(r){return console.error("Error fetching groups:",r),[]}}async function fetchFromQueryBuilder(e,r){try{const t=await fetch(`${e}/querybuilder/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return t.ok?(await t.json())?.data||[]:(console.error("QueryBuilder request failed:",t.status,t.statusText),[])}catch(t){return console.error("Error fetching from QueryBuilder:",t),[]}}async function fetchLinks(e,r){if(!r)return{incoming:[],outgoing:[]};try{const[t,o]=await Promise.all([fetch(`${e}/nodes/${encodeURIComponent(r)}/links/incoming`),fetch(`${e}/nodes/${encodeURIComponent(r)}/links/outgoing`)]),c=t.ok?await t.json():[],u=o.ok?await o.json():[];return{incoming:c,outgoing:u}}catch(t){return console.error("Error fetching links:",t),{incoming:[],outgoing:[]}}}async function fetchLinkCounts(e,r=[]){if(!r.length)return r;try{return await Promise.all(r.map(async o=>{if(typeof o?.data?.parentCount=="number"&&typeof o?.data?.childCount=="number")return o;const{incoming:c,outgoing:u}=await fetchLinks(e,o.id),v=(c?.data?.incoming||[]).length,f=(u?.data?.outgoing||[]).length;return{...o,data:{...o.data,parentCount:v,childCount:f}}}))}catch(t){return console.error("Error fetching next level nodes:",t),r}}async function smartFetchData(e,r,t={}){const o=t[r.id];if(o)return console.log(`${r.id} data is already cached`),console.log("node",r),{...r,data:{...r.data,...o}};let c={...r.data};const u={StructureData:fetchCif,CifData:fetchCif,BandsData:fetchJson,ArrayData:fetchJson,UpfData:fetchJson},v={FolderData:fetchNodeRepoList,RemoteData:fetchNodeRepoList,BandsData:fetchNodeRepoList,ArrayData:fetchNodeRepoList},f=await fetchNodeContents(e,r.id);c={...c,...f};const g=u[r.data.label]?u[r.data.label](e,r.id):null,_=v[r.data.label]?v[r.data.label](e,r.id):null;let p=null;r.data.label==="CalcJobNode"&&(p=(async()=>{let z=c.retrievedUUID;z||(z=await fetchRetrievedUUID(e,r.id));const l=await fetchFiles(e,r.id,z);return{retrievedUUID:z,files:l}})());const[E,k,A]=await Promise.all([g,_,p]);return E&&(c.download=E),k&&(c.repo_list=k),A&&(c={...c,...A}),console.log(`Fetched data for node ${r.id}`),console.log(c),{...r,data:c}}async function fetchGraphByNodeId(e,r){const o=(await fetchNodeById(e,r)).data.nodes[0];if(!o)return{nodes:[],edges:[]};const{incoming:c,outgoing:u}=await fetchLinks(e,r),v=c?.data?.incoming||[],f=u?.data?.outgoing||[],g=[{id:o.uuid,data:{label:o.node_type.split(".").filter(Boolean).pop(),node_type:o.node_type,pos:0,aiida:o}},...v.map(E=>({id:E.uuid,data:{label:E.node_type.split(".").filter(Boolean).pop(),node_type:E.node_type,pos:1,link_label:E.link_label,aiida:E}})),...f.map(E=>({id:E.uuid,data:{label:E.node_type.split(".").filter(Boolean).pop(),node_type:E.node_type,pos:-1,link_label:E.link_label,aiida:E}}))],{nodes:_,edges:p}=layoutGraphDefault(g.find(E=>E.data.pos===0),g.filter(E=>E.data.pos===1),g.filter(E=>E.data.pos===-1));return{nodes:_,edges:p}}const columnLabels$1={uuid:"Unique ID",full_type:"Type",ctime:"Created",mtime:"Modified",id:"ID"},columnOrder$1=["Unique ID","Type","Created","Modified",""];function formatValue$1(e,r){switch(e){case"Type":return typeof r!="string"?r:r.replace(/\|$/,"").split(".").at(-1)||r;case"Created":case"Modified":return r?new Date(r).toLocaleString():"";default:return r}}function formatTableData$1(e){return e.map(r=>{const t={};return columnOrder$1.forEach(o=>{const c=Object.keys(columnLabels$1).find(u=>columnLabels$1[u]===o);c&&r[c]!==void 0&&(t[o]=formatValue$1(o,r[c]))}),t[""]=jsxRuntimeExports$1.jsx("a",{href:`?rootNode=${r.uuid}`,className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 transition",children:"View"}),t})}function GridViewer({baseUrl:e=""}){const[r,t]=reactExports.useState([]),[o,c]=reactExports.useState([]),[u,v]=reactExports.useState([]),[f,g]=reactExports.useState(null),[_,p]=reactExports.useState({});reactExports.useEffect(()=>{if(!e)return;async function z(){try{const l=await fetchAPIFullTypes(e);if(!l)return;t(l)}catch(l){console.error("Failed to fetch tree data",l)}}z()},[e]);const E=z=>{p(l=>({...l,[z]:!l[z]}))},k=reactExports.useCallback(async z=>{console.log("Selected node:",z),g(z);try{const l=`${e}/nodes/page/1?perpage=10&full_type="${z.full_type}"&orderby=-ctime`,s=await fetch(l);if(!s.ok)throw new Error("Failed to fetch node data");const w=(await s.json()).data.nodes||[];v(w),console.log("raw TD",w),c(formatTableData$1(w))}catch(l){console.error("Error fetching node data:",l)}},[e]),A=[...columnOrder$1];return jsxRuntimeExports$1.jsxs("div",{className:"flex gap-4 mt-2 ml-2 overflow-auto",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex-shrink-0",children:[jsxRuntimeExports$1.jsx("h3",{className:"pb-2 px-2",children:"AiiDA node datatypes:"}),r?.data?.subspaces?.map(z=>jsxRuntimeExports$1.jsx(TreeDropdown,{data:z,onSelect:k,openNodes:_,toggleNode:E},z.full_type))]}),jsxRuntimeExports$1.jsx("div",{className:"flex-1",children:o.length>0&&f&&jsxRuntimeExports$1.jsx(DataTable,{title:`All nodes with datatype ${f.full_type.split(".").slice(-2)[0]}:`,columns:A,data:o,sortableCols:["Unique ID","Type","Created","Modified"]})})]})}const columnLabels={uuid:"Unique ID",label:"Label",full_type:"Type",ctime:"Created",mtime:"Modified",id:"ID"},columnOrder=["Unique ID","Label","Type","Created","Modified",""];function formatValue(e,r){switch(e){case"Type":return typeof r!="string"?r:r.replace(/\|$/,"").split(".").at(-1)||r;case"Created":case"Modified":return r?new Date(r).toLocaleString():"";default:return r}}function formatTableData(e){return e.map(r=>{const t={};return columnOrder.forEach(o=>{const c=Object.keys(columnLabels).find(u=>columnLabels[u]===o);c&&r[c]!==void 0&&(t[o]=formatValue(o,r[c]))}),t[""]=jsxRuntimeExports$1.jsx("a",{href:`?rootNode=${r.uuid}`,className:"px-2 py-1 rounded bg-indigo-600 text-white hover:bg-indigo-700 transition",children:"View"}),t})}function buildQuery({groups:e=[],nodeTypes:r=[],limit:t=50,offset:o=0}={}){const c=[{entity_type:"",orm_base:"node",tag:"node",joining_keyword:null,joining_value:null,edge_tag:null,outerjoin:!1}],u={node:{}},v={node:["id","uuid","node_type","label","ctime","mtime"]};if(r.length===1?u.node.node_type={like:r[0]}:r.length>1&&(u.node={or:r.map(f=>({node_type:{like:f}}))}),e.length>0){const f="core_1",g="node--core_1";c.push({entity_type:"group.core",orm_base:"group",tag:f,joining_keyword:"with_node",joining_value:"node",edge_tag:g,outerjoin:!1}),u[f]={type_string:{like:"%"},or:e.map(_=>({label:_}))},u[g]={},v[f]=[],v[g]=[]}return{path:c,filters:u,project:v,project_map:{},order_by:[],limit:t,offset:o,distinct:!0}}function GroupIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"M15.536 11.293a1 1 0 0 0 0 1.414l2.376 2.377a1 1 0 0 0 1.414 0l2.377-2.377a1 1 0 0 0 0-1.414l-2.377-2.377a1 1 0 0 0-1.414 0z"}),jsxRuntimeExports$1.jsx("path",{d:"M2.297 11.293a1 1 0 0 0 0 1.414l2.377 2.377a1 1 0 0 0 1.414 0l2.377-2.377a1 1 0 0 0 0-1.414L6.088 8.916a1 1 0 0 0-1.414 0z"}),jsxRuntimeExports$1.jsx("path",{d:"M8.916 17.912a1 1 0 0 0 0 1.415l2.377 2.376a1 1 0 0 0 1.414 0l2.377-2.376a1 1 0 0 0 0-1.415l-2.377-2.376a1 1 0 0 0-1.414 0z"}),jsxRuntimeExports$1.jsx("path",{d:"M8.916 4.674a1 1 0 0 0 0 1.414l2.377 2.376a1 1 0 0 0 1.414 0l2.377-2.376a1 1 0 0 0 0-1.414l-2.377-2.377a1 1 0 0 0-1.414 0z"})]})}function XIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"M18 6 6 18"}),jsxRuntimeExports$1.jsx("path",{d:"m6 6 12 12"})]})}function DownloadIcon({data:e=null,downloadUrl:r=null,filename:t="data.json",size:o=14,className:c=""}){const u=()=>{if(r){const v=document.createElement("a");v.href=r,v.download=t,v.target="_blank",v.rel="noopener noreferrer",v.click();return}if(e){const v=JSON.stringify(e,null,2),f=new Blob([v],{type:"application/json"}),g=URL.createObjectURL(f),_=document.createElement("a");_.href=g,_.download=t,_.click(),URL.revokeObjectURL(g)}};return jsxRuntimeExports$1.jsx("button",{type:"button",onClick:u,title:"Download",className:"p-1 hover:text-blue-600",children:jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:o,height:o,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:c,children:[jsxRuntimeExports$1.jsx("path",{d:"M12 15V3"}),jsxRuntimeExports$1.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),jsxRuntimeExports$1.jsx("path",{d:"m7 10 5 5 5-5"})]})})}function ClipBoardIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),jsxRuntimeExports$1.jsx("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})]})}function ClipboardCopyIcon({size:e=18,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"m12 15 2 2 4-4"}),jsxRuntimeExports$1.jsx("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),jsxRuntimeExports$1.jsx("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})]})}function RightDropDownIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:jsxRuntimeExports$1.jsx("path",{d:"m9 18 6-6-6-6"})})}function DownDropDownIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:jsxRuntimeExports$1.jsx("path",{d:"m6 9 6 6 6-6"})})}function ViewIcon({size:e=14,className:r=""}){return jsxRuntimeExports$1.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:r,children:[jsxRuntimeExports$1.jsx("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}),jsxRuntimeExports$1.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}const aiidaTypes=[{label:"Data",type:"data",children:[{label:"Int",type:"data.core.int.%"},{label:"Float",type:"data.core.float.%"},{label:"ArrayData",type:"data.core.array.%",children:[{label:"ArrayData",type:"data.core.array.%"},{label:"BandsData",type:"data.core.array.bands.%"},{label:"XyData",type:"data.core.array.xy.%"},{label:"TrajectoryData",type:"data.core.array.trajectory.%"},{label:"KpointsData",type:"data.core.array.kpoints.%"}]},{label:"Str",type:"data.core.str.%"},{label:"Bool",type:"data.core.bool.%"},{label:"List",type:"data.core.list.%"},{label:"Dict",type:"data.core.dict.%"},{label:"StructureData",type:"data.core.structure.%"},{label:"RemoteData",type:"data.core.remote.%"},{label:"FolderData",type:"data.core.folder.%"},{label:"SinglefileData",type:"data.core.singlefile.%"},{label:"UpfData",type:"data.core.upf.%"},{label:"Code",type:"data.core.code.%"}]},{label:"Process",type:"process.%",children:[{label:"CalcJob",type:"process.calculation.calcjob.%"},{label:"CalcFunction",type:"process.calculation.calcjob.%"},{label:"WorkFunction",type:"process.workflow.workfunction.%"},{label:"Workgraph",type:"process.workflow.workgraph.%"},{label:"Workchain",type:"process.workflow.workgraph.%"}]}];function getFlattenedNodeTypes(e,r){const t=[],o=c=>{c.forEach(u=>{e.includes(u.label)&&t.push(u.type),u.children&&o(u.children)})};return o(r),t}function TypeCheckboxTree({types:e,selectedTypes:r,setSelectedTypes:t,level:o=0}){const[c,u]=reactExports.useState({}),v=_=>_.every(p=>r.includes(p.label)),f=_=>_.some(p=>r.includes(p.label))&&!v(_),g=(_,p)=>{if(!p||p.length===0){t(k=>k.includes(_)?k.filter(A=>A!==_):[...k,_]);return}t(k=>{const A=new Set(k),z=(s,y)=>{s.forEach(w=>{y?A.add(w.label):A.delete(w.label),w.children&&z(w.children,y)})};return A.has(_)&&v(p)?(A.delete(_),z(p,!1)):(A.add(_),z(p,!0)),[...A]});const E=k=>{const A={};return k.forEach(z=>{z.children&&(A[z.label]=!0,Object.assign(A,E(z.children)))}),A};u(k=>({...k,[_]:!0,...E(p)}))};return jsxRuntimeExports$1.jsx("div",{className:"flex flex-col",children:e.map(({label:_,children:p})=>{const E=r.includes(_),k=p&&f(p);return jsxRuntimeExports$1.jsxs("div",{style:{marginLeft:`${o*8}px`},children:[jsxRuntimeExports$1.jsxs("div",{className:"flex items-center gap-1 cursor-pointer",onClick:()=>g(_,p),children:[jsxRuntimeExports$1.jsx("input",{type:"checkbox",checked:E,ref:A=>{A&&(A.indeterminate=k)},onChange:A=>A.stopPropagation()}),p&&p.length>0&&jsxRuntimeExports$1.jsx("button",{type:"button",onClick:A=>{A.stopPropagation(),u(z=>({...z,[_]:!z[_]}))},className:"p-0.5 focus:outline-none",children:c[_]?jsxRuntimeExports$1.jsx(DownDropDownIcon,{size:14}):jsxRuntimeExports$1.jsx(RightDropDownIcon,{size:14})}),jsxRuntimeExports$1.jsx("span",{children:_})]}),p&&p.length>0&&c[_]&&jsxRuntimeExports$1.jsx(TypeCheckboxTree,{types:p,selectedTypes:r,setSelectedTypes:t,level:o+1})]},_)})})}function sortGroups(e){return[...e].sort((r,t)=>{const o=/^\d/.test(r.label),c=/^\d/.test(t.label);return o&&!c?1:!o&&c?-1:r.label.localeCompare(t.label,void 0,{numeric:!0})})}function GroupsViewer2({baseUrl:e=""}){const[r,t]=reactExports.useState([]),[o,c]=reactExports.useState([]),[u,v]=reactExports.useState([]),[f,g]=reactExports.useState([]),[_,p]=reactExports.useState(0),E=200;reactExports.useEffect(()=>{fetchGroups(e).then(t)},[e]),reactExports.useEffect(()=>{r.length>0&&f.length===0&&k(0,1e3)},[r,f.length]);const k=async(A=0,z=E)=>{try{const l=getFlattenedNodeTypes(u,aiidaTypes),s=buildQuery({groups:o,nodeTypes:l,limit:z,offset:A}),w=(await fetchFromQueryBuilder(e,s)).node||[];g(S=>A===0?formatTableData(w):[...S,...formatTableData(w)]),p(A+w.length)}catch(l){console.error("Failed to fetch nodes:",l)}};return jsxRuntimeExports$1.jsxs("div",{className:"flex gap-4 p-3 overflow-auto w-full items-start",children:[jsxRuntimeExports$1.jsxs("div",{className:"min-w-[250px] max-w-[400px] flex-shrink-0 bg-slate-50 p-2 px-4 rounded",children:[jsxRuntimeExports$1.jsx("h4",{className:"font-medium mt-4 mb-2",children:"Filter by Node Types"}),jsxRuntimeExports$1.jsx(TypeCheckboxTree,{types:aiidaTypes,selectedTypes:u,setSelectedTypes:v}),jsxRuntimeExports$1.jsx("h4",{className:"font-medium my-2 mt-4",children:"Filter by Defined Groups"}),sortGroups(r).map(A=>jsxRuntimeExports$1.jsxs("label",{className:"flex items-start gap-2 mb-1",children:[jsxRuntimeExports$1.jsx("input",{type:"checkbox",className:"mt-1",checked:o.includes(A.label),onChange:z=>c(l=>z.target.checked?[...l,A.label]:l.filter(s=>s!==A.label))}),jsxRuntimeExports$1.jsx("span",{className:"truncate block",title:A.label,children:A.label})]},A.label)),jsxRuntimeExports$1.jsx("button",{onClick:()=>k(0),className:"px-3 py-1 my-2 ml-2 rounded bg-indigo-700 text-white hover:bg-indigo-800 transition",children:"Apply"})]}),jsxRuntimeExports$1.jsxs("div",{className:"flex-1 bg-white p-2 rounded",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex gap-4",children:[jsxRuntimeExports$1.jsxs("h4",{className:"text-xl font-semibold",children:[f.length," nodes loaded"]}),f.length>0&&jsxRuntimeExports$1.jsx("button",{onClick:()=>k(_),className:"px-3 py-1 mr-10 rounded bg-gray-700 text-white hover:bg-gray-800 transition",children:"Load next 200"})]}),jsxRuntimeExports$1.jsx(DataTable,{columns:columnOrder,data:f||[],sortableCols:["Unique ID","Label","Type","Created","Modified"],renderIfMissing:!0})]})]})}function omitGraphKeys(e){const r=["label","node_type","pos","link_label"];return e==null||typeof e!="object"?e:Array.isArray(e)?e.map(t=>omitGraphKeys(t)):Object.fromEntries(Object.entries(e).filter(([t])=>!r.includes(t)).map(([t,o])=>[t,omitGraphKeys(o)]))}function KpointsDataVisualiser({nodeData:e={}}){e.download;const r=e.attributes||{},t=e.derivedProperties||{};if(!r&&!t)return jsxRuntimeExports$1.jsx("div",{children:"No attributes available"});const o=["x","y","z"],c=(r.cell||[]).map(A=>({x:A[0],y:A[1],z:A[2]})),u=["dimension","value"],v=(r.mesh||[]).map((A,z)=>({dimension:z+1,value:A})),f=["i","x","y","z"],g=(r.offset||[]).map((A,z)=>({i:z+1,x:A[0]??A,y:A[1]??0,z:A[2]??0})),_=["axis","periodic"],p=["pbc1","pbc2","pbc3"].filter(A=>A in r).map(A=>({axis:A,periodic:r[A]?"True":"False"})),E=["K-point number","x","y","z"],k=(t.explicit_kpoints_abs||[]).map((A,z)=>({"K-point number":z+1,x:A[0],y:A[1],z:A[2]}));return jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4 space-y-6 overflow-y-auto",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports$1.jsx("h3",{className:"text-2xl",children:"Kpoints Data"}),jsxRuntimeExports$1.jsx(DownloadIcon,{data:omitGraphKeys(e),filename:`${e.aiida.uuid}_KpointNodeDetails.json`,size:22,className:"pb-0.5"})]}),jsxRuntimeExports$1.jsx(DataTable,{title:"Cell",columns:o,data:c,sortableCols:!1},"cell"),jsxRuntimeExports$1.jsx(DataTable,{title:"Mesh",columns:u,data:v,sortableCols:!1},"mesh"),jsxRuntimeExports$1.jsx(DataTable,{title:"Offset",columns:f,data:g,sortableCols:!1},"offset"),jsxRuntimeExports$1.jsx(DataTable,{title:"PBC Flags",columns:_,data:p,sortableCols:!1},"pbc"),jsxRuntimeExports$1.jsx(DataTable,{title:"Explicit K-points (Absolute)",columns:E,data:k,sortableCols:!1},"kpoints")]})}function FolderDataVisualiser({nodeData:e}){const t=(e?.repo_list?.data?.repo_list??[]).map(o=>({Files:o.name}));return jsxRuntimeExports$1.jsx("div",{className:"w-full h-full p-4 space-y-6 overflow-y-auto",children:jsxRuntimeExports$1.jsx(DataTable,{title:"Folder Files",columns:["Files"],data:t,sortableCols:!1})})}function CalcJobVisualiser({nodeData:e={}}){const r=e.files||{},t=Array.isArray(r.input_files)?r.input_files:[],o=Array.isArray(r.output_files)?r.output_files:[],[c,u]=reactExports.useState(null),[v,f]=reactExports.useState(null),[g,_]=reactExports.useState(!1),p=async l=>{try{const y=await(await fetch(l.downloadUrl)).text();u(y),f(l.name),_(!0)}catch(s){console.error("Error loading preview:",s),u("Failed to load file."),_(!0)}},E=["Files","Download","View"],k=t.map(l=>({Files:l.name,Download:jsxRuntimeExports$1.jsx("a",{href:l.downloadUrl||"#",download:l.name||void 0,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 transition-colors",children:jsxRuntimeExports$1.jsx(DownloadIcon,{size:18})}),View:jsxRuntimeExports$1.jsx("button",{type:"button",onClick:()=>p(l),className:"text-green-600 hover:text-green-800 transition-colors",children:jsxRuntimeExports$1.jsx(ViewIcon,{size:18})})})),A=["Files","Download","View"],z=o.map(l=>({Files:l.name,Download:jsxRuntimeExports$1.jsx("a",{href:l.downloadUrl||"#",download:l.name||void 0,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 transition-colors",children:jsxRuntimeExports$1.jsx(DownloadIcon,{size:18})}),View:jsxRuntimeExports$1.jsx("button",{type:"button",onClick:()=>p(l),className:"text-green-600 hover:text-green-800 transition-colors",children:jsxRuntimeExports$1.jsx(ViewIcon,{size:18})})}));return jsxRuntimeExports$1.jsxs(jsxRuntimeExports$1.Fragment,{children:[jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4 space-y-6 overflow-y-auto",children:[k.length>0&&jsxRuntimeExports$1.jsx(DataTable,{title:"Input Files (in this node)",columns:E,data:k,sortableCols:["Files"]}),z.length>0&&jsxRuntimeExports$1.jsx(DataTable,{title:"Output Files (retrieved)",columns:A,data:z,sortableCols:["Files"]}),k.length===0&&z.length===0&&jsxRuntimeExports$1.jsx("div",{children:"No files available"})]}),g&&ReactDOM.createPortal(jsxRuntimeExports$1.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999]",onClick:()=>_(!1),children:jsxRuntimeExports$1.jsxs("div",{className:`bg-white p-4 rounded-xl shadow-lg w-[600px] max-h-[80vh] flex flex-col 
                         transform transition-all duration-200 ease-out animate-fadeIn`,onClick:l=>l.stopPropagation(),children:[jsxRuntimeExports$1.jsxs("div",{className:"flex justify-between items-center border-b pb-2 mb-2",children:[jsxRuntimeExports$1.jsxs("h2",{className:"text-lg font-semibold",children:["Preview: ",v||"File"]}),jsxRuntimeExports$1.jsx("button",{onClick:()=>_(!1),className:"text-gray-600 hover:text-black",children:"✕"})]}),jsxRuntimeExports$1.jsx("pre",{className:"overflow-y-auto whitespace-pre-wrap text-sm flex-1",children:c})]})}),document.body)]})}function UpfDataVisualiser({nodeData:e={},baseUrl:r=""}){const t=e.aiida.uuid,o=e.download,c=e.attributes,u=v=>!v||typeof v!="object"?[]:Object.entries(v).map(([f,g])=>({Key:f,Value:g==null?"—":typeof g=="object"?JSON.stringify(g,null,2):String(g)}));return jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4 space-y-6 overflow-y-auto",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports$1.jsx("h3",{className:"text-2xl",children:"UpfData Node"}),jsxRuntimeExports$1.jsx(DownloadIcon,{downloadUrl:`${r}/nodes/${t}/download?download_format=upf`,filename:`${o.pseudo_potential.header.original_upf_file}`,size:22,className:"pb-0.5"})]}),jsxRuntimeExports$1.jsx(DataTable,{title:"Attributes",columns:["Key","Value"],data:u(c)},"attributes")]})}const isBoolean=e=>typeof e=="boolean"||e instanceof Boolean,isNumber=e=>typeof e=="number"||e instanceof Number,isBigInt=e=>typeof e=="bigint"||e instanceof BigInt,isDate=e=>!!e&&e instanceof Date,isString=e=>typeof e=="string"||e instanceof String,isArray=e=>Array.isArray(e),isObject=e=>typeof e=="object"&&e!==null,isFunction=e=>!!e&&e instanceof Object&&typeof e=="function";function quoteString(e,r){return r===void 0&&(r=!1),!e||r?`"${e}"`:e}function quoteStringValue(e,r,t){return t?JSON.stringify(e):r?`"${e}"`:e}function ExpandableObject(e){let{field:r,value:t,data:o,lastElement:c,openBracket:u,closeBracket:v,level:f,style:g,shouldExpandNode:_,clickToExpandNode:p,outerRef:E,beforeExpandChange:k}=e;const A=reactExports.useRef(!1),[z,l]=reactExports.useState(()=>_(f,t,r)),s=reactExports.useRef(null);reactExports.useEffect(()=>{A.current?l(_(f,t,r)):A.current=!0},[_]);const y=reactExports.useId();if(o.length===0)return EmptyObject({field:r,openBracket:u,closeBracket:v,lastElement:c,style:g});const w=z?g.collapseIcon:g.expandIcon,S=z?g.ariaLables.collapseJson:g.ariaLables.expandJson,C=f+1,h=o.length-1,x=P=>{z!==P&&(!k||k({level:f,value:t,field:r,newExpandValue:P}))&&l(P)},R=P=>{if(P.key==="ArrowRight"||P.key==="ArrowLeft")P.preventDefault(),x(P.key==="ArrowRight");else if(P.key==="ArrowUp"||P.key==="ArrowDown"){P.preventDefault();const D=P.key==="ArrowUp"?-1:1;if(!E.current)return;const L=E.current.querySelectorAll("[role=button]");let X=-1;for(let j=0;j<L.length;j++)if(L[j].tabIndex===0){X=j;break}if(X<0)return;const B=(X+D+L.length)%L.length;L[X].tabIndex=-1,L[B].tabIndex=0,L[B].focus()}},M=()=>{var P;x(!z);const D=s.current;if(!D)return;const L=(P=E.current)===null||P===void 0?void 0:P.querySelector('[role=button][tabindex="0"]');L&&(L.tabIndex=-1),D.tabIndex=0,D.focus()};return reactExports.createElement("div",{className:g.basicChildStyle,role:"treeitem","aria-expanded":z,"aria-selected":void 0},reactExports.createElement("span",{className:w,onClick:M,onKeyDown:R,role:"button","aria-label":S,"aria-expanded":z,"aria-controls":z?y:void 0,ref:s,tabIndex:f===0?0:-1}),(r||r==="")&&(p?reactExports.createElement("span",{className:g.clickableLabel,onClick:M,onKeyDown:R},quoteString(r,g.quotesForFieldNames),":"):reactExports.createElement("span",{className:g.label},quoteString(r,g.quotesForFieldNames),":")),reactExports.createElement("span",{className:g.punctuation},u),z?reactExports.createElement("ul",{id:y,role:"group",className:g.childFieldsContainer},o.map((P,D)=>reactExports.createElement(DataRender,{key:P[0]||D,field:P[0],value:P[1],style:g,lastElement:D===h,level:C,shouldExpandNode:_,clickToExpandNode:p,beforeExpandChange:k,outerRef:E}))):reactExports.createElement("span",{className:g.collapsedContent,onClick:M,onKeyDown:R}),reactExports.createElement("span",{className:g.punctuation},v),!c&&reactExports.createElement("span",{className:g.punctuation},","))}function EmptyObject(e){let{field:r,openBracket:t,closeBracket:o,lastElement:c,style:u}=e;return reactExports.createElement("div",{className:u.basicChildStyle,role:"treeitem","aria-selected":void 0},(r||r==="")&&reactExports.createElement("span",{className:u.label},quoteString(r,u.quotesForFieldNames),":"),reactExports.createElement("span",{className:u.punctuation},t),reactExports.createElement("span",{className:u.punctuation},o),!c&&reactExports.createElement("span",{className:u.punctuation},","))}function JsonObject(e){let{field:r,value:t,style:o,lastElement:c,shouldExpandNode:u,clickToExpandNode:v,level:f,outerRef:g,beforeExpandChange:_}=e;return ExpandableObject({field:r,value:t,lastElement:c||!1,level:f,openBracket:"{",closeBracket:"}",style:o,shouldExpandNode:u,clickToExpandNode:v,data:Object.keys(t).map(p=>[p,t[p]]),outerRef:g,beforeExpandChange:_})}function JsonArray(e){let{field:r,value:t,style:o,lastElement:c,level:u,shouldExpandNode:v,clickToExpandNode:f,outerRef:g,beforeExpandChange:_}=e;return ExpandableObject({field:r,value:t,lastElement:c||!1,level:u,openBracket:"[",closeBracket:"]",style:o,shouldExpandNode:v,clickToExpandNode:f,data:t.map(p=>[void 0,p]),outerRef:g,beforeExpandChange:_})}function JsonPrimitiveValue(e){let{field:r,value:t,style:o,lastElement:c}=e,u,v=o.otherValue;return t===null?(u="null",v=o.nullValue):t===void 0?(u="undefined",v=o.undefinedValue):isString(t)?(u=quoteStringValue(t,!o.noQuotesForStringValues,o.stringifyStringValues),v=o.stringValue):isBoolean(t)?(u=t?"true":"false",v=o.booleanValue):isNumber(t)?(u=t.toString(),v=o.numberValue):isBigInt(t)?(u=`${t.toString()}n`,v=o.numberValue):isDate(t)?u=t.toISOString():isFunction(t)?u="function() { }":u=t.toString(),reactExports.createElement("div",{className:o.basicChildStyle,role:"treeitem","aria-selected":void 0},(r||r==="")&&reactExports.createElement("span",{className:o.label},quoteString(r,o.quotesForFieldNames),":"),reactExports.createElement("span",{className:v},u),!c&&reactExports.createElement("span",{className:o.punctuation},","))}function DataRender(e){const r=e.value;return isArray(r)?reactExports.createElement(JsonArray,Object.assign({},e)):isObject(r)&&!isDate(r)&&!isFunction(r)?reactExports.createElement(JsonObject,Object.assign({},e)):reactExports.createElement(JsonPrimitiveValue,Object.assign({},e))}var styles={"container-light":"_2IvMF _GzYRV","basic-element-style":"_2bkNM","child-fields-container":"_1BXBN","label-light":"_1MGIk","clickable-label-light":"_2YKJg _1MGIk _1MFti","punctuation-light":"_3uHL6 _3eOF8","value-null-light":"_2T6PJ","value-undefined-light":"_1Gho6","value-string-light":"_vGjyY","value-number-light":"_1bQdo","value-boolean-light":"_3zQKs","value-other-light":"_1xvuR","collapse-icon-light":"_oLqym _f10Tu _1MFti _1LId0","expand-icon-light":"_2AXVT _f10Tu _1MFti _1UmXx","collapsed-content-light":"_2KJWg _1pNG9 _1MFti"};const defaultAriaLables={collapseJson:"collapse JSON",expandJson:"expand JSON"},defaultStyles={container:styles["container-light"],basicChildStyle:styles["basic-element-style"],childFieldsContainer:styles["child-fields-container"],label:styles["label-light"],clickableLabel:styles["clickable-label-light"],nullValue:styles["value-null-light"],undefinedValue:styles["value-undefined-light"],stringValue:styles["value-string-light"],booleanValue:styles["value-boolean-light"],numberValue:styles["value-number-light"],otherValue:styles["value-other-light"],punctuation:styles["punctuation-light"],collapseIcon:styles["collapse-icon-light"],expandIcon:styles["expand-icon-light"],collapsedContent:styles["collapsed-content-light"],noQuotesForStringValues:!1,quotesForFieldNames:!1,ariaLables:defaultAriaLables,stringifyStringValues:!1},allExpanded=()=>!0,JsonView=e=>{let{data:r,style:t=defaultStyles,shouldExpandNode:o=allExpanded,clickToExpandNode:c=!1,beforeExpandChange:u,compactTopLevel:v,...f}=e;const g=reactExports.useRef(null);return reactExports.createElement("div",Object.assign({"aria-label":"JSON view"},f,{className:t.container,ref:g,role:"tree"}),v&&isObject(r)?Object.entries(r).map(_=>{let[p,E]=_;return reactExports.createElement(DataRender,{key:p,field:p,value:E,style:{...defaultStyles,...t},lastElement:!0,level:1,shouldExpandNode:o,clickToExpandNode:c,beforeExpandChange:u,outerRef:g})}):reactExports.createElement(DataRender,{value:r,style:{...defaultStyles,...t},lastElement:!0,level:0,shouldExpandNode:o,clickToExpandNode:c,outerRef:g,beforeExpandChange:u}))};function RawDataVisualiser({nodeData:e={}}){const r=[{title:"Attributes",data:e.attributes},{title:"Download",data:e.download},{title:"Derived Properties",data:e.derived_properties},{title:"Repository List",data:e.repo_list},{title:"Files",data:e.files},{title:"Extras",data:e.extras},{title:"Full AIIDA Metadata",data:e.aiida,collapseLevel:0}],[t,o]=reactExports.useState(null),c=(u,v)=>{navigator.clipboard.writeText(JSON.stringify(u,null,2)),o(v),setTimeout(()=>o(null),700)};return jsxRuntimeExports$1.jsx("div",{className:"flex flex-col gap-4 p-4",children:r.map((u,v)=>{const f=u.data||{};return Object.keys(f).length===0?null:jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports$1.jsx("h3",{className:"text-lg font-semibold",children:u.title}),jsxRuntimeExports$1.jsxs("button",{className:"relative flex items-center gap-1 hover:text-blue-500",onClick:()=>c(f,v),children:[jsxRuntimeExports$1.jsx(ClipBoardIcon,{size:22}),jsxRuntimeExports$1.jsxs("div",{className:`absolute left-full ml-2 top-1/2 -translate-y-1/2 flex items-center gap-1 text-green-400 text-sm transition-all duration-400 transform ${t===v?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:[jsxRuntimeExports$1.jsx(ClipboardCopyIcon,{size:16}),jsxRuntimeExports$1.jsx("span",{children:"Copied"})]})]})]}),jsxRuntimeExports$1.jsx("div",{className:"max-h-96 overflow-auto border border-gray-200 rounded p-2 bg-gray-50",children:jsxRuntimeExports$1.jsx(JsonView,{data:f,shouldExpandNode:g=>g<(u.collapseLevel??1)})})]},v)})})}function cn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ve={exports:{}},ae={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sn;function ri(){if(Sn)return ae;Sn=1;var e=React,r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function v(f,g,_){var p,E={},k=null,A=null;_!==void 0&&(k=""+_),g.key!==void 0&&(k=""+g.key),g.ref!==void 0&&(A=g.ref);for(p in g)o.call(g,p)&&!u.hasOwnProperty(p)&&(E[p]=g[p]);if(f&&f.defaultProps)for(p in g=f.defaultProps,g)E[p]===void 0&&(E[p]=g[p]);return{$$typeof:r,type:f,key:k,ref:A,props:E,_owner:c.current}}return ae.Fragment=t,ae.jsx=v,ae.jsxs=v,ae}Ve.exports=ri();var T=Ve.exports;function We(e,r){if(e.contains)return e.contains(r);if(e.compareDocumentPosition)return e===r||!!(e.compareDocumentPosition(r)&16)}var Je={exports:{}},ze,Mn;function un(){if(Mn)return ze;Mn=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ze=e,ze}var He,Nn;function _i(){if(Nn)return He;Nn=1;var e=un();function r(){}function t(){}return t.resetWarningCache=r,He=function(){function o(v,f,g,_,p,E){if(E!==e){var k=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw k.name="Invariant Violation",k}}o.isRequired=o;function c(){return o}var u={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:c,element:o,elementType:o,instanceOf:c,node:o,objectOf:c,oneOf:c,oneOfType:c,shape:c,exact:c,checkPropTypes:t,resetWarningCache:r};return u.PropTypes=u,u},He}Je.exports=_i()();var yi=Je.exports;const N=cn(yi);function ur(){const e=reactExports.useRef(!0),r=reactExports.useRef(()=>e.current);return reactExports.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),r.current}function bi(e){const r=reactExports.useRef(e);return r.current=e,r}function Pi(e){const r=bi(e);reactExports.useEffect(()=>()=>r.current(),[])}const Ge=2**31-1;function lr(e,r,t){const o=t-Date.now();e.current=o<=Ge?setTimeout(r,o):setTimeout(()=>lr(e,r,t),Ge)}function wi(){const e=ur(),r=reactExports.useRef();return Pi(()=>clearTimeout(r.current)),reactExports.useMemo(()=>{const t=()=>clearTimeout(r.current);function o(c,u=0){e()&&(t(),u<=Ge?r.current=setTimeout(c,u):lr(r,c,Date.now()+u))}return{set:o,clear:t,handleRef:r}},[])}var fr=function(){},Ai=fr;const dr=cn(Ai);function Oi(e,r){if(e==null)return{};var t={},o=Object.keys(e),c,u;for(u=0;u<o.length;u++)c=o[u],!(r.indexOf(c)>=0)&&(t[c]=e[c]);return t}function Ri(e,r,t){var o=reactExports.useRef(e!==void 0),c=reactExports.useState(r),u=c[0],v=c[1],f=e!==void 0,g=o.current;return o.current=f,!f&&g&&u!==r&&v(r),[f?e:u,reactExports.useCallback(function(_){for(var p=arguments.length,E=new Array(p>1?p-1:0),k=1;k<p;k++)E[k-1]=arguments[k];t&&t.apply(void 0,[_].concat(E)),v(_)},[t])]}function qe(e,r){return qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,o){return t.__proto__=o,t},qe(e,r)}function Ci$1(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,qe(e,r)}const Zn=e=>!e||typeof e=="function"?e:r=>{e.current=r};function Ti(e,r){const t=Zn(e),o=Zn(r);return c=>{t&&t(c),o&&o(c)}}function ne(e,r){return reactExports.useMemo(()=>Ti(e,r),[e,r])}var pr={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var r={}.hasOwnProperty;function t(){for(var u="",v=0;v<arguments.length;v++){var f=arguments[v];f&&(u=c(u,o(f)))}return u}function o(u){if(typeof u=="string"||typeof u=="number")return u;if(typeof u!="object")return"";if(Array.isArray(u))return t.apply(null,u);if(u.toString!==Object.prototype.toString&&!u.toString.toString().includes("[native code]"))return u.toString();var v="";for(var f in u)r.call(u,f)&&u[f]&&(v=c(v,f));return v}function c(u,v){return v?u?u+" "+v:u+v:u}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(pr);var Si=pr.exports;const Ut=cn(Si);function Hn(){return reactExports.useState(null)}var Un=Object.prototype.hasOwnProperty;function Yn(e,r,t){for(t of e.keys())if(fe(t,r))return t}function fe(e,r){var t,o,c;if(e===r)return!0;if(e&&r&&(t=e.constructor)===r.constructor){if(t===Date)return e.getTime()===r.getTime();if(t===RegExp)return e.toString()===r.toString();if(t===Array){if((o=e.length)===r.length)for(;o--&&fe(e[o],r[o]););return o===-1}if(t===Set){if(e.size!==r.size)return!1;for(o of e)if(c=o,c&&typeof c=="object"&&(c=Yn(r,c),!c)||!r.has(c))return!1;return!0}if(t===Map){if(e.size!==r.size)return!1;for(o of e)if(c=o[0],c&&typeof c=="object"&&(c=Yn(r,c),!c)||!fe(o[1],r.get(c)))return!1;return!0}if(t===ArrayBuffer)e=new Uint8Array(e),r=new Uint8Array(r);else if(t===DataView){if((o=e.byteLength)===r.byteLength)for(;o--&&e.getInt8(o)===r.getInt8(o););return o===-1}if(ArrayBuffer.isView(e)){if((o=e.byteLength)===r.byteLength)for(;o--&&e[o]===r[o];);return o===-1}if(!t||typeof e=="object"){o=0;for(t in e)if(Un.call(e,t)&&++o&&!Un.call(r,t)||!(t in r)||!fe(e[t],r[t]))return!1;return Object.keys(r).length===o}}return e!==e&&r!==r}function ki(e){const r=ur();return[e[0],reactExports.useCallback(t=>{if(r())return e[1](t)},[r,e[1]])]}var dt="top",yt="bottom",bt="right",pt="left",ln="auto",he=[dt,yt,bt,pt],$t="start",ge="end",Ii="clippingParents",mr="viewport",ue="popper",ji="reference",Vn=he.reduce(function(e,r){return e.concat([r+"-"+$t,r+"-"+ge])},[]),gr=[].concat(he,[ln]).reduce(function(e,r){return e.concat([r,r+"-"+$t,r+"-"+ge])},[]),Di="beforeRead",Fi="read",Mi="afterRead",Bi="beforeMain",zi="main",Li="afterMain",Ni="beforeWrite",Zi="write",Hi="afterWrite",Ui=[Di,Fi,Mi,Bi,zi,Li,Ni,Zi,Hi];function Pt(e){return e.split("-")[0]}function gt(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var r=e.ownerDocument;return r&&r.defaultView||window}return e}function Zt(e){var r=gt(e).Element;return e instanceof r||e instanceof Element}function wt(e){var r=gt(e).HTMLElement;return e instanceof r||e instanceof HTMLElement}function fn(e){if(typeof ShadowRoot>"u")return!1;var r=gt(e).ShadowRoot;return e instanceof r||e instanceof ShadowRoot}var Nt=Math.max,Te=Math.min,Qt=Math.round;function Ke(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(r){return r.brand+"/"+r.version}).join(" "):navigator.userAgent}function _r(){return!/^((?!chrome|android).)*safari/i.test(Ke())}function Xt(e,r,t){r===void 0&&(r=!1),t===void 0&&(t=!1);var o=e.getBoundingClientRect(),c=1,u=1;r&&wt(e)&&(c=e.offsetWidth>0&&Qt(o.width)/e.offsetWidth||1,u=e.offsetHeight>0&&Qt(o.height)/e.offsetHeight||1);var v=Zt(e)?gt(e):window,f=v.visualViewport,g=!_r()&&t,_=(o.left+(g&&f?f.offsetLeft:0))/c,p=(o.top+(g&&f?f.offsetTop:0))/u,E=o.width/c,k=o.height/u;return{width:E,height:k,top:p,right:_+E,bottom:p+k,left:_,x:_,y:p}}function dn(e){var r=Xt(e),t=e.offsetWidth,o=e.offsetHeight;return Math.abs(r.width-t)<=1&&(t=r.width),Math.abs(r.height-o)<=1&&(o=r.height),{x:e.offsetLeft,y:e.offsetTop,width:t,height:o}}function vr(e,r){var t=r.getRootNode&&r.getRootNode();if(e.contains(r))return!0;if(t&&fn(t)){var o=r;do{if(o&&e.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function It(e){return e?(e.nodeName||"").toLowerCase():null}function Rt(e){return gt(e).getComputedStyle(e)}function Yi(e){return["table","td","th"].indexOf(It(e))>=0}function Dt(e){return((Zt(e)?e.ownerDocument:e.document)||window.document).documentElement}function ke(e){return It(e)==="html"?e:e.assignedSlot||e.parentNode||(fn(e)?e.host:null)||Dt(e)}function Wn(e){return!wt(e)||Rt(e).position==="fixed"?null:e.offsetParent}function Vi(e){var r=/firefox/i.test(Ke()),t=/Trident/i.test(Ke());if(t&&wt(e)){var o=Rt(e);if(o.position==="fixed")return null}var c=ke(e);for(fn(c)&&(c=c.host);wt(c)&&["html","body"].indexOf(It(c))<0;){var u=Rt(c);if(u.transform!=="none"||u.perspective!=="none"||u.contain==="paint"||["transform","perspective"].indexOf(u.willChange)!==-1||r&&u.willChange==="filter"||r&&u.filter&&u.filter!=="none")return c;c=c.parentNode}return null}function ye(e){for(var r=gt(e),t=Wn(e);t&&Yi(t)&&Rt(t).position==="static";)t=Wn(t);return t&&(It(t)==="html"||It(t)==="body"&&Rt(t).position==="static")?r:t||Vi(e)||r}function pn(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function de(e,r,t){return Nt(e,Te(r,t))}function Wi(e,r,t){var o=de(e,r,t);return o>t?t:o}function hr(){return{top:0,right:0,bottom:0,left:0}}function yr(e){return Object.assign({},hr(),e)}function br(e,r){return r.reduce(function(t,o){return t[o]=e,t},{})}var Ji=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,yr(typeof e!="number"?e:br(e,he))};function Gi(e){var r,t=e.state,o=e.name,c=e.options,u=t.elements.arrow,v=t.modifiersData.popperOffsets,f=Pt(t.placement),g=pn(f),_=[pt,bt].indexOf(f)>=0,p=_?"height":"width";if(!(!u||!v)){var E=Ji(c.padding,t),k=dn(u),A=g==="y"?dt:pt,z=g==="y"?yt:bt,l=t.rects.reference[p]+t.rects.reference[g]-v[g]-t.rects.popper[p],s=v[g]-t.rects.reference[g],y=ye(u),w=y?g==="y"?y.clientHeight||0:y.clientWidth||0:0,S=l/2-s/2,C=E[A],h=w-k[p]-E[z],x=w/2-k[p]/2+S,R=de(C,x,h),M=g;t.modifiersData[o]=(r={},r[M]=R,r.centerOffset=R-x,r)}}function qi(e){var r=e.state,t=e.options,o=t.element,c=o===void 0?"[data-popper-arrow]":o;c!=null&&(typeof c=="string"&&(c=r.elements.popper.querySelector(c),!c)||vr(r.elements.popper,c)&&(r.elements.arrow=c))}const Ki={name:"arrow",enabled:!0,phase:"main",fn:Gi,effect:qi,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function te(e){return e.split("-")[1]}var $i={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Qi(e,r){var t=e.x,o=e.y,c=r.devicePixelRatio||1;return{x:Qt(t*c)/c||0,y:Qt(o*c)/c||0}}function Jn(e){var r,t=e.popper,o=e.popperRect,c=e.placement,u=e.variation,v=e.offsets,f=e.position,g=e.gpuAcceleration,_=e.adaptive,p=e.roundOffsets,E=e.isFixed,k=v.x,A=k===void 0?0:k,z=v.y,l=z===void 0?0:z,s=typeof p=="function"?p({x:A,y:l}):{x:A,y:l};A=s.x,l=s.y;var y=v.hasOwnProperty("x"),w=v.hasOwnProperty("y"),S=pt,C=dt,h=window;if(_){var x=ye(t),R="clientHeight",M="clientWidth";if(x===gt(t)&&(x=Dt(t),Rt(x).position!=="static"&&f==="absolute"&&(R="scrollHeight",M="scrollWidth")),x=x,c===dt||(c===pt||c===bt)&&u===ge){C=yt;var P=E&&x===h&&h.visualViewport?h.visualViewport.height:x[R];l-=P-o.height,l*=g?1:-1}if(c===pt||(c===dt||c===yt)&&u===ge){S=bt;var D=E&&x===h&&h.visualViewport?h.visualViewport.width:x[M];A-=D-o.width,A*=g?1:-1}}var L=Object.assign({position:f},_&&$i),X=p===!0?Qi({x:A,y:l},gt(t)):{x:A,y:l};if(A=X.x,l=X.y,g){var B;return Object.assign({},L,(B={},B[C]=w?"0":"",B[S]=y?"0":"",B.transform=(h.devicePixelRatio||1)<=1?"translate("+A+"px, "+l+"px)":"translate3d("+A+"px, "+l+"px, 0)",B))}return Object.assign({},L,(r={},r[C]=w?l+"px":"",r[S]=y?A+"px":"",r.transform="",r))}function Xi(e){var r=e.state,t=e.options,o=t.gpuAcceleration,c=o===void 0?!0:o,u=t.adaptive,v=u===void 0?!0:u,f=t.roundOffsets,g=f===void 0?!0:f,_={placement:Pt(r.placement),variation:te(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:c,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,Jn(Object.assign({},_,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:v,roundOffsets:g})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,Jn(Object.assign({},_,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:g})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}const to={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Xi,data:{}};var Ae={passive:!0};function eo(e){var r=e.state,t=e.instance,o=e.options,c=o.scroll,u=c===void 0?!0:c,v=o.resize,f=v===void 0?!0:v,g=gt(r.elements.popper),_=[].concat(r.scrollParents.reference,r.scrollParents.popper);return u&&_.forEach(function(p){p.addEventListener("scroll",t.update,Ae)}),f&&g.addEventListener("resize",t.update,Ae),function(){u&&_.forEach(function(p){p.removeEventListener("scroll",t.update,Ae)}),f&&g.removeEventListener("resize",t.update,Ae)}}const no={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:eo,data:{}};var ro={left:"right",right:"left",bottom:"top",top:"bottom"};function Re(e){return e.replace(/left|right|bottom|top/g,function(r){return ro[r]})}var io={start:"end",end:"start"};function Gn(e){return e.replace(/start|end/g,function(r){return io[r]})}function mn(e){var r=gt(e),t=r.pageXOffset,o=r.pageYOffset;return{scrollLeft:t,scrollTop:o}}function gn(e){return Xt(Dt(e)).left+mn(e).scrollLeft}function oo(e,r){var t=gt(e),o=Dt(e),c=t.visualViewport,u=o.clientWidth,v=o.clientHeight,f=0,g=0;if(c){u=c.width,v=c.height;var _=_r();(_||!_&&r==="fixed")&&(f=c.offsetLeft,g=c.offsetTop)}return{width:u,height:v,x:f+gn(e),y:g}}function so(e){var r,t=Dt(e),o=mn(e),c=(r=e.ownerDocument)==null?void 0:r.body,u=Nt(t.scrollWidth,t.clientWidth,c?c.scrollWidth:0,c?c.clientWidth:0),v=Nt(t.scrollHeight,t.clientHeight,c?c.scrollHeight:0,c?c.clientHeight:0),f=-o.scrollLeft+gn(e),g=-o.scrollTop;return Rt(c||t).direction==="rtl"&&(f+=Nt(t.clientWidth,c?c.clientWidth:0)-u),{width:u,height:v,x:f,y:g}}function _n(e){var r=Rt(e),t=r.overflow,o=r.overflowX,c=r.overflowY;return/auto|scroll|overlay|hidden/.test(t+c+o)}function Pr(e){return["html","body","#document"].indexOf(It(e))>=0?e.ownerDocument.body:wt(e)&&_n(e)?e:Pr(ke(e))}function pe(e,r){var t;r===void 0&&(r=[]);var o=Pr(e),c=o===((t=e.ownerDocument)==null?void 0:t.body),u=gt(o),v=c?[u].concat(u.visualViewport||[],_n(o)?o:[]):o,f=r.concat(v);return c?f:f.concat(pe(ke(v)))}function $e(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function ao(e,r){var t=Xt(e,!1,r==="fixed");return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function qn(e,r,t){return r===mr?$e(oo(e,t)):Zt(r)?ao(r,t):$e(so(Dt(e)))}function co(e){var r=pe(ke(e)),t=["absolute","fixed"].indexOf(Rt(e).position)>=0,o=t&&wt(e)?ye(e):e;return Zt(o)?r.filter(function(c){return Zt(c)&&vr(c,o)&&It(c)!=="body"}):[]}function uo(e,r,t,o){var c=r==="clippingParents"?co(e):[].concat(r),u=[].concat(c,[t]),v=u[0],f=u.reduce(function(g,_){var p=qn(e,_,o);return g.top=Nt(p.top,g.top),g.right=Te(p.right,g.right),g.bottom=Te(p.bottom,g.bottom),g.left=Nt(p.left,g.left),g},qn(e,v,o));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function wr(e){var r=e.reference,t=e.element,o=e.placement,c=o?Pt(o):null,u=o?te(o):null,v=r.x+r.width/2-t.width/2,f=r.y+r.height/2-t.height/2,g;switch(c){case dt:g={x:v,y:r.y-t.height};break;case yt:g={x:v,y:r.y+r.height};break;case bt:g={x:r.x+r.width,y:f};break;case pt:g={x:r.x-t.width,y:f};break;default:g={x:r.x,y:r.y}}var _=c?pn(c):null;if(_!=null){var p=_==="y"?"height":"width";switch(u){case $t:g[_]=g[_]-(r[p]/2-t[p]/2);break;case ge:g[_]=g[_]+(r[p]/2-t[p]/2);break}}return g}function _e(e,r){r===void 0&&(r={});var t=r,o=t.placement,c=o===void 0?e.placement:o,u=t.strategy,v=u===void 0?e.strategy:u,f=t.boundary,g=f===void 0?Ii:f,_=t.rootBoundary,p=_===void 0?mr:_,E=t.elementContext,k=E===void 0?ue:E,A=t.altBoundary,z=A===void 0?!1:A,l=t.padding,s=l===void 0?0:l,y=yr(typeof s!="number"?s:br(s,he)),w=k===ue?ji:ue,S=e.rects.popper,C=e.elements[z?w:k],h=uo(Zt(C)?C:C.contextElement||Dt(e.elements.popper),g,p,v),x=Xt(e.elements.reference),R=wr({reference:x,element:S,placement:c}),M=$e(Object.assign({},S,R)),P=k===ue?M:x,D={top:h.top-P.top+y.top,bottom:P.bottom-h.bottom+y.bottom,left:h.left-P.left+y.left,right:P.right-h.right+y.right},L=e.modifiersData.offset;if(k===ue&&L){var X=L[c];Object.keys(D).forEach(function(B){var j=[bt,yt].indexOf(B)>=0?1:-1,H=[dt,yt].indexOf(B)>=0?"y":"x";D[B]+=X[H]*j})}return D}function lo(e,r){r===void 0&&(r={});var t=r,o=t.placement,c=t.boundary,u=t.rootBoundary,v=t.padding,f=t.flipVariations,g=t.allowedAutoPlacements,_=g===void 0?gr:g,p=te(o),E=p?f?Vn:Vn.filter(function(z){return te(z)===p}):he,k=E.filter(function(z){return _.indexOf(z)>=0});k.length===0&&(k=E);var A=k.reduce(function(z,l){return z[l]=_e(e,{placement:l,boundary:c,rootBoundary:u,padding:v})[Pt(l)],z},{});return Object.keys(A).sort(function(z,l){return A[z]-A[l]})}function fo(e){if(Pt(e)===ln)return[];var r=Re(e);return[Gn(e),r,Gn(r)]}function po(e){var r=e.state,t=e.options,o=e.name;if(!r.modifiersData[o]._skip){for(var c=t.mainAxis,u=c===void 0?!0:c,v=t.altAxis,f=v===void 0?!0:v,g=t.fallbackPlacements,_=t.padding,p=t.boundary,E=t.rootBoundary,k=t.altBoundary,A=t.flipVariations,z=A===void 0?!0:A,l=t.allowedAutoPlacements,s=r.options.placement,y=Pt(s),w=y===s,S=g||(w||!z?[Re(s)]:fo(s)),C=[s].concat(S).reduce(function(ce,Ne){return ce.concat(Pt(Ne)===ln?lo(r,{placement:Ne,boundary:p,rootBoundary:E,padding:_,flipVariations:z,allowedAutoPlacements:l}):Ne)},[]),h=r.rects.reference,x=r.rects.popper,R=new Map,M=!0,P=C[0],D=0;D<C.length;D++){var L=C[D],X=Pt(L),B=te(L)===$t,j=[dt,yt].indexOf(X)>=0,H=j?"width":"height",$=_e(r,{placement:L,boundary:p,rootBoundary:E,altBoundary:k,padding:_}),q=j?B?bt:pt:B?yt:dt;h[H]>x[H]&&(q=Re(q));var W=Re(q),Y=[];if(u&&Y.push($[X]<=0),f&&Y.push($[q]<=0,$[W]<=0),Y.every(function(ce){return ce})){P=L,M=!1;break}R.set(L,Y)}if(M)for(var G=z?3:1,V=function(ce){var Ne=C.find(function(Pe){var De=R.get(Pe);if(De)return De.slice(0,ce).every(function(Me){return Me})});if(Ne)return P=Ne,"break"},Z=G;Z>0;Z--){var xe=V(Z);if(xe==="break")break}r.placement!==P&&(r.modifiersData[o]._skip=!0,r.placement=P,r.reset=!0)}}const mo={name:"flip",enabled:!0,phase:"main",fn:po,requiresIfExists:["offset"],data:{_skip:!1}};function Kn(e,r,t){return t===void 0&&(t={x:0,y:0}),{top:e.top-r.height-t.y,right:e.right-r.width+t.x,bottom:e.bottom-r.height+t.y,left:e.left-r.width-t.x}}function $n(e){return[dt,bt,yt,pt].some(function(r){return e[r]>=0})}function go(e){var r=e.state,t=e.name,o=r.rects.reference,c=r.rects.popper,u=r.modifiersData.preventOverflow,v=_e(r,{elementContext:"reference"}),f=_e(r,{altBoundary:!0}),g=Kn(v,o),_=Kn(f,c,u),p=$n(g),E=$n(_);r.modifiersData[t]={referenceClippingOffsets:g,popperEscapeOffsets:_,isReferenceHidden:p,hasPopperEscaped:E},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":p,"data-popper-escaped":E})}const _o={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:go};function vo(e,r,t){var o=Pt(e),c=[pt,dt].indexOf(o)>=0?-1:1,u=typeof t=="function"?t(Object.assign({},r,{placement:e})):t,v=u[0],f=u[1];return v=v||0,f=(f||0)*c,[pt,bt].indexOf(o)>=0?{x:f,y:v}:{x:v,y:f}}function ho(e){var r=e.state,t=e.options,o=e.name,c=t.offset,u=c===void 0?[0,0]:c,v=gr.reduce(function(p,E){return p[E]=vo(E,r.rects,u),p},{}),f=v[r.placement],g=f.x,_=f.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=g,r.modifiersData.popperOffsets.y+=_),r.modifiersData[o]=v}const yo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:ho};function bo(e){var r=e.state,t=e.name;r.modifiersData[t]=wr({reference:r.rects.reference,element:r.rects.popper,placement:r.placement})}const Po={name:"popperOffsets",enabled:!0,phase:"read",fn:bo,data:{}};function wo(e){return e==="x"?"y":"x"}function Eo(e){var r=e.state,t=e.options,o=e.name,c=t.mainAxis,u=c===void 0?!0:c,v=t.altAxis,f=v===void 0?!1:v,g=t.boundary,_=t.rootBoundary,p=t.altBoundary,E=t.padding,k=t.tether,A=k===void 0?!0:k,z=t.tetherOffset,l=z===void 0?0:z,s=_e(r,{boundary:g,rootBoundary:_,padding:E,altBoundary:p}),y=Pt(r.placement),w=te(r.placement),S=!w,C=pn(y),h=wo(C),x=r.modifiersData.popperOffsets,R=r.rects.reference,M=r.rects.popper,P=typeof l=="function"?l(Object.assign({},r.rects,{placement:r.placement})):l,D=typeof P=="number"?{mainAxis:P,altAxis:P}:Object.assign({mainAxis:0,altAxis:0},P),L=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,X={x:0,y:0};if(x){if(u){var B,j=C==="y"?dt:pt,H=C==="y"?yt:bt,$=C==="y"?"height":"width",q=x[C],W=q+s[j],Y=q-s[H],G=A?-M[$]/2:0,V=w===$t?R[$]:M[$],Z=w===$t?-M[$]:-R[$],xe=r.elements.arrow,ce=A&&xe?dn(xe):{width:0,height:0},Ne=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:hr(),Pe=Ne[j],De=Ne[H],Me=de(0,R[$],ce[$]),Be=S?R[$]/2-G-Me-Pe-D.mainAxis:V-Me-Pe-D.mainAxis,ft=S?-R[$]/2+G+Me+De+D.mainAxis:Z+Me+De+D.mainAxis,jt=r.elements.arrow&&ye(r.elements.arrow),Gt=jt?C==="y"?jt.clientTop||0:jt.clientLeft||0:0,mt=(B=L?.[C])!=null?B:0,Fe=q+Be-mt-Gt,ht=q+ft-mt,Kt=de(A?Te(W,Fe):W,q,A?Nt(Y,ht):Y);x[C]=Kt,X[C]=Kt-q}if(f){var Jt,Wt=C==="x"?dt:pt,Br=C==="x"?yt:bt,zr=x[h],cr=h==="y"?"height":"width",Nr=zr+s[Wt],At=zr-s[Br],Mt=[dt,pt].indexOf(y)!==-1,Jr=(Jt=L?.[h])!=null?Jt:0,Yr=Mt?Nr:zr-R[cr]-M[cr]-Jr+D.altAxis,ie=Mt?zr+R[cr]+M[cr]-Jr-D.altAxis:At,ve=A&&Mt?Wi(Yr,zr,ie):de(A?Yr:Nr,zr,A?ie:At);x[h]=ve,X[h]=ve-zr}r.modifiersData[o]=X}}const xo={name:"preventOverflow",enabled:!0,phase:"main",fn:Eo,requiresIfExists:["offset"]};function Ao(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Oo(e){return e===gt(e)||!wt(e)?mn(e):Ao(e)}function Ro(e){var r=e.getBoundingClientRect(),t=Qt(r.width)/e.offsetWidth||1,o=Qt(r.height)/e.offsetHeight||1;return t!==1||o!==1}function Co(e,r,t){t===void 0&&(t=!1);var o=wt(r),c=wt(r)&&Ro(r),u=Dt(r),v=Xt(e,c,t),f={scrollLeft:0,scrollTop:0},g={x:0,y:0};return(o||!o&&!t)&&((It(r)!=="body"||_n(u))&&(f=Oo(r)),wt(r)?(g=Xt(r,!0),g.x+=r.clientLeft,g.y+=r.clientTop):u&&(g.x=gn(u))),{x:v.left+f.scrollLeft-g.x,y:v.top+f.scrollTop-g.y,width:v.width,height:v.height}}function To(e){var r=new Map,t=new Set,o=[];e.forEach(function(u){r.set(u.name,u)});function c(u){t.add(u.name);var v=[].concat(u.requires||[],u.requiresIfExists||[]);v.forEach(function(f){if(!t.has(f)){var g=r.get(f);g&&c(g)}}),o.push(u)}return e.forEach(function(u){t.has(u.name)||c(u)}),o}function So(e){var r=To(e);return Ui.reduce(function(t,o){return t.concat(r.filter(function(c){return c.phase===o}))},[])}function ko(e){var r;return function(){return r||(r=new Promise(function(t){Promise.resolve().then(function(){r=void 0,t(e())})})),r}}function Io(e){var r=e.reduce(function(t,o){var c=t[o.name];return t[o.name]=c?Object.assign({},c,o,{options:Object.assign({},c.options,o.options),data:Object.assign({},c.data,o.data)}):o,t},{});return Object.keys(r).map(function(t){return r[t]})}var Qn={placement:"bottom",modifiers:[],strategy:"absolute"};function Xn(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return!r.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function jo(e){e===void 0&&(e={});var r=e,t=r.defaultModifiers,o=t===void 0?[]:t,c=r.defaultOptions,u=c===void 0?Qn:c;return function(v,f,g){g===void 0&&(g=u);var _={placement:"bottom",orderedModifiers:[],options:Object.assign({},Qn,u),modifiersData:{},elements:{reference:v,popper:f},attributes:{},styles:{}},p=[],E=!1,k={state:_,setOptions:function(l){var s=typeof l=="function"?l(_.options):l;z(),_.options=Object.assign({},u,_.options,s),_.scrollParents={reference:Zt(v)?pe(v):v.contextElement?pe(v.contextElement):[],popper:pe(f)};var y=So(Io([].concat(o,_.options.modifiers)));return _.orderedModifiers=y.filter(function(w){return w.enabled}),A(),k.update()},forceUpdate:function(){if(!E){var l=_.elements,s=l.reference,y=l.popper;if(Xn(s,y)){_.rects={reference:Co(s,ye(y),_.options.strategy==="fixed"),popper:dn(y)},_.reset=!1,_.placement=_.options.placement,_.orderedModifiers.forEach(function(M){return _.modifiersData[M.name]=Object.assign({},M.data)});for(var w=0;w<_.orderedModifiers.length;w++){if(_.reset===!0){_.reset=!1,w=-1;continue}var S=_.orderedModifiers[w],C=S.fn,h=S.options,x=h===void 0?{}:h,R=S.name;typeof C=="function"&&(_=C({state:_,options:x,name:R,instance:k})||_)}}}},update:ko(function(){return new Promise(function(l){k.forceUpdate(),l(_)})}),destroy:function(){z(),E=!0}};if(!Xn(v,f))return k;k.setOptions(g).then(function(l){!E&&g.onFirstUpdate&&g.onFirstUpdate(l)});function A(){_.orderedModifiers.forEach(function(l){var s=l.name,y=l.options,w=y===void 0?{}:y,S=l.effect;if(typeof S=="function"){var C=S({state:_,name:s,instance:k,options:w}),h=function(){};p.push(C||h)}})}function z(){p.forEach(function(l){return l()}),p=[]}return k}}const Do=jo({defaultModifiers:[_o,Po,to,no,yo,mo,xo,Ki]}),Fo=["enabled","placement","strategy","modifiers"];function Mo(e,r){if(e==null)return{};var t={},o=Object.keys(e),c,u;for(u=0;u<o.length;u++)c=o[u],!(r.indexOf(c)>=0)&&(t[c]=e[c]);return t}const Bo={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},zo={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:e})=>()=>{const{reference:r,popper:t}=e.elements;if("removeAttribute"in r){const o=(r.getAttribute("aria-describedby")||"").split(",").filter(c=>c.trim()!==t.id);o.length?r.setAttribute("aria-describedby",o.join(",")):r.removeAttribute("aria-describedby")}},fn:({state:e})=>{var r;const{popper:t,reference:o}=e.elements,c=(r=t.getAttribute("role"))==null?void 0:r.toLowerCase();if(t.id&&c==="tooltip"&&"setAttribute"in o){const u=o.getAttribute("aria-describedby");if(u&&u.split(",").indexOf(t.id)!==-1)return;o.setAttribute("aria-describedby",u?`${u},${t.id}`:t.id)}}},Lo=[];function No(e,r,t={}){let{enabled:o=!0,placement:c="bottom",strategy:u="absolute",modifiers:v=Lo}=t,f=Mo(t,Fo);const g=reactExports.useRef(v),_=reactExports.useRef(),p=reactExports.useCallback(()=>{var s;(s=_.current)==null||s.update()},[]),E=reactExports.useCallback(()=>{var s;(s=_.current)==null||s.forceUpdate()},[]),[k,A]=ki(reactExports.useState({placement:c,update:p,forceUpdate:E,attributes:{},styles:{popper:{},arrow:{}}})),z=reactExports.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:s})=>{const y={},w={};Object.keys(s.elements).forEach(S=>{y[S]=s.styles[S],w[S]=s.attributes[S]}),A({state:s,styles:y,attributes:w,update:p,forceUpdate:E,placement:s.placement})}}),[p,E,A]),l=reactExports.useMemo(()=>(fe(g.current,v)||(g.current=v),g.current),[v]);return reactExports.useEffect(()=>{!_.current||!o||_.current.setOptions({placement:c,strategy:u,modifiers:[...l,z,Bo]})},[u,c,z,o,l]),reactExports.useEffect(()=>{if(!(!o||e==null||r==null))return _.current=Do(e,r,Object.assign({},f,{placement:c,strategy:u,modifiers:[...l,zo,z]})),()=>{_.current!=null&&(_.current.destroy(),_.current=void 0,A(s=>Object.assign({},s,{attributes:{},styles:{popper:{}}})))}},[o,e,r]),k}const vn=!!(typeof window<"u"&&window.document&&window.document.createElement);var Qe=!1,Xe=!1;try{var Ue={get passive(){return Qe=!0},get once(){return Xe=Qe=!0}};vn&&(window.addEventListener("test",Ue,Ue),window.removeEventListener("test",Ue,!0))}catch{}function Zo(e,r,t,o){if(o&&typeof o!="boolean"&&!Xe){var c=o.once,u=o.capture,v=t;!Xe&&c&&(v=t.__once||function f(g){this.removeEventListener(r,f,u),t.call(this,g)},t.__once=v),e.addEventListener(r,v,Qe?o:u)}e.addEventListener(r,t,o)}function Ho(e,r,t,o){var c=o&&typeof o!="boolean"?o.capture:o;e.removeEventListener(r,t,c),t.__once&&e.removeEventListener(r,t.__once,c)}function Lt(e,r,t,o){return Zo(e,r,t,o),function(){Ho(e,r,t,o)}}function Ie(e){return e&&e.ownerDocument||document}function Uo(e){const r=reactExports.useRef(e);return reactExports.useEffect(()=>{r.current=e},[e]),r}function ee(e){const r=Uo(e);return reactExports.useCallback(function(...t){return r.current&&r.current(...t)},[r])}const tr=()=>{};function Yo(e){return e.button===0}function Vo(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}const Ce=e=>e&&("current"in e?e.current:e),er={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function Wo(e,r=tr,{disabled:t,clickTrigger:o="click"}={}){const c=reactExports.useRef(!1),u=reactExports.useRef(!1),v=reactExports.useCallback(_=>{const p=Ce(e);dr(!!p,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),c.current=!p||Vo(_)||!Yo(_)||!!We(p,_.target)||u.current,u.current=!1},[e]),f=ee(_=>{const p=Ce(e);p&&We(p,_.target)&&(u.current=!0)}),g=ee(_=>{c.current||r(_)});reactExports.useEffect(()=>{var _,p;if(t||e==null)return;const E=Ie(Ce(e)),k=E.defaultView||window;let A=(_=k.event)!=null?_:(p=k.parent)==null?void 0:p.event,z=null;er[o]&&(z=Lt(E,er[o],f,!0));const l=Lt(E,o,v,!0),s=Lt(E,o,w=>{if(w===A){A=void 0;return}g(w)});let y=[];return"ontouchstart"in E.documentElement&&(y=[].slice.call(E.body.children).map(w=>Lt(w,"mousemove",tr))),()=>{z?.(),l(),s(),y.forEach(w=>w())}},[e,t,o,v,f,g])}function Jo(e){return e.code==="Escape"||e.keyCode===27}const Go=()=>{};function qo(e,r,{disabled:t,clickTrigger:o}={}){const c=r||Go;Wo(e,c,{disabled:t,clickTrigger:o});const u=ee(v=>{Jo(v)&&c(v)});reactExports.useEffect(()=>{if(t||e==null)return;const v=Ie(Ce(e));let f=(v.defaultView||window).event;const g=Lt(v,"keyup",_=>{if(_===f){f=void 0;return}u(_)});return()=>{g()}},[e,t,u])}const Er=reactExports.createContext(vn?window:void 0);Er.Provider;function Ko(){return reactExports.useContext(Er)}const Ye=(e,r)=>vn?e==null?(r||Ie()).body:(typeof e=="function"&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null;function nr(e,r){const t=Ko(),[o,c]=reactExports.useState(()=>Ye(e,t?.document));if(!o){const u=Ye(e);u&&c(u)}return reactExports.useEffect(()=>{},[r,o]),reactExports.useEffect(()=>{const u=Ye(e);u!==o&&c(u)},[e,o]),o}function $o(e){const r={};return Array.isArray(e)?(e?.forEach(t=>{r[t.name]=t}),r):e||r}function Qo(e={}){return Array.isArray(e)?e:Object.keys(e).map(r=>(e[r].name=r,e[r]))}function Xo({enabled:e,enableEvents:r,placement:t,flip:o,offset:c,fixed:u,containerPadding:v,arrowElement:f,popperConfig:g={}}){var _,p,E,k;const A=$o(g.modifiers);return Object.assign({},g,{placement:t,enabled:e,strategy:u?"fixed":g.strategy,modifiers:Qo(Object.assign({},A,{eventListeners:{enabled:r,options:(_=A.eventListeners)==null?void 0:_.options},preventOverflow:Object.assign({},A.preventOverflow,{options:Object.assign({padding:v},(p=A.preventOverflow)==null?void 0:p.options)}),offset:{options:Object.assign({offset:c},(E=A.offset)==null?void 0:E.options)},arrow:Object.assign({},A.arrow,{enabled:!!f,options:Object.assign({},(k=A.arrow)==null?void 0:k.options,{element:f})}),flip:Object.assign({enabled:!!o},A.flip)}))})}const ts=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",es=typeof document<"u",tn=es||ts?reactExports.useLayoutEffect:reactExports.useEffect;function ns({children:e,in:r,onExited:t,mountOnEnter:o,unmountOnExit:c}){const u=reactExports.useRef(null),v=reactExports.useRef(r),f=ee(t);reactExports.useEffect(()=>{r?v.current=!0:f(u.current)},[r,f]);const g=ne(u,e.ref),_=reactExports.cloneElement(e,{ref:g});return r?_:c||!v.current&&o?null:_}function rs({in:e,onTransition:r}){const t=reactExports.useRef(null),o=reactExports.useRef(!0),c=ee(r);return tn(()=>{if(!t.current)return;let u=!1;return c({in:e,element:t.current,initial:o.current,isStale:()=>u}),()=>{u=!0}},[e,c]),tn(()=>(o.current=!1,()=>{o.current=!0}),[]),t}function is({children:e,in:r,onExited:t,onEntered:o,transition:c}){const[u,v]=reactExports.useState(!r);r&&u&&v(!1);const f=rs({in:!!r,onTransition:_=>{const p=()=>{_.isStale()||(_.in?o?.(_.element,_.initial):(v(!0),t?.(_.element)))};Promise.resolve(c(_)).then(p,E=>{throw _.in||v(!0),E})}}),g=ne(f,e.ref);return u&&!r?null:reactExports.cloneElement(e,{ref:g})}function os(e,r,t){return e?T.jsx(e,Object.assign({},t)):r?T.jsx(is,Object.assign({},t,{transition:r})):T.jsx(ns,Object.assign({},t))}const xr=reactExports.forwardRef((e,r)=>{const{flip:t,offset:o,placement:c,containerPadding:u,popperConfig:v={},transition:f,runTransition:g}=e,[_,p]=Hn(),[E,k]=Hn(),A=ne(p,r),z=nr(e.container),l=nr(e.target),[s,y]=reactExports.useState(!e.show),w=No(l,_,Xo({placement:c,enableEvents:!!e.show,containerPadding:u||5,flip:t,offset:o,arrowElement:E,popperConfig:v}));e.show&&s&&y(!1);const S=(...L)=>{y(!0),e.onExited&&e.onExited(...L)},C=e.show||!s;if(qo(_,e.onHide,{disabled:!e.rootClose||e.rootCloseDisabled,clickTrigger:e.rootCloseEvent}),!C)return null;const{onExit:h,onExiting:x,onEnter:R,onEntering:M,onEntered:P}=e;let D=e.children(Object.assign({},w.attributes.popper,{style:w.styles.popper,ref:A}),{popper:w,placement:c,show:!!e.show,arrowProps:Object.assign({},w.attributes.arrow,{style:w.styles.arrow,ref:k})});return D=os(f,g,{in:!!e.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:D,onExit:h,onExiting:x,onExited:S,onEnter:R,onEntering:M,onEntered:P}),z?ReactDOM.createPortal(D,z):null});xr.displayName="Overlay";function rr(e,r){return e.classList?!!r&&e.classList.contains(r):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+r+" ")!==-1}const ss=["xxl","xl","lg","md","sm","xs"],as="xs",Ar=reactExports.createContext({prefixes:{},breakpoints:ss,minBreakpoint:as});function Ht(e,r){const{prefixes:t}=reactExports.useContext(Ar);return e||t[r]||r}function Or(){const{dir:e}=reactExports.useContext(Ar);return e==="rtl"}const Rr=reactExports.forwardRef(({className:e,bsPrefix:r,as:t="div",...o},c)=>(r=Ht(r,"popover-header"),T.jsx(t,{ref:c,className:Ut(e,r),...o})));Rr.displayName="PopoverHeader";const hn=reactExports.forwardRef(({className:e,bsPrefix:r,as:t="div",...o},c)=>(r=Ht(r,"popover-body"),T.jsx(t,{ref:c,className:Ut(e,r),...o})));hn.displayName="PopoverBody";function Cr(e,r){let t=e;return e==="left"?t=r?"end":"start":e==="right"&&(t=r?"start":"end"),t}function Tr(e="absolute"){return{position:e,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const cs=reactExports.forwardRef(({bsPrefix:e,placement:r="right",className:t,style:o,children:c,body:u,arrowProps:v,hasDoneInitialMeasure:f,popper:g,show:_,...p},E)=>{const k=Ht(e,"popover"),A=Or(),[z]=r?.split("-")||[],l=Cr(z,A);let s=o;return _&&!f&&(s={...o,...Tr(g?.strategy)}),T.jsxs("div",{ref:E,role:"tooltip",style:s,"x-placement":z,className:Ut(t,k,z&&`bs-popover-${l}`),...p,children:[T.jsx("div",{className:"popover-arrow",...v}),u?T.jsx(hn,{children:c}):c]})}),en=Object.assign(cs,{Header:Rr,Body:hn,POPPER_OFFSET:[0,8]}),Sr=reactExports.forwardRef(({bsPrefix:e,placement:r="right",className:t,style:o,children:c,arrowProps:u,hasDoneInitialMeasure:v,popper:f,show:g,..._},p)=>{e=Ht(e,"tooltip");const E=Or(),[k]=r?.split("-")||[],A=Cr(k,E);let z=o;return g&&!v&&(z={...o,...Tr(f?.strategy)}),T.jsxs("div",{ref:p,style:z,role:"tooltip","x-placement":k,className:Ut(t,e,`bs-tooltip-${A}`),..._,children:[T.jsx("div",{className:"tooltip-arrow",...u}),T.jsx("div",{className:`${e}-inner`,children:c})]})});Sr.displayName="Tooltip";const kr=Object.assign(Sr,{TOOLTIP_OFFSET:[0,6]});function us(e){const r=reactExports.useRef(null),t=Ht(void 0,"popover"),o=Ht(void 0,"tooltip"),c=reactExports.useMemo(()=>({name:"offset",options:{offset:()=>{if(e)return e;if(r.current){if(rr(r.current,t))return en.POPPER_OFFSET;if(rr(r.current,o))return kr.TOOLTIP_OFFSET}return[0,0]}}}),[e,t,o]);return[r,[c]]}const ir={disabled:!1},Ir=React.createContext(null);var fs=function(e){return e.scrollTop},le="unmounted",Bt="exited",kt="entering",zt="entered",nn="exiting",Ct=(function(e){Ci$1(r,e);function r(o,c){var u;u=e.call(this,o,c)||this;var v=c,f=v&&!v.isMounting?o.enter:o.appear,g;return u.appearStatus=null,o.in?f?(g=Bt,u.appearStatus=kt):g=zt:o.unmountOnExit||o.mountOnEnter?g=le:g=Bt,u.state={status:g},u.nextCallback=null,u}r.getDerivedStateFromProps=function(o,c){var u=o.in;return u&&c.status===le?{status:Bt}:null};var t=r.prototype;return t.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},t.componentDidUpdate=function(o){var c=null;if(o!==this.props){var u=this.state.status;this.props.in?u!==kt&&u!==zt&&(c=kt):(u===kt||u===zt)&&(c=nn)}this.updateStatus(!1,c)},t.componentWillUnmount=function(){this.cancelNextCallback()},t.getTimeouts=function(){var o=this.props.timeout,c,u,v;return c=u=v=o,o!=null&&typeof o!="number"&&(c=o.exit,u=o.enter,v=o.appear!==void 0?o.appear:u),{exit:c,enter:u,appear:v}},t.updateStatus=function(o,c){if(o===void 0&&(o=!1),c!==null)if(this.cancelNextCallback(),c===kt){if(this.props.unmountOnExit||this.props.mountOnEnter){var u=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this);u&&fs(u)}this.performEnter(o)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Bt&&this.setState({status:le})},t.performEnter=function(o){var c=this,u=this.props.enter,v=this.context?this.context.isMounting:o,f=this.props.nodeRef?[v]:[ReactDOM.findDOMNode(this),v],g=f[0],_=f[1],p=this.getTimeouts(),E=v?p.appear:p.enter;if(!o&&!u||ir.disabled){this.safeSetState({status:zt},function(){c.props.onEntered(g)});return}this.props.onEnter(g,_),this.safeSetState({status:kt},function(){c.props.onEntering(g,_),c.onTransitionEnd(E,function(){c.safeSetState({status:zt},function(){c.props.onEntered(g,_)})})})},t.performExit=function(){var o=this,c=this.props.exit,u=this.getTimeouts(),v=this.props.nodeRef?void 0:ReactDOM.findDOMNode(this);if(!c||ir.disabled){this.safeSetState({status:Bt},function(){o.props.onExited(v)});return}this.props.onExit(v),this.safeSetState({status:nn},function(){o.props.onExiting(v),o.onTransitionEnd(u.exit,function(){o.safeSetState({status:Bt},function(){o.props.onExited(v)})})})},t.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},t.safeSetState=function(o,c){c=this.setNextCallback(c),this.setState(o,c)},t.setNextCallback=function(o){var c=this,u=!0;return this.nextCallback=function(v){u&&(u=!1,c.nextCallback=null,o(v))},this.nextCallback.cancel=function(){u=!1},this.nextCallback},t.onTransitionEnd=function(o,c){this.setNextCallback(c);var u=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this),v=o==null&&!this.props.addEndListener;if(!u||v){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var f=this.props.nodeRef?[this.nextCallback]:[u,this.nextCallback],g=f[0],_=f[1];this.props.addEndListener(g,_)}o!=null&&setTimeout(this.nextCallback,o)},t.render=function(){var o=this.state.status;if(o===le)return null;var c=this.props,u=c.children;c.in,c.mountOnEnter,c.unmountOnExit,c.appear,c.enter,c.exit,c.timeout,c.addEndListener,c.onEnter,c.onEntering,c.onEntered,c.onExit,c.onExiting,c.onExited,c.nodeRef;var v=Oi(c,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return React.createElement(Ir.Provider,{value:null},typeof u=="function"?u(o,v):React.cloneElement(React.Children.only(u),v))},r})(React.Component);Ct.contextType=Ir;Ct.propTypes={};function qt(){}Ct.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:qt,onEntering:qt,onEntered:qt,onExit:qt,onExiting:qt,onExited:qt};Ct.UNMOUNTED=le;Ct.EXITED=Bt;Ct.ENTERING=kt;Ct.ENTERED=zt;Ct.EXITING=nn;function ds(e){var r=Ie(e);return r&&r.defaultView||window}function ps(e,r){return ds(e).getComputedStyle(e,r)}var ms=/([A-Z])/g;function gs(e){return e.replace(ms,"-$1").toLowerCase()}var _s=/^ms-/;function Oe(e){return gs(e).replace(_s,"-ms-")}var vs=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function hs(e){return!!(e&&vs.test(e))}function jr(e,r){var t="",o="";if(typeof r=="string")return e.style.getPropertyValue(Oe(r))||ps(e).getPropertyValue(Oe(r));Object.keys(r).forEach(function(c){var u=r[c];!u&&u!==0?e.style.removeProperty(Oe(c)):hs(c)?o+=c+"("+u+") ":t+=Oe(c)+": "+u+";"}),o&&(t+="transform: "+o+";"),e.style.cssText+=";"+t}function ys(e,r,t,o){if(o===void 0&&(o=!0),e){var c=document.createEvent("HTMLEvents");c.initEvent(r,t,o),e.dispatchEvent(c)}}function bs(e){var r=jr(e,"transitionDuration")||"",t=r.indexOf("ms")===-1?1e3:1;return parseFloat(r)*t}function Ps(e,r,t){t===void 0&&(t=5);var o=!1,c=setTimeout(function(){o||ys(e,"transitionend",!0)},r+t),u=Lt(e,"transitionend",function(){o=!0},{once:!0});return function(){clearTimeout(c),u()}}function ws(e,r,t,o){t==null&&(t=bs(e)||0);var c=Ps(e,t,o),u=Lt(e,"transitionend",r);return function(){c(),u()}}function or(e,r){const t=jr(e,r)||"",o=t.indexOf("ms")===-1?1e3:1;return parseFloat(t)*o}function Es(e,r){const t=or(e,"transitionDuration"),o=or(e,"transitionDelay"),c=ws(e,u=>{u.target===e&&(c(),r(u))},t+o)}function xs(e){e.offsetHeight}function Se(e){return e&&"setState"in e?ReactDOM.findDOMNode(e):e??null}const As=React.forwardRef(({onEnter:e,onEntering:r,onEntered:t,onExit:o,onExiting:c,onExited:u,addEndListener:v,children:f,childRef:g,..._},p)=>{const E=reactExports.useRef(null),k=ne(E,g),A=x=>{k(Se(x))},z=x=>R=>{x&&E.current&&x(E.current,R)},l=reactExports.useCallback(z(e),[e]),s=reactExports.useCallback(z(r),[r]),y=reactExports.useCallback(z(t),[t]),w=reactExports.useCallback(z(o),[o]),S=reactExports.useCallback(z(c),[c]),C=reactExports.useCallback(z(u),[u]),h=reactExports.useCallback(z(v),[v]);return T.jsx(Ct,{ref:p,..._,onEnter:l,onEntered:y,onEntering:s,onExit:w,onExited:C,onExiting:S,addEndListener:h,nodeRef:E,children:typeof f=="function"?(x,R)=>f(x,{...R,ref:A}):React.cloneElement(f,{ref:A})})}),Os={[kt]:"show",[zt]:"show"},rn=reactExports.forwardRef(({className:e,children:r,transitionClasses:t={},onEnter:o,...c},u)=>{const v={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...c},f=reactExports.useCallback((g,_)=>{xs(g),o?.(g,_)},[o]);return T.jsx(As,{ref:u,addEndListener:Es,...v,onEnter:f,childRef:r.ref,children:(g,_)=>reactExports.cloneElement(r,{..._,className:Ut("fade",e,r.props.className,Os[g],t[g])})})});rn.displayName="Fade";function Rs(e,r){const{ref:t}=e,{ref:o}=r;e.ref=t.__wrapped||(t.__wrapped=c=>t(Se(c))),r.ref=o.__wrapped||(o.__wrapped=c=>o(Se(c)))}const Dr=reactExports.forwardRef(({children:e,transition:r=rn,popperConfig:t={},rootClose:o=!1,placement:c="top",show:u=!1,...v},f)=>{const g=reactExports.useRef({}),[_,p]=reactExports.useState(null),[E,k]=us(v.offset),A=ne(f,E),z=r===!0?rn:r||void 0,l=ee(s=>{p(s),t==null||t.onFirstUpdate==null||t.onFirstUpdate(s)});return tn(()=>{_&&v.target&&(g.current.scheduleUpdate==null||g.current.scheduleUpdate())},[_,v.target]),reactExports.useEffect(()=>{u||p(null)},[u]),T.jsx(xr,{...v,ref:A,popperConfig:{...t,modifiers:k.concat(t.modifiers||[]),onFirstUpdate:l},transition:z,rootClose:o,placement:c,show:u,children:(s,{arrowProps:y,popper:w,show:S})=>{var C,h;Rs(s,y);const x=w?.placement,R=Object.assign(g.current,{state:w?.state,scheduleUpdate:w?.update,placement:x,outOfBoundaries:(w==null||(C=w.state)==null||(h=C.modifiersData.hide)==null?void 0:h.isReferenceHidden)||!1,strategy:t.strategy}),M=!!_;return typeof e=="function"?e({...s,placement:x,show:S,...!r&&S&&{className:"show"},popper:R,arrowProps:y,hasDoneInitialMeasure:M}):reactExports.cloneElement(e,{...s,placement:x,arrowProps:y,popper:R,hasDoneInitialMeasure:M,className:Ut(e.props.className,!r&&S&&"show"),style:{...e.props.style,...s.style}})}})});Dr.displayName="Overlay";function Cs(e){return e&&typeof e=="object"?e:{show:e,hide:e}}function sr(e,r,t){const[o]=r,c=o.currentTarget,u=o.relatedTarget||o.nativeEvent[t];(!u||u!==c)&&!We(c,u)&&e(...r)}N.oneOf(["click","hover","focus"]);const yn=({trigger:e=["hover","focus"],overlay:r,children:t,popperConfig:o={},show:c,defaultShow:u=!1,onToggle:v,delay:f,placement:g,flip:_=g&&g.indexOf("auto")!==-1,...p})=>{const E=reactExports.useRef(null),k=ne(E,t.ref),A=wi(),z=reactExports.useRef(""),[l,s]=Ri(c,u,v),y=Cs(f),{onFocus:w,onBlur:S,onClick:C}=typeof t!="function"?reactExports.Children.only(t).props:{},h=H=>{k(Se(H))},x=reactExports.useCallback(()=>{if(A.clear(),z.current="show",!y.show){s(!0);return}A.set(()=>{z.current==="show"&&s(!0)},y.show)},[y.show,s,A]),R=reactExports.useCallback(()=>{if(A.clear(),z.current="hide",!y.hide){s(!1);return}A.set(()=>{z.current==="hide"&&s(!1)},y.hide)},[y.hide,s,A]),M=reactExports.useCallback((...H)=>{x(),w?.(...H)},[x,w]),P=reactExports.useCallback((...H)=>{R(),S?.(...H)},[R,S]),D=reactExports.useCallback((...H)=>{s(!l),C?.(...H)},[C,s,l]),L=reactExports.useCallback((...H)=>{sr(x,H,"fromElement")},[x]),X=reactExports.useCallback((...H)=>{sr(R,H,"toElement")},[R]),B=e==null?[]:[].concat(e),j={ref:h};return B.indexOf("click")!==-1&&(j.onClick=D),B.indexOf("focus")!==-1&&(j.onFocus=M,j.onBlur=P),B.indexOf("hover")!==-1&&(j.onMouseOver=L,j.onMouseOut=X),T.jsxs(T.Fragment,{children:[typeof t=="function"?t(j):reactExports.cloneElement(t,j),T.jsx(Dr,{...p,show:l,onHide:R,flip:_,placement:g,popperConfig:o,target:E.current,children:r})]})},Is=["as","disabled"];function js(e,r){if(e==null)return{};var t={},o=Object.keys(e),c,u;for(u=0;u<o.length;u++)c=o[u],!(r.indexOf(c)>=0)&&(t[c]=e[c]);return t}function Ds(e){return!e||e.trim()==="#"}function Fr({tagName:e,disabled:r,href:t,target:o,rel:c,role:u,onClick:v,tabIndex:f=0,type:g}){e||(t!=null||o!=null||c!=null?e="a":e="button");const _={tagName:e};if(e==="button")return[{type:g||"button",disabled:r},_];const p=k=>{if((r||e==="a"&&Ds(t))&&k.preventDefault(),r){k.stopPropagation();return}v?.(k)},E=k=>{k.key===" "&&(k.preventDefault(),p(k))};return e==="a"&&(t||(t="#"),r&&(t=void 0)),[{role:u??"button",disabled:void 0,tabIndex:r?void 0:f,href:t,target:e==="a"?o:void 0,"aria-disabled":r||void 0,rel:e==="a"?c:void 0,onClick:p,onKeyDown:E},_]}const Fs=reactExports.forwardRef((e,r)=>{let{as:t,disabled:o}=e,c=js(e,Is);const[u,{tagName:v}]=Fr(Object.assign({tagName:t,disabled:o},c));return T.jsx(v,Object.assign({},c,u,{ref:r}))});Fs.displayName="Button";const Mr=reactExports.forwardRef(({as:e,bsPrefix:r,variant:t="primary",size:o,active:c=!1,disabled:u=!1,className:v,...f},g)=>{const _=Ht(r,"btn"),[p,{tagName:E}]=Fr({tagName:e,disabled:u,...f}),k=E;return T.jsx(k,{...p,...f,ref:g,disabled:u,className:Ut(v,_,c&&"active",t&&`${_}-${t}`,o&&`${_}-${o}`,f.href&&u&&"disabled")})});Mr.displayName="Button";const Ms="_download_dropdown_menu_23m9j_1",Bs={download_dropdown_menu:Ms},zs=[{format:"cif",label:"CIF"},{format:"xsf",label:"XSF"},{format:"xyz",label:"XYZ"}];function Au(e){const r=`${e.aiida_rest_url}/nodes/${e.uuid}/download`,t=e.download_formats||zs,o=T.jsx(en,{children:T.jsx(en.Body,{style:{padding:"5px 0px"},children:T.jsx("ul",{className:Bs.download_dropdown_menu,children:t.map(({format:c,label:u})=>T.jsx("li",{children:T.jsx("a",{href:`${r}?download_format=${c}`,children:u})},c))})})});return T.jsx(yn,{trigger:"click",rootClose:!0,placement:"bottom",overlay:o,children:T.jsx(Mr,{size:"sm",style:{margin:"4px",padding:"2px 7px"},title:"Download",children:T.jsx("span",{className:"bi bi-download"})})})}var classnames={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var hasRequiredClassnames;function requireClassnames(){return hasRequiredClassnames||(hasRequiredClassnames=1,(function(e){(function(){var r={}.hasOwnProperty;function t(){for(var u="",v=0;v<arguments.length;v++){var f=arguments[v];f&&(u=c(u,o(f)))}return u}function o(u){if(typeof u=="string"||typeof u=="number")return u;if(typeof u!="object")return"";if(Array.isArray(u))return t.apply(null,u);if(u.toString!==Object.prototype.toString&&!u.toString.toString().includes("[native code]"))return u.toString();var v="";for(var f in u)r.call(u,f)&&u[f]&&(v=c(v,f));return v}function c(u,v){return v?u?u+" "+v:u+v:u}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(classnames)),classnames.exports}var classnamesExports=requireClassnames();const classNames=getDefaultExportFromCjs(classnamesExports),DEFAULT_BREAKPOINTS=["xxl","xl","lg","md","sm","xs"],DEFAULT_MIN_BREAKPOINT="xs",ThemeContext=reactExports.createContext({prefixes:{},breakpoints:DEFAULT_BREAKPOINTS,minBreakpoint:DEFAULT_MIN_BREAKPOINT}),{Consumer,Provider}=ThemeContext;function useBootstrapPrefix(e,r){const{prefixes:t}=reactExports.useContext(ThemeContext);return e||t[r]||r}function useBootstrapBreakpoints(){const{breakpoints:e}=reactExports.useContext(ThemeContext);return e}function useBootstrapMinBreakpoint(){const{minBreakpoint:e}=reactExports.useContext(ThemeContext);return e}var propTypes$2={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=e,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var e=requireReactPropTypesSecret();function r(){}function t(){}return t.resetWarningCache=r,factoryWithThrowingShims=function(){function o(v,f,g,_,p,E){if(E!==e){var k=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw k.name="Invariant Violation",k}}o.isRequired=o;function c(){return o}var u={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:c,element:o,elementType:o,instanceOf:c,node:o,objectOf:c,oneOf:c,oneOfType:c,shape:c,exact:c,checkPropTypes:t,resetWarningCache:r};return u.PropTypes=u,u},factoryWithThrowingShims}var hasRequiredPropTypes;function requirePropTypes(){return hasRequiredPropTypes||(hasRequiredPropTypes=1,propTypes$2.exports=requireFactoryWithThrowingShims()()),propTypes$2.exports}var propTypesExports=requirePropTypes();const PropTypes=getDefaultExportFromCjs(propTypesExports),_excluded=["as","disabled"];function _objectWithoutPropertiesLoose(e,r){if(e==null)return{};var t={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(r.indexOf(o)>=0)continue;t[o]=e[o]}return t}function isTrivialHref(e){return!e||e.trim()==="#"}function useButtonProps({tagName:e,disabled:r,href:t,target:o,rel:c,role:u,onClick:v,tabIndex:f=0,type:g}){e||(t!=null||o!=null||c!=null?e="a":e="button");const _={tagName:e};if(e==="button")return[{type:g||"button",disabled:r},_];const p=k=>{if((r||e==="a"&&isTrivialHref(t))&&k.preventDefault(),r){k.stopPropagation();return}v?.(k)},E=k=>{k.key===" "&&(k.preventDefault(),p(k))};return e==="a"&&(t||(t="#"),r&&(t=void 0)),[{role:u??"button",disabled:void 0,tabIndex:r?void 0:f,href:t,target:e==="a"?o:void 0,"aria-disabled":r||void 0,rel:e==="a"?c:void 0,onClick:p,onKeyDown:E},_]}const Button$1=reactExports.forwardRef((e,r)=>{let{as:t,disabled:o}=e,c=_objectWithoutPropertiesLoose(e,_excluded);const[u,{tagName:v}]=useButtonProps(Object.assign({tagName:t,disabled:o},c));return jsxRuntimeExports$1.jsx(v,Object.assign({},c,u,{ref:r}))});Button$1.displayName="Button";const Button=reactExports.forwardRef(({as:e,bsPrefix:r,variant:t="primary",size:o,active:c=!1,disabled:u=!1,className:v,...f},g)=>{const _=useBootstrapPrefix(r,"btn"),[p,{tagName:E}]=useButtonProps({tagName:e,disabled:u,...f}),k=E;return jsxRuntimeExports$1.jsx(k,{...p,...f,ref:g,disabled:u,className:classNames(v,_,c&&"active",t&&`${_}-${t}`,o&&`${_}-${o}`,f.href&&u&&"disabled")})});Button.displayName="Button";function hasChildOfType(e,r){return reactExports.Children.toArray(e).some(t=>reactExports.isValidElement(t)&&t.type===r)}function useCol({as:e,bsPrefix:r,className:t,...o}){r=useBootstrapPrefix(r,"col");const c=useBootstrapBreakpoints(),u=useBootstrapMinBreakpoint(),v=[],f=[];return c.forEach(g=>{const _=o[g];delete o[g];let p,E,k;typeof _=="object"&&_!=null?{span:p,offset:E,order:k}=_:p=_;const A=g!==u?`-${g}`:"";p&&v.push(p===!0?`${r}${A}`:`${r}${A}-${p}`),k!=null&&f.push(`order${A}-${k}`),E!=null&&f.push(`offset${A}-${E}`)}),[{...o,className:classNames(t,...v,...f)},{as:e,bsPrefix:r,spans:v}]}const Col=reactExports.forwardRef((e,r)=>{const[{className:t,...o},{as:c="div",bsPrefix:u,spans:v}]=useCol(e);return jsxRuntimeExports$1.jsx(c,{...o,ref:r,className:classNames(t,!v.length&&u)})});Col.displayName="Col";const propTypes$1={type:PropTypes.string,tooltip:PropTypes.bool,as:PropTypes.elementType},Feedback=reactExports.forwardRef(({as:e="div",className:r,type:t="valid",tooltip:o=!1,...c},u)=>jsxRuntimeExports$1.jsx(e,{...c,ref:u,className:classNames(r,`${t}-${o?"tooltip":"feedback"}`)}));Feedback.displayName="Feedback";Feedback.propTypes=propTypes$1;const FormContext=reactExports.createContext({}),FormCheckInput=reactExports.forwardRef(({id:e,bsPrefix:r,className:t,type:o="checkbox",isValid:c=!1,isInvalid:u=!1,as:v="input",...f},g)=>{const{controlId:_}=reactExports.useContext(FormContext);return r=useBootstrapPrefix(r,"form-check-input"),jsxRuntimeExports$1.jsx(v,{...f,ref:g,type:o,id:e||_,className:classNames(t,r,c&&"is-valid",u&&"is-invalid")})});FormCheckInput.displayName="FormCheckInput";const FormCheckLabel=reactExports.forwardRef(({bsPrefix:e,className:r,htmlFor:t,...o},c)=>{const{controlId:u}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-check-label"),jsxRuntimeExports$1.jsx("label",{...o,ref:c,htmlFor:t||u,className:classNames(r,e)})});FormCheckLabel.displayName="FormCheckLabel";const FormCheck=reactExports.forwardRef(({id:e,bsPrefix:r,bsSwitchPrefix:t,inline:o=!1,reverse:c=!1,disabled:u=!1,isValid:v=!1,isInvalid:f=!1,feedbackTooltip:g=!1,feedback:_,feedbackType:p,className:E,style:k,title:A="",type:z="checkbox",label:l,children:s,as:y="input",...w},S)=>{r=useBootstrapPrefix(r,"form-check"),t=useBootstrapPrefix(t,"form-switch");const{controlId:C}=reactExports.useContext(FormContext),h=reactExports.useMemo(()=>({controlId:e||C}),[C,e]),x=!s&&l!=null&&l!==!1||hasChildOfType(s,FormCheckLabel),R=jsxRuntimeExports$1.jsx(FormCheckInput,{...w,type:z==="switch"?"checkbox":z,ref:S,isValid:v,isInvalid:f,disabled:u,as:y});return jsxRuntimeExports$1.jsx(FormContext.Provider,{value:h,children:jsxRuntimeExports$1.jsx("div",{style:k,className:classNames(E,x&&r,o&&`${r}-inline`,c&&`${r}-reverse`,z==="switch"&&t),children:s||jsxRuntimeExports$1.jsxs(jsxRuntimeExports$1.Fragment,{children:[R,x&&jsxRuntimeExports$1.jsx(FormCheckLabel,{title:A,children:l}),_&&jsxRuntimeExports$1.jsx(Feedback,{type:p,tooltip:g,children:_})]})})})});FormCheck.displayName="FormCheck";const FormCheck$1=Object.assign(FormCheck,{Input:FormCheckInput,Label:FormCheckLabel}),FormControl=reactExports.forwardRef(({bsPrefix:e,type:r,size:t,htmlSize:o,id:c,className:u,isValid:v=!1,isInvalid:f=!1,plaintext:g,readOnly:_,as:p="input",...E},k)=>{const{controlId:A}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-control"),jsxRuntimeExports$1.jsx(p,{...E,type:r,size:o,ref:k,readOnly:_,id:c||A,className:classNames(u,g?`${e}-plaintext`:e,t&&`${e}-${t}`,r==="color"&&`${e}-color`,v&&"is-valid",f&&"is-invalid")})});FormControl.displayName="FormControl";const FormControl$1=Object.assign(FormControl,{Feedback}),FormFloating=reactExports.forwardRef(({className:e,bsPrefix:r,as:t="div",...o},c)=>(r=useBootstrapPrefix(r,"form-floating"),jsxRuntimeExports$1.jsx(t,{ref:c,className:classNames(e,r),...o})));FormFloating.displayName="FormFloating";const FormGroup=reactExports.forwardRef(({controlId:e,as:r="div",...t},o)=>{const c=reactExports.useMemo(()=>({controlId:e}),[e]);return jsxRuntimeExports$1.jsx(FormContext.Provider,{value:c,children:jsxRuntimeExports$1.jsx(r,{...t,ref:o})})});FormGroup.displayName="FormGroup";const FormLabel=reactExports.forwardRef(({as:e="label",bsPrefix:r,column:t=!1,visuallyHidden:o=!1,className:c,htmlFor:u,...v},f)=>{const{controlId:g}=reactExports.useContext(FormContext);r=useBootstrapPrefix(r,"form-label");let _="col-form-label";typeof t=="string"&&(_=`${_} ${_}-${t}`);const p=classNames(c,r,o&&"visually-hidden",t&&_);return u=u||g,t?jsxRuntimeExports$1.jsx(Col,{ref:f,as:"label",className:p,htmlFor:u,...v}):jsxRuntimeExports$1.jsx(e,{ref:f,className:p,htmlFor:u,...v})});FormLabel.displayName="FormLabel";const FormRange=reactExports.forwardRef(({bsPrefix:e,className:r,id:t,...o},c)=>{const{controlId:u}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-range"),jsxRuntimeExports$1.jsx("input",{...o,type:"range",ref:c,className:classNames(r,e),id:t||u})});FormRange.displayName="FormRange";const FormSelect=reactExports.forwardRef(({bsPrefix:e,size:r,htmlSize:t,className:o,isValid:c=!1,isInvalid:u=!1,id:v,...f},g)=>{const{controlId:_}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-select"),jsxRuntimeExports$1.jsx("select",{...f,size:t,ref:g,className:classNames(o,e,r&&`${e}-${r}`,c&&"is-valid",u&&"is-invalid"),id:v||_})});FormSelect.displayName="FormSelect";const FormText=reactExports.forwardRef(({bsPrefix:e,className:r,as:t="small",muted:o,...c},u)=>(e=useBootstrapPrefix(e,"form-text"),jsxRuntimeExports$1.jsx(t,{...c,ref:u,className:classNames(r,e,o&&"text-muted")})));FormText.displayName="FormText";const Switch=reactExports.forwardRef((e,r)=>jsxRuntimeExports$1.jsx(FormCheck$1,{...e,ref:r,type:"switch"}));Switch.displayName="Switch";const Switch$1=Object.assign(Switch,{Input:FormCheck$1.Input,Label:FormCheck$1.Label}),FloatingLabel=reactExports.forwardRef(({bsPrefix:e,className:r,children:t,controlId:o,label:c,...u},v)=>(e=useBootstrapPrefix(e,"form-floating"),jsxRuntimeExports$1.jsxs(FormGroup,{ref:v,className:classNames(r,e),controlId:o,...u,children:[t,jsxRuntimeExports$1.jsx("label",{htmlFor:o,children:c})]})));FloatingLabel.displayName="FloatingLabel";const propTypes={_ref:PropTypes.any,validated:PropTypes.bool,as:PropTypes.elementType},Form=reactExports.forwardRef(({className:e,validated:r,as:t="form",...o},c)=>jsxRuntimeExports$1.jsx(t,{...o,ref:c,className:classNames(e,r&&"was-validated")}));Form.displayName="Form";Form.propTypes=propTypes;const Form$1=Object.assign(Form,{Group:FormGroup,Control:FormControl$1,Floating:FormFloating,Check:FormCheck$1,Switch:Switch$1,Label:FormLabel,Text:FormText,Range:FormRange,Select:FormSelect,FloatingLabel});var Zs=Object.defineProperty,Ys=(e,r,t)=>r in e?Zs(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Ci=(e,r,t)=>(Ys(e,typeof r!="symbol"?r+"":r,t),t),commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},jsxRuntime={exports:{}},reactJsxRuntime_production_min={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var e=React,r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function v(f,g,_){var p,E={},k=null,A=null;_!==void 0&&(k=""+_),g.key!==void 0&&(k=""+g.key),g.ref!==void 0&&(A=g.ref);for(p in g)o.call(g,p)&&!u.hasOwnProperty(p)&&(E[p]=g[p]);if(f&&f.defaultProps)for(p in g=f.defaultProps,g)E[p]===void 0&&(E[p]=g[p]);return{$$typeof:r,type:f,key:k,ref:A,props:E,_owner:c.current}}return reactJsxRuntime_production_min.Fragment=t,reactJsxRuntime_production_min.jsx=v,reactJsxRuntime_production_min.jsxs=v,reactJsxRuntime_production_min}jsxRuntime.exports=requireReactJsxRuntime_production_min();var jsxRuntimeExports=jsxRuntime.exports;class ControlBox extends React.Component{constructor(){super(...arguments),Ci(this,"handleSupercellChange",(r,t)=>{let o=this.props.viewerParams.supercell;o[r]=parseInt(t),this.props.onViewerParamChange("supercell",o)}),Ci(this,"handleOptionChange",r=>{this.props.onViewerParamChange(r,!this.props.viewerParams[r])}),Ci(this,"handleCameraEvent",r=>{this.props.onViewerEvent("camera",r)})}render(){return jsxRuntimeExports.jsxs("div",{className:"control-box",children:[jsxRuntimeExports.jsxs("div",{className:"control-box-row",children:[jsxRuntimeExports.jsxs("div",{className:"supercell-container",children:[jsxRuntimeExports.jsx(Form$1.Label,{children:"Supercell: "}),jsxRuntimeExports.jsx("div",{style:{display:"flex"},children:[0,1,2].map(r=>jsxRuntimeExports.jsx(Form$1.Control,{className:"supercell-input",type:"number",min:"1",max:"99",value:this.props.viewerParams.supercell[r],onChange:t=>this.handleSupercellChange(r,t.target.value)},r))})]}),jsxRuntimeExports.jsxs("div",{className:"camera-controls",children:[jsxRuntimeExports.jsx(Form$1.Label,{children:"Camera: "}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("x"),children:"x"}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("y"),children:"y"}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("z"),children:"z"})]})]}),jsxRuntimeExports.jsxs("div",{className:"control-box-row",style:{display:"flex"},children:[jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.bonds,onChange:()=>this.handleOptionChange("bonds"),label:"Bonds"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.packedCell,onChange:()=>this.handleOptionChange("packedCell"),label:"Packed cell"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.atomLabels,onChange:()=>this.handleOptionChange("atomLabels"),label:"Atom labels"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.spaceFilling,onChange:()=>this.handleOptionChange("vdwRadius"),label:"vdW radius"})]})]})}}var _3Dmol={exports:{}};/*!
 * 3dmol v2.3.0
 * JavaScript/TypeScript molecular visualization library
 * Author: David Koes and contributors
 */(function(module,exports){(function(e,r){module.exports=r()})(commonjsGlobal,()=>(()=>{var __webpack_modules__={"./node_modules/iobuffer/lib-esm/IOBuffer.js":((e,r,t)=>{t.r(r),t.d(r,{IOBuffer:()=>f});var o=t("./node_modules/iobuffer/lib-esm/text.browser.js");const c=1024*8,u=(()=>{const g=new Uint8Array(4),_=new Uint32Array(g.buffer);return!((_[0]=1)&g[0])})(),v={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class f{constructor(_=c,p={}){let E=!1;typeof _=="number"?_=new ArrayBuffer(_):(E=!0,this.lastWrittenByte=_.byteLength);const k=p.offset?p.offset>>>0:0,A=_.byteLength-k;let z=k;(ArrayBuffer.isView(_)||_ instanceof f)&&(_.byteLength!==_.buffer.byteLength&&(z=_.byteOffset+k),_=_.buffer),E?this.lastWrittenByte=A:this.lastWrittenByte=0,this.buffer=_,this.length=A,this.byteLength=A,this.byteOffset=z,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,z,A),this._mark=0,this._marks=[]}available(_=1){return this.offset+_<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(_=1){return this.offset+=_,this}back(_=1){return this.offset-=_,this}seek(_){return this.offset=_,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const _=this._marks.pop();if(_===void 0)throw new Error("Mark stack empty");return this.seek(_),this}rewind(){return this.offset=0,this}ensureAvailable(_=1){if(!this.available(_)){const p=(this.offset+_)*2,E=new Uint8Array(p);E.set(new Uint8Array(this.buffer)),this.buffer=E.buffer,this.length=this.byteLength=p,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(_=1){return this.readArray(_,"uint8")}readArray(_,p){const E=v[p].BYTES_PER_ELEMENT*_,k=this.byteOffset+this.offset,A=this.buffer.slice(k,k+E);if(this.littleEndian===u&&p!=="uint8"&&p!=="int8"){const l=new Uint8Array(this.buffer.slice(k,k+E));l.reverse();const s=new v[p](l.buffer);return this.offset+=E,s.reverse(),s}const z=new v[p](A);return this.offset+=E,z}readInt16(){const _=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,_}readUint16(){const _=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,_}readInt32(){const _=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,_}readUint32(){const _=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,_}readFloat32(){const _=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,_}readFloat64(){const _=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,_}readBigInt64(){const _=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,_}readBigUint64(){const _=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,_}readChar(){return String.fromCharCode(this.readInt8())}readChars(_=1){let p="";for(let E=0;E<_;E++)p+=this.readChar();return p}readUtf8(_=1){return(0,o.decode)(this.readBytes(_))}decodeText(_=1,p="utf-8"){return(0,o.decode)(this.readBytes(_),p)}writeBoolean(_){return this.writeUint8(_?255:0),this}writeInt8(_){return this.ensureAvailable(1),this._data.setInt8(this.offset++,_),this._updateLastWrittenByte(),this}writeUint8(_){return this.ensureAvailable(1),this._data.setUint8(this.offset++,_),this._updateLastWrittenByte(),this}writeByte(_){return this.writeUint8(_)}writeBytes(_){this.ensureAvailable(_.length);for(let p=0;p<_.length;p++)this._data.setUint8(this.offset++,_[p]);return this._updateLastWrittenByte(),this}writeInt16(_){return this.ensureAvailable(2),this._data.setInt16(this.offset,_,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(_){return this.ensureAvailable(2),this._data.setUint16(this.offset,_,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(_){return this.ensureAvailable(4),this._data.setInt32(this.offset,_,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(_){return this.ensureAvailable(4),this._data.setUint32(this.offset,_,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(_){return this.ensureAvailable(4),this._data.setFloat32(this.offset,_,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(_){return this.ensureAvailable(8),this._data.setFloat64(this.offset,_,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(_){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,_,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(_){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,_,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(_){return this.writeUint8(_.charCodeAt(0))}writeChars(_){for(let p=0;p<_.length;p++)this.writeUint8(_.charCodeAt(p));return this}writeUtf8(_){return this.writeBytes((0,o.encode)(_))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}}),"./node_modules/iobuffer/lib-esm/text-encoding-polyfill.js":(function(){(function(e){if(e.TextEncoder&&e.TextDecoder)return!1;function r(o="utf-8"){if(o!=="utf-8")throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${o}') is invalid.`)}Object.defineProperty(r.prototype,"encoding",{value:"utf-8"}),r.prototype.encode=function(o,c={stream:!1}){if(c.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let u=0;const v=o.length;let f=0,g=Math.max(32,v+(v>>1)+7),_=new Uint8Array(g>>3<<3);for(;u<v;){let p=o.charCodeAt(u++);if(p>=55296&&p<=56319){if(u<v){const E=o.charCodeAt(u);(E&64512)===56320&&(++u,p=((p&1023)<<10)+(E&1023)+65536)}if(p>=55296&&p<=56319)continue}if(f+4>_.length){g+=8,g*=1+u/o.length*2,g=g>>3<<3;const E=new Uint8Array(g);E.set(_),_=E}if(p&4294967168)if(!(p&4294965248))_[f++]=p>>6&31|192;else if(!(p&4294901760))_[f++]=p>>12&15|224,_[f++]=p>>6&63|128;else if(!(p&4292870144))_[f++]=p>>18&7|240,_[f++]=p>>12&63|128,_[f++]=p>>6&63|128;else continue;else{_[f++]=p;continue}_[f++]=p&63|128}return _.slice(0,f)};function t(o="utf-8",c={fatal:!1}){if(o!=="utf-8")throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${o}') is invalid.`);if(c.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(t.prototype,"fatal",{value:!1}),Object.defineProperty(t.prototype,"ignoreBOM",{value:!1}),t.prototype.decode=function(o,c={stream:!1}){if(c.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const u=new Uint8Array(o);let v=0;const f=u.length,g=[];for(;v<f;){const _=u[v++];if(_===0)break;if(!(_&128))g.push(_);else if((_&224)===192){const p=u[v++]&63;g.push((_&31)<<6|p)}else if((_&240)===224){const p=u[v++]&63,E=u[v++]&63;g.push((_&31)<<12|p<<6|E)}else if((_&248)===240){const p=u[v++]&63,E=u[v++]&63,k=u[v++]&63;let A=(_&7)<<18|p<<12|E<<6|k;A>65535&&(A-=65536,g.push(A>>>10&1023|55296),A=56320|A&1023),g.push(A)}}return String.fromCharCode.apply(null,g)},e.TextEncoder=r,e.TextDecoder=t})(typeof window<"u"?window:typeof self<"u"?self:this)}),"./node_modules/iobuffer/lib-esm/text.browser.js":((e,r,t)=>{t.r(r),t.d(r,{decode:()=>o,encode:()=>u}),t("./node_modules/iobuffer/lib-esm/text-encoding-polyfill.js");function o(v,f="utf8"){return new TextDecoder(f).decode(v)}const c=new TextEncoder;function u(v){return c.encode(v)}}),"./node_modules/netcdfjs/lib-esm/data.js":((e,r,t)=>{t.r(r),t.d(r,{nonRecord:()=>c,record:()=>u});var o=t("./node_modules/netcdfjs/lib-esm/types.js");function c(v,f){const g=(0,o.str2num)(f.type),_=f.size/(0,o.num2bytes)(g),p=new Array(_);for(let E=0;E<_;E++)p[E]=(0,o.readType)(v,g,1);return p}function u(v,f,g){const _=(0,o.str2num)(f.type),p=f.size?f.size/(0,o.num2bytes)(_):1,E=g.length,k=new Array(E),A=g.recordStep;if(A)for(let z=0;z<E;z++){const l=v.offset;k[z]=(0,o.readType)(v,_,p),v.seek(l+A)}else throw new Error("recordDimension.recordStep is undefined");return k}}),"./node_modules/netcdfjs/lib-esm/header.js":((e,r,t)=>{t.r(r),t.d(r,{header:()=>p});var o=t("./node_modules/netcdfjs/lib-esm/types.js"),c=t("./node_modules/netcdfjs/lib-esm/utils.js");const u=0,v=10,f=11,g=12,_=0;function p(z,l){const s={version:l},y={length:z.readUint32()},w=E(z);Array.isArray(w)||(y.id=w.recordId,y.name=w.recordName,s.dimensions=w.dimensions),s.globalAttributes=k(z);const S=A(z,y?.id,l);return Array.isArray(S)||(s.variables=S.variables,y.recordStep=S.recordStep),s.recordDimension=y,s}function E(z){const l={};let s,y;const w=z.readUint32();let S;if(w===u)return(0,c.notNetcdf)(z.readUint32()!==u,"wrong empty tag for list of dimensions"),[];{(0,c.notNetcdf)(w!==v,"wrong tag for list of dimensions");const C=z.readUint32();S=new Array(C);for(let h=0;h<C;h++){const x=(0,c.readName)(z),R=z.readUint32();R===_&&(s=h,y=x),S[h]={name:x,size:R}}}return s!==void 0&&(l.recordId=s),y!==void 0&&(l.recordName=y),l.dimensions=S,l}function k(z){const l=z.readUint32();let s;if(l===u)return(0,c.notNetcdf)(z.readUint32()!==u,"wrong empty tag for list of attributes"),[];{(0,c.notNetcdf)(l!==g,"wrong tag for list of attributes");const y=z.readUint32();s=new Array(y);for(let w=0;w<y;w++){const S=(0,c.readName)(z),C=z.readUint32();(0,c.notNetcdf)(C<1||C>6,`non valid type ${C}`);const h=z.readUint32(),x=(0,o.readType)(z,C,h);(0,c.padding)(z),s[w]={name:S,type:(0,o.num2str)(C),value:x}}}return s}function A(z,l,s){const y=z.readUint32();let w=0,S;if(y===u)return(0,c.notNetcdf)(z.readUint32()!==u,"wrong empty tag for list of variables"),[];{(0,c.notNetcdf)(y!==f,"wrong tag for list of variables");const C=z.readUint32();S=new Array(C);for(let h=0;h<C;h++){const x=(0,c.readName)(z),R=z.readUint32(),M=new Array(R);for(let j=0;j<R;j++)M[j]=z.readUint32();const P=k(z),D=z.readUint32();(0,c.notNetcdf)(D<1&&D>6,`non valid type ${D}`);const L=z.readUint32();let X=z.readUint32();s===2&&((0,c.notNetcdf)(X>0,"offsets larger than 4GB not supported"),X=z.readUint32());let B=!1;typeof l<"u"&&M[0]===l&&(w+=L,B=!0),S[h]={name:x,dimensions:M,attributes:P,type:(0,o.num2str)(D),size:L,offset:X,record:B}}}return{variables:S,recordStep:w}}}),"./node_modules/netcdfjs/lib-esm/index.js":((e,r,t)=>{t.r(r),t.d(r,{NetCDFReader:()=>o.NetCDFReader});var o=t("./node_modules/netcdfjs/lib-esm/parser.js")}),"./node_modules/netcdfjs/lib-esm/parser.js":((e,r,t)=>{t.r(r),t.d(r,{NetCDFReader:()=>g});var o=t("./node_modules/iobuffer/lib-esm/IOBuffer.js"),c=t("./node_modules/netcdfjs/lib-esm/data.js"),u=t("./node_modules/netcdfjs/lib-esm/header.js"),v=t("./node_modules/netcdfjs/lib-esm/toString.js"),f=t("./node_modules/netcdfjs/lib-esm/utils.js");class g{constructor(p){this.toString=v.toString;const E=new o.IOBuffer(p);E.setBigEndian(),(0,f.notNetcdf)(E.readChars(3)!=="CDF","should start with CDF");const k=E.readByte();(0,f.notNetcdf)(k>2,"unknown version"),this.header=(0,u.header)(E,k),this.buffer=E}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(p){const E=this.globalAttributes.find(k=>k.name===p);return E?E.value:null}getDataVariableAsString(p){const E=this.getDataVariable(p);return E?E.join(""):null}get variables(){return this.header.variables}getDataVariable(p){let E;if(typeof p=="string"?E=this.header.variables.find(k=>k.name===p):E=p,E===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(E.offset),E.record?(0,c.record)(this.buffer,E,this.header.recordDimension):(0,c.nonRecord)(this.buffer,E)}dataVariableExists(p){return this.header.variables.find(E=>E.name===p)!==void 0}attributeExists(p){return this.globalAttributes.find(E=>E.name===p)!==void 0}}}),"./node_modules/netcdfjs/lib-esm/toString.js":((e,r,t)=>{t.r(r),t.d(r,{toString:()=>o});function o(){const c=[];c.push("DIMENSIONS");for(const v of this.dimensions)c.push(`  ${v.name.padEnd(30)} = size: ${v.size}`);c.push(""),c.push("GLOBAL ATTRIBUTES");for(const v of this.globalAttributes)c.push(`  ${v.name.padEnd(30)} = ${v.value}`);const u=JSON.parse(JSON.stringify(this.variables));c.push(""),c.push("VARIABLES:");for(const v of u){v.value=this.getDataVariable(v);let f=JSON.stringify(v.value);f.length>50&&(f=f.substring(0,50)),isNaN(v.value.length)||(f+=` (length: ${v.value.length})`),c.push(`  ${v.name.padEnd(30)} = ${f}`)}return c.join(`
`)}}),"./node_modules/netcdfjs/lib-esm/types.js":((e,r,t)=>{t.r(r),t.d(r,{num2bytes:()=>u,num2str:()=>c,readType:()=>g,str2num:()=>v});const o={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function c(p){switch(Number(p)){case o.BYTE:return"byte";case o.CHAR:return"char";case o.SHORT:return"short";case o.INT:return"int";case o.FLOAT:return"float";case o.DOUBLE:return"double";default:return"undefined"}}function u(p){switch(Number(p)){case o.BYTE:return 1;case o.CHAR:return 1;case o.SHORT:return 2;case o.INT:return 4;case o.FLOAT:return 4;case o.DOUBLE:return 8;default:return-1}}function v(p){switch(String(p)){case"byte":return o.BYTE;case"char":return o.CHAR;case"short":return o.SHORT;case"int":return o.INT;case"float":return o.FLOAT;case"double":return o.DOUBLE;default:return-1}}function f(p,E){if(p!==1){const k=new Array(p);for(let A=0;A<p;A++)k[A]=E();return k}else return E()}function g(p,E,k){switch(E){case o.BYTE:return Array.from(p.readBytes(k));case o.CHAR:return _(p.readChars(k));case o.SHORT:return f(k,p.readInt16.bind(p));case o.INT:return f(k,p.readInt32.bind(p));case o.FLOAT:return f(k,p.readFloat32.bind(p));case o.DOUBLE:return f(k,p.readFloat64.bind(p));default:throw new Error(`non valid type ${E}`)}}function _(p){return p.charCodeAt(p.length-1)===0?p.substring(0,p.length-1):p}}),"./node_modules/netcdfjs/lib-esm/utils.js":((e,r,t)=>{t.r(r),t.d(r,{notNetcdf:()=>o,padding:()=>c,readName:()=>u});function o(v,f){if(v)throw new TypeError(`Not a valid NetCDF v3.x file: ${f}`)}function c(v){v.offset%4!==0&&v.skip(4-v.offset%4)}function u(v){const f=v.readUint32(),g=v.readChars(f);return c(v),g}}),"./src/WebGL/shaders/lib/basic/basic.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;
    float fogFactor = smoothstep( fogNear, fogFar, depth );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
}`}),"./src/WebGL/shaders/lib/basic/basic.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`}),"./src/WebGL/shaders/lib/blur/blur.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`}),"./src/WebGL/shaders/lib/blur/blur.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/instanced/instanced.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`}),"./src/WebGL/shaders/lib/instanced/instanced.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`}),"./src/WebGL/shaders/lib/lambert/lambert.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}`}),"./src/WebGL/shaders/lib/lambert/lambert.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`}),"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`}),"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`}),"./src/WebGL/shaders/lib/outline/outline.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );
}


`}),"./src/WebGL/shaders/lib/outline/outline.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    gl_Position = projectionMatrix * mvPosition;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`}),"./src/WebGL/shaders/lib/screen/screen.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `}),"./src/WebGL/shaders/lib/screen/screen.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/screenaa/screenaa.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec3 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP).xyz;
    vec3 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP).xyz;
    vec3 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP).xyz;
    vec3 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP).xyz;
    vec3 rgbM  = texture2D(tex, fragCoord  * inverseVP).xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)).xyz +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5).xyz +
        texture2D(tex, fragCoord  + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, 1.0);
    else
        color = vec4(rgbB, 1.0);
    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        `}),"./src/WebGL/shaders/lib/screenaa/screenaa.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    float fogFactor = smoothstep( fogNear, fogFar, gl_FragDepthEXT/gl_FragCoord.w );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );


}

`}),"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`}),"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );
}


`}),"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);
    vec4 adjust = projectionMatrix* vec4(norm,normal.z,0.0); adjust.z = 0.0; adjust.w = 0.0;
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+adjust;
}

`}),"./src/WebGL/shaders/lib/sprite/sprite.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform int fogType;
uniform vec3 fogColor;
uniform float fogDensity;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogType > 0) {

        float depth = gl_FragCoord.z / gl_FragCoord.w;
        float fogFactor = 0.0;

        if (fogType == 1) {
            fogFactor = smoothstep(fogNear, fogFar, depth);
        }

        else {
            const float LOG2 = 1.442695;
            float fogFactor = exp2(- fogDensity * fogDensity * depth * depth * LOG2);
            fogFactor = 1.0 - clamp(fogFactor, 0.0, 1.0);
        }

        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);

    }
}

`}),"./src/WebGL/shaders/lib/sprite/sprite.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`}),"./src/WebGL/shaders/lib/ssao/ssao.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`}),"./src/WebGL/shaders/lib/ssao/ssao.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    float fogFactor = smoothstep( fogNear, fogFar, depth );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
}`}),"./src/WebGL/shaders/lib/stickimposter/stickimposter.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(projectionMatrix[3][3] == 0.0) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(projectionMatrix[3][3] == 0.0) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }
    vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
    mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`}),"./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`}),"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    to.xyz += normalize(to.xyz)*outlinePushback;
    pt.xyz += normalize(pt.xyz)*outlinePushback;

    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }
    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`}),"./src/WebGL/shaders/lib/volumetric/volumetric.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `}),"./src/WebGL/shaders/lib/volumetric/volumetric.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>o});const o=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`}),"./src/GLDraw.ts":((e,r,t)=>{t.r(r),t.d(r,{CAP:()=>c,GLDraw:()=>u});var o=t("./src/WebGL/math/index.ts"),c;(function(v){v[v.NONE=0]="NONE",v[v.FLAT=1]="FLAT",v[v.ROUND=2]="ROUND"})(c||(c={}));var u;(function(v){function f(l,s,y){var w=Math.hypot(l,s),S,C,h,x,R;w<1e-4?(C=0,h=1):(C=-l/w,h=s/w),s=-C*l+h*s,S=Math.hypot(s,y),S<1e-4?(x=0,R=1):(x=y/S,R=s/S);var M=new Float32Array(9);return M[0]=h,M[1]=C,M[2]=0,M[3]=-C*R,M[4]=h*R,M[5]=x,M[6]=C*x,M[7]=-h*x,M[8]=R,M}class g{constructor(){this.cache={};let s=[],y=4,w=Math.pow(2,y),S=2,C=Math.pow(2,S),h=w/C,x;for(s[0]=new o.Vector3(-1,0,0),s[h]=new o.Vector3(0,0,1),s[h*2]=new o.Vector3(1,0,0),s[h*3]=new o.Vector3(0,0,-1),S=3;S<=y;S++){for(C=Math.pow(2,S-1),h=w/C,x=0;x<C-1;x++)s[h/2+x*h]=s[x*h].clone().add(s[(x+1)*h]).normalize();x=C-1,s[h/2+x*h]=s[x*h].clone().add(s[0]).normalize()}this.basisVectors=s}getVerticesForRadius(s,y,w){if(typeof this.cache<"u"&&this.cache[s]!==void 0&&this.cache[s][y+w]!==void 0)return this.cache[s][y+w];for(var S=this.basisVectors.length,C=[],h=[],x,R=0;R<S;R++)C.push(this.basisVectors[R].clone().multiplyScalar(s)),C.push(this.basisVectors[R].clone().multiplyScalar(s)),x=this.basisVectors[R].clone().normalize(),h.push(x),h.push(x);var M=[],P=10,D=S,L=0,X=Math.PI*2,B=0,j=Math.PI,H,$,q=!1,W=!1;for($=0;$<=P;$++){q=$===0||$===P,W=$===P/2;var Y=[],G=[];for(H=0;H<=D;H++){if(W){var V=H<D?2*H:0;G.push(V+1),Y.push(V);continue}var Z=H/D,xe=$/P;if(!q||H===0)if(H<D){var ce=new o.Vector3;ce.x=-s*Math.cos(L+Z*X)*Math.sin(B+xe*j),y==1?ce.y=0:ce.y=s*Math.cos(B+xe*j),ce.z=s*Math.sin(L+Z*X)*Math.sin(B+xe*j),Math.abs(ce.x)<1e-5&&(ce.x=0),Math.abs(ce.y)<1e-5&&(ce.y=0),Math.abs(ce.z)<1e-5&&(ce.z=0),y==c.FLAT?(x=new o.Vector3(0,Math.cos(B+xe*j),0),x.normalize()):(x=new o.Vector3(ce.x,ce.y,ce.z),x.normalize()),C.push(ce),h.push(x),Y.push(C.length-1)}else Y.push(C.length-D);else q&&Y.push(C.length-1)}W&&M.push(G),M.push(Y)}var Ne={vertices:C,normals:h,verticesRows:M,w:D,h:P};return s in this.cache||(this.cache[s]={}),this.cache[s][y+w]=Ne,Ne}}var _=new g;function p(l,s,y,w,S,C=0,h=0){if(!s||!y)return;let x=function(vt){if(typeof vt=="string"){let Qr=vt;return Qr.toLowerCase()=="flat"?c.FLAT:Qr.toLowerCase()=="round"?c.ROUND:c.NONE}else return vt};C=x(C),h=x(h);var R=h||C;S=S||{r:0,g:0,b:0};var M=f(y.x-s.x,y.y-s.y,y.z-s.z),P=_.getVerticesForRadius(w,h,"to"),D=P.w,L=P.h,X=R?L*D+2:2*D,B=l.updateGeoGroup(X),j=P.vertices,H=P.normals,$=P.verticesRows,q=$[L/2],W=$[L/2+1],Y=B.vertices,G,V,Z,xe,ce,Ne,Pe=B.vertexArray,De=B.normalArray,Me=B.colorArray,Be=B.faceArray;for(Z=0;Z<D;++Z){var ft=2*Z;xe=M[0]*j[ft].x+M[3]*j[ft].y+M[6]*j[ft].z,ce=M[1]*j[ft].x+M[4]*j[ft].y+M[7]*j[ft].z,Ne=M[5]*j[ft].y+M[8]*j[ft].z,G=3*(Y+ft),V=B.faceidx,Pe[G]=xe+s.x,Pe[G+1]=ce+s.y,Pe[G+2]=Ne+s.z,Pe[G+3]=xe+y.x,Pe[G+4]=ce+y.y,Pe[G+5]=Ne+y.z,De[G]=xe,De[G+3]=xe,De[G+1]=ce,De[G+4]=ce,De[G+2]=Ne,De[G+5]=Ne,Me[G]=S.r,Me[G+3]=S.r,Me[G+1]=S.g,Me[G+4]=S.g,Me[G+2]=S.b,Me[G+5]=S.b,Be[V]=W[Z]+Y,Be[V+1]=W[Z+1]+Y,Be[V+2]=q[Z]+Y,Be[V+3]=q[Z]+Y,Be[V+4]=W[Z+1]+Y,Be[V+5]=q[Z+1]+Y,B.faceidx+=6}if(R){var jt=h?0:L/2,Gt=C?L+1:L/2+1,mt,Fe,ht,Kt,Jt,Wt,Br,zr,cr,Nr,At,Mt,Jr,Yr,ie,ve,we,it,rt,Yt,Ft,re,tt,lt,ar,et,Ot,se,xt,Vr,J,ut;for(ce=jt;ce<Gt;ce++)if(ce!==L/2){var at=ce<=L/2?y:s,me=_.getVerticesForRadius(w,h,"to"),Ze=_.getVerticesForRadius(w,C,"from");for(at===y?(j=me.vertices,H=me.normals,$=me.verticesRows):at==s&&(j=Ze.vertices,H=Ze.normals,$=Ze.verticesRows),xe=0;xe<D;xe++)V=B.faceidx,mt=$[ce][xe+1],xt=(mt+Y)*3,Fe=$[ce][xe],Vr=(Fe+Y)*3,ht=$[ce+1][xe],J=(ht+Y)*3,Kt=$[ce+1][xe+1],ut=(Kt+Y)*3,Jt=M[0]*j[mt].x+M[3]*j[mt].y+M[6]*j[mt].z,Wt=M[0]*j[Fe].x+M[3]*j[Fe].y+M[6]*j[Fe].z,Br=M[0]*j[ht].x+M[3]*j[ht].y+M[6]*j[ht].z,zr=M[0]*j[Kt].x+M[3]*j[Kt].y+M[6]*j[Kt].z,cr=M[1]*j[mt].x+M[4]*j[mt].y+M[7]*j[mt].z,Nr=M[1]*j[Fe].x+M[4]*j[Fe].y+M[7]*j[Fe].z,At=M[1]*j[ht].x+M[4]*j[ht].y+M[7]*j[ht].z,Mt=M[1]*j[Kt].x+M[4]*j[Kt].y+M[7]*j[Kt].z,Jr=M[5]*j[mt].y+M[8]*j[mt].z,Yr=M[5]*j[Fe].y+M[8]*j[Fe].z,ie=M[5]*j[ht].y+M[8]*j[ht].z,ve=M[5]*j[Kt].y+M[8]*j[Kt].z,Pe[xt]=Jt+at.x,Pe[Vr]=Wt+at.x,Pe[J]=Br+at.x,Pe[ut]=zr+at.x,Pe[xt+1]=cr+at.y,Pe[Vr+1]=Nr+at.y,Pe[J+1]=At+at.y,Pe[ut+1]=Mt+at.y,Pe[xt+2]=Jr+at.z,Pe[Vr+2]=Yr+at.z,Pe[J+2]=ie+at.z,Pe[ut+2]=ve+at.z,Me[xt]=S.r,Me[Vr]=S.r,Me[J]=S.r,Me[ut]=S.r,Me[xt+1]=S.g,Me[Vr+1]=S.g,Me[J+1]=S.g,Me[ut+1]=S.g,Me[xt+2]=S.b,Me[Vr+2]=S.b,Me[J+2]=S.b,Me[ut+2]=S.b,we=M[0]*H[mt].x+M[3]*H[mt].y+M[6]*H[mt].z,it=M[0]*H[Fe].x+M[3]*H[Fe].y+M[6]*H[Fe].z,rt=M[0]*H[ht].x+M[3]*H[ht].y+M[6]*H[ht].z,Yt=M[0]*H[Kt].x+M[3]*H[Kt].y+M[6]*H[Kt].z,Ft=M[1]*H[mt].x+M[4]*H[mt].y+M[7]*H[mt].z,re=M[1]*H[Fe].x+M[4]*H[Fe].y+M[7]*H[Fe].z,tt=M[1]*H[ht].x+M[4]*H[ht].y+M[7]*H[ht].z,lt=M[1]*H[Kt].x+M[4]*H[Kt].y+M[7]*H[Kt].z,ar=M[5]*H[mt].y+M[8]*H[mt].z,et=M[5]*H[Fe].y+M[8]*H[Fe].z,Ot=M[5]*H[ht].y+M[8]*H[ht].z,se=M[5]*H[Kt].y+M[8]*H[Kt].z,ce===0?(De[xt]=we,De[J]=rt,De[ut]=Yt,De[xt+1]=Ft,De[J+1]=tt,De[ut+1]=lt,De[xt+2]=ar,De[J+2]=Ot,De[ut+2]=se,Be[V]=mt+Y,Be[V+1]=ht+Y,Be[V+2]=Kt+Y,B.faceidx+=3):ce===Gt-1?(De[xt]=we,De[Vr]=it,De[J]=rt,De[xt+1]=Ft,De[Vr+1]=re,De[J+1]=tt,De[xt+2]=ar,De[Vr+2]=et,De[J+2]=Ot,Be[V]=mt+Y,Be[V+1]=Fe+Y,Be[V+2]=ht+Y,B.faceidx+=3):(De[xt]=we,De[Vr]=it,De[ut]=Yt,De[xt+1]=Ft,De[Vr+1]=re,De[ut+1]=lt,De[xt+2]=ar,De[Vr+2]=et,De[ut+2]=se,De[Vr]=it,De[J]=rt,De[ut]=Yt,De[Vr+1]=re,De[J+1]=tt,De[ut+1]=lt,De[Vr+2]=et,De[J+2]=Ot,De[ut+2]=se,Be[V]=mt+Y,Be[V+1]=Fe+Y,Be[V+2]=Kt+Y,Be[V+3]=Fe+Y,Be[V+4]=ht+Y,Be[V+5]=Kt+Y,B.faceidx+=6)}}B.vertices+=X}v.drawCylinder=p;function E(l,s,y,w,S){if(!s||!y)return;S=S||{r:0,g:0,b:0};let C=new o.Vector3(y.x-s.x,y.y-s.y,y.z-s.z);var h=f(C.x,C.y,C.z);C=C.normalize();var x=_.basisVectors.length,R=_.basisVectors,M=x+2,P=l.updateGeoGroup(M),D=P.vertices,L,X,B,j,H,$,q=P.vertexArray,W=P.normalArray,Y=P.colorArray,G=P.faceArray;for(L=D*3,q[L]=s.x,q[L+1]=s.y,q[L+2]=s.z,W[L]=-C.x,W[L+1]=-C.y,W[L+2]=-C.z,Y[L]=S.r,Y[L+1]=S.g,Y[L+2]=S.b,q[L+3]=y.x,q[L+4]=y.y,q[L+5]=y.z,W[L+3]=C.x,W[L+4]=C.y,W[L+5]=C.z,Y[L+3]=S.r,Y[L+4]=S.g,Y[L+5]=S.b,L+=6,B=0;B<x;++B){var V=R[B].clone();V.multiplyScalar(w),j=h[0]*V.x+h[3]*V.y+h[6]*V.z,H=h[1]*V.x+h[4]*V.y+h[7]*V.z,$=h[5]*V.y+h[8]*V.z,q[L]=j+s.x,q[L+1]=H+s.y,q[L+2]=$+s.z,W[L]=j,W[L+1]=H,W[L+2]=$,Y[L]=S.r,Y[L+1]=S.g,Y[L+2]=S.b,L+=3}for(P.vertices+=x+2,X=P.faceidx,B=0;B<x;B++){var Z=D+2+B,xe=D+2+(B+1)%x;G[X]=Z,G[X+1]=xe,G[X+2]=D,X+=3,G[X]=Z,G[X+1]=xe,G[X+2]=D+1,X+=3}P.faceidx+=6*x}v.drawCone=E;class k{constructor(){this.cache=new Map}getVerticesForRadius(s,y){y=y||2,this.cache.has(y)||this.cache.set(y,new Map);let w=this.cache.get(y);if(w.has(s))return w.get(s);var S={vertices:[],verticesRows:[],normals:[]},C=16*y,h=10*y;s<1&&(C=10*y,h=8*y);var x=0,R=Math.PI*2,M=0,P=Math.PI,D,L;for(L=0;L<=h;L++){let B=[];for(D=0;D<=C;D++){let j=D/C,H=L/h,$=-s*Math.cos(x+j*R)*Math.sin(M+H*P),q=s*Math.cos(M+H*P),W=s*Math.sin(x+j*R)*Math.sin(M+H*P);var X=new o.Vector3($,q,W);X.normalize(),S.vertices.push({x:$,y:q,z:W}),S.normals.push(X),B.push(S.vertices.length-1)}S.verticesRows.push(B)}return w.set(s,S),S}}var A=new k;function z(l,s,y,w,S){var C=A.getVerticesForRadius(y,S),h=C.vertices,x=C.normals,R=l.updateGeoGroup(h.length),M=R.vertices,P=R.vertexArray,D=R.colorArray,L=R.faceArray,X=R.lineArray,B=R.normalArray;for(let $=0,q=h.length;$<q;++$){let W=3*(M+$),Y=h[$];P[W]=Y.x+s.x,P[W+1]=Y.y+s.y,P[W+2]=Y.z+s.z,D[W]=w.r,D[W+1]=w.g,D[W+2]=w.b}R.vertices+=h.length;let j=C.verticesRows,H=j.length-1;for(let $=0;$<H;$++){let q=j[$].length-1;for(let W=0;W<q;W++){let Y=R.faceidx,G=R.lineidx,V=j[$][W+1]+M,Z=V*3,xe=j[$][W]+M,ce=xe*3,Ne=j[$+1][W]+M,Pe=Ne*3,De=j[$+1][W+1]+M,Me=De*3,Be=x[V-M],ft=x[xe-M],jt=x[Ne-M],Gt=x[De-M];Math.abs(h[V-M].y)===y?(B[Z]=Be.x,B[Pe]=jt.x,B[Me]=Gt.x,B[Z+1]=Be.y,B[Pe+1]=jt.y,B[Me+1]=Gt.y,B[Z+2]=Be.z,B[Pe+2]=jt.z,B[Me+2]=Gt.z,L[Y]=V,L[Y+1]=Ne,L[Y+2]=De,X[G]=V,X[G+1]=Ne,X[G+2]=V,X[G+3]=De,X[G+4]=Ne,X[G+5]=De,R.faceidx+=3,R.lineidx+=6):Math.abs(h[Ne-M].y)===y?(B[Z]=Be.x,B[ce]=ft.x,B[Pe]=jt.x,B[Z+1]=Be.y,B[ce+1]=ft.y,B[Pe+1]=jt.y,B[Z+2]=Be.z,B[ce+2]=ft.z,B[Pe+2]=jt.z,L[Y]=V,L[Y+1]=xe,L[Y+2]=Ne,X[G]=V,X[G+1]=xe,X[G+2]=V,X[G+3]=Ne,X[G+4]=xe,X[G+5]=Ne,R.faceidx+=3,R.lineidx+=6):(B[Z]=Be.x,B[ce]=ft.x,B[Me]=Gt.x,B[Z+1]=Be.y,B[ce+1]=ft.y,B[Me+1]=Gt.y,B[Z+2]=Be.z,B[ce+2]=ft.z,B[Me+2]=Gt.z,B[ce]=ft.x,B[Pe]=jt.x,B[Me]=Gt.x,B[ce+1]=ft.y,B[Pe+1]=jt.y,B[Me+1]=Gt.y,B[ce+2]=ft.z,B[Pe+2]=jt.z,B[Me+2]=Gt.z,L[Y]=V,L[Y+1]=xe,L[Y+2]=De,L[Y+3]=xe,L[Y+4]=Ne,L[Y+5]=De,X[G]=V,X[G+1]=xe,X[G+2]=V,X[G+3]=De,X[G+4]=xe,X[G+5]=Ne,X[G+6]=Ne,X[G+7]=De,R.faceidx+=6,R.lineidx+=8)}}}v.drawSphere=z})(u||(u={}))}),"./src/GLModel.ts":((e,r,t)=>{t.r(r),t.d(r,{GLModel:()=>z});var o=t("./src/WebGL/index.ts"),c=t("./src/WebGL/shapes/index.ts"),u=t("./src/WebGL/math/index.ts"),v=t("./src/colors.ts"),f=t("./src/GLDraw.ts"),g=t("./src/glcartoon.ts"),_=t("./src/utilities.ts"),p=t("./src/Gradient.ts"),E=t("./src/parsers/index.ts"),k=t("./node_modules/netcdfjs/lib-esm/index.js"),A=t("./src/parsers/utils/assignBonds.ts");class z{static sameObj(s,y){return s&&y?JSON.stringify(s)==JSON.stringify(y):s==y}constructor(s,y){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new u.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=v.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=y||{},this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:v.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=s}getRadiusFromStyle(s,y){var w=this.defaultSphereRadius;if(typeof y.radius<"u")w=y.radius;else if(z.vdwRadii[s.elem])w=z.vdwRadii[s.elem];else if(s.elem.length>1){let S=s.elem;S=S[0].toUpperCase()+S[1].toLowerCase(),z.vdwRadii[S]&&(w=z.vdwRadii[S])}return typeof y.scale<"u"&&(w*=y.scale),w}drawAtomCross(s,y){if(s.style.cross){var w=s.style.cross;if(!w.hidden){var S=w.linewidth||z.defaultlineWidth;y[S]||(y[S]=new o.Geometry);var C=y[S].updateGeoGroup(6),h=this.getRadiusFromStyle(s,w),x=[[h,0,0],[-h,0,0],[0,h,0],[0,-h,0],[0,0,h],[0,0,-h]],R=s.clickable||s.hoverable;R&&s.intersectionShape===void 0&&(s.intersectionShape={sphere:[],cylinder:[],line:[]});for(var M=(0,_.getColorFromStyle)(s,w),P=C.vertexArray,D=C.colorArray,L=0;L<6;L++){var X=C.vertices*3;if(C.vertices++,P[X]=s.x+x[L][0],P[X+1]=s.y+x[L][1],P[X+2]=s.z+x[L][2],D[X]=M.r,D[X+1]=M.g,D[X+2]=M.b,R){var B=new u.Vector3(x[L][0],x[L][1],x[L][2]);B.multiplyScalar(.1),B.set(B.x+s.x,B.y+s.y,B.z+s.z),s.intersectionShape.line.push(B)}}}}}getGoodCross(s,y,w,S){for(var C=null,h=-1,x=0,R=s.bonds.length;x<R;x++)if(s.bonds[x]!=y.index){let P=s.bonds[x],D=this.atoms[P],L=new u.Vector3(D.x,D.y,D.z).clone();L.sub(w);let X=L.clone();X.cross(S);var M=X.lengthSq();if(M>h&&(h=M,C=X,h>.1))return C}return C}getSideBondV(s,y,w){var S,C,h,x,R,M=new u.Vector3(s.x,s.y,s.z),P=new u.Vector3(y.x,y.y,y.z),D=P.clone(),L=null;if(D.sub(M),s.bonds.length===1)y.bonds.length===1?(L=D.clone(),Math.abs(L.x)>1e-4?L.y+=1:L.x+=1):(S=(w+1)%y.bonds.length,C=y.bonds[S],h=this.atoms[C],h.index==s.index&&(S=(S+1)%y.bonds.length,C=y.bonds[S],h=this.atoms[C]),x=new u.Vector3(h.x,h.y,h.z),R=x.clone(),R.sub(M),L=R.clone(),L.cross(D));else if(L=this.getGoodCross(s,y,M,D),L.lengthSq()<.01){var X=this.getGoodCross(y,s,M,D);X!=null&&(L=X)}return L.lengthSq()<.01&&(L=D.clone(),Math.abs(L.x)>1e-4?L.y+=1:L.x+=1),L.cross(D),L.normalize(),L}addLine(s,y,w,S,C,h){s[w]=S.x,s[w+1]=S.y,s[w+2]=S.z,y[w]=h.r,y[w+1]=h.g,y[w+2]=h.b,s[w+3]=C.x,s[w+4]=C.y,s[w+5]=C.z,y[w+3]=h.r,y[w+4]=h.g,y[w+5]=h.b}drawBondLines(s,y,w){if(s.style.line){var S=s.style.line;if(!S.hidden){var C,h,x,R,M=S.linewidth||z.defaultlineWidth;w[M]||(w[M]=new o.Geometry);for(var P=w[M].updateGeoGroup(6*s.bonds.length),D=P.vertexArray,L=P.colorArray,X=0;X<s.bonds.length;X++){var B=s.bonds[X],j=y[B];if(j.style.line&&!(s.index>=j.index)){var H=new u.Vector3(s.x,s.y,s.z),$=new u.Vector3(j.x,j.y,j.z),q=H.clone().add($).multiplyScalar(.5),W=!1,Y=s.clickable||s.hoverable,G=j.clickable||j.hoverable;(Y||G)&&(Y&&(s.intersectionShape===void 0&&(s.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),s.intersectionShape.line.push(H),s.intersectionShape.line.push(q)),G&&(j.intersectionShape===void 0&&(j.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),j.intersectionShape.line.push(q),j.intersectionShape.line.push($)));var V=(0,_.getColorFromStyle)(s,s.style.line),Z=(0,_.getColorFromStyle)(j,j.style.line);if(s.bondStyles&&s.bondStyles[X]){var xe=s.bondStyles[X];if(!xe.iswire)continue;xe.singleBond&&(W=!0),typeof xe.color1<"u"&&(V=v.CC.color(xe.color1)),typeof xe.color2<"u"&&(Z=v.CC.color(xe.color2))}var ce=P.vertices*3,Ne,Pe;if(s.bondOrder[X]>1&&s.bondOrder[X]<4&&!W){var De=this.getSideBondV(s,j,X),Me=$.clone();Me.sub(H),s.bondOrder[X]==2?(De.multiplyScalar(.1),C=H.clone(),C.add(De),h=H.clone(),h.sub(De),x=C.clone(),x.add(Me),R=h.clone(),R.add(Me),V==Z?(P.vertices+=4,this.addLine(D,L,ce,C,x,V),this.addLine(D,L,ce+6,h,R,V)):(P.vertices+=8,Me.multiplyScalar(.5),Ne=C.clone(),Ne.add(Me),Pe=h.clone(),Pe.add(Me),this.addLine(D,L,ce,C,Ne,V),this.addLine(D,L,ce+6,Ne,x,Z),this.addLine(D,L,ce+12,h,Pe,V),this.addLine(D,L,ce+18,Pe,R,Z))):s.bondOrder[X]==3&&(De.multiplyScalar(.1),C=H.clone(),C.add(De),h=H.clone(),h.sub(De),x=C.clone(),x.add(Me),R=h.clone(),R.add(Me),V==Z?(P.vertices+=6,this.addLine(D,L,ce,H,$,V),this.addLine(D,L,ce+6,C,x,V),this.addLine(D,L,ce+12,h,R,V)):(P.vertices+=12,Me.multiplyScalar(.5),Ne=C.clone(),Ne.add(Me),Pe=h.clone(),Pe.add(Me),this.addLine(D,L,ce,H,q,V),this.addLine(D,L,ce+6,q,$,Z),this.addLine(D,L,ce+12,C,Ne,V),this.addLine(D,L,ce+18,Ne,x,Z),this.addLine(D,L,ce+24,h,Pe,V),this.addLine(D,L,ce+30,Pe,R,Z)))}else V==Z?(P.vertices+=2,this.addLine(D,L,ce,H,$,V)):(P.vertices+=4,this.addLine(D,L,ce,H,q,V),this.addLine(D,L,ce+6,q,$,Z))}}}}}drawAtomSphere(s,y){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var S=(0,_.getColorFromStyle)(s,w),C=this.getRadiusFromStyle(s,w);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var h=new u.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(h,C))}f.GLDraw.drawSphere(y,s,C,S)}}}drawAtomClickSphere(s){if(s.style.clicksphere){var y=s.style.clicksphere;if(!y.hidden){var w=this.getRadiusFromStyle(s,y);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var S=new u.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(S,w))}}}}drawAtomInstanced(s,y){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var S=this.getRadiusFromStyle(s,w),C=(0,_.getColorFromStyle)(s,w),h=y.updateGeoGroup(1),x=h.vertices,R=x*3,M=h.vertexArray,P=h.colorArray,D=h.radiusArray;if(M[R]=s.x,M[R+1]=s.y,M[R+2]=s.z,P[R]=C.r,P[R+1]=C.g,P[R+2]=C.b,D[x]=S,(s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var L=new u.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(L,S))}h.vertices+=1}}}drawSphereImposter(s,y,w,S){var C=s.updateGeoGroup(4),h,x=C.vertices,R=x*3,M=C.vertexArray,P=C.colorArray;for(h=0;h<4;h++)M[R+3*h]=y.x,M[R+3*h+1]=y.y,M[R+3*h+2]=y.z;var D=C.normalArray;for(h=0;h<4;h++)P[R+3*h]=S.r,P[R+3*h+1]=S.g,P[R+3*h+2]=S.b;D[R+0]=-w,D[R+1]=w,D[R+2]=0,D[R+3]=-w,D[R+4]=-w,D[R+5]=0,D[R+6]=w,D[R+7]=-w,D[R+8]=0,D[R+9]=w,D[R+10]=w,D[R+11]=0,C.vertices+=4;var L=C.faceArray,X=C.faceidx;L[X+0]=x,L[X+1]=x+1,L[X+2]=x+2,L[X+3]=x+2,L[X+4]=x+3,L[X+5]=x,C.faceidx+=6}drawAtomImposter(s,y){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var S=this.getRadiusFromStyle(s,w),C=(0,_.getColorFromStyle)(s,w);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var h=new u.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(h,S))}this.drawSphereImposter(y,s,S,C)}}}calculateDashes(s,y,w,S,C){var h=Math.sqrt(Math.pow(s.x-y.x,2)+Math.pow(s.y-y.y,2)+Math.pow(s.z-y.z,2));w=Math.max(w,0),C=Math.max(C,0)+2*w,S=Math.max(S,.001),S+C>h&&(S=h,C=0);var x=Math.floor((h-S)/(S+C))+1,R=x*S;C=(h-R)/x;for(var M,P=new u.Vector3(s.x,s.y,s.z),D=new u.Vector3((y.x-s.x)/(h/C),(y.y-s.y)/(h/C),(y.z-s.z)/(h/C)),L=new u.Vector3((y.x-s.x)/(h/S),(y.y-s.y)/(h/S),(y.z-s.z)/(h/S)),X=[],B=0;B<x;B++)M=new u.Vector3(P.x+L.x,P.y+L.y,P.z+L.z),X.push({from:P,to:M}),P=new u.Vector3(M.x+D.x,M.y+D.y,M.z+D.z);return X}static drawStickImposter(s,y,w,S,C,h=0,x=0){for(var R=s.updateGeoGroup(4),M=R.vertices,P=M*3,D=R.vertexArray,L=R.colorArray,X=R.radiusArray,B=R.normalArray,j=C.r,H=C.g,$=C.b,q=function(Z){var xe=-Z;return xe==0&&(xe=-1e-4),xe},W=P,Y=0;Y<4;Y++)D[W]=y.x,B[W]=w.x,L[W]=j,W++,D[W]=y.y,B[W]=w.y,L[W]=H,W++,D[W]=y.z,B[W]=w.z,Y<2?L[W]=$:L[W]=q($),W++;R.vertices+=4,X[M]=-S,X[M+1]=S,X[M+2]=-S,X[M+3]=S;var G=R.faceArray,V=R.faceidx;G[V+0]=M,G[V+1]=M+1,G[V+2]=M+2,G[V+3]=M+2,G[V+4]=M+3,G[V+5]=M,R.faceidx+=6}drawBondSticks(s,y,w){var S,C;if(s.style.stick){var h=s.style.stick;if(!h.hidden){var x=h.radius||this.defaultStickRadius,R=h.doubleBondScaling||.4,M=h.tripleBondScaling||.25,P=((S=h.dashedBondConfig)===null||S===void 0?void 0:S.dashLength)||.1,D=((C=h.dashedBondConfig)===null||C===void 0?void 0:C.gapLength)||.25,L=x,X=h.singleBonds||!1,B=h.dashedBonds||!1,j=0,H=0,$,q,W,Y,G,V,Z,xe,ce,Ne,Pe,De=(0,_.getColorFromStyle)(s,h),Me,Be,ft;!s.capDrawn&&s.bonds.length<4&&(j=2);var jt=tt=>{var lt=w.imposter?z.drawStickImposter:f.GLDraw.drawCylinder;return!B&&tt>=1?lt:(ar,et,Ot,se,xt,Vr=0,J=0,ut=.1,at=.25)=>{var me=this.calculateDashes(et,Ot,se,ut,at);me.forEach(Ze=>{lt(ar,Ze.from,Ze.to,se,xt,Vr,J)})}};for(W=0;W<s.bonds.length;W++){var Gt=jt(s.bondOrder[W]),mt=s.bonds[W],Fe=y[mt];if(Me=Be=ft=null,s.index<Fe.index){var ht=Fe.style;if(!ht.stick||ht.stick.hidden)continue;var Kt=(0,_.getColorFromStyle)(Fe,ht.stick);if(L=x,Y=X,s.bondStyles&&s.bondStyles[W]){if(G=s.bondStyles[W],G.iswire)continue;G.radius&&(L=G.radius),G.singleBond&&(Y=!0),typeof G.color1<"u"&&(De=v.CC.color(G.color1)),typeof G.color2<"u"&&(Kt=v.CC.color(G.color2))}var Jt=new u.Vector3(s.x,s.y,s.z),Wt=new u.Vector3(Fe.x,Fe.y,Fe.z);if(s.bondOrder[W]<=1||Y||s.bondOrder[W]>3){if(s.bondOrder[W]<1&&(L*=s.bondOrder[W]),!Fe.capDrawn&&Fe.bonds.length<4&&(H=2),De!=Kt?(Me=new u.Vector3().addVectors(Jt,Wt).multiplyScalar(.5),Gt(w,Jt,Me,L,De,j,0,P,D),Gt(w,Me,Wt,L,Kt,0,H,P,D)):Gt(w,Jt,Wt,L,De,j,H,P,D),$=s.clickable||s.hoverable,q=Fe.clickable||Fe.hoverable,$||q){if(Me||(Me=new u.Vector3().addVectors(Jt,Wt).multiplyScalar(.5)),$){var Br=new c.Cylinder(Jt,Me,L),zr=new c.Sphere(Jt,L);s.intersectionShape.cylinder.push(Br),s.intersectionShape.sphere.push(zr)}if(q){var cr=new c.Cylinder(Wt,Me,L),Nr=new c.Sphere(Wt,L);Fe.intersectionShape.cylinder.push(cr),Fe.intersectionShape.sphere.push(Nr)}}}else if(s.bondOrder[W]>1){var At=0,Mt=0;L!=x&&(At=2,Mt=2);var Jr=Wt.clone(),Yr=null;Jr.sub(Jt);var ie,ve,we,it,rt;Yr=this.getSideBondV(s,Fe,W),s.bondOrder[W]==2?(ie=L*R,Yr.multiplyScalar(ie*1.5),ve=Jt.clone(),ve.add(Yr),we=Jt.clone(),we.sub(Yr),it=ve.clone(),it.add(Jr),rt=we.clone(),rt.add(Jr),De!=Kt?(Me=new u.Vector3().addVectors(ve,it).multiplyScalar(.5),Be=new u.Vector3().addVectors(we,rt).multiplyScalar(.5),Gt(w,ve,Me,ie,De,At,0),Gt(w,Me,it,ie,Kt,0,Mt),Gt(w,we,Be,ie,De,At,0),Gt(w,Be,rt,ie,Kt,0,Mt)):(Gt(w,ve,it,ie,De,At,Mt),Gt(w,we,rt,ie,De,At,Mt)),$=s.clickable||s.hoverable,q=Fe.clickable||Fe.hoverable,($||q)&&(Me||(Me=new u.Vector3().addVectors(ve,it).multiplyScalar(.5)),Be||(Be=new u.Vector3().addVectors(we,rt).multiplyScalar(.5)),$&&(V=new c.Cylinder(ve,Me,ie),Z=new c.Cylinder(we,Be,ie),s.intersectionShape.cylinder.push(V),s.intersectionShape.cylinder.push(Z)),q&&(ce=new c.Cylinder(it,Me,ie),Ne=new c.Cylinder(rt,Be,ie),Fe.intersectionShape.cylinder.push(ce),Fe.intersectionShape.cylinder.push(Ne)))):s.bondOrder[W]==3&&(ie=L*M,Yr.cross(Jr),Yr.normalize(),Yr.multiplyScalar(ie*3),ve=Jt.clone(),ve.add(Yr),we=Jt.clone(),we.sub(Yr),it=ve.clone(),it.add(Jr),rt=we.clone(),rt.add(Jr),De!=Kt?(Me=new u.Vector3().addVectors(ve,it).multiplyScalar(.5),Be=new u.Vector3().addVectors(we,rt).multiplyScalar(.5),ft=new u.Vector3().addVectors(Jt,Wt).multiplyScalar(.5),Gt(w,ve,Me,ie,De,At,0),Gt(w,Me,it,ie,Kt,0,Mt),Gt(w,Jt,ft,ie,De,j,0),Gt(w,ft,Wt,ie,Kt,0,H),Gt(w,we,Be,ie,De,At,0),Gt(w,Be,rt,ie,Kt,0,Mt)):(Gt(w,ve,it,ie,De,At,Mt),Gt(w,Jt,Wt,ie,De,j,H),Gt(w,we,rt,ie,De,At,Mt)),$=s.clickable||s.hoverable,q=Fe.clickable||Fe.hoverable,($||q)&&(Me||(Me=new u.Vector3().addVectors(ve,it).multiplyScalar(.5)),Be||(Be=new u.Vector3().addVectors(we,rt).multiplyScalar(.5)),ft||(ft=new u.Vector3().addVectors(Jt,Wt).multiplyScalar(.5)),$&&(V=new c.Cylinder(ve.clone(),Me.clone(),ie),Z=new c.Cylinder(we.clone(),Be.clone(),ie),xe=new c.Cylinder(Jt.clone(),ft.clone(),ie),s.intersectionShape.cylinder.push(V),s.intersectionShape.cylinder.push(Z),s.intersectionShape.cylinder.push(xe)),q&&(ce=new c.Cylinder(it.clone(),Me.clone(),ie),Ne=new c.Cylinder(rt.clone(),Be.clone(),ie),Pe=new c.Cylinder(Wt.clone(),ft.clone(),ie),Fe.intersectionShape.cylinder.push(ce),Fe.intersectionShape.cylinder.push(Ne),Fe.intersectionShape.cylinder.push(Pe))))}}}var Yt=!1,Ft=0,re=!1;for(W=0;W<s.bonds.length;W++)Y=X,s.bondStyles&&s.bondStyles[W]&&(G=s.bondStyles[W],G.singleBond&&(Y=!0),G.radius&&G.radius!=x&&(re=!0)),(Y||s.bondOrder[W]==1)&&Ft++;re?Ft>0&&(Yt=!0):Ft==0&&(s.bonds.length>0||h.showNonBonded)&&(Yt=!0),Yt&&(L=x,w.imposter?this.drawSphereImposter(w.sphereGeometry,s,L,De):f.GLDraw.drawSphere(w,s,L,De))}}}createMolObj(s,y){y=y||{};var w=new o.Object3D,S=[],C={},h={},x=this.drawAtomSphere,R=null,M=null;y.supportsImposters?(x=this.drawAtomImposter,R=new o.Geometry(!0),R.imposter=!0,M=new o.Geometry(!0,!0),M.imposter=!0,M.sphereGeometry=new o.Geometry(!0),M.sphereGeometry.imposter=!0,M.drawnCaps={}):y.supportsAIA?(x=this.drawAtomInstanced,R=new o.Geometry(!1,!0,!0),R.instanced=!0,M=new o.Geometry(!0)):(R=new o.Geometry(!0),M=new o.Geometry(!0));var P,D,L,X,B={},j=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(P=0,L=s.length;P<L;P++){var H=s[P];if(H&&H.style){(H.clickable||H.hoverable)&&H.intersectionShape===void 0&&(H.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),X={line:void 0,cross:void 0,stick:void 0,sphere:void 0};for(D in X)H.style[D]?H.style[D].opacity?X[D]=parseFloat(H.style[D].opacity):X[D]=1:X[D]=void 0,B[D]?X[D]!=null&&B[D]!=X[D]&&(console.log("Warning: "+D+" opacity is ambiguous"),B[D]=1):B[D]=X[D];x.call(this,H,R),this.drawAtomClickSphere(H),this.drawAtomCross(H,h),this.drawBondLines(H,s,C),this.drawBondSticks(H,s,M),typeof H.style.cartoon<"u"&&!H.style.cartoon.hidden&&(H.style.cartoon.color==="spectrum"&&typeof H.resi=="number"&&!H.hetflag&&(H.resi<j[0]&&(j[0]=H.resi),H.resi>j[1]&&(j[1]=H.resi)),S.push(H))}}if(S.length>0&&(0,g.drawCartoon)(w,S,j,this.defaultCartoonQuality),R&&R.vertices>0){R.initTypedArrays();var $=null,q=null;R.imposter?$=new o.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):R.instanced?(q=new o.Geometry(!0),f.GLDraw.drawSphere(q,{x:0,y:0,z:0},1,new v.Color(.5,.5,.5)),q.initTypedArrays(),$=new o.InstancedMaterial({sphereMaterial:new o.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:q})):$=new o.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),B.sphere<1&&B.sphere>=0&&($.transparent=!0,$.opacity=B.sphere),q=new o.Mesh(R,$),w.add(q)}if(M.vertices>0){var W=null,Y=null,G=M.sphereGeometry;(!G||typeof G.vertices>"u"||G.vertices==0)&&(G=null),M.initTypedArrays(),G&&G.initTypedArrays();var V={ambient:0,vertexColors:!0,reflectivity:0};M.imposter?(W=new o.StickImposterMaterial(V),Y=new o.SphereImposterMaterial(V)):(W=new o.MeshLambertMaterial(V),Y=new o.MeshLambertMaterial(V),W.wireframe&&(M.setUpWireframe(),G&&G.setUpWireframe())),B.stick<1&&B.stick>=0&&(W.transparent=!0,W.opacity=B.stick,Y.transparent=!0,Y.opacity=B.stick);var Z=new o.Mesh(M,W);if(w.add(Z),G){var xe=new o.Mesh(G,Y);w.add(xe)}}var ce;for(P in C)if(C.hasOwnProperty(P)){ce=P;var Ne=new o.LineBasicMaterial({linewidth:ce,vertexColors:!0});B.line<1&&B.line>=0&&(Ne.transparent=!0,Ne.opacity=B.line),C[P].initTypedArrays();var Pe=new o.Line(C[P],Ne,o.LineStyle.LinePieces);w.add(Pe)}for(P in h)if(h.hasOwnProperty(P)){ce=P;var De=new o.LineBasicMaterial({linewidth:ce,vertexColors:!0});B.cross<1&&B.cross>=0&&(De.transparent=!0,De.opacity=B.cross),h[P].initTypedArrays();var Me=new o.Line(h[P],De,o.LineStyle.LinePieces);w.add(Me)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var Be=new o.Object3D,ft;for(ft=0;ft<this.modelData.symmetries.length;ft++){var jt=new o.Object3D;jt=w.clone(),jt.matrix.copy(this.modelData.symmetries[ft]),jt.matrixAutoUpdate=!1,Be.add(jt)}return Be}return w}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(s){this.atoms=s.atoms,this.frames=s.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const s=this.modelData.cryst;this.modelData.cryst.matrix=(0,u.conversionMatrix3)(s.a,s.b,s.c,s.alpha,s.beta,s.gamma)}return this.modelData.cryst}else return null}setCrystData(s,y,w,S,C,h){s=s||1,y=y||1,w=w||1,S=S||90,C=C||90,h=h||90;const x=(0,u.conversionMatrix3)(s,y,w,S,C,h);this.modelData.cryst={a:s,b:y,c:w,alpha:S,beta:C,gamma:h,matrix:x}}setCrystMatrix(s){s=s||new u.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:s}}getSymmetries(){return typeof this.modelData.symmetries>"u"&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(s){typeof s>"u"?this.modelData.symmetries=[this.idMatrix]:this.modelData.symmetries=s}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(s,y,w,S){var C=y-s;return C<-w?y+S:C>w?y-S:y}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var s=this.box[0],y=this.box[1],w=this.box[2],S=s*.9,C=y*.9,h=w*.9,x=0;x<this.atomdfs.length;x++)for(var R=this.atomdfs[x],M=1;M<R.length;M++){var P=this.atoms[R[M][0]],D=this.atoms[R[M][1]];P.x=this.adjustCoord(D.x,P.x,S,s),P.y=this.adjustCoord(D.y,P.y,C,y),P.z=this.adjustCoord(D.z,P.z,h,w)}}setFrame(s,y){var w=this.getNumFrames();let S=this;return new Promise(function(C,h){if(w==0&&C(),(s<0||s>=w)&&(s=w-1),S.frames.url!=null){var x=S.frames.url;(0,_.getbin)(x+"/traj/frame/"+s+"/"+S.frames.path,void 0,"POST",void 0).then(function(R){for(var M=new Float32Array(R,44),P=0,D=0;D<S.atoms.length;D++)S.atoms[D].x=M[P++],S.atoms[D].y=M[P++],S.atoms[D].z=M[P++];S.box&&S.atomdfs&&S.adjustCoordinatesToBox(),C()}).catch(h)}else S.atoms=S.frames[s],C();S.molObj=null,S.modelDatas&&s<S.modelDatas.length&&(S.modelData=S.modelDatas[s],S.unitCellObjects&&y&&(y.removeUnitCell(S),y.addUnitCell(S)))})}addFrame(s){this.frames.push(s)}vibrate(s=10,y=1,w=!1,S,C){var h=0,x=s;w&&(h=-s,x=s),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),h<x&&(this.frames=[]),w&&(this.frames.origIndex=s);for(var R=h;R<x;R++){var M=[],P=this.frames.length;if(R==0&&!C){this.frames.push(this.atoms);continue}for(var D=0;D<this.atoms.length;D++){var L=(0,_.getAtomProperty)(this.atoms[D],"dx"),X=(0,_.getAtomProperty)(this.atoms[D],"dy"),B=(0,_.getAtomProperty)(this.atoms[D],"dz"),j=new u.Vector3(L,X,B),H=new u.Vector3(this.atoms[D].x,this.atoms[D].y,this.atoms[D].z),$=R*y/s;j.multiplyScalar($),H.add(j);var q={};for(var W in this.atoms[D])q[W]=this.atoms[D][W];if(q.x=H.x,q.y=H.y,q.z=H.z,M.push(q),S&&C){var Y=(0,_.extend)({},C),G=new u.Vector3(L,X,B);if(G.multiplyScalar(y),G.add(H),Y.start=H,Y.end=G,Y.frame=P,!Y.color){var V=q.style.sphere;V||(V=q.style.stick),V||(V=q.style.line),Y.color=(0,_.getColorFromStyle)(q,V)}S.addArrow(Y)}}this.frames.push(M)}}setAtomDefaults(s){for(let y=0;y<s.length;y++){let w=s[y];w&&(w.style=w.style||(0,_.deepCopy)(z.defaultAtomStyle),w.color=w.color||this.ElementColors[w.elem]||this.defaultColor,w.model=this.id,(w.clickable||w.hoverable)&&(w.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(s,y,w={}){var S=z.parseMolData(s,y,w);this.dontDuplicateAtoms=!w.duplicateAssemblyAtoms;var C=S.modelData;if(C&&(Array.isArray(C)?(this.modelData=C[0],w.frames&&(this.modelDatas=C)):this.modelData=C),S.box?this.box=S.box:this.box=null,this.frames.length==0){for(let x=0;x<S.length;x++)S[x].length!=0&&this.frames.push(S[x]);this.frames[0]&&(this.atoms=this.frames[0])}else if(w.frames)for(let x=0;x<S.length;x++)this.frames.push(S[x]);else for(var h=0;h<S.length;h++)this.addAtoms(S[h]);for(let x=0;x<this.frames.length;x++)this.setAtomDefaults(this.frames[x]);w.vibrate&&w.vibrate.frames&&w.vibrate.amplitude&&this.vibrate(w.vibrate.frames,w.vibrate.amplitude),w.style&&this.setStyle({},w.style)}setDontDuplicateAtoms(s){this.dontDuplicateAtoms=s}setModelData(s){this.modelData=s}propertyMatches(s,y){if(s==y)return!0;if(typeof y=="string"&&typeof s=="number"){var w=y.match(/(-?\d+)\s*-\s*(-?\d+)/);if(w){var S=parseInt(w[1]),C=parseInt(w[2]);if(w&&s>=S&&s<=C)return!0}}return!1}static deepCopyAndCache(s,y){if(typeof s!="object"||s==null||s.__cache_created)return s;const w={};for(const S in s){const C=s[S];if(Array.isArray(C)){w[S]=[];for(let h=0;h<C.length;h++)w[S].push(z.deepCopyAndCache(C[h],y))}else typeof C=="object"&&S!="properties"&&S!="model"?w[S]=z.deepCopyAndCache(C,y):w[S]=C;if(S=="and"||S=="or"){const h=[];for(const x of w[S]){const R=new Set;for(const M of y.selectedAtoms(x))R.add(M.index);h.push(R)}if(S=="and"){const x=function(M,P){const D=new Set;for(const L of P)M.has(L)&&D.add(L);return D};let R=new Set(h[0]);for(const M of h.splice(1))R=x(R,M);w[S].__cached_results=R}else if(S=="or"){const x=new Set;for(const R of h)for(const M of R)x.add(M);w[S].__cached_results=x}}}return w.__cache_created=!0,w}atomIsSelected(s,y){if(typeof y>"u")return!0;var w=!!y.invert,S=!0;for(var C in y)if(C=="and"||C=="or"||C=="not"){if(C=="not"){if(this.atomIsSelected(s,y[C])){S=!1;break}}else if(y[C].__cached_results===void 0&&(y=z.deepCopyAndCache(y,this)),S=y[C].__cached_results.has(s.index),!S)break}else if(C==="predicate"){if(!y.predicate(s)){S=!1;break}}else if(C=="properties"&&s[C]){for(var h in y.properties)if(!h.startsWith("__cache")){if(typeof s.properties[h]>"u"){S=!1;break}if(s.properties[h]!=y.properties[h]){S=!1;break}}}else if(y.hasOwnProperty(C)&&!z.ignoredKeys.has(C)&&!C.startsWith("__cache")){if(typeof s[C]>"u"){S=!1;break}var x=!1;if(C==="bonds"){var R=y[C];if(R!=s.bonds.length){S=!1;break}}else if(Array.isArray(y[C])){var M=y[C],P=s[C];for(let D=0;D<M.length;D++)if(this.propertyMatches(P,M[D])){x=!0;break}if(!x){S=!1;break}}else{let D=y[C];if(!this.propertyMatches(s[C],D)){S=!1;break}}}return w?!S:S}static squaredDistance(s,y){var w=y.x-s.x,S=y.y-s.y,C=y.z-s.z;return w*w+S*S+C*C}expandAtomList(s,y){if(y<=0)return s;for(var w=(0,_.getExtent)(s,void 0),S=[[],[],[]],C=0;C<3;C++)S[0][C]=w[0][C]-y,S[1][C]=w[1][C]+y,S[2][C]=w[2][C];var h=[];for(let P=0;P<this.atoms.length;P++){var x=this.atoms[P].x,R=this.atoms[P].y,M=this.atoms[P].z;x>=S[0][0]&&x<=S[1][0]&&R>=S[0][1]&&R<=S[1][1]&&M>=S[0][2]&&M<=S[1][2]&&(x>=w[0][0]&&x<=w[1][0]&&R>=w[0][1]&&R<=w[1][1]&&M>=w[0][2]&&M<=w[1][2]||h.push(this.atoms[P]))}return h}static getFloat(s){return typeof s=="number"?s:parseFloat(s)}selectedAtoms(s,y){var w=[];s=z.deepCopyAndCache(s||{},this),y||(y=this.atoms);for(var S=y.length,C=0;C<S;C++){var h=y[C];h&&this.atomIsSelected(h,s)&&w.push(h)}if(s.hasOwnProperty("expand")){const q=z.getFloat(s.expand);let W=this.expandAtomList(w,q),Y=w.length;const G=q*q;for(let V=0;V<W.length;V++)for(let Z=0;Z<Y;Z++){var x=z.squaredDistance(W[V],w[Z]);x<G&&x>0&&w.push(W[V])}}if(s.hasOwnProperty("within")&&s.within.hasOwnProperty("sel")&&s.within.hasOwnProperty("distance")){var R=this.selectedAtoms(s.within.sel,this.atoms),M={};const q=z.getFloat(s.within.distance),W=q*q;for(let Y=0;Y<R.length;Y++)for(let G=0;G<w.length;G++){let V=z.squaredDistance(R[Y],w[G]);V<W&&V>0&&(M[G]=1)}var P=[];if(s.within.invert)for(let Y=0;Y<w.length;Y++)M[Y]||P.push(w[Y]);else for(let Y in M)P.push(w[Y]);w=P}if(s.hasOwnProperty("byres")){var D={},L=[],X=[];for(let q=0;q<w.length;q++){let W=w[q];var B=W.chain,j=W.resi;if(D[B]===void 0&&(D[B]={}),W.hasOwnProperty("resi")&&D[B][j]===void 0){for(D[B][j]=!0,X.push(W);X.length>0;)if(W=X.pop(),B=W.chain,j=W.resi,L[W.index]===void 0){L[W.index]=!0;for(var H=0;H<W.bonds.length;H++){var $=this.atoms[W.bonds[H]];L[$.index]===void 0&&$.hasOwnProperty("resi")&&$.chain==B&&$.resi==j&&(X.push($),w.push($))}}}}}return w}addAtoms(s){this.molObj=null;var y=this.atoms.length,w=[],S;for(S=0;S<s.length;S++)typeof s[S].index>"u"&&(s[S].index=S),typeof s[S].serial>"u"&&(s[S].serial=S),w[s[S].index]=y+S;for(S=0;S<s.length;S++){var C=s[S],h=w[C.index],x=(0,_.extend)({},C);x.index=h,x.bonds=[],x.bondOrder=[],x.model=this.id,x.style=x.style||(0,_.deepCopy)(z.defaultAtomStyle),typeof x.color>"u"&&(x.color=this.ElementColors[x.elem]||this.defaultColor);for(var R=C.bonds?C.bonds.length:0,M=0;M<R;M++){var P=w[C.bonds[M]];typeof P<"u"&&(x.bonds.push(P),x.bondOrder.push(C.bondOrder?C.bondOrder[M]:1))}this.atoms.push(x)}}assignBonds(){(0,A.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(s){this.molObj=null;var y=[],w;for(w=0;w<s.length;w++)y[s[w].index]=!0;var S=[];for(w=0;w<this.atoms.length;w++){var C=this.atoms[w];y[C.index]||S.push(C)}this.atoms=[],this.addAtoms(S)}setStyle(s,y,w){typeof y>"u"&&typeof w>"u"&&(y=s,s={}),s=s,typeof y=="string"&&(y=(0,_.specStringToObject)(y));var S=!1,C=this,h=function(R){var M=C.selectedAtoms(s,R);for(let P=0;P<R.length;P++)R[P]&&(R[P].capDrawn=!1);for(let P=0;P<M.length;P++){S=!0,(M[P].clickable||M[P].hoverable)&&(M[P].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),w||(M[P].style={});for(let D in y)y.hasOwnProperty(D)&&(M[P].style[D]=M[P].style[D]||{},Object.assign(M[P].style[D],y[D]))}};if(s.frame!==void 0&&s.frame<this.frames.length){let R=s.frame;R<0&&(R=this.frames.length+R),h(this.frames[R])}else{h(this.atoms);for(var x=0;x<this.frames.length;x++)this.frames[x]!==this.atoms&&h(this.frames[x])}S&&(this.molObj=null)}setClickable(s,y,w){if(y=!!y,w=(0,_.makeFunction)(w),w===null){console.log("Callback is not a function");return}var S=this.selectedAtoms(s,this.atoms),C=S.length;for(let h=0;h<C;h++)S[h].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},S[h].clickable=y,w&&(S[h].callback=w);C>0&&(this.molObj=null)}setHoverable(s,y,w,S){if(y=!!y,w=(0,_.makeFunction)(w),S=(0,_.makeFunction)(S),w===null){console.log("Hover_callback is not a function");return}if(S===null){console.log("Unhover_callback is not a function");return}var C=this.selectedAtoms(s,this.atoms),h=C.length;for(let x=0;x<h;x++)C[x].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},C[x].hoverable=y,w&&(C[x].hover_callback=w),S&&(C[x].unhover_callback=S);h>0&&(this.molObj=null)}enableContextMenu(s,y){y=!!y;var w,S=this.selectedAtoms(s,this.atoms),C=S.length;for(w=0;w<C;w++)S[w].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},S[w].contextMenuEnabled=y;C>0&&(this.molObj=null)}setColorByElement(s,y){if(!(this.molObj!==null&&z.sameObj(y,this.lastColors))){this.lastColors=y;var w=this.selectedAtoms(s,w);w.length>0&&(this.molObj=null);for(var S=0;S<w.length;S++){var C=w[S];typeof y[C.elem]<"u"&&(C.color=y[C.elem])}}}setColorByProperty(s,y,w,S){var C,h,x=this.selectedAtoms(s,x);for(this.lastColors=null,x.length>0&&(this.molObj=null),typeof w=="string"&&typeof p.Gradient.builtinGradients[w]<"u"&&(w=new p.Gradient.builtinGradients[w]),w=w,S||(S=w.range()),S||(S=(0,_.getPropertyRange)(x,y)),C=0;C<x.length;C++){h=x[C];var R=(0,_.getAtomProperty)(h,y);R!=null&&(h.color=w.valueToHex(parseFloat(h.properties[y]),S))}}setColorByFunction(s,y){var w=this.selectedAtoms(s,w);if(typeof y=="function"){this.lastColors=null,w.length>0&&(this.molObj=null);for(let S=0;S<w.length;S++){let C=w[S];C.color=y(C)}}}toCDObject(s=!1){var y={a:[],b:[]};s&&(y.s=[]);for(let S=0;S<this.atoms.length;S++){let C={},h=this.atoms[S];if(C.x=h.x,C.y=h.y,C.z=h.z,h.elem!="C"&&(C.l=h.elem),s){for(var w=0;w<y.s.length&&JSON.stringify(h.style)!==JSON.stringify(y.s[w]);)w++;w===y.s.length&&y.s.push(h.style),w!==0&&(C.s=w)}y.a.push(C);for(let x=0;x<h.bonds.length;x++){let R=S,M=h.bonds[x];if(R>=M)continue;let P={b:R,e:M},D=h.bondOrder[x];D!=1&&(P.o=D),y.b.push(P)}}return y}globj(s,y){(this.molObj===null||y.regen)&&(this.molObj=this.createMolObj(this.atoms,y),this.renderedMolObj&&(s.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),s.add(this.renderedMolObj))}exportVRML(){var s=this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1});return s.vrml()}removegl(s){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),s.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(s,y,w,S){for(var C=this.selectedAtoms(y,C),h=(0,_.deepCopy)(S),x=0;x<C.length;x++){var R=C[x],M=null;typeof R[s]<"u"?M=String(R[s]):typeof R.properties[s]<"u"&&(M=String(R.properties[s])),M!=null&&(h.position=R,w.addLabel(M,h))}}addResLabels(s,y,w,S=!1){var C=[],h=function(R,M){for(var P=R.selectedAtoms(s,P),D={},L=0;L<P.length;L++){var X=P[L],B=X.chain,j=X.resn,H=X.resi,$=j+""+H;D[B]||(D[B]={}),D[B][$]||(D[B][$]=[]),D[B][$].push(X)}var q=(0,_.deepCopy)(w);for(let Y in D)if(D.hasOwnProperty(Y)){var W=D[Y];for(let G in W)if(W.hasOwnProperty(G)){let V=W[G],Z=new u.Vector3(0,0,0);for(let ce=0;ce<V.length;ce++){let Ne=V[ce];Z.x+=Ne.x,Z.y+=Ne.y,Z.z+=Ne.z}Z.divideScalar(V.length),q.position=Z,q.frame=M;let xe=y.addLabel(G,q,void 0,!0);C.push(xe)}}};if(S){var x=this.getNumFrames();let R=this.atoms;for(let M=0;M<x;M++)this.frames[M]&&(this.atoms=this.frames[M],h(this,M));this.atoms=R}else h(this);return C}setupDFS(){this.atomdfs=[];var s=this,y=new Int8Array(this.atoms.length);y.fill(0);for(var w=function(x,R,M){M.push([x,R]);var P=s.atoms[x];y[x]=1;for(var D=0;D<P.bonds.length;D++){var L=P.bonds[D];s.atoms[L]&&!y[L]&&w(L,x,M)}},S=0;S<this.atoms.length;S++){var C=this.atoms[S];if(C&&!y[S]){var h=[];w(S,-1,h),this.atomdfs.push(h)}}}setCoordinatesFromURL(s,y){this.frames=[];var w=this;return this.box&&this.setupDFS(),s.startsWith("http")||(s="http://"+s),(0,_.get)(s+"/traj/numframes/"+y,function(S){if(!isNaN(parseInt(S)))return w.frames.push(w.atoms),w.frames.numFrames=S,w.frames.url=s,w.frames.path=y,w.setFrame(0)})}setCoordinates(s,y){if(y=y||"",!s)return[];if(/\.gz$/.test(y)){y=y.replace(/\.gz$/,"");try{s=(0,_.inflateString)(s)}catch(D){console.log(D)}}var w={mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""};if(w.hasOwnProperty(y)){this.frames=[];for(var S=this.atoms.length,C=z.parseCrd(s,y),h=0;h<C.length;){for(var x=[],R=0;R<S;R++){var M={};for(var P in this.atoms[R])M[P]=this.atoms[R][P];x[R]=M,x[R].x=C[h++],x[R].y=C[h++],x[R].z=C[h++]}this.frames.push(x)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(s){}static parseCrd(s,y){var w=[],S=0;if(y=="pdb")for(var C=s.indexOf(`
ATOM`);C!=-1;){for(;s.slice(C,C+5)==`
ATOM`||s.slice(C,C+7)==`
HETATM`;)w[S++]=parseFloat(s.slice(C+31,C+39)),w[S++]=parseFloat(s.slice(C+39,C+47)),w[S++]=parseFloat(s.slice(C+47,C+55)),C=s.indexOf(`
`,C+54),s.slice(C,C+4)==`
TER`&&(C=s.indexOf(`
`,C+5));C=s.indexOf(`
ATOM`,C)}else if(y=="netcdf"){var h=new k.NetCDFReader(s);w=[].concat.apply([],h.getDataVariable("coordinates"))}else{if(y=="array"||Array.isArray(s))return s.flat(2);{let x=s.indexOf(`
`);y=="inpcrd"&&(x=s.indexOf(`
`,x+1)),s=s.slice(x+1),w=s.match(/\S+/g).map(parseFloat)}}return w}static parseMolData(s,y="",w){if(!s)return[];if(/\.gz$/.test(y)){y=y.replace(/\.gz$/,"");try{y.match(/bcif/i)?s=(0,_.inflateString)(s,!1):s=(0,_.inflateString)(s)}catch(h){console.log(h)}}typeof E.Parsers[y]>"u"&&(y=y.split(".").pop(),typeof E.Parsers[y]>"u"&&(console.log("Unknown format: "+y),s instanceof Uint8Array?y="bcif":s.match(/^@<TRIPOS>MOLECULE/gm)?y="mol2":s.match(/^data_/gm)&&s.match(/^loop_/gm)?y="cif":s.match(/^HETATM/gm)||s.match(/^ATOM/gm)?y="pdb":s.match(/ITEM: TIMESTEP/gm)?y="lammpstrj":s.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?y="sdf":s.match(/^%VERSION\s+VERSION_STAMP/gm)?y="prmtop":y="xyz",console.log("Best guess: "+y)));var S=E.Parsers[y],C=S(s,w);return C}}z.defaultAtomStyle={line:{}},z.defaultlineWidth=1,z.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},z.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"])}),"./src/GLShape.ts":((e,r,t)=>{t.r(r),t.d(r,{GLShape:()=>k,splitMesh:()=>A});var o=t("./src/WebGL/index.ts"),c=t("./src/WebGL/shapes/index.ts"),u=t("./src/WebGL/math/index.ts"),v=t("./src/colors.ts"),f=t("./src/ProteinSurface4.ts"),g=t("./src/VolumeData.ts"),_=t("./src/GLDraw.ts"),p=t("./src/glcartoon.ts"),E=t("./src/utilities.ts");class k{static finalizeGeo(l){var s=l.updateGeoGroup(0);s.vertices>0&&s.truncateArrayBuffers(!0,!0)}static updateColor(l,s){s=s||v.CC.color(s),l.colorsNeedUpdate=!0;var y,w,S;s.constructor!==Array&&(y=s.r,w=s.g,S=s.b);for(let C in l.geometryGroups){let h=l.geometryGroups[C],x=h.colorArray;for(let R=0,M=h.vertices;R<M;++R){if(s.constructor===Array){let P=s[R];y=P.r,w=P.g,S=P.b}x[R*3]=y,x[R*3+1]=w,x[R*3+2]=S}}}static drawArrow(l,s,y){var w=y.start,S=y.end,C=y.radius,h=y.radiusRatio,x=y.mid,R=y.midpos;if(!(w&&S))return;var M=s.updateGeoGroup(51),P=new u.Vector3(S.x,S.y,S.z).sub(w);if(R){let et=P.length();R>0?x=R/et:x=(et+R)/et}P.multiplyScalar(x);var D=new u.Vector3(w.x,w.y,w.z).add(P),L=P.clone().negate();let X=new u.Vector3(w.x,w.y,w.z);l.intersectionShape.cylinder.push(new c.Cylinder(X,D.clone(),C)),l.intersectionShape.sphere.push(new c.Sphere(X,C));var B=[];B[0]=P.clone(),Math.abs(B[0].x)>1e-4?B[0].y+=1:B[0].x+=1,B[0].cross(P),B[0].normalize(),B[4]=B[0].clone(),B[4].crossVectors(B[0],P),B[4].normalize(),B[8]=B[0].clone().negate(),B[12]=B[4].clone().negate(),B[2]=B[0].clone().add(B[4]).normalize(),B[6]=B[4].clone().add(B[8]).normalize(),B[10]=B[8].clone().add(B[12]).normalize(),B[14]=B[12].clone().add(B[0]).normalize(),B[1]=B[0].clone().add(B[2]).normalize(),B[3]=B[2].clone().add(B[4]).normalize(),B[5]=B[4].clone().add(B[6]).normalize(),B[7]=B[6].clone().add(B[8]).normalize(),B[9]=B[8].clone().add(B[10]).normalize(),B[11]=B[10].clone().add(B[12]).normalize(),B[13]=B[12].clone().add(B[14]).normalize(),B[15]=B[14].clone().add(B[0]).normalize();var j=M.vertices,H=M.vertexArray,$=M.faceArray,q=M.normalArray,W=M.lineArray,Y,G,V;for(G=0,V=B.length;G<V;++G){Y=3*(j+3*G);var Z=B[G].clone().multiplyScalar(C).add(w),xe=B[G].clone().multiplyScalar(C).add(D),ce=B[G].clone().multiplyScalar(C*h).add(D);if(H[Y]=Z.x,H[Y+1]=Z.y,H[Y+2]=Z.z,H[Y+3]=xe.x,H[Y+4]=xe.y,H[Y+5]=xe.z,H[Y+6]=ce.x,H[Y+7]=ce.y,H[Y+8]=ce.z,G>0){var Ne=H[Y-3],Pe=H[Y-2],De=H[Y-1],Me=new u.Vector3(Ne,Pe,De),Be=new u.Vector3(S.x,S.y,S.z),ft=D.clone(),jt=new u.Vector3(ce.x,ce.y,ce.z);l.intersectionShape.triangle.push(new c.Triangle(jt,Be,Me)),l.intersectionShape.triangle.push(new c.Triangle(Me.clone(),ft,jt.clone()))}}M.vertices+=48,Y=M.vertices*3,H[Y]=w.x,H[Y+1]=w.y,H[Y+2]=w.z,H[Y+3]=D.x,H[Y+4]=D.y,H[Y+5]=D.z,H[Y+6]=S.x,H[Y+7]=S.y,H[Y+8]=S.z,M.vertices+=3;var Gt,mt,Fe,ht,Kt,Jt,Wt,Br,zr,cr,Nr,At,Mt,Jr,Yr,ie,ve,we,it,rt=M.vertices-3,Yt=M.vertices-2,Ft=M.vertices-1,re=rt*3,tt=Yt*3,lt=Ft*3;for(G=0,V=B.length-1;G<V;++G){var ar=j+3*G;Y=ar*3,mt=M.faceidx,Fe=M.lineidx,ht=ar,cr=ht*3,Kt=ar+1,Nr=Kt*3,Jt=ar+2,At=Jt*3,Wt=ar+4,Mt=Wt*3,Br=ar+5,Jr=Br*3,zr=ar+3,Yr=zr*3,ie=ve=B[G],we=it=B[G+1],q[cr]=ie.x,q[Nr]=ve.x,q[Yr]=it.x,q[cr+1]=ie.y,q[Nr+1]=ve.y,q[Yr+1]=it.y,q[cr+2]=ie.z,q[Nr+2]=ve.z,q[Yr+2]=it.z,q[Nr]=ve.x,q[Mt]=we.x,q[Yr]=it.x,q[Nr+1]=ve.y,q[Mt+1]=we.y,q[Yr+1]=it.y,q[Nr+2]=ve.z,q[Mt+2]=we.z,q[Yr+2]=it.z,q[At]=ve.x,q[Jr]=we.x,q[At+1]=ve.y,q[Jr+1]=we.y,q[At+2]=ve.z,q[Jr+2]=we.z,$[mt]=ht,$[mt+1]=Kt,$[mt+2]=zr,$[mt+3]=Kt,$[mt+4]=Wt,$[mt+5]=zr,$[mt+6]=ht,$[mt+7]=zr,$[mt+8]=rt,$[mt+9]=Jt,$[mt+10]=Yt,$[mt+11]=Br,$[mt+12]=Jt,$[mt+13]=Ft,$[mt+14]=Br,W[Fe]=ht,W[Fe+1]=Kt,W[Fe+2]=ht,W[Fe+3]=zr,W[Fe+4]=Wt,W[Fe+5]=zr,W[Fe+6]=ht,W[Fe+7]=zr,W[Fe+8]=Jt,W[Fe+9]=Kt,W[Fe+10]=Jt,W[Fe+11]=Br,W[Fe+12]=Wt,W[Fe+13]=Br,W[Fe+14]=Jt,W[Fe+15]=Ft,W[Fe+16]=Jt,W[Fe+17]=Br,W[Fe+18]=Ft,W[Fe+19]=Br,M.faceidx+=15,M.lineidx+=20}Gt=[j+45,j+46,j+1,j,j+47,j+2],mt=M.faceidx,Fe=M.lineidx,ht=Gt[0],cr=ht*3,Kt=Gt[1],Nr=Kt*3,Jt=Gt[4],At=Jt*3,Wt=Gt[2],Mt=Wt*3,Br=Gt[5],Jr=Br*3,zr=Gt[3],Yr=zr*3,ie=ve=B[15],we=it=B[0],q[cr]=ie.x,q[Nr]=ve.x,q[Yr]=it.x,q[cr+1]=ie.y,q[Nr+1]=ve.y,q[Yr+1]=it.y,q[cr+2]=ie.z,q[Nr+2]=ve.z,q[Yr+2]=it.z,q[Nr]=ve.x,q[Mt]=we.x,q[Yr]=it.x,q[Nr+1]=ve.y,q[Mt+1]=we.y,q[Yr+1]=it.y,q[Nr+2]=ve.z,q[Mt+2]=we.z,q[Yr+2]=it.z,q[At]=ve.x,q[Jr]=we.x,q[At+1]=ve.y,q[Jr+1]=we.y,q[At+2]=ve.z,q[Jr+2]=we.z,P.normalize(),L.normalize(),q[re]=L.x,q[tt]=q[lt]=P.x,q[re+1]=L.y,q[tt+1]=q[lt+1]=P.y,q[re+2]=L.z,q[tt+2]=q[lt+2]=P.z,$[mt]=ht,$[mt+1]=Kt,$[mt+2]=zr,$[mt+3]=Kt,$[mt+4]=Wt,$[mt+5]=zr,$[mt+6]=ht,$[mt+7]=zr,$[mt+8]=rt,$[mt+9]=Jt,$[mt+10]=Yt,$[mt+11]=Br,$[mt+12]=Jt,$[mt+13]=Ft,$[mt+14]=Br,W[Fe]=ht,W[Fe+1]=Kt,W[Fe+2]=ht,W[Fe+3]=zr,W[Fe+4]=Wt,W[Fe+5]=zr,W[Fe+6]=ht,W[Fe+7]=zr,W[Fe+8]=Jt,W[Fe+9]=Kt,W[Fe+10]=Jt,W[Fe+11]=Br,W[Fe+12]=Wt,W[Fe+13]=Br,W[Fe+14]=Jt,W[Fe+15]=Ft,W[Fe+16]=Jt,W[Fe+17]=Br,W[Fe+18]=Ft,W[Fe+19]=Br,M.faceidx+=15,M.lineidx+=20}static updateBoundingFromPoints(l,s,y,w){l.center.set(0,0,0);let S=1/0,C=1/0,h=1/0,x=-1/0,R=-1/0,M=-1/0;l.box&&(S=l.box.min.x,x=l.box.max.x,C=l.box.min.y,R=l.box.max.y,h=l.box.min.z,M=l.box.max.z);for(let X=0,B=w;X<B;X++){var P=y[X*3],D=y[X*3+1],L=y[X*3+2];P<S&&(S=P),D<C&&(C=D),L<h&&(h=L),P>x&&(x=P),D>R&&(R=D),L>M&&(M=L)}l.center.set((x+S)/2,(R+C)/2,(M+h)/2),l.radius=l.center.distanceTo({x,y:R,z:M}),l.box={min:{x:S,y:C,z:h},max:{x,y:R,z:M}}}static addCustomGeo(l,s,y,w,S){var C=s.addGeoGroup(),h=y.vertexArr,x=y.normalArr,R=y.faceArr;C.vertices=h.length,C.faceidx=R.length;var M,P,D,L,X,B,j,H,$,q=C.vertexArray,W=C.colorArray;for(w.constructor!==Array&&(H=w.r,$=w.g,L=w.b),B=0,j=C.vertices;B<j;++B)M=B*3,P=h[B],q[M]=P.x,q[M+1]=P.y,q[M+2]=P.z,w.constructor===Array&&(X=w[B],H=X.r,$=X.g,L=X.b),W[M]=H,W[M+1]=$,W[M+2]=L;if(S)for(B=0,j=C.faceidx/3;B<j;++B){M=B*3,D=R[M],L=R[M+1],X=R[M+2];var Y=new u.Vector3,G=new u.Vector3,V=new u.Vector3;l.intersectionShape.triangle.push(new c.Triangle(Y.copy(h[D]),G.copy(h[L]),V.copy(h[X])))}if(S){var Z=new u.Vector3(0,0,0),xe=0;for(let Pe=0;Pe<s.geometryGroups.length;Pe++)Z.add(s.geometryGroups[Pe].getCentroid()),xe++;Z.divideScalar(xe),k.updateBoundingFromPoints(l.boundingSphere,{centroid:Z},q,C.vertices)}if(C.faceArray=new Uint16Array(R),C.truncateArrayBuffers(!0,!0),x.length<C.vertices)C.setNormals();else{var ce=C.normalArray=new Float32Array(C.vertices*3),Ne;for(B=0,j=C.vertices;B<j;++B)M=B*3,Ne=x[B],ce[M]=Ne.x,ce[M+1]=Ne.y,ce[M+2]=Ne.z}C.setLineIndices(),C.lineidx=C.lineArray.length}static updateFromStyle(l,s){typeof s.color<"u"?(l.color=s.color||new v.Color,s.color instanceof v.Color||(l.color=v.CC.color(s.color))):l.color=v.CC.color(0),l.wireframe=!!s.wireframe,l.opacity=s.alpha?(0,u.clamp)(s.alpha,0,1):1,typeof s.opacity<"u"&&(l.opacity=(0,u.clamp)(s.opacity,0,1)),l.side=s.side!==void 0?s.side:o.DoubleSide,l.linewidth=typeof s.linewidth>"u"?1:s.linewidth,l.clickable=!!s.clickable,l.callback=(0,E.makeFunction)(s.callback),l.hoverable=!!s.hoverable,l.hover_callback=(0,E.makeFunction)(s.hover_callback),l.unhover_callback=(0,E.makeFunction)(s.unhover_callback),l.contextMenuEnabled=!!s.contextMenuEnabled,l.hidden=s.hidden,l.frame=s.frame}constructor(l){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=o.DoubleSide,this.stylespec=l||{},this.boundingSphere=new c.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},k.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new o.Geometry(!0),this.linegeo=new o.Geometry(!0)}updateStyle(l){for(var s in l)this.stylespec[s]=l[s];if(k.updateFromStyle(this,this.stylespec),l.voldata&&l.volscheme){(0,E.adjustVolumeStyle)(l);const y=l.volscheme,w=l.voldata,S=v.CC,C=y.range()||[-1,1];this.geo.setColors(function(h,x,R){let M=w.getVal(h,x,R);return S.color(y.valueToHex(M,C))}),delete this.color}}addCustom(l){l.vertexArr=l.vertexArr||[],l.faceArr=l.faceArr||[],l.normalArr=l.normalArr||[],k.drawCustom(this,this.geo,l)}addSphere(l){l.center||(l.center=new u.Vector3(0,0,0)),l.radius=l.radius?(0,u.clamp)(l.radius,0,1/0):1.5,l.color=v.CC.color(l.color),this.intersectionShape.sphere.push(new c.Sphere(l.center,l.radius)),_.GLDraw.drawSphere(this.geo,l.center,l.radius,l.color,l.quality),this.components.push({centroid:new u.Vector3(l.center.x,l.center.y,l.center.z)});var s=this.geo.updateGeoGroup(0);k.updateBoundingFromPoints(this.boundingSphere,this.components,s.vertexArray,s.vertices)}addBox(l){var s=l.dimensions||{w:1,h:1,d:1},y;typeof s.w=="number"?y={x:s.w,y:0,z:0}:y=s.w;var w;typeof s.h=="number"?w={x:0,y:s.h,z:0}:w=s.h;var S;typeof s.d=="number"?S={x:0,y:0,z:s.d}:S=s.d;var C=l.corner;C==null&&(l.center!==void 0?C={x:l.center.x-.5*(y.x+w.x+S.x),y:l.center.y-.5*(y.y+w.y+S.y),z:l.center.z-.5*(y.z+w.z+S.z)}:C={x:0,y:0,z:0});var h=[{x:C.x,y:C.y,z:C.z},{x:C.x+y.x,y:C.y+y.y,z:C.z+y.z},{x:C.x+w.x,y:C.y+w.y,z:C.z+w.z},{x:C.x+y.x+w.x,y:C.y+y.y+w.y,z:C.z+y.z+w.z},{x:C.x+S.x,y:C.y+S.y,z:C.z+S.z},{x:C.x+y.x+S.x,y:C.y+y.y+S.y,z:C.z+y.z+S.z},{x:C.x+w.x+S.x,y:C.y+w.y+S.y,z:C.z+w.z+S.z},{x:C.x+y.x+w.x+S.x,y:C.y+y.y+w.y+S.y,z:C.z+y.z+w.z+S.z}],x=[],R=[];x.splice(x.length,0,h[0],h[1],h[2],h[3]),R.splice(R.length,0,0,2,1,1,2,3);var M=4;x.splice(x.length,0,h[2],h[3],h[6],h[7]),R.splice(R.length,0,M+0,M+2,M+1,M+1,M+2,M+3),M+=4,x.splice(x.length,0,h[4],h[5],h[0],h[1]),R.splice(R.length,0,M+0,M+2,M+1,M+1,M+2,M+3),M+=4,x.splice(x.length,0,h[6],h[7],h[4],h[5]),R.splice(R.length,0,M+0,M+2,M+1,M+1,M+2,M+3),M+=4,x.splice(x.length,0,h[3],h[1],h[7],h[5]),R.splice(R.length,0,M+0,M+2,M+1,M+1,M+2,M+3),M+=4,x.splice(x.length,0,h[2],h[6],h[0],h[4]),R.splice(R.length,0,M+0,M+2,M+1,M+1,M+2,M+3),M+=4;var P=(0,E.extend)({},l);P.vertexArr=x,P.faceArr=R,P.normalArr=[],k.drawCustom(this,this.geo,P);var D=new u.Vector3;this.components.push({centroid:D.addVectors(h[0],h[7]).multiplyScalar(.5)});var L=this.geo.updateGeoGroup(0);k.updateBoundingFromPoints(this.boundingSphere,this.components,L.vertexArray,L.vertices)}addCylinder(l){var s,y;l.start?s=new u.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):s=new u.Vector3(0,0,0),l.end?(y=new u.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof y.x>"u"&&(y.x=3)):y=new u.Vector3(0,0,0);var w=l.radius||.1,S=v.CC.color(l.color);this.intersectionShape.cylinder.push(new c.Cylinder(s,y,w)),_.GLDraw.drawCylinder(this.geo,s,y,w,S,l.fromCap,l.toCap);var C=new u.Vector3;this.components.push({centroid:C.addVectors(s,y).multiplyScalar(.5)});var h=this.geo.updateGeoGroup(0);k.updateBoundingFromPoints(this.boundingSphere,this.components,h.vertexArray,h.vertices)}addDashedCylinder(l){l.dashLength=l.dashLength||.25,l.gapLength=l.gapLength||.25;var s;l.start?s=new u.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):s=new u.Vector3(0,0,0);var y;l.end?(y=new u.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof y.x>"u"&&(y.x=3)):y=new u.Vector3(3,0,0);for(var w=l.radius||.1,S=v.CC.color(l.color),C=Math.sqrt(Math.pow(s.x-y.x,2)+Math.pow(s.y-y.y,2)+Math.pow(s.z-y.z,2)),h=C/(l.gapLength+l.dashLength),x=new u.Vector3(l.start.x||0,l.start.y||0,l.start.z||0),R=new u.Vector3(l.end.x,l.end.y||0,l.end.z||0),M=new u.Vector3((y.x-s.x)/(C/l.gapLength),(y.y-s.y)/(C/l.gapLength),(y.z-s.z)/(C/l.gapLength)),P=new u.Vector3((y.x-s.x)/(C/l.dashLength),(y.y-s.y)/(C/l.dashLength),(y.z-s.z)/(C/l.dashLength)),D=0;D<h;D++)R=new u.Vector3(x.x+P.x,x.y+P.y,x.z+P.z),this.intersectionShape.cylinder.push(new c.Cylinder(x,R,w)),_.GLDraw.drawCylinder(this.geo,x,R,w,S,l.fromCap,l.toCap),x=new u.Vector3(R.x+M.x,R.y+M.y,R.z+M.z);var L=new u.Vector3;this.components.push({centroid:L.addVectors(s,y).multiplyScalar(.5)});var X=this.geo.updateGeoGroup(0);k.updateBoundingFromPoints(this.boundingSphere,this.components,X.vertexArray,X.vertices)}addCurve(l){l.points=l.points||[],l.smooth=l.smooth||10,typeof l.fromCap>"u"&&(l.fromCap=2),typeof l.toCap>"u"&&(l.toCap=2);var s=(0,p.subdivide_spline)(l.points,l.smooth);if(s.length<3){console.log("Too few points in addCurve");return}var y=l.radius||.1,w=v.CC.color(l.color),S=0,C=s.length-1,h=s[0].distanceTo(s[1]),x=Math.ceil(2*y/h);if(l.toArrow){C-=x;let D={start:s[C],end:s[s.length-1],radius:y,color:w,mid:1e-4};this.addArrow(D)}if(l.fromArrow){S+=x;let D={start:s[S],end:s[0],radius:y,color:w,mid:1e-4};this.addArrow(D)}for(var R=Math.ceil(s.length/2),M={radius:y,color:w,fromCap:2,toCap:2},P=S;P<C;P++)M.start=s[P],M.end=s[P+1],M.fromCap=2,M.toCap=2,P<R?(M.fromCap=2,M.toCap=0):P>R?(M.fromCap=0,M.toCap=2):(M.fromCap=2,M.toCap=2),this.addCylinder(M)}addLine(l){var s,y;l.start?s=new u.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):s=new u.Vector3(0,0,0),l.end?(y=new u.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof y.x>"u"&&(y.x=3)):y=new u.Vector3(3,0,0);var w=this.geo.updateGeoGroup(2),S=w.vertices,C=S*3,h=w.vertexArray;h[C]=s.x,h[C+1]=s.y,h[C+2]=s.z,h[C+3]=y.x,h[C+4]=y.y,h[C+5]=y.z,w.vertices+=2;var x=w.lineArray,R=w.lineidx;x[R]=S,x[R+1]=S+1,w.lineidx+=2;var M=new u.Vector3;this.components.push({centroid:M.addVectors(s,y).multiplyScalar(.5)}),w=this.geo.updateGeoGroup(0),k.updateBoundingFromPoints(this.boundingSphere,this.components,w.vertexArray,w.vertices)}addArrow(l){if(l.start?l.start=new u.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):l.start=new u.Vector3(0,0,0),l.dir instanceof u.Vector3&&typeof l.length=="number"){var s=l.dir.clone().multiplyScalar(l.length).add(l.start);l.end=s}else l.end?(l.end=new u.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof l.end.x>"u"&&(l.end.x=3)):l.end=new u.Vector3(3,0,0);l.radius=l.radius||.1,l.radiusRatio=l.radiusRatio||1.618034,l.mid=0<l.mid&&l.mid<1?l.mid:.618034,k.drawArrow(this,this.geo,l);var y=new u.Vector3;this.components.push({centroid:y.addVectors(l.start,l.end).multiplyScalar(.5)});var w=this.geo.updateGeoGroup(0);k.updateBoundingFromPoints(this.boundingSphere,this.components,w.vertexArray,w.vertices)}static distance_from(l,s){return Math.sqrt(Math.pow(l.x-s.x,2)+Math.pow(l.y-s.y,2)+Math.pow(l.z-s.z,2))}static inSelectedRegion(l,s,y){for(var w=0;w<s.length;w++)if(k.distance_from(s[w],l)<=y)return!0;return!1}addIsosurface(l,s,y,w){var S=s.isoval!==void 0&&typeof s.isoval=="number"?s.isoval:0,C=!!s.voxel,h=s.smoothness===void 0?1:s.smoothness,x=l.size.x,R=l.size.y,M=l.size.z,P=new Int16Array(x*R*M),D=l.data,L,X;for(L=0,X=P.length;L<X;++L)P[L]=-1;var B=new Uint8Array(x*R*M);for(L=0,X=D.length;L<X;++L){var j=S>=0?D[L]-S:S-D[L];j>0&&(B[L]|=k.ISDONE)}var H=[],$=[];f.MarchingCube.march(B,H,$,{fulltable:!0,voxel:C,unitCube:l.unit,origin:l.origin,matrix:l.matrix,nX:x,nY:R,nZ:M}),!C&&h>0&&f.MarchingCube.laplacianSmooth(h,H,$);var q=[],W=[],Y=[];if(s.selectedRegion&&s.coords===void 0&&(s.coords=s.selectedRegion),s.coords===void 0&&s.selection!==void 0&&(w?s.coords=w.selectedAtoms(s.selection):console.log("addIsosurface needs viewer is selection provided.")),s.coords!==void 0){var G=s.coords[0].x,V=s.coords[0].y,Z=s.coords[0].z,xe=s.coords[0].x,ce=s.coords[0].y,Ne=s.coords[0].z;for(let Fe=0;Fe<s.coords.length;Fe++)s.coords[Fe].x>G?G=s.coords[Fe].x:s.coords[Fe].x<xe&&(xe=s.coords[Fe].x),s.coords[Fe].y>V?V=s.coords[Fe].y:s.coords[Fe].y<ce&&(ce=s.coords[Fe].y),s.coords[Fe].z>Z?Z=s.coords[Fe].z:s.coords[Fe].z<Ne&&(Ne=s.coords[Fe].z);var Pe=2;s.radius!==void 0&&(Pe=s.radius),s.selectedOffset!==void 0&&(Pe=s.selectedOffset),s.seldist!==void 0&&(Pe=s.seldist),xe-=Pe,G+=Pe,ce-=Pe,V+=Pe,Ne-=Pe,Z+=Pe;for(let Fe=0;Fe<H.length;Fe++)H[Fe].x>xe&&H[Fe].x<G&&H[Fe].y>ce&&H[Fe].y<V&&H[Fe].z>Ne&&H[Fe].z<Z&&k.inSelectedRegion(H[Fe],s.coords,Pe)?(q.push(W.length),W.push(H[Fe])):q.push(-1);for(let Fe=0;Fe+2<$.length;Fe+=3)q[$[Fe]]!==-1&&q[$[Fe+1]]!==-1&&q[$[Fe+2]]!==-1&&(Y.push($[Fe]-($[Fe]-q[$[Fe]])),Y.push($[Fe+1]-($[Fe+1]-q[$[Fe+1]])),Y.push($[Fe+2]-($[Fe+2]-q[$[Fe+2]])));H=W,$=Y}k.drawCustom(this,this.geo,{vertexArr:H,faceArr:$,normalArr:[],clickable:s.clickable,hoverable:s.hoverable}),this.updateStyle(s);var De=new u.Vector3(l.origin.x,l.origin.y,l.origin.z),Me=new u.Vector3(l.size.x*l.unit.x,l.size.y*l.unit.y,l.size.z*l.unit.z),Be=new u.Vector3(0,0,0),ft=De.clone(),jt=De.clone().add(Me);for(let Fe=0;Fe<H.length;Fe++)Be.add(H[Fe]),ft.max(H[Fe]),jt.min(H[Fe]);Be.divideScalar(H.length);var Gt=Be.distanceTo(jt),mt=Be.distanceTo(ft);this.boundingSphere.center=Be,this.boundingSphere.radius=Math.max(Gt,mt),typeof y=="function"&&y()}addVolumetricData(l,s,y){l=new g.VolumeData(l,s),this.addIsosurface(l,y)}finalize(){return k.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj(l){if(this.renderedShapeObj&&(l.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){k.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),typeof this.color<"u"&&k.updateColor(this.geo,this.color),this.shapeObj=new o.Object3D;var s=null;this.side==o.DoubleSide?s=new o.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:o.Coloring.VertexColors}):s=new o.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:o.Coloring.VertexColors});var y=new o.Mesh(this.geo,s);if(this.shapeObj.add(y),this.linegeo&&this.linegeo.vertices>0){var w=new o.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),S=new o.Line(this.linegeo,w,o.LineStyle.LinePieces);this.shapeObj.add(S)}this.renderedShapeObj=this.shapeObj.clone(),l.add(this.renderedShapeObj)}}removegl(l){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),l.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}k.ISDONE=2,k.drawCustom=function(z,l,s){var y=s,w=y.vertexArr,S=y.faceArr;(w.length===0||S.length===0)&&console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var C=s.color;typeof C>"u"&&(C=z.color),C=v.CC.color(C);for(var h=A(y),x=0,R=h.length;x<R;x++)k.addCustomGeo(z,l,h[x],h[x].colorArr?h[x].colorArr:C,s.clickable)};function A(z){var l=64e3;if(z.vertexArr.length<l)return[z];var s=[{vertexArr:[],normalArr:[],faceArr:[]}];z.colorArr&&(s.colorArr=[]);var y=[],w=[],S=0,C=z.faceArr;for(let x=0,R=C.length;x<R;x+=3){let M=s[S];for(let P=0;P<3;P++){var h=C[x+P];y[h]!==S&&(y[h]=S,w[h]=M.vertexArr.length,M.vertexArr.push(z.vertexArr[h]),z.normalArr&&z.normalArr[h]&&M.normalArr.push(z.normalArr[h]),z.colorArr&&z.colorArr[h]&&M.colorArr.push(z.colorArr[h])),M.faceArr.push(w[h])}M.vertexArr.length>=l&&(s.push({vertexArr:[],normalArr:[],faceArr:[]}),z.colorArr&&(s.colorArr=[]),S++)}return s}}),"./src/GLViewer.ts":((e,r,t)=>{t.r(r),t.d(r,{CONTEXTS_PER_VIEWPORT:()=>l,GLViewer:()=>s,createStereoViewer:()=>S,createViewer:()=>y,createViewerGrid:()=>w});var o=t("./src/WebGL/index.ts"),c=t("./src/WebGL/math/index.ts"),u=t("./src/colors.ts"),v=t("./src/utilities.ts"),f=t("./src/Gradient.ts"),g=t("./src/GLModel.ts"),_=t("./src/Label.ts"),p=t("./src/GLShape.ts"),E=t("./src/VolumeData.ts"),k=t("./src/ProteinSurface4.ts"),A=t("./src/VolumetricRender.ts"),z=t("./node_modules/upng-js/UPNG.js");const l=16;class s{getWidth(){let h=this.container,x=h.offsetWidth;if(x==0&&h.style.display==="none"){let R=h.style.position,M=h.style.visibility;h.style.display="block",h.style.visibility="hidden",h.style.position="absolute",x=h.offsetWidth,h.style.display="none",h.style.visibility=M,h.style.position=R}return x}getHeight(){let h=this.container,x=h.offsetHeight;if(x==0&&h.style.display==="none"){let R=h.style.position,M=h.style.visibility;h.style.display="block",h.style.visibility="hidden",h.style.position="absolute",x=h.offsetHeight,h.style.display="none",h.style.visibility=M,h.style.position=R}return x}setupRenderer(){this.renderer=new o.Renderer({antialias:this.config.antialias,preserveDrawingBuffer:!0,premultipliedAlpha:!1,id:this.config.id,row:this.config.row,col:this.config.col,rows:this.config.rows,cols:this.config.cols,canvas:this.config.canvas,containerWidth:this.WIDTH,containerHeight:this.HEIGHT,ambientOcclusion:this.config.ambientOcclusion,outline:this.config.outline}),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new o.Scene,this.scene.fog=new o.Fog(this.bgColor,100,200),this.modelGroup=new o.Object3D,this.rotationGroup=new o.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new c.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var h=new o.Light(16777215);h.position=new c.Vector3(.2,.2,1).normalize(),h.intensity=1,this.scene.add(h)}_handleLostContext(h){const x=function(R){const M=R.getBoundingClientRect();return!(M.right<0||M.bottom<0||M.top>(window.innerHeight||document.documentElement.clientHeight)||M.left>(window.innerWidth||document.documentElement.clientWidth))};if(x(this.container)){let R=0;for(let M of document.getElementsByTagName("canvas"))if(x(M)&&M._3dmol_viewer!=null&&(M._3dmol_viewer.resize(),R+=1,R>=l))break}}initContainer(h){this.container=h,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var h=0;for(let R in this.surfaces)if(this.surfaces.hasOwnProperty(R)){var x=parseInt(R);isNaN(x)||x>h&&(h=x)}return h+1}setSlabAndFog(){let h=this.camera.position.z-this.rotationGroup.position.z;h<1&&(h=1),this.camera.near=h+this.slabNear,this.camera.near<1&&(this.camera.near=1),this.camera.far=h+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=h*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.far,this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(h){if(this.renderer.setViewport(),!!this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!h&&this.linkedViewers.length>0))for(var x=this._viewer.getView(),R=0;R<this.linkedViewers.length;R++){var M=this.linkedViewers[R];M.setView(x,!0)}}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let h=0,x=this.models.length;h<x;h++){let R=this.models[h];if(R){let M=R.selectedAtoms({clickable:!0}),P=R.selectedAtoms({hoverable:!0}),D=R.selectedAtoms({contextMenuEnabled:!0});for(let L=0;L<P.length;L++)this.hoverables.push(P[L]);for(let L=0;L<M.length;L++)this.clickables.push(M[L]);for(let L=0;L<D.length;L++)this.contextMenuEnabledObjects.push(D[L])}}for(let h=0,x=this.shapes.length;h<x;h++){let R=this.shapes[h];R&&R.clickable&&this.clickables.push(R),R&&R.hoverable&&this.hoverables.push(R),R&&R.contextMenuEnabled&&this.contextMenuEnabledObjects.push(R)}}handleClickSelection(h,x,R){let M=this.targetedObjects(h,x,this.clickables);if(M.length){var P=M[0].clickable;P.callback!==void 0&&(typeof P.callback!="function"&&(P.callback=(0,v.makeFunction)(P.callback)),typeof P.callback=="function"&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(P)&&this.userContextMenuHandler||P.callback(P,this._viewer,R,this.container,M)))}}canvasOffset(){let h=this.glDOM,x=h.getBoundingClientRect(),R=h.ownerDocument,M=R.documentElement,P=R.defaultView;return{top:x.top+P.pageYOffset-M.clientTop,left:x.left+P.pageXOffset-M.clientLeft}}setHover(h,x,R){this.current_hover!=h&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,v.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,x,this.container,R)),this.current_hover=h,h&&h.hover_callback!==void 0&&(typeof h.hover_callback!="function"&&(h.hover_callback=(0,v.makeFunction)(h.hover_callback)),typeof h.hover_callback=="function"&&h.hover_callback(h,this._viewer,x,this.container,R)))}handleHoverSelection(h,x,R){if(this.hoverables.length==0)return;let M=this.targetedObjects(h,x,this.hoverables);if(M.length){var P=M[0].clickable;this.setHover(P,R,M),this.current_hover=P}else this.setHover(null)}handleHoverContinue(h,x){let R=this.targetedObjects(h,x,this.hoverables);(R.length==0||R[0]===void 0)&&this.setHover(null),R[0]!==void 0&&R[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(h,{allowTolerance:x=h.targetTouches,tolerance:R=5}={}){const M=this.getX(h),P=this.getY(h);if(x){const D=Math.abs(M-this.mouseStartX),L=Math.abs(P-this.mouseStartY);return D<=R&&L<=R}else return M===this.mouseStartX&&P===this.mouseStartY}calcTouchDistance(h){var x=h.targetTouches[0].pageX-h.targetTouches[1].pageX,R=h.targetTouches[0].pageY-h.targetTouches[1].pageY;return Math.hypot(x,R)}getX(h){var x=h.pageX;return x==null&&(x=h.pageX),h.targetTouches&&h.targetTouches[0]?x=h.targetTouches[0].pageX:h.changedTouches&&h.changedTouches[0]&&(x=h.changedTouches[0].pageX),x}getY(h){var x=h.pageY;return x==null&&(x=h.pageY),h.targetTouches&&h.targetTouches[0]?x=h.targetTouches[0].pageY:h.changedTouches&&h.changedTouches[0]&&(x=h.changedTouches[0].pageY),x}isInViewer(h,x){if(this.viewers!=null){var R=this.WIDTH/this.cols,M=this.HEIGHT/this.rows,P=this.canvasOffset(),D=h-P.left,L=x-P.top,X=this.rows-Math.floor(L/M)-1,B=Math.floor(D/R);if(X!=this.row||B!=this.col)return!1}return!0}adjustZoomToLimits(h){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let x=this.CAMERA_Z-this.config.lowerZoomLimit;h>x&&(h=x)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let x=this.CAMERA_Z-this.config.upperZoomLimit;h<x&&(h=x)}return h>this.CAMERA_Z-1&&(h=this.CAMERA_Z-1),h}static slerp(h,x,R){if(R==1)return x.clone();if(R==0)return h.clone();let M=h.x*x.x+h.y*x.y+h.z*x.z+h.w*x.w;if(M>.9995){let H=new c.Quaternion(h.x+R*(x.x-h.x),h.y+R*(x.y-h.y),h.z+R*(x.z-h.z),h.w+R*(x.w-h.w));return H.normalize(),H}M<0&&(x=x.clone().multiplyScalar(-1),M=-M),M>1?M=1:M<-1&&(M=-1);var P=Math.acos(M),D=P*R,L=x.clone();L.sub(h.clone().multiplyScalar(M)),L.normalize();var X=Math.cos(D),B=Math.sin(D),j=new c.Quaternion(h.x*X+L.x*B,h.y*X+L.y*B,h.z*X+L.z*B,h.w*X+L.w*B);return j.normalize(),j}constructor(h,x={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.slabNear=-50,this.slabFar=50,this.cq=new c.Quaternion(0,0,0,1),this.dq=new c.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=x,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=u.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",typeof this.config.backgroundColor<"u"&&(this.bgColor=u.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,typeof this.config.camerax<"u"&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=h,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new o.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new c.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new c.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new o.Raycaster(new c.Vector3(0,0,0),new c.Vector3(0,0,0)),this.projector=new o.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=u.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),typeof window.ResizeObserver<"u"&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),typeof window.IntersectionObserver<"u"){let R=(M,P)=>{M.forEach(D=>{D.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(R),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(R){console.log("error with glviewer callback: "+R)}}targetedObjects(h,x,R){var M={x:h,y:x,z:-1};return Array.isArray(R)||(R=this.selectedAtoms(R)),R.length==0?[]:(this.raycaster.setFromCamera(M,this.camera),this.raycaster.intersectObjects(this.modelGroup,R))}modelToScreen(h){let x=!1;Array.isArray(h)||(h=[h],x=!0);let R=this.renderer.getXRatio(),M=this.renderer.getYRatio(),P=this.col,D=this.row,L=P*(this.WIDTH/R),X=(M-D-1)*(this.HEIGHT/M),B=[],j=this.canvasOffset();return h.forEach(H=>{let $=new c.Vector3(H.x,H.y,H.z);$.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector($,this.camera);let q=this.WIDTH/R*($.x+1)/2+j.left+L,W=-(this.HEIGHT/M)*($.y-1)/2+j.top+X;B.push({x:q,y:W})}),x&&(B=B[0]),B}screenOffsetToModel(h,x,R){var M=h/this.WIDTH,P=x/this.HEIGHT,D=R===void 0?this.rotationGroup.position.z:R,L=this.rotationGroup.quaternion,X=new c.Vector3(0,0,D);return this.projector.projectVector(X,this.camera),X.x+=M*2,X.y-=P*2,this.projector.unprojectVector(X,this.camera),X.z=0,X.applyQuaternion(L),X}screenToModelDistance(h,x){let R=this.canvasOffset(),M=new c.Vector3(x.x,x.y,x.z);M.applyMatrix4(this.modelGroup.matrixWorld);let P=M.clone();this.projector.projectVector(M,this.camera);let D=new c.Vector3((h.x-R.left)*2/this.WIDTH-1,(h.y-R.top)*2/-this.HEIGHT+1,M.z);return this.projector.unprojectVector(D,this.camera),D.distanceTo(P)}setViewChangeCallback(h){(typeof h=="function"||h==null)&&(this.viewChangeCallback=h)}setStateChangeCallback(h){(typeof h=="function"||h==null)&&(this.stateChangeCallback=h)}getConfig(){return this.config}setConfig(h){this.config=h,h.ambientOcclusion&&this.renderer.enableAmbientOcclusion(h.ambientOcclusion)}getInternalState(){var h={models:[],surfaces:[],shapes:[],labels:[]};for(let x=0;x<this.models.length;x++)this.models[x]&&(h.models[x]=this.models[x].getInternalState());return h}setInternalState(h){this.clear();var x=h.models;for(let R=0;R<x.length;R++)x[R]&&(this.models[R]=new g.GLModel(R),this.models[R].setInternalState(x[R]));this.render()}setZoomLimits(h,x){typeof h<"u"&&(this.config.lowerZoomLimit=h),x&&(this.config.upperZoomLimit=x),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(h){h.fov!==void 0&&(this.fov=h.fov,this.camera.fov=this.fov),h.z!==void 0&&(this.CAMERA_Z=h.z,this.camera.z=this.CAMERA_Z),h.orthographic!==void 0&&(this.camera.ortho=h.orthographic)}_handleMouseDown(h){if(h.preventDefault(),!this.scene)return;var x=this.getX(h),R=this.getY(h);if(x===void 0)return;this.isDragging=!0,this.mouseButton=h.which,this.mouseStartX=x,this.mouseStartY=R,this.touchHold=!0,this.touchDistanceStart=0,h.targetTouches&&h.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(h)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let M=this;h.targetTouches&&h.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(M.touchHold==!0){M.glDOM=M.renderer.domElement;const P=h.targetTouches[0],D=new PointerEvent("contextmenu",Object.assign(Object.assign({},h),{pageX:P.pageX,pageY:P.pageY,screenX:P.screenX,screenY:P.screenY,clientX:P.clientX,clientY:P.clientY}));M.glDOM.dispatchEvent(D)}},this.longTouchDuration))}_handleMouseUp(h){if(this.touchHold=!1,this.isDragging&&this.scene){var x=this.getX(h),R=this.getY(h);if(this.closeEnoughForClick(h)&&this.isInViewer(x,R)){let M=this.mouseXY(x,R);this.handleClickSelection(M.x,M.y,h)}}this.isDragging=!1}_handleMouseScroll(h){if(h.preventDefault(),!!this.scene){var x=this.getX(h),R=this.getY(h);if(x!==void 0&&!(!this.control_all&&!this.isInViewer(x,R))){var M=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,P=1;if(h.ctrlKey&&(P=-1),h.detail)this.rotationGroup.position.z+=P*M*h.detail/10;else if(h.wheelDelta){let D=h.wheelDelta*600/(h.wheelDelta+600);this.rotationGroup.position.z-=P*M*D/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(h){let x=this;return h=h||1,new Promise(function(R){let M=0,P=x.viewChangeCallback,D=[],L=[],X=Date.now();x.viewChangeCallback=function(){L.push(Date.now()-X),X=Date.now(),D.push(new Promise(B=>{x.getCanvas().toBlob(function(j){j.arrayBuffer().then(B)},"image/png")})),M+=1,M==h&&(x.viewChangeCallback=P,Promise.all(D).then(B=>{let j=[];for(let G=0;G<B.length;G++){let V=(0,z.decode)(B[G]);j.push((0,z.toRGBA8)(V)[0])}let H=x.getCanvas().width,$=x.getCanvas().height,q=(0,z.encode)(j,H,$,0,L),W=new Blob([q],{type:"image/png"}),Y=new FileReader;Y.onload=function(G){R(G.target.result)},Y.readAsDataURL(W)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(h){this.hoverDuration=h}mouseXY(h,x){let R=this.canvasOffset(),M=this.renderer.getXRatio(),P=this.renderer.getYRatio(),D=this.col,L=this.row,X=D*(this.WIDTH/M),B=(P-L-1)*(this.HEIGHT/P),j=(h-R.left-X)/(this.WIDTH/M)*2-1,H=-((x-R.top-B)/(this.HEIGHT/P))*2+1;return{x:j,y:H}}_handleMouseMove(h){clearTimeout(this.hoverTimeout),h.preventDefault();let x=this.getX(h),R=this.getY(h);if(x===void 0)return;let M=this.renderer.getXRatio(),P=this.renderer.getYRatio(),D=this.mouseXY(x,R),L=this;this.current_hover!==null&&this.handleHoverContinue(D.x,D.y);var X=0;if(!(!this.control_all&&!this.isInViewer(x,R))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){L.handleHoverSelection(D.x,D.y,h)},this.hoverDuration)),!!this.isDragging)){h.targetTouches&&(h.targetTouches.length>1||h.targetTouches.length===1&&!this.closeEnoughForClick(h))&&clearTimeout(this.longTouchTimeout);var B=(x-this.mouseStartX)/this.WIDTH,j=(R-this.mouseStartY)/this.HEIGHT;if(this.touchDistanceStart!=0&&h.targetTouches&&h.targetTouches.length==2){var H=this.calcTouchDistance(h);X=2,j=(H-this.touchDistanceStart)*2/(this.WIDTH+this.HEIGHT)}else h.targetTouches&&h.targetTouches.length==3&&(X=1);B*=M,j*=P;var $=Math.hypot(B,j),q;if(X==3||this.mouseButton==3&&h.ctrlKey)this.slabNear=this.cslabNear+B*100,this.slabFar=this.cslabFar-j*100;else if(X==2||this.mouseButton==3||h.shiftKey)q=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,q<80&&(q=80),this.rotationGroup.position.z=this.cz+j*q,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(X==1||this.mouseButton==2||h.ctrlKey){var W=this.screenOffsetToModel(M*(x-this.mouseStartX),P*(R-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,W)}else if((X===0||this.mouseButton==1)&&$!==0){var Y=Math.sin($*Math.PI)/$;this.dq.x=Math.cos($*Math.PI),this.dq.y=0,this.dq.z=Y*B,this.dq.w=-Y*j,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(h){if(h.preventDefault(),this.closeEnoughForClick(h)){var M=this.mouseStartX,P=this.mouseStartY,R=this.canvasOffset();let D=this.mouseXY(M,P),L=D.x,X=D.y,B=this.targetedObjects(L,X,this.contextMenuEnabledObjects);var x=null;B.length&&(x=B[0].clickable);var R=this.canvasOffset(),M=this.mouseStartX-R.left,P=this.mouseStartY-R.top;this.userContextMenuHandler&&(this.userContextMenuHandler(x,M,P,B,h),this.isDragging=!1)}}setContainer(h){let x=(0,v.getElement)(h)||this.container;return this.initContainer(x),this}setBackgroundColor(h,x){(typeof x>"u"||x<0||x>1)&&(x=1);var R=u.CC.color(h);return this.scene.fog.color=R,this.bgColor=R.getHex(),this.renderer.setClearColorHex(R.getHex(),x),this.show(),this}setProjection(h){this.camera.ortho=h==="orthographic",this.setSlabAndFog()}setViewStyle(h){if(h=h||{},h.style=h.style||"",h.style.includes("outline")){var x={};h.color&&(x.color=u.CC.color(h.color)),h.width&&(x.width=h.width),this.renderer.enableOutline(x)}else this.renderer.disableOutline();if(h.style.includes("ambientOcclusion")){var x={};h.strength&&(x.strength=h.strength),h.radius&&(x.radius=h.radius),this.renderer.enableAmbientOcclusion(x)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(h){return this.WIDTH=h||this.WIDTH,this.updateSize(),this}setHeight(h){return this.HEIGHT=h||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let h=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let x=!1,R=this.container.querySelector("canvas");R&&R!=this.renderer.getCanvas()?this.config.canvas=R:(R.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,x=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),h=!0,x&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),h){let x=this.renderer.supportedExtensions();if(x.regen=!0,this.viewers)for(let R=0,M=this.viewers.length;R<M;R++)for(let P=0,D=this.viewers[R].length;P<D;P++)this.viewers[R][P].render(null,x);this._viewer.render(null,x)}else this.show();return this}getModel(h){return h===void 0?this.models.length==0?null:this.models[this.models.length-1]:h instanceof g.GLModel?h:h in this.models?this.models[h]:this.models.length==0?null:this.models[this.models.length-1]}spin(h,x=1){if(clearInterval(this.spinInterval),typeof h>"u"&&(h="y"),typeof h=="boolean")if(h)h="y";else return;Array.isArray(h)&&(h={x:h[0],y:h[1],z:h[2]});var R=this;this.spinInterval=setInterval(function(){!R.getCanvas().isConnected&&R.renderer.isLost()&&clearInterval(R.spinInterval),R.rotate(1*x,h)},25)}animateMotion(h,x,R,M,P,D){var L=20,X=Math.ceil(h/L);X<1&&(X=1),this.incAnim();var B={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(x){let $=new Array(X);for(let G=0;G<X;G++){let V=(G+1)/X,Z={mpos:B.mpos,rz:B.rz,rot:B.rot};Z.mpos=R.clone().sub(B.mpos).multiplyScalar(V).add(B.mpos),Z.rz=B.rz+V*(M-B.rz),Z.rot=s.slerp(B.rot,P,V),Z.cam=D.clone().sub(B.cam).multiplyScalar(V).add(B.cam),$[G]=Z}let q=0,W=this,Y=function(){var G=$[q];q+=1,W.modelGroup.position=G.mpos,W.rotationGroup.position.z=G.rz,W.rotationGroup.quaternion=G.rot,W.camera.lookAt(G.cam),q<$.length?setTimeout(Y,L):W.decAnim(),W.show()};setTimeout(Y,L)}else{var j={};let $=1/X;if(R&&(j.mpos=R.clone().sub(B.mpos).multiplyScalar($)),typeof M<"u"&&M!=null&&(j.rz=$*(M-B.rz)),P){var H=s.slerp(B.rot,P,$);j.rot=B.rot.clone().inverse().multiply(H)}D&&(j.cam=D.clone().sub(B.cam).multiplyScalar($));let q=0,W=this,Y=function(){q+=1,j.mpos&&W.modelGroup.position.add(j.mpos),j.rz&&(W.rotationGroup.position.z+=j.rz),j.rot&&W.rotationGroup.quaternion.multiply(j.rot),j.cam&&(W.lookingAt.add(j.cam),W.camera.lookAt(W.lookingAt)),q<X?setTimeout(Y,L):W.decAnim(),W.show()};setTimeout(Y,L)}}rotate(h,x="y",R=0,M=!1){if(x=="x"?x={x:1,y:0,z:0}:x=="y"?x={x:0,y:1,z:0}:x=="z"&&(x={x:0,y:0,z:1}),x=="vx"?x={vx:1,vy:0,vz:0}:x=="vy"?x={vx:0,vy:1,vz:0}:x=="vz"&&(x={vx:0,vy:0,vz:1}),typeof x.vx<"u"){var P=new c.Vector3(x.vx,x.vy,x.vz);P.applyQuaternion(this.rotationGroup.quaternion),x={x:P.x,y:P.y,z:P.z}}var D=function(j){var H=Math.sin(j/2),$=Math.cos(j/2),q=0,W=0,Y=0;return q=x.x*H,W=x.y*H,Y=x.z*H,new c.Quaternion(q,W,Y,$).normalize()},L=Math.PI*h/180,X=D(L);if(R){var B=new c.Quaternion().copy(this.rotationGroup.quaternion).multiply(X);this.animateMotion(R,M,this.modelGroup.position,this.rotationGroup.position.z,B,this.lookingAt)}else this.rotationGroup.quaternion.multiply(X),this.show();return this}surfacesFinished(){for(var h in this.surfaces)if(!this.surfaces[h][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var h=this.modelGroup.position,x=this.rotationGroup.quaternion;return[h.x,h.y,h.z,this.rotationGroup.position.z,x.x,x.y,x.z,x.w]}setView(h,x){return h===void 0||!(h instanceof Array||h.length!==8)?this:!this.modelGroup||!this.rotationGroup?this:(this.modelGroup.position.x=h[0],this.modelGroup.position.y=h[1],this.modelGroup.position.z=h[2],this.rotationGroup.position.z=h[3],this.rotationGroup.quaternion.x=h[4],this.rotationGroup.quaternion.y=h[5],this.rotationGroup.quaternion.z=h[6],this.rotationGroup.quaternion.w=h[7],typeof h[8]<"u"&&(this.rotationGroup.position.x=h[8],this.rotationGroup.position.y=h[9]),this.show(x),this)}render(h,x){this.renderer.setViewport(),this.updateClickables();var R=this.getView();this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState());var M,P;for(x||(x=this.renderer.supportedExtensions()),M=0;M<this.models.length;M++)this.models[M]&&this.models[M].globj(this.modelGroup,x);for(M=0;M<this.shapes.length;M++)this.shapes[M]&&(typeof this.shapes[M].frame>"u"||this.viewer_frame<0||this.shapes[M].frame<0||this.shapes[M].frame==this.viewer_frame?this.shapes[M].globj(this.modelGroup,x):this.shapes[M].removegl(this.modelGroup));for(M=0;M<this.labels.length;M++)x.regen&&(this.labels[M].dispose(),this.modelGroup.remove(this.labels[M].sprite),this.labels[M].setContext(),this.modelGroup.add(this.labels[M].sprite)),this.labels[M]&&typeof this.labels[M].frame<"u"&&this.labels[M].frame>=0&&(this.modelGroup.remove(this.labels[M].sprite),(this.viewer_frame<0||this.labels[M].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[M].sprite));for(M in this.surfaces)if(this.surfaces.hasOwnProperty(M)){var D=this.surfaces[M];for(P=0;P<D.length;P++)if(D.hasOwnProperty(P)){var L=D[P].geo;if(!D[P].finished||x.regen){L.verticesNeedUpdate=!0,L.elementsNeedUpdate=!0,L.normalsNeedUpdate=!0,L.colorsNeedUpdate=!0,L.buffersNeedUpdate=!0,L.boundingSphere=null,D[P].mat.needsUpdate=!0,D[P].done&&(D[P].finished=!0),D[P].lastGL&&this.modelGroup.remove(D[P].lastGL);var X=null;if(D[P].mat instanceof o.LineBasicMaterial?X=new o.Line(L,D[P].mat):X=new o.Mesh(L,D[P].mat),D[P].mat.transparent&&D[P].mat.opacity==0?X.visible=!1:X.visible=!0,D[P].symmetries.length>1||D[P].symmetries.length==1&&!D[P].symmetries[P].isIdentity()){var B,j=new o.Object3D;for(B=0;B<D[P].symmetries.length;B++){var H=X.clone();H.matrix=D[P].symmetries[B],H.matrixAutoUpdate=!1,j.add(H)}D[P].lastGL=j,this.modelGroup.add(j)}else D[P].lastGL=X,this.modelGroup.add(X)}}}return this.setView(R),typeof h=="function"&&h(this),this}getModelList(h){let x=[];if(typeof h>"u"||typeof h.model>"u")for(let M=0;M<this.models.length;M++)this.models[M]&&x.push(this.models[M]);else{let M=h.model;Array.isArray(M)||(M=[M]);for(let P=0;P<M.length;P++)if(typeof M[P]=="number"){var R=M[P];R<0&&(R+=this.models.length),x.push(this.models[R])}else x.push(M[P])}return x}getAtomsFromSel(h){var x=[];typeof h>"u"&&(h={});var R=this.getModelList(h);for(let M=0;M<R.length;M++)x=x.concat(R[M].selectedAtoms(h));return x}atomIsSelected(h,x){typeof x>"u"&&(x={});for(var R=this.getModelList(x),M=0;M<R.length;M++)if(R[M].atomIsSelected(h,x))return!0;return!1}selectedAtoms(h){return this.getAtomsFromSel(h)}getUniqueValues(h,x){typeof x>"u"&&(x={});var R=this.getAtomsFromSel(x),M={};for(var P in R)if(R[P].hasOwnProperty(h)){var D=R[P][h];M[D]=!0}return Object.keys(M)}pdbData(h){for(var x=this.getAtomsFromSel(h),R="",M=0,P=x.length;M<P;++M)R+=x[M].pdbline+`
`;return R}zoom(h=2,x=0,R=!1){var M=(this.CAMERA_Z-this.rotationGroup.position.z)/h,P=this.CAMERA_Z-M;return x>0?this.animateMotion(x,R,this.modelGroup.position,this.adjustZoomToLimits(P),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(P),this.show()),this}translate(h,x,R=0,M=!1){var P=h/this.WIDTH,D=x/this.HEIGHT,L=new c.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(L,this.camera),L.x-=P,L.y-=D,this.projector.unprojectVector(L,this.camera),L.z=0;var X=this.lookingAt.clone().add(L);return R>0?this.animateMotion(R,M,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,X):(this.lookingAt=X,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(h,x,R=0,M=!1){var P=this.screenOffsetToModel(h,x),D=this.modelGroup.position.clone().add(P);return R>0?this.animateMotion(R,M,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=D,this.show()),this}fitSlab(h){h=h||{};var x=this.getAtomsFromSel(h),R=(0,v.getExtent)(x),M=R[1][0]-R[0][0],P=R[1][1]-R[0][1],D=R[1][2]-R[0][2],L=Math.hypot(M,P,D);return L<5&&(L=5),this.slabNear=-L/1.9,this.slabFar=L/2,this}center(h={},x=0,R=!1){var M,P,D=this.getAtomsFromSel(h),L=(0,v.getExtent)(D);(0,v.isEmptyObject)(h)?(this.shapes.forEach(V=>{if(V&&V.boundingSphere&&V.boundingSphere.center){var Z=V.boundingSphere.center,xe=V.boundingSphere.radius;xe>0?(D.push(new c.Vector3(Z.x+xe,Z.y,Z.z)),D.push(new c.Vector3(Z.x-xe,Z.y,Z.z)),D.push(new c.Vector3(Z.x,Z.y+xe,Z.z)),D.push(new c.Vector3(Z.x,Z.y-xe,Z.z)),D.push(new c.Vector3(Z.x,Z.y,Z.z+xe)),D.push(new c.Vector3(Z.x,Z.y,Z.z-xe))):D.push(Z)}}),L=(0,v.getExtent)(D),M=D,P=L):(M=this.getAtomsFromSel({}),P=(0,v.getExtent)(M));var X=new c.Vector3(L[2][0],L[2][1],L[2][2]),B=P[1][0]-P[0][0],j=P[1][1]-P[0][1],H=P[1][2]-P[0][2],$=Math.hypot(B,j,H);$<5&&($=5),this.slabNear=-$/1.9,this.slabFar=$/2,B=L[1][0]-L[0][0],j=L[1][1]-L[0][1],H=L[1][2]-L[0][2],$=Math.hypot(B,j,H),$<5&&($=5);for(var q=25,W=0;W<D.length;W++)if(D[W]){var Y=X.distanceToSquared(D[W]);Y>q&&(q=Y)}$=Math.sqrt(q)*2;var G=X.clone().multiplyScalar(-1);return x>0?this.animateMotion(x,R,G,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=G,this.show()),this}zoomTo(h={},x=0,R=!1){let M=this.getAtomsFromSel(h),P=(0,v.getExtent)(M),D=P;if((0,v.isEmptyObject)(h)){let Z=M&&M.length;if(this.shapes.forEach(xe=>{if(xe&&xe.boundingSphere){if(xe.boundingSphere.box){let Pe=xe.boundingSphere.box;M.push(new c.Vector3(Pe.min.x,Pe.min.y,Pe.min.z)),M.push(new c.Vector3(Pe.max.x,Pe.max.y,Pe.max.z))}else if(xe.boundingSphere.center){var ce=xe.boundingSphere.center,Ne=xe.boundingSphere.radius;Ne>0?(M.push(new c.Vector3(ce.x+Ne,ce.y,ce.z)),M.push(new c.Vector3(ce.x-Ne,ce.y,ce.z)),M.push(new c.Vector3(ce.x,ce.y+Ne,ce.z)),M.push(new c.Vector3(ce.x,ce.y-Ne,ce.z)),M.push(new c.Vector3(ce.x,ce.y,ce.z+Ne)),M.push(new c.Vector3(ce.x,ce.y,ce.z-Ne))):M.push(ce)}}}),D=(0,v.getExtent)(M),!Z)for(let xe=0;xe<3;xe++)P[2][xe]=(D[0][xe]+D[1][xe])/2}else{let Z=this.getAtomsFromSel({});D=(0,v.getExtent)(Z)}var L=new c.Vector3(P[2][0],P[2][1],P[2][2]),X=D[1][0]-D[0][0],B=D[1][1]-D[0][1],j=D[1][2]-D[0][2],H=Math.hypot(X,B,j);H<5&&(H=5),this.slabNear=-H/1.9,this.slabFar=H/2,Object.keys(h).length===0&&(this.slabNear=Math.min(-H*2,-50),this.slabFar=Math.max(H*2,50));var $=this.config.minimumZoomToDistance||5;X=P[1][0]-P[0][0],B=P[1][1]-P[0][1],j=P[1][2]-P[0][2],H=Math.hypot(X,B,j),H<$&&(H=$);for(var q=$*$,W=0;W<M.length;W++)if(M[W]){var Y=L.distanceToSquared(M[W]);Y>q&&(q=Y)}H=Math.sqrt(q)*2;var G=L.clone().multiplyScalar(-1),V=-(H*.5/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return V=this.adjustZoomToLimits(V),x>0?this.animateMotion(x,R,G,V,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=G,this.rotationGroup.position.z=V,this.show()),this}setSlab(h,x){this.slabNear=h,this.slabFar=x}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(h,x={},R,M=!1){if(R){var P=(0,v.getExtent)(this.getAtomsFromSel(R));x.position={x:P[2][0],y:P[2][1],z:P[2][2]}}var D=new _.Label(h,x);return D.setContext(),this.modelGroup.add(D.sprite),this.labels.push(D),M||this.show(),D}addResLabels(h,x,R=!1){let M=this.labels.length;return this.applyToModels("addResLabels",h,this,x,R),this.show(),this.labels.slice(M)}addPropertyLabels(h,x,R){return this.applyToModels("addPropertyLabels",h,x,this,R),this.show(),this}removeLabel(h){for(var x=0;x<this.labels.length;x++)if(this.labels[x]==h){this.labels.splice(x,1),h.dispose(),this.modelGroup.remove(h.sprite);break}return this.show(),this}removeAllLabels(){for(var h=0;h<this.labels.length;h++)this.labels[h]&&this.labels[h].sprite&&this.modelGroup.remove(this.labels[h].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}setLabelStyle(h,x){return this.modelGroup.remove(h.sprite),h.dispose(),h.stylespec=x,h.setContext(),this.modelGroup.add(h.sprite),this.show(),h}setLabelText(h,x){return this.modelGroup.remove(h.sprite),h.dispose(),h.text=x,h.setContext(),this.modelGroup.add(h.sprite),this.show(),h}addShape(h){h=h||{};var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,this.shapes.push(x),x}removeShape(h){if(!h)return this;for(h.removegl(this.modelGroup),delete this.shapes[h.shapePosition];this.shapes.length>0&&typeof this.shapes[this.shapes.length-1]>"u";)this.shapes.pop();return this}removeAllShapes(){for(var h=0;h<this.shapes.length;h++){var x=this.shapes[h];x&&x.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(h){if(h.hasOwnProperty("x")&&h.hasOwnProperty("y")&&h.hasOwnProperty("z"))return h;var x=this.getAtomsFromSel(h);if(x.length==0)return{x:0,y:0,z:0};var R=(0,v.getExtent)(x);return{x:R[0][0]+(R[1][0]-R[0][0])/2,y:R[0][1]+(R[1][1]-R[0][1])/2,z:R[0][2]+(R[1][2]-R[0][2])/2}}addSphere(h){h=h||{},h.center=this.getSelectionCenter(h.center);var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,x.addSphere(h),this.shapes.push(x),x.finalize(),x}addBox(h={}){h.corner!=null&&(h.corner=this.getSelectionCenter(h.corner)),h.center!=null&&(h.center=this.getSelectionCenter(h.center));var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,x.addBox(h),this.shapes.push(x),x.finalize(),x}addArrow(h={}){h.start=this.getSelectionCenter(h.start),h.end=this.getSelectionCenter(h.end);var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,x.addArrow(h),this.shapes.push(x),x.finalize(),x}addCylinder(h={}){h.start=this.getSelectionCenter(h.start),h.end=this.getSelectionCenter(h.end);var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,h.dashed?x.addDashedCylinder(h):x.addCylinder(h),this.shapes.push(x),x.finalize(),x}addCurve(h={}){var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,x.addCurve(h),this.shapes.push(x),x.finalize(),x}addLine(h={}){h.start=this.getSelectionCenter(h.start),h.end=this.getSelectionCenter(h.end),h.wireframe=!0;var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,h.dashed?x=this.addLineDashed(h,x):x.addLine(h),this.shapes.push(x),x.finalize(),x}addUnitCell(h,x){h=this.getModel(h),x=x||{alabel:"a",blabel:"b",clabel:"c"},x.box=x.box||{},x.astyle=x.astyle||{color:"red",radius:.1,midpos:-1},x.bstyle=x.bstyle||{color:"green",radius:.1,midpos:-1},x.cstyle=x.cstyle||{color:"blue",radius:.1,midpos:-1},x.alabelstyle=x.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},x.blabelstyle=x.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},x.clabelstyle=x.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},h.unitCellObjects&&this.removeUnitCell(h),h.unitCellObjects={shapes:[],labels:[]};var R=h.getCrystData(),M=null;if(R){if(R.matrix)M=R.matrix;else{var P=R.a,D=R.b,L=R.c,X=R.alpha,B=R.beta,j=R.gamma;X=X*Math.PI/180,B=B*Math.PI/180,j=j*Math.PI/180;var H,$,q;H=Math.cos(B),$=(Math.cos(X)-Math.cos(B)*Math.cos(j))/Math.sin(j),q=Math.sqrt(Math.max(0,1-H*H-$*$)),M=new c.Matrix3(P,D*Math.cos(j),L*H,0,D*Math.sin(j),L*$,0,0,L*q)}var W=[new c.Vector3(0,0,0),new c.Vector3(1,0,0),new c.Vector3(0,1,0),new c.Vector3(0,0,1),new c.Vector3(1,1,0),new c.Vector3(0,1,1),new c.Vector3(1,0,1),new c.Vector3(1,1,1)];if(R.matrix4)for(let G=0;G<W.length;G++)R.size&&W[G].multiplyVectors(W[G],R.size),W[G]=W[G].applyMatrix4(R.matrix4);else for(let G=0;G<W.length;G++)W[G]=W[G].applyMatrix3(M);if(x.box&&!x.box.hidden){x.box.wireframe=!0;var Y=new p.GLShape(x.box);Y.shapePosition=this.shapes.length,Y.addLine({start:W[0],end:W[1]}),Y.addLine({start:W[0],end:W[2]}),Y.addLine({start:W[1],end:W[4]}),Y.addLine({start:W[2],end:W[4]}),Y.addLine({start:W[0],end:W[3]}),Y.addLine({start:W[3],end:W[5]}),Y.addLine({start:W[2],end:W[5]}),Y.addLine({start:W[1],end:W[6]}),Y.addLine({start:W[4],end:W[7]}),Y.addLine({start:W[6],end:W[7]}),Y.addLine({start:W[3],end:W[6]}),Y.addLine({start:W[5],end:W[7]}),this.shapes.push(Y),h.unitCellObjects.shapes.push(Y),Y.finalize()}if(!x.astyle.hidden){x.astyle.start=W[0],x.astyle.end=W[1];let G=this.addArrow(x.astyle);h.unitCellObjects.shapes.push(G)}if(!x.bstyle.hidden){x.bstyle.start=W[0],x.bstyle.end=W[2];let G=this.addArrow(x.bstyle);h.unitCellObjects.shapes.push(G)}if(!x.cstyle.hidden){x.cstyle.start=W[0],x.cstyle.end=W[3];let G=this.addArrow(x.cstyle);h.unitCellObjects.shapes.push(G)}if(x.alabel){x.alabelstyle.position=W[1];let G=this.addLabel(x.alabel,x.alabelstyle);h.unitCellObjects.labels.push(G)}if(x.blabel){x.blabelstyle.position=W[2];let G=this.addLabel(x.blabel,x.blabelstyle);h.unitCellObjects.labels.push(G)}if(x.clabel){x.clabelstyle.position=W[3];let G=this.addLabel(x.clabel,x.clabelstyle);h.unitCellObjects.labels.push(G)}}}removeUnitCell(h){if(h=this.getModel(h),h.unitCellObjects){let x=this;h.unitCellObjects.shapes.forEach(function(R){x.removeShape(R)}),h.unitCellObjects.labels.forEach(function(R){x.removeLabel(R)})}delete h.unitCellObjects}replicateUnitCell(h=3,x=h,R=x,M,P,D){M=this.getModel(M);let L=M.getCrystData();if(L){const X=M.selectedAtoms({}),B=L.matrix;let j=function($){return $%2==0?-$/2:Math.ceil($/2)};h<=1&&x<=1&&R<=1&&(D=!0,h=x=R=3);let H=function($,q,W){return!1};if(D){const $=new c.Matrix3().getInverse3(B);H=function(q,W,Y){let G=new c.Vector3(q,W,Y).applyMatrix3($);return!(G.x>-1e-4&&G.x<1.0001&&G.y>-1e-4&&G.y<1.0001&&G.z>-1e-4&&G.z<1.0001)}}for(let $=0;$<h;$++)for(let q=0;q<x;q++)for(let W=0;W<R;W++){if($==0&&q==0&&W==0)continue;let Y=new c.Vector3(j($),j(q),j(W));Y.applyMatrix3(B);let G=[];for(let V=0;V<X.length;V++){let Z=X[V].x+Y.x,xe=X[V].y+Y.y,ce=X[V].z+Y.z;if(H(Z,xe,ce))continue;let Ne={};for(let Pe in X[V])Ne[Pe]=X[V][Pe];Ne.x=Z,Ne.y=xe,Ne.z=ce,G.push(Ne)}M.addAtoms(G)}P&&M.assignBonds()}}addLineDashed(h,x){h.dashLength=h.dashLength||.5,h.gapLength=h.gapLength||.5;var R;h.start?R=new c.Vector3(h.start.x||0,h.start.y||0,h.start.z||0):R=new c.Vector3(0,0,0);var M;h.end?M=new c.Vector3(h.end.x,h.end.y||0,h.end.z||0):M=new c.Vector3(0,0,0);var P=new c.Vector3,D=new c.Vector3,L=new c.Vector3,X,B,j,H=R.clone(),$=0;for(P.subVectors(M,R),X=P.length(),P.normalize(),D=P.clone(),L=P.clone(),D.multiplyScalar(h.dashLength),L.multiplyScalar(h.gapLength),B=D.length(),j=L.length();$<X;){if($+B>X){h.start=R,h.end=M,x.addLine(h);break}H.addVectors(R,D),h.start=R,h.end=H,x.addLine(h),R=H.clone(),$+=B,H.addVectors(R,L),R=H.clone(),$+=j}return x.finalize(),x}addCustom(h){h=h||{};var x=new p.GLShape(h);return x.shapePosition=this.shapes.length,x.addCustom(h),this.shapes.push(x),x.finalize(),x}addVolumetricData(h,x,R={}){var M=new E.VolumeData(h,x);return R.hasOwnProperty("transferfn")?this.addVolumetricRender(M,R):this.addIsosurface(M,R)}addIsosurface(h,x={},R){var M=new p.GLShape(x);return M.shapePosition=this.shapes.length,M.addIsosurface(h,x,R,this),this.shapes.push(M),M}addVolumetricRender(h,x){x=x||{};var R=new A.GLVolumetricRender(h,x,this);return R.shapePosition=this.shapes.length,this.shapes.push(R),R}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(h){h?this.scene.fog=new o.Fog(this.bgColor,100,200):(this.config.disableFog=!0,this.show())}setFrame(h){this.viewer_frame=h;let x=this;return new Promise(function(R){var M=x.models.map(function(P){return P.setFrame(h,x)});Promise.all(M).then(function(){R()})})}getFrame(){return this.viewer_frame}getNumFrames(){var h=0;for(let x=0;x<this.models.length;x++)this.models[x].getNumFrames()>h&&(h=this.models[x].getNumFrames());for(let x=0;x<this.shapes.length;x++)this.shapes[x].frame&&this.shapes[x].frame>=h&&(h=this.shapes[x].frame+1);for(let x=0;x<this.labels.length;x++)this.labels[x].frame&&this.labels[x].frame>=h&&(h=this.labels[x].frame+1);return h}animate(h){this.incAnim();var x=100,R="forward",M=1/0;h=h||{},h.interval&&(x=h.interval),h.loop&&(R=h.loop),h.reps&&(M=h.reps);var P=this.getNumFrames(),D=this,L=0;h.startFrame&&(L=h.startFrame%P);var X=1;h.step&&(X=h.step,M/=X);var B=0,j=P*M,H=new Date,$,q,W=function(Y){H=new Date,Y=="forward"?D.setFrame(L).then(function(){L=(L+X)%P,$()}):Y=="backward"?D.setFrame(P-1-L).then(function(){L=(L+X)%P,$()}):D.setFrame(L).then(function(){L+=X,X*=L%(P-1)==0?-1:1,$()})};return $=function(){if(D.render(),!D.getCanvas().isConnected)D.stopAnimate();else if(++B>=j||!D.isAnimated())q.cancel(),D.animationTimers.delete(q),D.decAnim();else{var Y=x-(new Date().getTime()-H.getTime());Y=Y>0?Y:0,D.animationTimers.delete(q),q=new v.PausableTimer(W,Y,R),D.animationTimers.add(q)}},q=new v.PausableTimer(W,0,R),this.animationTimers.add(q),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(h){h.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(h){h.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(h){h.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(h){return h&&!h.defaultcolors?(h.defaultcolors=this.defaultcolors,h.cartoonQuality=h.cartoonQuality||this.config.cartoonQuality):typeof h>"u"&&(h={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),h}addModel(h,x="",R){R=this.getModelOpt(R);var M=new g.GLModel(this.models.length,R);return M.addMolData(h,x,R),this.models.push(M),M}addModels(h,x,R){R=this.getModelOpt(R),R.multimodel=!0,R.frames=!0;for(var M=g.GLModel.parseMolData(h,x,R),P=0;P<M.length;P++){var D=new g.GLModel(this.models.length,R);D.setAtomDefaults(M[P]),D.addFrame(M[P]),D.setFrame(0),M.modelData&&D.setModelData(M.modelData[P]),D.setDontDuplicateAtoms(!R.duplicateAssemblyAtoms),this.models.push(D)}return this.models}addModelsAsFrames(h,x,R){R=this.getModelOpt(R),R.multimodel=!0,R.frames=!0;var M=new g.GLModel(this.models.length,R);return M.addMolData(h,x,R),this.models.push(M),M}addAsOneMolecule(h,x,R){R=this.getModelOpt(R),R.multimodel=!0,R.onemol=!0;var M=new g.GLModel(this.models.length,R);return M.addMolData(h,x,R),this.models.push(M),M}removeModel(h){if(h=this.getModel(h),!!h){for(h.removegl(this.modelGroup),delete this.models[h.getID()];this.models.length>0&&typeof this.models[this.models.length-1]>"u";)this.models.pop();return this}}removeAllModels(){for(var h=0;h<this.models.length;h++){var x=this.models[h];x&&x.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(h,x){var R={};return x===void 0?R.m=this.models.map(function(M){return M.toCDObject(h)}):R.m=[this.models[x].toCDObject()],JSON.stringify(R)}exportVRML(){var h=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new o.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var x=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=h,x}createModelFrom(h,x=!1){for(var R=new g.GLModel(this.models.length,this.defaultcolors),M=0;M<this.models.length;M++)if(this.models[M]){var P=this.models[M].selectedAtoms(h);R.addAtoms(P),x&&this.models[M].removeAtoms(P)}return this.models.push(R),R}applyToModels(h,x,R,M,P,D,L){for(var X=this.getModelList(x),B=0;B<X.length;B++)X[B][h](x,R,M,P,D,L)}setStyle(h,x){return typeof x>"u"&&(x=h,h={}),this.applyToModels("setStyle",h,x,!1),this}addStyle(h,x){return typeof x>"u"&&(x=h,h={}),this.applyToModels("setStyle",h,x,!0),this}setClickable(h,x,R){return this.applyToModels("setClickable",h,x,R),this}setHoverable(h,x,R,M){return this.applyToModels("setHoverable",h,x,R,M),this}enableContextMenu(h,x){return this.applyToModels("enableContextMenu",h,x),this}vibrate(h,x,R,M){return this.applyToModels("vibrate",h,x,R,this,M),this}setColorByProperty(h,x,R,M){return this.applyToModels("setColorByProperty",h,x,R,M),this}setColorByElement(h,x){return this.applyToModels("setColorByElement",h,x),this}static getAtomsWithin(h,x){var R=[];for(let P=0;P<h.length;P++){var M=h[P];typeof M>"u"||M.x<x[0][0]||M.x>x[1][0]||M.y<x[0][1]||M.y>x[1][1]||M.z<x[0][2]||M.z>x[1][2]||R.push(M)}return R}static volume(h){var x=h[1][0]-h[0][0],R=h[1][1]-h[0][1],M=h[1][2]-h[0][2];return x*R*M}carveUpExtent(h,x,R){let M=[],P={};for(let H=0,$=x.length;H<$;H++)P[x[H].index]=H;let D=function(H){let $=[];for(let q=0,W=H.length;q<W;q++)H[q].index in P&&$.push(P[H[q].index]);return $},L=function(H){let $=[];return $[0]=[H[0][0],H[0][1],H[0][2]],$[1]=[H[1][0],H[1][1],H[1][2]],$},X=function(H){if(s.volume(H)<s.maxVolume)return[H];var $=H[1][0]-H[0][0],q=H[1][1]-H[0][1],W=H[1][2]-H[0][2],Y;$>q&&$>W?Y=0:q>$&&q>W?Y=1:Y=2;var G=L(H),V=L(H),Z=(H[1][Y]-H[0][Y])/2+H[0][Y];G[1][Y]=Z,V[0][Y]=Z;var xe=X(G),ce=X(V);return xe.concat(ce)},B=X(h),j=6;for(let H=0,$=B.length;H<$;H++){let q=L(B[H]);q[0][0]-=j,q[0][1]-=j,q[0][2]-=j,q[1][0]+=j,q[1][1]+=j,q[1][2]+=j;let W=s.getAtomsWithin(x,q),Y=s.getAtomsWithin(R,B[H]);M.push({extent:B[H],atoms:D(W),toshow:D(Y)})}return M}static generateSurfaceMesh(h,x,R){var M=new o.Geometry(!0),P=M.updateGeoGroup(0),D=[];for(let Gt=0,mt=h.length;Gt<mt;Gt++){var L=h[Gt];L&&(typeof L.surfaceColor<"u"?D[Gt]=L.surfaceColor:L.color&&(D[Gt]=u.CC.color(L.color)))}var X=P.vertexArray,B=x.vertices;for(let Gt=0,mt=B.length;Gt<mt;Gt++){let Fe=P.vertices*3;X[Fe]=B[Gt].x,X[Fe+1]=B[Gt].y,X[Fe+2]=B[Gt].z,P.vertices++}var j=P.colorArray;if(R.voldata&&R.volscheme){var H=R.volscheme,$=R.voldata,q=H.range()||[-1,1];for(let Gt=0,mt=B.length;Gt<mt;Gt++){let Fe=$.getVal(B[Gt].x,B[Gt].y,B[Gt].z),ht=u.CC.color(H.valueToHex(Fe,q)),Kt=Gt*3;j[Kt]=ht.r,j[Kt+1]=ht.g,j[Kt+2]=ht.b}}else if(D.length>0)for(let Gt=0,mt=B.length;Gt<mt;Gt++){let Fe=B[Gt].atomid,ht=Gt*3;j[ht]=D[Fe].r,j[ht+1]=D[Fe].g,j[ht+2]=D[Fe].b}var W=x.faces;P.faceidx=W.length,M.initTypedArrays();var Y=P.vertexArray,G=P.normalArray,V,Z,xe,ce;for(let Gt=0,mt=W.length;Gt<mt;Gt+=3){var Ne=W[Gt],Pe=W[Gt+1],De=W[Gt+2],Me=Ne*3,Be=Pe*3,ft=De*3;V=new c.Vector3(Y[Me],Y[Me+1],Y[Me+2]),Z=new c.Vector3(Y[Be],Y[Be+1],Y[Be+2]),xe=new c.Vector3(Y[ft],Y[ft+1],Y[ft+2]),xe.subVectors(xe,Z),V.subVectors(V,Z),xe.cross(V),ce=xe,ce.normalize(),G[Me]+=ce.x,G[Be]+=ce.x,G[ft]+=ce.x,G[Me+1]+=ce.y,G[Be+1]+=ce.y,G[ft+1]+=ce.y,G[Me+2]+=ce.z,G[Be+2]+=ce.z,G[ft+2]+=ce.z}P.faceArray=new Uint16Array(W);var jt=new o.Mesh(M,R);return jt}static generateMeshSyncHelper(h,x,R,M,P,D){var L=new k.ProteinSurface;return L.initparm(x,h!==1,D),L.fillvoxels(P,R),L.buildboundary(),(h==k.SurfaceType.SES||h==k.SurfaceType.MS)&&(L.fastdistancemap(),L.boundingatom(!1),L.fillvoxelswaals(P,R)),L.marchingcube(h),L.getFacesAndVertices(M)}static getMatWithStyle(h){let x=null;h.onesided?x=new o.MeshLambertMaterial:x=new o.MeshDoubleLambertMaterial,x.vertexColors=o.Coloring.VertexColors;for(var R in h)R==="color"||R==="map"||h.hasOwnProperty(R)&&(x[R]=h[R]);return h.opacity!==void 0&&(h.opacity===1?x.transparent=!1:x.transparent=!0),x}addMesh(h){var x={geo:h.geometry,mat:h.material,done:!0,finished:!1},R=this.nextSurfID();return this.surfaces[R]=x,R}static shallowCopy(h){var x=[];let R=h.length;for(let M=0;M<R;M++)x[M]=(0,v.extend)({},h[M]);return x}addSurface(h,x={},R={},M,P,D){let L=this.nextSurfID(),X=null,B=this,j=k.SurfaceType.VDW;typeof h=="string"?s.surfaceTypeMap[h.toUpperCase()]!==void 0?j=s.surfaceTypeMap[h]:console.log("Surface type : "+h+" is not recognized"):typeof h=="number"&&(j=h);var H=null,$=null,q=s.shallowCopy(this.getAtomsFromSel(R));M?H=s.shallowCopy(this.getAtomsFromSel(M)):H=q,(0,v.adjustVolumeStyle)(x);var W=!1,Y;for(Y=0;Y<this.models.length;Y++)if(this.models[Y]){var G=this.models[Y].getSymmetries();if(G.length>1||G.length==1&&!G[0].isIdentity()){W=!0;break}}var V=function(De,Me,Be){P?$=s.shallowCopy(B.getAtomsFromSel(P)):$=Be;var ft,jt=(0,v.getExtent)(Be,!0);if(x.map&&x.map.prop){var Gt=x.map.prop;let At=(0,f.getGradient)(x.map.scheme||x.map.gradient||new f.Gradient.RWB),Mt=At.range();Mt||(Mt=(0,v.getPropertyRange)(Be,Gt)),x.colorscheme={prop:Gt,gradient:At}}for(let At=0,Mt=Me.length;At<Mt;At++)ft=Me[At],ft.surfaceColor=(0,v.getColorFromStyle)(ft,x);var mt=s.volume(jt),Fe=B.carveUpExtent(jt,Me,Be);if($&&$.length&&$.length>0){var ht=(0,v.getExtent)($,!0),Kt=function(At,Mt){var Jr=function(ve,we){var it=ve.extent,rt=it[1][0]-it[0][0],Yt=it[1][1]-it[0][1],Ft=it[1][2]-it[0][2],re=rt-we[2][0];re*=re;var tt=Yt-we[2][1];tt*=tt;var lt=Ft-we[2][2];return lt*=lt,re+tt+lt},Yr=Jr(At,ht),ie=Jr(Mt,ht);return Yr-ie};Fe.sort(Kt)}var Jt=[];for(let At=0,Mt=Me.length;At<Mt;At++)ft=Me[At],Jt[At]={x:ft.x,y:ft.y,z:ft.z,serial:At,elem:ft.elem};var Wt=!!k.syncSurface;if(Wt){var Br=function(At){return new Promise(function(Mt){for(var Jr=s.generateMeshSyncHelper(j,Fe[At].extent,Fe[At].atoms,Fe[At].toshow,Jt,mt),Yr=(0,p.splitMesh)({vertexArr:Jr.vertices,faceArr:Jr.faces}),ie=0,ve=Yr.length;ie<ve;ie++){Jr={vertices:Yr[ie].vertexArr,faces:Yr[ie].faceArr};var we=s.generateSurfaceMesh(Me,Jr,X);(0,v.mergeGeos)(De.geo,we)}B.render(),Mt()})},zr=[];for(let At=0;At<Fe.length;At++)zr.push(Br(At));return Promise.all(zr).then(function(){return De.done=!0,Promise.resolve(L)})}else{var cr=[];j<0&&(j=0);for(let At=0,Mt=s.numWorkers;At<Mt;At++){var Nr=new Worker($3Dmol.SurfaceWorker);cr.push(Nr),Nr.postMessage({type:-1,atoms:Jt,volume:mt})}return new Promise(function(At,Mt){var Jr=0,Yr=function(){!cr||!cr.length||cr.forEach(function(it){it&&it.terminate&&it.terminate()})},ie=function(it){for(var rt=(0,p.splitMesh)({vertexArr:it.data.vertices,faceArr:it.data.faces}),Yt=0,Ft=rt.length;Yt<Ft;Yt++){var re={vertices:rt[Yt].vertexArr,faces:rt[Yt].faceArr},tt=s.generateSurfaceMesh(Me,re,X);(0,v.mergeGeos)(De.geo,tt)}B.render(),Jr++,Jr==Fe.length&&(De.done=!0,Yr(),At(L))},ve=function(it){Yr(),console.log(it.message+" ("+it.filename+":"+it.lineno+")"),Mt(it)};for(let it=0;it<Fe.length;it++){var we=cr[it%cr.length];we.onmessage=ie,we.onerror=ve,we.postMessage({type:j,expandedExtent:Fe[it].extent,extendedAtoms:Fe[it].atoms,atomsToShow:Fe[it].toshow})}})}};x=x||{},X=s.getMatWithStyle(x);var Z=[];Z.style=x,Z.atomsel=R,Z.allsel=M,Z.focus=P;var xe=null;if(W){var ce={},Ne={};for(Y=0;Y<this.models.length;Y++)ce[Y]=[],Ne[Y]=[];for(Y=0;Y<H.length;Y++)ce[H[Y].model].push(H[Y]);for(Y=0;Y<q.length;Y++)Ne[q[Y].model].push(q[Y]);var Pe=[];for(Y=0;Y<this.models.length;Y++)Ne[Y].length>0&&(Z.push({geo:new o.Geometry(!0),mat:X,done:!1,finished:!1,symmetries:this.models[Y].getSymmetries()}),Pe.push(V(Z[Z.length-1],ce[Y],Ne[Y])));xe=Promise.all(Pe)}else Z.push({geo:new o.Geometry(!0),mat:X,done:!1,finished:!1,symmetries:[new c.Matrix4]}),xe=V(Z[Z.length-1],H,q);return this.surfaces[L]=Z,xe.surfid=L,D&&typeof D=="function"?(xe.then(function(De){D(De)}),L):xe}setSurfaceMaterialStyle(h,x){if((0,v.adjustVolumeStyle)(x),this.surfaces[h]){var R=this.surfaces[h];R.style=x;for(var M=0;M<R.length;M++){var P=R[M].mat=s.getMatWithStyle(x);if(R[M].mat.side=o.FrontSide,x.color){R[M].mat.color=x.color,R[M].geo.colorsNeedUpdate=!0;const D=u.CC.color(x.color);R[M].geo.setColors(function(){return D})}else if(P.voldata&&P.volscheme){const D=P.volscheme,L=P.voldata,X=u.CC,B=D.range()||[-1,1];R[M].geo.setColors(function(j,H,$){let q=L.getVal(j,H,$);return X.color(D.valueToHex(q,B))})}R[M].finished=!1}}return this}getSurface(h){return this.surfaces[h]}removeSurface(h){for(var x=this.surfaces[h],R=0;R<x.length;R++)x[R]&&x[R].lastGL&&(x[R].geo!==void 0&&x[R].geo.dispose(),x[R].mat!==void 0&&x[R].mat.dispose(),this.modelGroup.remove(x[R].lastGL));return delete this.surfaces[h],this.show(),this}removeAllSurfaces(){for(var h in this.surfaces)if(this.surfaces.hasOwnProperty(h)){for(var x=this.surfaces[h],R=0;R<x.length;R++)x[R]&&x[R].lastGL&&(x[R].geo!==void 0&&x[R].geo.dispose(),x[R].mat!==void 0&&x[R].mat.dispose(),this.modelGroup.remove(x[R].lastGL));delete this.surfaces[h]}return this.show(),this}jmolMoveTo(){var h=this.modelGroup.position,x="center { "+-h.x+" "+-h.y+" "+-h.z+" }; ",R=this.rotationGroup.quaternion;return x+="moveto .5 quaternion { "+R.x+" "+R.y+" "+R.z+" "+R.w+" };",x}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(h,x){x=x||{};var R=this.getAtomsFromSel(x);if(typeof h=="function")for(let D=0,L=R.length;D<L;D++){let X=R[D];h(X)}else for(let D=0,L=R.length;D<L;D++){var M=R[D];for(let X=0,B=h.length;X<B;X++){let j=h[X];if(j.props)for(var P in j.props)j.props.hasOwnProperty(P)&&this.atomIsSelected(M,j)&&(M.properties||(M.properties={}),M.properties[P]=j.props[P])}}return this}linkViewer(h){return this.linkedViewers.push(h),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(h){this.rotationGroup.position.z=this.CAMERA_Z-h}setAutoEyeSeparation(h,x){var R=this.getPerceivedDistance();return x||(x=5),h||this.camera.position.x>0?this.camera.position.x=R*Math.tan(Math.PI/180*x):this.camera.position.x=-R*Math.tan(Math.PI/180*x),this.camera.lookAt(new c.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(h){this.config.cartoonQuality=h}}s.numWorkers=4,s.maxVolume=64e3,s.surfaceTypeMap={VDW:k.SurfaceType.VDW,MS:k.SurfaceType.MS,SAS:k.SurfaceType.SAS,SES:k.SurfaceType.SES};function y(C,h){if(C=(0,v.getElement)(C),!!C){h=h||{};try{var x=new s(C,h);return x}catch(R){throw"error creating viewer: "+R}}}function w(C,h={},x={}){if(C=(0,v.getElement)(C),!!C){var R=[],M=document.createElement("canvas");x.rows=h.rows,x.cols=h.cols,x.control_all=h.control_all!=null?h.control_all:!1,C.appendChild(M);try{for(var P=0;P<h.rows;P++){for(var D=[],L=0;L<h.cols;L++){x.row=P,x.col=L,x.canvas=M,x.viewers=R,x.control_all=h.control_all;var X=y(C,(0,v.extend)({},x));D.push(X)}R.unshift(D)}}catch(B){throw"error creating viewer grid: "+B}return R}}function S(C){var h=this;if(C=(0,v.getElement)(C),!!C){var x=w(C,{rows:1,cols:2,control_all:!0});this.glviewer1=x[0][0],this.glviewer2=x[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var R=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(P){return typeof h.glviewer1[P]=="function"}),M=0;M<R.length;M++)this[R[M]]=(function(P){return function(){var D=this.glviewer1[P].apply(this.glviewer1,arguments),L=this.glviewer2[P].apply(this.glviewer2,arguments);return[D,L]}})(R[M]);this.setCoordinates=function(P,D,L){for(var X=0;X<P.length;X++)P[X].setCoordinates(D,L)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(P){this.glviewer1.render(),this.glviewer2.render(),P&&P(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}}),"./src/Gradient.ts":((e,r,t)=>{t.r(r),t.d(r,{CustomLinear:()=>p,Gradient:()=>k,GradientType:()=>c,ROYGB:()=>g,RWB:()=>f,Sinebow:()=>_,builtinGradients:()=>E,getGradient:()=>v,normalizeValue:()=>u});var o=t("./src/colors.ts");class c{}function u(A,z,l){return z>=A?(l<A&&(l=A),l>z&&(l=z),{lo:A,hi:z,val:l}):(l>A&&(l=A),l<z&&(l=z),l=A-l+z,{lo:z,hi:A,val:l})}function v(A){if(A instanceof c)return A;if(A.gradient!==void 0&&E[A.gradient]){let z=A.min===void 0?-1:A.min,l=A.max===void 0?1:A.max;return A.mid===void 0?A.colors===void 0?new E[A.gradient](z,l):new E[A.gradient](z,l,A.colors):new E[A.gradient](z,l,A.mid)}else if(typeof A.gradient=="string"&&A.gradient.startsWith("linear_")){let z=A.gradient.split("_");z.shift();let l=A.min===void 0?-1:A.min,s=A.max===void 0?1:A.max;return new p(l,s,z)}return A}class f extends c{constructor(z,l,s){super(),this.gradient="RWB",this.mult=1,this.mid=s,this.min=z,this.max=l,typeof l>"u"&&Array.isArray(z)&&z.length>=2?(this.max=z[1],this.min=z[0]):z&&l&&!Array.isArray(z)&&(this.min=z,this.max=l)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(z,l){var s,y;if(z=this.mult*z,l?(s=l[0],y=l[1]):(s=this.min,y=this.max),z===void 0)return 16777215;var w=u(s,y,z);s=w.lo,y=w.hi,z=w.val;var S=(y+s)/2;l&&typeof l[2]<"u"?S=l[2]:typeof this.mid<"u"?S=this.mid:S=(s+y)/2;var C,h;return z<S?(C=Math.floor(255*Math.sqrt((z-s)/(S-s))),h=16711680+256*C+C,h):z>S?(C=Math.floor(255*Math.sqrt(1-(z-S)/(y-S))),h=65536*C+256*C+255,h):16777215}}class g extends c{constructor(z,l){super(),this.gradient="ROYGB",this.mult=1,this.min=z,this.max=l,typeof l>"u"&&Array.isArray(z)&&z.length>=2?(this.max=z[1],this.min=z[0]):z&&l&&!Array.isArray(z)&&(this.min=z,this.max=l)}valueToHex(z,l){var s,y;if(z=this.mult*z,l?(s=l[0],y=l[1]):(s=this.min,y=this.max),typeof z>"u")return 16777215;var w=u(s,y,z);s=w.lo,y=w.hi,z=w.val;var S=(s+y)/2,C=(s+S)/2,h=(S+y)/2,x,R;return z<C?(x=Math.floor(255*Math.sqrt((z-s)/(C-s))),R=16711680+256*x+0,R):z<S?(x=Math.floor(255*Math.sqrt(1-(z-C)/(S-C))),R=65536*x+65280+0,R):z<h?(x=Math.floor(255*Math.sqrt((z-S)/(h-S))),R=65280+1*x,R):(x=Math.floor(255*Math.sqrt(1-(z-h)/(y-h))),R=0+256*x+255,R)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class _ extends c{constructor(z,l){super(),this.gradient="Sinebow",this.mult=1,this.min=z,this.max=l,typeof l>"u"&&Array.isArray(z)&&z.length>=2&&(this.max=z[1],this.min=z[0]),l<z&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(z,l){var s,y;if(z=this.mult*z,l?(s=l[0],y=l[1]):(s=this.min,y=this.max),typeof z>"u")return 16777215;var w=k.normalizeValue(s,y,z);s=w.lo,y=w.hi,z=w.val;var S=(z-s)/(y-s),C=5*S/6+.5,h=Math.sin(Math.PI*C);h*=h*255;var x=Math.sin(Math.PI*(C+1/3));x*=x*255;var R=Math.sin(Math.PI*(C+2/3));return R*=R*255,65536*Math.floor(h)+256*Math.floor(R)+1*Math.floor(x)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class p extends c{constructor(z,l,s){super(),this.gradient="linear",this.colors=new Array;var y;if(Array.isArray(z)&&z.length>=2?(this.max=z[1],this.min=z[0],y=l):(this.min=z,this.max=l,y=s),y)for(let w of y)this.colors.push(o.CC.color(w));else this.colors.push(o.CC.color(0))}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(z,l){var s,y;if(l?(s=l[0],y=l[1]):(s=this.min,y=this.max),z===void 0)return 16777215;var w=u(s,y,z);s=w.lo,y=w.hi,z=w.val;let S=this.colors.length,C=(y-s)/S,h=Math.min(Math.floor((z-s)/C),S-1),x=Math.min(h+1,S-1),R=(z-s-h*C)/C,M=this.colors[h],P=this.colors[x];return new o.Color(M.r+R*(P.r-M.r),M.g+R*(P.g-M.g),M.b+R*(P.b-M.b)).getHex()}}const E={rwb:f,RWB:f,roygb:g,ROYGB:g,sinebow:_,linear:p};class k extends c{valueToHex(z,l){return 0}range(){return null}}k.RWB=f,k.ROYGB=g,k.Sinebow=_,k.CustomLinear=p,k.builtinGradients=E,k.normalizeValue=u,k.getGradient=v}),"./src/Label.ts":((e,r,t)=>{t.r(r),t.d(r,{Label:()=>_,LabelCount:()=>v});var o=t("./src/WebGL/index.ts"),c=t("./src/Gradient.ts"),u=t("./src/colors.ts");let v=0;function f(p,E,k,A,z,l,s){p.beginPath(),p.moveTo(E+l,k),p.lineTo(E+A-l,k),p.quadraticCurveTo(E+A,k,E+A,k+l),p.lineTo(E+A,k+z-l),p.quadraticCurveTo(E+A,k+z,E+A-l,k+z),p.lineTo(E+l,k+z),p.quadraticCurveTo(E,k+z,E,k+z-l),p.lineTo(E,k+l),p.quadraticCurveTo(E,k,E+l,k),p.closePath(),p.fill(),s&&p.stroke()}function g(p,E,k){var A=k;return typeof p<"u"&&(p instanceof u.Color?A=p.scaled():(A=u.CC.color(p),typeof A.scaled<"u"&&(A=A.scaled()))),typeof E<"u"&&(A.a=parseFloat(E)),A}class _{constructor(E,k){this.id=v++,this.stylespec=k||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new o.Sprite,this.text=E,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}setContext(){var E=this.stylespec,k=typeof E.useScreen>"u"?!1:E.useScreen,A=E.showBackground;(A==="0"||A==="false")&&(A=!1),typeof A>"u"&&(A=!0);var z=E.font?E.font:"sans-serif",l=parseInt(E.fontSize)?parseInt(E.fontSize):18,s=g(E.fontColor,E.fontOpacity,{r:255,g:255,b:255,a:1}),y=E.padding?E.padding:4,w=E.borderThickness?E.borderThickness:0,S=g(E.backgroundColor,E.backgroundOpacity,{r:0,g:0,b:0,a:1}),C=g(E.borderColor,E.borderOpacity,S),h=E.position?E.position:{x:-10,y:1,z:1},x=E.inFront!==void 0?E.inFront:!0;(x==="false"||x==="0")&&(x=!1);var R=E.alignment||o.SpriteAlignment.topLeft;typeof R=="string"&&R in o.SpriteAlignment&&(R=o.SpriteAlignment[R]);var M="";E.bold&&(M="bold "),this.context.font=M+l+"px  "+z;var P=this.context.measureText(this.text),D=P.width;A||(w=0);var L=D+2.5*w+2*y,X=l*1.25+2*w+2*y;if(E.backgroundImage){var B=E.backgroundImage,j=E.backgroundWidth?E.backgroundWidth:B.width,H=E.backgroundHeight?E.backgroundHeight:B.height;j>L&&(L=j),H>X&&(X=H)}if(this.canvas.width=L,this.canvas.height=X,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),M="",E.bold&&(M="bold "),this.context.font=M+l+"px  "+z,this.context.fillStyle="rgba("+S.r+","+S.g+","+S.b+","+S.a+")",this.context.strokeStyle="rgba("+C.r+","+C.g+","+C.b+","+C.a+")",E.backgroundGradient){let q=this.context.createLinearGradient(0,X/2,L,X/2),W=c.Gradient.getGradient(E.backgroundGradient),Y=W.range(),G=-1,V=1;Y&&(G=Y[0],V=Y[1]);let Z=V-G;for(let xe=0;xe<1.01;xe+=.1){let ce=g(W.valueToHex(G+Z*xe)),Ne="rgba("+ce.r+","+ce.g+","+ce.b+","+ce.a+")";q.addColorStop(xe,Ne)}this.context.fillStyle=q}this.context.lineWidth=w,A&&f(this.context,w,w,L-2*w,X-2*w,6,w>0),E.backgroundImage&&this.context.drawImage(B,0,0,L,X),this.context.fillStyle="rgba("+s.r+","+s.g+","+s.b+","+s.a+")",this.context.fillText(this.text,w+y,l+w+y,D);var $=new o.Texture(this.canvas);$.needsUpdate=!0,this.sprite.material=new o.SpriteMaterial({map:$,useScreenCoordinates:k,alignment:R,depthTest:!x,screenOffset:E.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(h.x,h.y,h.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}}),"./src/ProteinSurface4.ts":((e,r,t)=>{t.r(r),t.d(r,{MarchingCube:()=>g,MarchingCubeInitializer:()=>f,PointGrid:()=>_,ProteinSurface:()=>p,SurfaceType:()=>c,setSyncSurface:()=>v,syncSurface:()=>u});var o=t("./src/WebGL/math/index.ts"),c;(function(E){E[E.VDW=1]="VDW",E[E.MS=2]="MS",E[E.SAS=3]="SAS",E[E.SES=4]="SES"})(c||(c={}));var u=!1;function v(E){u=E}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&(u=!0);class f{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(k,A,z,l){let s=!!l.fulltable,y=l.hasOwnProperty("origin")&&l.origin.hasOwnProperty("x")?l.origin:{x:0,y:0,z:0},w=!!l.voxel,S=l.matrix,C=l.nX||0,h=l.nY||0,x=l.nZ||0,R=l.scale||1,M=null;l.unitCube?M=l.unitCube:M={x:R,y:R,z:R};let P=new Int32Array(C*h*x),D,L;for(D=0,L=P.length;D<L;++D)P[D]=-1;let X=function($,q,W,Y,G,V){let Z={x:0,y:0,z:0},xe=!!(Y&1<<G),ce=!!(Y&1<<V),Ne=G;if(!xe&&ce&&(Ne=V),Ne&1&&W++,Ne&2&&q++,Ne&4&&$++,S){let De=new o.Vector3($,q,W);De=De.applyMatrix4(S),Z={x:De.x,y:De.y,z:De.z}}else Z.x=y.x+M.x*$,Z.y=y.y+M.y*q,Z.z=y.z+M.z*W;let Pe=(h*$+q)*x+W;return w?(A.push(Z),A.length-1):(P[Pe]<0&&(P[Pe]=A.length,A.push(Z)),P[Pe])},B=new Int32Array(12),j=s?this.edgeTable2:this.edgeTable,H=s?this.triTable2:this.triTable;for(D=0;D<C-1;++D)for(let $=0;$<h-1;++$)for(let q=0;q<x-1;++q){let W=0;for(let V=0;V<8;++V){let Z=(h*(D+((V&4)>>2))+$+((V&2)>>1))*x+q+(V&1),xe=!!(k[Z]&this.ISDONE);W|=xe<<V}if(W===0||W===255)continue;let Y=j[W];if(Y===0)continue;let G=H[W];Y&1&&(B[0]=X(D,$,q,W,0,1)),Y&2&&(B[1]=X(D,$,q,W,1,3)),Y&4&&(B[2]=X(D,$,q,W,3,2)),Y&8&&(B[3]=X(D,$,q,W,2,0)),Y&16&&(B[4]=X(D,$,q,W,4,5)),Y&32&&(B[5]=X(D,$,q,W,5,7)),Y&64&&(B[6]=X(D,$,q,W,7,6)),Y&128&&(B[7]=X(D,$,q,W,6,4)),Y&256&&(B[8]=X(D,$,q,W,0,4)),Y&512&&(B[9]=X(D,$,q,W,1,5)),Y&1024&&(B[10]=X(D,$,q,W,3,7)),Y&2048&&(B[11]=X(D,$,q,W,2,6));for(let V=0;V<G.length;V+=3){let Z=B[G[V]],xe=B[G[V+1]],ce=B[G[V+2]];w&&V>=3&&(A.push(A[Z]),Z=A.length-1,A.push(A[xe]),xe=A.length-1,A.push(A[ce]),ce=A.length-1),z.push(Z),z.push(xe),z.push(ce)}}}laplacianSmooth(k,A,z){let l=new Array(A.length),s,y,w,S,C;for(s=0,y=A.length;s<y;s++)l[s]={x:0,y:0,z:0};let h=new Array(20),x;for(s=0;s<20;s++)h[s]=new Array(A.length);for(s=0,y=A.length;s<y;s++)h[0][s]=0;for(s=0,y=z.length/3;s<y;s++){let P=s*3,D=s*3+1,L=s*3+2;for(x=!0,w=0,S=h[0][z[P]];w<S;w++)if(z[D]==h[w+1][z[P]]){x=!1;break}for(x&&(h[0][z[P]]++,h[h[0][z[P]]][z[P]]=z[D]),x=!0,w=0,S=h[0][z[P]];w<S;w++)if(z[L]==h[w+1][z[P]]){x=!1;break}for(x&&(h[0][z[P]]++,h[h[0][z[P]]][z[P]]=z[L]),x=!0,w=0,S=h[0][z[D]];w<S;w++)if(z[P]==h[w+1][z[D]]){x=!1;break}for(x&&(h[0][z[D]]++,h[h[0][z[D]]][z[D]]=z[P]),x=!0,w=0,S=h[0][z[D]];w<S;w++)if(z[L]==h[w+1][z[D]]){x=!1;break}for(x&&(h[0][z[D]]++,h[h[0][z[D]]][z[D]]=z[L]),x=!0,w=0;w<h[0][z[L]];w++)if(z[P]==h[w+1][z[L]]){x=!1;break}for(x&&(h[0][z[L]]++,h[h[0][z[L]]][z[L]]=z[P]),x=!0,w=0,S=h[0][z[L]];w<S;w++)if(z[D]==h[w+1][z[L]]){x=!1;break}x&&(h[0][z[L]]++,h[h[0][z[L]]][z[L]]=z[D])}let R=1,M=.5;for(C=0;C<k;C++){for(s=0,y=A.length;s<y;s++)if(h[0][s]<3)l[s].x=A[s].x,l[s].y=A[s].y,l[s].z=A[s].z;else if(h[0][s]==3||h[0][s]==4){for(l[s].x=0,l[s].y=0,l[s].z=0,w=0,S=h[0][s];w<S;w++)l[s].x+=A[h[w+1][s]].x,l[s].y+=A[h[w+1][s]].y,l[s].z+=A[h[w+1][s]].z;l[s].x+=M*A[s].x,l[s].y+=M*A[s].y,l[s].z+=M*A[s].z,l[s].x/=M+h[0][s],l[s].y/=M+h[0][s],l[s].z/=M+h[0][s]}else{for(l[s].x=0,l[s].y=0,l[s].z=0,w=0,S=h[0][s];w<S;w++)l[s].x+=A[h[w+1][s]].x,l[s].y+=A[h[w+1][s]].y,l[s].z+=A[h[w+1][s]].z;l[s].x+=R*A[s].x,l[s].y+=R*A[s].y,l[s].z+=R*A[s].z,l[s].x/=R+h[0][s],l[s].y/=R+h[0][s],l[s].z/=R+h[0][s]}for(s=0,y=A.length;s<y;s++)A[s].x=l[s].x,A[s].y=l[s].y,A[s].z=l[s].z}}}let g=new f;class _{constructor(k,A,z){this.data=new Int32Array(k*A*z*3),this.width=A,this.height=z}set(k,A,z,l){let s=((k*this.width+A)*this.height+z)*3;this.data[s]=l.ix,this.data[s+1]=l.iy,this.data[s+2]=l.iz}get(k,A,z){let l=((k*this.width+A)*this.height+z)*3;return{ix:this.data[l],iy:this.data[l+1],iz:this.data[l+2]}}}class p{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],p.MarchingCube||(p.MarchingCube=new f)}getVDWIndex(k){return!k.elem||typeof this.vdwRadii[k.elem]>"u"?"X":k.elem}getFacesAndVertices(k){let A={};for(let s=0,y=k.length;s<y;s++)A[k[s]]=!0;let z=this.verts;for(let s=0,y=z.length;s<y;s++)z[s].x=z[s].x/this.scaleFactor-this.ptranx,z[s].y=z[s].y/this.scaleFactor-this.ptrany,z[s].z=z[s].z/this.scaleFactor-this.ptranz;let l=[];for(let s=0,y=this.faces.length;s<y;s+=3){let w=this.faces[s],S=this.faces[s+1],C=this.faces[s+2],h=z[w].atomid,x=z[S].atomid,R=z[C].atomid,M=h;x<M&&(M=x),R<M&&(M=R),A[M]&&w!==S&&S!==C&&w!==C&&(l.push(w),l.push(S),l.push(C))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:z,faces:l}}initparm(k,A,z){z>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let l=1/this.scaleFactor*5.5;this.pminx=k[0][0],this.pmaxx=k[1][0],this.pminy=k[0][1],this.pmaxy=k[1][1],this.pminz=k[0][2],this.pmaxz=k[1][2],A?(this.pminx-=this.probeRadius+l,this.pminy-=this.probeRadius+l,this.pminz-=this.probeRadius+l,this.pmaxx+=this.probeRadius+l,this.pmaxy+=this.probeRadius+l,this.pmaxz+=this.probeRadius+l):(this.pminx-=l,this.pminy-=l,this.pminz-=l,this.pmaxx+=l,this.pmaxy+=l,this.pmaxz+=l),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(A),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(k){let A={};for(const z in this.vdwRadii){let l=this.vdwRadii[z];k?A[z]=(l+this.probeRadius)*this.scaleFactor+.5:A[z]=l*this.scaleFactor+.5;let s=A[z]*A[z];this.widxz[z]=Math.floor(A[z])+1,this.depty[z]=new Int32Array(this.widxz[z]*this.widxz[z]);let y=0;for(let w=0;w<this.widxz[z];w++)for(let S=0;S<this.widxz[z];S++){let C=w*w+S*S;if(C>s)this.depty[z][y]=-1;else{let h=Math.sqrt(s-C);this.depty[z][y]=Math.floor(h)}y++}}}fillvoxels(k,A){for(let z=0,l=this.vpBits.length;z<l;z++)this.vpBits[z]=0,this.vpDistance[z]=-1,this.vpAtomID[z]=-1;for(let z in A){let l=k[A[z]];l!==void 0&&this.fillAtom(l,k)}for(let z=0,l=this.vpBits.length;z<l;z++)this.vpBits[z]&this.INOUT&&(this.vpBits[z]|=this.ISDONE)}fillAtom(k,A){let z=Math.floor(.5+this.scaleFactor*(k.x+this.ptranx)),l=Math.floor(.5+this.scaleFactor*(k.y+this.ptrany)),s=Math.floor(.5+this.scaleFactor*(k.z+this.ptranz)),y=this.getVDWIndex(k),w=0,S=this.pWidth*this.pHeight;for(let C=0,h=this.widxz[y];C<h;C++)for(let x=0;x<h;x++){if(this.depty[y][w]!=-1){for(let R=-1;R<2;R++)for(let M=-1;M<2;M++)for(let P=-1;P<2;P++)if(R!==0&&M!==0&&P!==0){let D=R*C,L=P*x;for(let X=0;X<=this.depty[y][w];X++){let B=X*M,j=z+D,H=l+B,$=s+L;if(j<0||H<0||$<0||j>=this.pLength||H>=this.pWidth||$>=this.pHeight)continue;let q=j*S+H*this.pHeight+$;if(!(this.vpBits[q]&this.INOUT))this.vpBits[q]|=this.INOUT,this.vpAtomID[q]=k.serial;else{let W=A[this.vpAtomID[q]];if(W.serial!=k.serial){let Y=z+D-Math.floor(.5+this.scaleFactor*(W.x+this.ptranx)),G=l+B-Math.floor(.5+this.scaleFactor*(W.y+this.ptrany)),V=s+L-Math.floor(.5+this.scaleFactor*(W.z+this.ptranz));D*D+B*B+L*L<Y*Y+G*G+V*V&&(this.vpAtomID[q]=k.serial)}}}}}w++}}fillvoxelswaals(k,A){for(let z=0,l=this.vpBits.length;z<l;z++)this.vpBits[z]&=~this.ISDONE;for(let z in A){let l=k[A[z]];l!==void 0&&this.fillAtomWaals(l,k)}}fillAtomWaals(k,A){let z=0,l=Math.floor(.5+this.scaleFactor*(k.x+this.ptranx)),s=Math.floor(.5+this.scaleFactor*(k.y+this.ptrany)),y=Math.floor(.5+this.scaleFactor*(k.z+this.ptranz)),w=this.getVDWIndex(k),S=this.pWidth*this.pHeight;for(let C=0,h=this.widxz[w];C<h;C++)for(let x=0;x<h;x++){if(this.depty[w][z]!=-1){for(let R=-1;R<2;R++)for(let M=-1;M<2;M++)for(let P=-1;P<2;P++)if(R!==0&&M!==0&&P!==0){let D=R*C,L=P*x;for(let X=0;X<=this.depty[w][z];X++){let B=X*M,j=l+D,H=s+B,$=y+L;if(j<0||H<0||$<0||j>=this.pLength||H>=this.pWidth||$>=this.pHeight)continue;let q=j*S+H*this.pHeight+$;if(!(this.vpBits[q]&this.ISDONE))this.vpBits[q]|=this.ISDONE,this.vpAtomID[q]=k.serial;else{let W=A[this.vpAtomID[q]];if(W.serial!=k.serial){let Y=l+D-Math.floor(.5+this.scaleFactor*(W.x+this.ptranx)),G=s+B-Math.floor(.5+this.scaleFactor*(W.y+this.ptrany)),V=y+L-Math.floor(.5+this.scaleFactor*(W.z+this.ptranz));D*D+B*B+L*L<Y*Y+G*G+V*V&&(this.vpAtomID[q]=k.serial)}}}}}z++}}buildboundary(){let k=this.pWidth*this.pHeight;for(let A=0;A<this.pLength;A++)for(let z=0;z<this.pHeight;z++)for(let l=0;l<this.pWidth;l++){let s=A*k+l*this.pHeight+z;if(this.vpBits[s]&this.INOUT){let y=0;for(;y<26;){let w=A+this.nb[y][0],S=z+this.nb[y][2],C=l+this.nb[y][1];if(w>-1&&w<this.pLength&&C>-1&&C<this.pWidth&&S>-1&&S<this.pHeight&&!(this.vpBits[w*k+C*this.pHeight+S]&this.INOUT)){this.vpBits[s]|=this.ISBOUND;break}else y++}}}}fastdistancemap(){let k=new _(this.pLength,this.pWidth,this.pHeight),A=this.pWidth*this.pHeight,z=this.cutRadius*this.cutRadius,l=[],s=[],y;for(let C=0;C<this.pLength;C++)for(let h=0;h<this.pWidth;h++)for(let x=0;x<this.pHeight;x++)if(y=C*A+h*this.pHeight+x,this.vpBits[y]&=~this.ISDONE,this.vpBits[y]&this.INOUT&&this.vpBits[y]&this.ISBOUND){let R={ix:C,iy:h,iz:x};k.set(C,h,x,R),l.push(R),this.vpDistance[y]=0,this.vpBits[y]|=this.ISDONE,this.vpBits[y]&=~this.ISBOUND}do{s=this.fastoneshell(l,k),l=[];for(let C=0,h=s.length;C<h;C++)y=A*s[C].ix+this.pHeight*s[C].iy+s[C].iz,this.vpBits[y]&=~this.ISBOUND,this.vpDistance[y]<=1.0404*z&&l.push({ix:s[C].ix,iy:s[C].iy,iz:s[C].iz})}while(l.length!==0);l=[],s=[],k=null;let w=this.scaleFactor-.5;w<0&&(w=0);let S=z-.5/(.1+w);for(let C=0;C<this.pLength;C++)for(let h=0;h<this.pWidth;h++)for(let x=0;x<this.pHeight;x++)y=C*A+h*this.pHeight+x,this.vpBits[y]&=~this.ISBOUND,this.vpBits[y]&this.INOUT&&(!(this.vpBits[y]&this.ISDONE)||this.vpBits[y]&this.ISDONE&&this.vpDistance[y]>=S)&&(this.vpBits[y]|=this.ISBOUND)}fastoneshell(k,A){let z,l,s,y,w,S,C,h,x,R=[];if(k.length===0)return R;let M={ix:-1,iy:-1,iz:-1},P=this.pWidth*this.pHeight;for(let D=0,L=k.length;D<L;D++){z=k[D].ix,l=k[D].iy,s=k[D].iz,h=A.get(z,l,s);for(let X=0;X<6;X++)M.ix=z+this.nb[X][0],M.iy=l+this.nb[X][1],M.iz=s+this.nb[X][2],M.ix<this.pLength&&M.ix>-1&&M.iy<this.pWidth&&M.iy>-1&&M.iz<this.pHeight&&M.iz>-1&&(x=M.ix*P+this.pHeight*M.iy+M.iz,this.vpBits[x]&this.INOUT&&!(this.vpBits[x]&this.ISDONE)?(A.set(M.ix,M.iy,s+this.nb[X][2],h),y=M.ix-h.ix,w=M.iy-h.iy,S=M.iz-h.iz,C=y*y+w*w+S*S,this.vpDistance[x]=C,this.vpBits[x]|=this.ISDONE,this.vpBits[x]|=this.ISBOUND,R.push({ix:M.ix,iy:M.iy,iz:M.iz})):this.vpBits[x]&this.INOUT&&this.vpBits[x]&this.ISDONE&&(y=M.ix-h.ix,w=M.iy-h.iy,S=M.iz-h.iz,C=y*y+w*w+S*S,C<this.vpDistance[x]&&(A.set(M.ix,M.iy,M.iz,h),this.vpDistance[x]=C,this.vpBits[x]&this.ISBOUND||(this.vpBits[x]|=this.ISBOUND,R.push({ix:M.ix,iy:M.iy,iz:M.iz})))))}for(let D=0,L=k.length;D<L;D++){z=k[D].ix,l=k[D].iy,s=k[D].iz,h=A.get(z,l,s);for(let X=6;X<18;X++)M.ix=z+this.nb[X][0],M.iy=l+this.nb[X][1],M.iz=s+this.nb[X][2],M.ix<this.pLength&&M.ix>-1&&M.iy<this.pWidth&&M.iy>-1&&M.iz<this.pHeight&&M.iz>-1&&(x=M.ix*P+this.pHeight*M.iy+M.iz,this.vpBits[x]&this.INOUT&&!(this.vpBits[x]&this.ISDONE)?(A.set(M.ix,M.iy,s+this.nb[X][2],h),y=M.ix-h.ix,w=M.iy-h.iy,S=M.iz-h.iz,C=y*y+w*w+S*S,this.vpDistance[x]=C,this.vpBits[x]|=this.ISDONE,this.vpBits[x]|=this.ISBOUND,R.push({ix:M.ix,iy:M.iy,iz:M.iz})):this.vpBits[x]&this.INOUT&&this.vpBits[x]&this.ISDONE&&(y=M.ix-h.ix,w=M.iy-h.iy,S=M.iz-h.iz,C=y*y+w*w+S*S,C<this.vpDistance[x]&&(A.set(M.ix,M.iy,M.iz,h),this.vpDistance[x]=C,this.vpBits[x]&this.ISBOUND||(this.vpBits[x]|=this.ISBOUND,R.push({ix:M.ix,iy:M.iy,iz:M.iz})))))}for(let D=0,L=k.length;D<L;D++){z=k[D].ix,l=k[D].iy,s=k[D].iz,h=A.get(z,l,s);for(let X=18;X<26;X++)M.ix=z+this.nb[X][0],M.iy=l+this.nb[X][1],M.iz=s+this.nb[X][2],M.ix<this.pLength&&M.ix>-1&&M.iy<this.pWidth&&M.iy>-1&&M.iz<this.pHeight&&M.iz>-1&&(x=M.ix*P+this.pHeight*M.iy+M.iz,this.vpBits[x]&this.INOUT&&!(this.vpBits[x]&this.ISDONE)?(A.set(M.ix,M.iy,s+this.nb[X][2],h),y=M.ix-h.ix,w=M.iy-h.iy,S=M.iz-h.iz,C=y*y+w*w+S*S,this.vpDistance[x]=C,this.vpBits[x]|=this.ISDONE,this.vpBits[x]|=this.ISBOUND,R.push({ix:M.ix,iy:M.iy,iz:M.iz})):this.vpBits[x]&this.INOUT&&this.vpBits[x]&this.ISDONE&&(y=M.ix-h.ix,w=M.iy-h.iy,S=M.iz-h.iz,C=y*y+w*w+S*S,C<this.vpDistance[x]&&(A.set(M.ix,M.iy,M.iz,h),this.vpDistance[x]=C,this.vpBits[x]&this.ISBOUND||(this.vpBits[x]|=this.ISBOUND,R.push({ix:M.ix,iy:M.iy,iz:M.iz})))))}return R}marchingcubeinit(k){for(let A=0,z=this.vpBits.length;A<z;A++)k==1?this.vpBits[A]&=~this.ISBOUND:k==4?(this.vpBits[A]&=~this.ISDONE,this.vpBits[A]&this.ISBOUND&&(this.vpBits[A]|=this.ISDONE),this.vpBits[A]&=~this.ISBOUND):k==2?this.vpBits[A]&this.ISBOUND&&this.vpBits[A]&this.ISDONE?this.vpBits[A]&=~this.ISBOUND:this.vpBits[A]&this.ISBOUND&&!(this.vpBits[A]&this.ISDONE)&&(this.vpBits[A]|=this.ISDONE):k==3&&(this.vpBits[A]&=~this.ISBOUND)}marchingcube(k){this.marchingcubeinit(k),this.verts=[],this.faces=[],p.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let A=this.pWidth*this.pHeight;for(let z=0,l=this.verts.length;z<l;z++)this.verts[z].atomid=this.vpAtomID[this.verts[z].x*A+this.pHeight*this.verts[z].y+this.verts[z].z];p.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}p.MarchingCube=new f}),"./src/VolumeData.ts":((e,r,t)=>{t.r(r),t.d(r,{VolumeData:()=>g});var o=t("./src/utilities.ts"),c=t("./src/WebGL/math/index.ts"),u=t("./src/parsers/VASP.ts"),v=t("./src/parsers/CUBE.ts"),f=t("./node_modules/pako/dist/pako.esm.mjs");class g{constructor(p,E,k){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(y){var w=y/(this.size.y*this.size.z),S=y%(this.size.y*this.size.z),C=y%this.size.z;return w*=this.unit.x,S*=this.unit.y,C*=this.unit.z,w+=this.origin.x,S+=this.origin.y,C+=this.origin.z,{x:w,y:S,z:C}},this.vasp=function(y){var w=y.replace(/^\s+/,"").split(/[\n\r]/),S=(0,u.VASP)(y)[0],C=S.length;if(C==0){console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),this.data=[];return}var h=1.889725992,x=.036749309,R=parseFloat(w[1]),M;M=w[2].replace(/^\s+/,"").split(/\s+/);var P=new c.Vector3(parseFloat(M[0]),parseFloat(M[1]),parseFloat(M[2])).multiplyScalar(R*h);M=w[3].replace(/^\s+/,"").split(/\s+/);var D=new c.Vector3(parseFloat(M[0]),parseFloat(M[1]),parseFloat(M[2])).multiplyScalar(R*h);M=w[4].replace(/^\s+/,"").split(/\s+/);var L=new c.Vector3(parseFloat(M[0]),parseFloat(M[1]),parseFloat(M[2])).multiplyScalar(R*h),X=P.x*(D.y*L.z-L.y*D.z)-D.x*(P.y*L.z-L.y*P.z)+L.x*(P.y*D.z-D.y*P.z);X=Math.abs(X)/Math.pow(h,3);var B=1/X;w.splice(0,8+C+1);var j=w[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),H=Math.abs(parseFloat(j[0])),$=Math.abs(parseFloat(j[1])),q=Math.abs(parseFloat(j[2])),W=this.origin=new c.Vector3(0,0,0);this.size={x:H,y:$,z:q},this.unit=new c.Vector3(P.x,D.y,L.z),P=P.multiplyScalar(1/(h*H)),D=D.multiplyScalar(1/(h*$)),L=L.multiplyScalar(1/(h*q)),(P.y!=0||P.z!=0||D.x!=0||D.z!=0||L.x!=0||L.y!=0)&&(this.matrix=new c.Matrix4(P.x,D.x,L.x,0,P.y,D.y,L.y,0,P.z,D.z,L.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new c.Matrix4().makeTranslation(W.x,W.y,W.z)),this.origin=new c.Vector3(0,0,0),this.unit=new c.Vector3(1,1,1)),w.splice(0,1);var Y=w.join(" ");Y=Y.replace(/^\s+/,"");var G=Y.split(/[\s\r]+/);G.splice(H*$*q+1);for(var V=Float32Array.from(G,parseFloat),Z=0;Z<V.length;Z++)V[Z]=V[Z]*B*x;this.data=V},this.dx=function(y){var w=y.split(/[\n\r]+/),S,C=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,h=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,x=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,R=/data follows/,M=0;for(M=0;M<w.length;M++){var P=w[M];if(S=C.exec(P)){var D=parseInt(S[1]),L=parseInt(S[2]),X=parseInt(S[3]);this.size={x:D,y:L,z:X}}else if(S=x.exec(P)){var B=parseFloat(S[1]);if((parseFloat(S[2])!=0||parseFloat(S[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),M+=1,P=w[M],S=x.exec(P),S==null){console.error("Parse error in dx delta matrix");return}var j=parseFloat(S[2]);if((parseFloat(S[1])!=0||parseFloat(S[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),M+=1,P=w[M],S=x.exec(P),S==null){console.error("Parse error in dx delta matrix");return}var H=parseFloat(S[3]);(parseFloat(S[1])!=0||parseFloat(S[2])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new c.Vector3(B,j,H)}else if(S=h.exec(P)){var $=parseFloat(S[1]),q=parseFloat(S[2]),W=parseFloat(S[3]);this.origin=new c.Vector3($,q,W)}else if(S=R.exec(P))break}if(M+=1,!this.size||!this.origin||!this.unit||!this.size){console.error("Error parsing dx format");return}var Y=w.splice(M).join(" "),G=Y.split(/[\s\r]+/);this.data=Float32Array.from(G,parseFloat)},E=E.toLowerCase(),/\.gz$/.test(E)){E=E.replace(/\.gz$/,"");try{this[E]&&this.isbinary.has(E)?(typeof p=="string"&&(p=(0,o.base64ToArray)(p)),p=(0,f.inflate)(p)):p=new TextDecoder("utf-8").decode((0,f.inflate)(p))}catch(y){console.error(y)}}if(this[E]&&(this.isbinary.has(E)&&typeof p=="string"&&(p=(0,o.base64ToArray)(p)),this[E](p)),k){if(k.negate)for(let y=0,w=this.data.length;y<w;y++)this.data[y]=-this.data[y];if(k.normalize){var A=0;for(let y=0,w=this.data.length;y<w;y++)A+=this.data[y];var z=A/this.data.length;A=0;for(let y=0,w=this.data.length;y<w;y++){var l=this.data[y]-z;A+=l*l}var s=A/this.data.length;for(let y=0,w=this.data.length;y<w;y++)this.data[y]=(this.data[y]-z)/s}}}getIndex(p,E,k){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new c.Matrix4().getInverse(this.matrix));var A=new c.Vector3(p,E,k);A=A.applyMatrix4(this.inversematrix),p=A.x,E=A.y,k=A.z}else p-=this.origin.x,E-=this.origin.y,k-=this.origin.z,p/=this.unit.x,E/=this.unit.y,k/=this.unit.z;return p=Math.round(p),E=Math.round(E),k=Math.round(k),p<0||p>=this.size.x||E<0||E>=this.size.y||k<0||k>=this.size.z?-1:p*this.size.y*this.size.z+E*this.size.z+k}getVal(p,E,k){let A=this.getIndex(p,E,k);return A<0?0:this.data[A]}cube(p){var E=p.split(/\r?\n/);if(!(E.length<6)){var k=(0,v.CUBE)(p,{}).modelData[0].cryst,A=E[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),z=parseFloat(A[0]),l=Math.abs(z);this.origin=k.origin,this.size=k.size,this.unit=k.unit,this.matrix=k.matrix4;var s=6;z<0&&s++;var y=E.splice(l+s).join(" ");y=y.replace(/^\s+/,"");var w=y.split(/[\s\r]+/);this.data=Float32Array.from(w,parseFloat)}}ccp4(p){var E={};p=new Int8Array(p);var k=new Int32Array(p.buffer,0,56),A=new Float32Array(p.buffer,0,56),z=new DataView(p.buffer);if(E.MAP=String.fromCharCode(z.getUint8(208),z.getUint8(209),z.getUint8(210),z.getUint8(211)),E.MACHST=[z.getUint8(212),z.getUint8(213)],E.MACHST[0]===17&&E.MACHST[1]===17)for(var l=p.byteLength,s=0;s<l;s+=4)z.setFloat32(s,z.getFloat32(s),!0);E.NX=k[0],E.NY=k[1],E.NZ=k[2],E.MODE=k[3],E.NXSTART=k[4],E.NYSTART=k[5],E.NZSTART=k[6],E.MX=k[7],E.MY=k[8],E.MZ=k[9],E.xlen=A[10],E.ylen=A[11],E.zlen=A[12],E.alpha=A[13],E.beta=A[14],E.gamma=A[15],E.MAPC=k[16],E.MAPR=k[17],E.MAPS=k[18],E.DMIN=A[19],E.DMAX=A[20],E.DMEAN=A[21],E.ISPG=k[22],E.NSYMBT=k[23],E.LSKFLG=k[24],E.originX=A[49],E.originY=A[50],E.originZ=A[51],E.ARMS=A[54];var y=E,w=[y.xlen,0,0],S=[y.ylen*Math.cos(Math.PI/180*y.gamma),y.ylen*Math.sin(Math.PI/180*y.gamma),0],C=[y.zlen*Math.cos(Math.PI/180*y.beta),y.zlen*(Math.cos(Math.PI/180*y.alpha)-Math.cos(Math.PI/180*y.gamma)*Math.cos(Math.PI/180*y.beta))/Math.sin(Math.PI/180*y.gamma),0];C[2]=Math.sqrt(y.zlen*y.zlen*Math.sin(Math.PI/180*y.beta)*Math.sin(Math.PI/180*y.beta)-C[1]*C[1]);var h=[0,w,S,C],x=[0,y.MX,y.MY,y.MZ],R=[0,y.MAPC,y.MAPR,y.MAPS];this.matrix=new c.Matrix4,this.matrix.set(h[R[1]][0]/x[R[1]],h[R[2]][0]/x[R[2]],h[R[3]][0]/x[R[3]],0,h[R[1]][1]/x[R[1]],h[R[2]][1]/x[R[2]],h[R[3]][1]/x[R[3]],0,h[R[1]][2]/x[R[1]],h[R[2]][2]/x[R[2]],h[R[3]][2]/x[R[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new c.Matrix4().makeTranslation(y.NXSTART+y.originX,y.NYSTART+y.originY,y.NZSTART+y.originZ)),this.origin=new c.Vector3(0,0,0),this.unit=new c.Vector3(1,1,1),this.size={x:E.NX,y:E.NY,z:E.NZ},this.dimensionorder=[E.MAPC,E.MAPR,E.MAPS];var M=new Float32Array(p.buffer,1024+E.NSYMBT),P=E.NX,D=E.NY,L=E.NZ;this.data=new Float32Array(P*D*L);for(let X=0;X<P;X++)for(let B=0;B<D;B++)for(let j=0;j<L;j++)this.data[(X*D+B)*L+j]=M[(j*D+B)*P+X]}}}),"./src/VolumetricRender.ts":((e,r,t)=>{t.r(r),t.d(r,{GLVolumetricRender:()=>g});var o=t("./src/WebGL/shapes/index.ts"),c=t("./src/WebGL/math/index.ts"),u=t("./src/WebGL/index.ts"),v=t("./src/colors.ts"),f=t("./src/GLShape.ts");class g{static interpolateArray(p,E){function k(C,h,x){return C+(h-C)*x}var A=[],z=(p.length-1)/(E-1);A[0]=p[0];for(var l=1;l<E-1;l++){var s=l*z,y=Math.floor(s),w=Math.ceil(s),S=s-y;A[l]=k(p[y],p[w],S)}return A[E-1]=p[p.length-1],A}constructor(p,E,k){this.hidden=!1,this.boundingSphere=new o.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,E=E||{};var A=Object.assign([],E.transferfn);this.subsamples=E.subsamples||5;let z=256;A.forEach(function(D){D.value=parseFloat(D.value)}),A.sort(function(D,L){return D.value-L.value}),this.min=A[0].value,A.length==0&&A.push(A[0]),this.max=A[A.length-1].value;var l,s,y,w,S,C,h,x,R,M;for(let D=0;D<A.length-1;D++)if(y=v.CC.color(A[D].color),w=v.CC.color(A[D+1].color),R=A[D].opacity,M=A[D+1].opacity,l=Math.floor((A[D].value-this.min)*z/(this.max-this.min)),s=Math.floor((A[D+1].value-this.min)*z/(this.max-this.min)),l!=s){S=g.interpolateArray([y.r*255,w.r*255],s-l),C=g.interpolateArray([y.g*255,w.g*255],s-l),h=g.interpolateArray([y.b*255,w.b*255],s-l),x=g.interpolateArray([R*255,M*255],s-l);for(let L=0;L<S.length;L++)this.transferfunctionbuffer.push(S[L]),this.transferfunctionbuffer.push(C[L]),this.transferfunctionbuffer.push(h[L]),this.transferfunctionbuffer.push(x[L])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),p.matrix){let D=new c.Vector3(0,0,0),L=new c.Vector3(p.size.x,p.size.y,p.size.z),X=new c.Vector3(1,1,1);D.applyMatrix4(p.matrix),L.applyMatrix4(p.matrix),X.applyMatrix4(p.matrix).sub(D),this.extent=[[D.x,D.y,D.z],[L.x,L.y,L.z]];for(let $=1;$<7;$++)L.x=$&1?p.size.x:0,L.y=$&2?p.size.y:0,L.z=$&4?p.size.z:0,L.applyMatrix4(p.matrix),this.extent[0][0]=Math.min(this.extent[0][0],L.x),this.extent[0][1]=Math.min(this.extent[0][1],L.y),this.extent[0][2]=Math.min(this.extent[0][2],L.z),this.extent[1][0]=Math.max(this.extent[1][0],L.x),this.extent[1][1]=Math.max(this.extent[1][1],L.y),this.extent[1][2]=Math.max(this.extent[1][2],L.z);let B=L.x-D.x,j=L.y-D.y,H=L.z-D.z;this.maxdepth=Math.sqrt(B*B+j*j+H*H),this.minunit=Math.min(Math.min(X.x,X.y),X.z),this.texmatrix=new c.Matrix4().identity().scale({x:p.size.x,y:p.size.y,z:p.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(p.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new c.Matrix4().identity();let D=p.unit.x*p.size.x,L=p.unit.y*p.size.y,X=p.unit.z*p.size.z;this.texmatrix.makeTranslation(-p.origin.x/D,-p.origin.y/L,-p.origin.z/X),this.texmatrix.scale({x:1/D,y:1/L,z:1/X}),this.minunit=Math.min(Math.min(p.unit.x,p.unit.y),p.unit.z),this.extent=[[p.origin.x,p.origin.y,p.origin.z],[p.origin.x+D,p.origin.y+L,p.origin.z+X]],this.maxdepth=Math.sqrt(D*D+L*L+X*X)}var P=new f.GLShape({});if(P.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=P.finalize(),this.boundingSphere.center=new c.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,E.coords===void 0&&E.selection!==void 0&&(k?E.coords=k.selectedAtoms(E.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),E.coords!==void 0&&E.seldist!==void 0){let D=new Uint8Array(p.data.length),L=E.seldist,X=L*L;for(let B=0,j=E.coords.length;B<j;B++){let H=E.coords[B],$=H.x-L,q=H.y-L,W=H.z-L,Y=H.x+L,G=H.y+L,V=H.z+L;if(p.getIndex($,q,W)>=0||p.getIndex(Y,G,V)>=0)for(let Z=$;Z<Y;Z+=this.minunit)for(let xe=q;xe<G;xe+=this.minunit)for(let ce=W;ce<V;ce+=this.minunit){let Ne=p.getIndex(Z,xe,ce);Ne>=0&&!D[Ne]&&(Z-H.x)*(Z-H.x)+(xe-H.y)*(xe-H.y)+(ce-H.z)*(ce-H.z)<X&&(D[Ne]=1)}}for(let B=0,j=p.data.length;B<j;B++)D[B]==0&&(p.data[B]=1/0)}this.data=p}globj(p){if(this.renderedShapeObj&&(p.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new u.Object3D;var E=null,k=new u.Texture(this.data,!0),A=new u.Texture(this.transferfunctionbuffer,!1);k.needsUpdate=!0,A.needsUpdate=!0,A.flipY=!1,E=new u.VolumetricMaterial({transferfn:A,transfermin:this.min,transfermax:this.max,map:k,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var z=new u.Mesh(this.geo,E);this.shapeObj.add(z),this.renderedShapeObj=this.shapeObj.clone(),p.add(this.renderedShapeObj)}}removegl(p){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),p.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}}),"./src/WebGL/Camera.ts":((e,r,t)=>{t.r(r),t.d(r,{Camera:()=>u});var o=t("./src/WebGL/core/index.ts"),c=t("./src/WebGL/math/index.ts");class u extends o.Object3D{constructor(f=50,g=1,_=.1,p=2e3,E=!1){super(),this.projectionMatrix=new c.Matrix4,this.projectionMatrixInverse=new c.Matrix4,this.matrixWorldInverse=new c.Matrix4,this.fov=f,this.aspect=g,this.near=_,this.far=p;var k=this.position.z;this.right=k*Math.tan(Math.PI/180*f),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!E,this.updateProjectionMatrix()}lookAt(f){this.matrix.lookAt(this.position,f,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof c.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}}),"./src/WebGL/Fog.ts":((e,r,t)=>{t.r(r),t.d(r,{Fog:()=>c});var o=t("./src/colors.ts");class c{constructor(v,f=1,g=1e3){this.name="",this.color=new o.Color(v),this.near=f,this.far=g}clone(){return new c(this.color.getHex(),this.near,this.far)}}}),"./src/WebGL/Renderer.ts":((e,r,t)=>{t.r(r),t.d(r,{Renderer:()=>A});var o=t("./src/WebGL/Camera.ts"),c=t("./src/WebGL/constants/Sides.ts"),u=t("./src/WebGL/constants/TextureConstants.ts"),v=t("./src/WebGL/core/index.ts"),f=t("./src/colors.ts"),g=t("./src/WebGL/materials/index.ts"),_=t("./src/WebGL/math/index.ts"),p=t("./src/WebGL/objects/index.ts"),E=t("./src/WebGL/shaders/index.ts"),k=t("./src/WebGL/SpritePlugin.ts");class A{constructor(l){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new _.Vector3,this._worldInverse=new _.Matrix4,this._projInverse=new _.Matrix4,this._textureMatrix=new _.Matrix4,this._fullProjModelMatrix=new _.Matrix4,this._fullProjModelMatrixInv=new _.Matrix4,this._direction=new _.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new k.SpritePlugin,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,l=l||{},this.row=l.row,this.col=l.col,this.rows=l.rows,this.cols=l.cols,this._canvas=l.canvas!==void 0?l.canvas:document.createElement("canvas"),this._precision=l.precision!==void 0?l.precision:"highp",this._alpha=l.alpha!==void 0?l.alpha:!0,this._premultipliedAlpha=l.premultipliedAlpha!==void 0?l.premultipliedAlpha:!0,this._antialias=l.antialias!==void 0?l.antialias:!1,this._preserveDrawingBuffer=l.preserveDrawingBuffer!==void 0?l.preserveDrawingBuffer:!1,this._clearColor=l.clearColor!==void 0?new f.Color(l.clearColor):new f.Color(0),this._clearAlpha=l.clearAlpha!==void 0?l.clearAlpha:0,this._outlineMaterial=new g.MeshOutlineMaterial(l.outline),this._outlineSphereImposterMaterial=new g.SphereImposterOutlineMaterial(l.outline),this._outlineStickImposterMaterial=new g.StickImposterOutlineMaterial(l.outline),this._outlineEnabled=!!l.outline,this._AOEnabled=!!l.ambientOcclusion,l.ambientOcclusion&&typeof l.ambientOcclusion.strength<"u"&&(this._AOstrength=parseFloat(l.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),l.ambientOcclusion&&typeof l.ambientOcclusion.radius<"u"&&(this._AOradius=parseFloat(l.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=l.id,!(l.containerWidth==0||l.containerHeight==0)&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(l,s){this._clearColor.setHex(l),this._clearAlpha=s,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(l){this._outlineMaterial=new g.MeshOutlineMaterial(l),this._outlineSphereImposterMaterial=new g.SphereImposterOutlineMaterial(l),this._outlineStickImposterMaterial=new g.StickImposterOutlineMaterial(l),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(l){l&&(l.strength&&(this._AOstrength=l.strength),l.scale&&(this._AOradius=l.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var l=this._canvas.width/this.cols,s=this._canvas.height/this.rows;this._viewportWidth=l,this._viewportHeight=s,this.isLost()||(this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(l*this.col,s*this.row,l,s),this._gl.viewport(l*this.col,s*this.row,l,s))}}setSize(l,s){if(this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._antialias&&this.devicePixelRatio<2&&(this.devicePixelRatio*=2),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var y=l/this.cols,w=s/this.rows;this._canvas.width=l*this.devicePixelRatio,this._canvas.height=s*this.devicePixelRatio,this._viewportWidth=y*this.devicePixelRatio,this._viewportHeight=w*this.devicePixelRatio,this._canvas.style.width=l+"px",this._canvas.style.height=s+"px",this.setViewport()}else this._viewportWidth=this._canvas.width=l*this.devicePixelRatio,this._viewportHeight=this._canvas.height=s*this.devicePixelRatio,this._canvas.style.width=l+"px",this._canvas.style.height=s+"px",this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight);this.initFrameBuffer()}clear(l,s,y){var w=0;(l===void 0||l)&&(w|=this._gl.COLOR_BUFFER_BIT),(s===void 0||s)&&(w|=this._gl.DEPTH_BUFFER_BIT),(y===void 0||y)&&(w|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(w)}setMaterialFaces(l,s){var y=l.side===c.DoubleSide,w=l.side===c.BackSide;l.imposter||(w=s?!w:w),this._oldDoubleSided!==y&&(y?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=y),this._oldFlipSided!==w&&(w?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=w),this._gl.cullFace(this._gl.BACK)}setDepthTest(l){this._oldDepthTest!==l&&(l?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=l)}setDepthWrite(l){this._oldDepthWrite!==l&&(this._gl.depthMask(l),this._oldDepthWrite=l)}setBlending(l){l?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(l,s,y,w){l.addEventListener("dispose",this.onMaterialDispose.bind(this));var S,C;if(C=l.shaderID,C){var h=E.ShaderLib[C];l.vertexShader=h.vertexShader,l.fragmentShader=h.fragmentShader,l.uniforms=E.ShaderUtils.clone(h.uniforms),l.shaded&&l.makeShaded(this.SHADE_TEXTURE)}S={wireframe:l.wireframe,fragdepth:l.imposter,volumetric:l.volumetric,shaded:l.shaded},l.program=this.buildProgram(l.fragmentShader,l.vertexShader,l.uniforms,S)}renderBuffer(l,s,y,w,S,C){if(w.visible){var h,x;if(h=this.setProgram(l,s,y,w,C,this),!!h){x=h.attributes;var R=!1,M=w.wireframe?1:0,P=S.id*16777215+h.id*2+M;P!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=P,R=!0),R&&(this.disableAttributes(),x.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglVertexBuffer),this.enableAttribute(x.position),this._gl.vertexAttribPointer(x.position,3,this._gl.FLOAT,!1,0,0)),x.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglColorBuffer),this.enableAttribute(x.color),this._gl.vertexAttribPointer(x.color,3,this._gl.FLOAT,!1,0,0)),x.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglNormalBuffer),this.enableAttribute(x.normal),this._gl.vertexAttribPointer(x.normal,3,this._gl.FLOAT,!1,0,0)),x.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglOffsetBuffer),this.enableAttribute(x.offset),this._gl.vertexAttribPointer(x.offset,3,this._gl.FLOAT,!1,0,0)),x.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglRadiusBuffer),this.enableAttribute(x.radius),this._gl.vertexAttribPointer(x.radius,1,this._gl.FLOAT,!1,0,0)));var D,L;if(C instanceof p.Mesh){if(w.shaderID==="instanced"){var X=w.sphere.geometryGroups[0];R&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,X.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,X.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,S.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,X.faceArray,this._gl.STATIC_DRAW)),D=X.faceidx,this._extInstanced.vertexAttribDivisorANGLE(x.offset,1),this._extInstanced.vertexAttribDivisorANGLE(x.radius,1),this._extInstanced.vertexAttribDivisorANGLE(x.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,D,this._gl.UNSIGNED_SHORT,0,S.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(x.offset,0),this._extInstanced.vertexAttribDivisorANGLE(x.radius,0),this._extInstanced.vertexAttribDivisorANGLE(x.color,0)}else w.wireframe?(L=S.lineidx,this.setLineWidth(w.wireframeLinewidth),R&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,S.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,L,this._gl.UNSIGNED_SHORT,0)):(D=S.faceidx,R&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,S.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,D,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=D,this.info.render.faces+=D/3}else C instanceof p.Line&&(L=S.vertices,this.setLineWidth(w.linewidth),this._gl.drawArrays(this._gl.LINES,0,L),this.info.render.calls++)}}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(l,s,y){let w=l.__lights,S=l.fog,C=[];for(let R=0,M=l.__webglObjects.length;R<M;R++){let P=l.__webglObjects[R];P.render&&P[y]&&C.push(P)}if(C.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(l.__webglObjects,!0,y+"Depth",s,w,S,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let h=this._AOshader.uniforms;this._gl.uniform1f(h.total_strength,this._AOstrength),this._gl.uniform1f(h.radius,this._AOradius),this._fullProjModelMatrix=new _.Matrix4,this._fullProjModelMatrixInv=new _.Matrix4;let x=C[0].object;this._fullProjModelMatrix.multiplyMatrices(s.projectionMatrix,x._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(h.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(h.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(l,s){if(!(s instanceof o.Camera)){console.error("Renderer.render: camera is not an instance of Camera.");return}var y,w,S,C,h,x=l.__lights,R=l.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&l.updateMatrixWorld(),s.parent===void 0&&s.updateMatrixWorld(),s.matrixWorldInverse.getInverse(s.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(l),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),h=l.__webglObjects;let M=!1,P=this._AOEnabled;for(y=0,w=h.length;y<w;y++)S=h[y],C=S.object,S.render=!1,C.visible&&(this.setupMatrices(C,s),this.unrollBufferMaterial(S),S.render=!0,S.volumetric&&(M=!0),S.hasAO&&(P=!0));this.setBlending(!1),P&&this.setShading(l,s,"opaque"),this.renderObjects(l.__webglObjects,!0,"opaque",s,x,R,!1),P&&this.clearShading(),this.renderSprites(l,s,!1),this.renderObjects(l.__webglObjects,!0,"transparentDepth",s,x,R,!0),this.renderObjects(l.__webglObjects,!1,"transparent",s,x,R,!0),M&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(l.__webglObjects,!1,"volumetric",s,x,R,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(l,s,!0)}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let l=this._viewportWidth,s=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,l,s),this._gl.viewport(0,0,l,s),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,l,s,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,l,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,l,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,l,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let l=this._viewportWidth,s=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,l,s),this._gl.viewport(0,0,l,s),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var y=this._antialias?E.ShaderLib.screenaa:E.ShaderLib.screen;this._screenshader=this.buildProgram(y.fragmentShader,y.vertexShader,y.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition");var w=[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1];this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(w),this._gl.STATIC_DRAW);let S=E.ShaderLib.ssao;this._AOshader=this.buildProgram(S.fragmentShader,S.vertexShader,S.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let C=E.ShaderLib.blur;this._blurshader=this.buildProgram(C.fragmentShader,C.vertexShader,C.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(l){if(l.__webglObjects||(l.__webglObjects=[],l.__webglObjectsImmediate=[],l.__webglSprites=[],l.__webglFlares=[]),l.__objectsAdded.length){for(;l.__objectsAdded.length;)this.addObject(l.__objectsAdded[0],l),l.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;l.__objectsRemoved.length;)this.removeObject(l.__objectsRemoved[0],l),l.__objectsRemoved.splice(0,1);for(var s=0,y=l.__webglObjects.length;s<y;s++)this.updateObject(l.__webglObjects[s].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(l,s){(l==null||s==null)&&(l=this._canvas.width,s=this._canvas.height);var y=l/s;if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var w=l/this.cols,S=s/this.rows;y=w/S}return y}setTexture(l,s,y){if(l.needsUpdate){l.__webglInit||(l.__webglInit=!0,l.addEventListener("dispose",this.onTextureDispose.bind(this)),l.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+s);var w=y?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(w,l.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,l.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,l.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,l.unpackAlignment);var S=this.paramToGL(l.format),C=this.paramToGL(l.type);if(y)this.setTextureParameters(this._gl.TEXTURE_3D,l),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,l.image.size.z,l.image.size.y,l.image.size.x,0,this._gl.RED,this._gl.FLOAT,l.image.data);else{var h=l.image,x=h.width,R=h.height;typeof x>"u"&&(x=h.length,S==this._gl.RGBA&&(x/=4),R=1),this.setTextureParameters(this._gl.TEXTURE_2D,l),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,S,S,C,l.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,S,x,R,0,S,C,l.image)}l.needsUpdate=!1,l.onUpdate&&l.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+s),y?this._gl.bindTexture(this._gl.TEXTURE_3D,l.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,l.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(l){this._enabledAttributes[l]||(this._gl.enableVertexAttribArray(l),this._enabledAttributes[l]=!0)}disableAttributes(){for(let l in this._enabledAttributes)this._enabledAttributes[l]&&(this._gl.disableVertexAttribArray(l),this._enabledAttributes[l]=!1)}setPolygonOffset(l,s,y){this._oldPolygonOffset!==l&&(l?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(l){l!==this._oldLineWidth&&(this._gl.lineWidth(l),this._oldLineWidth=l)}deallocateGeometry(l){if(l.__webglInit=void 0,l.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(l.__webglVertexBuffer),l.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(l.__webglColorBuffer),l.geometryGroups!==void 0)for(var s=0,y=l.groups;s<y;s++){var w=l.geometryGroups[s];w.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(w.__webglVertexBuffer),w.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(w.__webglColorBuffer),w.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(w.__webglNormalBuffer),w.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(w.__webglFaceBuffer),w.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(w.__webglLineBuffer)}}deallocateMaterial(l){var s=l.program;if(s!==void 0){l.program=void 0;var y,w,S,C=!1;for(y=0,w=this._programs.length;y<w;y++)if(S=this._programs[y],S.program===s){S.usedTimes--,S.usedTimes===0&&(C=!0);break}if(C===!0){var h=[];for(y=0,w=this._programs.length;y<w;y++)S=this._programs[y],S.program!==s&&h.push(S);this._programs=h,this._gl.deleteProgram(s),this.info.memory.programs--}}}deallocateTexture(l){if(l.image&&l.image.__webglTextureCube)this._gl.deleteTexture(l.image.__webglTextureCube);else{if(!l.__webglInit)return;l.__webglInit=!1,this._gl.deleteTexture(l.__webglTexture)}}onGeometryDispose(l){var s=l.target;s.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(s),this.info.memory.geometries--}onTextureDispose(l){var s=l.target;s.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(s),this.info.memory.textures--}onMaterialDispose(l){var s=l.target;s.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(s)}getShader(l,s){var y;return!this.isWebGL1()&&!s.startsWith("#version")&&(s=s.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),l=="fragment"?s=s.replace(/varying/g,"in"):s=s.replace(/varying/g,"out"),s=s.replace(/attribute/g,"in"),s=s.replace(/texture2D/g,"texture"),s=s.replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;"),s=s.replace(/gl_FragColor/g,"glFragColor"),s=`#version 300 es
`+s),l==="fragment"?y=this._gl.createShader(this._gl.FRAGMENT_SHADER):l==="vertex"&&(y=this._gl.createShader(this._gl.VERTEX_SHADER)),y==null?null:(this._gl.shaderSource(y,s),this._gl.compileShader(y),this._gl.getShaderParameter(y,this._gl.COMPILE_STATUS)?y:(console.error(this._gl.getShaderInfoLog(y)),console.error("could not initialize shader"),null))}buildProgram(l,s,y,w){var S,C,h,x,R=[];R.push(l),R.push(s);for(S in w)R.push(S),R.push(w[S]);for(x=R.join(),S=0,C=this._programs.length;S<C;S++){var M=this._programs[S];if(M.code===x)return M.usedTimes++,M.program}if(this.isWebGL1()&&w.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if(h=this._gl.createProgram(),h==null)return null;var P=this._precision,D="precision "+P+" float;",L=[w.volumetric?"#version 300 es":"",D].join(`
`),X=[w.volumetric?"#version 300 es":"",w.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",w.shaded?"#define SHADED 1":"",w.wireframe?"#define WIREFRAME 1":"",D].join(`
`),B=this.getShader("fragment",X+l),j=this.getShader("vertex",L+s);j!=null&&this._gl.attachShader(h,j),B!=null&&this._gl.attachShader(h,B),this._gl.linkProgram(h),this._gl.getProgramParameter(h,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),h.uniforms={},h.attributes={};var H,$,q;H=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix"];for($ in y)H.push($);for(q=0;q<H.length;q++){var W=H[q];h.uniforms[W]=this._gl.getUniformLocation(h,W)}for(H=["position","normal","color","lineDistance","offset","radius"],q=0;q<H.length;q++){var Y=H[q];h.attributes[Y]=this._gl.getAttribLocation(h,Y)}return h.id=this._programs_counter++,this._programs.push({program:h,code:x,usedTimes:1}),this.info.memory.programs=this._programs.length,h}setProgram(l,s,y,w,S,C){if(w.needsUpdate&&(w.program&&this.deallocateMaterial(w),this.initMaterial(w,s,y,S),w.needsUpdate=!1),w.program==null)return null;var h=!1,x=w.program,R=x.uniforms,M=w.uniforms;if(x!=this._currentProgram&&(this._gl.useProgram(x),this._currentProgram=x,h=!0),w.id!=this._currentMaterialId&&(this._currentMaterialId=w.id,h=!0),l!=this._currentCamera&&(this._currentCamera=l,h=!0),R.projectionMatrix&&this._gl.uniformMatrix4fv(R.projectionMatrix,!1,l.projectionMatrix.elements),R.modelViewMatrix&&this._gl.uniformMatrix4fv(R.modelViewMatrix,!1,S._modelViewMatrix.elements),R.normalMatrix&&this._gl.uniformMatrix3fv(R.normalMatrix,!1,S._normalMatrix.elements),R.projinv&&(this._projInverse.getInverse(l.projectionMatrix),this._gl.uniformMatrix4fv(R.projinv,!1,this._projInverse.elements)),R.viewMatrix&&this._gl.uniformMatrix4fv(R.viewMatrix,!1,l.matrixWorldInverse.elements),h){if(M.fogColor.value=y.color,M.fogNear.value=y.near,M.fogFar.value=y.far,w.shaderID.startsWith("lambert")||w.shaderID==="instanced"||w.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(x,s),this._lightsNeedUpdate=!1),M.directionalLightColor.value=this._lights.directional.colors,M.directionalLightDirection.value=this._lights.directional.positions;else if(w.shaderID.endsWith("outline"))M.outlineColor.value=w.outlineColor,M.outlineWidth.value=w.outlineWidth,M.outlinePushback.value=w.outlinePushback;else if(w.shaderID==="volumetric"){S._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(S._modelViewMatrix),this._projInverse.getInverse(l.projectionMatrix),this._textureMatrix.multiplyMatrices(S.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(R.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(R.projinv,!1,this._projInverse.elements);let P=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);M.step.value=S.material.unit*P,M.maxdepth.value=S.material.maxdepth*P,M.transfermax.value=S.material.transfermax,M.transfermin.value=S.material.transfermin,M.subsamples.value=S.material.subsamples,C.setTexture(S.material.transferfn,4,!1),C.setTexture(S.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}M.opacity.value=w.opacity,this.loadMaterialUniforms(R,M)}return M.shading&&(M.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),x}loadMaterialUniforms(l,s){var y,w,S,C;for(y in s)l[y]&&(w=s[y].type,S=s[y].value,C=l[y],w==="f"?this._gl.uniform1f(C,S):w==="i"?this._gl.uniform1i(C,S):w==="fv"?this._gl.uniform3fv(C,S):w==="c"?this._gl.uniform3f(C,S.r,S.g,S.b):w==="f4"&&this._gl.uniform4f(C,S[0],S[1],S[2],S[3]))}addObject(l,s){var y,w,S,C;if(!l.__webglInit&&(l.__webglInit=!0,l._modelViewMatrix=new _.Matrix4,l._normalMatrix=new _.Matrix3,l.geometry!==void 0&&l.geometry.__webglInit===void 0&&(l.geometry.__webglInit=!0,l.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),l instanceof p.Mesh||l instanceof p.Line))for(S=l.geometry,y=0,w=S.geometryGroups.length;y<w;y++)C=S.geometryGroups[y],C.id=this._geometryGroupCounter++,C.__webglVertexBuffer||(l instanceof p.Mesh?(this.createMeshBuffers(C),S.elementsNeedUpdate=!0,S.normalsNeedUpdate=!0):l instanceof p.Line&&this.createLineBuffers(C),S.verticesNeedUpdate=!0,S.colorsNeedUpdate=!0);if(!l.__webglActive){if(l instanceof p.Mesh||l instanceof p.Line)for(S=l.geometry,y=0,w=S.geometryGroups.length;y<w;y++)C=S.geometryGroups[y],this.addBuffer(s.__webglObjects,C,l);else l instanceof p.Sprite&&s.__webglSprites.push(l);l.__webglActive=!0}}updateObject(l){var s=l.geometry,y;if(l instanceof p.Mesh||l instanceof p.Line){for(var w=0,S=s.geometryGroups.length;w<S;w++)y=s.geometryGroups[w],(s.verticesNeedUpdate||s.elementsNeedUpdate||s.colorsNeedUpdate||s.normalsNeedUpdate)&&this.setBuffers(y,this._gl.STATIC_DRAW);s.verticesNeedUpdate=!1,s.elementsNeedUpdate=!1,s.normalsNeedUpdate=!1,s.colorsNeedUpdate=!1,s.buffersNeedUpdate=!1}}removeObject(l,s){l instanceof p.Mesh||l instanceof p.Line?this.removeInstances(s.__webglObjects,l):l instanceof p.Sprite&&this.removeInstancesDirect(s.__webglSprites,l),l.__webglActive=!1}removeInstances(l,s){for(var y=l.length-1;y>=0;--y)l[y].object===s&&l.splice(y,1)}removeInstancesDirect(l,s){for(var y=l.length-1;y>=0;--y)l[y]===s&&l.splice(y,1)}unrollBufferMaterial(l){var s=l.object,y=s.material;if(y.volumetric)l.opaque=null,l.transparent=null,l.volumetric=y;else if(y.transparent){if(l.opaque=null,l.volumetric=null,l.transparent=y,!y.wireframe){let w=y.clone();w.opacity=0,l.transparentDepth=w}}else{if(l.opaque=y,l.transparent=null,l.volumetric=null,!y.wireframe){let w=y.clone();w.opacity=0,l.opaqueDepth=w}y.hasAO&&(l.hasAO=!0),(this._AOEnabled||l.hasAO)&&(l.opaqueShaded=y.clone(),l.opaqueShaded.shaded=!0)}}setBuffers(l,s){var y=l.vertexArray,w=l.colorArray;if(l.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,y,s)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,y,s)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,w,s),l.normalArray&&l.__webglNormalBuffer!==void 0){var S=l.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,S,s)}if(l.radiusArray&&l.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,l.radiusArray,s)),l.faceArray&&l.__webglFaceBuffer!==void 0){var C=l.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,l.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,C,s)}if(l.lineArray&&l.__webglLineBuffer!==void 0){var h=l.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,l.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,h,s)}}createMeshBuffers(l){l.radiusArray&&(l.__webglRadiusBuffer=this._gl.createBuffer()),l.useOffset&&(l.__webglOffsetBuffer=this._gl.createBuffer()),l.__webglVertexBuffer=this._gl.createBuffer(),l.__webglNormalBuffer=this._gl.createBuffer(),l.__webglColorBuffer=this._gl.createBuffer(),l.__webglFaceBuffer=this._gl.createBuffer(),l.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(l){l.__webglVertexBuffer=this._gl.createBuffer(),l.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(l,s,y){l.push({buffer:s,object:y,opaque:null,transparent:null})}setupMatrices(l,s){l._modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,l.matrixWorld),l._normalMatrix.getInverse(l._modelViewMatrix),l._normalMatrix.transpose()}filterFallback(l){return this._gl.LINEAR}setTextureParameters(l,s){l==this._gl.TEXTURE_2D?(this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(s.magFilter)),this._gl.texParameteri(l,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(s.minFilter))):(this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(l,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(l,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(l,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(l,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(l){return l===u.UnsignedByteType?this._gl.UNSIGNED_BYTE:l===u.RGBAFormat?this._gl.RGBA:l===u.NearestFilter?this._gl.NEAREST:0}setupLights(l,s){var y,w,S,C=0,h=0,x=0,R,M,P=this._lights,D=P.directional.colors,L=P.directional.positions,X=0,B=0;for(y=0,w=s.length;y<w;y++)if(S=s[y],R=S.color,M=S.intensity,S instanceof v.Light){if(this._direction.getPositionFromMatrix(S.matrixWorld),this._vector3.getPositionFromMatrix(S.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;L[B]=this._direction.x,L[B+1]=this._direction.y,L[B+2]=this._direction.z,D[B]=R.r*M,D[B+1]=R.g*M,D[B+2]=R.b*M,B+=3,X++}P.ambient[0]=C,P.ambient[1]=h,P.ambient[2]=x,P.directional.length=X}initGL(){try{if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context.";var l=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(l[6])}catch(s){console.error(s)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearColor(0,0,0,1),this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(l,s,y,w,S,C,h){var x,R,M,P,D,L,X;s?(D=l.length-1,L=-1,X=-1):(D=0,L=l.length,X=1);for(var B=D;B!==L;B+=X)if(x=l[B],x.render){if(R=x.object,M=x.buffer,P=x[y],(x.hasAO||this._AOEnabled)&&x[y+"Shaded"]&&(P=x[y+"Shaded"]),!P)continue;h&&this.setBlending(!0),this.setDepthTest(P.depthTest),this.setDepthWrite(P.depthWrite),this.setPolygonOffset(P.polygonOffset,P.polygonOffsetFactor,P.polygonOffsetUnits);var j=R._modelViewMatrix.isReflected();if(this.setMaterialFaces(P,j),this.renderBuffer(w,S,C,P,M,R),(this._outlineEnabled||P.outline)&&!P.wireframe&&P.shaderID!=="basic"&&P.opacity!==0){let H=this._outlineMaterial;P.shaderID=="sphereimposter"?H=this._outlineSphereImposterMaterial:P.shaderID=="stickimposter"&&(H=this._outlineStickImposterMaterial),this.renderBuffer(w,S,C,H,M,R)}}}renderSprites(l,s,y){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(l,s,this._currentWidth,this._currentHeight,y),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}}),"./src/WebGL/SpritePlugin.ts":((e,r,t)=>{t.r(r),t.d(r,{SpritePlugin:()=>c});var o=t("./src/WebGL/shaders/index.ts");class c{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(f){this.gl=f.context,this.renderer=f,this.precision=f.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var g=0;this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=1,g=0,this.sprite.faces[g++]=0,this.sprite.faces[g++]=1,this.sprite.faces[g++]=2,this.sprite.faces[g++]=0,this.sprite.faces[g++]=2,this.sprite.faces[g++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(o.ShaderLib.sprite,this.precision||1),this.sprite.attributes={};const _={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),_.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),_.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),_.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),_.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),_.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),_.color=this.gl.getUniformLocation(this.sprite.program,"color"),_.map=this.gl.getUniformLocation(this.sprite.program,"map"),_.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),_.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),_.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),_.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),_.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),_.fogType=this.gl.getUniformLocation(this.sprite.program,"fogType"),_.fogDensity=this.gl.getUniformLocation(this.sprite.program,"fogDensity"),_.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),_.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),_.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),_.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=_}render(f,g,_,p,E){var k,A,z,l,s,y,w,S,C,h;if(!this.gl)throw new Error("WebGLRenderer not initialized");let x=[];(k=f?.__webglSprites)===null||k===void 0||k.forEach(xe=>{(E&&xe.material.depthTest==!1||!E&&xe.material.depthTest)&&x.push(xe)});let R=x.length;if(!R)return;const M=this.sprite.attributes,P=this.sprite.uniforms;if(!P)throw new Error("Uniforms not defined");var D=_*.5,L=p*.5;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(M.position),this.gl.enableVertexAttribArray(M.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(M.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(M.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(P.projectionMatrix,!1,g.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(P.map,0);var X=0,B=0,j=f.fog;j?(this.gl.uniform3f(P.fogColor,j.color.r,j.color.g,j.color.b),this.gl.uniform1f(P.fogNear,j.near),this.gl.uniform1f(P.fogFar,j.far),this.gl.uniform1i(P.fogType,1),X=1,B=1):(this.gl.uniform1i(P.fogType,0),X=0,B=0);var H;let $,q,W,Y,G=[];for(H=0;H<R;H++)$=x[H],q=$.material,q&&(q.depthTest==!1&&!E||!$.visible||q.opacity===0||(q.useScreenCoordinates?$.z=-$.position.z:($._modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,$.matrixWorld),$.z=-$._modelViewMatrix.elements[14])));for(x.sort(u),H=0;H<R;H++)if($=x[H],q=$.material,!!q&&!(!$.visible||q.opacity===0)&&q.map&&q.map.image&&q.map.image.width){this.gl.uniform1f(P?.alphaTest||null,q.alphaTest);var V=q.map.image.width,Z=q.map.image.height;G[0]=V*this.renderer.devicePixelRatio/_,G[1]=Z*this.renderer.devicePixelRatio/p,q.useScreenCoordinates===!0?(this.gl.uniform1i(P.useScreenCoordinates,1),this.gl.uniform3f(P.screenPosition,($.position.x*this.renderer.devicePixelRatio-D)/D,(L-$.position.y*this.renderer.devicePixelRatio)/L,Math.max(0,Math.min(1,$.position.z)))):(this.gl.uniform1i(P.useScreenCoordinates,0),this.gl.uniformMatrix4fv(P.modelViewMatrix,!1,$._modelViewMatrix.elements)),f.fog&&q.fog?Y=B:Y=0,X!==Y&&(this.gl.uniform1i(P.fogType,Y),X=Y),W=1/(q.scaleByViewport?p:1),G[0]*=W*$.scale.x,G[1]*=W*$.scale.y;let xe=(A=q?.alignment)===null||A===void 0?void 0:A.x,ce=(z=q?.alignment)===null||z===void 0?void 0:z.y;q.screenOffset&&(xe=(xe||0)+2*q.screenOffset.x/V,ce=(ce||0)+2*q.screenOffset.y/Z),this.gl.uniform2f(P.uvScale,((l=q?.uvScale)===null||l===void 0?void 0:l.x)||1,((s=q?.uvScale)===null||s===void 0?void 0:s.y)||1),this.gl.uniform2f(P.uvOffset,((y=q?.uvOffset)===null||y===void 0?void 0:y.x)||0,((w=q?.uvOffset)===null||w===void 0?void 0:w.y)||0),this.gl.uniform2f(P.alignment,xe||0,ce||0),this.gl.uniform1f(P.opacity,q.opacity),this.gl.uniform3f(P.color,((S=q?.color)===null||S===void 0?void 0:S.r)||0,((C=q?.color)===null||C===void 0?void 0:C.g)||0,((h=q?.color)===null||h===void 0?void 0:h.b)||0),this.gl.uniform1f(P.rotation,$.rotation),this.gl.uniform2fv(P.scale,G),this.renderer.setDepthTest(q.depthTest),this.renderer.setDepthWrite(q.depthWrite),this.renderer.setTexture(q.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(f,g){if(!this.gl)throw new Error("WebGL Rendering context not found");var _=this.gl.createProgram();if(!_)throw new Error("Error creating webgl program");var p=this.gl.createShader(this.gl.FRAGMENT_SHADER),E=this.gl.createShader(this.gl.VERTEX_SHADER);if(!p)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!E)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var k="precision "+g+` float;
`;if(this.gl.shaderSource(p,k+f.fragmentShader),this.gl.shaderSource(E,k+f.vertexShader),this.gl.compileShader(p),this.gl.compileShader(E),!this.gl.getShaderParameter(p,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(E,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(p)} 
      ${this.gl.getShaderInfoLog(E)}`);return this.gl.attachShader(_,p),this.gl.attachShader(_,E),this.gl.linkProgram(_),this.gl.getProgramParameter(_,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),_}}function u(v,f){return v.z!==f.z?f.z-v.z:f.id-v.id}}),"./src/WebGL/constants/Coloring.ts":((e,r,t)=>{t.r(r),t.d(r,{Coloring:()=>o});var o;(function(c){c[c.NoColors=0]="NoColors",c[c.FaceColors=1]="FaceColors",c[c.VertexColors=2]="VertexColors"})(o||(o={}))}),"./src/WebGL/constants/Shading.ts":((e,r,t)=>{t.r(r),t.d(r,{Shading:()=>o});var o;(function(c){c[c.NoShading=0]="NoShading",c[c.FlatShading=1]="FlatShading",c[c.SmoothShading=2]="SmoothShading"})(o||(o={}))}),"./src/WebGL/constants/Sides.ts":((e,r,t)=>{t.r(r),t.d(r,{BackSide:()=>c,DoubleSide:()=>u,FrontSide:()=>o});const o=0,c=1,u=2}),"./src/WebGL/constants/SpriteAlignment.ts":((e,r,t)=>{t.r(r),t.d(r,{SpriteAlignment:()=>c});var o=t("./src/WebGL/math/index.ts");const c={topLeft:new o.Vector2(1,-1),topCenter:new o.Vector2(0,-1),topRight:new o.Vector2(-1,-1),centerLeft:new o.Vector2(1,0),center:new o.Vector2(0,0),centerRight:new o.Vector2(-1,0),bottomLeft:new o.Vector2(1,1),bottomCenter:new o.Vector2(0,1),bottomRight:new o.Vector2(-1,1)}}),"./src/WebGL/constants/TextureConstants.ts":((e,r,t)=>{t.r(r),t.d(r,{ClampToEdgeWrapping:()=>o,FloatType:()=>g,LinearFilter:()=>c,LinearMipMapLinearFilter:()=>v,NearestFilter:()=>u,R32Format:()=>E,RFormat:()=>p,RGBAFormat:()=>_,UnsignedByteType:()=>f});const o=1001,c=1006,u=1007,v=1008,f=1009,g=1010,_=1021,p=1022,E=1023}),"./src/WebGL/constants/TextureOperations.ts":((e,r,t)=>{t.r(r),t.d(r,{TextureOperations:()=>o});var o;(function(c){c[c.MultiplyOperation=0]="MultiplyOperation",c[c.MixOperation=1]="MixOperation",c[c.AddOperation=2]="AddOperation"})(o||(o={}))}),"./src/WebGL/constants/index.ts":((e,r,t)=>{t.r(r),t.d(r,{BackSide:()=>c.BackSide,ClampToEdgeWrapping:()=>f.ClampToEdgeWrapping,Coloring:()=>o.Coloring,DoubleSide:()=>c.DoubleSide,FloatType:()=>f.FloatType,FrontSide:()=>c.FrontSide,LinearFilter:()=>f.LinearFilter,LinearMipMapLinearFilter:()=>f.LinearMipMapLinearFilter,NearestFilter:()=>f.NearestFilter,R32Format:()=>f.R32Format,RFormat:()=>f.RFormat,RGBAFormat:()=>f.RGBAFormat,Shading:()=>u.Shading,SpriteAlignment:()=>v.SpriteAlignment,TextureOperations:()=>g.TextureOperations,UnsignedByteType:()=>f.UnsignedByteType});var o=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Sides.ts"),u=t("./src/WebGL/constants/Shading.ts"),v=t("./src/WebGL/constants/SpriteAlignment.ts"),f=t("./src/WebGL/constants/TextureConstants.ts"),g=t("./src/WebGL/constants/TextureOperations.ts")}),"./src/WebGL/core/EventDispatcher.ts":((e,r,t)=>{t.r(r),t.d(r,{EventDispatcher:()=>o});class o{constructor(){this.listeners={}}dispatchEvent(u){var v=this.listeners[u.type];if(v!==void 0){u.target=this;for(var f=0,g=v.length;f<g;f++)v[f].call(this,u)}}removeEventListener(u,v){if(!v)this.listeners[u]=[];else{var f=this.listeners[u].indexOf(v);f!==-1&&this.listeners[u].splice(f,1)}}addEventListener(u,v){this.listeners[u]===void 0&&(this.listeners[u]=[]),this.listeners[u].indexOf(v)===-1&&this.listeners[u].push(v)}}}),"./src/WebGL/core/Geometry.ts":((e,r,t)=>{t.r(r),t.d(r,{Geometry:()=>_,GeometryGroup:()=>g,GeometryIDCount:()=>p});var o=t("./src/WebGL/materials/LineBasicMaterial.ts"),c=t("./src/WebGL/core/EventDispatcher.ts"),u=t("./src/WebGL/math/index.ts"),v=t("./src/colors.ts");const f=65535;class g{constructor(k=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=k}setColors(k){var A=this.vertexArray,z=this.colorArray;if(!A)throw new Error("vertex array not initialized");if(!z)throw new Error("color array not initialized");if(A.length!=z.length){console.log("Cannot re-color geometry group due to mismatched lengths.");return}for(var l=0;l<A.length;l+=3){var s=k(A[l],A[l+1],A[l+2]);s instanceof v.Color||(s=v.CC.color(s)),z[l]=s.r,z[l+1]=s.g,z[l+2]=s.b}}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var k=new u.Vector3,A,z,l,s,y=0;y<this.vertices;++y)A=y*3,z=this.vertexArray[A],l=this.vertexArray[A+1],s=this.vertexArray[A+2],k.x+=z,k.y+=l,k.z+=s;return k.divideScalar(this.vertices),k}setNormals(){var k=this.faceArray,A=this.vertexArray,z=this.normalArray;if(!(!this.vertices||!this.faceidx)){if(!k)throw new Error("face array not initialized");if(!A)throw new Error("vertex array not initialized");if(!z)throw new Error("normal array not initialized");for(var l,s,y,w,S,C,h,x=0;x<k.length/3;++x)l=k[x*3]*3,s=k[x*3+1]*3,y=k[x*3+2]*3,w=new u.Vector3(A[l],A[l+1],A[l+2]),S=new u.Vector3(A[s],A[s+1],A[s+2]),C=new u.Vector3(A[y],A[y+1],A[y+2]),w.subVectors(w,S),C.subVectors(C,S),C.cross(w),h=C,h.normalize(),z[l]+=h.x,z[s]+=h.x,z[y]+=h.x,z[l+1]+=h.y,z[s+1]+=h.y,z[y+1]+=h.y,z[l+2]+=h.z,z[s+2]+=h.z,z[y+2]+=h.z}}setLineIndices(){if(this.faceidx&&!(this.lineArray&&this.lineArray.length==this.faceidx*2&&this.lineidx==this.faceidx*2)){var k=this.faceArray,A=this.lineArray=new Uint16Array(this.faceidx*2);if(this.lineidx=this.faceidx*2,!k)throw new Error("face array not initialized");for(var z=0;z<this.faceidx/3;++z){var l=z*3,s=l*2,y=k[l],w=k[l+1],S=k[l+2];A[s]=y,A[s+1]=w,A[s+2]=y,A[s+3]=S,A[s+4]=w,A[s+5]=S}}}vrml(k,A){var z,l,s,y,w,S,C,h,x,R,M,P,D,L,X,B,j,H,$="";if($+=k+`Shape {
`+k+` appearance Appearance {
`+k+`  material Material {
`+k+"   diffuseColor "+((z=A?.color)===null||z===void 0?void 0:z.r)+" "+((l=A?.color)===null||l===void 0?void 0:l.g)+" "+((s=A?.color)===null||s===void 0?void 0:s.b)+`
`,A.wireframe&&this.colorArray){let W=this.colorArray;$+=k+"    emissiveColor "+W[0]+" "+W[1]+" "+W[2]+`
`}A!=null&&A.transparent&&($+=k+"   transparency "+(1-A.opacity)+`
`),$+=k+`  }
`,$+=k+` }
`;var q=k;if(k+=" ",A instanceof o.LineBasicMaterial||A.wireframe){$+=k+`geometry IndexedLineSet {
`+k+` colorPerVertex TRUE
`+k+` coord Coordinate {
`+k+`  point [
`;let W,Y,G;for(let V=0;V<this.vertices;++V){let Z=V*3;W=(y=this.vertexArray)===null||y===void 0?void 0:y[Z],Y=(w=this.vertexArray)===null||w===void 0?void 0:w[Z+1],G=(S=this.vertexArray)===null||S===void 0?void 0:S[Z+2],$+=k+"   "+W+" "+Y+" "+G+`,
`}if($+=k+`  ]
`,$+=k+` }
`,this.colorArray&&!A.wireframe){$+=k+` color Color {
`+k+`  color [
`;for(let V=0;V<this.vertices;++V){let Z=V*3;W=this.colorArray[Z],Y=this.colorArray[Z+1],G=this.colorArray[Z+2],$+=k+"   "+W+" "+Y+" "+G+`,
`}$+=k+`  ]
`,$+=k+` }
`}if($+=k+` coordIndex [
`,A.wireframe&&this.faceArray)for(let V=0;V<this.faceidx;V+=3)W=(C=this.faceArray)===null||C===void 0?void 0:C[V],Y=(h=this.faceArray)===null||h===void 0?void 0:h[V+1],G=(x=this.faceArray)===null||x===void 0?void 0:x[V+2],$+=k+"  "+W+", "+Y+", "+G+`, -1,
`;else for(let V=0;V<this.vertices-1;V+=2)$+=k+"  "+V+", "+(V+1)+`, -1,
`;$+=k+` ]
`,$+=k+`}
`}else{$+=k+`geometry IndexedFaceSet {
`+k+` colorPerVertex TRUE
`+k+` normalPerVertex TRUE
`+k+` solid FALSE
`,$+=k+` coord Coordinate {
`+k+`  point [
`;let W,Y,G;for(let V=0;V<this.vertices;++V){let Z=V*3;W=(R=this.vertexArray)===null||R===void 0?void 0:R[Z],Y=(M=this.vertexArray)===null||M===void 0?void 0:M[Z+1],G=(P=this.vertexArray)===null||P===void 0?void 0:P[Z+2],$+=k+"   "+W+" "+Y+" "+G+`,
`}$+=k+`  ]
`,$+=k+` }
`,$+=k+` normal Normal {
`+k+`  vector [
`;for(let V=0;V<this.vertices;++V){let Z=V*3;W=(D=this.normalArray)===null||D===void 0?void 0:D[Z],Y=(L=this.normalArray)===null||L===void 0?void 0:L[Z+1],G=(X=this.normalArray)===null||X===void 0?void 0:X[Z+2],$+=k+"   "+W+" "+Y+" "+G+`,
`}if($+=k+`  ]
`,$+=k+` }
`,this.colorArray){$+=k+` color Color {
`+k+`  color [
`;for(let V=0;V<this.vertices;++V){let Z=V*3;W=this.colorArray[Z],Y=this.colorArray[Z+1],G=this.colorArray[Z+2],$+=k+"   "+W+" "+Y+" "+G+`,
`}$+=k+`  ]
`,$+=k+` }
`}$+=k+` coordIndex [
`;for(let V=0;V<this.faceidx;V+=3)W=(B=this.faceArray)===null||B===void 0?void 0:B[V],Y=(j=this.faceArray)===null||j===void 0?void 0:j[V+1],G=(H=this.faceArray)===null||H===void 0?void 0:H[V+2],$+=k+"  "+W+", "+Y+", "+G+`, -1,
`;$+=k+` ]
`,$+=k+`}
`}return $+=q+"}",$}truncateArrayBuffers(k=!0,A=!1){var z=this.vertexArray,l=this.colorArray,s=this.normalArray,y=this.faceArray,w=this.lineArray,S=this.radiusArray;this.vertexArray=z?.subarray(0,this.vertices*3)||null,this.colorArray=l?.subarray(0,this.vertices*3)||null,k?(this.normalArray=s?.subarray(0,this.vertices*3)||null,this.faceArray=y?.subarray(0,this.faceidx)||null,this.lineidx>0?this.lineArray=w?.subarray(0,this.lineidx)||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),S&&(this.radiusArray=S.subarray(0,this.vertices)),A&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class _ extends c.EventDispatcher{constructor(k=!1,A=!1,z=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=p++,this.mesh=k,this.radii=A,this.offset=z}updateGeoGroup(k=0){var A,z=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!z||z.vertices+k>(((A=z?.vertexArray)===null||A===void 0?void 0:A.length)||0)/3)&&(z=this.addGeoGroup()),z}vrml(k,A){for(var z="",l=this.geometryGroups.length,s=0;s<l;s++){var y=this.geometryGroups[s];z+=y.vrml(k,A)+`,
`}return z}addGeoGroup(){var k=new g(this.geometryGroups.length);return this.geometryGroups.push(k),this.groups=this.geometryGroups.length,k.vertexArray=new Float32Array(f*3),k.colorArray=new Float32Array(f*3),this.mesh&&(k.normalArray=new Float32Array(f*3),k.faceArray=new Uint16Array(f*6),k.lineArray=new Uint16Array(f*6)),this.radii&&(k.radiusArray=new Float32Array(f)),k.useOffset=this.offset,k}setUpNormals(...k){for(var A=0;A<this.groups;A++){var z=this.geometryGroups[A];z.setNormals(...k)}}setColors(...k){for(var A=this.geometryGroups.length,z=0;z<A;z++){var l=this.geometryGroups[z];l.setColors(...k)}}setUpWireframe(...k){for(var A=0;A<this.groups;A++){var z=this.geometryGroups[A];z.setLineIndices(...k)}}initTypedArrays(){for(var k=0;k<this.groups;k++){var A=this.geometryGroups[k];A.__inittedArrays!==!0&&A.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var k=0,A=0;A<this.groups;A++)k+=this.geometryGroups[A].vertices;return k}}let p=0}),"./src/WebGL/core/Object3D.ts":((e,r,t)=>{t.r(r),t.d(r,{Light:()=>g,Object3D:()=>v,Object3DIDCount:()=>u,Scene:()=>f});var o=t("./src/WebGL/math/index.ts"),c=t("./src/colors.ts");let u=0;class v{constructor(){this.id=u++,this.name="",this.children=[],this.position=new o.Vector3,this.rotation=new o.Vector3,this.matrix=new o.Matrix4,this.matrixWorld=new o.Matrix4,this.quaternion=new o.Quaternion,this.eulerOrder="XYZ",this.up=new o.Vector3(0,1,0),this.scale=new o.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(p){this.matrix.lookAt(p,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof o.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(p){if(p===this){console.error("Can't add $3Dmol.Object3D to itself");return}p.parent=this,this.children.push(p);for(var E=this;E.parent!==void 0;)E=E.parent;E!==void 0&&E instanceof f&&E.__addObject(p)}remove(p){var E=this.children.indexOf(p);if(E!==-1){p.parent=void 0,this.children.splice(E,1);for(var k=this;k.parent!==void 0;)k=k.parent;k!==void 0&&k instanceof f&&k.__removeObject(p)}}vrml(p){p||(p=" ");var E=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),k=0,A=0,z=0;if(E!=0){let y=Math.sin(E/2);k=this.quaternion.x/y,A=this.quaternion.y/y,z=this.quaternion.z/y}var l=p+`Transform {
`+p+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+p+" rotation "+k+" "+A+" "+z+" "+E+`
`+p+` children [
`;this.geometry&&(l+=this.geometry.vrml(p,this.material));for(var s=0;s<this.children.length;s++)l+=this.children[s].vrml(p+" ")+`,
`;return l+=` ]
`,l+="}",l}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof o.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),(this.scale.x!==1||this.scale.y!==1||this.scale.z!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(p){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||p===!0)&&(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var E=0;E<this.children.length;E++)this.children[E].updateMatrixWorld(!0)}clone(p){p===void 0&&(p=new v),p.name=this.name,p.up.copy(this.up),p.position.copy(this.position),p.rotation instanceof o.Vector3&&this.rotation instanceof o.Vector3?p.rotation.copy(this.rotation):p.rotation=this.rotation,p.eulerOrder=this.eulerOrder,p.scale.copy(this.scale),p.rotationAutoUpdate=this.rotationAutoUpdate,p.matrix.copy(this.matrix),p.matrixWorld.copy(this.matrixWorld),p.quaternion.copy(this.quaternion),p.matrixAutoUpdate=this.matrixAutoUpdate,p.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,p.useQuaternion=this.useQuaternion,p.visible=this.visible;for(var E=0;E<this.children.length;E++){var k=this.children[E];p.add(k.clone())}return p}setVisible(p){this.visible=p;for(var E=0;E<this.children.length;E++){var k=this.children[E];k.setVisible(p)}}}class f extends v{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(p){if(p instanceof g)this.__lights.indexOf(p)===-1&&this.__lights.push(p),p.target&&p.target.parent===void 0&&this.add(p.target);else if(this.__objects.indexOf(p)===-1){this.__objects.push(p),this.__objectsAdded.push(p);var E=this.__objectsRemoved.indexOf(p);E!==-1&&this.__objectsRemoved.splice(E,1)}for(var k=0;k<p.children.length;k++)this.__addObject(p.children[k])}__removeObject(p){var E;if(p instanceof g)E=this.__lights.indexOf(p),E!==-1&&this.__lights.splice(E,1);else if(E=this.__objects.indexOf(p),E!==-1){this.__objects.splice(E,1),this.__objectsRemoved.push(p);var k=this.__objectsAdded.indexOf(p);k!==-1&&this.__objectsAdded.splice(E,1)}for(var A=0;A<p.children.length;A++)this.__removeObject(p.children[A])}}class g extends v{constructor(p,E=1){super(),this.position=new o.Vector3(0,1,0),this.target=new v,this.castShadow=!1,this.onlyShadow=!1,this.color=new c.Color(p),this.intensity=E}}}),"./src/WebGL/core/Projector.ts":((e,r,t)=>{t.r(r),t.d(r,{Projector:()=>u});var o=t("./src/WebGL/math/index.ts");const c=new o.Matrix4;class u{static unprojectVector(f,g){return g.projectionMatrixInverse.getInverse(g.projectionMatrix),c.multiplyMatrices(g.matrixWorld,g.projectionMatrixInverse),f.applyProjection(c)}static projectVector(f,g){return g.matrixWorldInverse.getInverse(g.matrixWorld),c.multiplyMatrices(g.projectionMatrix,g.matrixWorldInverse),f.applyProjection(c)}projectVector(f,g){return u.projectVector(f,g)}unprojectVector(f,g){return u.unprojectVector(f,g)}}}),"./src/WebGL/core/Raycaster.ts":((e,r,t)=>{t.r(r),t.d(r,{Raycaster:()=>f,intersectObject:()=>y});var o=t("./src/WebGL/math/index.ts"),c=t("./src/WebGL/shapes/index.ts");const u=(w,S)=>w.distance-S.distance,v=new o.Matrix4;class f{constructor(S,C,h,x){this.precision=1e-4,this.linePrecision=.2,this.ray=new o.Ray(S,C),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=x||0,this.far=h||1/0}set(S,C){this.ray.set(S,C)}setFromCamera(S,C){C.ortho?(this.ray.origin.set(S.x,S.y,(C.near+C.far)/(C.near-C.far)).unproject(C),this.ray.direction.set(0,0,-1).transformDirection(C.matrixWorld)):(this.ray.origin.setFromMatrixPosition(C.matrixWorld),this.ray.direction.set(S.x,S.y,S.z),C.projectionMatrixInverse.getInverse(C.projectionMatrix),v.multiplyMatrices(C.matrixWorld,C.projectionMatrixInverse),this.ray.direction.applyProjection(v),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(S,C){for(var h=[],x=0,R=C.length;x<R;x++)y(S,C[x],this,h);return h.sort(u),h}}const g=w=>Math.min(Math.max(w,-1),1);var _=new c.Sphere,p=new c.Cylinder,E=new c.Triangle,k=new o.Vector3,A=new o.Vector3,z=new o.Vector3,l=new o.Vector3,s=new o.Vector3;function y(w,S,C,h){if(s.getPositionFromMatrix(w.matrixWorld),S.intersectionShape===void 0)return h;var x=S.intersectionShape,R=C.linePrecision;R*=w.matrixWorld.getMaxScaleOnAxis();var M=R*R;if(S.boundingSphere!==void 0&&S.boundingSphere instanceof c.Sphere&&(_.copy(S.boundingSphere),_.applyMatrix4(w.matrixWorld),!C.ray.isIntersectionSphere(_)))return h;var P,D,L,X,B,j,H,$,q,W,Y,G,V,Z;for(P=0,D=x.triangle.length;P<D;P++)if(x.triangle[P]instanceof c.Triangle){if(E.copy(x.triangle[P]),E.applyMatrix4(w.matrixWorld),L=E.getNormal(),X=C.ray.direction.dot(L),X>=0||(k.subVectors(E.a,C.ray.origin),H=L.dot(k)/X,H<0))continue;A.copy(C.ray.direction).multiplyScalar(H).add(C.ray.origin),A.sub(E.a),z.copy(E.b).sub(E.a),l.copy(E.c).sub(E.a);var xe=z.dot(l),ce=z.lengthSq(),Ne=l.lengthSq();if(G=(ce*A.dot(l)-xe*A.dot(z))/(ce*Ne-xe*xe),G<0||G>1||(Y=(A.dot(z)-G*xe)/ce,Y<0||Y>1||Y+G>1))continue;h.push({clickable:S,distance:H})}for(P=0,D=x.cylinder.length;P<D;P++)if(x.cylinder[P]instanceof c.Cylinder){if(p.copy(x.cylinder[P]),p.applyMatrix4(w.matrixWorld),k.subVectors(p.c1,C.ray.origin),B=k.dot(p.direction),j=k.dot(C.ray.direction),X=g(C.ray.direction.dot(p.direction)),q=1-X*X,q===0)continue;V=(X*j-B)/q,Z=(j-X*B)/q,A.copy(p.direction).multiplyScalar(V).add(p.c1),z.copy(C.ray.direction).multiplyScalar(Z).add(C.ray.origin),$=l.subVectors(A,z).lengthSq();var Pe=p.radius*p.radius;if($<=Pe){if(W=(X*B-j)*(X*B-j)-q*(k.lengthSq()-B*B-Pe),W<=0?G=H=Math.sqrt($):G=H=(j-X*B-Math.sqrt(W))/q,Y=X*G-B,Y<0||Y*Y>p.lengthSq()||G<0)continue;h.push({clickable:S,distance:H})}}for(P=0,D=x.line.length;P<D;P+=2){A.copy(x.line[P]),A.applyMatrix4(w.matrixWorld),z.copy(x.line[P+1]),z.applyMatrix4(w.matrixWorld),l.subVectors(z,A);var De=l.lengthSq();l.normalize(),k.subVectors(A,C.ray.origin);var Me=k.dot(l);j=k.dot(C.ray.direction),X=g(C.ray.direction.dot(l)),q=1-X*X,q!==0&&(V=(X*j-Me)/q,Z=(j-X*Me)/q,A.add(l.multiplyScalar(V)),z.copy(C.ray.direction).multiplyScalar(Z).add(C.ray.origin),$=l.subVectors(z,A).lengthSq(),$<M&&V*V<De&&h.push({clickable:S,distance:Z}))}for(P=0,D=x.sphere.length;P<D;P++)if(x.sphere[P]instanceof c.Sphere&&(_.copy(x.sphere[P]),_.applyMatrix4(w.matrixWorld),C.ray.isIntersectionSphere(_))){A.subVectors(_.center,C.ray.origin);var Be=A.dot(C.ray.direction);if(W=Be*Be-(A.lengthSq()-_.radius*_.radius),Be<0)return h;W<=0?H=Be:H=Be-Math.sqrt(W),h.push({clickable:S,distance:H})}return h}}),"./src/WebGL/core/Texture.ts":((e,r,t)=>{t.r(r),t.d(r,{Texture:()=>f,TextureIdCount:()=>g});var o=t("./src/WebGL/constants/TextureConstants.ts"),c=t("./src/WebGL/math/index.ts"),u=t("./src/WebGL/core/EventDispatcher.ts"),v=t("./src/WebGL/core/UVMapping.ts");class f extends u.EventDispatcher{constructor(p,E){super(),this.id=g++,this.name="",this.image=p,this.mapping=new v.UVMapping,this.wrapS=o.ClampToEdgeWrapping,this.wrapT=o.ClampToEdgeWrapping,this.anisotropy=1,E?(this.format=o.RFormat,this.type=o.FloatType,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=o.NearestFilter,this.minFilter=o.NearestFilter):(this.format=o.RGBAFormat,this.type=o.UnsignedByteType,this.offset=new c.Vector2(0,0),this.repeat=new c.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=o.LinearFilter,this.minFilter=o.LinearMipMapLinearFilter),this.needsUpdate=!1,this.onUpdate=null}clone(p=new f){return p.image=this.image,p.mapping=this.mapping,p.wrapS=this.wrapS,p.wrapT=this.wrapT,p.magFilter=this.magFilter,p.minFilter=this.minFilter,p.anisotropy=this.anisotropy,p.format=this.format,p.type=this.type,p.offset.copy(this.offset),p.repeat.copy(this.repeat),p.premultiplyAlpha=this.premultiplyAlpha,p.flipY=this.flipY,p.unpackAlignment=this.unpackAlignment,p}dispose(){this.dispatchEvent({type:"dispose"})}}let g=0}),"./src/WebGL/core/UVMapping.ts":((e,r,t)=>{t.r(r),t.d(r,{UVMapping:()=>o});class o{}}),"./src/WebGL/core/index.ts":((e,r,t)=>{t.r(r),t.d(r,{EventDispatcher:()=>o.EventDispatcher,Geometry:()=>c.Geometry,GeometryGroup:()=>c.GeometryGroup,GeometryIDCount:()=>c.GeometryIDCount,Light:()=>u.Light,Object3D:()=>u.Object3D,Object3DIDCount:()=>u.Object3DIDCount,Projector:()=>v.Projector,Raycaster:()=>f.Raycaster,Scene:()=>u.Scene,Texture:()=>g.Texture,TextureIdCount:()=>g.TextureIdCount,UVMapping:()=>_.UVMapping,intersectObject:()=>f.intersectObject});var o=t("./src/WebGL/core/EventDispatcher.ts"),c=t("./src/WebGL/core/Geometry.ts"),u=t("./src/WebGL/core/Object3D.ts"),v=t("./src/WebGL/core/Projector.ts"),f=t("./src/WebGL/core/Raycaster.ts"),g=t("./src/WebGL/core/Texture.ts"),_=t("./src/WebGL/core/UVMapping.ts")}),"./src/WebGL/index.ts":((e,r,t)=>{t.r(r),t.d(r,{BackSide:()=>o.BackSide,Camera:()=>p.Camera,ClampToEdgeWrapping:()=>o.ClampToEdgeWrapping,Coloring:()=>o.Coloring,Cylinder:()=>_.Cylinder,DoubleSide:()=>o.DoubleSide,EventDispatcher:()=>c.EventDispatcher,FloatType:()=>o.FloatType,Fog:()=>E.Fog,FrontSide:()=>o.FrontSide,Geometry:()=>c.Geometry,GeometryGroup:()=>c.GeometryGroup,GeometryIDCount:()=>c.GeometryIDCount,ImposterMaterial:()=>u.ImposterMaterial,InstancedMaterial:()=>u.InstancedMaterial,Light:()=>c.Light,Line:()=>f.Line,LineBasicMaterial:()=>u.LineBasicMaterial,LineStyle:()=>f.LineStyle,LinearFilter:()=>o.LinearFilter,LinearMipMapLinearFilter:()=>o.LinearMipMapLinearFilter,Material:()=>u.Material,MaterialIdCount:()=>u.MaterialIdCount,Matrix3:()=>v.Matrix3,Matrix4:()=>v.Matrix4,Mesh:()=>f.Mesh,MeshDoubleLambertMaterial:()=>u.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>u.MeshLambertMaterial,MeshOutlineMaterial:()=>u.MeshOutlineMaterial,NearestFilter:()=>o.NearestFilter,Object3D:()=>c.Object3D,Object3DIDCount:()=>c.Object3DIDCount,Projector:()=>c.Projector,Quaternion:()=>v.Quaternion,R32Format:()=>o.R32Format,RFormat:()=>o.RFormat,RGBAFormat:()=>o.RGBAFormat,Ray:()=>v.Ray,Raycaster:()=>c.Raycaster,Renderer:()=>k.Renderer,Scene:()=>c.Scene,ShaderLib:()=>g.ShaderLib,ShaderUtils:()=>g.ShaderUtils,Shading:()=>o.Shading,Sphere:()=>_.Sphere,SphereImposterMaterial:()=>u.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>u.SphereImposterOutlineMaterial,Sprite:()=>f.Sprite,SpriteAlignment:()=>o.SpriteAlignment,SpriteMaterial:()=>u.SpriteMaterial,SpritePlugin:()=>A.SpritePlugin,StickImposterMaterial:()=>u.StickImposterMaterial,StickImposterOutlineMaterial:()=>u.StickImposterOutlineMaterial,Texture:()=>c.Texture,TextureIdCount:()=>c.TextureIdCount,TextureOperations:()=>o.TextureOperations,Triangle:()=>_.Triangle,UVMapping:()=>c.UVMapping,UnsignedByteType:()=>o.UnsignedByteType,Vector2:()=>v.Vector2,Vector3:()=>v.Vector3,VolumetricMaterial:()=>u.VolumetricMaterial,basic:()=>g.basic,clamp:()=>v.clamp,clone:()=>g.clone,conversionMatrix3:()=>v.conversionMatrix3,degToRad:()=>v.degToRad,instanced:()=>g.instanced,intersectObject:()=>c.intersectObject,lambert:()=>g.lambert,lambertdouble:()=>g.lambertdouble,outline:()=>g.outline,screen:()=>g.screen,screenaa:()=>g.screenaa,sphereimposter:()=>g.sphereimposter,sphereimposteroutline:()=>g.sphereimposteroutline,sprite:()=>g.sprite,stickimposter:()=>g.stickimposter,stickimposteroutline:()=>g.stickimposteroutline,volumetric:()=>g.volumetric});var o=t("./src/WebGL/constants/index.ts"),c=t("./src/WebGL/core/index.ts"),u=t("./src/WebGL/materials/index.ts"),v=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/objects/index.ts"),g=t("./src/WebGL/shaders/index.ts"),_=t("./src/WebGL/shapes/index.ts"),p=t("./src/WebGL/Camera.ts"),E=t("./src/WebGL/Fog.ts"),k=t("./src/WebGL/Renderer.ts"),A=t("./src/WebGL/SpritePlugin.ts")}),"./src/WebGL/materials/ImposterMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{ImposterMaterial:()=>g});var o=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Shading.ts"),u=t("./src/colors.ts"),v=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/materials/Material.ts");class g extends f.Material{constructor(p){super(),this.color=new u.Color(16777215),this.ambient=new u.Color(1048575),this.emissive=new u.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new v.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=c.Shading.SmoothShading,this.shaderID=null,this.vertexColors=o.Coloring.NoColors,this.skinning=!1,this.setValues(p)}clone(p=new g){return super.clone.call(this,p),p.color.copy(this.color),p.ambient.copy(this.ambient),p.emissive.copy(this.emissive),p.wrapAround=this.wrapAround,p.wrapRGB.copy(this.wrapRGB),p.map=this.map,p.lightMap=this.lightMap,p.specularMap=this.specularMap,p.envMap=this.envMap,p.combine=this.combine,p.reflectivity=this.reflectivity,p.refractionRatio=this.refractionRatio,p.fog=this.fog,p.shading=this.shading,p.shaderID=this.shaderID,p.vertexColors=this.vertexColors,p.skinning=this.skinning,p.morphTargets=this.morphTargets,p.morphNormals=this.morphNormals,p}}}),"./src/WebGL/materials/InstancedMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{InstancedMaterial:()=>g});var o=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Shading.ts"),u=t("./src/colors.ts"),v=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/materials/Material.ts");class g extends f.Material{constructor(p){super(),this.color=new u.Color(16777215),this.ambient=new u.Color(1048575),this.emissive=new u.Color(0),this.wrapAround=!1,this.wrapRGB=new v.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=c.Shading.SmoothShading,this.shaderID="instanced",this.vertexColors=o.Coloring.NoColors,this.skinning=!1,this.sphere=null,this.setValues(p)}clone(p=new g){return super.clone.call(this,p),p.color.copy(this.color),p.ambient.copy(this.ambient),p.emissive.copy(this.emissive),p.wrapAround=this.wrapAround,p.wrapRGB.copy(this.wrapRGB),p.map=this.map,p.lightMap=this.lightMap,p.specularMap=this.specularMap,p.envMap=this.envMap,p.combine=this.combine,p.reflectivity=this.reflectivity,p.refractionRatio=this.refractionRatio,p.fog=this.fog,p.shading=this.shading,p.shaderID=this.shaderID,p.vertexColors=this.vertexColors,p.skinning=this.skinning,p.morphTargets=this.morphTargets,p.morphNormals=this.morphNormals,p.sphere=this.sphere,p}}}),"./src/WebGL/materials/LineBasicMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{LineBasicMaterial:()=>u});var o=t("./src/colors.ts"),c=t("./src/WebGL/materials/Material.ts");class u extends c.Material{constructor(f){super(),this.color=new o.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(f)}clone(f=new u){return super.clone.call(this,f),f.color.copy(this.color),f}}}),"./src/WebGL/materials/Material.ts":((e,r,t)=>{t.r(r),t.d(r,{Material:()=>f,MaterialIdCount:()=>g});var o=t("./src/WebGL/constants/Sides.ts"),c=t("./src/WebGL/core/index.ts"),u=t("./src/WebGL/math/index.ts"),v=t("./src/colors.ts");class f extends c.EventDispatcher{constructor(){super(...arguments),this.id=g++,this.name="",this.side=o.FrontSide,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(p={}){if(p!==void 0)for(var E in p){var k=p[E];if(k===void 0){console.warn("$3Dmol.Material: '"+E+"' parameter is undefined.");continue}if(E in this){var A=this[E];A instanceof v.Color&&k instanceof v.Color?A.copy(k):A instanceof v.Color?A.set(k):A instanceof u.Vector3&&k instanceof u.Vector3?A.copy(k):this[E]=k}}}clone(p=new f){return p.name=this.name,p.side=this.side,p.opacity=this.opacity,p.transparent=this.transparent,p.depthTest=this.depthTest,p.depthWrite=this.depthWrite,p.polygonOffset=this.polygonOffset,p.polygonOffsetFactor=this.polygonOffsetFactor,p.polygonOffsetUnits=this.polygonOffsetUnits,p.alphaTest=this.alphaTest,p.overdraw=this.overdraw,p.visible=this.visible,p}makeShaded(p){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:p},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let g=0}),"./src/WebGL/materials/MeshDoubleLambertMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{MeshDoubleLambertMaterial:()=>u});var o=t("./src/WebGL/constants/Sides.ts"),c=t("./src/WebGL/materials/MeshLambertMaterial.ts");class u extends c.MeshLambertMaterial{constructor(f){super(f),this.shaderID="lambertdouble",this.side=o.DoubleSide,this.outline=!1}clone(f=new u){return super.clone.call(this,f),f}}}),"./src/WebGL/materials/MeshLambertMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{MeshLambertMaterial:()=>g});var o=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Shading.ts"),u=t("./src/WebGL/materials/Material.ts"),v=t("./src/colors.ts"),f=t("./src/WebGL/math/index.ts");class g extends u.Material{constructor(p){super(),this.color=new v.Color(16777215),this.ambient=new v.Color(1048575),this.emissive=new v.Color(0),this.wrapAround=!1,this.wrapRGB=new f.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=c.Shading.SmoothShading,this.shaderID="lambert",this.vertexColors=o.Coloring.NoColors,this.skinning=!1,this.setValues(p)}clone(p=new g){return super.clone.call(this,p),p.color.copy(this.color),p.ambient.copy(this.ambient),p.emissive.copy(this.emissive),p.wrapAround=this.wrapAround,p.wrapRGB.copy(this.wrapRGB),p.map=this.map,p.lightMap=this.lightMap,p.specularMap=this.specularMap,p.envMap=this.envMap,p.combine=this.combine,p.reflectivity=this.reflectivity,p.refractionRatio=this.refractionRatio,p.fog=this.fog,p.shading=this.shading,p.shaderID=this.shaderID,p.vertexColors=this.vertexColors,p.skinning=this.skinning,p.morphTargets=this.morphTargets,p.morphNormals=this.morphNormals,p}}}),"./src/WebGL/materials/MeshOutlineMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{MeshOutlineMaterial:()=>u});var o=t("./src/colors.ts"),c=t("./src/WebGL/materials/Material.ts");class u extends c.Material{constructor(f){super(),f=f||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=f.color||new o.Color(0,0,0),this.outlineWidth=f.width||.1,this.outlinePushback=f.pushback||1}clone(f=new u){return super.clone.call(this,f),f.fog=this.fog,f.shaderID=this.shaderID,f.wireframe=this.wireframe,f}}}),"./src/WebGL/materials/SphereImposterMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{SphereImposterMaterial:()=>c});var o=t("./src/WebGL/materials/ImposterMaterial.ts");class c extends o.ImposterMaterial{constructor(v){super(v),this.shaderID="sphereimposter",this.setValues(v)}clone(v=new c){return super.clone.call(this,v),v}}}),"./src/WebGL/materials/SphereImposterOutlineMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{SphereImposterOutlineMaterial:()=>u});var o=t("./src/colors.ts"),c=t("./src/WebGL/materials/ImposterMaterial.ts");class u extends c.ImposterMaterial{constructor(f){super(f),f=f||{},this.shaderID="sphereimposteroutline",this.outlineColor=f.color||new o.Color(0,0,0),this.outlineWidth=f.width||.1,this.outlinePushback=f.pushback||1,this.setValues(f)}clone(f=new u){return super.clone.call(this,f),f.outlineColor=this.outlineColor,f.outlineWidth=this.outlineWidth,f.outlinePushback=this.outlinePushback,f}}}),"./src/WebGL/materials/SpriteMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{SpriteMaterial:()=>g});var o=t("./src/WebGL/constants/SpriteAlignment.ts"),c=t("./src/WebGL/core/Texture.ts"),u=t("./src/colors.ts"),v=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/materials/Material.ts");class g extends f.Material{constructor(p){super(),this.color=new u.Color(16777215),this.map=new c.Texture,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new v.Vector2(0,0),this.uvScale=new v.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=o.SpriteAlignment.center.clone(),this.setValues(p),p=p||{},p.depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),p.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),p.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(p=new g){return super.clone.call(this,p),p.color.copy(this.color),p.map=this.map,p.useScreenCoordinates=this.useScreenCoordinates,p.screenOffset=this.screenOffset,p.sizeAttenuation=this.sizeAttenuation,p.scaleByViewport=this.scaleByViewPort,p.alignment.copy(this.alignment),p.uvOffset.copy(this.uvOffset),p}}}),"./src/WebGL/materials/StickImposterMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{StickImposterMaterial:()=>c});var o=t("./src/WebGL/materials/ImposterMaterial.ts");class c extends o.ImposterMaterial{constructor(v){super(v),this.shaderID="stickimposter",this.setValues(v)}clone(v=new c){return super.clone.call(this,v),v}}}),"./src/WebGL/materials/StickImposterOutlineMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{StickImposterOutlineMaterial:()=>u});var o=t("./src/colors.ts"),c=t("./src/WebGL/materials/ImposterMaterial.ts");class u extends c.ImposterMaterial{constructor(f={}){super(f),this.shaderID="stickimposteroutline",this.outlineColor=new o.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,f.color&&(this.outlineColor=f.color),f.width&&(this.outlineWidth=f.width),f.pushback&&(this.outlinePushback=f.pushback),this.setValues(f)}clone(f=new u){return super.clone.call(this,f),f.outlineColor=this.outlineColor,f.outlineWidth=this.outlineWidth,f.outlinePushback=this.outlinePushback,f}}}),"./src/WebGL/materials/VolumetricMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{VolumetricMaterial:()=>v});var o=t("./src/WebGL/constants/Sides.ts"),c=t("./src/colors.ts"),u=t("./src/WebGL/materials/Material.ts");class v extends u.Material{constructor(g){super(),this.transparent=!1,this.volumetric=!0,this.color=new c.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=o.FrontSide,this.setValues(g)}clone(g=new v){return super.clone.call(this,g),g.transparent=this.transparent,g.volumetric=this.volumetric,g.color=this.color,g.transferfn=this.transferfn,g.map=this.map,g.extent=this.extent,g.maxdepth=this.maxdepth,g.unit=this.unit,g.texmatrix=this.texmatrix,g.transfermin=this.transfermin,g.transfermax=this.transfermax,g.subsamples=this.subsamples,g.shaderID=this.shaderID,g.side=this.side,g}}}),"./src/WebGL/materials/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ImposterMaterial:()=>o.ImposterMaterial,InstancedMaterial:()=>c.InstancedMaterial,LineBasicMaterial:()=>u.LineBasicMaterial,Material:()=>v.Material,MaterialIdCount:()=>v.MaterialIdCount,MeshDoubleLambertMaterial:()=>f.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>g.MeshLambertMaterial,MeshOutlineMaterial:()=>_.MeshOutlineMaterial,SphereImposterMaterial:()=>p.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>E.SphereImposterOutlineMaterial,SpriteMaterial:()=>k.SpriteMaterial,StickImposterMaterial:()=>A.StickImposterMaterial,StickImposterOutlineMaterial:()=>z.StickImposterOutlineMaterial,VolumetricMaterial:()=>l.VolumetricMaterial});var o=t("./src/WebGL/materials/ImposterMaterial.ts"),c=t("./src/WebGL/materials/InstancedMaterial.ts"),u=t("./src/WebGL/materials/LineBasicMaterial.ts"),v=t("./src/WebGL/materials/Material.ts"),f=t("./src/WebGL/materials/MeshDoubleLambertMaterial.ts"),g=t("./src/WebGL/materials/MeshLambertMaterial.ts"),_=t("./src/WebGL/materials/MeshOutlineMaterial.ts"),p=t("./src/WebGL/materials/SphereImposterMaterial.ts"),E=t("./src/WebGL/materials/SphereImposterOutlineMaterial.ts"),k=t("./src/WebGL/materials/SpriteMaterial.ts"),A=t("./src/WebGL/materials/StickImposterMaterial.ts"),z=t("./src/WebGL/materials/StickImposterOutlineMaterial.ts"),l=t("./src/WebGL/materials/VolumetricMaterial.ts")}),"./src/WebGL/math/Quaternion.ts":((e,r,t)=>{t.r(r),t.d(r,{Quaternion:()=>o});class o{constructor(u,v,f,g){this.x=u||0,this.y=v||0,this.z=f||0,this.w=g!==void 0?g:1}set(u,v,f,g){return this.x=u,this.y=v,this.z=f,this.w=g,this}copy(u){return this.x=u.x,this.y=u.y,this.z=u.z,this.w=u.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let u=this.length();return u===0?(this.x=0,this.y=0,this.z=0,this.w=1):(u=1/u,this.x*=u,this.y*=u,this.z*=u,this.w*=u),this}multiply(u){return this.multiplyQuaternions(this,u)}multiplyScalar(u){return this.x*=u,this.y*=u,this.z*=u,this.w*=u,this}multiplyQuaternions(u,v){const f=u.x,g=u.y,_=u.z,p=u.w,E=v.x,k=v.y,A=v.z,z=v.w;return this.x=f*z+p*E+g*A-_*k,this.y=g*z+p*k+_*E-f*A,this.z=_*z+p*A+f*k-g*E,this.w=p*z-f*E-g*k-_*A,this}sub(u){return this.x-=u.x,this.y-=u.y,this.z-=u.z,this.w-=u.w,this}clone(){return new o(this.x,this.y,this.z,this.w)}setFromEuler(u){const v=Math.cos(u.x/2),f=Math.cos(u.y/2),g=Math.cos(u.z/2),_=Math.sin(u.x/2),p=Math.sin(u.y/2),E=Math.sin(u.z/2);return this.x=_*f*g+v*p*E,this.y=v*p*g-_*f*E,this.z=v*f*E+_*p*g,this.w=v*f*g-_*p*E,this}}}),"./src/WebGL/math/Vector2.ts":((e,r,t)=>{t.r(r),t.d(r,{Vector2:()=>o});class o{constructor(u,v){this.x=u||0,this.y=v||0}set(u,v){return this.x=u,this.y=v,this}subVectors(u,v){return this.x=u.x-v.x,this.y=u.y-v.y,this}copy(u){return this.x=u.x,this.y=u.y,this}clone(){return new o(this.x,this.y)}}}),"./src/WebGL/math/index.ts":((e,r,t)=>{t.r(r),t.d(r,{Matrix3:()=>g.Matrix3,Matrix4:()=>g.Matrix4,Quaternion:()=>o.Quaternion,Ray:()=>g.Ray,Vector2:()=>c.Vector2,Vector3:()=>g.Vector3,clamp:()=>u.clamp,conversionMatrix3:()=>v.conversionMatrix3,degToRad:()=>f.degToRad});var o=t("./src/WebGL/math/Quaternion.ts"),c=t("./src/WebGL/math/Vector2.ts"),u=t("./src/WebGL/math/utils/clamp.ts"),v=t("./src/WebGL/math/utils/conversionMatrix3.ts"),f=t("./src/WebGL/math/utils/degToRad.ts"),g=t("./src/WebGL/math/math.ts")}),"./src/WebGL/math/math.ts":((e,r,t)=>{t.r(r),t.d(r,{Matrix3:()=>k,Matrix4:()=>p,Ray:()=>A,Vector3:()=>E});var o=t("./src/WebGL/math/utils/degToRad.ts"),c=t("./src/WebGL/math/utils/clamp.ts"),u,v,f,g,_;class p{constructor(l=1,s=0,y=0,w=0,S=0,C=1,h=0,x=0,R=0,M=0,P=1,D=0,L=0,X=0,B=0,j=1){typeof l<"u"&&typeof l!="number"?this.elements=new Float32Array(l):(this.elements=new Float32Array(16),this.elements[0]=l,this.elements[4]=s,this.elements[8]=y,this.elements[12]=w,this.elements[1]=S,this.elements[5]=C,this.elements[9]=h,this.elements[13]=x,this.elements[2]=R,this.elements[6]=M,this.elements[10]=P,this.elements[14]=D,this.elements[3]=L,this.elements[7]=X,this.elements[11]=B,this.elements[15]=j)}makeScale(l,s,y){throw new Error("Method not implemented.")}set(l,s,y,w,S,C,h,x,R,M,P,D,L,X,B,j){const H=this.elements;return H[0]=l,H[4]=s,H[8]=y,H[12]=w,H[1]=S,H[5]=C,H[9]=h,H[13]=x,H[2]=R,H[6]=M,H[10]=P,H[14]=D,H[3]=L,H[7]=X,H[11]=B,H[15]=j,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(l){const s=l.elements;return this.set(s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14],s[3],s[7],s[11],s[15]),this}matrix3FromTopLeft(){const l=this.elements;return new k(l[0],l[4],l[8],l[1],l[5],l[9],l[2],l[6],l[10])}setRotationFromEuler(l,s){const y=this.elements,{x:w,y:S,z:C}=l,h=Math.cos(w),x=Math.sin(w),R=Math.cos(S),M=Math.sin(S),P=Math.cos(C),D=Math.sin(C);if(s===void 0||s==="XYZ"){const L=h*P,X=h*D,B=x*P,j=x*D;y[0]=R*P,y[4]=-R*D,y[8]=M,y[1]=X+B*M,y[5]=L-j*M,y[9]=-x*R,y[2]=j-L*M,y[6]=B+X*M,y[10]=h*R}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${s}`);return this}setRotationFromQuaternion(l){const s=this.elements,{x:y,y:w,z:S,w:C}=l,h=y+y,x=w+w,R=S+S,M=y*h,P=y*x,D=y*R,L=w*x,X=w*R,B=S*R,j=C*h,H=C*x,$=C*R;return s[0]=1-(L+B),s[4]=P-$,s[8]=D+H,s[1]=P+$,s[5]=1-(M+B),s[9]=X-j,s[2]=D-H,s[6]=X+j,s[10]=1-(M+L),this}multiplyMatrices(l,s){const y=l.elements,w=s.elements,S=this.elements,C=y[0],h=y[4],x=y[8],R=y[12],M=y[1],P=y[5],D=y[9],L=y[13],X=y[2],B=y[6],j=y[10],H=y[14],$=y[3],q=y[7],W=y[11],Y=y[15],G=w[0],V=w[4],Z=w[8],xe=w[12],ce=w[1],Ne=w[5],Pe=w[9],De=w[13],Me=w[2],Be=w[6],ft=w[10],jt=w[14],Gt=w[3],mt=w[7],Fe=w[11],ht=w[15];return S[0]=C*G+h*ce+x*Me+R*Gt,S[4]=C*V+h*Ne+x*Be+R*mt,S[8]=C*Z+h*Pe+x*ft+R*Fe,S[12]=C*xe+h*De+x*jt+R*ht,S[1]=M*G+P*ce+D*Me+L*Gt,S[5]=M*V+P*Ne+D*Be+L*mt,S[9]=M*Z+P*Pe+D*ft+L*Fe,S[13]=M*xe+P*De+D*jt+L*ht,S[2]=X*G+B*ce+j*Me+H*Gt,S[6]=X*V+B*Ne+j*Be+H*mt,S[10]=X*Z+B*Pe+j*ft+H*Fe,S[14]=X*xe+B*De+j*jt+H*ht,S[3]=$*G+q*ce+W*Me+Y*Gt,S[7]=$*V+q*Ne+W*Be+Y*mt,S[11]=$*Z+q*Pe+W*ft+Y*Fe,S[15]=$*xe+q*De+W*jt+Y*ht,this}multiplyScalar(l){const s=this.elements;return s[0]*=l,s[4]*=l,s[8]*=l,s[12]*=l,s[1]*=l,s[5]*=l,s[9]*=l,s[13]*=l,s[2]*=l,s[6]*=l,s[10]*=l,s[14]*=l,s[3]*=l,s[7]*=l,s[11]*=l,s[15]*=l,this}makeTranslation(l,s,y){return this.set(1,0,0,l,0,1,0,s,0,0,1,y,0,0,0,1),this}snap(l){const s=Math.pow(10,4),y=this.elements;for(let w=0;w<16;w++){const S=Math.round(y[w]);S===Math.round(y[w]*s)/s&&(y[w]=S)}return this}transpose(){const l=this.elements;let s;return s=l[1],l[1]=l[4],l[4]=s,s=l[2],l[2]=l[8],l[8]=s,s=l[6],l[6]=l[9],l[9]=s,s=l[3],l[3]=l[12],l[12]=s,s=l[7],l[7]=l[13],l[13]=s,s=l[11],l[11]=l[14],l[14]=s,this}setPosition(l){const s=this.elements;return s[12]=l.x,s[13]=l.y,s[14]=l.z,this}translate(l){const s=this.elements;return s[12]+=l.x,s[13]+=l.y,s[14]+=l.z,this}getInverse(l,s){const y=this.elements,w=l.elements,S=w[0],C=w[4],h=w[8],x=w[12],R=w[1],M=w[5],P=w[9],D=w[13],L=w[2],X=w[6],B=w[10],j=w[14],H=w[3],$=w[7],q=w[11],W=w[15];y[0]=P*j*$-D*B*$+D*X*q-M*j*q-P*X*W+M*B*W,y[4]=x*B*$-h*j*$-x*X*q+C*j*q+h*X*W-C*B*W,y[8]=h*D*$-x*P*$+x*M*q-C*D*q-h*M*W+C*P*W,y[12]=x*P*X-h*D*X-x*M*B+C*D*B+h*M*j-C*P*j,y[1]=D*B*H-P*j*H-D*L*q+R*j*q+P*L*W-R*B*W,y[5]=h*j*H-x*B*H+x*L*q-S*j*q-h*L*W+S*B*W,y[9]=x*P*H-h*D*H-x*R*q+S*D*q+h*R*W-S*P*W,y[13]=h*D*L-x*P*L+x*R*B-S*D*B-h*R*j+S*P*j,y[2]=M*j*H-D*X*H+D*L*$-R*j*$-M*L*W+R*X*W,y[6]=x*X*H-C*j*H-x*L*$+S*j*$+C*L*W-S*X*W,y[10]=C*D*H-x*M*H+x*R*$-S*D*$-C*R*W+S*M*W,y[14]=x*M*L-C*D*L-x*R*X+S*D*X+C*R*j-S*M*j,y[3]=P*X*H-M*B*H-P*L*$+R*B*$+M*L*q-R*X*q,y[7]=C*B*H-h*X*H+h*L*$-S*B*$-C*L*q+S*X*q,y[11]=h*M*H-C*P*H-h*R*$+S*P*$+C*R*q-S*M*q,y[15]=C*P*L-h*M*L+h*R*X-S*P*X-C*R*B+S*M*B;const Y=S*y[0]+R*y[4]+L*y[8]+H*y[12];if(Y===0){const G="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(s)throw new Error(G);return console.warn(G),this.identity(),this}return this.multiplyScalar(1/Y),this}isReflected(){const l=this.elements,s=l[0],y=l[4],w=l[8],S=l[1],C=l[5],h=l[9],x=l[2],R=l[6],M=l[10];return s*C*M+S*R*w+x*y*h-x*C*w-S*y*M-s*R*h<0}scale(l){const s=this.elements,{x:y}=l,{y:w}=l,{z:S}=l;return s[0]*=y,s[4]*=w,s[8]*=S,s[1]*=y,s[5]*=w,s[9]*=S,s[2]*=y,s[6]*=w,s[10]*=S,s[3]*=y,s[7]*=w,s[11]*=S,this}getMaxScaleOnAxis(){const l=this.elements,s=l[0]*l[0]+l[1]*l[1]+l[2]*l[2],y=l[4]*l[4]+l[5]*l[5]+l[6]*l[6],w=l[8]*l[8]+l[9]*l[9]+l[10]*l[10];return Math.sqrt(Math.max(s,Math.max(y,w)))}makeFrustum(l,s,y,w,S,C){const h=this.elements,x=2*S/(s-l),R=2*S/(w-y),M=(s+l)/(s-l),P=(w+y)/(w-y),D=-(C+S)/(C-S),L=-2*C*S/(C-S);return h[0]=x,h[4]=0,h[8]=M,h[12]=0,h[1]=0,h[5]=R,h[9]=P,h[13]=0,h[2]=0,h[6]=0,h[10]=D,h[14]=L,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makePerspective(l,s,y,w){const S=y*Math.tan((0,o.degToRad)(l*.5)),C=-S,h=C*s,x=S*s;return this.makeFrustum(h,x,C,S,y,w)}makeOrthographic(l,s,y,w,S,C){const h=this.elements,x=1/(s-l),R=1/(y-w),M=1/(C-S),P=(s+l)*x,D=(y+w)*R,L=(C+S)*M;return h[0]=2*x,h[4]=0,h[8]=0,h[12]=-P,h[1]=0,h[5]=2*R,h[9]=0,h[13]=-D,h[2]=0,h[6]=0,h[10]=-2*M,h[14]=-L,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}isEqual(l){const s=l.elements,y=this.elements;return y[0]===s[0]&&y[4]===s[4]&&y[8]===s[8]&&y[12]===s[12]&&y[1]===s[1]&&y[5]===s[5]&&y[9]===s[9]&&y[13]===s[13]&&y[2]===s[2]&&y[6]===s[6]&&y[10]===s[10]&&y[14]===s[14]&&y[3]===s[3]&&y[7]===s[7]&&y[11]===s[11]&&y[15]===s[15]}clone(){const l=this.elements;return new p(l[0],l[4],l[8],l[12],l[1],l[5],l[9],l[13],l[2],l[6],l[10],l[14],l[3],l[7],l[11],l[15])}isIdentity(){const l=this.elements;return l[0]===1&&l[4]===0&&l[8]===0&&l[12]===0&&l[1]===0&&l[5]===1&&l[9]===0&&l[13]===0&&l[2]===0&&l[6]===0&&l[10]===1&&l[14]===0&&l[3]===0&&l[7]===0&&l[11]===0&&l[15]===1}isNearlyIdentity(l){return this.clone().snap(l).isIdentity()}getScale(l){const s=this.elements;return l=l||new E,f.set(s[0],s[1],s[2]),g.set(s[4],s[5],s[6]),_.set(s[8],s[9],s[10]),l.x=f.length(),l.y=g.length(),l.z=_.length(),l}lookAt(l,s,y){const w=this.elements;return _.subVectors(l,s).normalize(),_.length()===0&&(_.z=1),f.crossVectors(y,_).normalize(),f.length()===0&&(_.x+=1e-4,f.crossVectors(y,_).normalize()),g.crossVectors(_,f),w[0]=f.x,w[4]=g.x,w[8]=_.x,w[1]=f.y,w[5]=g.y,w[9]=_.y,w[2]=f.z,w[6]=g.z,w[10]=_.z,this}compose(l,s,y){const w=this.elements;return u.identity(),u.setRotationFromQuaternion(s),v.makeScale(y.x,y.y,y.z),this.multiplyMatrices(u,v),w[12]=l.x,w[13]=l.y,w[14]=l.z,this}}u=new p,v=new p;class E{constructor(l,s,y){this.x=l||0,this.y=s||0,this.z=y||0,this.atomid=void 0}set(l,s,y){return this.x=l,this.y=s,this.z=y,this}copy(l){return this.x=l.x,this.y=l.y,this.z=l.z,this}add(l){return this.x+=l.x,this.y+=l.y,this.z+=l.z,this}addVectors(l,s){return this.x=l.x+s.x,this.y=l.y+s.y,this.z=l.z+s.z,this}multiplyVectors(l,s){return this.x=l.x*s.x,this.y=l.y*s.y,this.z=l.z*s.z,this}sub(l){return this.x-=l.x,this.y-=l.y,this.z-=l.z,this}subVectors(l,s){return this.x=l.x-s.x,this.y=l.y-s.y,this.z=l.z-s.z,this}multiplyScalar(l){return this.x*=l,this.y*=l,this.z*=l,this}divideScalar(l){return l!==0?(this.x/=l,this.y/=l,this.z/=l):(this.x=0,this.y=0,this.z=0),this}max(l){return this.x=Math.max(this.x,l.x),this.y=Math.max(this.y,l.y),this.z=Math.max(this.z,l.z),this}min(l){return this.x=Math.min(this.x,l.x),this.y=Math.min(this.y,l.y),this.z=Math.min(this.z,l.z),this}distanceTo(l){return Math.sqrt(this.distanceToSquared(l))}distanceToSquared(l){const s=this.x-l.x,y=this.y-l.y,w=this.z-l.z;return s*s+y*y+w*w}applyMatrix3(l){const{x:s}=this,{y}=this,{z:w}=this,S=l.elements;return this.x=S[0]*s+S[3]*y+S[6]*w,this.y=S[1]*s+S[4]*y+S[7]*w,this.z=S[2]*s+S[5]*y+S[8]*w,this}applyMatrix4(l){const{x:s}=this,{y}=this,{z:w}=this,S=l.elements;return this.x=S[0]*s+S[4]*y+S[8]*w+S[12],this.y=S[1]*s+S[5]*y+S[9]*w+S[13],this.z=S[2]*s+S[6]*y+S[10]*w+S[14],this}applyProjection(l){const{x:s}=this,{y}=this,{z:w}=this,S=l.elements,C=S[3]*s+S[7]*y+S[11]*w+S[15];return this.x=(S[0]*s+S[4]*y+S[8]*w+S[12])/C,this.y=(S[1]*s+S[5]*y+S[9]*w+S[13])/C,this.z=(S[2]*s+S[6]*y+S[10]*w+S[14])/C,this}applyQuaternion(l){const{x:s}=this,{y}=this,{z:w}=this,S=l.x,C=l.y,h=l.z,x=l.w,R={};R.x=2*(y*h-w*C),R.y=2*(w*S-s*h),R.z=2*(s*C-y*S);const M={};return M.x=R.y*h-R.z*C,M.y=R.z*S-R.x*h,M.z=R.x*C-R.y*S,this.x=s+x*R.x+M.x,this.y=y+x*R.y+M.y,this.z=w+x*R.z+M.z,this}negate(){return this.multiplyScalar(-1)}dot(l){return this.x*l.x+this.y*l.y+this.z*l.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross(l){const{x:s}=this,{y}=this,{z:w}=this;return this.x=y*l.z-w*l.y,this.y=w*l.x-s*l.z,this.z=s*l.y-y*l.x,this}crossVectors(l,s){return this.x=l.y*s.z-l.z*s.y,this.y=l.z*s.x-l.x*s.z,this.z=l.x*s.y-l.y*s.x,this}equals(l){return this.x==l.x&&this.y==l.y&&this.z==l.z}getPositionFromMatrix(l){return this.x=l.elements[12],this.y=l.elements[13],this.z=l.elements[14],this}setEulerFromRotationMatrix(l,s){const y=l.elements,w=y[0],S=y[4],C=y[8],h=y[5],x=y[9],R=y[6],M=y[10];return s===void 0||s==="XYZ"?(this.y=Math.asin((0,c.clamp)(C,-1,1)),Math.abs(C)<.99999?(this.x=Math.atan2(-x,M),this.z=Math.atan2(-S,w)):(this.x=Math.atan2(R,h),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${s}`),this}rotateAboutVector(l,s){l.normalize();const y=Math.cos(s),w=Math.sin(s),S=this.clone().multiplyScalar(y),C=l.clone().cross(this).multiplyScalar(w),h=l.clone().multiplyScalar(l.clone().dot(this)).multiplyScalar(1-y),x=S.add(C).add(h);return this.x=x.x,this.y=x.y,this.z=x.z,this}setFromMatrixPosition(l){const s=l.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}transformDirection(l){const{x:s}=this,{y}=this,{z:w}=this,S=l.elements;return this.x=S[0]*s+S[4]*y+S[8]*w,this.y=S[1]*s+S[5]*y+S[9]*w,this.z=S[2]*s+S[6]*y+S[10]*w,this.normalize()}clone(){return new E(this.x,this.y,this.z)}unproject(l){const s=u;return s.multiplyMatrices(l.matrixWorld,s.getInverse(l.projectionMatrix)),this.applyMatrix4(s)}}f=new E,g=new E,_=new E;class k{constructor(l=1,s=0,y=0,w=0,S=1,C=0,h=0,x=0,R=1){this.elements=new Float32Array(9),this.set(l,s,y,w,S,C,h,x,R)}set(l,s,y,w,S,C,h,x,R){const M=this.elements;return M[0]=l,M[3]=s,M[6]=y,M[1]=w,M[4]=S,M[7]=C,M[2]=h,M[5]=x,M[8]=R,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(l){const s=l.elements;this.set(s[0],s[3],s[6],s[1],s[4],s[7],s[2],s[5],s[8])}multiplyScalar(l){const s=this.elements;return s[0]*=l,s[3]*=l,s[6]*=l,s[1]*=l,s[4]*=l,s[7]*=l,s[2]*=l,s[5]*=l,s[8]*=l,this}getInverse3(l){const s=l.elements,y=this.elements;y[0]=s[4]*s[8]-s[5]*s[7],y[3]=s[6]*s[5]-s[3]*s[8],y[6]=s[3]*s[7]-s[6]*s[4],y[1]=s[7]*s[2]-s[1]*s[8],y[4]=s[0]*s[8]-s[6]*s[2],y[7]=s[1]*s[6]-s[0]*s[7],y[2]=s[1]*s[5]-s[2]*s[4],y[5]=s[2]*s[3]-s[0]*s[5],y[8]=s[0]*s[4]-s[1]*s[3];const w=s[0]*y[0]+s[3]*y[1]+s[6]*y[2];return this.multiplyScalar(1/w),this}getInverse(l,s){const y=l.elements,w=this.elements;w[0]=y[10]*y[5]-y[6]*y[9],w[1]=-y[10]*y[1]+y[2]*y[9],w[2]=y[6]*y[1]-y[2]*y[5],w[3]=-y[10]*y[4]+y[6]*y[8],w[4]=y[10]*y[0]-y[2]*y[8],w[5]=-y[6]*y[0]+y[2]*y[4],w[6]=y[9]*y[4]-y[5]*y[8],w[7]=-y[9]*y[0]+y[1]*y[8],w[8]=y[5]*y[0]-y[1]*y[4];const S=y[0]*w[0]+y[1]*w[3]+y[2]*w[6];if(S===0){const C="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(s)throw new Error(C);return console.warn(C),this.identity(),this}return this.multiplyScalar(1/S),this}getDeterminant(){const l=this.elements;return l[0]*l[4]*l[8]+l[1]*l[5]*l[6]+l[2]*l[3]*l[7]-l[2]*l[4]*l[6]-l[1]*l[3]*l[8]-l[0]*l[5]*l[7]}transpose(){let l;const s=this.elements;return l=s[1],s[1]=s[3],s[3]=l,l=s[2],s[2]=s[6],s[6]=l,l=s[5],s[5]=s[7],s[7]=l,this}clone(){const l=this.elements;return new k(l[0],l[3],l[6],l[1],l[4],l[7],l[2],l[5],l[8])}getMatrix4(){const l=this.elements;return new p(l[0],l[3],l[6],0,l[1],l[4],l[7],0,l[2],l[5],l[8],0)}}class A{constructor(l,s){this.origin=l!==void 0?l:new E,this.direction=s!==void 0?s:new E}set(l,s){return this.origin.copy(l),this.direction.copy(s),this}copy(l){return this.origin.copy(l.origin),this.direction.copy(l.direction),this}at(l,s){return(s||new E).copy(this.direction).multiplyScalar(l).add(this.origin)}recast(l){const s=f;return this.origin.copy(this.at(l,s)),this}closestPointToPoint(l,s){const y=s||new E;y.subVectors(l,this.origin);const w=y.dot(this.direction);return y.copy(this.direction).multiplyScalar(w).add(this.origin)}distanceToPoint(l){const s=f,y=s.subVectors(l,this.origin).dot(this.direction);return s.copy(this.direction).multiplyScalar(y).add(this.origin),s.distanceTo(l)}isIntersectionCylinder(){}isIntersectionSphere(l){return this.distanceToPoint(l.center)<=l.radius}isIntersectionPlane(l){return l.normal.dot(this.direction)!==0||l.distanceToPoint(this.origin)===0}distanceToPlane(l){const s=l.normal.dot(this.direction);return s===0?l.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot(l.normal)+l.constant)/s}intersectPlane(l,s){const y=this.distanceToPlane(l);if(y!==void 0)return this.at(y,s)}applyMatrix4(l){return this.direction.add(this.origin).applyMatrix4(l),this.origin.applyMatrix4(l),this.direction.sub(this.origin),this}clone(){return new A().copy(this)}}}),"./src/WebGL/math/utils/clamp.ts":((e,r,t)=>{t.r(r),t.d(r,{clamp:()=>o});function o(c,u,v){return Math.min(Math.max(c,u),v)}}),"./src/WebGL/math/utils/conversionMatrix3.ts":((e,r,t)=>{t.r(r),t.d(r,{conversionMatrix3:()=>c});var o=t("./src/WebGL/math/math.ts");function c(u,v,f,g,_,p){g=g*Math.PI/180,_=_*Math.PI/180,p=p*Math.PI/180;const E=s=>s*s,k=Math.cos(g),A=Math.cos(_),z=Math.cos(p),l=Math.sin(p);return new o.Matrix3(u,v*z,f*A,0,v*l,f*(k-A*z)/l,0,0,f*Math.sqrt(1-E(k)-E(A)-E(z)+2*k*A*z)/l)}}),"./src/WebGL/math/utils/degToRad.ts":((e,r,t)=>{t.r(r),t.d(r,{degToRad:()=>c});const o=Math.PI/180;function c(u){return u*o}}),"./src/WebGL/objects/Line.ts":((e,r,t)=>{t.r(r),t.d(r,{Line:()=>v,LineStyle:()=>u});var o=t("./src/WebGL/materials/index.ts"),c=t("./src/WebGL/core/index.ts"),u;(function(f){f[f.LineStrip=0]="LineStrip",f[f.LinePieces=1]="LinePieces"})(u||(u={}));class v extends c.Object3D{constructor(g,_=new o.LineBasicMaterial({color:Math.random()*16777215}),p=u.LineStrip){super(),this.geometry=g,this.material=_,this.type=p}clone(g=new v(this.geometry,this.material,this.type)){return super.clone.call(this,g),g}}}),"./src/WebGL/objects/Mesh.ts":((e,r,t)=>{t.r(r),t.d(r,{Mesh:()=>c});var o=t("./src/WebGL/core/index.ts");class c extends o.Object3D{constructor(v,f){super(),this.geometry=v,this.material=f}clone(v){return v===void 0&&(v=new c(this.geometry,this.material)),super.clone.call(this,v),v}}}),"./src/WebGL/objects/Sprite.ts":((e,r,t)=>{t.r(r),t.d(r,{Sprite:()=>u});var o=t("./src/WebGL/materials/index.ts"),c=t("./src/WebGL/core/index.ts");class u extends c.Object3D{constructor(f=new o.SpriteMaterial){super(),this.material=f,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),(this.scale.x!==1||this.scale.y!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(f=new u(this.material)){return c.Object3D.prototype.clone.call(this,f),f}}}),"./src/WebGL/objects/index.ts":((e,r,t)=>{t.r(r),t.d(r,{Line:()=>o.Line,LineStyle:()=>o.LineStyle,Mesh:()=>c.Mesh,Sprite:()=>u.Sprite});var o=t("./src/WebGL/objects/Line.ts"),c=t("./src/WebGL/objects/Mesh.ts"),u=t("./src/WebGL/objects/Sprite.ts")}),"./src/WebGL/shaders/ShaderType.ts":((e,r,t)=>{t.r(r)}),"./src/WebGL/shaders/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ShaderLib:()=>o.ShaderLib,ShaderUtils:()=>c.ShaderUtils,basic:()=>o.basic,clone:()=>c.clone,instanced:()=>o.instanced,lambert:()=>o.lambert,lambertdouble:()=>o.lambertdouble,outline:()=>o.outline,screen:()=>o.screen,screenaa:()=>o.screenaa,sphereimposter:()=>o.sphereimposter,sphereimposteroutline:()=>o.sphereimposteroutline,sprite:()=>o.sprite,stickimposter:()=>o.stickimposter,stickimposteroutline:()=>o.stickimposteroutline,volumetric:()=>o.volumetric});var o=t("./src/WebGL/shaders/lib/index.ts"),c=t("./src/WebGL/shaders/utils/index.ts");t("./src/WebGL/shaders/ShaderType.ts")}),"./src/WebGL/shaders/lib/basic/index.ts":((e,r,t)=>{t.r(r),t.d(r,{basic:()=>v});var o=t("./src/WebGL/shaders/lib/basic/uniforms.ts"),c=t("./src/WebGL/shaders/lib/basic/basic.frag"),u=t("./src/WebGL/shaders/lib/basic/basic.vert");const v={vertexShader:u.default.replace("#define GLSLIFY 1",""),fragmentShader:c.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/basic/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}}}),"./src/WebGL/shaders/lib/blur/index.ts":((e,r,t)=>{t.r(r),t.d(r,{blur:()=>v});var o=t("./src/WebGL/shaders/lib/blur/uniforms.ts"),c=t("./src/WebGL/shaders/lib/blur/blur.frag"),u=t("./src/WebGL/shaders/lib/blur/blur.vert");const v={fragmentShader:c.default,vertexShader:u.default,uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/blur/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>o});const o={}}),"./src/WebGL/shaders/lib/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ShaderLib:()=>w,basic:()=>o.basic,instanced:()=>c.instanced,lambert:()=>u.lambert,lambertdouble:()=>v.lambertdouble,outline:()=>f.outline,screen:()=>g.screen,screenaa:()=>_.screenaa,sphereimposter:()=>p.sphereimposter,sphereimposteroutline:()=>E.sphereimposteroutline,sprite:()=>k.sprite,stickimposter:()=>A.stickimposter,stickimposteroutline:()=>z.stickimposteroutline,volumetric:()=>l.volumetric});var o=t("./src/WebGL/shaders/lib/basic/index.ts"),c=t("./src/WebGL/shaders/lib/instanced/index.ts"),u=t("./src/WebGL/shaders/lib/lambert/index.ts"),v=t("./src/WebGL/shaders/lib/lambertdouble/index.ts"),f=t("./src/WebGL/shaders/lib/outline/index.ts"),g=t("./src/WebGL/shaders/lib/screen/index.ts"),_=t("./src/WebGL/shaders/lib/screenaa/index.ts"),p=t("./src/WebGL/shaders/lib/sphereimposter/index.ts"),E=t("./src/WebGL/shaders/lib/sphereimposteroutline/index.ts"),k=t("./src/WebGL/shaders/lib/sprite/index.ts"),A=t("./src/WebGL/shaders/lib/stickimposter/index.ts"),z=t("./src/WebGL/shaders/lib/stickimposteroutline/index.ts"),l=t("./src/WebGL/shaders/lib/volumetric/index.ts"),s=t("./src/WebGL/shaders/lib/ssao/index.ts"),y=t("./src/WebGL/shaders/lib/blur/index.ts");const w={basic:o.basic,blur:y.blur,instanced:c.instanced,lambert:u.lambert,lambertdouble:v.lambertdouble,outline:f.outline,screen:g.screen,screenaa:_.screenaa,ssao:s.ssao,sphereimposter:p.sphereimposter,sphereimposteroutline:E.sphereimposteroutline,sprite:k.sprite,stickimposter:A.stickimposter,stickimposteroutline:z.stickimposteroutline,volumetric:l.volumetric}}),"./src/WebGL/shaders/lib/instanced/index.ts":((e,r,t)=>{t.r(r),t.d(r,{instanced:()=>v});var o=t("./src/WebGL/shaders/lib/instanced/uniforms.ts"),c=t("./src/WebGL/shaders/lib/instanced/instanced.frag"),u=t("./src/WebGL/shaders/lib/instanced/instanced.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/instanced/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/lambert/index.ts":((e,r,t)=>{t.r(r),t.d(r,{lambert:()=>v});var o=t("./src/WebGL/shaders/lib/lambert/uniforms.ts"),c=t("./src/WebGL/shaders/lib/lambert/lambert.frag"),u=t("./src/WebGL/shaders/lib/lambert/lambert.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/lambert/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/lambertdouble/index.ts":((e,r,t)=>{t.r(r),t.d(r,{lambertdouble:()=>v});var o=t("./src/WebGL/shaders/lib/lambertdouble/uniforms.ts"),c=t("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag"),u=t("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/lambertdouble/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/outline/index.ts":((e,r,t)=>{t.r(r),t.d(r,{outline:()=>v});var o=t("./src/WebGL/shaders/lib/outline/uniforms.ts"),c=t("./src/WebGL/shaders/lib/outline/outline.frag"),u=t("./src/WebGL/shaders/lib/outline/outline.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/outline/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new o.Color(0,0,0)},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/screen/index.ts":((e,r,t)=>{t.r(r),t.d(r,{screen:()=>v});var o=t("./src/WebGL/shaders/lib/screen/uniforms.ts"),c=t("./src/WebGL/shaders/lib/screen/screen.frag"),u=t("./src/WebGL/shaders/lib/screen/screen.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/screen/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>o});const o={}}),"./src/WebGL/shaders/lib/screenaa/index.ts":((e,r,t)=>{t.r(r),t.d(r,{screenaa:()=>v});var o=t("./src/WebGL/shaders/lib/screenaa/uniforms.ts"),c=t("./src/WebGL/shaders/lib/screenaa/screenaa.frag"),u=t("./src/WebGL/shaders/lib/screenaa/screenaa.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/screenaa/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>o});const o={}}),"./src/WebGL/shaders/lib/sphereimposter/index.ts":((e,r,t)=>{t.r(r),t.d(r,{sphereimposter:()=>v});var o=t("./src/WebGL/shaders/lib/sphereimposter/uniforms.ts"),c=t("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag"),u=t("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert");const v={vertexShader:u.default.replace("#define GLSLIFY 1",""),fragmentShader:c.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/sphereimposter/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/sphereimposteroutline/index.ts":((e,r,t)=>{t.r(r),t.d(r,{sphereimposteroutline:()=>v});var o=t("./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts"),c=t("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag"),u=t("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new o.Color(0,0,0)},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/sprite/index.ts":((e,r,t)=>{t.r(r),t.d(r,{sprite:()=>v});var o=t("./src/WebGL/shaders/lib/sprite/uniforms.ts"),c=t("./src/WebGL/shaders/lib/sprite/sprite.frag"),u=t("./src/WebGL/shaders/lib/sprite/sprite.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/sprite/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>o});const o={}}),"./src/WebGL/shaders/lib/ssao/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ssao:()=>v});var o=t("./src/WebGL/shaders/lib/ssao/uniforms.ts"),c=t("./src/WebGL/shaders/lib/ssao/ssao.frag"),u=t("./src/WebGL/shaders/lib/ssao/ssao.vert");const v={fragmentShader:c.default,vertexShader:u.default,uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/ssao/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>o});const o={total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}}),"./src/WebGL/shaders/lib/stickimposter/index.ts":((e,r,t)=>{t.r(r),t.d(r,{stickimposter:()=>f});var o=t("./src/WebGL/shaders/lib/stickimposter/uniforms.ts"),c=t("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),u=t("./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag"),v=t("./src/WebGL/shaders/lib/stickimposter/stickimposter.vert");const f={fragmentShader:[c.default,u.default].join(`
`),vertexShader:v.default,uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/stickimposter/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/stickimposteroutline/index.ts":((e,r,t)=>{t.r(r),t.d(r,{stickimposteroutline:()=>v});var o=t("./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts"),c=t("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),u=t("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert");const v={fragmentShader:c.default+"gl_FragColor = vec4(color,1.0);}",vertexShader:u.default,uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new o.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/volumetric/index.ts":((e,r,t)=>{t.r(r),t.d(r,{volumetric:()=>v});var o=t("./src/WebGL/shaders/lib/volumetric/uniforms.ts"),c=t("./src/WebGL/shaders/lib/volumetric/volumetric.frag"),u=t("./src/WebGL/shaders/lib/volumetric/volumetric.vert");const v={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:u.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}}),"./src/WebGL/shaders/lib/volumetric/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var o=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}}}),"./src/WebGL/shaders/utils/clone.ts":((e,r,t)=>{t.r(r),t.d(r,{clone:()=>c});var o=t("./src/colors.ts");function c(u){let v={};for(const g in u){v[g]={},v[g].type=u[g].type;var f=u[g].value;f instanceof o.Color?v[g].value=f.clone():typeof f=="number"?v[g].value=f:f instanceof Array?v[g].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return v}}),"./src/WebGL/shaders/utils/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ShaderUtils:()=>c,clone:()=>o.clone});var o=t("./src/WebGL/shaders/utils/clone.ts");const c={clone:o.clone}}),"./src/WebGL/shapes/Cylinder.ts":((e,r,t)=>{t.r(r),t.d(r,{Cylinder:()=>u});var o=t("./src/WebGL/math/index.ts");let c=new o.Vector3;class u{constructor(f=new o.Vector3,g=new o.Vector3,_=0){this.c1=f,this.c2=g,this.radius=_,this.direction=new o.Vector3().subVectors(this.c2,this.c1).normalize()}copy(f){return this.c1.copy(f.c1),this.c2.copy(f.c2),this.direction.copy(f.direction),this.radius=f.radius,this}lengthSq(){return c.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(f){return this.direction.add(this.c1).applyMatrix4(f),this.c1.applyMatrix4(f),this.c2.applyMatrix4(f),this.direction.sub(this.c1).normalize(),this.radius=this.radius*f.getMaxScaleOnAxis(),this}}}),"./src/WebGL/shapes/Sphere.ts":((e,r,t)=>{t.r(r),t.d(r,{Sphere:()=>c});var o=t("./src/WebGL/math/index.ts");class c{constructor(v={x:0,y:0,z:0},f=0){this.center=new o.Vector3(v.x,v.y,v.z),this.radius=f}set(v,f){return this.center.copy(v),this.radius=f,this}copy(v){return this.center.copy(v.center),this.radius=v.radius,this}applyMatrix4(v){return this.center.applyMatrix4(v),this.radius=this.radius*v.getMaxScaleOnAxis(),this}translate(v){return this.center.add(v),this}equals(v){return v.center.equals(this.center)&&v.radius===this.radius}clone(){return new c().copy(this)}}}),"./src/WebGL/shapes/Triangle.ts":((e,r,t)=>{t.r(r),t.d(r,{Triangle:()=>u});var o=t("./src/WebGL/math/index.ts");const c=new o.Vector3;class u{constructor(f=new o.Vector3,g=new o.Vector3,_=new o.Vector3){this.a=f,this.b=g,this.c=_}copy(f){return this.a.copy(f.a),this.b.copy(f.b),this.c.copy(f.c),this}applyMatrix4(f){return this.a.applyMatrix4(f),this.b.applyMatrix4(f),this.c.applyMatrix4(f),this}getNormal(){var f=this.a.clone();return f.sub(this.b),c.subVectors(this.c,this.b),f.cross(c),f.normalize(),f}}}),"./src/WebGL/shapes/index.ts":((e,r,t)=>{t.r(r),t.d(r,{Cylinder:()=>c.Cylinder,Sphere:()=>o.Sphere,Triangle:()=>u.Triangle});var o=t("./src/WebGL/shapes/Sphere.ts"),c=t("./src/WebGL/shapes/Cylinder.ts"),u=t("./src/WebGL/shapes/Triangle.ts")}),"./src/autoload.ts":((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{autoinit:()=>autoinit,autoload:()=>autoload,processing_autoinit:()=>processing_autoinit,viewers:()=>viewers});var _GLViewer__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/GLViewer.ts"),_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/ProteinSurface4.ts"),_utilities__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utilities.ts"),_colors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/colors.ts"),autoinit=!1,processing_autoinit=!1,viewers={};function autoload(viewer,callback){var i,dataname,type;if(document.querySelector(".viewer_3Dmoljs")!=null&&(autoinit=!0),autoinit){processing_autoinit=!0,viewer=viewer??null;var nviewers=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(viewerdiv=>{var datauri=[],datatypes=[],uri="";viewerdiv.style.position=="static"&&(viewerdiv.style.position="relative");var UI=null;if(type=null,viewerdiv.dataset.pdb)datauri.push("https://files.rcsb.org/view/"+viewerdiv.dataset.pdb+".pdb"),datatypes.push("pdb");else if(viewerdiv.dataset.cid)datatypes.push("sdf"),datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+viewerdiv.dataset.cid+"/SDF?record_type=3d");else if(viewerdiv.dataset.href||viewerdiv.dataset.url){if(viewerdiv.dataset.href?uri=viewerdiv.dataset.href:uri=viewerdiv.dataset.url,datauri.push(uri),type=uri.substring(uri.lastIndexOf(".")+1),type=="gz"){let e=uri.substring(0,uri.lastIndexOf(".")).lastIndexOf(".");type=uri.substring(e+1)}datatypes.push(type);var molName=uri.substring(uri.lastIndexOf("/")+1,uri.lastIndexOf("."));molName=="/"&&(molName=uri.substring(uri.lastIndexOf("/")+1)),viewerdiv.dataset[datatypes[datatypes.length-1]]=molName}let divdata=viewerdiv.dataset;for(i in divdata)i.substring(0,3)==="pdb"&&i!=="pdb"?(datauri.push("https://files.rcsb.org/view/"+divdata[i]+".pdb"),datatypes.push("pdb")):i.substring(0,4)==="href"&&i!=="href"?(uri=divdata[i],datauri.push(uri),datatypes.push(uri.substring(uri.lastIndexOf(".")+1))):i.substring(0,3)==="cid"&&i!=="cid"&&(datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+divdata[i]+"/SDF?record_type=3d"),datatypes.push("sdf"));var options={};viewerdiv.dataset.options&&(options=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.options));var bgcolor=_colors__WEBPACK_IMPORTED_MODULE_3__.CC.color(viewerdiv.dataset.backgroundcolor),bgalpha=viewerdiv.dataset.backgroundalpha;bgalpha=bgalpha==null?1:parseFloat(bgalpha);var style={line:{}};viewerdiv.dataset.style&&(style=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.style));var select={};viewerdiv.dataset.select&&(select=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.select));var selectstylelist=[],surfaces=[],labels=[],zoomto={},spin=null,d=viewerdiv.dataset,stylere=/style(.+)/,surfre=/surface(.*)/,reslabre=/labelres(.*)/,keys=[];for(dataname in d)Object.prototype.hasOwnProperty.call(d,dataname)&&keys.push(dataname);for(keys.sort(),i=0;i<keys.length;i++){dataname=keys[i];var m=stylere.exec(dataname),selname,newsel,styleobj;m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),selectstylelist.push([newsel,styleobj])),m=surfre.exec(dataname),m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),surfaces.push([newsel,styleobj])),m=reslabre.exec(dataname),m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),labels.push([newsel,styleobj])),dataname=="zoomto"&&(zoomto=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname])),dataname=="spin"&&(spin=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]))}var applyStyles=function(e){for(e.setStyle(select,style),UI&&UI.createSelectionAndStyle(select,style),i=0;i<selectstylelist.length;i++){let r=selectstylelist[i][0]||{},t=selectstylelist[i][1]||{line:{}};e.setStyle(r,t),UI&&UI.createSelectionAndStyle(select,style)}for(i=0;i<surfaces.length;i++){let r=surfaces[i][0]||{},t=surfaces[i][1]||{};UI?e.addSurface(_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__.SurfaceType.VDW,t,r,r).then(o=>{UI.loadSurface("VDW",r,t,o)}):e.addSurface(_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__.SurfaceType.VDW,t,r,r)}for(i=0;i<labels.length;i++){let r=labels[i][0]||{},t=labels[i][1]||{};e.addResLabels(r,t)}e.render(),e.zoomTo(zoomto),spin&&e.spin(spin.axis,spin.speed)};let glviewer=viewer;try{var config=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.config)||{};config.backgroundColor===void 0&&(config.backgroundColor=bgcolor),config.backgroundAlpha===void 0&&(config.backgroundAlpha=bgalpha),glviewer==null?glviewer=viewers[viewerdiv.id||nviewers++]=(0,_GLViewer__WEBPACK_IMPORTED_MODULE_0__.createViewer)(viewerdiv,config):(glviewer.setBackgroundColor(bgcolor,bgalpha),glviewer.setConfig(config),UI&&UI.initiateUI()),viewerdiv.dataset.ui&&$3Dmol.StateManager&&(UI=new $3Dmol.StateManager(glviewer))}catch(e){console.log(e),viewerdiv.textContent="WebGL appears to be disabled."}if(datauri.length!=0){let i=0,process=((viewerdiv,glviewer)=>function(moldata){uri=datauri[i];var type=viewerdiv.dataset.type||viewerdiv.dataset.datatype||datatypes[i];if(glviewer.addModel(moldata,type,options),UI){var modelName=viewerdiv.dataset[datatypes[i]];UI.setModelTitle(modelName)}if(i+=1,i<datauri.length)(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.get)(datauri[i]).then(process);else{if(applyStyles(glviewer),viewerdiv.dataset.callback){var runres=eval(viewerdiv.dataset.callback);typeof runres=="function"&&runres(glviewer)}processing_autoinit=!1,callback&&callback(glviewer)}})(viewerdiv,glviewer);type&&type.endsWith("gz")?(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.getbin)(datauri[0]).then(process):(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.get)(datauri[0]).then(process)}else{if(viewerdiv.dataset.element){var moldataid="#"+viewerdiv.dataset.element,molelem=document.querySelector(moldataid),moldata=molelem?molelem.textContent:"";type=viewerdiv.dataset.type||viewerdiv.dataset.datatype,glviewer.addModel(moldata,type,options)}if(applyStyles(glviewer),viewerdiv.dataset.callback){var runres=eval(viewerdiv.dataset.callback);typeof runres=="function"&&runres(glviewer)}processing_autoinit=!1,callback&&callback(glviewer)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&autoload()}}),"./src/colors.ts":((e,r,t)=>{t.r(r),t.d(r,{CC:()=>c,Color:()=>o,builtinColorSchemes:()=>E,chains:()=>p,elementColors:()=>g,htmlColors:()=>u,residues:()=>_,ssColors:()=>v});class o{constructor(A,z,l){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof A=="number"?(this.r=A||0,this.g=z||0,this.b=l||0,this):this.set(A||0)}set(A){return A instanceof o?A.clone():(typeof A=="number"?this.setHex(A):typeof A=="object"&&(this.r=A?.r||0,this.g=A?.g||0,this.b=A?.b||0),this)}setHex(A){return A=Math.floor(A),this.r=(A>>16&255)/255,this.g=(A>>8&255)/255,this.b=(A&255)/255,this}getHex(){var A=Math.round(this.r*255),z=Math.round(this.g*255),l=Math.round(this.b*255);return A<<16|z<<8|l}clone(){return new o(this.r,this.g,this.b)}copy(A){return this.r=A.r,this.g=A.g,this.b=A.b,this}scaled(){var A={};return A.r=Math.round(this.r*255),A.g=Math.round(this.g*255),A.b=Math.round(this.b*255),A.a=1,A}}class c{static color(A){if(!A)return c.cache[0];if(A instanceof o)return A;if(typeof A=="number"&&typeof c.cache[A]<"u")return c.cache[A];if(A&&Array.isArray(A))return A.map(c.color);let z=c.getHex(A),l=new o(z);return c.cache[z]=l,l}static getHex(A){var z;if(Array.isArray(A))return A.map(c.getHex);if(typeof A=="string"){let l=A;if(!isNaN(parseInt(l)))return parseInt(l);if(l=l.trim(),l.length==4&&l[0]=="#"&&(l="#"+l[1]+l[1]+l[2]+l[2]+l[3]+l[3]),l.length==7&&l[0]=="#")return parseInt(l.substring(1),16);let s=c.rgbRegEx.exec(l);if(s){s[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let y=0;for(let w=2;w<5;w++){y*=256;let S=s[w].endsWith("%")?255*parseFloat(s[w])/100:parseFloat(s[w]);y+=Math.round(S)}return y}return((z=window?.$3Dmol)===null||z===void 0?void 0:z.htmlColors[A.toLowerCase()])||0}return A}}c.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,c.cache={0:new o(0)};const u={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},v={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},f={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},g={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:f,defaultColors:Object.assign({},f),greenCarbon:Object.assign(Object.assign({},f),{C:65280}),cyanCarbon:Object.assign(Object.assign({},f),{C:65535}),magentaCarbon:Object.assign(Object.assign({},f),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},f),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},f),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},f),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},f),{C:8388736}),blueCarbon:Object.assign(Object.assign({},f),{C:255})},_={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},p={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},E={ssPyMol:{prop:"ss",map:v.pyMol},ssJmol:{prop:"ss",map:v.Jmol},Jmol:{prop:"elem",map:g.Jmol},amino:{prop:"resn",map:_.amino},shapely:{prop:"resn",map:_.shapely},nucleic:{prop:"resn",map:_.nucleic},chain:{prop:"chain",map:p.atom},rasmol:{prop:"elem",map:g.rasmol},default:{prop:"elem",map:g.defaultColors},greenCarbon:{prop:"elem",map:g.greenCarbon},chainHetatm:{prop:"chain",map:p.hetatm},cyanCarbon:{prop:"elem",map:g.cyanCarbon},magentaCarbon:{prop:"elem",map:g.magentaCarbon},purpleCarbon:{prop:"elem",map:g.purpleCarbon},whiteCarbon:{prop:"elem",map:g.whiteCarbon},orangeCarbon:{prop:"elem",map:g.orangeCarbon},yellowCarbon:{prop:"elem",map:g.yellowCarbon},blueCarbon:{prop:"elem",map:g.blueCarbon}}}),"./src/glcartoon.ts":((e,r,t)=>{t.r(r),t.d(r,{drawCartoon:()=>X,subdivide_spline:()=>p});var o=t("./src/WebGL/math/index.ts"),c=t("./src/WebGL/shapes/index.ts"),u=t("./src/WebGL/index.ts"),v=t("./src/Gradient.ts"),f=t("./src/colors.ts"),g=t("./src/GLDraw.ts"),_=t("./src/utilities.ts");function p(B,j){var H=[],$=B;$=[],$.push(B[0]);var q,W,Y,G,V,Z,xe,ce,Ne;for(q=1,W=B.length-1;q<W;q++)if(V=B[q],Z=B[q+1],V.smoothen){var Pe=new o.Vector3((V.x+Z.x)/2,(V.y+Z.y)/2,(V.z+Z.z)/2);Pe.atom=V.atom,$.push(Pe)}else $.push(V);for($.push(B[B.length-1]),q=-1,Y=$.length;q<=Y-3;q++)if(G=$[q===-1?0:q],V=$[q+1],Z=$[q+2],xe=$[q===Y-3?Y-1:q+3],ce=new o.Vector3().subVectors(Z,G).multiplyScalar(.5),Ne=new o.Vector3().subVectors(xe,V).multiplyScalar(.5),!Z.skip)for(var De=0;De<j;De++){var Me=1/j*De,Be=V.x+Me*ce.x+Me*Me*(-3*V.x+3*Z.x-2*ce.x-Ne.x)+Me*Me*Me*(2*V.x-2*Z.x+ce.x+Ne.x),ft=V.y+Me*ce.y+Me*Me*(-3*V.y+3*Z.y-2*ce.y-Ne.y)+Me*Me*Me*(2*V.y-2*Z.y+ce.y+Ne.y),jt=V.z+Me*ce.z+Me*Me*(-3*V.z+3*Z.z-2*ce.z-Ne.z)+Me*Me*Me*(2*V.z-2*Z.z+ce.z+Ne.z),Gt=new o.Vector3(Be,ft,jt);De<j/2?Gt.atom=V.atom:Gt.atom=Z.atom,H.push(Gt)}return H.push($[$.length-1]),H}const E=.5,k=1.3,A=.8,z=.4,l=.4;function s(B,j,H,$){for(var q,W,Y,G,V=0,Z=j.length;V<Z;V++){G=Math.round(V*($.length-1)/Z),Y=f.CC.color($[G]);var xe=B.updateGeoGroup(2),ce=xe.vertexArray,Ne=xe.colorArray,Pe=xe.faceArray;q=xe.vertices,W=q*3,ce[W]=j[V].x,ce[W+1]=j[V].y,ce[W+2]=j[V].z,ce[W+3]=H[V].x,ce[W+4]=H[V].y,ce[W+5]=H[V].z;for(var De=0;De<6;++De)Ne[W+3*De]=Y.r,Ne[W+1+3*De]=Y.g,Ne[W+2+3*De]=Y.b;if(V>0){var Me=[q,q+1,q-1,q-2],Be=xe.faceidx;Pe[Be]=Me[0],Pe[Be+1]=Me[1],Pe[Be+2]=Me[3],Pe[Be+3]=Me[1],Pe[Be+4]=Me[2],Pe[Be+5]=Me[3],xe.faceidx+=6}xe.vertices+=2}}function y(B,j,H,$,q,W,Y){var G,V,Z,xe;if(Z=j.length,Z<2||j[0].length<2)return;for(G=0;G<Z;G++)j[G]=p(j[G],$);if(xe=j[0].length,!q)return s(B,j[0],j[Z-1],H);var ce,Ne,Pe,De,Me,Be,ft=[],jt=[],Gt=[];for(V=0;V<Z;V++)ft.push(.25+1.5*Math.sqrt((Z-1)*V-Math.pow(V,2))/(Z-1)),jt.push(.5),Gt.push(2*(Math.pow(V/Z,2)-V/Z)+.6);var mt=[];for(V=0;V<Z*2-1;V++)mt[V]=[V,V+1,V+1-2*Z,V-2*Z];mt[Z*2-1]=[V,V+1-2*Z,V+1-4*Z,V-2*Z];var Fe,ht,Kt,Jt,Wt,Br,zr,cr,Nr,At;let Mt=B.updateGeoGroup();for(G=0;G<xe;G++){let ve=B.groups,we=!1;Mt=B.updateGeoGroup(2*Z),ve!=B.groups&&G>0&&(G=G-1,we=!0),Br=Math.round(G*(H.length-1)/xe),Wt=f.CC.color(H[Br]),Me=Pe,Be=De,Pe=[],De=[],ce=[],j[0][G].atom!==void 0&&(Jt=j[0][G].atom,Y==="oval"?Ne=ft:Y==="rectangle"?Ne=jt:Y==="parabola"&&(Ne=Gt)),Ne||(Ne=jt);var Jr,Yr;for(V=0;V<Z;V++)G<xe-1?Jr=j[V][G+1].clone().sub(j[V][G]):Jr=j[V][G-1].clone().sub(j[V][G]).negate(),V<Z-1?Yr=j[V+1][G].clone().sub(j[V][G]):Yr=j[V-1][G].clone().sub(j[V][G]).negate(),ce[V]=Yr.cross(Jr).normalize().multiplyScalar(q*Ne[V]);for(V=0;V<Z;V++)Pe[V]=j[V][G].clone().add(ce[V].clone().negate());for(V=0;V<Z;V++)De[V]=j[V][G].clone().add(ce[V]);for(zr=Mt.vertexArray,cr=Mt.colorArray,Nr=Mt.faceArray,Fe=Mt.vertices,ht=Fe*3,V=0;V<Z;V++)zr[ht+3*V+0]=Pe[V].x,zr[ht+3*V+1]=Pe[V].y,zr[ht+3*V+2]=Pe[V].z;for(V=0;V<Z;V++)zr[ht+3*V+0+3*Z]=De[Z-1-V].x,zr[ht+3*V+1+3*Z]=De[Z-1-V].y,zr[ht+3*V+2+3*Z]=De[Z-1-V].z;for(V=0;V<2*Z;++V)cr[ht+3*V+0]=Wt.r,cr[ht+3*V+1]=Wt.g,cr[ht+3*V+2]=Wt.b;if(G>0&&!we){for(V=0;V<Z*2;V++)At=[Fe+mt[V][0],Fe+mt[V][1],Fe+mt[V][2],Fe+mt[V][3]],Kt=Mt.faceidx,Nr[Kt]=At[0],Nr[Kt+1]=At[1],Nr[Kt+2]=At[3],Nr[Kt+3]=At[1],Nr[Kt+4]=At[2],Nr[Kt+5]=At[3],Mt.faceidx+=6;if(Jt.clickable||Jt.hoverable){var ie=[];ie.push(new c.Triangle(Me[0],Pe[0],Pe[Z-1])),ie.push(new c.Triangle(Me[0],Pe[Z-1],Me[Z-1])),ie.push(new c.Triangle(Me[Z-1],Pe[Z-1],De[Z-1])),ie.push(new c.Triangle(Me[Z-1],De[Z-1],Be[Z-1])),ie.push(new c.Triangle(De[0],Be[0],Be[Z-1])),ie.push(new c.Triangle(De[Z-1],De[0],Be[Z-1])),ie.push(new c.Triangle(Pe[0],Me[0],Be[0])),ie.push(new c.Triangle(De[0],Pe[0],Be[0]));for(V in ie)Jt.intersectionShape.triangle.push(ie[V])}}Mt.vertices+=2*Z}for(zr=Mt.vertexArray,cr=Mt.colorArray,Nr=Mt.faceArray,Fe=Mt.vertices,ht=Fe*3,Kt=Mt.faceidx,G=0;G<Z-1;G++)At=[G,G+1,2*Z-2-G,2*Z-1-G],Kt=Mt.faceidx,Nr[Kt]=At[0],Nr[Kt+1]=At[1],Nr[Kt+2]=At[3],Nr[Kt+3]=At[1],Nr[Kt+4]=At[2],Nr[Kt+5]=At[3],Mt.faceidx+=6;for(G=0;G<Z-1;G++)At=[Fe-1-G,Fe-2-G,Fe-2*Z+G+1,Fe-2*Z+G],Kt=Mt.faceidx,Nr[Kt]=At[0],Nr[Kt+1]=At[1],Nr[Kt+2]=At[3],Nr[Kt+3]=At[1],Nr[Kt+4]=At[2],Nr[Kt+5]=At[3],Mt.faceidx+=6}function w(B,j,H,$,q,W){if(!(j.length<2)){var Y,G;if(Y=j[0],G=j[j.length-1],Y=p(Y,$),G=p(G,$),!q)return s(B,Y,G,H);var V=[],Z,xe,ce,Ne,Pe,De=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],Me,Be,ft,jt,Gt,mt,Fe,ht,Kt,Jt,Wt,Br,zr,cr,Nr,At,Mt;for(ht=0,Kt=Y.length;ht<Kt;ht++){if(Gt=Math.round(ht*(H.length-1)/Kt),jt=f.CC.color(H[Gt]),V.push(xe=Y[ht]),V.push(xe),V.push(ce=G[ht]),V.push(ce),ht<Kt-1){var Jr=Y[ht+1].clone().sub(Y[ht]),Yr=G[ht].clone().sub(Y[ht]);Z=Yr.cross(Jr).normalize().multiplyScalar(q)}for(V.push(Ne=Y[ht].clone().add(Z)),V.push(Ne),V.push(Pe=G[ht].clone().add(Z)),V.push(Pe),xe.atom!==void 0&&(mt=xe.atom),cr=B.updateGeoGroup(8),Nr=cr.vertexArray,At=cr.colorArray,Mt=cr.faceArray,Me=cr.vertices,Be=Me*3,Nr[Be]=xe.x,Nr[Be+1]=xe.y,Nr[Be+2]=xe.z,Nr[Be+3]=xe.x,Nr[Be+4]=xe.y,Nr[Be+5]=xe.z,Nr[Be+6]=ce.x,Nr[Be+7]=ce.y,Nr[Be+8]=ce.z,Nr[Be+9]=ce.x,Nr[Be+10]=ce.y,Nr[Be+11]=ce.z,Nr[Be+12]=Ne.x,Nr[Be+13]=Ne.y,Nr[Be+14]=Ne.z,Nr[Be+15]=Ne.x,Nr[Be+16]=Ne.y,Nr[Be+17]=Ne.z,Nr[Be+18]=Pe.x,Nr[Be+19]=Pe.y,Nr[Be+20]=Pe.z,Nr[Be+21]=Pe.x,Nr[Be+22]=Pe.y,Nr[Be+23]=Pe.z,Jt=0;Jt<8;++Jt)At[Be+3*Jt]=jt.r,At[Be+1+3*Jt]=jt.g,At[Be+2+3*Jt]=jt.b;if(ht>0){var ie=Fe!==void 0&&mt!==void 0&&Fe.serial!==mt.serial;for(Jt=0;Jt<4;Jt++){var ve=[Me+De[Jt][0],Me+De[Jt][1],Me+De[Jt][2],Me+De[Jt][3]];if(ft=cr.faceidx,Mt[ft]=ve[0],Mt[ft+1]=ve[1],Mt[ft+2]=ve[3],Mt[ft+3]=ve[1],Mt[ft+4]=ve[2],Mt[ft+5]=ve[3],cr.faceidx+=6,mt.clickable||Fe.clickable||mt.hoverable||Fe.hoverable){var we=V[ve[3]].clone(),it=V[ve[0]].clone(),rt=V[ve[2]].clone(),Yt=V[ve[1]].clone();if(we.atom=V[ve[3]].atom||null,rt.atom=V[ve[2]].atom||null,it.atom=V[ve[0]].atom||null,Yt.atom=V[ve[1]].atom||null,ie){var Ft=we.clone().add(it).multiplyScalar(.5),re=rt.clone().add(Yt).multiplyScalar(.5),tt=we.clone().add(Yt).multiplyScalar(.5);Jt%2===0?((Fe.clickable||Fe.hoverable)&&(Wt=new c.Triangle(Ft,tt,we),Br=new c.Triangle(re,rt,tt),zr=new c.Triangle(tt,rt,we),Fe.intersectionShape.triangle.push(Wt),Fe.intersectionShape.triangle.push(Br),Fe.intersectionShape.triangle.push(zr)),(mt.clickable||mt.hoverable)&&(Wt=new c.Triangle(it,Yt,tt),Br=new c.Triangle(Yt,re,tt),zr=new c.Triangle(it,tt,Ft),mt.intersectionShape.triangle.push(Wt),mt.intersectionShape.triangle.push(Br),mt.intersectionShape.triangle.push(zr))):((mt.clickable||mt.hoverable)&&(Wt=new c.Triangle(Ft,tt,we),Br=new c.Triangle(re,rt,tt),zr=new c.Triangle(tt,rt,we),mt.intersectionShape.triangle.push(Wt),mt.intersectionShape.triangle.push(Br),mt.intersectionShape.triangle.push(zr)),(Fe.clickable||Fe.hoverable)&&(Wt=new c.Triangle(it,Yt,tt),Br=new c.Triangle(Yt,re,tt),zr=new c.Triangle(it,tt,Ft),Fe.intersectionShape.triangle.push(Wt),Fe.intersectionShape.triangle.push(Br),Fe.intersectionShape.triangle.push(zr)))}else(mt.clickable||mt.hoverable)&&(Wt=new c.Triangle(it,Yt,we),Br=new c.Triangle(Yt,rt,we),mt.intersectionShape.triangle.push(Wt),mt.intersectionShape.triangle.push(Br))}}}cr.vertices+=8,Fe=mt}var lt=V.length-8;for(cr=B.updateGeoGroup(8),Nr=cr.vertexArray,At=cr.colorArray,Mt=cr.faceArray,Me=cr.vertices,Be=Me*3,ft=cr.faceidx,ht=0;ht<4;ht++){V.push(V[ht*2]),V.push(V[lt+ht*2]);var ar=V[ht*2],et=V[lt+ht*2];Nr[Be+6*ht]=ar.x,Nr[Be+1+6*ht]=ar.y,Nr[Be+2+6*ht]=ar.z,Nr[Be+3+6*ht]=et.x,Nr[Be+4+6*ht]=et.y,Nr[Be+5+6*ht]=et.z,At[Be+6*ht]=jt.r,At[Be+1+6*ht]=jt.g,At[Be+2+6*ht]=jt.b,At[Be+3+6*ht]=jt.r,At[Be+4+6*ht]=jt.g,At[Be+5+6*ht]=jt.b}lt+=8,Wt=[Me,Me+2,Me+6,Me+4],Br=[Me+1,Me+5,Me+7,Me+3],Mt[ft]=Wt[0],Mt[ft+1]=Wt[1],Mt[ft+2]=Wt[3],Mt[ft+3]=Wt[1],Mt[ft+4]=Wt[2],Mt[ft+5]=Wt[3],Mt[ft+6]=Br[0],Mt[ft+7]=Br[1],Mt[ft+8]=Br[3],Mt[ft+9]=Br[1],Mt[ft+10]=Br[2],Mt[ft+11]=Br[3],cr.faceidx+=12,cr.vertices+=8}}function S(B,j,H,$,q,W,Y){(!Y||Y==="default")&&(Y="rectangle"),Y==="edged"?w(B,j,H,$,q):(Y==="rectangle"||Y==="oval"||Y==="parabola")&&y(B,j,H,$,q,W,Y)}function C(B){return B&&B.elem==="C"&&B.atom==="CA"}function h(B,j){if(B&&j&&B.chain===j.chain){if(!B.hetflag&&!j.hetflag&&B.reschain===j.reschain&&(B.resi===j.resi||B.resi===j.resi-1))return!0;if(B.resi<j.resi){var H=B.x-j.x,$=B.y-j.y,q=B.z-j.z,W=H*H+$*$+q*q;if(B.atom=="CA"&&j.atom=="CA"&&W<16||(B.atom=="P"||j.atom=="P")&&W<64)return!0}}return!1}function x(B,j,H,$,q){if(!(j==null||j.vertices==0)){q&&(j.initTypedArrays(),j.setUpNormals());var W=new u.MeshDoubleLambertMaterial;W.vertexColors=u.Coloring.FaceColors,typeof H=="number"&&H>=0&&H<1&&(W.transparent=!0,W.opacity=H),W.outline=$;var Y=new u.Mesh(j,W);B.add(Y)}}function R(B,j,H,$,q,W,Y,G,V){var Z,xe,ce,Ne,Pe,De;if(!(!$||!q||!Y)){var Me=q.sub($);Me.normalize();var Be=G[V];for(xe=V+1;xe<G.length&&(Be=G[xe],Be.atom!=Y.atom);xe++);if(Be=Be?new o.Vector3(Be.x,Be.y,Be.z):new o.Vector3(0,0,0),Be.sub($),Y.ss==="arrow start"){var ft=Be.clone().multiplyScalar(.3).cross(q);$.add(ft);var jt=Be.clone().cross(Me).normalize();Me.rotateAboutVector(jt,.43)}for(Y.style.cartoon.ribbon?Z=Y.style.cartoon.thickness||z:Y.style.cartoon.width?Z=Y.style.cartoon.width:Y.ss==="c"?Y.atom==="P"?Z=A:Z=E:Y.ss==="arrow start"?(Z=k,Pe=!0):Y.ss==="arrow end"||Y.ss==="h"&&Y.style.cartoon.tubes||Y.ss==="tube start"?Z=E:Z=k,W!=null&&Me.dot(W)<0&&Me.negate(),Me.multiplyScalar(Z),xe=0;xe<j;xe++)ce=-1+xe*2/(j-1),Ne=new o.Vector3($.x+ce*Me.x,$.y+ce*Me.y,$.z+ce*Me.z),Ne.atom=Y,Y.ss==="s"&&(Ne.smoothen=!0),B[xe].push(Ne);if(Pe)for(Me.multiplyScalar(2),xe=0;xe<j;xe++)ce=-1+xe*2/(j-1),Ne=new o.Vector3($.x+ce*Me.x,$.y+ce*Me.y,$.z+ce*Me.z),Ne.atom=Y,Ne.smoothen=!1,Ne.skip=!0,B[xe].push(Ne);return De=Y.style.cartoon.style||"default",B.style?B.style!=De&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),B.style="default"):B.style=De,(Y.ss==="arrow start"||Y.ss==="arrow end")&&(Y.ss="s"),Pe}}const M={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},P={DA:!0,DG:!0,A:!0,G:!0},D={DT:!0,DC:!0,U:!0,C:!0,T:!0},L={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function X(B,j,H,$=10){let q=$,W=$;var Y,G,V,Z,xe,ce,Ne,Pe,De,Me,Be,ft,jt,Gt,mt,Fe,ht,Kt,Jt=new u.Geometry(!0),Wt=new u.Geometry(!0),Br=[],zr=[],cr=1,Nr=!1,At={};for(var Mt in v.Gradient.builtinGradients)v.Gradient.builtinGradients.hasOwnProperty(Mt)&&(At[Mt]=new v.Gradient.builtinGradients[Mt](H[1],H[0]));var Jr=function(se,xt){return H&&xt.color==="spectrum"?xt.colorscheme in At?At[xt.colorscheme].valueToHex(se.resi):At.sinebow.valueToHex(se.resi):(0,_.getColorFromStyle)(se,xt).getHex()};for(Pe=0;Pe<q;Pe++)zr[Pe]=[];var Yr=!1,ie=!1,ve=[];for(Pe in j){if(Z=j[Pe],Z.elem==="C"&&Z.atom==="CA"){var we=h(V,Z);we&&Z.ss==="s"?Yr=!0:Yr&&(V&&G&&V.style.cartoon.arrows&&G.style.cartoon.arrows&&(V.ss="arrow end",G.ss="arrow start"),Yr=!1),we&&(V.ss==="h"||V.ss=="tube start")&&V.style.cartoon.tubes?!ie&&V.ss!="tube start"&&Z.style.cartoon.tubes&&(Z.ss="tube start",ie=!0):ie&&(V.ss==="tube start"?V.ss="tube end":G&&G.style.cartoon.tubes&&(G.ss="tube end"),ie=!1),G=V,V=Z}Z&&Z.atom in M&&ve.push(Z)}ie&&V.style.cartoon.tubes&&(V.ss="tube end",ie=!1);var it=function(se){zr[0].length>0&&S(Wt,zr,Br,W,Ne,cr,zr.style);var xt=[],Vr=null;if(se){for(Pe=0;Pe<q;Pe++)xt[Pe]=zr[Pe][zr[Pe].length-1];Vr=Br[Br.length-1]}for(zr=[],Pe=0;Pe<q;Pe++)zr[Pe]=[];if(Br=[],se){for(Pe=0;Pe<q;Pe++)zr[Pe].push(xt[Pe]);Br.push(Vr)}x(B,Wt,cr,Nr,!0),x(B,Jt,cr,Nr,!1),Wt=new u.Geometry(!0),Jt=new u.Geometry(!0)};V=void 0;for(var rt=0;rt<ve.length;rt++){Z=ve[rt];var Yt=Z.resn.trim(),Ft=Yt in L;if(cr=1,Y=Z.style.cartoon,V&&V.style.cartoon&&(cr=V.style.cartoon.opacity),V&&V.style.cartoon&&V.style.cartoon.outline&&(Nr=V.style.cartoon.outline),V&&V.style.cartoon&&(!Z.style.cartoon||V.style.cartoon.opacity!=Z.style.cartoon.opacity)&&it(V.chain==Z.chain),Y.style==="trace"){if(!Z.hetflag&&(Z.elem==="C"&&Z.atom==="CA"||Ft&&Z.atom==="P"||Z.atom==="BB")){if(ce=Jr(Z,Y),(0,_.isNumeric)(Y.thickness)?Ne=Y.thickness:Ne=z,h(V,Z))if(ce==xe){var re=f.CC.color(ce);g.GLDraw.drawCylinder(Jt,V,Z,Ne,re,2,2)}else{var tt=new o.Vector3().addVectors(V,Z).multiplyScalar(.5),lt=f.CC.color(xe),ar=f.CC.color(ce);g.GLDraw.drawCylinder(Jt,V,tt,Ne,lt,2,0),g.GLDraw.drawCylinder(Jt,tt,Z,Ne,ar,0,2)}if((Z.clickable===!0||Z.hoverable)&&Z.intersectionShape!==void 0){var et=new o.Vector3(Z.x,Z.y,Z.z);Z.intersectionShape.sphere.push(new c.Sphere(et,Ne))}V=Z,xe=ce}}else{if(C(Z)||Ft&&(Z.atom==="P"||Z.atom.indexOf("O5")==0)){if(Kt)if(Z.ss==="tube end")Kt=!1,ht=new o.Vector3(Z.x,Z.y,Z.z),g.GLDraw.drawCylinder(Jt,Fe,ht,2,f.CC.color(xe),1,1),Z.ss="h";else if(V.chain!=Z.chain||V.ss==="tube end")Kt=!1,V.ss="h",ht=new o.Vector3(V.x,V.y,V.z),g.GLDraw.drawCylinder(Jt,Fe,ht,2,f.CC.color(xe),1,1);else continue;if(V&&(!h(V,Z)||V.ss==="tube start")){for(V.ss==="tube start"&&(Kt=!0,Fe=new o.Vector3(V.x,V.y,V.z),V.ss="h"),mt&&(ft?Gt=new o.Vector3().addVectors(V,ft).multiplyScalar(.5):Gt=new o.Vector3(V.x,V.y,V.z),g.GLDraw.drawCylinder(Jt,Gt,mt,l,f.CC.color(mt.color),0,2),R(zr,q,!0,ft,jt,Be,V,ve,rt),Br.push(ce),Gt=null,mt=null),zr[0].length>0&&S(Wt,zr,Br,W,Ne,cr,zr.style),zr=[],Pe=0;Pe<q;Pe++)zr[Pe]=[];Br=[]}if(V===void 0||V.rescode!=Z.rescode||V.resi!=Z.resi){if(mt&&V!=null){Gt=new o.Vector3().addVectors(V,Z).multiplyScalar(.5);var Ot=Gt.clone().sub(mt).multiplyScalar(.02);Gt.add(Ot),g.GLDraw.drawCylinder(Jt,Gt,mt,l,f.CC.color(mt.color),0,2),Gt=null,mt=null}ce=Jr(Z,Y),Br.push(ce),(0,_.isNumeric)(Y.thickness)?Ne=Y.thickness:Ne=z,V=Z,De=new o.Vector3(V.x,V.y,V.z),De.resi=V.resi,xe=ce}(Z.clickable===!0||Z.hoverable===!0)&&(Z.intersectionShape===void 0||Z.intersectionShape.triangle===void 0)&&(Z.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else V!=null&&(C(V)&&Z.atom==="O"||Ft&&V.atom==="P"&&(Z.atom==="OP2"||Z.atom==="O2P")||Ft&&V.atom.indexOf("O5")==0&&Z.atom.indexOf("C5")==0)?(Me=new o.Vector3(Z.x,Z.y,Z.z),Me.resi=Z.resi,(Z.atom==="OP2"||Z.atom==="O2P")&&(jt=new o.Vector3(Z.x,Z.y,Z.z))):Ft&&Z.atom.indexOf("O3")==0?ft=new o.Vector3(Z.x,Z.y,Z.z):(Z.atom==="N1"&&Yt in P||Z.atom==="N3"&&Yt in D)&&(mt=new o.Vector3(Z.x,Z.y,Z.z),mt.color=(0,_.getColorFromStyle)(Z,Y).getHex());Me&&De&&Me.resi===De.resi&&(R(zr,q,!0,De,Me,Be,V,ve,rt),Be=Me,De=null,Me=null,Br.push(ce))}}mt&&(ft?Gt=new o.Vector3().addVectors(V,ft).multiplyScalar(.5):Gt=new o.Vector3(V.x,V.y,V.z),g.GLDraw.drawCylinder(Jt,Gt,mt,l,f.CC.color(mt.color),0,2),R(zr,q,!0,ft,jt,Be,V,ve,rt),Br.push(ce)),it(!1)}}),"./src/index.ts":((e,r,t)=>{t.r(r),t.d(r,{CAP:()=>l.CAP,CC:()=>c.CC,CONTEXTS_PER_VIEWPORT:()=>w.CONTEXTS_PER_VIEWPORT,Color:()=>c.Color,CustomLinear:()=>o.CustomLinear,Cylinder:()=>_.Cylinder,GLDraw:()=>l.GLDraw,GLModel:()=>y.GLModel,GLShape:()=>z.GLShape,GLViewer:()=>w.GLViewer,GLVolumetricRender:()=>A.GLVolumetricRender,Gradient:()=>o.Gradient,GradientType:()=>o.GradientType,Label:()=>u.Label,LabelCount:()=>u.LabelCount,MarchingCube:()=>E.MarchingCube,MarchingCubeInitializer:()=>E.MarchingCubeInitializer,Matrix3:()=>g.Matrix3,Matrix4:()=>g.Matrix4,Parsers:()=>f.Parsers,PausableTimer:()=>p.PausableTimer,PointGrid:()=>E.PointGrid,ProteinSurface:()=>E.ProteinSurface,Quaternion:()=>g.Quaternion,ROYGB:()=>o.ROYGB,RWB:()=>o.RWB,Ray:()=>g.Ray,Sinebow:()=>o.Sinebow,Sphere:()=>_.Sphere,SurfaceType:()=>E.SurfaceType,Triangle:()=>_.Triangle,Vector2:()=>g.Vector2,Vector3:()=>g.Vector3,VolumeData:()=>k.VolumeData,adjustVolumeStyle:()=>p.adjustVolumeStyle,applyPartialCharges:()=>v.applyPartialCharges,autoinit:()=>S.autoinit,autoload:()=>S.autoload,base64ToArray:()=>p.base64ToArray,bondLength:()=>f.bondLength,builtinColorSchemes:()=>c.builtinColorSchemes,builtinGradients:()=>o.builtinGradients,chains:()=>c.chains,clamp:()=>g.clamp,conversionMatrix3:()=>g.conversionMatrix3,createStereoViewer:()=>w.createStereoViewer,createViewer:()=>w.createViewer,createViewerGrid:()=>w.createViewerGrid,deepCopy:()=>p.deepCopy,degToRad:()=>g.degToRad,download:()=>p.download,drawCartoon:()=>s.drawCartoon,elementColors:()=>c.elementColors,extend:()=>p.extend,get:()=>p.get,getAtomProperty:()=>p.getAtomProperty,getColorFromStyle:()=>p.getColorFromStyle,getElement:()=>p.getElement,getExtent:()=>p.getExtent,getGradient:()=>o.getGradient,getPropertyRange:()=>p.getPropertyRange,getbin:()=>p.getbin,htmlColors:()=>c.htmlColors,inflateString:()=>p.inflateString,isEmptyObject:()=>p.isEmptyObject,isNumeric:()=>p.isNumeric,makeFunction:()=>p.makeFunction,mergeGeos:()=>p.mergeGeos,normalizeValue:()=>o.normalizeValue,partialCharges:()=>v.partialCharges,processing_autoinit:()=>S.processing_autoinit,residues:()=>c.residues,setBondLength:()=>f.setBondLength,setSyncSurface:()=>E.setSyncSurface,specStringToObject:()=>p.specStringToObject,splitMesh:()=>z.splitMesh,ssColors:()=>c.ssColors,subdivide_spline:()=>s.subdivide_spline,syncSurface:()=>E.syncSurface,viewers:()=>S.viewers});var o=t("./src/Gradient.ts"),c=t("./src/colors.ts"),u=t("./src/Label.ts"),v=t("./src/partialCharges.ts"),f=t("./src/parsers/index.ts"),g=t("./src/WebGL/math/index.ts"),_=t("./src/WebGL/shapes/index.ts"),p=t("./src/utilities.ts"),E=t("./src/ProteinSurface4.ts"),k=t("./src/VolumeData.ts"),A=t("./src/VolumetricRender.ts"),z=t("./src/GLShape.ts"),l=t("./src/GLDraw.ts"),s=t("./src/glcartoon.ts"),y=t("./src/GLModel.ts"),w=t("./src/GLViewer.ts"),S=t("./src/autoload.ts");t("./src/specs.ts"),window&&(window.$3Dmol=r)}),"./src/parsers/BCIF.ts":((e,r,t)=>{t.r(r),t.d(r,{BCIF:()=>z});var o=t("./src/utilities.ts"),c=t("./src/parsers/utils/computeSecondaryStructure.ts"),u=t("./src/parsers/utils/processSymmetries.ts"),v=t("./src/parsers/cifutils/category.ts"),f=t("./src/parsers/utils/assignPDBBonds.ts"),g=t("./src/WebGL/index.ts"),_=t("./src/parsers/utils/isEmpty.ts"),p=t("./src/vendor/mmtf.js");class E{constructor(s){if(this.C={},s){let y=s.getField("comp_id"),w=s.getField("atom_id_1"),S=s.getField("atom_id_2"),C=s.getField("value_order");for(let h=0;h<y.length;h++){let x=y[h],R=w[h],M=S[h],P=C[h],D=1;P=="doub"?D=2:P=="trip"&&(D=3),this.C[x]==null&&(this.C[x]={}),this.C[x][R]==null&&(this.C[x][R]={}),this.C[x][M]==null&&(this.C[x][M]={}),this.C[x][R][M]=D,this.C[x][M][R]=D}}}order(s,y,w){return this.C[s]!==void 0&&this.C[s][y]!==void 0&&this.C[s][y][w]!==void 0?this.C[s][y][w]:0}}class k{constructor(s){if(this.C=[],s){let y=s.getField("conn_type_id"),w=s.getField("ptnr1_label_asym_id"),S=s.getField("ptnr1_label_seq_id"),C=s.getField("ptnr1_label_comp_id"),h=s.getField("ptnr1_label_atom_id"),x=s.getField("ptnr2_label_asym_id"),R=s.getField("ptnr2_label_seq_id"),M=s.getField("ptnr2_label_comp_id"),P=s.getField("ptnr2_label_atom_id"),D=s.getField("pdbx_value_order");for(let L=0;L<y.length;L++)if(y[L]=="disulf"||y[L]=="covale"){let X=D?D[L]==""?1:parseInt(D[L]):1;this.C.push([[w[L],S[L],C[L],h[L]],[x[L],R[L],M[L],P[L]],X])}}}}class A{constructor(){this.R={}}add(s){this.R[s.lchain]==null&&(this.R[s.lchain]={}),this.R[s.lchain][s.lresi]==null&&(this.R[s.lchain][s.lresi]={}),this.R[s.lchain][s.lresi][s.lresn]==null&&(this.R[s.lchain][s.lresi][s.lresn]=[]),this.R[s.lchain][s.lresi][s.lresn].push(s),this.R[s.lchain][s.lresi][s.lresn][s.atom]=s}geta([s,y,w,S]){if(this.R[s]!==void 0&&this.R[s][y]!==void 0&&this.R[s][y][w]!==void 0)return this.R[s][y][w][S]}setBonds(s,y){for(let w in this.R)for(let S in this.R[w])for(let C in this.R[w][S]){let h=this.R[w][S][C];for(let x=0;x<h.length;x++)for(let R=x+1;R<h.length;R++){let M=h[x],P=h[R],D=s.order(C,M.atom,P.atom);D>0&&(M.bonds.push(P.index),P.bonds.push(M.index),M.bondOrder.push(D),P.bondOrder.push(D))}}for(let w of y.C){let S=w[0],C=w[1],h=w[2],x=this.geta(S),R=this.geta(C);x!=null&&R!=null&&(x.bonds.push(R.index),R.bonds.push(x.index),x.bondOrder.push(h),R.bondOrder.push(h))}}}function z(l,s){var y=!s.keepH,w=s.altLoc?s.altLoc:"A",S=!s.noComputeSecondaryStructure;const C=!s.doAssembly,h=s.assignBonds===void 0?!0:s.assignBonds;if(typeof l=="string")try{l=(0,o.base64ToArray)(l)}catch{l=new TextEncoder().encode(l)}else l=new Uint8Array(l);var x=p.decodeMsgpack(l);x==31&&(l=(0,o.inflateString)(l,!1),x=p.decodeMsgpack(l));var R=[],M=R.modelData=[],P=x.dataBlocks.length;if(P==0)return R;s.multimodel||(P=1);for(let D=0;D<P;D++){let L=R.length;const X=[];M.push({symmetries:[]}),R.push([]);const B=x.dataBlocks[D],j=Object.create(null);for(const At of B.categories)j[At.name.substr(1)]=(0,v.Category)(At);let H={},$=j.struct_conf;if($){let At=$.getField("conf_type_id"),Mt=$.getField("beg_label_asym_id"),Jr=$.getField("beg_label_seq_id"),Yr=$.getField("end_label_seq_id");for(let ie=0;ie<At.length;ie++)if(At[ie].startsWith("H")){let ve=Mt[ie],we=Jr[ie],it=Yr[ie];ve in H||(H[ve]={}),H[ve][we]="h1";for(let rt=we+1;rt<it;rt++)H[ve][rt]="h";H[ve][it]="h2"}}let q=j.struct_sheet_range;if(q){let At=q.getField("id"),Mt=q.getField("beg_label_asym_id"),Jr=q.getField("beg_label_seq_id"),Yr=q.getField("end_label_seq_id");for(let ie=0;ie<At.length;ie++){let ve=Mt[ie],we=Jr[ie],it=Yr[ie];ve in H||(H[ve]={}),H[ve][we]="s1";for(let rt=we+1;rt<it;rt++)H[ve][rt]="s";H[ve][it]="s2"}}let W=j.pdbx_struct_oper_list,Y=W.getField("id");if(Y&&!C){let At=W.getField("matrix[1][1]"),Mt=W.getField("matrix[1][2]"),Jr=W.getField("matrix[1][3]"),Yr=W.getField("matrix[2][1]"),ie=W.getField("matrix[2][2]"),ve=W.getField("matrix[2][3]"),we=W.getField("matrix[3][1]"),it=W.getField("matrix[3][2]"),rt=W.getField("matrix[3][3]"),Yt=W.getField("vector[1]"),Ft=W.getField("vector[2]"),re=W.getField("vector[3]");for(let tt=0;tt<Y.length;tt++){const lt=new g.Matrix4(At[tt],Mt[tt],Jr[tt],Yt[tt],Yr[tt],ie[tt],ve[tt],Ft[tt],we[tt],it[tt],rt[tt],re[tt]);M[M.length-1].symmetries.push(lt)}}let G=new E(j.chem_comp_bond),V=new A,Z=new k(j.struct_conn),xe=j.atom_site,ce=xe.rowCount,Ne=xe.getField("group_PDB"),Pe=xe.getField("Cartn_x"),De=xe.getField("Cartn_y"),Me=xe.getField("Cartn_z"),Be=xe.getField("auth_asym_id"),ft=xe.getField("label_asym_id"),jt=xe.getField("auth_seq_id"),Gt=xe.getField("label_seq_id"),mt=xe.getField("auth_comp_id"),Fe=xe.getField("label_comp_id"),ht=xe.getField("auth_atom_id"),Kt=xe.getField("label_atom_id"),Jt=xe.getField("type_symbol"),Wt=xe.getField("B_iso_or_equiv"),Br=xe.getField("id"),zr=xe.getField("label_alt_id"),cr=xe.getField("pdbx_PDB_model_num"),Nr=cr?cr[0]:0;for(let At=0;At<ce;At++){if(Ne!==void 0&&Ne[At]==="TER")continue;if(cr&&cr[At]!=Nr)if(Nr=cr[At],s.multimodel)s.onemol||(R.push([]),M.push(M[M.length-1]),Nr=cr[At],V.setBonds(G,Z),V=new A);else break;const Mt={};Mt.x=Pe[At],Mt.y=De[At],Mt.z=Me[At],Mt.chain=Be?Be[At]:ft?ft[At]:void 0,Mt.lchain=ft?ft[At]:void 0,Mt.resi=jt?jt[At]:Gt?Gt[At]:void 0,Mt.lresi=Gt?Gt[At]:void 0,Mt.resn=mt?mt[At].trim():Fe?Fe[At].trim():void 0,Mt.lresn=Fe?Fe[At].trim():void 0,Mt.atom=ht?ht[At].replace(/"/gm,""):Kt?Kt[At].replace(/"/gm,""):void 0,Mt.icode=zr?zr[At]:void 0,Mt.altLoc=Mt.icode,Mt.hetflag=!Ne||Ne[At]==="HETA"||Ne[At]==="HETATM";let Jr="X";Jt&&(Jr=Jt[At].replace(/\(?\+?\d+.*/,"")),Mt.elem=Jr[0].toUpperCase()+Jr.substring(1,2).toLowerCase(),Wt&&(Mt.b=Wt[At]),!(y&&Mt.elem=="H")&&(Mt.altLoc!=""&&Mt.altLoc!=w&&w!="*"||(Mt.bonds=[],Mt.ss="c",Mt.serial=Br[At],Mt.model=Nr,Mt.bondOrder=[],Mt.properties={},Mt.index=R[R.length-1].length,X[Mt.serial]=[R.length,Mt.index],R[R.length-1].push(Mt),V.add(Mt)))}if(V.setBonds(G,Z),!(0,_.isEmpty)(H))for(let At=L;At<R.length;At++){let Mt=R[At];for(let Jr=0;Jr<Mt.length;Jr++){const Yr=Mt[Jr];if(Yr!==void 0&&Yr.lchain in H&&Yr.lresi in H[Yr.lchain]){const ie=H[Yr.lchain][Yr.lresi];Yr.ss=ie[0],ie.length>1&&(ie[1]=="1"?Yr.ssbegin=!0:ie[1]=="2"&&(Yr.ssend=!0))}}}s.multimodel&&D<P-1&&(s.onemol||(R.push([]),M.push({symmetries:[]})))}for(let D=0;D<R.length;D++)h&&!(s.duplicateAssemblyAtoms&&!s.dontConnectDuplicatedAtoms)&&(0,f.assignPDBBonds)(R[D],s),S&&(0,c.computeSecondaryStructure)(R[D],s.hbondCutoff),(0,u.processSymmetries)(M[D].symmetries,R[D],s,M[D].cryst),s.duplicateAssemblyAtoms&&!s.dontConnectDuplicatedAtoms&&h&&(0,f.assignPDBBonds)(R[D],s);return R}}),"./src/parsers/CDJSON.ts":((e,r,t)=>{t.r(r),t.d(r,{CDJSON:()=>o});function o(c,u){var v=[[]];typeof c=="string"&&(c=JSON.parse(c));for(var f=c.m,g=f[0].a,_=f[0].b,p=f[0].s,E=u!==void 0&&u.parseStyle!==void 0?u.parseStyle:p!==void 0,k=v[v.length-1].length,A=0;A<g.length;A++){var z=g[A],l={};l.id=z.i,l.x=z.x,l.y=z.y,l.z=z.z||0,l.bonds=[],l.bondOrder=[];var s=z.l||"C";l.elem=s[0].toUpperCase()+s.substring(1).toLowerCase(),l.serial=v[v.length-1].length,E&&(l.style=p[z.s||0]),v[v.length-1].push(l)}for(let y=0;y<_.length;y++){let w=_[y],S=w.b+k,C=w.e+k,h=w.o||1,x=v[v.length-1][S],R=v[v.length-1][C];x.bonds.push(C),x.bondOrder.push(h),R.bonds.push(S),R.bondOrder.push(h)}return v}}),"./src/parsers/CIF.ts":((e,r,t)=>{t.r(r),t.d(r,{CIF:()=>g});var o=t("./src/parsers/utils/computeSecondaryStructure.ts"),c=t("./src/parsers/utils/processSymmetries.ts"),u=t("./src/WebGL/index.ts"),v=t("./src/parsers/utils/assignPDBBonds.ts");const f=function(_,p,E,k){return new u.Vector3(p,E,k).applyMatrix3(_)};function g(_,p={}){const E=[],k=!p.doAssembly,A=E.modelData=[],z=p.assignBonds===void 0?!0:p.assignBonds;function l(h,x){const R=[];let M=0,P=0;for(;P<h.length;){for(;h.substring(P,P+x.length)!==x&&P<h.length;)if(h[P]==="'"){for(P++;P<h.length&&h[P]!=="'";)P++;for(;h.substring(P,P+x.length)!==x&&P<h.length;)P++}else if(h[P]==='"'){for(P++;P<h.length&&h[P]!=='"';)P++;P++}else P++;R.push(h.substring(M,P)),M=P=P+x.length}return R}const s=_.split(/\r?\n|\r/),y=[];let w=!1;for(let h=0;h<s.length;h++){var S=s[h].split("#")[0];if(w?S[0]===";"&&(w=!1):S[0]===";"&&(w=!0),w||S!==""){if(!w&&(S=S.trim(),S[0]==="_")){const x=S.split(/\s/)[0].indexOf(".");if(x>-1){let R=S.split("");R[x]="_",S=R.join(""),S=S.substring(0,x)+"_"+S.substring(x+1)}}y.push(S)}}let C=0;for(;C<y.length;){for(;!y[C].startsWith("data_")||y[C]==="data_global";)C++;C++;const h={};for(;C<y.length&&!y[C].startsWith("data_");)if(y[C][0]===void 0)C++;else if(y[C][0]==="_"){const P=y[C].split(/\s/)[0].toLowerCase(),D=h[P]=h[P]||[],L=y[C].substring(y[C].indexOf(P)+P.length);if(L==="")if(C++,y[C][0]===";"){let X=y[C].substring(1);for(C++;y[C]!==";";)X=X+`
`+y[C],C++;D.push(X)}else D.push(y[C]);else D.push(L.trim());C++}else if(y[C].substring(0,5)==="loop_"){C++;const P=[];for(;y[C]===""||y[C][0]==="_";){if(y[C]!==""){let L=y[C].split(/\s/)[0].toLowerCase(),X=h[L]=h[L]||[];P.push(X)}C++}let D=0;for(;C<y.length&&y[C][0]!=="_"&&!y[C].startsWith("loop_")&&!y[C].startsWith("data_");){let L=l(y[C]," ");for(let X=0;X<L.length;X++)L[X]!==""&&(P[D].push(L[X]),D=(D+1)%P.length);C++}}else C++;A.push({symmetries:[]}),E.push([]);const x=h._atom_site_id!==void 0?h._atom_site_id.length:h._atom_site_label.length;let R;if(h._cell_length_a!==void 0){const P=parseFloat(h._cell_length_a),D=parseFloat(h._cell_length_b),L=parseFloat(h._cell_length_c),X=parseFloat(h._cell_angle_alpha)||90,B=parseFloat(h._cell_angle_beta)||90,j=parseFloat(h._cell_angle_gamma)||90;R=(0,u.conversionMatrix3)(P,D,L,X,B,j),A[A.length-1].cryst={a:P,b:D,c:L,alpha:X,beta:B,gamma:j}}for(let P=0;P<x;P++){if(h._atom_site_group_pdb!==void 0&&h._atom_site_group_pdb[P]==="TER")continue;const D={};if(h._atom_site_cartn_x!==void 0)D.x=parseFloat(h._atom_site_cartn_x[P]),D.y=parseFloat(h._atom_site_cartn_y[P]),D.z=parseFloat(h._atom_site_cartn_z[P]);else{const X=f(R,parseFloat(h._atom_site_fract_x[P]),parseFloat(h._atom_site_fract_y[P]),parseFloat(h._atom_site_fract_z[P]));D.x=X.x,D.y=X.y,D.z=X.z}D.chain=h._atom_site_auth_asym_id?h._atom_site_auth_asym_id[P]:h._atom_site_label_asym_id?h._atom_site_label_asym_id[P]:void 0,D.resi=h._atom_site_auth_seq_id?parseInt(h._atom_site_auth_seq_id[P]):h._atom_site_label_seq_id?h._atom_site_label_seq_id[P]:void 0,D.resn=h._atom_site_auth_comp_id?h._atom_site_auth_comp_id[P].trim():h._atom_site_label_comp_id?h._atom_site_label_comp_id[P].trim():void 0,D.atom=h._atom_site_auth_atom_id?h._atom_site_auth_atom_id[P].replace(/"/gm,""):h._atom_site_label_atom_id?h._atom_site_label_atom_id[P].replace(/"/gm,""):void 0,D.hetflag=!h._atom_site_group_pdb||h._atom_site_group_pdb[P]==="HETA"||h._atom_site_group_pdb[P]==="HETATM",h._atom_site_b_iso_or_equiv&&(D.b=parseFloat(h._atom_site_b_iso_or_equiv[P]));let L="X";h._atom_site_type_symbol?L=h._atom_site_type_symbol[P].replace(/\(?\+?\d+.*/,""):h._atom_site_label&&(L=h._atom_site_label[P].split("_")[0].replace(/\(?\d+.*/,"")),D.elem=L[0].toUpperCase()+L.substring(1,2).toLowerCase(),D.bonds=[],D.ss="c",D.serial=P,D.bondOrder=[],D.properties={},E[E.length-1].push(D)}if(h._pdbx_struct_oper_list_id!==void 0&&!k)for(let P=0;P<h._pdbx_struct_oper_list_id.length;P++){const D=parseFloat(h["_pdbx_struct_oper_list_matrix[1][1]"][P]),L=parseFloat(h["_pdbx_struct_oper_list_matrix[1][2]"][P]),X=parseFloat(h["_pdbx_struct_oper_list_matrix[1][3]"][P]),B=parseFloat(h["_pdbx_struct_oper_list_vector[1]"][P]),j=parseFloat(h["_pdbx_struct_oper_list_matrix[2][1]"][P]),H=parseFloat(h["_pdbx_struct_oper_list_matrix[2][2]"][P]),$=parseFloat(h["_pdbx_struct_oper_list_matrix[2][3]"][P]),q=parseFloat(h["_pdbx_struct_oper_list_vector[2]"][P]),W=parseFloat(h["_pdbx_struct_oper_list_matrix[3][1]"][P]),Y=parseFloat(h["_pdbx_struct_oper_list_matrix[3][2]"][P]),G=parseFloat(h["_pdbx_struct_oper_list_matrix[3][3]"][P]),V=parseFloat(h["_pdbx_struct_oper_list_vector[3]"][P]),Z=new u.Matrix4(D,L,X,B,j,H,$,q,W,Y,G,V);A[A.length-1].symmetries.push(Z)}const M=function(P){const D=P.match("-");P=P.replace(/[-xyz]/g,"");const L=P.split("/");let X,B;return L[1]===void 0?B=1:B=parseInt(L[1]),L[0]===""?X=1:X=parseInt(L[0]),X/B*(D?-1:1)};if(h._symmetry_equiv_pos_as_xyz!==void 0&&!k)for(let P=0;P<h._symmetry_equiv_pos_as_xyz.length;P++){const D=h._symmetry_equiv_pos_as_xyz[P].replace(/["' ]/g,"").split(",").map(function(j){return j.replace(/-/g,"+-")});let L=new u.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let j=0;j<3;j++){const H=D[j].split("+");for(let $=0;$<H.length;$++){const q=H[$];if(q==="")continue;const W=M(q);q.match("x")?L.elements[j+0]=W:q.match("y")?L.elements[j+4]=W:q.match("z")?L.elements[j+8]=W:L.elements[j+12]=W}}const X=R.getMatrix4(),B=new u.Matrix4().getInverse(X,!0);L=new u.Matrix4().multiplyMatrices(L,B),L=new u.Matrix4().multiplyMatrices(X,L),A[A.length-1].symmetries.push(L)}}for(let h=0;h<E.length;h++)z&&!(p.duplicateAssemblyAtoms&&!p.dontConnectDuplicatedAtoms)&&(0,v.assignPDBBonds)(E[h],p),(0,o.computeSecondaryStructure)(E[h],p.hbondCutoff),(0,c.processSymmetries)(A[h].symmetries,E[h],p,A[h].cryst),p.duplicateAssemblyAtoms&&!p.dontConnectDuplicatedAtoms&&z&&(0,v.assignPDBBonds)(E[h],p);return E}}),"./src/parsers/CUBE.ts":((e,r,t)=>{t.r(r),t.d(r,{CUBE:()=>v});var o=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/assignBonds.ts"),u=t("./src/parsers/utils/anumToSymbol.ts");function v(f,g){g=g||{};const _=[[]];let p=f.split(/\r?\n/);const E=g.assignBonds===void 0?!0:g.assignBonds;if(p.length<6)return _;let k=p[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const A=Math.abs(parseFloat(k[0]));let z={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const l=z.origin=new o.Vector3(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3]));k=p[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),k=p[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const s=k[0]>0?.529177:1;l.multiplyScalar(s);const y=Math.abs(k[0]),w=new o.Vector3(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])).multiplyScalar(s);k=p[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const S=Math.abs(k[0]),C=new o.Vector3(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])).multiplyScalar(s);k=p[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const h=Math.abs(k[0]),x=new o.Vector3(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])).multiplyScalar(s);if(z.size={x:y,y:S,z:h},z.unit=new o.Vector3(w.x,C.y,x.z),w.y!=0||w.z!=0||C.x!=0||C.z!=0||x.x!=0||x.y!=0){z.matrix4=new o.Matrix4(w.x,C.x,x.x,0,w.y,C.y,x.y,0,w.z,C.z,x.z,0,0,0,0,1);let B=new o.Matrix4().makeTranslation(l.x,l.y,l.z);z.matrix4=z.matrix4.multiplyMatrices(B,z.matrix4),z.matrix=z.matrix4.matrix3FromTopLeft(),z.origin=new o.Vector3(0,0,0),z.unit=new o.Vector3(1,1,1)}_.modelData=[{cryst:z}],p=p.splice(6,A);for(var R=_[_.length-1].length,M=R+p.length,P=R;P<M;++P){var D={};D.serial=P;var L=p[P-R],X=L.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");D.elem=u.anumToSymbol[X[0]],D.x=parseFloat(X[2])*s,D.y=parseFloat(X[3])*s,D.z=parseFloat(X[4])*s,D.hetflag=!0,D.bonds=[],D.bondOrder=[],D.properties={},_[_.length-1].push(D)}if(E)for(let B=0;B<_.length;B++)(0,c.assignBonds)(_[B],g);return _}}),"./src/parsers/GRO.ts":((e,r,t)=>{t.r(r),t.d(r,{GRO:()=>u});var o=t("./src/parsers/utils/assignPDBBonds.ts"),c=t("./src/parsers/utils/atomNameToElem.ts");function u(v,f){const g=[],_=v.split(/\r?\n|\r/);for(;_.length>0;){const p=parseInt(_[1]);if(_.length<3||isNaN(p)||p<=0||_.length<p+3)break;const E=[];g.push(E);let k=2;const A=E.length,z=A+p;for(let l=A;l<z;l++){const s=_[k++],y={};y.serial=l,y.atom=s.slice(10,15).trim(),y.elem=(0,c.atomNameToElem)(y.atom,!0),y.x=10*parseFloat(s.slice(20,28)),y.y=10*parseFloat(s.slice(28,36)),y.z=10*parseFloat(s.slice(36,44)),y.resi=parseInt(s.slice(0,5)),y.resn=s.slice(5,10).trim(),y.bonds=[],y.bondOrder=[],y.properties={},s.length>44&&(y.dx=10*parseFloat(s.slice(44,52)),y.dy=10*parseFloat(s.slice(52,60)),y.dz=10*parseFloat(s.slice(60,68))),E[l]=y}if(_.length<=k+3){const l=_[k++].trim().split(/\s+/);if(l.length===3){for(let s=0;s<3;s++)l[s]=(parseFloat(l[s])*10).toString();g.box=l}}_.splice(0,++k)}for(let p=0;p<g.length;p++)(0,o.assignPDBBonds)(g[p],f);return g}}),"./src/parsers/LAMMPSTRJ.ts":((e,r,t)=>{t.r(r),t.d(r,{LAMMPSTRJ:()=>u});var o=t("./src/parsers/utils/assignBonds.ts");const c={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function u(v,f){const g=[],_=v.split(/\r?\n|\r/);let p=0,E=0,k=0;for(;k<_.length-9;){for(var A=k;A<_.length;A++)if(_[A].match(/ITEM: NUMBER OF ATOMS/)&&(E=parseInt(_[A+1])),_[A].match(/ITEM: ATOMS/)){p=A+1;break}const z=_[p-1].replace("ITEM: ATOMS ","").split(" ");g.push([]);for(let l=p;l<p+E;l++){const s={},y={},w=_[l].split(" ");for(let S=0;S<w.length;S++){const C=c[z[S]];C!==void 0&&(C==="serial"?s[C]=parseInt(w[S]):C==="x"||C==="y"||C==="z"?s[C]=parseFloat(w[S]):C==="charge"||C==="radius"?y[C]=parseFloat(w[S]):s[C]=w[S]),s.properties=y,s.bonds=[],s.bondOrder=[]}g[g.length-1][l-p]=s}k=p+E-1}if(f.assignBonds)for(let z=0;z<g.length;z++)(0,o.assignBonds)(g[z],f);return g}}),"./src/parsers/MMTF.ts":((e,r,t)=>{t.r(r),t.d(r,{MMTFparser:()=>E});var o=t("./src/utilities.ts"),c=t("./src/WebGL/index.ts"),u=t("./src/parsers/utils/computeSecondaryStructure.ts"),v=t("./src/parsers/utils/processSymmetries.ts"),f=t("./src/vendor/mmtf.js"),g=function(k){return String.fromCharCode.apply(null,k).replace(/\0/g,"")},_=function(k){return k==0||k==2||k==4?"h":k==3?"s":"c"};let p=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function E(k,A){var z=!A.keepH,l=A.altLoc?A.altLoc:"A",s=!!A.noSecondaryStructure,y=!A.noComputeSecondaryStructure,w=!A.doAssembly,S=A.assemblyIndex?A.assemblyIndex:0;typeof k=="string"?k=(0,o.base64ToArray)(k):k=new Uint8Array(k);var C=f.decode(k),h=[[]],x=h.modelData=[],R=0,M=0,P=0,D=C.secStructList,L=C.bFactorList,X=C.altLocList,B=C.occupancyList,j=C.bondAtomList,H=C.bondOrderList,$=C.numModels;if($==0)return h;A.multimodel||($=1);var q,W,Y,G,V,Z,xe=[];if(!w&&C.bioAssemblyList&&C.bioAssemblyList.length>0){var ce=C.bioAssemblyList[S].transformList;for(q=0,Z=ce.length;q<Z;q++){var Ne=new c.Matrix4(ce[q].matrix);Ne.transpose(),xe.push(Ne)}}var Pe=null;if(C.unitCell){var De=C.unitCell;Pe={a:De[0],b:De[1],c:De[2],alpha:De[3],beta:De[4],gamma:De[5]}}let Me=[];C.entityList.forEach(at=>{at.chainIndexList.forEach(me=>{Me[me]=at.type=="polymer"})});var Be=0;for(V=0;V<$;V++){var ft=C.chainsPerModel[V],jt=h[h.length-1],Gt=[];for(x.push({symmetries:xe,cryst:Pe}),q=0;q<ft;++q){var mt=C.groupsPerChain[R],Fe=g(C.chainIdList.subarray(R*4,R*4+4));C.chainNameList&&(Fe=g(C.chainNameList.subarray(R*4,R*4+4)));var ht=M,Kt="";for(W=0;W<mt;++W){var Jt=C.groupList[C.groupTypeList[M]],Wt=Jt.atomNameList.length,Br=0,zr=!1,cr=!1;if(D){Br=D[M];var Nr=_(Br);(M==0||Nr!=Kt)&&(zr=!0),Kt=Nr;var At=M+1;(At>=D.length||_(D[At]!=Nr))&&(cr=!0)}var Mt=C.groupIdList[M],Jr=Jt.groupName;let at=Jt.chemCompType;var Yr=P;let me=p.has(at)||!Me[R];for(Y=0;Y<Wt;++Y){var ie=Jt.elementList[Y];if(z&&ie=="H"){P+=1;continue}var ve="";L&&(ve=L[P]);var we="";X&&X[P]&&(we=String.fromCharCode(X[P]));var it="";if(B&&(it=B[P]),we!=""&&we!=l&&l!="*"){P+=1;continue}var rt=C.atomIdList[P],Yt=Jt.atomNameList[Y],Ft=0;Jt.atomChargeList&&(Ft=Jt.atomChargeList[Y]);var re=C.xCoordList[P],tt=C.yCoordList[P],lt=C.zCoordList[P];Gt[P]=jt.length,jt.push({resn:Jr,x:re,y:tt,z:lt,elem:ie,hetflag:me,chain:Fe,resi:Mt,icode:we,rescode:Mt+(we!=" "?"^"+we:""),serial:rt,altLoc:we,index:P,atom:Yt,bonds:[],ss:_(Br),ssbegin:zr,ssend:cr,bondOrder:[],properties:{charge:Ft,occupancy:it},b:ve}),P+=1}var ar=Jt.bondAtomList;for(Y=0,G=Jt.bondOrderList.length;Y<G;++Y){var et=Yr+ar[Y*2],Ot=Yr+ar[Y*2+1],se=Jt.bondOrderList[Y],xt=Gt[et],Vr=Gt[Ot],J=jt[xt],ut=jt[Vr];J&&ut&&(J.bonds.push(Vr),J.bondOrder.push(se),ut.bonds.push(xt),ut.bondOrder.push(se))}M+=1}for(M=ht,W=0;W<mt;++W)M+=1;R+=1}if(j)for(let at=Be,me=j.length;at<me;at+=2){let Ze=j[at],vt=j[at+1],Qr=H?H[at/2]:1;if(Ze>=P){Be=at;break}let Xr=Gt[Ze],Zr=Gt[vt],xn=jt[Xr],Ei=jt[Zr];xn&&Ei&&(xn.bonds.push(Zr),xn.bondOrder.push(Qr),Ei.bonds.push(Xr),Ei.bondOrder.push(Qr))}A.multimodel&&(A.onemol||h.push([]))}if(!w)for(let at=0;at<h.length;at++)(0,v.processSymmetries)(x[at].symmetries,h[at],A,x[at].cryst);return y&&!s&&(0,u.computeSecondaryStructure)(h,A.hbondCutoff),h}}),"./src/parsers/MOL2.ts":((e,r,t)=>{t.r(r),t.d(r,{MOL2:()=>c});let o={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function c(u,v){var f=[[]],g=!1;typeof v.keepH<"u"&&(g=!v.keepH);var _=u.search(/@<TRIPOS>MOLECULE/),p=u.search(/@<TRIPOS>ATOM/);if(_==-1||p==-1)return f;for(var E=u.substring(_).split(/\r?\n|\r/);E.length>0;){var k=[],A=E[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),z=parseInt(A[0]),l=0;A.length>1&&(l=parseInt(A[1]));var s=4,y;for(y=3;y<E.length;y++)if(E[y]=="@<TRIPOS>ATOM"){s=y+1;break}var w=f[f.length-1].length,S=w+z,C;for(y=w;y<S;y++){C=E[s++],A=C.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var h={},x=A[5];if(o[x]!==void 0?x=o[x]:(x=x.split(".")[0],x=x[0].toUpperCase()+x.substring(1).toLowerCase()),h.atom=A[1],h.elem=x,!(h.elem=="H"&&g)){var R=f[f.length-1].length,M=parseInt(A[0]);h.serial=M,h.x=parseFloat(A[2]),h.y=parseFloat(A[3]),h.z=parseFloat(A[4]),h.atom=A[5];var P=parseFloat(A[8]);h.index=R,h.bonds=[],h.bondOrder=[],h.properties={charge:P,partialCharge:P},k[M]=R,f[f.length-1].push(h)}}for(var D=!1;s<E.length;)if(E[s++]=="@<TRIPOS>BOND"){D=!0;break}if(D&&l)for(y=0;y<l;y++){C=E[s++],A=C.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var L=parseInt(A[1]),X=f[f.length-1][k[L]],B=parseInt(A[2]),j=f[f.length-1][k[B]],H=parseInt(A[3]);isNaN(H)&&(H=1),X!==void 0&&j!==void 0&&(X.bonds.push(k[B]),X.bondOrder.push(H),j.bonds.push(k[L]),j.bondOrder.push(H))}if(v.multimodel){v.onemol||f.push([]),E.splice(0,s),u=E.join(`
`);continue}else break}return f}}),"./src/parsers/PDB.ts":((e,r,t)=>{t.r(r),t.d(r,{PDB:()=>c});var o=t("./src/parsers/utils/getSinglePDB.ts");function c(u,v){v=v||{};var f=[],g={};f.modelData=[];for(var _=u.split(/\r?\n|\r/);_.length>0;){var p=(0,o.getSinglePDB)(_,v,g),E=p[0],k=p[1];if(_=p[2],E.length!=0){if(v.multimodel&&v.onemol&&f.length>0)for(var A=f[0].length,z=0;z<E.length;z++){var l=E[z];l.index=z;for(var s=0;s<l.bonds.length;s++)l.bonds[s]+=A;f[0].push(l)}else f.modelData.push(k),f.push(E);if(!v.multimodel)break}}return f}}),"./src/parsers/PQR.ts":((e,r,t)=>{t.r(r),t.d(r,{PQR:()=>u});var o=t("./src/parsers/utils/assignPDBBonds.ts"),c=t("./src/parsers/utils/computeSecondaryStructure.ts");function u(v,f){var g=[[]],_=!f.noSecondaryStructure;g.modelData=[{symmetries:[]}];var p=[],E=v.split(/\r?\n|\r/),k;for(let D=0;D<E.length;D++){k=E[D].replace(/^\s*/,"");var A=k.substring(0,6);if(A.indexOf("END")==0)if(f.multimodel){f.onemol||g.push([]);continue}else break;else if(A=="ATOM  "||A=="HETATM"){var z;let L=parseInt(k.substring(6,11)),X=k.substring(12,16).replace(/ /g,""),B=k.substring(17,20).trim(),j=k.substring(21,22),H=parseInt(k.substring(22,26));var l=k.substring(30).trim().split(/\s+/),s=parseFloat(l[0]),y=parseFloat(l[1]),w=parseFloat(l[2]),S=parseFloat(l[3]),C=parseFloat(l[4]),h=X[0];X.length>1&&X[1].toUpperCase()!=X[1]&&(h=X.substring(0,2)),k[0]=="H"?z=!0:z=!1,p[L]=g[g.length-1].length,g[g.length-1].push({resn:B,x:s,y,z:w,elem:h,hetflag:z,chain:j,resi:H,serial:L,atom:X,bonds:[],ss:"c",bondOrder:[],properties:{charge:S,partialCharge:S,radius:C},pdbline:k})}else if(A=="CONECT"){var x=parseInt(k.substring(6,11)),R=g[g.length-1][p[x]];for(let L=0;L<4;L++){var M=parseInt(k.substring([11,16,21,26][L],[11,16,21,26][L]+5)),P=g[g.length-1][p[M]];R!==void 0&&P!==void 0&&(R.bonds.push(p[M]),R.bondOrder.push(1))}}}for(let D=0;D<g.length;D++)(0,o.assignPDBBonds)(g[D],f),_&&(0,c.computeSecondaryStructure)(g[D],f.hbondCutoff);return g}}),"./src/parsers/PRMTOP.ts":((e,r,t)=>{t.r(r),t.d(r,{PRMTOP:()=>o});function o(c){var u=[],v,f=0,g=c.split(/\r?\n|\r/);if(g.length>0&&g[0].includes("VERSION")){var _=g.filter(function(s){return s.includes("POINTERS")||s.includes("ATOM_NAME")||s.includes("CHARGE")||s.includes("RADII")||s.includes("BONDS_INC_HYDROGEN")||s.includes("BONDS_WITHOUT_HYDROGEN")}),p=z("POINTERS");if(p==-1)return[];var E=l(p),k=parseInt(g[p+1].slice(0,E[1]));if(isNaN(k)||k<=0)return[];if(p=z("ATOM_NAME"),p==-1)return[];E=l(p);var A=E[0];for(let s=0;s<k/E[0];s++){s==parseInt(k/E[0])&&(A=k%E[0]);for(let y=0;y<A;y++){let w={},S={charge:"",radii:""};w.serial=f,w.x=0,w.y=0,w.z=0,w.atom=g[p+1].slice(E[1]*y,E[1]*(y+1)).trim(),w.elem=g[p+1].slice(E[1]*y,E[1]*y+1).trim(),w.properties=S,w.bonds=[],w.bondOrder=[],u.push(w),f++}p++}if(p=z("CHARGE"),p!=-1){E=l(p),f=0,A=E[0];for(let s=0;s<k/E[0];s++){s==parseInt(k/E[0])&&(A=k%E[0]);for(let y=0;y<A;y++)u[f].properties.charge=parseFloat(g[p+1].slice(E[1]*y,E[1]*(y+1))),f++;p++}}if(p=z("RADII"),p!=-1){E=l(p),f=0,A=E[0];for(let s=0;s<k/E[0];s++){s==parseInt(k/E[0])&&(A=k%E[0]);for(let y=0;y<A;y++)u[f].properties.radii=parseFloat(g[p+1].slice(E[1]*y,E[1]*(y+1))),f++;p++}}if(p=z("BONDS_WITHOUT_HYDROGEN"),p!=-1)for(E=l(p),f=0,A=E[0],p=p+1;!g[p].match(/^%FLAG/);){g[p+1].match(/^%FLAG/)&&(A=k%E[0]);for(let s=0;s<A;s++)f%3==0?v=parseInt(g[p].slice(E[1]*s,E[1]*(s+1))/3):f%3==1&&u[v].bonds.push(parseInt(g[p].slice(E[1]*s,E[1]*(s+1))/3)),f++;p++}if(p=z("BONDS_INC_HYDROGEN"),p!=-1)for(E=l(p),f=0,A=E[0],p=p+1;!g[p].match(/^%FLAG/);){g[p+1].match(/^%FLAG/)&&(A=k%E[0]);for(let s=0;s<A;s++)f%3==0?v=parseInt(g[p].slice(E[1]*s,E[1]*(s+1))/3):f%3==1&&u[v].bonds.push(parseInt(g[p].slice(E[1]*s,E[1]*(s+1))/3)),f++;p++}}else return[];function z(s){var y=g.indexOf(_.filter(function(w){return w.includes(s)})[0]);if(Number.isInteger(y)&&y>0){for(;!g[y].includes("FORMAT");)y++;return y}else return-1}function l(s){var y=g[s].match(/\((\d*)\S*/),w=g[s].match(/[a-zA-Z](\d*)\)\s*/);return w==null&&(w=g[s].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[y[1],w[1]]}return[u]}}),"./src/parsers/SDF.ts":((e,r,t)=>{t.r(r),t.d(r,{SDF:()=>u});var o=function(v,f){var g=[[]],_=!1;for(typeof f.keepH<"u"&&(_=!f.keepH);v.length>0&&!(v.length<4);){var p=parseInt(v[3].substring(0,3));if(isNaN(p)||p<=0)break;var E=parseInt(v[3].substring(3,6)),k=4;if(v.length<4+p+E)break;var A=[],z=g[g.length-1].length,l=z+p,s,y;for(s=z;s<l;s++,k++){y=v[k];var w={},S=y.substring(31,34).replace(/ /g,"");w.atom=w.elem=S[0].toUpperCase()+S.substring(1).toLowerCase(),(w.elem!=="H"||!_)&&(w.serial=s,A[s]=g[g.length-1].length,w.x=parseFloat(y.substring(0,10)),w.y=parseFloat(y.substring(10,20)),w.z=parseFloat(y.substring(20,30)),w.hetflag=!0,w.bonds=[],w.bondOrder=[],w.properties={},w.index=g[g.length-1].length,g[g.length-1].push(w))}for(s=0;s<E;s++,k++){y=v[k];var C=A[parseInt(y.substring(0,3))-1+z],h=A[parseInt(y.substring(3,6))-1+z],x=parseFloat(y.substring(6));typeof C<"u"&&typeof h<"u"&&(g[g.length-1][C].bonds.push(h),g[g.length-1][C].bondOrder.push(x),g[g.length-1][h].bonds.push(C),g[g.length-1][h].bondOrder.push(x))}if(f.multimodel){for(f.onemol||g.push([]);v[k]!=="$$$$"&&k<v.length;)k++;v.splice(0,++k)}else break}return g},c=function(v,f){var g=[[]],_=!1;for(typeof f.keepH<"u"&&(_=!f.keepH);v.length>0&&!(v.length<8||!v[4].startsWith("M  V30 BEGIN CTAB")||!v[5].startsWith("M  V30 COUNTS")||v[5].length<14);){var p=v[5].substring(13).match(/\S+/g);if(p.length<2)break;var E=parseInt(p[0]);if(isNaN(E)||E<=0)break;var k=parseInt(p[1]),A=7;if(v.length<8+E+k)break;var z=[],l=g[g.length-1].length,s=l+E,y,w;for(y=l;y<s;y++,A++){w=v[A];var S=w.substring(6).match(/\S+/g);if(S.length>4){var C={},h=S[1].replace(/ /g,"");C.atom=C.elem=h[0].toUpperCase()+h.substring(1).toLowerCase(),(C.elem!=="H"||!_)&&(C.serial=y,z[y]=g[g.length-1].length,C.x=parseFloat(S[2]),C.y=parseFloat(S[3]),C.z=parseFloat(S[4]),C.hetflag=!0,C.bonds=[],C.bondOrder=[],C.properties={},C.index=g[g.length-1].length,g[g.length-1].push(C))}}if(v[A]==="M  V30 END ATOM")A++;else break;if(k!==0&&v[A]==="M  V30 BEGIN BOND")A++;else break;for(y=0;y<k;y++,A++){w=v[A];var x=w.substring(6).match(/\S+/g);if(x.length>3){var R=z[parseInt(x[2])-1+l],M=z[parseInt(x[3])-1+l],P=parseFloat(x[1]);typeof R<"u"&&typeof M<"u"&&(g[g.length-1][R].bonds.push(M),g[g.length-1][R].bondOrder.push(P),g[g.length-1][M].bonds.push(R),g[g.length-1][M].bondOrder.push(P))}}if(f.multimodel){for(f.onemol||g.push([]);v[A]!=="$$$$"&&A<v.length;)A++;v.splice(0,++A)}else break}return g};function u(v,f){var g="V2000",_=v.split(/\r?\n|\r/);return _.length>3&&_[3].length>38&&(g=_[3].substring(34,39)),g==="V2000"?o(_,f):g==="V3000"?c(_,f):[[""]]}}),"./src/parsers/VASP.ts":((e,r,t)=>{t.r(r),t.d(r,{VASP:()=>u});var o=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/assignBonds.ts");function u(v,f={}){var g=[[]],_={};const p=f.assignBonds===void 0?!0:f.assignBonds;var E=v.replace(/^\s+/,"").split(/\r?\n/);if(E.length<3)return g;if(E[1].match(/\d+/))_.length=parseFloat(E[1]);else return console.log("Warning: second line of the vasp structure file must be a number"),g;if(_.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),g;_.xVec=new Float32Array(E[2].replace(/^\s+/,"").split(/\s+/)),_.yVec=new Float32Array(E[3].replace(/^\s+/,"").split(/\s+/)),_.zVec=new Float32Array(E[4].replace(/^\s+/,"").split(/\s+/));var k=new o.Matrix3(_.xVec[0],_.xVec[1],_.xVec[2],_.yVec[0],_.yVec[1],_.yVec[2],_.zVec[0],_.zVec[1],_.zVec[2]);k.multiplyScalar(_.length),g.modelData=[{symmetries:[],cryst:{matrix:k}}];var A=E[5].replace(/\s+/,"").replace(/\s+$/,"").split(/\s+/),z=new Int16Array(E[6].replace(/^\s+/,"").split(/\s+/)),l=E[7].replace(/\s+/,""),s=!1;if(l.match(/S/)&&(s=!0,l=E[8].replace(/\s+/,"")),l.match(/C/))l="cartesian";else if(l.match(/D/))l="direct";else return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),g;if(A.length!=z.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(A),console.log(z),g;s?E.splice(0,9):E.splice(0,8);for(var y=0,w=0,S=A.length;w<S;w++){for(var C=A[w],h=0,x=z[w];h<x;h++){var R=new Float32Array(E[y+h].replace(/^\s+/,"").split(/\s+/)),M={};M.elem=C,l=="cartesian"?(M.x=_.length*R[0],M.y=_.length*R[1],M.z=_.length*R[2]):(M.x=_.length*(R[0]*_.xVec[0]+R[1]*_.yVec[0]+R[2]*_.zVec[0]),M.y=_.length*(R[0]*_.xVec[1]+R[1]*_.yVec[1]+R[2]*_.zVec[1]),M.z=_.length*(R[0]*_.xVec[2]+R[1]*_.yVec[2]+R[2]*_.zVec[2])),M.bonds=[],M.bondOrder=[],g[0].push(M)}y+=z[w]}if(p)for(let P=0;P<g.length;P++)(0,c.assignBonds)(g[P],f);return g}}),"./src/parsers/XYZ.ts":((e,r,t)=>{t.r(r),t.d(r,{XYZ:()=>u});var o=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/assignBonds.ts");function u(v,f){f=f||{};for(var g=[[]],_=f.assignBonds===void 0?!0:f.assignBonds,p=v.split(/\r?\n|\r/);p.length>0&&!(p.length<3);){var E=parseInt(p[0]);if(isNaN(E)||E<=0||p.length<E+2)break;var k=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi,A=k.exec(p[1]);if(A!=null&&A.length>1){var z=new Float32Array(A[1].split(/\s+/)),l=new o.Matrix3(z[0],z[3],z[6],z[1],z[4],z[7],z[2],z[5],z[8]);g.modelData=[{cryst:{matrix:l}}]}for(var s=2,y=g[g.length-1].length,w=y+E,S=y;S<w;S++){var C=p[s++],h=C.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),x={};x.serial=S;var R=h[0];x.atom=x.elem=R[0].toUpperCase()+R.substring(1,2).toLowerCase(),x.x=parseFloat(h[1]),x.y=parseFloat(h[2]),x.z=parseFloat(h[3]),x.hetflag=!0,x.bonds=[],x.bondOrder=[],x.properties={},g[g.length-1][S]=x,h.length>=7&&(x.dx=parseFloat(h[4]),x.dy=parseFloat(h[5]),x.dz=parseFloat(h[6]))}if(f.multimodel)g.push([]),p.splice(0,s);else break}if(_)for(let P=0;P<g.length;P++)(0,c.assignBonds)(g[P],f);if(f.onemol){var M=g;g=[],g.push(M[0]);for(let P=1;P<M.length;P++){let D=g[0].length;for(let L=0;L<M[P].length;L++){let X=M[P][L];for(let B=0;B<X.bonds.length;B++)X.bonds[B]=X.bonds[B]+D;X.index=g[0].length,X.serial=g[0].length,g[0].push(X)}}}return g}}),"./src/parsers/cifutils/category.ts":((e,r,t)=>{t.r(r),t.d(r,{Category:()=>c});var o=t("./src/parsers/cifutils/decoder.ts");function c(u){const v=Object.create(null),f=Object.create(null);for(const g of u.columns)v[g.name]=g;return{rowCount:u.rowCount,name:u.name.substring(1),fieldNames:u.columns.map(g=>g.name),getField(g){const _=v[g];if(_)return f[g]||(f[g]=(0,o.decode)(_.data)),f[g]}}}}),"./src/parsers/cifutils/decoder.ts":((e,r,t)=>{t.r(r),t.d(r,{decode:()=>v});var o=t("./src/parsers/cifutils/encoding.ts");const c=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function u(D,L){const X=new ArrayBuffer(D.length),B=new Uint8Array(X);for(let j=0,H=D.length;j<H;j+=L)for(let $=0;$<L;$++)B[j+L-$-1]=D[j+$];return X}function v(D){let L=D.data;for(let X=D.encoding.length-1;X>=0;X--)L=f(L,D.encoding[X]);return L}function f(D,L){switch(L.kind){case"ByteArray":switch(L.type){case o.Encoding.IntDataType.Uint8:return D;case o.Encoding.IntDataType.Int8:return p(D);case o.Encoding.IntDataType.Int16:return k(D);case o.Encoding.IntDataType.Uint16:return A(D);case o.Encoding.IntDataType.Int32:return z(D);case o.Encoding.IntDataType.Uint32:return l(D);case o.Encoding.FloatDataType.Float32:return s(D);case o.Encoding.FloatDataType.Float64:return y(D);default:throw new Error("unreachable")}case"FixedPoint":return w(D,L);case"IntervalQuantization":return S(D,L);case"RunLength":return C(D,L);case"Delta":return h(D,L);case"IntegerPacking":return M(D,L);case"StringArray":return P(D,L)}}function g(D,L){switch(D){case o.Encoding.IntDataType.Int8:return new Int8Array(L);case o.Encoding.IntDataType.Int16:return new Int16Array(L);case o.Encoding.IntDataType.Int32:return new Int32Array(L);case o.Encoding.IntDataType.Uint8:return new Uint8Array(L);case o.Encoding.IntDataType.Uint16:return new Uint16Array(L);case o.Encoding.IntDataType.Uint32:return new Uint32Array(L);default:return new Int32Array(L)}}function _(D,L){switch(D){case o.Encoding.FloatDataType.Float32:return new Float32Array(L);case o.Encoding.FloatDataType.Float64:return new Float64Array(L);default:return new Float64Array(L)}}function p(D){return new Int8Array(D.buffer,D.byteOffset)}function E(D,L,X){return(D.byteOffset!=0||D.byteLength!=D.buffer.byteLength)&&(D=new Uint8Array(D)),c?new X(D.buffer):new X(u(D,L))}function k(D){return E(D,2,Int16Array)}function A(D){return E(D,2,Uint16Array)}function z(D){return E(D,4,Int32Array)}function l(D){return E(D,4,Uint32Array)}function s(D){return E(D,4,Float32Array)}function y(D){return E(D,8,Float64Array)}function w(D,L){const X=D.length,B=_(L.srcType,X),j=1/L.factor;for(let H=0;H<X;H++)B[H]=j*D[H];return B}function S(D,L){const X=D.length,B=_(L.srcType,X),j=(L.max-L.min)/(L.numSteps-1),H=L.min;for(let $=0;$<X;$++)B[$]=H+j*D[$];return B}function C(D,L){const X=g(L.srcType,L.srcSize);let B=0;for(let j=0,H=D.length;j<H;j+=2){const $=D[j],q=D[j+1];for(let W=0;W<q;++W)X[B++]=$}return X}function h(D,L){const X=D.length,B=g(L.srcType,X);if(!X)return D;B[0]=D[0]+(L.origin|0);for(let j=1;j<X;++j)B[j]=D[j]+B[j-1];return B}function x(D,L){const X=L.byteCount===1?127:32767,B=-X-1,j=D.length,H=new Int32Array(L.srcSize);let $=0,q=0;for(;$<j;){let W=0,Y=D[$];for(;Y===X||Y===B;)W+=Y,$++,Y=D[$];W+=Y,H[q]=W,$++,q++}return H}function R(D,L){const X=L.byteCount===1?255:65535,B=D.length,j=new Int32Array(L.srcSize);let H=0,$=0;for(;H<B;){let q=0,W=D[H];for(;W===X;)q+=W,H++,W=D[H];q+=W,j[$]=q,H++,$++}return j}function M(D,L){return D.length===L.srcSize?D:L.isUnsigned?R(D,L):x(D,L)}function P(D,L){const X=v({encoding:L.offsetEncoding,data:L.offsets}),B=v({encoding:L.dataEncoding,data:D}),j=L.stringData,H=new Array(X.length);H[0]="";for(let W=1,Y=X.length;W<Y;W++)H[W]=j.substring(X[W-1],X[W]);let $=0;const q=new Array(B.length);for(let W=0,Y=B.length;W<Y;W++)q[$++]=H[B[W]+1];return q}}),"./src/parsers/cifutils/encoding.ts":((e,r,t)=>{t.r(r),t.d(r,{Encoding:()=>c,VERSION:()=>o});const o="0.3.0";var c;(function(u){(function(g){g[g.Int8=1]="Int8",g[g.Int16=2]="Int16",g[g.Int32=3]="Int32",g[g.Uint8=4]="Uint8",g[g.Uint16=5]="Uint16",g[g.Uint32=6]="Uint32"})(u.IntDataType||(u.IntDataType={})),(function(g){g[g.Float32=32]="Float32",g[g.Float64=33]="Float64"})(u.FloatDataType||(u.FloatDataType={}));function v(g){let _;return g instanceof Int8Array?_=u.IntDataType.Int8:g instanceof Int16Array?_=u.IntDataType.Int16:g instanceof Int32Array?_=u.IntDataType.Int32:g instanceof Uint8Array?_=u.IntDataType.Uint8:g instanceof Uint16Array?_=u.IntDataType.Uint16:g instanceof Uint32Array?_=u.IntDataType.Uint32:g instanceof Float32Array?_=u.FloatDataType.Float32:g instanceof Float64Array?_=u.FloatDataType.Float64:_=u.IntDataType.Int32,_}u.getDataType=v;function f(g){if(g instanceof Int8Array||g instanceof Int16Array||g instanceof Int32Array)return!0;for(let _=0,p=g.length;_<p;_++)if(_<0)return!1;return!0}u.isSignedIntegerDataType=f})(c||(c={}))}),"./src/parsers/index.ts":((e,r,t)=>{t.r(r),t.d(r,{Parsers:()=>w,bondLength:()=>y.bondLength,setBondLength:()=>y.setBondLength});var o=t("./src/parsers/VASP.ts"),c=t("./src/parsers/CUBE.ts"),u=t("./src/parsers/XYZ.ts"),v=t("./src/parsers/SDF.ts"),f=t("./src/parsers/CDJSON.ts"),g=t("./src/parsers/CIF.ts"),_=t("./src/parsers/MOL2.ts"),p=t("./src/parsers/PDB.ts"),E=t("./src/parsers/PQR.ts"),k=t("./src/parsers/MMTF.ts"),A=t("./src/parsers/PRMTOP.ts"),z=t("./src/parsers/GRO.ts"),l=t("./src/parsers/LAMMPSTRJ.ts"),s=t("./src/parsers/BCIF.ts"),y=t("./src/parsers/utils/bondLength.ts");const w={vasp:o.VASP,VASP:o.VASP,cube:c.CUBE,CUBE:c.CUBE,xyz:u.XYZ,XYZ:u.XYZ,sdf:v.SDF,SDF:v.SDF,json:f.CDJSON,cdjson:f.CDJSON,CDJSON:f.CDJSON,mcif:g.CIF,cif:g.CIF,CIF:g.CIF,mol2:_.MOL2,MOL2:_.MOL2,pdb:p.PDB,PDB:p.PDB,pdbqt:p.PDB,PDBQT:p.PDB,pqr:E.PQR,PQR:E.PQR,mmtf:k.MMTFparser,MMTF:k.MMTFparser,prmtop:A.PRMTOP,PRMTOP:A.PRMTOP,gro:z.GRO,GRO:z.GRO,lammpstrj:l.LAMMPSTRJ,LAMMPSTRJ:l.LAMMPSTRJ,bcif:s.BCIF,BCIF:s.BCIF}}),"./src/parsers/utils/anumToSymbol.ts":((e,r,t)=>{t.r(r),t.d(r,{anumToSymbol:()=>o});const o={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"}}),"./src/parsers/utils/areConnected.ts":((e,r,t)=>{t.r(r),t.d(r,{areConnected:()=>u});var o=t("./src/parsers/utils/bondLength.ts");const c=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function u(v,f,g){if(g&&g.unboundCations&&(c.has(v.elem)||c.has(f.elem)))return!1;let _=(0,o.bondLength)(v.elem)+(0,o.bondLength)(f.elem);_+=.25,_*=_;let p=v.x-f.x;if(p*=p,p>_)return!1;let E=v.y-f.y;if(E*=E,E>_)return!1;let k=v.z-f.z;if(k*=k,k>_)return!1;const A=p+E+k;return!(isNaN(A)||A<.5||A>_||v.altLoc!==f.altLoc&&v.altLoc.trim()!==""&&f.altLoc.trim()!=="")}}),"./src/parsers/utils/assignBackboneHBonds.ts":((e,r,t)=>{t.r(r),t.d(r,{assignBackboneHBonds:()=>o});function o(c,u){const v=u||3.2,f=v*v,g=[];for(let _=0,p=c.length;_<p;_++){c[_].index=_;const E=c[_];!E.hetflag&&(E.atom==="N"||E.atom==="O")&&(g.push(E),E.hbondOther=null,E.hbondDistanceSq=Number.POSITIVE_INFINITY)}g.sort(function(_,p){return _.z-p.z});for(let _=0,p=g.length;_<p;_++){const E=g[_];for(let k=_+1;k<p;k++){const A=g[k],z=A.z-E.z;if(z>v)break;if(A.atom==E.atom)continue;const l=Math.abs(A.y-E.y);if(l>v)continue;const s=Math.abs(A.x-E.x);if(s>v)continue;const y=s*s+l*l+z*z;y>f||A.chain==E.chain&&Math.abs(A.resi-E.resi)<4||(y<E.hbondDistanceSq&&(E.hbondOther=A,E.hbondDistanceSq=y),y<A.hbondDistanceSq&&(A.hbondOther=E,A.hbondDistanceSq=y))}}}}),"./src/parsers/utils/assignBonds.ts":((e,r,t)=>{t.r(r),t.d(r,{assignBonds:()=>v});var o=t("./src/parsers/utils/areConnected.ts");const c=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],u=4.95;function v(f,g){for(let E=0,k=f.length;E<k;E++)f[E].index||(f[E].index=E);const _={x:{y:{z:[]}}};for(let E=0;E<f.length;E++){const k=f[E],A=Math.floor(k.x/u),z=Math.floor(k.y/u),l=Math.floor(k.z/u);_[A]||(_[A]={}),_[A][z]||(_[A][z]={}),_[A][z][l]||(_[A][z][l]=[]),_[A][z][l].push(k)}function p(E,k){for(let A=0;A<E.length;A++){const z=E[A];for(let l=0;l<k.length;l++){const s=k[l];if((0,o.areConnected)(z,s,g)){const y=z.bonds.indexOf(s.index),w=s.bonds.indexOf(z.index);y===-1&&w===-1?(z.bonds.push(s.index),z.bondOrder.push(1),s.bonds.push(z.index),s.bondOrder.push(1)):y===-1?(z.bonds.push(s.index),z.bondOrder.push(s.bondOrder[w])):w===-1&&(s.bonds.push(z.index),s.bondOrder.push(z.bondOrder[y]))}}}}for(let E in _){const k=parseInt(E);for(let A in _[k]){const z=parseInt(A);for(let l in _[k][z]){const s=parseInt(l),y=_[k][z][s];for(let w=0;w<y.length;w++){const S=y[w];for(let C=w+1;C<y.length;C++){const h=y[C];(0,o.areConnected)(S,h,g)&&S.bonds.indexOf(h.index)==-1&&(S.bonds.push(h.index),S.bondOrder.push(1),h.bonds.push(S.index),h.bondOrder.push(1))}}for(let w=0;w<c.length;w++){const S=c[w];if(!_[k+S.x]||!_[k+S.x][z+S.y]||!_[k+S.x][z+S.y][s+S.z])continue;const C=_[k+S.x][z+S.y][s+S.z];p(y,C)}}}}}}),"./src/parsers/utils/assignPDBBonds.ts":((e,r,t)=>{t.r(r),t.d(r,{assignPDBBonds:()=>v});var o=t("./src/parsers/utils/areConnected.ts"),c=t("./src/parsers/utils/assignBonds.ts"),u=t("./src/parsers/utils/standardResidues.ts");function v(f,g){const _=[],p=[];for(let z=0,l=f.length;z<l;z++){const s=f[z];s.index=z,s.hetflag||!u.standardResidues.has(s.resn)?p.push(s):_.push(s)}(0,c.assignBonds)(p,g),_.sort(function(z,l){return z.chain!==l.chain?z.chain<l.chain?-1:1:z.resi-l.resi});let E=-1,k=-1,A;for(let z=0,l=_.length;z<l;z++){const s=_[z];s.resi!==E&&(E=s.resi,A||k++,A=!1),s.reschain=k;for(let y=z+1;y<_.length;y++){const w=_[y];if(w.chain!==s.chain||w.resi-s.resi>1)break;(0,o.areConnected)(s,w,g)&&(s.bonds.indexOf(w.index)===-1&&(s.bonds.push(w.index),s.bondOrder.push(1),w.bonds.push(s.index),w.bondOrder.push(1)),s.resi!==w.resi&&(A=!0))}}}}),"./src/parsers/utils/atomNameToElem.ts":((e,r,t)=>{t.r(r),t.d(r,{atomNameToElem:()=>c});var o=t("./src/parsers/utils/bondLength.ts");function c(u,v){let f=u.replace(/ /g,"");return f.length>0&&f[0]==="H"&&f!=="Hg"&&f!=="He"&&f!=="Hf"&&f!=="Hs"&&f!=="Ho"&&(f="H"),f.length>1&&(f=f[0].toUpperCase()+f.substring(1).toLowerCase(),o.bondTable[f]===void 0?f=f[0]:v&&(f==="Ca"||f==="Cd")&&(f="C")),f}}),"./src/parsers/utils/bondLength.ts":((e,r,t)=>{t.r(r),t.d(r,{bondLength:()=>c,bondTable:()=>o,setBondLength:()=>u});let o={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function c(v){return o[v]||1.6}function u(v,f){f<0&&(f=0),o[v]=f}}),"./src/parsers/utils/computeSecondaryStructure.ts":((e,r,t)=>{t.r(r),t.d(r,{computeSecondaryStructure:()=>c});var o=t("./src/parsers/utils/assignBackboneHBonds.ts");function c(u,v){(0,o.assignBackboneHBonds)(u,v);const f={};let g,_,p,E,k,A;for(g=0,_=u.length;g<_;g++)if(k=u[g],f[k.chain]===void 0&&(f[k.chain]=[]),isFinite(k.hbondDistanceSq)){const z=k.hbondOther;f[z.chain]===void 0&&(f[z.chain]=[]),Math.abs(z.resi-k.resi)===4&&(f[k.chain][k.resi]="h")}for(p in f)for(E=1;E<f[p].length-1;E++){const z=f[p][E-1],l=f[p][E+1];A=f[p][E],z=="h"&&z==l&&A!=z&&(f[p][E]=z)}for(g=0,_=u.length;g<_;g++)k=u[g],isFinite(k.hbondDistanceSq)&&f[k.chain][k.resi]!="h"&&k.ss!=="h"&&(f[k.chain][k.resi]="maybesheet");for(let z=0,l=u.length;z<l;z++)if(k=u[z],isFinite(k.hbondDistanceSq)&&f[k.chain][k.resi]=="maybesheet"){let s=k.hbondOther,y=f[s.chain][s.resi];(y=="maybesheet"||y=="s")&&(f[k.chain][k.resi]="s",f[s.chain][s.resi]="s")}for(let z in f){for(let l=1;l<f[z].length-1;l++){const s=f[z][l-1],y=f[z][l+1];A=f[z][l],s=="s"&&s==y&&A!=s&&(f[z][l]=s)}for(let l=0;l<f[z].length;l++){const s=f[z][l];(s=="h"||s=="s")&&f[z][l-1]!=s&&f[z][l+1]!=s&&delete f[z][l]}}for(g=0,_=u.length;g<_;g++)k=u[g],A=f[k.chain][k.resi],delete k.hbondOther,delete k.hbondDistanceSq,!(A===void 0||A==="maybesheet")&&(k.ss=A,f[k.chain][k.resi-1]!=A&&(k.ssbegin=!0),f[k.chain][k.resi+1]!=A&&(k.ssend=!0))}}),"./src/parsers/utils/getSinglePDB.ts":((e,r,t)=>{t.r(r),t.d(r,{getSinglePDB:()=>E});var o=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/atomNameToElem.ts"),u=t("./src/parsers/utils/bondLength.ts"),v=t("./src/parsers/utils/computeSecondaryStructure.ts"),f=t("./src/parsers/utils/isEmpty.ts"),g=t("./src/parsers/utils/processSymmetries.ts"),_=t("./src/parsers/utils/assignPDBBonds.ts"),p=t("./src/parsers/utils/validateBonds.ts");function E(k,A,z){const l=[],s=A.assignBonds===void 0?!0:A.assignBonds,y=!A.keepH,w=!!A.noSecondaryStructure,S=!A.noComputeSecondaryStructure,C=!A.doAssembly,h=A.altLoc?A.altLoc:"A",x={symmetries:[],cryst:void 0};let R,M=[];const P=[];let D;const L={};for(let X=0;X<k.length;X++){D=k[X].replace(/^\s*/,"");const B=D.substring(0,6);let j,H,$;if(B.indexOf("END")===0){if(M=k.slice(X+1),B==="END")for(const q in z)z.hasOwnProperty(q)&&delete z[q];break}else if(B==="ATOM  "||B==="HETATM"){let q,W,Y,G,V,Z,xe,ce,Ne,Pe,De,Me;if(De=D.substring(16,17),De!==" "&&De!==h&&h!=="*"||(Pe=parseInt(D.substring(6,11)),R=D.substring(12,16).replace(/ /g,""),q=D.substring(17,20).replace(/ /g,""),W=D.substring(21,22),Y=parseInt(D.substring(22,26)),G=D.substring(26,27),V=parseFloat(D.substring(30,38)),Z=parseFloat(D.substring(38,46)),xe=parseFloat(D.substring(46,54)),Me=parseFloat(D.substring(60,68)),Ne=D.substring(76,78).replace(/ /g,""),Ne===""||u.bondTable[Ne]===void 0?Ne=(0,c.atomNameToElem)(D.substring(12,14),D[0]=="A"):Ne=Ne[0].toUpperCase()+Ne.substring(1).toLowerCase(),Ne==="H"&&y))continue;B[0]=="H"?ce=!0:ce=!1,P[Pe]=l.length,l.push({resn:q,x:V,y:Z,z:xe,elem:Ne,hetflag:ce,altLoc:De,chain:W,resi:Y,icode:G,rescode:Y+(G!==" "?"^"+G:""),serial:Pe,atom:R,bonds:[],ss:"c",bondOrder:[],properties:{},b:Me,pdbline:D})}else if(B==="SHEET "){j=D.substring(21,22),H=parseInt(D.substring(22,26)),$=parseInt(D.substring(33,37)),j in z||(z[j]={}),z[j][H]="s1";for(let q=H+1;q<$;q++)z[j][q]="s";z[j][$]="s2"}else if(B==="CONECT"){const q=parseInt(D.substring(6,11)),W=P[q],Y=l[W],G=[11,16,21,26];for(let V=0;V<4;V++){const Z=parseInt(D.substring(G[V],G[V]+5)),xe=P[Z];let ce=W+":"+xe;const Ne=l[xe];if(Y!==void 0&&Ne!==void 0)if(!L[ce])L[ce]=1,(Y.bonds.length==0||Y.bonds[Y.bonds.length-1]!==xe)&&(Y.bonds.push(xe),Y.bondOrder.push(1));else{L[ce]+=1;for(let Pe=0;Pe<Y.bonds.length;Pe++)if(Y.bonds[Pe]==xe){const De=L[ce];De>=4?Y.bondOrder[Pe]=1:Y.bondOrder[Pe]=De}}}}else if(B==="HELIX "){j=D.substring(19,20),H=parseInt(D.substring(21,25)),$=parseInt(D.substring(33,37)),j in z||(z[j]={}),z[j][H]="h1";for(let q=H+1;q<$;q++)z[j][q]="h";z[j][$]="h2"}else if(!C&&B==="REMARK"&&D.substring(13,18)==="BIOMT"){let q,W=new o.Matrix4;for(q=1;q<=3;q++)if(D=k[X].replace(/^\s*/,""),parseInt(D.substring(18,19))==q)W.elements[q-1]=parseFloat(D.substring(23,33)),W.elements[q-1+4]=parseFloat(D.substring(33,43)),W.elements[q-1+8]=parseFloat(D.substring(43,53)),W.elements[q-1+12]=parseFloat(D.substring(53)),X++;else for(;D.substring(13,18)==="BIOMT";)X++,D=k[X].replace(/^\s*/,"");W.elements[3]=0,W.elements[7]=0,W.elements[11]=0,W.elements[15]=1,x.symmetries.push(W),X--}else if(B==="CRYST1"){let q,W,Y,G,V,Z;q=parseFloat(D.substring(7,15)),W=parseFloat(D.substring(16,24)),Y=parseFloat(D.substring(25,33)),G=parseFloat(D.substring(34,40)),V=parseFloat(D.substring(41,47)),Z=parseFloat(D.substring(48,54)),x.cryst={a:q,b:W,c:Y,alpha:G,beta:V,gamma:Z}}else if(B==="ANISOU"){const q=parseInt(D.substring(6,11)),W=P[q],Y=l[W];if(Y){const G=D.substring(30).trim().split(/\s+/),V={u11:parseInt(G[0]),u22:parseInt(G[1]),u33:parseInt(G[2]),u12:parseInt(G[3]),u13:parseInt(G[4]),u23:parseInt(G[5])};Y.uMat=V}}}if((0,p.validateBonds)(l,P),s&&(0,_.assignPDBBonds)(l,A),C||(0,g.processSymmetries)(x.symmetries,l,A,x.cryst),S&&!w&&(0,v.computeSecondaryStructure)(l,A.hbondCutoff),!(0,f.isEmpty)(z))for(let X=0;X<l.length;X++){const B=l[X];if(B!==void 0&&B.chain in z&&B.resi in z[B.chain]){const j=z[B.chain][B.resi];B.ss=j[0],j.length>1&&(j[1]=="1"?B.ssbegin=!0:j[1]=="2"&&(B.ssend=!0))}}return[l,x,M]}}),"./src/parsers/utils/isEmpty.ts":((e,r,t)=>{t.r(r),t.d(r,{isEmpty:()=>o});function o(c){for(const u in c)return!1;return!0}}),"./src/parsers/utils/processSymmetries.ts":((e,r,t)=>{t.r(r),t.d(r,{processSymmetries:()=>c});var o=t("./src/WebGL/index.ts");function c(u,v,f,g){const _=!f.duplicateAssemblyAtoms,p=v.length;let E=p,k=-1,A=null,z=null;(f.normalizeAssembly||f.wrapAtoms)&&g&&(A=(0,o.conversionMatrix3)(g.a,g.b,g.c,g.alpha,g.beta,g.gamma),z=new o.Matrix3,z.getInverse3(A));let l=function(w){let S=w.clone().applyMatrix3(z);const C=[S.x,S.y,S.z],h=[0,0,0];for(let R=0;R<3;R++){for(;C[R]<-.001;)C[R]+=1,h[R]+=1;for(;C[R]>1.001;)C[R]-=1,h[R]-=1}const x=new o.Vector3(h[0],h[1],h[2]);return x.applyMatrix3(A),x};if(f.normalizeAssembly&&g)for(let w=0;w<u.length;w++){const S=new o.Vector3(0,0,0);for(let h=0;h<p;h++){const x=new o.Vector3(v[h].x,v[h].y,v[h].z);x.applyMatrix4(u[w]),S.add(x)}S.divideScalar(p);const C=l(S);u[w].isNearlyIdentity()&&C.lengthSq()>.001&&(k=w),u[w].translate(C)}if(_){if(u.length>1)for(let w=0;w<v.length;w++){var s=[];for(let S=0;S<u.length;S++)if(!u[S].isNearlyIdentity()){var y=new o.Vector3;y.set(v[w].x,v[w].y,v[w].z),y.applyMatrix4(u[S]),s.push(y)}v[w].symmetries=s}}else{for(let w=0;w<p;w++)v[w].sym=-1;for(let w=0;w<u.length;w++)if(!u[w].isNearlyIdentity()&&k!=w){let S=new o.Vector3;for(let C=0;C<p;C++){const h=[];for(let R=0;R<v[C].bonds.length;R++)h.push(v[C].bonds[R]+E);if(S.set(v[C].x,v[C].y,v[C].z),S.applyMatrix4(u[w]),f.wrapAtoms&&g){let R=l(S);S.add(R)}const x={};for(const R in v[C])x[R]=v[C][R];x.x=S.x,x.y=S.y,x.z=S.z,x.bonds=h,x.sym=w,x.index=v.length,v.push(x)}E=v.length}else for(let S=0;S<p;S++)v[S].sym=w;if(f.wrapAtoms&&g){let w=new o.Vector3;for(let S=0;S<p;S++){w.set(v[S].x,v[S].y,v[S].z);let C=l(w);w.add(C),v[S].x=w.x,v[S].y=w.y,v[S].z=w.z}}if(k>=0){const w=new o.Vector3;for(let S=0;S<p;S++)w.set(v[S].x,v[S].y,v[S].z),w.applyMatrix4(u[k]),v[S].x=w.x,v[S].y=w.y,v[S].z=w.z}u.length=0}}}),"./src/parsers/utils/standardResidues.ts":((e,r,t)=>{t.r(r),t.d(r,{standardResidues:()=>o});const o=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"])}),"./src/parsers/utils/validateBonds.ts":((e,r,t)=>{t.r(r),t.d(r,{validateBonds:()=>o});function o(c,u){for(let v=0,f=c.length;v<f;v++){const g=c[v];for(let _=0;_<g.bonds.length;_++){const p=g.bonds[_],E=c[p],k=u[g.serial];E&&k&&E.bonds.indexOf(k)<0&&(E.bonds.push(k),E.bondOrder.push(g.bondOrder[_]))}}}}),"./src/partialCharges.ts":((e,r,t)=>{t.r(r),t.d(r,{applyPartialCharges:()=>c,partialCharges:()=>o});const o={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function c(u,v){if((!v||typeof u.partialCharge>"u")&&u.resn&&u.atom){var f=u.resn+":"+u.atom;u.properties.partialCharge=o[f]}}}),"./src/specs.ts":((e,r,t)=>{t.r(r)}),"./src/utilities.ts":((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/Gradient.ts"),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/VolumeData.ts"),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/colors.ts"),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/pako/dist/pako.esm.mjs");function extend(e,r){for(var t in r)r.hasOwnProperty(t)&&r[t]!==void 0&&(e[t]=r[t]);return e}function deepCopy(e){let r,t,o;if(e==null)return{};if(typeof e!="object"||e===null)return e;r=Array.isArray(e)?[]:{};for(o in e)t=e[o],r[o]=deepCopy(t);return r}function isNumeric(e){var r=typeof e;return(r==="number"||r==="string")&&!isNaN(e-parseFloat(e))}function isEmptyObject(e){var r;for(r in e)return!1;return!0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?null:callback}function adjustVolumeStyle(e){e&&(e.volformat&&!(e.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData)&&(e.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(e.voldata,e.volformat)),e.volscheme&&(e.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(e.volscheme)))}function getExtent(e,r){var t,o,c,u,v,f,g,_,p,E,k=!r;if(t=o=c=9999,u=v=f=-9999,g=_=p=E=0,e.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var A=0;A<e.length;A++){var z=e[A];if(!(typeof z>"u"||!isFinite(z.x)||!isFinite(z.y)||!isFinite(z.z))&&(E++,g+=z.x,_+=z.y,p+=z.z,t=t<z.x?t:z.x,o=o<z.y?o:z.y,c=c<z.z?c:z.z,u=u>z.x?u:z.x,v=v>z.y?v:z.y,f=f>z.z?f:z.z,z.symmetries&&k))for(var l=0;l<z.symmetries.length;l++)E++,g+=z.symmetries[l].x,_+=z.symmetries[l].y,p+=z.symmetries[l].z,t=t<z.symmetries[l].x?t:z.symmetries[l].x,o=o<z.symmetries[l].y?o:z.symmetries[l].y,c=c<z.symmetries[l].z?c:z.symmetries[l].z,u=u>z.symmetries[l].x?u:z.symmetries[l].x,v=v>z.symmetries[l].y?v:z.symmetries[l].y,f=f>z.symmetries[l].z?f:z.symmetries[l].z}return[[t,o,c],[u,v,f],[g/E,_/E,p/E]]}function getPropertyRange(e,r){for(var t=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,c=0,u=e.length;c<u;c++){var v=e[c],f=getAtomProperty(v,r);f!=null&&(f<t&&(t=f),f>o&&(o=f))}return!isFinite(t)&&!isFinite(o)?t=o=0:isFinite(t)?isFinite(o)||(o=t):t=o,[t,o]}class PausableTimer{constructor(r,t,o){this.total_time_run=0,this.fn=r,this.arg=o,this.countdown=t,this.start_time=new Date().getTime(),this.ident=setTimeout(r,t,o)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(e){for(var r=window.atob(e),t=r.length,o=new Uint8Array(t),c=0;c<t;c++)o[c]=r.charCodeAt(c);return o}function getAtomProperty(e,r){var t=null;return e.properties&&typeof e.properties[r]<"u"?t=e.properties[r]:typeof e[r]<"u"&&(t=e[r]),t}function mergeGeos(e,r){var t=r.geometry;t!==void 0&&e.geometryGroups.push(t.geometryGroups[0])}function specStringToObject(e){if(typeof e=="object"||typeof e>"u"||e==null)return e;try{return JSON.parse(e)}catch{}e=e.replace(/%7E/g,"~");var r=function(k){return isNumeric(k)?Math.floor(parseFloat(k))==parseInt(k)||k.indexOf(".")>=0?parseFloat(k):parseInt(k):k==="true"?!0:k==="false"?!1:k},t={};if(e==="all")return t;for(var o=e.split(";"),c=0;c<o.length;c++){var u=o[c].split(":"),v=u[0],f={},g=u[1];if(g)if(g=g.replace(/~/g,"="),g.indexOf("=")!==-1)for(var _=g.split(","),p=0;p<_.length;p++){var E=_[p].split("=",2);f[E[0]]=r(E[1])}else g.indexOf(",")!==-1?f=g.split(","):f=r(g);t[v]=f}return t}function checkStatus(e){if(!e.ok)throw new Error(`HTTP ${e.status} - ${e.statusText}`);return e}function get(e,r){var t=fetch(e).then(checkStatus).then(o=>o.text());return r?t.then(r):t}function getbin(e,r,t,o){var c;return t=="POST"?c=fetch(e,{method:"POST",body:o}).then(u=>checkStatus(u)).then(u=>u.arrayBuffer()):c=fetch(e).then(u=>checkStatus(u)).then(u=>u.arrayBuffer()),r?c.then(r):c}function download(e,r,t,o){var c="",u="",v="",f=null,g=r.addModel();if(e.indexOf(":")<0&&(e.length==4?e="pdb:"+e:isNaN(e)?e="url:"+e:e="cid:"+e),e.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),e="bcif:"+e.slice(5)),e.substring(0,5)==="bcif:")e=e.substring(5).toUpperCase(),v="https://models.rcsb.org/"+e+".bcif.gz",t&&typeof t.noComputeSecondaryStructure>"u"&&(t.noComputeSecondaryStructure=!0),f=new Promise(function(p){getbin(v).then(function(E){g.addMolData(E,"bcif.gz",t),r.zoomTo(),r.render(),p(g)},function(){console.error("fetch of "+v+" failed.")})});else{if(e.substring(0,4)==="pdb:"){if(c="bcif",t&&t.format&&(c=t.format),t&&typeof t.noComputeSecondaryStructure>"u"&&(t.noComputeSecondaryStructure=!0),e=e.substring(4).toUpperCase(),!e.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}c=="bcif"?v="https://models.rcsb.org/"+e.toUpperCase()+".bcif.gz":(u=t&&t.pdbUri?t.pdbUri:"https://files.rcsb.org/view/",v=u+e+"."+c)}else if(e.substring(0,4)=="cid:"){if(c="sdf",e=e.substring(4),!e.match(/^[0-9]+$/)){alert("Wrong Compound ID");return}v="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+e+"/SDF?record_type=3d"}else e.substring(0,4)=="url:"&&(v=e.substring(4),c=v);var _=function(p){g.addMolData(p,c,t),r.zoomTo(),r.render()};f=new Promise(function(p){c=="bcif"?getbin(v).then(function(E){_(E),p(g)}).catch(function(){u=t&&t.pdbUri?t.pdbUri:"https://files.rcsb.org/view/",v=u+e+".pdb",c="pdb",console.warn("falling back to pdb format"),get(v).then(function(E){_(E),p(g)}).catch(function(E){_(""),p(g),console.error("fetch of "+v+" failed: "+E.statusText)})}):get(v).then(function(E){_(E),p(g)}).catch(function(E){_(""),p(g),console.error("fetch of "+v+" failed: "+E.statusText)})})}return o?(f.then(function(p){o(p)}),g):f}function getColorFromStyle(e,r){let t=r.colorscheme;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]<"u")t=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t];else if(typeof t=="string"&&t.endsWith("Carbon")){let u=t.substring(0,t.lastIndexOf("Carbon")).toLowerCase();if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[u]<"u"){let v=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);v.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[u],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]={prop:"elem",map:v},t=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]}}let o=e.color;if(typeof r.color<"u"&&r.color!="spectrum"&&(o=r.color),typeof t<"u"){let u,v;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[t]<"u")t=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[t],typeof t[e[t.prop]]<"u"&&(o=t.map[e[t.prop]]);else if(typeof t[e[t.prop]]<"u")o=t.map[e[t.prop]];else if(typeof t.prop<"u"&&typeof t.gradient<"u"){u=t.prop;var c=t.gradient;c instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(c=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(t));let f=c.range()||[-1,1];v=getAtomProperty(e,u),v!=null&&(o=c.valueToHex(v,f))}else typeof t.prop<"u"&&typeof t.map<"u"?(u=t.prop,v=getAtomProperty(e,u),typeof t.map[v]<"u"&&(o=t.map[v])):typeof r.colorscheme[e.elem]<"u"?o=r.colorscheme[e.elem]:console.warn("Could not interpret colorscheme "+t)}else typeof r.colorfunc<"u"&&(o=r.colorfunc(e));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(o)}function getElement(e){let r=e;return typeof e=="string"?r=document.querySelector("#"+e):typeof e=="object"&&e.get&&(r=e.get(0)),r}function inflateString(e,r=!0){let t;return typeof e=="string"?t=new TextEncoder().encode(e):t=new Uint8Array(e),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(t,{to:r?"string":null})}}),"./node_modules/upng-js/UPNG.js":((e,r,t)=>{(function(){var o={},c;e.exports=o,c=t("./node_modules/upng-js/node_modules/pako/index.js"),(function(u,v){u.toRGBA8=function(f){var g=f.width,_=f.height;if(f.tabs.acTL==null)return[u.toRGBA8.decodeImage(f.data,g,_,f).buffer];var p=[];f.frames[0].data==null&&(f.frames[0].data=f.data);for(var E,k=new Uint8Array(g*_*4),A=0;A<f.frames.length;A++){var z=f.frames[A],l=z.rect.x,s=z.rect.y,y=z.rect.width,w=z.rect.height,S=u.toRGBA8.decodeImage(z.data,y,w,f);if(A==0?E=S:z.blend==0?u._copyTile(S,y,w,E,g,_,l,s,0):z.blend==1&&u._copyTile(S,y,w,E,g,_,l,s,1),p.push(E.buffer),E=E.slice(0),z.dispose!=0){if(z.dispose==1)u._copyTile(k,y,w,E,g,_,l,s,0);else if(z.dispose==2){for(var C=A-1;f.frames[C].dispose==2;)C--;E=new Uint8Array(p[C]).slice(0)}}}return p},u.toRGBA8.decodeImage=function(f,g,_,p){var E=g*_,k=u.decode._getBPP(p),A=Math.ceil(g*k/8),z=new Uint8Array(E*4),l=new Uint32Array(z.buffer),s=p.ctype,y=p.depth,w=u._bin.readUshort;if(s==6){var S=E<<2;if(y==8)for(var C=0;C<S;C++)z[C]=f[C];if(y==16)for(var C=0;C<S;C++)z[C]=f[C<<1]}else if(s==2){var h=p.tabs.tRNS,x=-1,R=-1,M=-1;if(h&&(x=h[0],R=h[1],M=h[2]),y==8)for(var C=0;C<E;C++){var P=C<<2,D=C*3;z[P]=f[D],z[P+1]=f[D+1],z[P+2]=f[D+2],z[P+3]=255,x!=-1&&f[D]==x&&f[D+1]==R&&f[D+2]==M&&(z[P+3]=0)}if(y==16)for(var C=0;C<E;C++){var P=C<<2,D=C*6;z[P]=f[D],z[P+1]=f[D+2],z[P+2]=f[D+4],z[P+3]=255,x!=-1&&w(f,D)==x&&w(f,D+2)==R&&w(f,D+4)==M&&(z[P+3]=0)}}else if(s==3){var L=p.tabs.PLTE,X=p.tabs.tRNS,B=X?X.length:0;if(y==1)for(var j=0;j<_;j++)for(var H=j*A,$=j*g,C=0;C<g;C++){var P=$+C<<2,q=f[H+(C>>3)]>>7-((C&7)<<0)&1,W=3*q;z[P]=L[W],z[P+1]=L[W+1],z[P+2]=L[W+2],z[P+3]=q<B?X[q]:255}if(y==2)for(var j=0;j<_;j++)for(var H=j*A,$=j*g,C=0;C<g;C++){var P=$+C<<2,q=f[H+(C>>2)]>>6-((C&3)<<1)&3,W=3*q;z[P]=L[W],z[P+1]=L[W+1],z[P+2]=L[W+2],z[P+3]=q<B?X[q]:255}if(y==4)for(var j=0;j<_;j++)for(var H=j*A,$=j*g,C=0;C<g;C++){var P=$+C<<2,q=f[H+(C>>1)]>>4-((C&1)<<2)&15,W=3*q;z[P]=L[W],z[P+1]=L[W+1],z[P+2]=L[W+2],z[P+3]=q<B?X[q]:255}if(y==8)for(var C=0;C<E;C++){var P=C<<2,q=f[C],W=3*q;z[P]=L[W],z[P+1]=L[W+1],z[P+2]=L[W+2],z[P+3]=q<B?X[q]:255}}else if(s==4){if(y==8)for(var C=0;C<E;C++){var P=C<<2,Y=C<<1,G=f[Y];z[P]=G,z[P+1]=G,z[P+2]=G,z[P+3]=f[Y+1]}if(y==16)for(var C=0;C<E;C++){var P=C<<2,Y=C<<2,G=f[Y];z[P]=G,z[P+1]=G,z[P+2]=G,z[P+3]=f[Y+2]}}else if(s==0){var x=p.tabs.tRNS?p.tabs.tRNS:-1;if(y==1)for(var C=0;C<E;C++){var G=255*(f[C>>3]>>7-(C&7)&1),V=G==x*255?0:255;l[C]=V<<24|G<<16|G<<8|G}if(y==2)for(var C=0;C<E;C++){var G=85*(f[C>>2]>>6-((C&3)<<1)&3),V=G==x*85?0:255;l[C]=V<<24|G<<16|G<<8|G}if(y==4)for(var C=0;C<E;C++){var G=17*(f[C>>1]>>4-((C&1)<<2)&15),V=G==x*17?0:255;l[C]=V<<24|G<<16|G<<8|G}if(y==8)for(var C=0;C<E;C++){var G=f[C],V=G==x?0:255;l[C]=V<<24|G<<16|G<<8|G}if(y==16)for(var C=0;C<E;C++){var G=f[C<<1],V=w(f,C<<1)==x?0:255;l[C]=V<<24|G<<16|G<<8|G}}return z},u.decode=function(f){for(var g=new Uint8Array(f),_=8,p=u._bin,E=p.readUshort,k=p.readUint,A={tabs:{},frames:[]},z=new Uint8Array(g.length),l=0,s,y=0,w=[137,80,78,71,13,10,26,10],S=0;S<8;S++)if(g[S]!=w[S])throw"The input is not a PNG file!";for(;_<g.length;){var C=p.readUint(g,_);_+=4;var h=p.readASCII(g,_,4);if(_+=4,h=="IHDR")u.decode._IHDR(g,_,A);else if(h=="IDAT"){for(var S=0;S<C;S++)z[l+S]=g[_+S];l+=C}else if(h=="acTL")A.tabs[h]={num_frames:k(g,_),num_plays:k(g,_+4)},s=new Uint8Array(g.length);else if(h=="fcTL"){if(y!=0){var x=A.frames[A.frames.length-1];x.data=u.decode._decompress(A,s.slice(0,y),x.rect.width,x.rect.height),y=0}var R={x:k(g,_+12),y:k(g,_+16),width:k(g,_+4),height:k(g,_+8)},M=E(g,_+22);M=E(g,_+20)/(M==0?100:M);var P={rect:R,delay:Math.round(M*1e3),dispose:g[_+24],blend:g[_+25]};A.frames.push(P)}else if(h=="fdAT"){for(var S=0;S<C-4;S++)s[y+S]=g[_+S+4];y+=C-4}else if(h=="pHYs")A.tabs[h]=[p.readUint(g,_),p.readUint(g,_+4),g[_+8]];else if(h=="cHRM"){A.tabs[h]=[];for(var S=0;S<8;S++)A.tabs[h].push(p.readUint(g,_+S*4))}else if(h=="tEXt"){A.tabs[h]==null&&(A.tabs[h]={});var D=p.nextZero(g,_),L=p.readASCII(g,_,D-_),X=p.readASCII(g,D+1,_+C-D-1);A.tabs[h][L]=X}else if(h=="iTXt"){A.tabs[h]==null&&(A.tabs[h]={});var D=0,B=_;D=p.nextZero(g,B);var L=p.readASCII(g,B,D-B);B=D+1,g[B],g[B+1],B+=2,D=p.nextZero(g,B),p.readASCII(g,B,D-B),B=D+1,D=p.nextZero(g,B),p.readUTF8(g,B,D-B),B=D+1;var X=p.readUTF8(g,B,C-(B-_));A.tabs[h][L]=X}else if(h=="PLTE")A.tabs[h]=p.readBytes(g,_,C);else if(h=="hIST"){var j=A.tabs.PLTE.length/3;A.tabs[h]=[];for(var S=0;S<j;S++)A.tabs[h].push(E(g,_+S*2))}else if(h=="tRNS")A.ctype==3?A.tabs[h]=p.readBytes(g,_,C):A.ctype==0?A.tabs[h]=E(g,_):A.ctype==2&&(A.tabs[h]=[E(g,_),E(g,_+2),E(g,_+4)]);else if(h=="gAMA")A.tabs[h]=p.readUint(g,_)/1e5;else if(h=="sRGB")A.tabs[h]=g[_];else if(h=="bKGD")A.ctype==0||A.ctype==4?A.tabs[h]=[E(g,_)]:A.ctype==2||A.ctype==6?A.tabs[h]=[E(g,_),E(g,_+2),E(g,_+4)]:A.ctype==3&&(A.tabs[h]=g[_]);else if(h=="IEND"){if(y!=0){var x=A.frames[A.frames.length-1];x.data=u.decode._decompress(A,s.slice(0,y),x.rect.width,x.rect.height),y=0}A.data=u.decode._decompress(A,z,A.width,A.height);break}_+=C,p.readUint(g,_),_+=4}return delete A.compress,delete A.interlace,delete A.filter,A},u.decode._decompress=function(f,g,_,p){return f.compress==0&&(g=u.decode._inflate(g)),f.interlace==0?g=u.decode._filterZero(g,f,0,_,p):f.interlace==1&&(g=u.decode._readInterlace(g,f)),g},u.decode._inflate=function(f){return v.inflate(f)},u.decode._readInterlace=function(f,g){for(var _=g.width,p=g.height,E=u.decode._getBPP(g),k=E>>3,A=Math.ceil(_*E/8),z=new Uint8Array(p*A),l=0,s=[0,0,4,0,2,0,1],y=[0,4,0,2,0,1,0],w=[8,8,8,4,4,2,2],S=[8,8,4,4,2,2,1],C=0;C<7;){for(var h=w[C],x=S[C],R=0,M=0,P=s[C];P<p;)P+=h,M++;for(var D=y[C];D<_;)D+=x,R++;var L=Math.ceil(R*E/8);u.decode._filterZero(f,g,l,R,M);for(var X=0,B=s[C];B<p;){for(var j=y[C],H=l+X*L<<3;j<_;){if(E==1){var $=f[H>>3];$=$>>7-(H&7)&1,z[B*A+(j>>3)]|=$<<7-((j&3)<<0)}if(E==2){var $=f[H>>3];$=$>>6-(H&7)&3,z[B*A+(j>>2)]|=$<<6-((j&3)<<1)}if(E==4){var $=f[H>>3];$=$>>4-(H&7)&15,z[B*A+(j>>1)]|=$<<4-((j&1)<<2)}if(E>=8)for(var q=B*A+j*k,W=0;W<k;W++)z[q+W]=f[(H>>3)+W];H+=E,j+=x}X++,B+=h}R*M!=0&&(l+=M*(1+L)),C=C+1}return z},u.decode._getBPP=function(f){var g=[1,null,3,1,2,null,4][f.ctype];return g*f.depth},u.decode._filterZero=function(f,g,_,p,E){var k=u.decode._getBPP(g),A=Math.ceil(p*k/8),z=u.decode._paeth;k=Math.ceil(k/8);for(var l=0;l<E;l++){var s=_+l*A,y=s+l+1,w=f[y-1];if(w==0)for(var S=0;S<A;S++)f[s+S]=f[y+S];else if(w==1){for(var S=0;S<k;S++)f[s+S]=f[y+S];for(var S=k;S<A;S++)f[s+S]=f[y+S]+f[s+S-k]&255}else if(l==0){for(var S=0;S<k;S++)f[s+S]=f[y+S];if(w==2)for(var S=k;S<A;S++)f[s+S]=f[y+S]&255;if(w==3)for(var S=k;S<A;S++)f[s+S]=f[y+S]+(f[s+S-k]>>1)&255;if(w==4)for(var S=k;S<A;S++)f[s+S]=f[y+S]+z(f[s+S-k],0,0)&255}else{if(w==2)for(var S=0;S<A;S++)f[s+S]=f[y+S]+f[s+S-A]&255;if(w==3){for(var S=0;S<k;S++)f[s+S]=f[y+S]+(f[s+S-A]>>1)&255;for(var S=k;S<A;S++)f[s+S]=f[y+S]+(f[s+S-A]+f[s+S-k]>>1)&255}if(w==4){for(var S=0;S<k;S++)f[s+S]=f[y+S]+z(0,f[s+S-A],0)&255;for(var S=k;S<A;S++)f[s+S]=f[y+S]+z(f[s+S-k],f[s+S-A],f[s+S-k-A])&255}}}return f},u.decode._paeth=function(f,g,_){var p=f+g-_,E=Math.abs(p-f),k=Math.abs(p-g),A=Math.abs(p-_);return E<=k&&E<=A?f:k<=A?g:_},u.decode._IHDR=function(f,g,_){var p=u._bin;_.width=p.readUint(f,g),g+=4,_.height=p.readUint(f,g),g+=4,_.depth=f[g],g++,_.ctype=f[g],g++,_.compress=f[g],g++,_.filter=f[g],g++,_.interlace=f[g],g++},u._bin={nextZero:function(f,g){for(;f[g]!=0;)g++;return g},readUshort:function(f,g){return f[g]<<8|f[g+1]},writeUshort:function(f,g,_){f[g]=_>>8&255,f[g+1]=_&255},readUint:function(f,g){return f[g]*16777216+(f[g+1]<<16|f[g+2]<<8|f[g+3])},writeUint:function(f,g,_){f[g]=_>>24&255,f[g+1]=_>>16&255,f[g+2]=_>>8&255,f[g+3]=_&255},readASCII:function(f,g,_){for(var p="",E=0;E<_;E++)p+=String.fromCharCode(f[g+E]);return p},writeASCII:function(f,g,_){for(var p=0;p<_.length;p++)f[g+p]=_.charCodeAt(p)},readBytes:function(f,g,_){for(var p=[],E=0;E<_;E++)p.push(f[g+E]);return p},pad:function(f){return f.length<2?"0"+f:f},readUTF8:function(f,g,_){for(var p="",E,k=0;k<_;k++)p+="%"+u._bin.pad(f[g+k].toString(16));try{E=decodeURIComponent(p)}catch{return u._bin.readASCII(f,g,_)}return E}},u._copyTile=function(f,g,_,p,E,k,A,z,l){for(var s=Math.min(g,E),y=Math.min(_,k),w=0,S=0,C=0;C<y;C++)for(var h=0;h<s;h++)if(A>=0&&z>=0?(w=C*g+h<<2,S=(z+C)*E+A+h<<2):(w=(-z+C)*g-A+h<<2,S=C*E+h<<2),l==0)p[S]=f[w],p[S+1]=f[w+1],p[S+2]=f[w+2],p[S+3]=f[w+3];else if(l==1){var x=f[w+3]*.00392156862745098,R=f[w]*x,M=f[w+1]*x,P=f[w+2]*x,D=p[S+3]*(1/255),L=p[S]*D,X=p[S+1]*D,B=p[S+2]*D,j=1-x,H=x+D*j,$=H==0?0:1/H;p[S+3]=255*H,p[S+0]=(R+L*j)*$,p[S+1]=(M+X*j)*$,p[S+2]=(P+B*j)*$}else if(l==2){var x=f[w+3],R=f[w],M=f[w+1],P=f[w+2],D=p[S+3],L=p[S],X=p[S+1],B=p[S+2];x==D&&R==L&&M==X&&P==B?(p[S]=0,p[S+1]=0,p[S+2]=0,p[S+3]=0):(p[S]=R,p[S+1]=M,p[S+2]=P,p[S+3]=x)}else if(l==3){var x=f[w+3],R=f[w],M=f[w+1],P=f[w+2],D=p[S+3],L=p[S],X=p[S+1],B=p[S+2];if(x==D&&R==L&&M==X&&P==B)continue;if(x<220&&D>20)return!1}return!0},u.encode=function(f,g,_,p,E,k){p==null&&(p=0),k==null&&(k=!1);for(var A=new Uint8Array(f[0].byteLength*f.length+100),z=[137,80,78,71,13,10,26,10],l=0;l<8;l++)A[l]=z[l];var s=8,y=u._bin,w=u.crc.crc,S=y.writeUint,C=y.writeUshort,h=y.writeASCII,x=u.encode.compressPNG(f,g,_,p,k);S(A,s,13),s+=4,h(A,s,"IHDR"),s+=4,S(A,s,g),s+=4,S(A,s,_),s+=4,A[s]=x.depth,s++,A[s]=x.ctype,s++,A[s]=0,s++,A[s]=0,s++,A[s]=0,s++,S(A,s,w(A,s-17,17)),s+=4,S(A,s,1),s+=4,h(A,s,"sRGB"),s+=4,A[s]=1,s++,S(A,s,w(A,s-5,5)),s+=4;var R=f.length>1;if(R&&(S(A,s,8),s+=4,h(A,s,"acTL"),s+=4,S(A,s,f.length),s+=4,S(A,s,0),s+=4,S(A,s,w(A,s-12,12)),s+=4),x.ctype==3){var M=x.plte.length;S(A,s,M*3),s+=4,h(A,s,"PLTE"),s+=4;for(var l=0;l<M;l++){var P=l*3,D=x.plte[l],L=D&255,X=D>>8&255,B=D>>16&255;A[s+P+0]=L,A[s+P+1]=X,A[s+P+2]=B}if(s+=M*3,S(A,s,w(A,s-M*3-4,M*3+4)),s+=4,x.gotAlpha){S(A,s,M),s+=4,h(A,s,"tRNS"),s+=4;for(var l=0;l<M;l++)A[s+l]=x.plte[l]>>24&255;s+=M,S(A,s,w(A,s-M-4,M+4)),s+=4}}for(var j=0,H=0;H<x.frames.length;H++){var $=x.frames[H];R&&(S(A,s,26),s+=4,h(A,s,"fcTL"),s+=4,S(A,s,j++),s+=4,S(A,s,$.rect.width),s+=4,S(A,s,$.rect.height),s+=4,S(A,s,$.rect.x),s+=4,S(A,s,$.rect.y),s+=4,C(A,s,E[H]),s+=2,C(A,s,1e3),s+=2,A[s]=$.dispose,s++,A[s]=$.blend,s++,S(A,s,w(A,s-30,30)),s+=4);var q=$.cimg,M=q.length;S(A,s,M+(H==0?0:4)),s+=4;var W=s;h(A,s,H==0?"IDAT":"fdAT"),s+=4,H!=0&&(S(A,s,j++),s+=4);for(var l=0;l<M;l++)A[s+l]=q[l];s+=M,S(A,s,w(A,W,s-W)),s+=4}return S(A,s,0),s+=4,h(A,s,"IEND"),s+=4,S(A,s,w(A,s-4,4)),s+=4,A.buffer.slice(0,s)},u.encode.compressPNG=function(f,g,_,p,E){for(var k=u.encode.compress(f,g,_,p,!1,E),A=0;A<f.length;A++){var z=k.frames[A];z.rect.width;var l=z.rect.height,s=z.bpl,y=z.bpp,w=new Uint8Array(l*s+l);z.cimg=u.encode._filterZero(z.img,l,y,s,w)}return k},u.encode.compress=function(f,g,_,p,E,k){k==null&&(k=!1);for(var A=6,z=8,l=4,s=255,y=0;y<f.length;y++)for(var w=new Uint8Array(f[y]),S=w.length,C=0;C<S;C+=4)s&=w[C+3];var h=s!=255,x={},R=[];if(f.length!=0&&(x[0]=0,R.push(0),p!=0&&p--),p!=0){var M=u.quantize(f,p,E);f=M.bufs;for(var C=0;C<M.plte.length;C++){var P=M.plte[C].est.rgba;x[P]==null&&(x[P]=R.length,R.push(P))}}else for(var y=0;y<f.length;y++)for(var D=new Uint32Array(f[y]),S=D.length,C=0;C<S;C++){var P=D[C];if((C<g||P!=D[C-1]&&P!=D[C-g])&&x[P]==null&&(x[P]=R.length,R.push(P),R.length>=300))break}var L=h?E:!1,X=R.length;X<=256&&k==!1&&(X<=2?z=1:X<=4?z=2:X<=16?z=4:z=8,E&&(z=8),h=!0);for(var B=[],y=0;y<f.length;y++){var j=new Uint8Array(f[y]),H=new Uint32Array(j.buffer),$=0,q=0,W=g,Y=_,G=0;if(y!=0&&!L){for(var V=E||y==1||B[B.length-2].dispose==2?1:2,Z=0,xe=1e9,ce=0;ce<V;ce++){for(var mt=new Uint8Array(f[y-1-ce]),Ne=new Uint32Array(f[y-1-ce]),Pe=g,De=_,Me=-1,Be=-1,ft=0;ft<_;ft++)for(var jt=0;jt<g;jt++){var C=ft*g+jt;H[C]!=Ne[C]&&(jt<Pe&&(Pe=jt),jt>Me&&(Me=jt),ft<De&&(De=ft),ft>Be&&(Be=ft))}var Gt=Me==-1?1:(Me-Pe+1)*(Be-De+1);Gt<xe&&(xe=Gt,Z=ce,Me==-1?($=q=0,W=Y=1):($=Pe,q=De,W=Me-Pe+1,Y=Be-De+1))}var mt=new Uint8Array(f[y-1-Z]);Z==1&&(B[B.length-1].dispose=2);var Fe=new Uint8Array(W*Y*4);new Uint32Array(Fe.buffer),u._copyTile(mt,g,_,Fe,W,Y,-$,-q,0),u._copyTile(j,g,_,Fe,W,Y,-$,-q,3)?(u._copyTile(j,g,_,Fe,W,Y,-$,-q,2),G=1):(u._copyTile(j,g,_,Fe,W,Y,-$,-q,0),G=0),j=Fe,H=new Uint32Array(j.buffer)}var ht=4*W;if(X<=256&&k==!1){ht=Math.ceil(z*W/8);for(var Fe=new Uint8Array(ht*Y),ft=0;ft<Y;ft++){var C=ft*ht,Kt=ft*W;if(z==8)for(var jt=0;jt<W;jt++)Fe[C+jt]=x[H[Kt+jt]];else if(z==4)for(var jt=0;jt<W;jt++)Fe[C+(jt>>1)]|=x[H[Kt+jt]]<<4-(jt&1)*4;else if(z==2)for(var jt=0;jt<W;jt++)Fe[C+(jt>>2)]|=x[H[Kt+jt]]<<6-(jt&3)*2;else if(z==1)for(var jt=0;jt<W;jt++)Fe[C+(jt>>3)]|=x[H[Kt+jt]]<<7-(jt&7)*1}j=Fe,A=3,l=1}else if(h==!1&&f.length==1){for(var Fe=new Uint8Array(W*Y*3),Jt=W*Y,C=0;C<Jt;C++){var Wt=C*3,Br=C*4;Fe[Wt]=j[Br],Fe[Wt+1]=j[Br+1],Fe[Wt+2]=j[Br+2]}j=Fe,A=2,l=3,ht=3*W}B.push({rect:{x:$,y:q,width:W,height:Y},img:j,bpl:ht,bpp:l,blend:G,dispose:L?1:0})}return{ctype:A,depth:z,plte:R,gotAlpha:h,frames:B}},u.encode._filterZero=function(f,g,_,p,E){for(var k=[],A=0;A<5;A++)if(!(g*p>5e5&&(A==2||A==3||A==4))){for(var z=0;z<g;z++)u.encode._filterLine(E,f,z,p,_,A);if(k.push(v.deflate(E)),_==1)break}for(var l,s=1e9,y=0;y<k.length;y++)k[y].length<s&&(l=y,s=k[y].length);return k[l]},u.encode._filterLine=function(f,g,_,p,E,k){var A=_*p,z=A+_,l=u.decode._paeth;if(f[z]=k,z++,k==0)for(var s=0;s<p;s++)f[z+s]=g[A+s];else if(k==1){for(var s=0;s<E;s++)f[z+s]=g[A+s];for(var s=E;s<p;s++)f[z+s]=g[A+s]-g[A+s-E]+256&255}else if(_==0){for(var s=0;s<E;s++)f[z+s]=g[A+s];if(k==2)for(var s=E;s<p;s++)f[z+s]=g[A+s];if(k==3)for(var s=E;s<p;s++)f[z+s]=g[A+s]-(g[A+s-E]>>1)+256&255;if(k==4)for(var s=E;s<p;s++)f[z+s]=g[A+s]-l(g[A+s-E],0,0)+256&255}else{if(k==2)for(var s=0;s<p;s++)f[z+s]=g[A+s]+256-g[A+s-p]&255;if(k==3){for(var s=0;s<E;s++)f[z+s]=g[A+s]+256-(g[A+s-p]>>1)&255;for(var s=E;s<p;s++)f[z+s]=g[A+s]+256-(g[A+s-p]+g[A+s-E]>>1)&255}if(k==4){for(var s=0;s<E;s++)f[z+s]=g[A+s]+256-l(0,g[A+s-p],0)&255;for(var s=E;s<p;s++)f[z+s]=g[A+s]+256-l(g[A+s-E],g[A+s-p],g[A+s-E-p])&255}}},u.crc={table:(function(){for(var f=new Uint32Array(256),g=0;g<256;g++){for(var _=g,p=0;p<8;p++)_&1?_=3988292384^_>>>1:_=_>>>1;f[g]=_}return f})(),update:function(f,g,_,p){for(var E=0;E<p;E++)f=u.crc.table[(f^g[_+E])&255]^f>>>8;return f},crc:function(f,g,_){return u.crc.update(4294967295,f,g,_)^4294967295}},u.quantize=function(f,g,_){for(var p=[],E=0,k=0;k<f.length;k++)p.push(u.encode.alphaMul(new Uint8Array(f[k]),_)),E+=f[k].byteLength;for(var A=new Uint8Array(E),z=new Uint32Array(A.buffer),l=0,k=0;k<p.length;k++){for(var s=p[k],y=s.length,w=0;w<y;w++)A[l+w]=s[w];l+=y}var S={i0:0,i1:A.length,bst:null,est:null,tdst:0,left:null,right:null};S.bst=u.quantize.stats(A,S.i0,S.i1),S.est=u.quantize.estats(S.bst);for(var C=[S];C.length<g;){for(var h=0,x=0,k=0;k<C.length;k++)C[k].est.L>h&&(h=C[k].est.L,x=k);if(h<.001)break;var R=C[x],M=u.quantize.splitPixels(A,z,R.i0,R.i1,R.est.e,R.est.eMq255),P={i0:R.i0,i1:M,bst:null,est:null,tdst:0,left:null,right:null};P.bst=u.quantize.stats(A,P.i0,P.i1),P.est=u.quantize.estats(P.bst);var D={i0:M,i1:R.i1,bst:null,est:null,tdst:0,left:null,right:null};D.bst={R:[],m:[],N:R.bst.N-P.bst.N};for(var k=0;k<16;k++)D.bst.R[k]=R.bst.R[k]-P.bst.R[k];for(var k=0;k<4;k++)D.bst.m[k]=R.bst.m[k]-P.bst.m[k];D.est=u.quantize.estats(D.bst),R.left=P,R.right=D,C[x]=P,C.push(D)}C.sort(function(V,Z){return Z.bst.N-V.bst.N});for(var L=0;L<p.length;L++){for(var X=u.quantize.planeDst,B=new Uint8Array(p[L].buffer),j=new Uint32Array(p[L].buffer),H=B.length,k=0;k<H;k+=4){for(var $=B[k]*.00392156862745098,q=B[k+1]*.00392156862745098,W=B[k+2]*.00392156862745098,Y=B[k+3]*.00392156862745098,G=S;G.left;)G=X(G.est,$,q,W,Y)<=0?G.left:G.right;j[k>>2]=G.est.rgba}p[L]=j.buffer}return{bufs:p,plte:C}},u.quantize.getNearest=function(f,g,_,p,E){if(f.left==null)return f.tdst=u.quantize.dist(f.est.q,g,_,p,E),f;var k=u.quantize.planeDst(f.est,g,_,p,E),A=f.left,z=f.right;k>0&&(A=f.right,z=f.left);var l=u.quantize.getNearest(A,g,_,p,E);if(l.tdst<=k*k)return l;var s=u.quantize.getNearest(z,g,_,p,E);return s.tdst<l.tdst?s:l},u.quantize.planeDst=function(f,g,_,p,E){var k=f.e;return k[0]*g+k[1]*_+k[2]*p+k[3]*E-f.eMq},u.quantize.dist=function(f,g,_,p,E){var k=g-f[0],A=_-f[1],z=p-f[2],l=E-f[3];return k*k+A*A+z*z+l*l},u.quantize.splitPixels=function(f,g,_,p,E,k){var A=u.quantize.vecDot;for(p-=4;_<p;){for(;A(f,_,E)<=k;)_+=4;for(;A(f,p,E)>k;)p-=4;if(_>=p)break;var z=g[_>>2];g[_>>2]=g[p>>2],g[p>>2]=z,_+=4,p-=4}for(;A(f,_,E)>k;)_-=4;return _+4},u.quantize.vecDot=function(f,g,_){return f[g]*_[0]+f[g+1]*_[1]+f[g+2]*_[2]+f[g+3]*_[3]},u.quantize.stats=function(f,g,_){for(var p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],E=[0,0,0,0],k=_-g>>2,A=g;A<_;A+=4){var z=f[A]*.00392156862745098,l=f[A+1]*(1/255),s=f[A+2]*(1/255),y=f[A+3]*(1/255);E[0]+=z,E[1]+=l,E[2]+=s,E[3]+=y,p[0]+=z*z,p[1]+=z*l,p[2]+=z*s,p[3]+=z*y,p[5]+=l*l,p[6]+=l*s,p[7]+=l*y,p[10]+=s*s,p[11]+=s*y,p[15]+=y*y}return p[4]=p[1],p[8]=p[2],p[12]=p[3],p[9]=p[6],p[13]=p[7],p[14]=p[11],{R:p,m:E,N:k}},u.quantize.estats=function(f){var g=f.R,_=f.m,p=f.N,E=_[0],k=_[1],A=_[2],z=_[3],l=p==0?0:1/p,s=[g[0]-E*E*l,g[1]-E*k*l,g[2]-E*A*l,g[3]-E*z*l,g[4]-k*E*l,g[5]-k*k*l,g[6]-k*A*l,g[7]-k*z*l,g[8]-A*E*l,g[9]-A*k*l,g[10]-A*A*l,g[11]-A*z*l,g[12]-z*E*l,g[13]-z*k*l,g[14]-z*A*l,g[15]-z*z*l],y=s,w=u.M4,S=[.5,.5,.5,.5],C=0,h=0;if(p!=0)for(var x=0;x<10&&(S=w.multVec(y,S),h=Math.sqrt(w.dot(S,S)),S=w.sml(1/h,S),!(Math.abs(h-C)<1e-9));x++)C=h;var R=[E*l,k*l,A*l,z*l],M=w.dot(w.sml(255,R),S),P=R[3]<.001?0:1/R[3];return{Cov:s,q:R,e:S,L:C,eMq255:M,eMq:w.dot(S,R),rgba:(Math.round(255*R[3])<<24|Math.round(255*R[2]*P)<<16|Math.round(255*R[1]*P)<<8|Math.round(255*R[0]*P)<<0)>>>0}},u.M4={multVec:function(f,g){return[f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3],f[4]*g[0]+f[5]*g[1]+f[6]*g[2]+f[7]*g[3],f[8]*g[0]+f[9]*g[1]+f[10]*g[2]+f[11]*g[3],f[12]*g[0]+f[13]*g[1]+f[14]*g[2]+f[15]*g[3]]},dot:function(f,g){return f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3]},sml:function(f,g){return[f*g[0],f*g[1],f*g[2],f*g[3]]}},u.encode.alphaMul=function(f,g){for(var _=new Uint8Array(f.length),p=f.length>>2,E=0;E<p;E++){var k=E<<2,A=f[k+3];g&&(A=A<128?0:255);var z=A*(1/255);_[k+0]=f[k+0]*z,_[k+1]=f[k+1]*z,_[k+2]=f[k+2]*z,_[k+3]=A}return _}})(o,c)})()}),"./node_modules/upng-js/node_modules/pako/index.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js").assign,c=t("./node_modules/upng-js/node_modules/pako/lib/deflate.js"),u=t("./node_modules/upng-js/node_modules/pako/lib/inflate.js"),v=t("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),f={};o(f,c,u,v),e.exports=f}),"./node_modules/upng-js/node_modules/pako/lib/deflate.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),u=t("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),v=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),f=t("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),g=Object.prototype.toString,_=0,p=4,E=0,k=1,A=2,z=-1,l=0,s=8;function y(h){if(!(this instanceof y))return new y(h);this.options=c.assign({level:z,method:s,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},h||{});var x=this.options;x.raw&&x.windowBits>0?x.windowBits=-x.windowBits:x.gzip&&x.windowBits>0&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var R=o.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(R!==E)throw new Error(v[R]);if(x.header&&o.deflateSetHeader(this.strm,x.header),x.dictionary){var M;if(typeof x.dictionary=="string"?M=u.string2buf(x.dictionary):g.call(x.dictionary)==="[object ArrayBuffer]"?M=new Uint8Array(x.dictionary):M=x.dictionary,R=o.deflateSetDictionary(this.strm,M),R!==E)throw new Error(v[R]);this._dict_set=!0}}y.prototype.push=function(h,x){var R=this.strm,M=this.options.chunkSize,P,D;if(this.ended)return!1;D=x===~~x?x:x===!0?p:_,typeof h=="string"?R.input=u.string2buf(h):g.call(h)==="[object ArrayBuffer]"?R.input=new Uint8Array(h):R.input=h,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new c.Buf8(M),R.next_out=0,R.avail_out=M),P=o.deflate(R,D),P!==k&&P!==E)return this.onEnd(P),this.ended=!0,!1;(R.avail_out===0||R.avail_in===0&&(D===p||D===A))&&(this.options.to==="string"?this.onData(u.buf2binstring(c.shrinkBuf(R.output,R.next_out))):this.onData(c.shrinkBuf(R.output,R.next_out)))}while((R.avail_in>0||R.avail_out===0)&&P!==k);return D===p?(P=o.deflateEnd(this.strm),this.onEnd(P),this.ended=!0,P===E):(D===A&&(this.onEnd(E),R.avail_out=0),!0)},y.prototype.onData=function(h){this.chunks.push(h)},y.prototype.onEnd=function(h){h===E&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg};function w(h,x){var R=new y(x);if(R.push(h,!0),R.err)throw R.msg||v[R.err];return R.result}function S(h,x){return x=x||{},x.raw=!0,w(h,x)}function C(h,x){return x=x||{},x.gzip=!0,w(h,x)}r.Deflate=y,r.deflate=w,r.deflateRaw=S,r.gzip=C}),"./node_modules/upng-js/node_modules/pako/lib/inflate.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),u=t("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),v=t("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),f=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),g=t("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),_=t("./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js"),p=Object.prototype.toString;function E(z){if(!(this instanceof E))return new E(z);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},z||{});var l=this.options;l.raw&&l.windowBits>=0&&l.windowBits<16&&(l.windowBits=-l.windowBits,l.windowBits===0&&(l.windowBits=-15)),l.windowBits>=0&&l.windowBits<16&&!(z&&z.windowBits)&&(l.windowBits+=32),l.windowBits>15&&l.windowBits<48&&(l.windowBits&15||(l.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var s=o.inflateInit2(this.strm,l.windowBits);if(s!==v.Z_OK)throw new Error(f[s]);if(this.header=new _,o.inflateGetHeader(this.strm,this.header),l.dictionary&&(typeof l.dictionary=="string"?l.dictionary=u.string2buf(l.dictionary):p.call(l.dictionary)==="[object ArrayBuffer]"&&(l.dictionary=new Uint8Array(l.dictionary)),l.raw&&(s=o.inflateSetDictionary(this.strm,l.dictionary),s!==v.Z_OK)))throw new Error(f[s])}E.prototype.push=function(z,l){var s=this.strm,y=this.options.chunkSize,w=this.options.dictionary,S,C,h,x,R,M=!1;if(this.ended)return!1;C=l===~~l?l:l===!0?v.Z_FINISH:v.Z_NO_FLUSH,typeof z=="string"?s.input=u.binstring2buf(z):p.call(z)==="[object ArrayBuffer]"?s.input=new Uint8Array(z):s.input=z,s.next_in=0,s.avail_in=s.input.length;do{if(s.avail_out===0&&(s.output=new c.Buf8(y),s.next_out=0,s.avail_out=y),S=o.inflate(s,v.Z_NO_FLUSH),S===v.Z_NEED_DICT&&w&&(S=o.inflateSetDictionary(this.strm,w)),S===v.Z_BUF_ERROR&&M===!0&&(S=v.Z_OK,M=!1),S!==v.Z_STREAM_END&&S!==v.Z_OK)return this.onEnd(S),this.ended=!0,!1;s.next_out&&(s.avail_out===0||S===v.Z_STREAM_END||s.avail_in===0&&(C===v.Z_FINISH||C===v.Z_SYNC_FLUSH))&&(this.options.to==="string"?(h=u.utf8border(s.output,s.next_out),x=s.next_out-h,R=u.buf2string(s.output,h),s.next_out=x,s.avail_out=y-x,x&&c.arraySet(s.output,s.output,h,x,0),this.onData(R)):this.onData(c.shrinkBuf(s.output,s.next_out))),s.avail_in===0&&s.avail_out===0&&(M=!0)}while((s.avail_in>0||s.avail_out===0)&&S!==v.Z_STREAM_END);return S===v.Z_STREAM_END&&(C=v.Z_FINISH),C===v.Z_FINISH?(S=o.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===v.Z_OK):(C===v.Z_SYNC_FLUSH&&(this.onEnd(v.Z_OK),s.avail_out=0),!0)},E.prototype.onData=function(z){this.chunks.push(z)},E.prototype.onEnd=function(z){z===v.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=z,this.msg=this.strm.msg};function k(z,l){var s=new E(l);if(s.push(z,!0),s.err)throw s.msg||f[s.err];return s.result}function A(z,l){return l=l||{},l.raw=!0,k(z,l)}r.Inflate=E,r.inflate=k,r.inflateRaw=A,r.ungzip=k}),"./node_modules/upng-js/node_modules/pako/lib/utils/common.js":((e,r)=>{var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function o(v,f){return Object.prototype.hasOwnProperty.call(v,f)}r.assign=function(v){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var g=f.shift();if(g){if(typeof g!="object")throw new TypeError(g+"must be non-object");for(var _ in g)o(g,_)&&(v[_]=g[_])}}return v},r.shrinkBuf=function(v,f){return v.length===f?v:v.subarray?v.subarray(0,f):(v.length=f,v)};var c={arraySet:function(v,f,g,_,p){if(f.subarray&&v.subarray){v.set(f.subarray(g,g+_),p);return}for(var E=0;E<_;E++)v[p+E]=f[g+E]},flattenChunks:function(v){var f,g,_,p,E,k;for(_=0,f=0,g=v.length;f<g;f++)_+=v[f].length;for(k=new Uint8Array(_),p=0,f=0,g=v.length;f<g;f++)E=v[f],k.set(E,p),p+=E.length;return k}},u={arraySet:function(v,f,g,_,p){for(var E=0;E<_;E++)v[p+E]=f[g+E]},flattenChunks:function(v){return[].concat.apply([],v)}};r.setTyped=function(v){v?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,c)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,u))},r.setTyped(t)}),"./node_modules/upng-js/node_modules/pako/lib/utils/strings.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{c=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var v=new o.Buf8(256),f=0;f<256;f++)v[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;v[254]=v[254]=1,r.string2buf=function(_){var p,E,k,A,z,l=_.length,s=0;for(A=0;A<l;A++)E=_.charCodeAt(A),(E&64512)===55296&&A+1<l&&(k=_.charCodeAt(A+1),(k&64512)===56320&&(E=65536+(E-55296<<10)+(k-56320),A++)),s+=E<128?1:E<2048?2:E<65536?3:4;for(p=new o.Buf8(s),z=0,A=0;z<s;A++)E=_.charCodeAt(A),(E&64512)===55296&&A+1<l&&(k=_.charCodeAt(A+1),(k&64512)===56320&&(E=65536+(E-55296<<10)+(k-56320),A++)),E<128?p[z++]=E:E<2048?(p[z++]=192|E>>>6,p[z++]=128|E&63):E<65536?(p[z++]=224|E>>>12,p[z++]=128|E>>>6&63,p[z++]=128|E&63):(p[z++]=240|E>>>18,p[z++]=128|E>>>12&63,p[z++]=128|E>>>6&63,p[z++]=128|E&63);return p};function g(_,p){if(p<65534&&(_.subarray&&u||!_.subarray&&c))return String.fromCharCode.apply(null,o.shrinkBuf(_,p));for(var E="",k=0;k<p;k++)E+=String.fromCharCode(_[k]);return E}r.buf2binstring=function(_){return g(_,_.length)},r.binstring2buf=function(_){for(var p=new o.Buf8(_.length),E=0,k=p.length;E<k;E++)p[E]=_.charCodeAt(E);return p},r.buf2string=function(_,p){var E,k,A,z,l=p||_.length,s=new Array(l*2);for(k=0,E=0;E<l;){if(A=_[E++],A<128){s[k++]=A;continue}if(z=v[A],z>4){s[k++]=65533,E+=z-1;continue}for(A&=z===2?31:z===3?15:7;z>1&&E<l;)A=A<<6|_[E++]&63,z--;if(z>1){s[k++]=65533;continue}A<65536?s[k++]=A:(A-=65536,s[k++]=55296|A>>10&1023,s[k++]=56320|A&1023)}return g(s,k)},r.utf8border=function(_,p){var E;for(p=p||_.length,p>_.length&&(p=_.length),E=p-1;E>=0&&(_[E]&192)===128;)E--;return E<0||E===0?p:E+v[_[E]]>p?E:p}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js":(e=>{function r(t,o,c,u){for(var v=t&65535|0,f=t>>>16&65535|0,g=0;c!==0;){g=c>2e3?2e3:c,c-=g;do v=v+o[u++]|0,f=f+v|0;while(--g);v%=65521,f%=65521}return v|f<<16|0}e.exports=r}),"./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js":(e=>{e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js":(e=>{function r(){for(var c,u=[],v=0;v<256;v++){c=v;for(var f=0;f<8;f++)c=c&1?3988292384^c>>>1:c>>>1;u[v]=c}return u}var t=r();function o(c,u,v,f){var g=t,_=f+v;c^=-1;for(var p=f;p<_;p++)c=c>>>8^g[(c^u[p])&255];return c^-1}e.exports=o}),"./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js"),u=t("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),v=t("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),f=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),g=0,_=1,p=3,E=4,k=5,A=0,z=1,l=-2,s=-3,y=-5,w=-1,S=1,C=2,h=3,x=4,R=0,M=2,P=8,D=9,L=15,X=8,B=29,j=256,H=j+1+B,$=30,q=19,W=2*H+1,Y=15,G=3,V=258,Z=V+G+1,xe=32,ce=42,Ne=69,Pe=73,De=91,Me=103,Be=113,ft=666,jt=1,Gt=2,mt=3,Fe=4,ht=3;function Kt(J,ut){return J.msg=f[ut],ut}function Jt(J){return(J<<1)-(J>4?9:0)}function Wt(J){for(var ut=J.length;--ut>=0;)J[ut]=0}function Br(J){var ut=J.state,at=ut.pending;at>J.avail_out&&(at=J.avail_out),at!==0&&(o.arraySet(J.output,ut.pending_buf,ut.pending_out,at,J.next_out),J.next_out+=at,ut.pending_out+=at,J.total_out+=at,J.avail_out-=at,ut.pending-=at,ut.pending===0&&(ut.pending_out=0))}function zr(J,ut){c._tr_flush_block(J,J.block_start>=0?J.block_start:-1,J.strstart-J.block_start,ut),J.block_start=J.strstart,Br(J.strm)}function cr(J,ut){J.pending_buf[J.pending++]=ut}function Nr(J,ut){J.pending_buf[J.pending++]=ut>>>8&255,J.pending_buf[J.pending++]=ut&255}function At(J,ut,at,me){var Ze=J.avail_in;return Ze>me&&(Ze=me),Ze===0?0:(J.avail_in-=Ze,o.arraySet(ut,J.input,J.next_in,Ze,at),J.state.wrap===1?J.adler=u(J.adler,ut,Ze,at):J.state.wrap===2&&(J.adler=v(J.adler,ut,Ze,at)),J.next_in+=Ze,J.total_in+=Ze,Ze)}function Mt(J,ut){var at=J.max_chain_length,me=J.strstart,Ze,vt,Qr=J.prev_length,Xr=J.nice_match,Zr=J.strstart>J.w_size-Z?J.strstart-(J.w_size-Z):0,xn=J.window,Ei=J.w_mask,zn=J.prev,Pn=J.strstart+V,On=xn[me+Qr-1],mi=xn[me+Qr];J.prev_length>=J.good_match&&(at>>=2),Xr>J.lookahead&&(Xr=J.lookahead);do if(Ze=ut,!(xn[Ze+Qr]!==mi||xn[Ze+Qr-1]!==On||xn[Ze]!==xn[me]||xn[++Ze]!==xn[me+1])){me+=2,Ze++;do;while(xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&xn[++me]===xn[++Ze]&&me<Pn);if(vt=V-(Pn-me),me=Pn-V,vt>Qr){if(J.match_start=ut,Qr=vt,vt>=Xr)break;On=xn[me+Qr-1],mi=xn[me+Qr]}}while((ut=zn[ut&Ei])>Zr&&--at!==0);return Qr<=J.lookahead?Qr:J.lookahead}function Jr(J){var ut=J.w_size,at,me,Ze,vt,Qr;do{if(vt=J.window_size-J.lookahead-J.strstart,J.strstart>=ut+(ut-Z)){o.arraySet(J.window,J.window,ut,ut,0),J.match_start-=ut,J.strstart-=ut,J.block_start-=ut,me=J.hash_size,at=me;do Ze=J.head[--at],J.head[at]=Ze>=ut?Ze-ut:0;while(--me);me=ut,at=me;do Ze=J.prev[--at],J.prev[at]=Ze>=ut?Ze-ut:0;while(--me);vt+=ut}if(J.strm.avail_in===0)break;if(me=At(J.strm,J.window,J.strstart+J.lookahead,vt),J.lookahead+=me,J.lookahead+J.insert>=G)for(Qr=J.strstart-J.insert,J.ins_h=J.window[Qr],J.ins_h=(J.ins_h<<J.hash_shift^J.window[Qr+1])&J.hash_mask;J.insert&&(J.ins_h=(J.ins_h<<J.hash_shift^J.window[Qr+G-1])&J.hash_mask,J.prev[Qr&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=Qr,Qr++,J.insert--,!(J.lookahead+J.insert<G)););}while(J.lookahead<Z&&J.strm.avail_in!==0)}function Yr(J,ut){var at=65535;for(at>J.pending_buf_size-5&&(at=J.pending_buf_size-5);;){if(J.lookahead<=1){if(Jr(J),J.lookahead===0&&ut===g)return jt;if(J.lookahead===0)break}J.strstart+=J.lookahead,J.lookahead=0;var me=J.block_start+at;if((J.strstart===0||J.strstart>=me)&&(J.lookahead=J.strstart-me,J.strstart=me,zr(J,!1),J.strm.avail_out===0)||J.strstart-J.block_start>=J.w_size-Z&&(zr(J,!1),J.strm.avail_out===0))return jt}return J.insert=0,ut===E?(zr(J,!0),J.strm.avail_out===0?mt:Fe):(J.strstart>J.block_start&&(zr(J,!1),J.strm.avail_out),jt)}function ie(J,ut){for(var at,me;;){if(J.lookahead<Z){if(Jr(J),J.lookahead<Z&&ut===g)return jt;if(J.lookahead===0)break}if(at=0,J.lookahead>=G&&(J.ins_h=(J.ins_h<<J.hash_shift^J.window[J.strstart+G-1])&J.hash_mask,at=J.prev[J.strstart&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=J.strstart),at!==0&&J.strstart-at<=J.w_size-Z&&(J.match_length=Mt(J,at)),J.match_length>=G)if(me=c._tr_tally(J,J.strstart-J.match_start,J.match_length-G),J.lookahead-=J.match_length,J.match_length<=J.max_lazy_match&&J.lookahead>=G){J.match_length--;do J.strstart++,J.ins_h=(J.ins_h<<J.hash_shift^J.window[J.strstart+G-1])&J.hash_mask,at=J.prev[J.strstart&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=J.strstart;while(--J.match_length!==0);J.strstart++}else J.strstart+=J.match_length,J.match_length=0,J.ins_h=J.window[J.strstart],J.ins_h=(J.ins_h<<J.hash_shift^J.window[J.strstart+1])&J.hash_mask;else me=c._tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++;if(me&&(zr(J,!1),J.strm.avail_out===0))return jt}return J.insert=J.strstart<G-1?J.strstart:G-1,ut===E?(zr(J,!0),J.strm.avail_out===0?mt:Fe):J.last_lit&&(zr(J,!1),J.strm.avail_out===0)?jt:Gt}function ve(J,ut){for(var at,me,Ze;;){if(J.lookahead<Z){if(Jr(J),J.lookahead<Z&&ut===g)return jt;if(J.lookahead===0)break}if(at=0,J.lookahead>=G&&(J.ins_h=(J.ins_h<<J.hash_shift^J.window[J.strstart+G-1])&J.hash_mask,at=J.prev[J.strstart&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=J.strstart),J.prev_length=J.match_length,J.prev_match=J.match_start,J.match_length=G-1,at!==0&&J.prev_length<J.max_lazy_match&&J.strstart-at<=J.w_size-Z&&(J.match_length=Mt(J,at),J.match_length<=5&&(J.strategy===S||J.match_length===G&&J.strstart-J.match_start>4096)&&(J.match_length=G-1)),J.prev_length>=G&&J.match_length<=J.prev_length){Ze=J.strstart+J.lookahead-G,me=c._tr_tally(J,J.strstart-1-J.prev_match,J.prev_length-G),J.lookahead-=J.prev_length-1,J.prev_length-=2;do++J.strstart<=Ze&&(J.ins_h=(J.ins_h<<J.hash_shift^J.window[J.strstart+G-1])&J.hash_mask,at=J.prev[J.strstart&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=J.strstart);while(--J.prev_length!==0);if(J.match_available=0,J.match_length=G-1,J.strstart++,me&&(zr(J,!1),J.strm.avail_out===0))return jt}else if(J.match_available){if(me=c._tr_tally(J,0,J.window[J.strstart-1]),me&&zr(J,!1),J.strstart++,J.lookahead--,J.strm.avail_out===0)return jt}else J.match_available=1,J.strstart++,J.lookahead--}return J.match_available&&(me=c._tr_tally(J,0,J.window[J.strstart-1]),J.match_available=0),J.insert=J.strstart<G-1?J.strstart:G-1,ut===E?(zr(J,!0),J.strm.avail_out===0?mt:Fe):J.last_lit&&(zr(J,!1),J.strm.avail_out===0)?jt:Gt}function we(J,ut){for(var at,me,Ze,vt,Qr=J.window;;){if(J.lookahead<=V){if(Jr(J),J.lookahead<=V&&ut===g)return jt;if(J.lookahead===0)break}if(J.match_length=0,J.lookahead>=G&&J.strstart>0&&(Ze=J.strstart-1,me=Qr[Ze],me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze])){vt=J.strstart+V;do;while(me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&Ze<vt);J.match_length=V-(vt-Ze),J.match_length>J.lookahead&&(J.match_length=J.lookahead)}if(J.match_length>=G?(at=c._tr_tally(J,1,J.match_length-G),J.lookahead-=J.match_length,J.strstart+=J.match_length,J.match_length=0):(at=c._tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++),at&&(zr(J,!1),J.strm.avail_out===0))return jt}return J.insert=0,ut===E?(zr(J,!0),J.strm.avail_out===0?mt:Fe):J.last_lit&&(zr(J,!1),J.strm.avail_out===0)?jt:Gt}function it(J,ut){for(var at;;){if(J.lookahead===0&&(Jr(J),J.lookahead===0)){if(ut===g)return jt;break}if(J.match_length=0,at=c._tr_tally(J,0,J.window[J.strstart]),J.lookahead--,J.strstart++,at&&(zr(J,!1),J.strm.avail_out===0))return jt}return J.insert=0,ut===E?(zr(J,!0),J.strm.avail_out===0?mt:Fe):J.last_lit&&(zr(J,!1),J.strm.avail_out===0)?jt:Gt}function rt(J,ut,at,me,Ze){this.good_length=J,this.max_lazy=ut,this.nice_length=at,this.max_chain=me,this.func=Ze}var Yt;Yt=[new rt(0,0,0,0,Yr),new rt(4,4,8,4,ie),new rt(4,5,16,8,ie),new rt(4,6,32,32,ie),new rt(4,4,16,16,ve),new rt(8,16,32,32,ve),new rt(8,16,128,128,ve),new rt(8,32,128,256,ve),new rt(32,128,258,1024,ve),new rt(32,258,258,4096,ve)];function Ft(J){J.window_size=2*J.w_size,Wt(J.head),J.max_lazy_match=Yt[J.level].max_lazy,J.good_match=Yt[J.level].good_length,J.nice_match=Yt[J.level].nice_length,J.max_chain_length=Yt[J.level].max_chain,J.strstart=0,J.block_start=0,J.lookahead=0,J.insert=0,J.match_length=J.prev_length=G-1,J.match_available=0,J.ins_h=0}function re(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=P,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(W*2),this.dyn_dtree=new o.Buf16((2*$+1)*2),this.bl_tree=new o.Buf16((2*q+1)*2),Wt(this.dyn_ltree),Wt(this.dyn_dtree),Wt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(Y+1),this.heap=new o.Buf16(2*H+1),Wt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*H+1),Wt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function tt(J){var ut;return!J||!J.state?Kt(J,l):(J.total_in=J.total_out=0,J.data_type=M,ut=J.state,ut.pending=0,ut.pending_out=0,ut.wrap<0&&(ut.wrap=-ut.wrap),ut.status=ut.wrap?ce:Be,J.adler=ut.wrap===2?0:1,ut.last_flush=g,c._tr_init(ut),A)}function lt(J){var ut=tt(J);return ut===A&&Ft(J.state),ut}function ar(J,ut){return!J||!J.state||J.state.wrap!==2?l:(J.state.gzhead=ut,A)}function et(J,ut,at,me,Ze,vt){if(!J)return l;var Qr=1;if(ut===w&&(ut=6),me<0?(Qr=0,me=-me):me>15&&(Qr=2,me-=16),Ze<1||Ze>D||at!==P||me<8||me>15||ut<0||ut>9||vt<0||vt>x)return Kt(J,l);me===8&&(me=9);var Xr=new re;return J.state=Xr,Xr.strm=J,Xr.wrap=Qr,Xr.gzhead=null,Xr.w_bits=me,Xr.w_size=1<<Xr.w_bits,Xr.w_mask=Xr.w_size-1,Xr.hash_bits=Ze+7,Xr.hash_size=1<<Xr.hash_bits,Xr.hash_mask=Xr.hash_size-1,Xr.hash_shift=~~((Xr.hash_bits+G-1)/G),Xr.window=new o.Buf8(Xr.w_size*2),Xr.head=new o.Buf16(Xr.hash_size),Xr.prev=new o.Buf16(Xr.w_size),Xr.lit_bufsize=1<<Ze+6,Xr.pending_buf_size=Xr.lit_bufsize*4,Xr.pending_buf=new o.Buf8(Xr.pending_buf_size),Xr.d_buf=1*Xr.lit_bufsize,Xr.l_buf=3*Xr.lit_bufsize,Xr.level=ut,Xr.strategy=vt,Xr.method=at,lt(J)}function Ot(J,ut){return et(J,ut,P,L,X,R)}function se(J,ut){var at,me,Ze,vt;if(!J||!J.state||ut>k||ut<0)return J?Kt(J,l):l;if(me=J.state,!J.output||!J.input&&J.avail_in!==0||me.status===ft&&ut!==E)return Kt(J,J.avail_out===0?y:l);if(me.strm=J,at=me.last_flush,me.last_flush=ut,me.status===ce)if(me.wrap===2)J.adler=0,cr(me,31),cr(me,139),cr(me,8),me.gzhead?(cr(me,(me.gzhead.text?1:0)+(me.gzhead.hcrc?2:0)+(me.gzhead.extra?4:0)+(me.gzhead.name?8:0)+(me.gzhead.comment?16:0)),cr(me,me.gzhead.time&255),cr(me,me.gzhead.time>>8&255),cr(me,me.gzhead.time>>16&255),cr(me,me.gzhead.time>>24&255),cr(me,me.level===9?2:me.strategy>=C||me.level<2?4:0),cr(me,me.gzhead.os&255),me.gzhead.extra&&me.gzhead.extra.length&&(cr(me,me.gzhead.extra.length&255),cr(me,me.gzhead.extra.length>>8&255)),me.gzhead.hcrc&&(J.adler=v(J.adler,me.pending_buf,me.pending,0)),me.gzindex=0,me.status=Ne):(cr(me,0),cr(me,0),cr(me,0),cr(me,0),cr(me,0),cr(me,me.level===9?2:me.strategy>=C||me.level<2?4:0),cr(me,ht),me.status=Be);else{var Qr=P+(me.w_bits-8<<4)<<8,Xr=-1;me.strategy>=C||me.level<2?Xr=0:me.level<6?Xr=1:me.level===6?Xr=2:Xr=3,Qr|=Xr<<6,me.strstart!==0&&(Qr|=xe),Qr+=31-Qr%31,me.status=Be,Nr(me,Qr),me.strstart!==0&&(Nr(me,J.adler>>>16),Nr(me,J.adler&65535)),J.adler=1}if(me.status===Ne)if(me.gzhead.extra){for(Ze=me.pending;me.gzindex<(me.gzhead.extra.length&65535)&&!(me.pending===me.pending_buf_size&&(me.gzhead.hcrc&&me.pending>Ze&&(J.adler=v(J.adler,me.pending_buf,me.pending-Ze,Ze)),Br(J),Ze=me.pending,me.pending===me.pending_buf_size));)cr(me,me.gzhead.extra[me.gzindex]&255),me.gzindex++;me.gzhead.hcrc&&me.pending>Ze&&(J.adler=v(J.adler,me.pending_buf,me.pending-Ze,Ze)),me.gzindex===me.gzhead.extra.length&&(me.gzindex=0,me.status=Pe)}else me.status=Pe;if(me.status===Pe)if(me.gzhead.name){Ze=me.pending;do{if(me.pending===me.pending_buf_size&&(me.gzhead.hcrc&&me.pending>Ze&&(J.adler=v(J.adler,me.pending_buf,me.pending-Ze,Ze)),Br(J),Ze=me.pending,me.pending===me.pending_buf_size)){vt=1;break}me.gzindex<me.gzhead.name.length?vt=me.gzhead.name.charCodeAt(me.gzindex++)&255:vt=0,cr(me,vt)}while(vt!==0);me.gzhead.hcrc&&me.pending>Ze&&(J.adler=v(J.adler,me.pending_buf,me.pending-Ze,Ze)),vt===0&&(me.gzindex=0,me.status=De)}else me.status=De;if(me.status===De)if(me.gzhead.comment){Ze=me.pending;do{if(me.pending===me.pending_buf_size&&(me.gzhead.hcrc&&me.pending>Ze&&(J.adler=v(J.adler,me.pending_buf,me.pending-Ze,Ze)),Br(J),Ze=me.pending,me.pending===me.pending_buf_size)){vt=1;break}me.gzindex<me.gzhead.comment.length?vt=me.gzhead.comment.charCodeAt(me.gzindex++)&255:vt=0,cr(me,vt)}while(vt!==0);me.gzhead.hcrc&&me.pending>Ze&&(J.adler=v(J.adler,me.pending_buf,me.pending-Ze,Ze)),vt===0&&(me.status=Me)}else me.status=Me;if(me.status===Me&&(me.gzhead.hcrc?(me.pending+2>me.pending_buf_size&&Br(J),me.pending+2<=me.pending_buf_size&&(cr(me,J.adler&255),cr(me,J.adler>>8&255),J.adler=0,me.status=Be)):me.status=Be),me.pending!==0){if(Br(J),J.avail_out===0)return me.last_flush=-1,A}else if(J.avail_in===0&&Jt(ut)<=Jt(at)&&ut!==E)return Kt(J,y);if(me.status===ft&&J.avail_in!==0)return Kt(J,y);if(J.avail_in!==0||me.lookahead!==0||ut!==g&&me.status!==ft){var Zr=me.strategy===C?it(me,ut):me.strategy===h?we(me,ut):Yt[me.level].func(me,ut);if((Zr===mt||Zr===Fe)&&(me.status=ft),Zr===jt||Zr===mt)return J.avail_out===0&&(me.last_flush=-1),A;if(Zr===Gt&&(ut===_?c._tr_align(me):ut!==k&&(c._tr_stored_block(me,0,0,!1),ut===p&&(Wt(me.head),me.lookahead===0&&(me.strstart=0,me.block_start=0,me.insert=0))),Br(J),J.avail_out===0))return me.last_flush=-1,A}return ut!==E?A:me.wrap<=0?z:(me.wrap===2?(cr(me,J.adler&255),cr(me,J.adler>>8&255),cr(me,J.adler>>16&255),cr(me,J.adler>>24&255),cr(me,J.total_in&255),cr(me,J.total_in>>8&255),cr(me,J.total_in>>16&255),cr(me,J.total_in>>24&255)):(Nr(me,J.adler>>>16),Nr(me,J.adler&65535)),Br(J),me.wrap>0&&(me.wrap=-me.wrap),me.pending!==0?A:z)}function xt(J){var ut;return!J||!J.state?l:(ut=J.state.status,ut!==ce&&ut!==Ne&&ut!==Pe&&ut!==De&&ut!==Me&&ut!==Be&&ut!==ft?Kt(J,l):(J.state=null,ut===Be?Kt(J,s):A))}function Vr(J,ut){var at=ut.length,me,Ze,vt,Qr,Xr,Zr,xn,Ei;if(!J||!J.state||(me=J.state,Qr=me.wrap,Qr===2||Qr===1&&me.status!==ce||me.lookahead))return l;for(Qr===1&&(J.adler=u(J.adler,ut,at,0)),me.wrap=0,at>=me.w_size&&(Qr===0&&(Wt(me.head),me.strstart=0,me.block_start=0,me.insert=0),Ei=new o.Buf8(me.w_size),o.arraySet(Ei,ut,at-me.w_size,me.w_size,0),ut=Ei,at=me.w_size),Xr=J.avail_in,Zr=J.next_in,xn=J.input,J.avail_in=at,J.next_in=0,J.input=ut,Jr(me);me.lookahead>=G;){Ze=me.strstart,vt=me.lookahead-(G-1);do me.ins_h=(me.ins_h<<me.hash_shift^me.window[Ze+G-1])&me.hash_mask,me.prev[Ze&me.w_mask]=me.head[me.ins_h],me.head[me.ins_h]=Ze,Ze++;while(--vt);me.strstart=Ze,me.lookahead=G-1,Jr(me)}return me.strstart+=me.lookahead,me.block_start=me.strstart,me.insert=me.lookahead,me.lookahead=0,me.match_length=me.prev_length=G-1,me.match_available=0,J.next_in=Zr,J.input=xn,J.avail_in=Xr,me.wrap=Qr,A}r.deflateInit=Ot,r.deflateInit2=et,r.deflateReset=lt,r.deflateResetKeep=tt,r.deflateSetHeader=ar,r.deflate=se,r.deflateEnd=xt,r.deflateSetDictionary=Vr,r.deflateInfo="pako deflate (from Nodeca project)"}),"./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js":(e=>{function r(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=r}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js":(e=>{var r=30,t=12;e.exports=function(o,c){var u,v,f,g,_,p,E,k,A,z,l,s,y,w,S,C,h,x,R,M,P,D,L,X,B;u=o.state,v=o.next_in,X=o.input,f=v+(o.avail_in-5),g=o.next_out,B=o.output,_=g-(c-o.avail_out),p=g+(o.avail_out-257),E=u.dmax,k=u.wsize,A=u.whave,z=u.wnext,l=u.window,s=u.hold,y=u.bits,w=u.lencode,S=u.distcode,C=(1<<u.lenbits)-1,h=(1<<u.distbits)-1;e:do{y<15&&(s+=X[v++]<<y,y+=8,s+=X[v++]<<y,y+=8),x=w[s&C];t:for(;;){if(R=x>>>24,s>>>=R,y-=R,R=x>>>16&255,R===0)B[g++]=x&65535;else if(R&16){M=x&65535,R&=15,R&&(y<R&&(s+=X[v++]<<y,y+=8),M+=s&(1<<R)-1,s>>>=R,y-=R),y<15&&(s+=X[v++]<<y,y+=8,s+=X[v++]<<y,y+=8),x=S[s&h];r:for(;;){if(R=x>>>24,s>>>=R,y-=R,R=x>>>16&255,R&16){if(P=x&65535,R&=15,y<R&&(s+=X[v++]<<y,y+=8,y<R&&(s+=X[v++]<<y,y+=8)),P+=s&(1<<R)-1,P>E){o.msg="invalid distance too far back",u.mode=r;break e}if(s>>>=R,y-=R,R=g-_,P>R){if(R=P-R,R>A&&u.sane){o.msg="invalid distance too far back",u.mode=r;break e}if(D=0,L=l,z===0){if(D+=k-R,R<M){M-=R;do B[g++]=l[D++];while(--R);D=g-P,L=B}}else if(z<R){if(D+=k+z-R,R-=z,R<M){M-=R;do B[g++]=l[D++];while(--R);if(D=0,z<M){R=z,M-=R;do B[g++]=l[D++];while(--R);D=g-P,L=B}}}else if(D+=z-R,R<M){M-=R;do B[g++]=l[D++];while(--R);D=g-P,L=B}for(;M>2;)B[g++]=L[D++],B[g++]=L[D++],B[g++]=L[D++],M-=3;M&&(B[g++]=L[D++],M>1&&(B[g++]=L[D++]))}else{D=g-P;do B[g++]=B[D++],B[g++]=B[D++],B[g++]=B[D++],M-=3;while(M>2);M&&(B[g++]=B[D++],M>1&&(B[g++]=B[D++]))}}else if(R&64){o.msg="invalid distance code",u.mode=r;break e}else{x=S[(x&65535)+(s&(1<<R)-1)];continue r}break}}else if(R&64)if(R&32){u.mode=t;break e}else{o.msg="invalid literal/length code",u.mode=r;break e}else{x=w[(x&65535)+(s&(1<<R)-1)];continue t}break}}while(v<f&&g<p);M=y>>3,v-=M,y-=M<<3,s&=(1<<y)-1,o.next_in=v,o.next_out=g,o.avail_in=v<f?5+(f-v):5-(v-f),o.avail_out=g<p?257+(p-g):257-(g-p),u.hold=s,u.bits=y}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),u=t("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),v=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js"),f=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js"),g=0,_=1,p=2,E=4,k=5,A=6,z=0,l=1,s=2,y=-2,w=-3,S=-4,C=-5,h=8,x=1,R=2,M=3,P=4,D=5,L=6,X=7,B=8,j=9,H=10,$=11,q=12,W=13,Y=14,G=15,V=16,Z=17,xe=18,ce=19,Ne=20,Pe=21,De=22,Me=23,Be=24,ft=25,jt=26,Gt=27,mt=28,Fe=29,ht=30,Kt=31,Jt=32,Wt=852,Br=592,zr=15,cr=zr;function Nr(et){return(et>>>24&255)+(et>>>8&65280)+((et&65280)<<8)+((et&255)<<24)}function At(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Mt(et){var Ot;return!et||!et.state?y:(Ot=et.state,et.total_in=et.total_out=Ot.total=0,et.msg="",Ot.wrap&&(et.adler=Ot.wrap&1),Ot.mode=x,Ot.last=0,Ot.havedict=0,Ot.dmax=32768,Ot.head=null,Ot.hold=0,Ot.bits=0,Ot.lencode=Ot.lendyn=new o.Buf32(Wt),Ot.distcode=Ot.distdyn=new o.Buf32(Br),Ot.sane=1,Ot.back=-1,z)}function Jr(et){var Ot;return!et||!et.state?y:(Ot=et.state,Ot.wsize=0,Ot.whave=0,Ot.wnext=0,Mt(et))}function Yr(et,Ot){var se,xt;return!et||!et.state||(xt=et.state,Ot<0?(se=0,Ot=-Ot):(se=(Ot>>4)+1,Ot<48&&(Ot&=15)),Ot&&(Ot<8||Ot>15))?y:(xt.window!==null&&xt.wbits!==Ot&&(xt.window=null),xt.wrap=se,xt.wbits=Ot,Jr(et))}function ie(et,Ot){var se,xt;return et?(xt=new At,et.state=xt,xt.window=null,se=Yr(et,Ot),se!==z&&(et.state=null),se):y}function ve(et){return ie(et,cr)}var we=!0,it,rt;function Yt(et){if(we){var Ot;for(it=new o.Buf32(512),rt=new o.Buf32(32),Ot=0;Ot<144;)et.lens[Ot++]=8;for(;Ot<256;)et.lens[Ot++]=9;for(;Ot<280;)et.lens[Ot++]=7;for(;Ot<288;)et.lens[Ot++]=8;for(f(_,et.lens,0,288,it,0,et.work,{bits:9}),Ot=0;Ot<32;)et.lens[Ot++]=5;f(p,et.lens,0,32,rt,0,et.work,{bits:5}),we=!1}et.lencode=it,et.lenbits=9,et.distcode=rt,et.distbits=5}function Ft(et,Ot,se,xt){var Vr,J=et.state;return J.window===null&&(J.wsize=1<<J.wbits,J.wnext=0,J.whave=0,J.window=new o.Buf8(J.wsize)),xt>=J.wsize?(o.arraySet(J.window,Ot,se-J.wsize,J.wsize,0),J.wnext=0,J.whave=J.wsize):(Vr=J.wsize-J.wnext,Vr>xt&&(Vr=xt),o.arraySet(J.window,Ot,se-xt,Vr,J.wnext),xt-=Vr,xt?(o.arraySet(J.window,Ot,se-xt,xt,0),J.wnext=xt,J.whave=J.wsize):(J.wnext+=Vr,J.wnext===J.wsize&&(J.wnext=0),J.whave<J.wsize&&(J.whave+=Vr))),0}function re(et,Ot){var se,xt,Vr,J,ut,at,me,Ze,vt,Qr,Xr,Zr,xn,Ei,zn=0,Pn,On,mi,xi,Ca,Aa,ei,ai,ci=new o.Buf8(4),Xs,Us,fa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!et||!et.state||!et.output||!et.input&&et.avail_in!==0)return y;se=et.state,se.mode===q&&(se.mode=W),ut=et.next_out,Vr=et.output,me=et.avail_out,J=et.next_in,xt=et.input,at=et.avail_in,Ze=se.hold,vt=se.bits,Qr=at,Xr=me,ai=z;e:for(;;)switch(se.mode){case x:if(se.wrap===0){se.mode=W;break}for(;vt<16;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(se.wrap&2&&Ze===35615){se.check=0,ci[0]=Ze&255,ci[1]=Ze>>>8&255,se.check=u(se.check,ci,2,0),Ze=0,vt=0,se.mode=R;break}if(se.flags=0,se.head&&(se.head.done=!1),!(se.wrap&1)||(((Ze&255)<<8)+(Ze>>8))%31){et.msg="incorrect header check",se.mode=ht;break}if((Ze&15)!==h){et.msg="unknown compression method",se.mode=ht;break}if(Ze>>>=4,vt-=4,ei=(Ze&15)+8,se.wbits===0)se.wbits=ei;else if(ei>se.wbits){et.msg="invalid window size",se.mode=ht;break}se.dmax=1<<ei,et.adler=se.check=1,se.mode=Ze&512?H:q,Ze=0,vt=0;break;case R:for(;vt<16;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(se.flags=Ze,(se.flags&255)!==h){et.msg="unknown compression method",se.mode=ht;break}if(se.flags&57344){et.msg="unknown header flags set",se.mode=ht;break}se.head&&(se.head.text=Ze>>8&1),se.flags&512&&(ci[0]=Ze&255,ci[1]=Ze>>>8&255,se.check=u(se.check,ci,2,0)),Ze=0,vt=0,se.mode=M;case M:for(;vt<32;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}se.head&&(se.head.time=Ze),se.flags&512&&(ci[0]=Ze&255,ci[1]=Ze>>>8&255,ci[2]=Ze>>>16&255,ci[3]=Ze>>>24&255,se.check=u(se.check,ci,4,0)),Ze=0,vt=0,se.mode=P;case P:for(;vt<16;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}se.head&&(se.head.xflags=Ze&255,se.head.os=Ze>>8),se.flags&512&&(ci[0]=Ze&255,ci[1]=Ze>>>8&255,se.check=u(se.check,ci,2,0)),Ze=0,vt=0,se.mode=D;case D:if(se.flags&1024){for(;vt<16;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}se.length=Ze,se.head&&(se.head.extra_len=Ze),se.flags&512&&(ci[0]=Ze&255,ci[1]=Ze>>>8&255,se.check=u(se.check,ci,2,0)),Ze=0,vt=0}else se.head&&(se.head.extra=null);se.mode=L;case L:if(se.flags&1024&&(Zr=se.length,Zr>at&&(Zr=at),Zr&&(se.head&&(ei=se.head.extra_len-se.length,se.head.extra||(se.head.extra=new Array(se.head.extra_len)),o.arraySet(se.head.extra,xt,J,Zr,ei)),se.flags&512&&(se.check=u(se.check,xt,Zr,J)),at-=Zr,J+=Zr,se.length-=Zr),se.length))break e;se.length=0,se.mode=X;case X:if(se.flags&2048){if(at===0)break e;Zr=0;do ei=xt[J+Zr++],se.head&&ei&&se.length<65536&&(se.head.name+=String.fromCharCode(ei));while(ei&&Zr<at);if(se.flags&512&&(se.check=u(se.check,xt,Zr,J)),at-=Zr,J+=Zr,ei)break e}else se.head&&(se.head.name=null);se.length=0,se.mode=B;case B:if(se.flags&4096){if(at===0)break e;Zr=0;do ei=xt[J+Zr++],se.head&&ei&&se.length<65536&&(se.head.comment+=String.fromCharCode(ei));while(ei&&Zr<at);if(se.flags&512&&(se.check=u(se.check,xt,Zr,J)),at-=Zr,J+=Zr,ei)break e}else se.head&&(se.head.comment=null);se.mode=j;case j:if(se.flags&512){for(;vt<16;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(Ze!==(se.check&65535)){et.msg="header crc mismatch",se.mode=ht;break}Ze=0,vt=0}se.head&&(se.head.hcrc=se.flags>>9&1,se.head.done=!0),et.adler=se.check=0,se.mode=q;break;case H:for(;vt<32;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}et.adler=se.check=Nr(Ze),Ze=0,vt=0,se.mode=$;case $:if(se.havedict===0)return et.next_out=ut,et.avail_out=me,et.next_in=J,et.avail_in=at,se.hold=Ze,se.bits=vt,s;et.adler=se.check=1,se.mode=q;case q:if(Ot===k||Ot===A)break e;case W:if(se.last){Ze>>>=vt&7,vt-=vt&7,se.mode=Gt;break}for(;vt<3;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}switch(se.last=Ze&1,Ze>>>=1,vt-=1,Ze&3){case 0:se.mode=Y;break;case 1:if(Yt(se),se.mode=Ne,Ot===A){Ze>>>=2,vt-=2;break e}break;case 2:se.mode=Z;break;case 3:et.msg="invalid block type",se.mode=ht}Ze>>>=2,vt-=2;break;case Y:for(Ze>>>=vt&7,vt-=vt&7;vt<32;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if((Ze&65535)!==(Ze>>>16^65535)){et.msg="invalid stored block lengths",se.mode=ht;break}if(se.length=Ze&65535,Ze=0,vt=0,se.mode=G,Ot===A)break e;case G:se.mode=V;case V:if(Zr=se.length,Zr){if(Zr>at&&(Zr=at),Zr>me&&(Zr=me),Zr===0)break e;o.arraySet(Vr,xt,J,Zr,ut),at-=Zr,J+=Zr,me-=Zr,ut+=Zr,se.length-=Zr;break}se.mode=q;break;case Z:for(;vt<14;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(se.nlen=(Ze&31)+257,Ze>>>=5,vt-=5,se.ndist=(Ze&31)+1,Ze>>>=5,vt-=5,se.ncode=(Ze&15)+4,Ze>>>=4,vt-=4,se.nlen>286||se.ndist>30){et.msg="too many length or distance symbols",se.mode=ht;break}se.have=0,se.mode=xe;case xe:for(;se.have<se.ncode;){for(;vt<3;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}se.lens[fa[se.have++]]=Ze&7,Ze>>>=3,vt-=3}for(;se.have<19;)se.lens[fa[se.have++]]=0;if(se.lencode=se.lendyn,se.lenbits=7,Xs={bits:se.lenbits},ai=f(g,se.lens,0,19,se.lencode,0,se.work,Xs),se.lenbits=Xs.bits,ai){et.msg="invalid code lengths set",se.mode=ht;break}se.have=0,se.mode=ce;case ce:for(;se.have<se.nlen+se.ndist;){for(;zn=se.lencode[Ze&(1<<se.lenbits)-1],Pn=zn>>>24,On=zn>>>16&255,mi=zn&65535,!(Pn<=vt);){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(mi<16)Ze>>>=Pn,vt-=Pn,se.lens[se.have++]=mi;else{if(mi===16){for(Us=Pn+2;vt<Us;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(Ze>>>=Pn,vt-=Pn,se.have===0){et.msg="invalid bit length repeat",se.mode=ht;break}ei=se.lens[se.have-1],Zr=3+(Ze&3),Ze>>>=2,vt-=2}else if(mi===17){for(Us=Pn+3;vt<Us;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}Ze>>>=Pn,vt-=Pn,ei=0,Zr=3+(Ze&7),Ze>>>=3,vt-=3}else{for(Us=Pn+7;vt<Us;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}Ze>>>=Pn,vt-=Pn,ei=0,Zr=11+(Ze&127),Ze>>>=7,vt-=7}if(se.have+Zr>se.nlen+se.ndist){et.msg="invalid bit length repeat",se.mode=ht;break}for(;Zr--;)se.lens[se.have++]=ei}}if(se.mode===ht)break;if(se.lens[256]===0){et.msg="invalid code -- missing end-of-block",se.mode=ht;break}if(se.lenbits=9,Xs={bits:se.lenbits},ai=f(_,se.lens,0,se.nlen,se.lencode,0,se.work,Xs),se.lenbits=Xs.bits,ai){et.msg="invalid literal/lengths set",se.mode=ht;break}if(se.distbits=6,se.distcode=se.distdyn,Xs={bits:se.distbits},ai=f(p,se.lens,se.nlen,se.ndist,se.distcode,0,se.work,Xs),se.distbits=Xs.bits,ai){et.msg="invalid distances set",se.mode=ht;break}if(se.mode=Ne,Ot===A)break e;case Ne:se.mode=Pe;case Pe:if(at>=6&&me>=258){et.next_out=ut,et.avail_out=me,et.next_in=J,et.avail_in=at,se.hold=Ze,se.bits=vt,v(et,Xr),ut=et.next_out,Vr=et.output,me=et.avail_out,J=et.next_in,xt=et.input,at=et.avail_in,Ze=se.hold,vt=se.bits,se.mode===q&&(se.back=-1);break}for(se.back=0;zn=se.lencode[Ze&(1<<se.lenbits)-1],Pn=zn>>>24,On=zn>>>16&255,mi=zn&65535,!(Pn<=vt);){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(On&&!(On&240)){for(xi=Pn,Ca=On,Aa=mi;zn=se.lencode[Aa+((Ze&(1<<xi+Ca)-1)>>xi)],Pn=zn>>>24,On=zn>>>16&255,mi=zn&65535,!(xi+Pn<=vt);){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}Ze>>>=xi,vt-=xi,se.back+=xi}if(Ze>>>=Pn,vt-=Pn,se.back+=Pn,se.length=mi,On===0){se.mode=jt;break}if(On&32){se.back=-1,se.mode=q;break}if(On&64){et.msg="invalid literal/length code",se.mode=ht;break}se.extra=On&15,se.mode=De;case De:if(se.extra){for(Us=se.extra;vt<Us;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}se.length+=Ze&(1<<se.extra)-1,Ze>>>=se.extra,vt-=se.extra,se.back+=se.extra}se.was=se.length,se.mode=Me;case Me:for(;zn=se.distcode[Ze&(1<<se.distbits)-1],Pn=zn>>>24,On=zn>>>16&255,mi=zn&65535,!(Pn<=vt);){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(!(On&240)){for(xi=Pn,Ca=On,Aa=mi;zn=se.distcode[Aa+((Ze&(1<<xi+Ca)-1)>>xi)],Pn=zn>>>24,On=zn>>>16&255,mi=zn&65535,!(xi+Pn<=vt);){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}Ze>>>=xi,vt-=xi,se.back+=xi}if(Ze>>>=Pn,vt-=Pn,se.back+=Pn,On&64){et.msg="invalid distance code",se.mode=ht;break}se.offset=mi,se.extra=On&15,se.mode=Be;case Be:if(se.extra){for(Us=se.extra;vt<Us;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}se.offset+=Ze&(1<<se.extra)-1,Ze>>>=se.extra,vt-=se.extra,se.back+=se.extra}if(se.offset>se.dmax){et.msg="invalid distance too far back",se.mode=ht;break}se.mode=ft;case ft:if(me===0)break e;if(Zr=Xr-me,se.offset>Zr){if(Zr=se.offset-Zr,Zr>se.whave&&se.sane){et.msg="invalid distance too far back",se.mode=ht;break}Zr>se.wnext?(Zr-=se.wnext,xn=se.wsize-Zr):xn=se.wnext-Zr,Zr>se.length&&(Zr=se.length),Ei=se.window}else Ei=Vr,xn=ut-se.offset,Zr=se.length;Zr>me&&(Zr=me),me-=Zr,se.length-=Zr;do Vr[ut++]=Ei[xn++];while(--Zr);se.length===0&&(se.mode=Pe);break;case jt:if(me===0)break e;Vr[ut++]=se.length,me--,se.mode=Pe;break;case Gt:if(se.wrap){for(;vt<32;){if(at===0)break e;at--,Ze|=xt[J++]<<vt,vt+=8}if(Xr-=me,et.total_out+=Xr,se.total+=Xr,Xr&&(et.adler=se.check=se.flags?u(se.check,Vr,Xr,ut-Xr):c(se.check,Vr,Xr,ut-Xr)),Xr=me,(se.flags?Ze:Nr(Ze))!==se.check){et.msg="incorrect data check",se.mode=ht;break}Ze=0,vt=0}se.mode=mt;case mt:if(se.wrap&&se.flags){for(;vt<32;){if(at===0)break e;at--,Ze+=xt[J++]<<vt,vt+=8}if(Ze!==(se.total&4294967295)){et.msg="incorrect length check",se.mode=ht;break}Ze=0,vt=0}se.mode=Fe;case Fe:ai=l;break e;case ht:ai=w;break e;case Kt:return S;case Jt:default:return y}return et.next_out=ut,et.avail_out=me,et.next_in=J,et.avail_in=at,se.hold=Ze,se.bits=vt,(se.wsize||Xr!==et.avail_out&&se.mode<ht&&(se.mode<Gt||Ot!==E))&&Ft(et,et.output,et.next_out,Xr-et.avail_out),Qr-=et.avail_in,Xr-=et.avail_out,et.total_in+=Qr,et.total_out+=Xr,se.total+=Xr,se.wrap&&Xr&&(et.adler=se.check=se.flags?u(se.check,Vr,Xr,et.next_out-Xr):c(se.check,Vr,Xr,et.next_out-Xr)),et.data_type=se.bits+(se.last?64:0)+(se.mode===q?128:0)+(se.mode===Ne||se.mode===G?256:0),(Qr===0&&Xr===0||Ot===E)&&ai===z&&(ai=C),ai}function tt(et){if(!et||!et.state)return y;var Ot=et.state;return Ot.window&&(Ot.window=null),et.state=null,z}function lt(et,Ot){var se;return!et||!et.state||(se=et.state,!(se.wrap&2))?y:(se.head=Ot,Ot.done=!1,z)}function ar(et,Ot){var se=Ot.length,xt,Vr,J;return!et||!et.state||(xt=et.state,xt.wrap!==0&&xt.mode!==$)?y:xt.mode===$&&(Vr=1,Vr=c(Vr,Ot,se,0),Vr!==xt.check)?w:(J=Ft(et,Ot,se,se),J?(xt.mode=Kt,S):(xt.havedict=1,z))}r.inflateReset=Jr,r.inflateReset2=Yr,r.inflateResetKeep=Mt,r.inflateInit=ve,r.inflateInit2=ie,r.inflate=re,r.inflateEnd=tt,r.inflateGetHeader=lt,r.inflateSetDictionary=ar,r.inflateInfo="pako inflate (from Nodeca project)"}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=15,u=852,v=592,f=0,g=1,_=2,p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],E=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],k=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],A=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(z,l,s,y,w,S,C,h){var x=h.bits,R=0,M=0,P=0,D=0,L=0,X=0,B=0,j=0,H=0,$=0,q,W,Y,G,V,Z=null,xe=0,ce,Ne=new o.Buf16(c+1),Pe=new o.Buf16(c+1),De=null,Me=0,Be,ft,jt;for(R=0;R<=c;R++)Ne[R]=0;for(M=0;M<y;M++)Ne[l[s+M]]++;for(L=x,D=c;D>=1&&Ne[D]===0;D--);if(L>D&&(L=D),D===0)return w[S++]=20971520,w[S++]=20971520,h.bits=1,0;for(P=1;P<D&&Ne[P]===0;P++);for(L<P&&(L=P),j=1,R=1;R<=c;R++)if(j<<=1,j-=Ne[R],j<0)return-1;if(j>0&&(z===f||D!==1))return-1;for(Pe[1]=0,R=1;R<c;R++)Pe[R+1]=Pe[R]+Ne[R];for(M=0;M<y;M++)l[s+M]!==0&&(C[Pe[l[s+M]]++]=M);if(z===f?(Z=De=C,ce=19):z===g?(Z=p,xe-=257,De=E,Me-=257,ce=256):(Z=k,De=A,ce=-1),$=0,M=0,R=P,V=S,X=L,B=0,Y=-1,H=1<<L,G=H-1,z===g&&H>u||z===_&&H>v)return 1;for(;;){Be=R-B,C[M]<ce?(ft=0,jt=C[M]):C[M]>ce?(ft=De[Me+C[M]],jt=Z[xe+C[M]]):(ft=96,jt=0),q=1<<R-B,W=1<<X,P=W;do W-=q,w[V+($>>B)+W]=Be<<24|ft<<16|jt|0;while(W!==0);for(q=1<<R-1;$&q;)q>>=1;if(q!==0?($&=q-1,$+=q):$=0,M++,--Ne[R]===0){if(R===D)break;R=l[s+C[M]]}if(R>L&&($&G)!==Y){for(B===0&&(B=L),V+=P,X=R-B,j=1<<X;X+B<D&&(j-=Ne[X+B],!(j<=0));)X++,j<<=1;if(H+=1<<X,z===g&&H>u||z===_&&H>v)return 1;Y=$&G,w[Y]=L<<24|X<<16|V-S|0}}return $!==0&&(w[V+$]=R-B<<24|4194304|0),h.bits=L,0}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js":(e=>{e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js":((e,r,t)=>{var o=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=4,u=0,v=1,f=2;function g(re){for(var tt=re.length;--tt>=0;)re[tt]=0}var _=0,p=1,E=2,k=3,A=258,z=29,l=256,s=l+1+z,y=30,w=19,S=2*s+1,C=15,h=16,x=7,R=256,M=16,P=17,D=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],X=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=512,$=new Array((s+2)*2);g($);var q=new Array(y*2);g(q);var W=new Array(H);g(W);var Y=new Array(A-k+1);g(Y);var G=new Array(z);g(G);var V=new Array(y);g(V);function Z(re,tt,lt,ar,et){this.static_tree=re,this.extra_bits=tt,this.extra_base=lt,this.elems=ar,this.max_length=et,this.has_stree=re&&re.length}var xe,ce,Ne;function Pe(re,tt){this.dyn_tree=re,this.max_code=0,this.stat_desc=tt}function De(re){return re<256?W[re]:W[256+(re>>>7)]}function Me(re,tt){re.pending_buf[re.pending++]=tt&255,re.pending_buf[re.pending++]=tt>>>8&255}function Be(re,tt,lt){re.bi_valid>h-lt?(re.bi_buf|=tt<<re.bi_valid&65535,Me(re,re.bi_buf),re.bi_buf=tt>>h-re.bi_valid,re.bi_valid+=lt-h):(re.bi_buf|=tt<<re.bi_valid&65535,re.bi_valid+=lt)}function ft(re,tt,lt){Be(re,lt[tt*2],lt[tt*2+1])}function jt(re,tt){var lt=0;do lt|=re&1,re>>>=1,lt<<=1;while(--tt>0);return lt>>>1}function Gt(re){re.bi_valid===16?(Me(re,re.bi_buf),re.bi_buf=0,re.bi_valid=0):re.bi_valid>=8&&(re.pending_buf[re.pending++]=re.bi_buf&255,re.bi_buf>>=8,re.bi_valid-=8)}function mt(re,tt){var lt=tt.dyn_tree,ar=tt.max_code,et=tt.stat_desc.static_tree,Ot=tt.stat_desc.has_stree,se=tt.stat_desc.extra_bits,xt=tt.stat_desc.extra_base,Vr=tt.stat_desc.max_length,J,ut,at,me,Ze,vt,Qr=0;for(me=0;me<=C;me++)re.bl_count[me]=0;for(lt[re.heap[re.heap_max]*2+1]=0,J=re.heap_max+1;J<S;J++)ut=re.heap[J],me=lt[lt[ut*2+1]*2+1]+1,me>Vr&&(me=Vr,Qr++),lt[ut*2+1]=me,!(ut>ar)&&(re.bl_count[me]++,Ze=0,ut>=xt&&(Ze=se[ut-xt]),vt=lt[ut*2],re.opt_len+=vt*(me+Ze),Ot&&(re.static_len+=vt*(et[ut*2+1]+Ze)));if(Qr!==0){do{for(me=Vr-1;re.bl_count[me]===0;)me--;re.bl_count[me]--,re.bl_count[me+1]+=2,re.bl_count[Vr]--,Qr-=2}while(Qr>0);for(me=Vr;me!==0;me--)for(ut=re.bl_count[me];ut!==0;)at=re.heap[--J],!(at>ar)&&(lt[at*2+1]!==me&&(re.opt_len+=(me-lt[at*2+1])*lt[at*2],lt[at*2+1]=me),ut--)}}function Fe(re,tt,lt){var ar=new Array(C+1),et=0,Ot,se;for(Ot=1;Ot<=C;Ot++)ar[Ot]=et=et+lt[Ot-1]<<1;for(se=0;se<=tt;se++){var xt=re[se*2+1];xt!==0&&(re[se*2]=jt(ar[xt]++,xt))}}function ht(){var re,tt,lt,ar,et,Ot=new Array(C+1);for(lt=0,ar=0;ar<z-1;ar++)for(G[ar]=lt,re=0;re<1<<L[ar];re++)Y[lt++]=ar;for(Y[lt-1]=ar,et=0,ar=0;ar<16;ar++)for(V[ar]=et,re=0;re<1<<X[ar];re++)W[et++]=ar;for(et>>=7;ar<y;ar++)for(V[ar]=et<<7,re=0;re<1<<X[ar]-7;re++)W[256+et++]=ar;for(tt=0;tt<=C;tt++)Ot[tt]=0;for(re=0;re<=143;)$[re*2+1]=8,re++,Ot[8]++;for(;re<=255;)$[re*2+1]=9,re++,Ot[9]++;for(;re<=279;)$[re*2+1]=7,re++,Ot[7]++;for(;re<=287;)$[re*2+1]=8,re++,Ot[8]++;for(Fe($,s+1,Ot),re=0;re<y;re++)q[re*2+1]=5,q[re*2]=jt(re,5);xe=new Z($,L,l+1,s,C),ce=new Z(q,X,0,y,C),Ne=new Z(new Array(0),B,0,w,x)}function Kt(re){var tt;for(tt=0;tt<s;tt++)re.dyn_ltree[tt*2]=0;for(tt=0;tt<y;tt++)re.dyn_dtree[tt*2]=0;for(tt=0;tt<w;tt++)re.bl_tree[tt*2]=0;re.dyn_ltree[R*2]=1,re.opt_len=re.static_len=0,re.last_lit=re.matches=0}function Jt(re){re.bi_valid>8?Me(re,re.bi_buf):re.bi_valid>0&&(re.pending_buf[re.pending++]=re.bi_buf),re.bi_buf=0,re.bi_valid=0}function Wt(re,tt,lt,ar){Jt(re),Me(re,lt),Me(re,~lt),o.arraySet(re.pending_buf,re.window,tt,lt,re.pending),re.pending+=lt}function Br(re,tt,lt,ar){var et=tt*2,Ot=lt*2;return re[et]<re[Ot]||re[et]===re[Ot]&&ar[tt]<=ar[lt]}function zr(re,tt,lt){for(var ar=re.heap[lt],et=lt<<1;et<=re.heap_len&&(et<re.heap_len&&Br(tt,re.heap[et+1],re.heap[et],re.depth)&&et++,!Br(tt,ar,re.heap[et],re.depth));)re.heap[lt]=re.heap[et],lt=et,et<<=1;re.heap[lt]=ar}function cr(re,tt,lt){var ar,et,Ot=0,se,xt;if(re.last_lit!==0)do ar=re.pending_buf[re.d_buf+Ot*2]<<8|re.pending_buf[re.d_buf+Ot*2+1],et=re.pending_buf[re.l_buf+Ot],Ot++,ar===0?ft(re,et,tt):(se=Y[et],ft(re,se+l+1,tt),xt=L[se],xt!==0&&(et-=G[se],Be(re,et,xt)),ar--,se=De(ar),ft(re,se,lt),xt=X[se],xt!==0&&(ar-=V[se],Be(re,ar,xt)));while(Ot<re.last_lit);ft(re,R,tt)}function Nr(re,tt){var lt=tt.dyn_tree,ar=tt.stat_desc.static_tree,et=tt.stat_desc.has_stree,Ot=tt.stat_desc.elems,se,xt,Vr=-1,J;for(re.heap_len=0,re.heap_max=S,se=0;se<Ot;se++)lt[se*2]!==0?(re.heap[++re.heap_len]=Vr=se,re.depth[se]=0):lt[se*2+1]=0;for(;re.heap_len<2;)J=re.heap[++re.heap_len]=Vr<2?++Vr:0,lt[J*2]=1,re.depth[J]=0,re.opt_len--,et&&(re.static_len-=ar[J*2+1]);for(tt.max_code=Vr,se=re.heap_len>>1;se>=1;se--)zr(re,lt,se);J=Ot;do se=re.heap[1],re.heap[1]=re.heap[re.heap_len--],zr(re,lt,1),xt=re.heap[1],re.heap[--re.heap_max]=se,re.heap[--re.heap_max]=xt,lt[J*2]=lt[se*2]+lt[xt*2],re.depth[J]=(re.depth[se]>=re.depth[xt]?re.depth[se]:re.depth[xt])+1,lt[se*2+1]=lt[xt*2+1]=J,re.heap[1]=J++,zr(re,lt,1);while(re.heap_len>=2);re.heap[--re.heap_max]=re.heap[1],mt(re,tt),Fe(lt,Vr,re.bl_count)}function At(re,tt,lt){var ar,et=-1,Ot,se=tt[1],xt=0,Vr=7,J=4;for(se===0&&(Vr=138,J=3),tt[(lt+1)*2+1]=65535,ar=0;ar<=lt;ar++)Ot=se,se=tt[(ar+1)*2+1],!(++xt<Vr&&Ot===se)&&(xt<J?re.bl_tree[Ot*2]+=xt:Ot!==0?(Ot!==et&&re.bl_tree[Ot*2]++,re.bl_tree[M*2]++):xt<=10?re.bl_tree[P*2]++:re.bl_tree[D*2]++,xt=0,et=Ot,se===0?(Vr=138,J=3):Ot===se?(Vr=6,J=3):(Vr=7,J=4))}function Mt(re,tt,lt){var ar,et=-1,Ot,se=tt[1],xt=0,Vr=7,J=4;for(se===0&&(Vr=138,J=3),ar=0;ar<=lt;ar++)if(Ot=se,se=tt[(ar+1)*2+1],!(++xt<Vr&&Ot===se)){if(xt<J)do ft(re,Ot,re.bl_tree);while(--xt!==0);else Ot!==0?(Ot!==et&&(ft(re,Ot,re.bl_tree),xt--),ft(re,M,re.bl_tree),Be(re,xt-3,2)):xt<=10?(ft(re,P,re.bl_tree),Be(re,xt-3,3)):(ft(re,D,re.bl_tree),Be(re,xt-11,7));xt=0,et=Ot,se===0?(Vr=138,J=3):Ot===se?(Vr=6,J=3):(Vr=7,J=4)}}function Jr(re){var tt;for(At(re,re.dyn_ltree,re.l_desc.max_code),At(re,re.dyn_dtree,re.d_desc.max_code),Nr(re,re.bl_desc),tt=w-1;tt>=3&&re.bl_tree[j[tt]*2+1]===0;tt--);return re.opt_len+=3*(tt+1)+5+5+4,tt}function Yr(re,tt,lt,ar){var et;for(Be(re,tt-257,5),Be(re,lt-1,5),Be(re,ar-4,4),et=0;et<ar;et++)Be(re,re.bl_tree[j[et]*2+1],3);Mt(re,re.dyn_ltree,tt-1),Mt(re,re.dyn_dtree,lt-1)}function ie(re){var tt=4093624447,lt;for(lt=0;lt<=31;lt++,tt>>>=1)if(tt&1&&re.dyn_ltree[lt*2]!==0)return u;if(re.dyn_ltree[18]!==0||re.dyn_ltree[20]!==0||re.dyn_ltree[26]!==0)return v;for(lt=32;lt<l;lt++)if(re.dyn_ltree[lt*2]!==0)return v;return u}var ve=!1;function we(re){ve||(ht(),ve=!0),re.l_desc=new Pe(re.dyn_ltree,xe),re.d_desc=new Pe(re.dyn_dtree,ce),re.bl_desc=new Pe(re.bl_tree,Ne),re.bi_buf=0,re.bi_valid=0,Kt(re)}function it(re,tt,lt,ar){Be(re,(_<<1)+(ar?1:0),3),Wt(re,tt,lt)}function rt(re){Be(re,p<<1,3),ft(re,R,$),Gt(re)}function Yt(re,tt,lt,ar){var et,Ot,se=0;re.level>0?(re.strm.data_type===f&&(re.strm.data_type=ie(re)),Nr(re,re.l_desc),Nr(re,re.d_desc),se=Jr(re),et=re.opt_len+3+7>>>3,Ot=re.static_len+3+7>>>3,Ot<=et&&(et=Ot)):et=Ot=lt+5,lt+4<=et&&tt!==-1?it(re,tt,lt,ar):re.strategy===c||Ot===et?(Be(re,(p<<1)+(ar?1:0),3),cr(re,$,q)):(Be(re,(E<<1)+(ar?1:0),3),Yr(re,re.l_desc.max_code+1,re.d_desc.max_code+1,se+1),cr(re,re.dyn_ltree,re.dyn_dtree)),Kt(re),ar&&Jt(re)}function Ft(re,tt,lt){return re.pending_buf[re.d_buf+re.last_lit*2]=tt>>>8&255,re.pending_buf[re.d_buf+re.last_lit*2+1]=tt&255,re.pending_buf[re.l_buf+re.last_lit]=lt&255,re.last_lit++,tt===0?re.dyn_ltree[lt*2]++:(re.matches++,tt--,re.dyn_ltree[(Y[lt]+l+1)*2]++,re.dyn_dtree[De(tt)*2]++),re.last_lit===re.lit_bufsize-1}r._tr_init=we,r._tr_stored_block=it,r._tr_flush_block=Yt,r._tr_tally=Ft,r._tr_align=rt}),"./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js":(e=>{function r(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=r}),"./src/SurfaceWorker.js":(()=>{$3Dmol.workerString=(function(){self.onmessage=function(e){var r=e.data,t=r.type;if(t<0)self.atomData=r.atoms,self.volume=r.volume,self.ps=new ProteinSurface;else{var o=self.ps;o.initparm(r.expandedExtent,t!=1,self.volume),o.fillvoxels(self.atomData,r.extendedAtoms),o.buildboundary(),(t===4||t===2)&&(o.fastdistancemap(),o.boundingatom(!1),o.fillvoxelswaals(self.atomData,r.extendedAtoms)),o.marchingcube(t);var c=o.getFacesAndVertices(r.atomsToShow);self.postMessage(c)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0}),"./src/exporter.js":(e=>{typeof e.exports=="object"&&(e.exports=window.$3Dmol)}),"./src/vendor/mmtf.js":(function(e,r){(function(t,o){o(r)})(this,function(t){function o(ie,ve,we){for(var it=(ie.byteLength,0),rt=we.length;rt>it;it++){var Yt=we.charCodeAt(it);if(128>Yt)ie.setUint8(ve++,Yt>>>0&127|0);else if(2048>Yt)ie.setUint8(ve++,Yt>>>6&31|192),ie.setUint8(ve++,Yt>>>0&63|128);else if(65536>Yt)ie.setUint8(ve++,Yt>>>12&15|224),ie.setUint8(ve++,Yt>>>6&63|128),ie.setUint8(ve++,Yt>>>0&63|128);else{if(!(1114112>Yt))throw new Error("bad codepoint "+Yt);ie.setUint8(ve++,Yt>>>18&7|240),ie.setUint8(ve++,Yt>>>12&63|128),ie.setUint8(ve++,Yt>>>6&63|128),ie.setUint8(ve++,Yt>>>0&63|128)}}}function c(ie){for(var ve=0,we=0,it=ie.length;it>we;we++){var rt=ie.charCodeAt(we);if(128>rt)ve+=1;else if(2048>rt)ve+=2;else if(65536>rt)ve+=3;else{if(!(1114112>rt))throw new Error("bad codepoint "+rt);ve+=4}}return ve}function u(ie,ve,we){var it=typeof ie;if(it==="string"){var rt=c(ie);if(32>rt)return ve.setUint8(we,160|rt),o(ve,we+1,ie),1+rt;if(256>rt)return ve.setUint8(we,217),ve.setUint8(we+1,rt),o(ve,we+2,ie),2+rt;if(65536>rt)return ve.setUint8(we,218),ve.setUint16(we+1,rt),o(ve,we+3,ie),3+rt;if(4294967296>rt)return ve.setUint8(we,219),ve.setUint32(we+1,rt),o(ve,we+5,ie),5+rt}if(ie instanceof Uint8Array){var rt=ie.byteLength,Yt=new Uint8Array(ve.buffer);if(256>rt)return ve.setUint8(we,196),ve.setUint8(we+1,rt),Yt.set(ie,we+2),2+rt;if(65536>rt)return ve.setUint8(we,197),ve.setUint16(we+1,rt),Yt.set(ie,we+3),3+rt;if(4294967296>rt)return ve.setUint8(we,198),ve.setUint32(we+1,rt),Yt.set(ie,we+5),5+rt}if(it==="number"){if(!isFinite(ie))throw new Error("Number not finite: "+ie);if(Math.floor(ie)!==ie)return ve.setUint8(we,203),ve.setFloat64(we+1,ie),9;if(ie>=0){if(128>ie)return ve.setUint8(we,ie),1;if(256>ie)return ve.setUint8(we,204),ve.setUint8(we+1,ie),2;if(65536>ie)return ve.setUint8(we,205),ve.setUint16(we+1,ie),3;if(4294967296>ie)return ve.setUint8(we,206),ve.setUint32(we+1,ie),5;throw new Error("Number too big 0x"+ie.toString(16))}if(ie>=-32)return ve.setInt8(we,ie),1;if(ie>=-128)return ve.setUint8(we,208),ve.setInt8(we+1,ie),2;if(ie>=-32768)return ve.setUint8(we,209),ve.setInt16(we+1,ie),3;if(ie>=-2147483648)return ve.setUint8(we,210),ve.setInt32(we+1,ie),5;throw new Error("Number too small -0x"+(-ie).toString(16).substr(1))}if(ie===null)return ve.setUint8(we,192),1;if(it==="boolean")return ve.setUint8(we,ie?195:194),1;if(it==="object"){var rt,tt=0,Ft=Array.isArray(ie);if(Ft)rt=ie.length;else{var re=Object.keys(ie);rt=re.length}var tt;if(16>rt?(ve.setUint8(we,rt|(Ft?144:128)),tt=1):65536>rt?(ve.setUint8(we,Ft?220:222),ve.setUint16(we+1,rt),tt=3):4294967296>rt&&(ve.setUint8(we,Ft?221:223),ve.setUint32(we+1,rt),tt=5),Ft)for(var lt=0;rt>lt;lt++)tt+=u(ie[lt],ve,we+tt);else for(var lt=0;rt>lt;lt++){var ar=re[lt];tt+=u(ar,ve,we+tt),tt+=u(ie[ar],ve,we+tt)}return tt}throw new Error("Unknown type "+it)}function v(ie){var ve=typeof ie;if(ve==="string"){var we=c(ie);if(32>we)return 1+we;if(256>we)return 2+we;if(65536>we)return 3+we;if(4294967296>we)return 5+we}if(ie instanceof Uint8Array){var we=ie.byteLength;if(256>we)return 2+we;if(65536>we)return 3+we;if(4294967296>we)return 5+we}if(ve==="number"){if(Math.floor(ie)!==ie)return 9;if(ie>=0){if(128>ie)return 1;if(256>ie)return 2;if(65536>ie)return 3;if(4294967296>ie)return 5;throw new Error("Number too big 0x"+ie.toString(16))}if(ie>=-32)return 1;if(ie>=-128)return 2;if(ie>=-32768)return 3;if(ie>=-2147483648)return 5;throw new Error("Number too small -0x"+ie.toString(16).substr(1))}if(ve==="boolean"||ie===null)return 1;if(ve==="object"){var we,it=0;if(Array.isArray(ie)){we=ie.length;for(var rt=0;we>rt;rt++)it+=v(ie[rt])}else{var Yt=Object.keys(ie);we=Yt.length;for(var rt=0;we>rt;rt++){var Ft=Yt[rt];it+=v(Ft)+v(ie[Ft])}}if(16>we)return 1+it;if(65536>we)return 3+it;if(4294967296>we)return 5+it;throw new Error("Array or object too long 0x"+we.toString(16))}throw new Error("Unknown type "+ve)}function f(ie){var ve=new ArrayBuffer(v(ie)),we=new DataView(ve);return u(ie,we,0),new Uint8Array(ve)}function g(ie,ve,we){return ve?new ie(ve.buffer,ve.byteOffset,ve.byteLength/(we||1)):void 0}function _(ie){return g(DataView,ie)}function p(ie){return g(Uint8Array,ie)}function E(ie){return g(Int8Array,ie)}function k(ie){return g(Int32Array,ie,4)}function A(ie){return g(Float32Array,ie,4)}function z(ie,ve){var we=ie.length/2;ve||(ve=new Int16Array(we));for(var it=0,rt=0;we>it;++it,rt+=2)ve[it]=ie[rt]<<8^ie[rt+1]<<0;return ve}function l(ie,ve){var we=ie.length;ve||(ve=new Uint8Array(2*we));for(var it=_(ve),rt=0;we>rt;++rt)it.setInt16(2*rt,ie[rt]);return p(ve)}function s(ie,ve){var we=ie.length/4;ve||(ve=new Int32Array(we));for(var it=0,rt=0;we>it;++it,rt+=4)ve[it]=ie[rt]<<24^ie[rt+1]<<16^ie[rt+2]<<8^ie[rt+3]<<0;return ve}function y(ie,ve){var we=ie.length;ve||(ve=new Uint8Array(4*we));for(var it=_(ve),rt=0;we>rt;++rt)it.setInt32(4*rt,ie[rt]);return p(ve)}function w(ie,ve){var we=ie.length;ve||(ve=new Float32Array(we/4));for(var it=_(ve),rt=_(ie),Yt=0,Ft=0,re=we/4;re>Yt;++Yt,Ft+=4)it.setFloat32(Ft,rt.getFloat32(Ft),!0);return ve}function S(ie,ve,we){var it=ie.length,rt=1/ve;we||(we=new Float32Array(it));for(var Yt=0;it>Yt;++Yt)we[Yt]=ie[Yt]*rt;return we}function C(ie,ve,we){var it=ie.length;we||(we=new Int32Array(it));for(var rt=0;it>rt;++rt)we[rt]=Math.round(ie[rt]*ve);return we}function h(ie,ve){var we,it;if(!ve){var rt=0;for(we=0,it=ie.length;it>we;we+=2)rt+=ie[we+1];ve=new ie.constructor(rt)}var Yt=0;for(we=0,it=ie.length;it>we;we+=2)for(var Ft=ie[we],re=ie[we+1],tt=0;re>tt;++tt)ve[Yt]=Ft,++Yt;return ve}function x(ie){if(ie.length===0)return new Int32Array;var ve,we,it=2;for(ve=1,we=ie.length;we>ve;++ve)ie[ve-1]!==ie[ve]&&(it+=2);var rt=new Int32Array(it),Yt=0,Ft=1;for(ve=1,we=ie.length;we>ve;++ve)ie[ve-1]!==ie[ve]?(rt[Yt]=ie[ve-1],rt[Yt+1]=Ft,Ft=1,Yt+=2):++Ft;return rt[Yt]=ie[ie.length-1],rt[Yt+1]=Ft,rt}function R(ie,ve){var we=ie.length;ve||(ve=new ie.constructor(we)),we&&(ve[0]=ie[0]);for(var it=1;we>it;++it)ve[it]=ie[it]+ve[it-1];return ve}function M(ie,ve){var we=ie.length;ve||(ve=new ie.constructor(we)),ve[0]=ie[0];for(var it=1;we>it;++it)ve[it]=ie[it]-ie[it-1];return ve}function P(ie,ve){var we,it,rt=ie instanceof Int8Array?127:32767,Yt=-rt-1,Ft=ie.length;if(!ve){var re=0;for(we=0;Ft>we;++we)ie[we]<rt&&ie[we]>Yt&&++re;ve=new Int32Array(re)}for(we=0,it=0;Ft>we;){for(var tt=0;ie[we]===rt||ie[we]===Yt;)tt+=ie[we],++we;tt+=ie[we],++we,ve[it]=tt,++it}return ve}function D(ie,ve){var we,it=32767,rt=-it-1,Yt=ie.length,Ft=0;for(we=0;Yt>we;++we){var re=ie[we];re===0?++Ft:re>0?(Ft+=Math.ceil(re/it),re%it===0&&(Ft+=1)):(Ft+=Math.ceil(re/rt),re%rt===0&&(Ft+=1))}var tt=new Int16Array(Ft),lt=0;for(we=0;Yt>we;++we){var re=ie[we];if(re>=0)for(;re>=it;)tt[lt]=it,++lt,re-=it;else for(;rt>=re;)tt[lt]=rt,++lt,re-=rt;tt[lt]=re,++lt}return tt}function L(ie,ve){return R(h(ie),ve)}function X(ie){return x(M(ie))}function B(ie,ve,we){return S(h(ie,k(we)),ve,we)}function j(ie,ve){return x(C(ie,ve))}function H(ie,ve,we){return S(R(ie,k(we)),ve,we)}function $(ie,ve,we){return M(C(ie,ve),we)}function q(ie,ve,we){return S(P(ie,k(we)),ve,we)}function W(ie,ve,we){var it=P(ie,k(we));return H(it,ve,A(it))}function Y(ie,ve,we){return D($(ie,ve))}function G(Yt){var ve=_(Yt),we=ve.getInt32(0),it=ve.getInt32(4),rt=Yt.subarray(8,12),Yt=Yt.subarray(12);return[we,Yt,it,rt]}function V(ie,ve,we,it){var rt=new ArrayBuffer(12+it.byteLength),Yt=new Uint8Array(rt),Ft=new DataView(rt);return Ft.setInt32(0,ie),Ft.setInt32(4,ve),we&&Yt.set(we,8),Yt.set(it,12),Yt}function Z(ie){var ve=ie.length,we=p(ie);return V(2,ve,void 0,we)}function xe(ie){var ve=ie.length,we=y(ie);return V(4,ve,void 0,we)}function ce(ie,ve){var we=ie.length/ve,it=y([ve]),rt=p(ie);return V(5,we,it,rt)}function Ne(ie){var ve=ie.length,we=y(x(ie));return V(6,ve,void 0,we)}function Pe(ie){var ve=ie.length,we=y(X(ie));return V(8,ve,void 0,we)}function De(ie,ve){var we=ie.length,it=y([ve]),rt=y(j(ie,ve));return V(9,we,it,rt)}function Me(ie,ve){var we=ie.length,it=y([ve]),rt=l(Y(ie,ve));return V(10,we,it,rt)}function Be(ie){var ve={};return zr.forEach(function(we){ie[we]!==void 0&&(ve[we]=ie[we])}),ie.bondAtomList&&(ve.bondAtomList=xe(ie.bondAtomList)),ie.bondOrderList&&(ve.bondOrderList=Z(ie.bondOrderList)),ve.xCoordList=Me(ie.xCoordList,1e3),ve.yCoordList=Me(ie.yCoordList,1e3),ve.zCoordList=Me(ie.zCoordList,1e3),ie.bFactorList&&(ve.bFactorList=Me(ie.bFactorList,100)),ie.atomIdList&&(ve.atomIdList=Pe(ie.atomIdList)),ie.altLocList&&(ve.altLocList=Ne(ie.altLocList)),ie.occupancyList&&(ve.occupancyList=De(ie.occupancyList,100)),ve.groupIdList=Pe(ie.groupIdList),ve.groupTypeList=xe(ie.groupTypeList),ie.secStructList&&(ve.secStructList=Z(ie.secStructList)),ie.insCodeList&&(ve.insCodeList=Ne(ie.insCodeList)),ie.sequenceIndexList&&(ve.sequenceIndexList=Pe(ie.sequenceIndexList)),ve.chainIdList=ce(ie.chainIdList,4),ie.chainNameList&&(ve.chainNameList=ce(ie.chainNameList,4)),ve}function ft(ie){function ve(tt){for(var lt={},ar=0;tt>ar;ar++){var et=Yt();lt[et]=Yt()}return lt}function we(tt){var lt=ie.subarray(Ft,Ft+tt);return Ft+=tt,lt}function it(tt){var lt=ie.subarray(Ft,Ft+tt);Ft+=tt;var ar=65535;if(tt>ar){for(var et=[],Ot=0;Ot<lt.length;Ot+=ar)et.push(String.fromCharCode.apply(null,lt.subarray(Ot,Ot+ar)));return et.join("")}return String.fromCharCode.apply(null,lt)}function rt(tt){for(var lt=new Array(tt),ar=0;tt>ar;ar++)lt[ar]=Yt();return lt}function Yt(){var tt,lt,ar=ie[Ft];if(!(128&ar))return Ft++,ar;if((240&ar)===128)return lt=15&ar,Ft++,ve(lt);if((240&ar)===144)return lt=15&ar,Ft++,rt(lt);if((224&ar)===160)return lt=31&ar,Ft++,it(lt);if((224&ar)===224)return tt=re.getInt8(Ft),Ft++,tt;switch(ar){case 192:return Ft++,null;case 194:return Ft++,!1;case 195:return Ft++,!0;case 196:return lt=re.getUint8(Ft+1),Ft+=2,we(lt);case 197:return lt=re.getUint16(Ft+1),Ft+=3,we(lt);case 198:return lt=re.getUint32(Ft+1),Ft+=5,we(lt);case 202:return tt=re.getFloat32(Ft+1),Ft+=5,tt;case 203:return tt=re.getFloat64(Ft+1),Ft+=9,tt;case 204:return tt=ie[Ft+1],Ft+=2,tt;case 205:return tt=re.getUint16(Ft+1),Ft+=3,tt;case 206:return tt=re.getUint32(Ft+1),Ft+=5,tt;case 208:return tt=re.getInt8(Ft+1),Ft+=2,tt;case 209:return tt=re.getInt16(Ft+1),Ft+=3,tt;case 210:return tt=re.getInt32(Ft+1),Ft+=5,tt;case 217:return lt=re.getUint8(Ft+1),Ft+=2,it(lt);case 218:return lt=re.getUint16(Ft+1),Ft+=3,it(lt);case 219:return lt=re.getUint32(Ft+1),Ft+=5,it(lt);case 220:return lt=re.getUint16(Ft+1),Ft+=3,rt(lt);case 221:return lt=re.getUint32(Ft+1),Ft+=5,rt(lt);case 222:return lt=re.getUint16(Ft+1),Ft+=3,ve(lt);case 223:return lt=re.getUint32(Ft+1),Ft+=5,ve(lt)}throw new Error("Unknown type 0x"+ar.toString(16))}var Ft=0,re=new DataView(ie.buffer);return Yt()}function jt(ie,ve,we,it){switch(ie){case 1:return w(ve);case 2:return E(ve);case 3:return z(ve);case 4:return s(ve);case 5:return p(ve);case 6:return h(s(ve),new Uint8Array(we));case 7:return h(s(ve));case 8:return L(s(ve));case 9:return B(s(ve),s(it)[0]);case 10:return W(z(ve),s(it)[0]);case 11:return S(z(ve),s(it)[0]);case 12:return q(z(ve),s(it)[0]);case 13:return q(E(ve),s(it)[0]);case 14:return P(z(ve));case 15:return P(E(ve))}}function Gt(ie,ve){ve=ve||{};var we=ve.ignoreFields,it={};return Nr.forEach(function(rt){var Yt=we?we.indexOf(rt)!==-1:!1,Ft=ie[rt];Yt||Ft===void 0||(Ft instanceof Uint8Array?it[rt]=jt.apply(null,G(Ft)):it[rt]=Ft)}),it}function mt(ie){return String.fromCharCode.apply(null,ie).replace(/\0/g,"")}function Fe(ie,ve,we){we=we||{};var it,rt,Yt,Ft,re,tt,lt=we.firstModelOnly,ar=ve.onModel,et=ve.onChain,Ot=ve.onGroup,se=ve.onAtom,xt=ve.onBond,Vr=0,J=0,ut=0,at=0,me=0,Ze=-1,vt=ie.chainNameList,Qr=ie.secStructList,Xr=ie.insCodeList,Zr=ie.sequenceIndexList,xn=ie.atomIdList,Ei=ie.bFactorList,zn=ie.altLocList,Pn=ie.occupancyList,On=ie.bondAtomList,mi=ie.bondOrderList;for(it=0,rt=ie.chainsPerModel.length;rt>it&&!(lt&&Vr>0);++it){var xi=ie.chainsPerModel[Vr];for(ar&&ar({chainCount:xi,modelIndex:Vr}),Yt=0;xi>Yt;++Yt){var Ca=ie.groupsPerChain[J];if(et){var Aa=mt(ie.chainIdList.subarray(4*J,4*J+4)),ei=null;vt&&(ei=mt(vt.subarray(4*J,4*J+4))),et({groupCount:Ca,chainIndex:J,modelIndex:Vr,chainId:Aa,chainName:ei})}for(Ft=0;Ca>Ft;++Ft){var ai=ie.groupList[ie.groupTypeList[ut]],ci=ai.atomNameList.length;if(Ot){var Xs=null;Qr&&(Xs=Qr[ut]);var Us=null;ie.insCodeList&&(Us=String.fromCharCode(Xr[ut]));var fa=null;Zr&&(fa=Zr[ut]),Ot({atomCount:ci,groupIndex:ut,chainIndex:J,modelIndex:Vr,groupId:ie.groupIdList[ut],groupType:ie.groupTypeList[ut],groupName:ai.groupName,singleLetterCode:ai.singleLetterCode,chemCompType:ai.chemCompType,secStruct:Xs,insCode:Us,sequenceIndex:fa})}for(re=0;ci>re;++re){if(se){var ll=null;xn&&(ll=xn[at]);var cl=null;Ei&&(cl=Ei[at]);var ul=null;zn&&(ul=String.fromCharCode(zn[at]));var Ya=null;Pn&&(Ya=Pn[at]),se({atomIndex:at,groupIndex:ut,chainIndex:J,modelIndex:Vr,atomId:ll,element:ai.elementList[re],atomName:ai.atomNameList[re],formalCharge:ai.formalChargeList[re],xCoord:ie.xCoordList[at],yCoord:ie.yCoordList[at],zCoord:ie.zCoordList[at],bFactor:cl,altLoc:ul,occupancy:Ya})}at+=1}if(xt){var hi=ai.bondAtomList;for(re=0,tt=ai.bondOrderList.length;tt>re;++re)xt({atomIndex1:at-ci+hi[2*re],atomIndex2:at-ci+hi[2*re+1],bondOrder:ai.bondOrderList[re]})}ut+=1}J+=1}if(me=Ze+1,Ze=at-1,xt&&On)for(re=0,tt=On.length;tt>re;re+=2){var dl=On[re],ja=On[re+1];(dl>=me&&Ze>=dl||ja>=me&&Ze>=ja)&&xt({atomIndex1:dl,atomIndex2:ja,bondOrder:mi?mi[re/2]:null})}Vr+=1}}function ht(ie){return f(Be(ie))}function Kt(ie,ve){ie instanceof ArrayBuffer&&(ie=new Uint8Array(ie));var we;return we=ie instanceof Uint8Array?ft(ie):ie,Gt(we,ve)}function Jt(ie,ve,we,it){function rt(){try{var Ft=Kt(Yt.response);we(Ft)}catch(re){it(re)}}var Yt=new XMLHttpRequest;Yt.addEventListener("load",rt,!0),Yt.addEventListener("error",it,!0),Yt.responseType="arraybuffer",Yt.open("GET",ve+ie.toUpperCase()),Yt.send()}function Wt(ie,ve,we){Jt(ie,Jr,ve,we)}function Br(ie,ve,we){Jt(ie,Yr,ve,we)}var zr=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],cr=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],Nr=zr.concat(cr),At="v1.0.1",Mt="//mmtf.rcsb.org/v1.0/",Jr=Mt+"full/",Yr=Mt+"reduced/";t.encode=ht,t.decode=Kt,t.traverse=Fe,t.fetch=Wt,t.fetchReduced=Br,t.version=At,t.fetchUrl=Jr,t.fetchReducedUrl=Yr,t.encodeMsgpack=f,t.encodeMmtf=Be,t.decodeMsgpack=ft,t.decodeMmtf=Gt})}),"./node_modules/pako/dist/pako.esm.mjs":((e,r,t)=>{t.r(r),t.d(r,{Deflate:()=>il,Inflate:()=>Xu,constants:()=>Pa,default:()=>ru,deflate:()=>Sl,deflateRaw:()=>na,gzip:()=>vc,inflate:()=>Ju,inflateRaw:()=>xc,ungzip:()=>Qu});/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const o=4,c=0,u=1,v=2;function f(I){let K=I.length;for(;--K>=0;)I[K]=0}const g=0,_=1,p=2,E=3,k=258,A=29,z=256,l=z+1+A,s=30,y=19,w=2*l+1,S=15,C=16,h=7,x=256,R=16,M=17,P=18,D=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),L=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),X=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),B=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),j=512,H=new Array((l+2)*2);f(H);const $=new Array(s*2);f($);const q=new Array(j);f(q);const W=new Array(k-E+1);f(W);const Y=new Array(A);f(Y);const G=new Array(s);f(G);function V(I,K,O,be,Ee){this.static_tree=I,this.extra_bits=K,this.extra_base=O,this.elems=be,this.max_length=Ee,this.has_stree=I&&I.length}let Z,xe,ce;function Ne(I,K){this.dyn_tree=I,this.max_code=0,this.stat_desc=K}const Pe=I=>I<256?q[I]:q[256+(I>>>7)],De=(I,K)=>{I.pending_buf[I.pending++]=K&255,I.pending_buf[I.pending++]=K>>>8&255},Me=(I,K,O)=>{I.bi_valid>C-O?(I.bi_buf|=K<<I.bi_valid&65535,De(I,I.bi_buf),I.bi_buf=K>>C-I.bi_valid,I.bi_valid+=O-C):(I.bi_buf|=K<<I.bi_valid&65535,I.bi_valid+=O)},Be=(I,K,O)=>{Me(I,O[K*2],O[K*2+1])},ft=(I,K)=>{let O=0;do O|=I&1,I>>>=1,O<<=1;while(--K>0);return O>>>1},jt=I=>{I.bi_valid===16?(De(I,I.bi_buf),I.bi_buf=0,I.bi_valid=0):I.bi_valid>=8&&(I.pending_buf[I.pending++]=I.bi_buf&255,I.bi_buf>>=8,I.bi_valid-=8)},Gt=(I,K)=>{const O=K.dyn_tree,be=K.max_code,Ee=K.stat_desc.static_tree,Le=K.stat_desc.has_stree,St=K.stat_desc.extra_bits,ct=K.stat_desc.extra_base,Kr=K.stat_desc.max_length;let nt,_t,jn,Hr,Lr,pi,vi=0;for(Hr=0;Hr<=S;Hr++)I.bl_count[Hr]=0;for(O[I.heap[I.heap_max]*2+1]=0,nt=I.heap_max+1;nt<w;nt++)_t=I.heap[nt],Hr=O[O[_t*2+1]*2+1]+1,Hr>Kr&&(Hr=Kr,vi++),O[_t*2+1]=Hr,!(_t>be)&&(I.bl_count[Hr]++,Lr=0,_t>=ct&&(Lr=St[_t-ct]),pi=O[_t*2],I.opt_len+=pi*(Hr+Lr),Le&&(I.static_len+=pi*(Ee[_t*2+1]+Lr)));if(vi!==0){do{for(Hr=Kr-1;I.bl_count[Hr]===0;)Hr--;I.bl_count[Hr]--,I.bl_count[Hr+1]+=2,I.bl_count[Kr]--,vi-=2}while(vi>0);for(Hr=Kr;Hr!==0;Hr--)for(_t=I.bl_count[Hr];_t!==0;)jn=I.heap[--nt],!(jn>be)&&(O[jn*2+1]!==Hr&&(I.opt_len+=(Hr-O[jn*2+1])*O[jn*2],O[jn*2+1]=Hr),_t--)}},mt=(I,K,O)=>{const be=new Array(S+1);let Ee=0,Le,St;for(Le=1;Le<=S;Le++)Ee=Ee+O[Le-1]<<1,be[Le]=Ee;for(St=0;St<=K;St++){let ct=I[St*2+1];ct!==0&&(I[St*2]=ft(be[ct]++,ct))}},Fe=()=>{let I,K,O,be,Ee;const Le=new Array(S+1);for(O=0,be=0;be<A-1;be++)for(Y[be]=O,I=0;I<1<<D[be];I++)W[O++]=be;for(W[O-1]=be,Ee=0,be=0;be<16;be++)for(G[be]=Ee,I=0;I<1<<L[be];I++)q[Ee++]=be;for(Ee>>=7;be<s;be++)for(G[be]=Ee<<7,I=0;I<1<<L[be]-7;I++)q[256+Ee++]=be;for(K=0;K<=S;K++)Le[K]=0;for(I=0;I<=143;)H[I*2+1]=8,I++,Le[8]++;for(;I<=255;)H[I*2+1]=9,I++,Le[9]++;for(;I<=279;)H[I*2+1]=7,I++,Le[7]++;for(;I<=287;)H[I*2+1]=8,I++,Le[8]++;for(mt(H,l+1,Le),I=0;I<s;I++)$[I*2+1]=5,$[I*2]=ft(I,5);Z=new V(H,D,z+1,l,S),xe=new V($,L,0,s,S),ce=new V(new Array(0),X,0,y,h)},ht=I=>{let K;for(K=0;K<l;K++)I.dyn_ltree[K*2]=0;for(K=0;K<s;K++)I.dyn_dtree[K*2]=0;for(K=0;K<y;K++)I.bl_tree[K*2]=0;I.dyn_ltree[x*2]=1,I.opt_len=I.static_len=0,I.sym_next=I.matches=0},Kt=I=>{I.bi_valid>8?De(I,I.bi_buf):I.bi_valid>0&&(I.pending_buf[I.pending++]=I.bi_buf),I.bi_buf=0,I.bi_valid=0},Jt=(I,K,O,be)=>{const Ee=K*2,Le=O*2;return I[Ee]<I[Le]||I[Ee]===I[Le]&&be[K]<=be[O]},Wt=(I,K,O)=>{const be=I.heap[O];let Ee=O<<1;for(;Ee<=I.heap_len&&(Ee<I.heap_len&&Jt(K,I.heap[Ee+1],I.heap[Ee],I.depth)&&Ee++,!Jt(K,be,I.heap[Ee],I.depth));)I.heap[O]=I.heap[Ee],O=Ee,Ee<<=1;I.heap[O]=be},Br=(I,K,O)=>{let be,Ee,Le=0,St,ct;if(I.sym_next!==0)do be=I.pending_buf[I.sym_buf+Le++]&255,be+=(I.pending_buf[I.sym_buf+Le++]&255)<<8,Ee=I.pending_buf[I.sym_buf+Le++],be===0?Be(I,Ee,K):(St=W[Ee],Be(I,St+z+1,K),ct=D[St],ct!==0&&(Ee-=Y[St],Me(I,Ee,ct)),be--,St=Pe(be),Be(I,St,O),ct=L[St],ct!==0&&(be-=G[St],Me(I,be,ct)));while(Le<I.sym_next);Be(I,x,K)},zr=(I,K)=>{const O=K.dyn_tree,be=K.stat_desc.static_tree,Ee=K.stat_desc.has_stree,Le=K.stat_desc.elems;let St,ct,Kr=-1,nt;for(I.heap_len=0,I.heap_max=w,St=0;St<Le;St++)O[St*2]!==0?(I.heap[++I.heap_len]=Kr=St,I.depth[St]=0):O[St*2+1]=0;for(;I.heap_len<2;)nt=I.heap[++I.heap_len]=Kr<2?++Kr:0,O[nt*2]=1,I.depth[nt]=0,I.opt_len--,Ee&&(I.static_len-=be[nt*2+1]);for(K.max_code=Kr,St=I.heap_len>>1;St>=1;St--)Wt(I,O,St);nt=Le;do St=I.heap[1],I.heap[1]=I.heap[I.heap_len--],Wt(I,O,1),ct=I.heap[1],I.heap[--I.heap_max]=St,I.heap[--I.heap_max]=ct,O[nt*2]=O[St*2]+O[ct*2],I.depth[nt]=(I.depth[St]>=I.depth[ct]?I.depth[St]:I.depth[ct])+1,O[St*2+1]=O[ct*2+1]=nt,I.heap[1]=nt++,Wt(I,O,1);while(I.heap_len>=2);I.heap[--I.heap_max]=I.heap[1],Gt(I,K),mt(O,Kr,I.bl_count)},cr=(I,K,O)=>{let be,Ee=-1,Le,St=K[1],ct=0,Kr=7,nt=4;for(St===0&&(Kr=138,nt=3),K[(O+1)*2+1]=65535,be=0;be<=O;be++)Le=St,St=K[(be+1)*2+1],!(++ct<Kr&&Le===St)&&(ct<nt?I.bl_tree[Le*2]+=ct:Le!==0?(Le!==Ee&&I.bl_tree[Le*2]++,I.bl_tree[R*2]++):ct<=10?I.bl_tree[M*2]++:I.bl_tree[P*2]++,ct=0,Ee=Le,St===0?(Kr=138,nt=3):Le===St?(Kr=6,nt=3):(Kr=7,nt=4))},Nr=(I,K,O)=>{let be,Ee=-1,Le,St=K[1],ct=0,Kr=7,nt=4;for(St===0&&(Kr=138,nt=3),be=0;be<=O;be++)if(Le=St,St=K[(be+1)*2+1],!(++ct<Kr&&Le===St)){if(ct<nt)do Be(I,Le,I.bl_tree);while(--ct!==0);else Le!==0?(Le!==Ee&&(Be(I,Le,I.bl_tree),ct--),Be(I,R,I.bl_tree),Me(I,ct-3,2)):ct<=10?(Be(I,M,I.bl_tree),Me(I,ct-3,3)):(Be(I,P,I.bl_tree),Me(I,ct-11,7));ct=0,Ee=Le,St===0?(Kr=138,nt=3):Le===St?(Kr=6,nt=3):(Kr=7,nt=4)}},At=I=>{let K;for(cr(I,I.dyn_ltree,I.l_desc.max_code),cr(I,I.dyn_dtree,I.d_desc.max_code),zr(I,I.bl_desc),K=y-1;K>=3&&I.bl_tree[B[K]*2+1]===0;K--);return I.opt_len+=3*(K+1)+5+5+4,K},Mt=(I,K,O,be)=>{let Ee;for(Me(I,K-257,5),Me(I,O-1,5),Me(I,be-4,4),Ee=0;Ee<be;Ee++)Me(I,I.bl_tree[B[Ee]*2+1],3);Nr(I,I.dyn_ltree,K-1),Nr(I,I.dyn_dtree,O-1)},Jr=I=>{let K=4093624447,O;for(O=0;O<=31;O++,K>>>=1)if(K&1&&I.dyn_ltree[O*2]!==0)return c;if(I.dyn_ltree[18]!==0||I.dyn_ltree[20]!==0||I.dyn_ltree[26]!==0)return u;for(O=32;O<z;O++)if(I.dyn_ltree[O*2]!==0)return u;return c};let Yr=!1;const ie=I=>{Yr||(Fe(),Yr=!0),I.l_desc=new Ne(I.dyn_ltree,Z),I.d_desc=new Ne(I.dyn_dtree,xe),I.bl_desc=new Ne(I.bl_tree,ce),I.bi_buf=0,I.bi_valid=0,ht(I)},ve=(I,K,O,be)=>{Me(I,(g<<1)+(be?1:0),3),Kt(I),De(I,O),De(I,~O),O&&I.pending_buf.set(I.window.subarray(K,K+O),I.pending),I.pending+=O},we=I=>{Me(I,_<<1,3),Be(I,x,H),jt(I)},it=(I,K,O,be)=>{let Ee,Le,St=0;I.level>0?(I.strm.data_type===v&&(I.strm.data_type=Jr(I)),zr(I,I.l_desc),zr(I,I.d_desc),St=At(I),Ee=I.opt_len+3+7>>>3,Le=I.static_len+3+7>>>3,Le<=Ee&&(Ee=Le)):Ee=Le=O+5,O+4<=Ee&&K!==-1?ve(I,K,O,be):I.strategy===o||Le===Ee?(Me(I,(_<<1)+(be?1:0),3),Br(I,H,$)):(Me(I,(p<<1)+(be?1:0),3),Mt(I,I.l_desc.max_code+1,I.d_desc.max_code+1,St+1),Br(I,I.dyn_ltree,I.dyn_dtree)),ht(I),be&&Kt(I)},rt=(I,K,O)=>(I.pending_buf[I.sym_buf+I.sym_next++]=K,I.pending_buf[I.sym_buf+I.sym_next++]=K>>8,I.pending_buf[I.sym_buf+I.sym_next++]=O,K===0?I.dyn_ltree[O*2]++:(I.matches++,K--,I.dyn_ltree[(W[O]+z+1)*2]++,I.dyn_dtree[Pe(K)*2]++),I.sym_next===I.sym_end);var Yt=ie,Ft=ve,re=it,tt=rt,lt=we,ar={_tr_init:Yt,_tr_stored_block:Ft,_tr_flush_block:re,_tr_tally:tt,_tr_align:lt},et=(I,K,O,be)=>{let Ee=I&65535|0,Le=I>>>16&65535|0,St=0;for(;O!==0;){St=O>2e3?2e3:O,O-=St;do Ee=Ee+K[be++]|0,Le=Le+Ee|0;while(--St);Ee%=65521,Le%=65521}return Ee|Le<<16|0};const Ot=()=>{let I,K=[];for(var O=0;O<256;O++){I=O;for(var be=0;be<8;be++)I=I&1?3988292384^I>>>1:I>>>1;K[O]=I}return K},se=new Uint32Array(Ot());var xt=(I,K,O,be)=>{const Ee=se,Le=be+O;I^=-1;for(let St=be;St<Le;St++)I=I>>>8^Ee[(I^K[St])&255];return I^-1},Vr={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},J={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ut,_tr_stored_block:at,_tr_flush_block:me,_tr_tally:Ze,_tr_align:vt}=ar,{Z_NO_FLUSH:Qr,Z_PARTIAL_FLUSH:Xr,Z_FULL_FLUSH:Zr,Z_FINISH:xn,Z_BLOCK:Ei,Z_OK:zn,Z_STREAM_END:Pn,Z_STREAM_ERROR:On,Z_DATA_ERROR:mi,Z_BUF_ERROR:xi,Z_DEFAULT_COMPRESSION:Ca,Z_FILTERED:Aa,Z_HUFFMAN_ONLY:ei,Z_RLE:ai,Z_FIXED:ci,Z_DEFAULT_STRATEGY:Xs,Z_UNKNOWN:Us,Z_DEFLATED:fa}=J,ll=9,cl=15,ul=8,Ya=286,hi=30,dl=19,ja=2*Ya+1,kc=15,Ln=3,Ra=258,pa=Ra+Ln+1,Tl=32,Ws=42,hl=57,ma=69,pu=73,mu=91,gu=103,Na=113,qa=666,Ns=1,Ba=2,fl=3,Ml=4,yu=3,Xa=(I,K)=>(I.msg=Vr[K],K),Tc=I=>I*2-(I>4?9:0),_a=I=>{let K=I.length;for(;--K>=0;)I[K]=0},bh=I=>{let K,O,be,Ee=I.w_size;K=I.hash_size,be=K;do O=I.head[--be],I.head[be]=O>=Ee?O-Ee:0;while(--K);K=Ee,be=K;do O=I.prev[--be],I.prev[be]=O>=Ee?O-Ee:0;while(--K)};let za=(I,K,O)=>(K<<I.hash_shift^O)&I.hash_mask;const Dn=I=>{const K=I.state;let O=K.pending;O>I.avail_out&&(O=I.avail_out),O!==0&&(I.output.set(K.pending_buf.subarray(K.pending_out,K.pending_out+O),I.next_out),I.next_out+=O,K.pending_out+=O,I.total_out+=O,I.avail_out-=O,K.pending-=O,K.pending===0&&(K.pending_out=0))},oa=(I,K)=>{me(I,I.block_start>=0?I.block_start:-1,I.strstart-I.block_start,K),I.block_start=I.strstart,Dn(I.strm)},ii=(I,K)=>{I.pending_buf[I.pending++]=K},pl=(I,K)=>{I.pending_buf[I.pending++]=K>>>8&255,I.pending_buf[I.pending++]=K&255},Mc=(I,K,O,be)=>{let Ee=I.avail_in;return Ee>be&&(Ee=be),Ee===0?0:(I.avail_in-=Ee,K.set(I.input.subarray(I.next_in,I.next_in+Ee),O),I.state.wrap===1?I.adler=et(I.adler,K,Ee,O):I.state.wrap===2&&(I.adler=xt(I.adler,K,Ee,O)),I.next_in+=Ee,I.total_in+=Ee,Ee)},vu=(I,K)=>{let O=I.max_chain_length,be=I.strstart,Ee,Le,St=I.prev_length,ct=I.nice_match;const Kr=I.strstart>I.w_size-pa?I.strstart-(I.w_size-pa):0,nt=I.window,_t=I.w_mask,jn=I.prev,Hr=I.strstart+Ra;let Lr=nt[be+St-1],pi=nt[be+St];I.prev_length>=I.good_match&&(O>>=2),ct>I.lookahead&&(ct=I.lookahead);do if(Ee=K,!(nt[Ee+St]!==pi||nt[Ee+St-1]!==Lr||nt[Ee]!==nt[be]||nt[++Ee]!==nt[be+1])){be+=2,Ee++;do;while(nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&be<Hr);if(Le=Ra-(Hr-be),be=Hr-Ra,Le>St){if(I.match_start=K,St=Le,Le>=ct)break;Lr=nt[be+St-1],pi=nt[be+St]}}while((K=jn[K&_t])>Kr&&--O!==0);return St<=I.lookahead?St:I.lookahead},ml=I=>{const K=I.w_size;let O,be,Ee;do{if(be=I.window_size-I.lookahead-I.strstart,I.strstart>=K+(K-pa)&&(I.window.set(I.window.subarray(K,K+K-be),0),I.match_start-=K,I.strstart-=K,I.block_start-=K,I.insert>I.strstart&&(I.insert=I.strstart),bh(I),be+=K),I.strm.avail_in===0)break;if(O=Mc(I.strm,I.window,I.strstart+I.lookahead,be),I.lookahead+=O,I.lookahead+I.insert>=Ln)for(Ee=I.strstart-I.insert,I.ins_h=I.window[Ee],I.ins_h=za(I,I.ins_h,I.window[Ee+1]);I.insert&&(I.ins_h=za(I,I.ins_h,I.window[Ee+Ln-1]),I.prev[Ee&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=Ee,Ee++,I.insert--,!(I.lookahead+I.insert<Ln)););}while(I.lookahead<pa&&I.strm.avail_in!==0)},Nc=(I,K)=>{let O=I.pending_buf_size-5>I.w_size?I.w_size:I.pending_buf_size-5,be,Ee,Le,St=0,ct=I.strm.avail_in;do{if(be=65535,Le=I.bi_valid+42>>3,I.strm.avail_out<Le||(Le=I.strm.avail_out-Le,Ee=I.strstart-I.block_start,be>Ee+I.strm.avail_in&&(be=Ee+I.strm.avail_in),be>Le&&(be=Le),be<O&&(be===0&&K!==xn||K===Qr||be!==Ee+I.strm.avail_in)))break;St=K===xn&&be===Ee+I.strm.avail_in?1:0,at(I,0,0,St),I.pending_buf[I.pending-4]=be,I.pending_buf[I.pending-3]=be>>8,I.pending_buf[I.pending-2]=~be,I.pending_buf[I.pending-1]=~be>>8,Dn(I.strm),Ee&&(Ee>be&&(Ee=be),I.strm.output.set(I.window.subarray(I.block_start,I.block_start+Ee),I.strm.next_out),I.strm.next_out+=Ee,I.strm.avail_out-=Ee,I.strm.total_out+=Ee,I.block_start+=Ee,be-=Ee),be&&(Mc(I.strm,I.strm.output,I.strm.next_out,be),I.strm.next_out+=be,I.strm.avail_out-=be,I.strm.total_out+=be)}while(St===0);return ct-=I.strm.avail_in,ct&&(ct>=I.w_size?(I.matches=2,I.window.set(I.strm.input.subarray(I.strm.next_in-I.w_size,I.strm.next_in),0),I.strstart=I.w_size,I.insert=I.strstart):(I.window_size-I.strstart<=ct&&(I.strstart-=I.w_size,I.window.set(I.window.subarray(I.w_size,I.w_size+I.strstart),0),I.matches<2&&I.matches++,I.insert>I.strstart&&(I.insert=I.strstart)),I.window.set(I.strm.input.subarray(I.strm.next_in-ct,I.strm.next_in),I.strstart),I.strstart+=ct,I.insert+=ct>I.w_size-I.insert?I.w_size-I.insert:ct),I.block_start=I.strstart),I.high_water<I.strstart&&(I.high_water=I.strstart),St?Ml:K!==Qr&&K!==xn&&I.strm.avail_in===0&&I.strstart===I.block_start?Ba:(Le=I.window_size-I.strstart,I.strm.avail_in>Le&&I.block_start>=I.w_size&&(I.block_start-=I.w_size,I.strstart-=I.w_size,I.window.set(I.window.subarray(I.w_size,I.w_size+I.strstart),0),I.matches<2&&I.matches++,Le+=I.w_size,I.insert>I.strstart&&(I.insert=I.strstart)),Le>I.strm.avail_in&&(Le=I.strm.avail_in),Le&&(Mc(I.strm,I.window,I.strstart,Le),I.strstart+=Le,I.insert+=Le>I.w_size-I.insert?I.w_size-I.insert:Le),I.high_water<I.strstart&&(I.high_water=I.strstart),Le=I.bi_valid+42>>3,Le=I.pending_buf_size-Le>65535?65535:I.pending_buf_size-Le,O=Le>I.w_size?I.w_size:Le,Ee=I.strstart-I.block_start,(Ee>=O||(Ee||K===xn)&&K!==Qr&&I.strm.avail_in===0&&Ee<=Le)&&(be=Ee>Le?Le:Ee,St=K===xn&&I.strm.avail_in===0&&be===Ee?1:0,at(I,I.block_start,be,St),I.block_start+=be,Dn(I.strm)),St?fl:Ns)},Nl=(I,K)=>{let O,be;for(;;){if(I.lookahead<pa){if(ml(I),I.lookahead<pa&&K===Qr)return Ns;if(I.lookahead===0)break}if(O=0,I.lookahead>=Ln&&(I.ins_h=za(I,I.ins_h,I.window[I.strstart+Ln-1]),O=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart),O!==0&&I.strstart-O<=I.w_size-pa&&(I.match_length=vu(I,O)),I.match_length>=Ln)if(be=Ze(I,I.strstart-I.match_start,I.match_length-Ln),I.lookahead-=I.match_length,I.match_length<=I.max_lazy_match&&I.lookahead>=Ln){I.match_length--;do I.strstart++,I.ins_h=za(I,I.ins_h,I.window[I.strstart+Ln-1]),O=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart;while(--I.match_length!==0);I.strstart++}else I.strstart+=I.match_length,I.match_length=0,I.ins_h=I.window[I.strstart],I.ins_h=za(I,I.ins_h,I.window[I.strstart+1]);else be=Ze(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++;if(be&&(oa(I,!1),I.strm.avail_out===0))return Ns}return I.insert=I.strstart<Ln-1?I.strstart:Ln-1,K===xn?(oa(I,!0),I.strm.avail_out===0?fl:Ml):I.sym_next&&(oa(I,!1),I.strm.avail_out===0)?Ns:Ba},ga=(I,K)=>{let O,be,Ee;for(;;){if(I.lookahead<pa){if(ml(I),I.lookahead<pa&&K===Qr)return Ns;if(I.lookahead===0)break}if(O=0,I.lookahead>=Ln&&(I.ins_h=za(I,I.ins_h,I.window[I.strstart+Ln-1]),O=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart),I.prev_length=I.match_length,I.prev_match=I.match_start,I.match_length=Ln-1,O!==0&&I.prev_length<I.max_lazy_match&&I.strstart-O<=I.w_size-pa&&(I.match_length=vu(I,O),I.match_length<=5&&(I.strategy===Aa||I.match_length===Ln&&I.strstart-I.match_start>4096)&&(I.match_length=Ln-1)),I.prev_length>=Ln&&I.match_length<=I.prev_length){Ee=I.strstart+I.lookahead-Ln,be=Ze(I,I.strstart-1-I.prev_match,I.prev_length-Ln),I.lookahead-=I.prev_length-1,I.prev_length-=2;do++I.strstart<=Ee&&(I.ins_h=za(I,I.ins_h,I.window[I.strstart+Ln-1]),O=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart);while(--I.prev_length!==0);if(I.match_available=0,I.match_length=Ln-1,I.strstart++,be&&(oa(I,!1),I.strm.avail_out===0))return Ns}else if(I.match_available){if(be=Ze(I,0,I.window[I.strstart-1]),be&&oa(I,!1),I.strstart++,I.lookahead--,I.strm.avail_out===0)return Ns}else I.match_available=1,I.strstart++,I.lookahead--}return I.match_available&&(be=Ze(I,0,I.window[I.strstart-1]),I.match_available=0),I.insert=I.strstart<Ln-1?I.strstart:Ln-1,K===xn?(oa(I,!0),I.strm.avail_out===0?fl:Ml):I.sym_next&&(oa(I,!1),I.strm.avail_out===0)?Ns:Ba},Ja=(I,K)=>{let O,be,Ee,Le;const St=I.window;for(;;){if(I.lookahead<=Ra){if(ml(I),I.lookahead<=Ra&&K===Qr)return Ns;if(I.lookahead===0)break}if(I.match_length=0,I.lookahead>=Ln&&I.strstart>0&&(Ee=I.strstart-1,be=St[Ee],be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee])){Le=I.strstart+Ra;do;while(be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee]&&be===St[++Ee]&&Ee<Le);I.match_length=Ra-(Le-Ee),I.match_length>I.lookahead&&(I.match_length=I.lookahead)}if(I.match_length>=Ln?(O=Ze(I,1,I.match_length-Ln),I.lookahead-=I.match_length,I.strstart+=I.match_length,I.match_length=0):(O=Ze(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++),O&&(oa(I,!1),I.strm.avail_out===0))return Ns}return I.insert=0,K===xn?(oa(I,!0),I.strm.avail_out===0?fl:Ml):I.sym_next&&(oa(I,!1),I.strm.avail_out===0)?Ns:Ba},Qa=(I,K)=>{let O;for(;;){if(I.lookahead===0&&(ml(I),I.lookahead===0)){if(K===Qr)return Ns;break}if(I.match_length=0,O=Ze(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++,O&&(oa(I,!1),I.strm.avail_out===0))return Ns}return I.insert=0,K===xn?(oa(I,!0),I.strm.avail_out===0?fl:Ml):I.sym_next&&(oa(I,!1),I.strm.avail_out===0)?Ns:Ba};function aa(I,K,O,be,Ee){this.good_length=I,this.max_lazy=K,this.nice_length=O,this.max_chain=be,this.func=Ee}const Ga=[new aa(0,0,0,0,Nc),new aa(4,4,8,4,Nl),new aa(4,5,16,8,Nl),new aa(4,6,32,32,Nl),new aa(4,4,16,16,ga),new aa(8,16,32,32,ga),new aa(8,16,128,128,ga),new aa(8,32,128,256,ga),new aa(32,128,258,1024,ga),new aa(32,258,258,4096,ga)],Za=I=>{I.window_size=2*I.w_size,_a(I.head),I.max_lazy_match=Ga[I.level].max_lazy,I.good_match=Ga[I.level].good_length,I.nice_match=Ga[I.level].nice_length,I.max_chain_length=Ga[I.level].max_chain,I.strstart=0,I.block_start=0,I.lookahead=0,I.insert=0,I.match_length=I.prev_length=Ln-1,I.match_available=0,I.ins_h=0};function wh(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=fa,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(ja*2),this.dyn_dtree=new Uint16Array((2*hi+1)*2),this.bl_tree=new Uint16Array((2*dl+1)*2),_a(this.dyn_ltree),_a(this.dyn_dtree),_a(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(kc+1),this.heap=new Uint16Array(2*Ya+1),_a(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Ya+1),_a(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const zl=I=>{if(!I)return 1;const K=I.state;return!K||K.strm!==I||K.status!==Ws&&K.status!==hl&&K.status!==ma&&K.status!==pu&&K.status!==mu&&K.status!==gu&&K.status!==Na&&K.status!==qa?1:0},Il=I=>{if(zl(I))return Xa(I,On);I.total_in=I.total_out=0,I.data_type=Us;const K=I.state;return K.pending=0,K.pending_out=0,K.wrap<0&&(K.wrap=-K.wrap),K.status=K.wrap===2?hl:K.wrap?Ws:Na,I.adler=K.wrap===2?0:1,K.last_flush=-2,ut(K),zn},fd=I=>{const K=Il(I);return K===zn&&Za(I.state),K},pd=(I,K)=>zl(I)||I.state.wrap!==2?On:(I.state.gzhead=K,zn),rc=(I,K,O,be,Ee,Le)=>{if(!I)return On;let St=1;if(K===Ca&&(K=6),be<0?(St=0,be=-be):be>15&&(St=2,be-=16),Ee<1||Ee>ll||O!==fa||be<8||be>15||K<0||K>9||Le<0||Le>ci||be===8&&St!==1)return Xa(I,On);be===8&&(be=9);const ct=new wh;return I.state=ct,ct.strm=I,ct.status=Ws,ct.wrap=St,ct.gzhead=null,ct.w_bits=be,ct.w_size=1<<ct.w_bits,ct.w_mask=ct.w_size-1,ct.hash_bits=Ee+7,ct.hash_size=1<<ct.hash_bits,ct.hash_mask=ct.hash_size-1,ct.hash_shift=~~((ct.hash_bits+Ln-1)/Ln),ct.window=new Uint8Array(ct.w_size*2),ct.head=new Uint16Array(ct.hash_size),ct.prev=new Uint16Array(ct.w_size),ct.lit_bufsize=1<<Ee+6,ct.pending_buf_size=ct.lit_bufsize*4,ct.pending_buf=new Uint8Array(ct.pending_buf_size),ct.sym_buf=ct.lit_bufsize,ct.sym_end=(ct.lit_bufsize-1)*3,ct.level=K,ct.strategy=Le,ct.method=O,fd(I)},md=(I,K)=>rc(I,K,fa,cl,ul,Xs),Eh=(I,K)=>{if(zl(I)||K>Ei||K<0)return I?Xa(I,On):On;const O=I.state;if(!I.output||I.avail_in!==0&&!I.input||O.status===qa&&K!==xn)return Xa(I,I.avail_out===0?xi:On);const be=O.last_flush;if(O.last_flush=K,O.pending!==0){if(Dn(I),I.avail_out===0)return O.last_flush=-1,zn}else if(I.avail_in===0&&Tc(K)<=Tc(be)&&K!==xn)return Xa(I,xi);if(O.status===qa&&I.avail_in!==0)return Xa(I,xi);if(O.status===Ws&&O.wrap===0&&(O.status=Na),O.status===Ws){let Ee=fa+(O.w_bits-8<<4)<<8,Le=-1;if(O.strategy>=ei||O.level<2?Le=0:O.level<6?Le=1:O.level===6?Le=2:Le=3,Ee|=Le<<6,O.strstart!==0&&(Ee|=Tl),Ee+=31-Ee%31,pl(O,Ee),O.strstart!==0&&(pl(O,I.adler>>>16),pl(O,I.adler&65535)),I.adler=1,O.status=Na,Dn(I),O.pending!==0)return O.last_flush=-1,zn}if(O.status===hl){if(I.adler=0,ii(O,31),ii(O,139),ii(O,8),O.gzhead)ii(O,(O.gzhead.text?1:0)+(O.gzhead.hcrc?2:0)+(O.gzhead.extra?4:0)+(O.gzhead.name?8:0)+(O.gzhead.comment?16:0)),ii(O,O.gzhead.time&255),ii(O,O.gzhead.time>>8&255),ii(O,O.gzhead.time>>16&255),ii(O,O.gzhead.time>>24&255),ii(O,O.level===9?2:O.strategy>=ei||O.level<2?4:0),ii(O,O.gzhead.os&255),O.gzhead.extra&&O.gzhead.extra.length&&(ii(O,O.gzhead.extra.length&255),ii(O,O.gzhead.extra.length>>8&255)),O.gzhead.hcrc&&(I.adler=xt(I.adler,O.pending_buf,O.pending,0)),O.gzindex=0,O.status=ma;else if(ii(O,0),ii(O,0),ii(O,0),ii(O,0),ii(O,0),ii(O,O.level===9?2:O.strategy>=ei||O.level<2?4:0),ii(O,yu),O.status=Na,Dn(I),O.pending!==0)return O.last_flush=-1,zn}if(O.status===ma){if(O.gzhead.extra){let Ee=O.pending,Le=(O.gzhead.extra.length&65535)-O.gzindex;for(;O.pending+Le>O.pending_buf_size;){let ct=O.pending_buf_size-O.pending;if(O.pending_buf.set(O.gzhead.extra.subarray(O.gzindex,O.gzindex+ct),O.pending),O.pending=O.pending_buf_size,O.gzhead.hcrc&&O.pending>Ee&&(I.adler=xt(I.adler,O.pending_buf,O.pending-Ee,Ee)),O.gzindex+=ct,Dn(I),O.pending!==0)return O.last_flush=-1,zn;Ee=0,Le-=ct}let St=new Uint8Array(O.gzhead.extra);O.pending_buf.set(St.subarray(O.gzindex,O.gzindex+Le),O.pending),O.pending+=Le,O.gzhead.hcrc&&O.pending>Ee&&(I.adler=xt(I.adler,O.pending_buf,O.pending-Ee,Ee)),O.gzindex=0}O.status=pu}if(O.status===pu){if(O.gzhead.name){let Ee=O.pending,Le;do{if(O.pending===O.pending_buf_size){if(O.gzhead.hcrc&&O.pending>Ee&&(I.adler=xt(I.adler,O.pending_buf,O.pending-Ee,Ee)),Dn(I),O.pending!==0)return O.last_flush=-1,zn;Ee=0}O.gzindex<O.gzhead.name.length?Le=O.gzhead.name.charCodeAt(O.gzindex++)&255:Le=0,ii(O,Le)}while(Le!==0);O.gzhead.hcrc&&O.pending>Ee&&(I.adler=xt(I.adler,O.pending_buf,O.pending-Ee,Ee)),O.gzindex=0}O.status=mu}if(O.status===mu){if(O.gzhead.comment){let Ee=O.pending,Le;do{if(O.pending===O.pending_buf_size){if(O.gzhead.hcrc&&O.pending>Ee&&(I.adler=xt(I.adler,O.pending_buf,O.pending-Ee,Ee)),Dn(I),O.pending!==0)return O.last_flush=-1,zn;Ee=0}O.gzindex<O.gzhead.comment.length?Le=O.gzhead.comment.charCodeAt(O.gzindex++)&255:Le=0,ii(O,Le)}while(Le!==0);O.gzhead.hcrc&&O.pending>Ee&&(I.adler=xt(I.adler,O.pending_buf,O.pending-Ee,Ee))}O.status=gu}if(O.status===gu){if(O.gzhead.hcrc){if(O.pending+2>O.pending_buf_size&&(Dn(I),O.pending!==0))return O.last_flush=-1,zn;ii(O,I.adler&255),ii(O,I.adler>>8&255),I.adler=0}if(O.status=Na,Dn(I),O.pending!==0)return O.last_flush=-1,zn}if(I.avail_in!==0||O.lookahead!==0||K!==Qr&&O.status!==qa){let Ee=O.level===0?Nc(O,K):O.strategy===ei?Qa(O,K):O.strategy===ai?Ja(O,K):Ga[O.level].func(O,K);if((Ee===fl||Ee===Ml)&&(O.status=qa),Ee===Ns||Ee===fl)return I.avail_out===0&&(O.last_flush=-1),zn;if(Ee===Ba&&(K===Xr?vt(O):K!==Ei&&(at(O,0,0,!1),K===Zr&&(_a(O.head),O.lookahead===0&&(O.strstart=0,O.block_start=0,O.insert=0))),Dn(I),I.avail_out===0))return O.last_flush=-1,zn}return K!==xn?zn:O.wrap<=0?Pn:(O.wrap===2?(ii(O,I.adler&255),ii(O,I.adler>>8&255),ii(O,I.adler>>16&255),ii(O,I.adler>>24&255),ii(O,I.total_in&255),ii(O,I.total_in>>8&255),ii(O,I.total_in>>16&255),ii(O,I.total_in>>24&255)):(pl(O,I.adler>>>16),pl(O,I.adler&65535)),Dn(I),O.wrap>0&&(O.wrap=-O.wrap),O.pending!==0?zn:Pn)},nc=I=>{if(zl(I))return On;const K=I.state.status;return I.state=null,K===Na?Xa(I,mi):zn},ic=(I,K)=>{let O=K.length;if(zl(I))return On;const be=I.state,Ee=be.wrap;if(Ee===2||Ee===1&&be.status!==Ws||be.lookahead)return On;if(Ee===1&&(I.adler=et(I.adler,K,O,0)),be.wrap=0,O>=be.w_size){Ee===0&&(_a(be.head),be.strstart=0,be.block_start=0,be.insert=0);let Kr=new Uint8Array(be.w_size);Kr.set(K.subarray(O-be.w_size,O),0),K=Kr,O=be.w_size}const Le=I.avail_in,St=I.next_in,ct=I.input;for(I.avail_in=O,I.next_in=0,I.input=K,ml(be);be.lookahead>=Ln;){let Kr=be.strstart,nt=be.lookahead-(Ln-1);do be.ins_h=za(be,be.ins_h,be.window[Kr+Ln-1]),be.prev[Kr&be.w_mask]=be.head[be.ins_h],be.head[be.ins_h]=Kr,Kr++;while(--nt);be.strstart=Kr,be.lookahead=Ln-1,ml(be)}return be.strstart+=be.lookahead,be.block_start=be.strstart,be.insert=be.lookahead,be.lookahead=0,be.match_length=be.prev_length=Ln-1,be.match_available=0,I.next_in=St,I.input=ct,I.avail_in=Le,be.wrap=Ee,zn};var Pl=md,zc=rc,Sh=fd,Ch=Il,xu=pd,Ic=Eh,_u=nc,gd=ic,Ka="pako deflate (from Nodeca project)",gl={deflateInit:Pl,deflateInit2:zc,deflateReset:Sh,deflateResetKeep:Ch,deflateSetHeader:xu,deflate:Ic,deflateEnd:_u,deflateSetDictionary:gd,deflateInfo:Ka};const Pc=(I,K)=>Object.prototype.hasOwnProperty.call(I,K);var yd=function(I){const K=Array.prototype.slice.call(arguments,1);for(;K.length;){const O=K.shift();if(O){if(typeof O!="object")throw new TypeError(O+"must be non-object");for(const be in O)Pc(O,be)&&(I[be]=O[be])}}return I},Dc=I=>{let K=0;for(let be=0,Ee=I.length;be<Ee;be++)K+=I[be].length;const O=new Uint8Array(K);for(let be=0,Ee=0,Le=I.length;be<Le;be++){let St=I[be];O.set(St,Ee),Ee+=St.length}return O},yl={assign:yd,flattenChunks:Dc};let bu=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{bu=!1}const $s=new Uint8Array(256);for(let I=0;I<256;I++)$s[I]=I>=252?6:I>=248?5:I>=240?4:I>=224?3:I>=192?2:1;$s[254]=$s[254]=1;var Dl=I=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(I);let K,O,be,Ee,Le,St=I.length,ct=0;for(Ee=0;Ee<St;Ee++)O=I.charCodeAt(Ee),(O&64512)===55296&&Ee+1<St&&(be=I.charCodeAt(Ee+1),(be&64512)===56320&&(O=65536+(O-55296<<10)+(be-56320),Ee++)),ct+=O<128?1:O<2048?2:O<65536?3:4;for(K=new Uint8Array(ct),Le=0,Ee=0;Le<ct;Ee++)O=I.charCodeAt(Ee),(O&64512)===55296&&Ee+1<St&&(be=I.charCodeAt(Ee+1),(be&64512)===56320&&(O=65536+(O-55296<<10)+(be-56320),Ee++)),O<128?K[Le++]=O:O<2048?(K[Le++]=192|O>>>6,K[Le++]=128|O&63):O<65536?(K[Le++]=224|O>>>12,K[Le++]=128|O>>>6&63,K[Le++]=128|O&63):(K[Le++]=240|O>>>18,K[Le++]=128|O>>>12&63,K[Le++]=128|O>>>6&63,K[Le++]=128|O&63);return K};const wu=(I,K)=>{if(K<65534&&I.subarray&&bu)return String.fromCharCode.apply(null,I.length===K?I:I.subarray(0,K));let O="";for(let be=0;be<K;be++)O+=String.fromCharCode(I[be]);return O};var sc=(I,K)=>{const O=K||I.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(I.subarray(0,K));let be,Ee;const Le=new Array(O*2);for(Ee=0,be=0;be<O;){let St=I[be++];if(St<128){Le[Ee++]=St;continue}let ct=$s[St];if(ct>4){Le[Ee++]=65533,be+=ct-1;continue}for(St&=ct===2?31:ct===3?15:7;ct>1&&be<O;)St=St<<6|I[be++]&63,ct--;if(ct>1){Le[Ee++]=65533;continue}St<65536?Le[Ee++]=St:(St-=65536,Le[Ee++]=55296|St>>10&1023,Le[Ee++]=56320|St&1023)}return wu(Le,Ee)},Ah=(I,K)=>{K=K||I.length,K>I.length&&(K=I.length);let O=K-1;for(;O>=0&&(I[O]&192)===128;)O--;return O<0||O===0?K:O+$s[I[O]]>K?O:K},vl={string2buf:Dl,buf2string:sc,utf8border:Ah};function Eu(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Fl=Eu;const oc=Object.prototype.toString,{Z_NO_FLUSH:vd,Z_SYNC_FLUSH:Rh,Z_FULL_FLUSH:kh,Z_FINISH:Th,Z_OK:Ol,Z_STREAM_END:Mh,Z_DEFAULT_COMPRESSION:Nh,Z_DEFAULT_STRATEGY:zh,Z_DEFLATED:Ih}=J;function ac(I){this.options=yl.assign({level:Nh,method:Ih,chunkSize:16384,windowBits:15,memLevel:8,strategy:zh},I||{});let K=this.options;K.raw&&K.windowBits>0?K.windowBits=-K.windowBits:K.gzip&&K.windowBits>0&&K.windowBits<16&&(K.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Fl,this.strm.avail_out=0;let O=gl.deflateInit2(this.strm,K.level,K.method,K.windowBits,K.memLevel,K.strategy);if(O!==Ol)throw new Error(Vr[O]);if(K.header&&gl.deflateSetHeader(this.strm,K.header),K.dictionary){let be;if(typeof K.dictionary=="string"?be=vl.string2buf(K.dictionary):oc.call(K.dictionary)==="[object ArrayBuffer]"?be=new Uint8Array(K.dictionary):be=K.dictionary,O=gl.deflateSetDictionary(this.strm,be),O!==Ol)throw new Error(Vr[O]);this._dict_set=!0}}ac.prototype.push=function(I,K){const O=this.strm,be=this.options.chunkSize;let Ee,Le;if(this.ended)return!1;for(K===~~K?Le=K:Le=K===!0?Th:vd,typeof I=="string"?O.input=vl.string2buf(I):oc.call(I)==="[object ArrayBuffer]"?O.input=new Uint8Array(I):O.input=I,O.next_in=0,O.avail_in=O.input.length;;){if(O.avail_out===0&&(O.output=new Uint8Array(be),O.next_out=0,O.avail_out=be),(Le===Rh||Le===kh)&&O.avail_out<=6){this.onData(O.output.subarray(0,O.next_out)),O.avail_out=0;continue}if(Ee=gl.deflate(O,Le),Ee===Mh)return O.next_out>0&&this.onData(O.output.subarray(0,O.next_out)),Ee=gl.deflateEnd(this.strm),this.onEnd(Ee),this.ended=!0,Ee===Ol;if(O.avail_out===0){this.onData(O.output);continue}if(Le>0&&O.next_out>0){this.onData(O.output.subarray(0,O.next_out)),O.avail_out=0;continue}if(O.avail_in===0)break}return!0},ac.prototype.onData=function(I){this.chunks.push(I)},ac.prototype.onEnd=function(I){I===Ol&&(this.result=yl.flattenChunks(this.chunks)),this.chunks=[],this.err=I,this.msg=this.strm.msg};function Fc(I,K){const O=new ac(K);if(O.push(I,!0),O.err)throw O.msg||Vr[O.err];return O.result}function Ph(I,K){return K=K||{},K.raw=!0,Fc(I,K)}function Dh(I,K){return K=K||{},K.gzip=!0,Fc(I,K)}var Fh=ac,Oh=Fc,Su=Ph,Lh=Dh,jh={Deflate:Fh,deflate:Oh,deflateRaw:Su,gzip:Lh};const Oc=16209,xd=16191;var Bh=function(I,K){let O,be,Ee,Le,St,ct,Kr,nt,_t,jn,Hr,Lr,pi,vi,ti,Cn,En,Wr,An,ks,ni,Bn,li,Rn;const Fn=I.state;O=I.next_in,li=I.input,be=O+(I.avail_in-5),Ee=I.next_out,Rn=I.output,Le=Ee-(K-I.avail_out),St=Ee+(I.avail_out-257),ct=Fn.dmax,Kr=Fn.wsize,nt=Fn.whave,_t=Fn.wnext,jn=Fn.window,Hr=Fn.hold,Lr=Fn.bits,pi=Fn.lencode,vi=Fn.distcode,ti=(1<<Fn.lenbits)-1,Cn=(1<<Fn.distbits)-1;e:do{Lr<15&&(Hr+=li[O++]<<Lr,Lr+=8,Hr+=li[O++]<<Lr,Lr+=8),En=pi[Hr&ti];t:for(;;){if(Wr=En>>>24,Hr>>>=Wr,Lr-=Wr,Wr=En>>>16&255,Wr===0)Rn[Ee++]=En&65535;else if(Wr&16){An=En&65535,Wr&=15,Wr&&(Lr<Wr&&(Hr+=li[O++]<<Lr,Lr+=8),An+=Hr&(1<<Wr)-1,Hr>>>=Wr,Lr-=Wr),Lr<15&&(Hr+=li[O++]<<Lr,Lr+=8,Hr+=li[O++]<<Lr,Lr+=8),En=vi[Hr&Cn];r:for(;;){if(Wr=En>>>24,Hr>>>=Wr,Lr-=Wr,Wr=En>>>16&255,Wr&16){if(ks=En&65535,Wr&=15,Lr<Wr&&(Hr+=li[O++]<<Lr,Lr+=8,Lr<Wr&&(Hr+=li[O++]<<Lr,Lr+=8)),ks+=Hr&(1<<Wr)-1,ks>ct){I.msg="invalid distance too far back",Fn.mode=Oc;break e}if(Hr>>>=Wr,Lr-=Wr,Wr=Ee-Le,ks>Wr){if(Wr=ks-Wr,Wr>nt&&Fn.sane){I.msg="invalid distance too far back",Fn.mode=Oc;break e}if(ni=0,Bn=jn,_t===0){if(ni+=Kr-Wr,Wr<An){An-=Wr;do Rn[Ee++]=jn[ni++];while(--Wr);ni=Ee-ks,Bn=Rn}}else if(_t<Wr){if(ni+=Kr+_t-Wr,Wr-=_t,Wr<An){An-=Wr;do Rn[Ee++]=jn[ni++];while(--Wr);if(ni=0,_t<An){Wr=_t,An-=Wr;do Rn[Ee++]=jn[ni++];while(--Wr);ni=Ee-ks,Bn=Rn}}}else if(ni+=_t-Wr,Wr<An){An-=Wr;do Rn[Ee++]=jn[ni++];while(--Wr);ni=Ee-ks,Bn=Rn}for(;An>2;)Rn[Ee++]=Bn[ni++],Rn[Ee++]=Bn[ni++],Rn[Ee++]=Bn[ni++],An-=3;An&&(Rn[Ee++]=Bn[ni++],An>1&&(Rn[Ee++]=Bn[ni++]))}else{ni=Ee-ks;do Rn[Ee++]=Rn[ni++],Rn[Ee++]=Rn[ni++],Rn[Ee++]=Rn[ni++],An-=3;while(An>2);An&&(Rn[Ee++]=Rn[ni++],An>1&&(Rn[Ee++]=Rn[ni++]))}}else if(Wr&64){I.msg="invalid distance code",Fn.mode=Oc;break e}else{En=vi[(En&65535)+(Hr&(1<<Wr)-1)];continue r}break}}else if(Wr&64)if(Wr&32){Fn.mode=xd;break e}else{I.msg="invalid literal/length code",Fn.mode=Oc;break e}else{En=pi[(En&65535)+(Hr&(1<<Wr)-1)];continue t}break}}while(O<be&&Ee<St);An=Lr>>3,O-=An,Lr-=An<<3,Hr&=(1<<Lr)-1,I.next_in=O,I.next_out=Ee,I.avail_in=O<be?5+(be-O):5-(O-be),I.avail_out=Ee<St?257+(St-Ee):257-(Ee-St),Fn.hold=Hr,Fn.bits=Lr};const Ll=15,_d=852,bd=592,wd=0,Cu=1,Ed=2,Ru=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lc=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Gh=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Sd=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var jl=(I,K,O,be,Ee,Le,St,ct)=>{const Kr=ct.bits;let nt=0,_t=0,jn=0,Hr=0,Lr=0,pi=0,vi=0,ti=0,Cn=0,En=0,Wr,An,ks,ni,Bn,li=null,Rn;const Fn=new Uint16Array(Ll+1),Qs=new Uint16Array(Ll+1);let ba=null,nu,iu,ca;for(nt=0;nt<=Ll;nt++)Fn[nt]=0;for(_t=0;_t<be;_t++)Fn[K[O+_t]]++;for(Lr=Kr,Hr=Ll;Hr>=1&&Fn[Hr]===0;Hr--);if(Lr>Hr&&(Lr=Hr),Hr===0)return Ee[Le++]=1<<24|64<<16|0,Ee[Le++]=1<<24|64<<16|0,ct.bits=1,0;for(jn=1;jn<Hr&&Fn[jn]===0;jn++);for(Lr<jn&&(Lr=jn),ti=1,nt=1;nt<=Ll;nt++)if(ti<<=1,ti-=Fn[nt],ti<0)return-1;if(ti>0&&(I===wd||Hr!==1))return-1;for(Qs[1]=0,nt=1;nt<Ll;nt++)Qs[nt+1]=Qs[nt]+Fn[nt];for(_t=0;_t<be;_t++)K[O+_t]!==0&&(St[Qs[K[O+_t]]++]=_t);if(I===wd?(li=ba=St,Rn=20):I===Cu?(li=Ru,ba=lc,Rn=257):(li=Gh,ba=Sd,Rn=0),En=0,_t=0,nt=jn,Bn=Le,pi=Lr,vi=0,ks=-1,Cn=1<<Lr,ni=Cn-1,I===Cu&&Cn>_d||I===Ed&&Cn>bd)return 1;for(;;){nu=nt-vi,St[_t]+1<Rn?(iu=0,ca=St[_t]):St[_t]>=Rn?(iu=ba[St[_t]-Rn],ca=li[St[_t]-Rn]):(iu=96,ca=0),Wr=1<<nt-vi,An=1<<pi,jn=An;do An-=Wr,Ee[Bn+(En>>vi)+An]=nu<<24|iu<<16|ca|0;while(An!==0);for(Wr=1<<nt-1;En&Wr;)Wr>>=1;if(Wr!==0?(En&=Wr-1,En+=Wr):En=0,_t++,--Fn[nt]===0){if(nt===Hr)break;nt=K[O+St[_t]]}if(nt>Lr&&(En&ni)!==ks){for(vi===0&&(vi=Lr),Bn+=jn,pi=nt-vi,ti=1<<pi;pi+vi<Hr&&(ti-=Fn[pi+vi],!(ti<=0));)pi++,ti<<=1;if(Cn+=1<<pi,I===Cu&&Cn>_d||I===Ed&&Cn>bd)return 1;ks=En&ni,Ee[ks]=Lr<<24|pi<<16|Bn-Le|0}}return En!==0&&(Ee[Bn+En]=nt-vi<<24|64<<16|0),ct.bits=Lr,0};const Cd=0,ku=1,Tu=2,{Z_FINISH:xl,Z_BLOCK:Uh,Z_TREES:Lc,Z_OK:_l,Z_STREAM_END:Ad,Z_NEED_DICT:Rd,Z_STREAM_ERROR:ra,Z_DATA_ERROR:Bl,Z_MEM_ERROR:kd,Z_BUF_ERROR:jc,Z_DEFLATED:Td}=J,uc=16180,Bc=16181,Gc=16182,Mu=16183,Nu=16184,zu=16185,Md=16186,Nd=16187,zd=16188,Id=16189,Uc=16190,Ls=16191,bl=16192,Iu=16193,Vc=16194,Pu=16195,Du=16196,Wc=16197,Pd=16198,$c=16199,Ua=16200,Hc=16201,Gl=16202,Yc=16203,Fu=16204,dc=16205,el=16206,qc=16207,Ou=16208,ui=16209,Lu=16210,ju=16211,Dd=852,Fd=592,Od=15,Bu=I=>(I>>>24&255)+(I>>>8&65280)+((I&65280)<<8)+((I&255)<<24);function tl(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Va=I=>{if(!I)return 1;const K=I.state;return!K||K.strm!==I||K.mode<uc||K.mode>ju?1:0},Xc=I=>{if(Va(I))return ra;const K=I.state;return I.total_in=I.total_out=K.total=0,I.msg="",K.wrap&&(I.adler=K.wrap&1),K.mode=uc,K.last=0,K.havedict=0,K.flags=-1,K.dmax=32768,K.head=null,K.hold=0,K.bits=0,K.lencode=K.lendyn=new Int32Array(Dd),K.distcode=K.distdyn=new Int32Array(Fd),K.sane=1,K.back=-1,_l},Ld=I=>{if(Va(I))return ra;const K=I.state;return K.wsize=0,K.whave=0,K.wnext=0,Xc(I)},jd=(I,K)=>{let O;if(Va(I))return ra;const be=I.state;return K<0?(O=0,K=-K):(O=(K>>4)+5,K<48&&(K&=15)),K&&(K<8||K>15)?ra:(be.window!==null&&be.wbits!==K&&(be.window=null),be.wrap=O,be.wbits=K,Ld(I))},Ul=(I,K)=>{if(!I)return ra;const O=new tl;I.state=O,O.strm=I,O.window=null,O.mode=uc;const be=jd(I,K);return be!==_l&&(I.state=null),be},Vh=I=>Ul(I,Od);let Gu=!0,Jc,di;const Uu=I=>{if(Gu){Jc=new Int32Array(512),di=new Int32Array(32);let K=0;for(;K<144;)I.lens[K++]=8;for(;K<256;)I.lens[K++]=9;for(;K<280;)I.lens[K++]=7;for(;K<288;)I.lens[K++]=8;for(jl(ku,I.lens,0,288,Jc,0,I.work,{bits:9}),K=0;K<32;)I.lens[K++]=5;jl(Tu,I.lens,0,32,di,0,I.work,{bits:5}),Gu=!1}I.lencode=Jc,I.lenbits=9,I.distcode=di,I.distbits=5},hc=(I,K,O,be)=>{let Ee;const Le=I.state;return Le.window===null&&(Le.wsize=1<<Le.wbits,Le.wnext=0,Le.whave=0,Le.window=new Uint8Array(Le.wsize)),be>=Le.wsize?(Le.window.set(K.subarray(O-Le.wsize,O),0),Le.wnext=0,Le.whave=Le.wsize):(Ee=Le.wsize-Le.wnext,Ee>be&&(Ee=be),Le.window.set(K.subarray(O-be,O-be+Ee),Le.wnext),be-=Ee,be?(Le.window.set(K.subarray(O-be,O),0),Le.wnext=be,Le.whave=Le.wsize):(Le.wnext+=Ee,Le.wnext===Le.wsize&&(Le.wnext=0),Le.whave<Le.wsize&&(Le.whave+=Ee))),0},fc=(I,K)=>{let O,be,Ee,Le,St,ct,Kr,nt,_t,jn,Hr,Lr,pi,vi,ti=0,Cn,En,Wr,An,ks,ni,Bn,li;const Rn=new Uint8Array(4);let Fn,Qs;const ba=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Va(I)||!I.output||!I.input&&I.avail_in!==0)return ra;O=I.state,O.mode===Ls&&(O.mode=bl),St=I.next_out,Ee=I.output,Kr=I.avail_out,Le=I.next_in,be=I.input,ct=I.avail_in,nt=O.hold,_t=O.bits,jn=ct,Hr=Kr,li=_l;e:for(;;)switch(O.mode){case uc:if(O.wrap===0){O.mode=bl;break}for(;_t<16;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}if(O.wrap&2&&nt===35615){O.wbits===0&&(O.wbits=15),O.check=0,Rn[0]=nt&255,Rn[1]=nt>>>8&255,O.check=xt(O.check,Rn,2,0),nt=0,_t=0,O.mode=Bc;break}if(O.head&&(O.head.done=!1),!(O.wrap&1)||(((nt&255)<<8)+(nt>>8))%31){I.msg="incorrect header check",O.mode=ui;break}if((nt&15)!==Td){I.msg="unknown compression method",O.mode=ui;break}if(nt>>>=4,_t-=4,Bn=(nt&15)+8,O.wbits===0&&(O.wbits=Bn),Bn>15||Bn>O.wbits){I.msg="invalid window size",O.mode=ui;break}O.dmax=1<<O.wbits,O.flags=0,I.adler=O.check=1,O.mode=nt&512?Id:Ls,nt=0,_t=0;break;case Bc:for(;_t<16;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}if(O.flags=nt,(O.flags&255)!==Td){I.msg="unknown compression method",O.mode=ui;break}if(O.flags&57344){I.msg="unknown header flags set",O.mode=ui;break}O.head&&(O.head.text=nt>>8&1),O.flags&512&&O.wrap&4&&(Rn[0]=nt&255,Rn[1]=nt>>>8&255,O.check=xt(O.check,Rn,2,0)),nt=0,_t=0,O.mode=Gc;case Gc:for(;_t<32;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}O.head&&(O.head.time=nt),O.flags&512&&O.wrap&4&&(Rn[0]=nt&255,Rn[1]=nt>>>8&255,Rn[2]=nt>>>16&255,Rn[3]=nt>>>24&255,O.check=xt(O.check,Rn,4,0)),nt=0,_t=0,O.mode=Mu;case Mu:for(;_t<16;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}O.head&&(O.head.xflags=nt&255,O.head.os=nt>>8),O.flags&512&&O.wrap&4&&(Rn[0]=nt&255,Rn[1]=nt>>>8&255,O.check=xt(O.check,Rn,2,0)),nt=0,_t=0,O.mode=Nu;case Nu:if(O.flags&1024){for(;_t<16;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}O.length=nt,O.head&&(O.head.extra_len=nt),O.flags&512&&O.wrap&4&&(Rn[0]=nt&255,Rn[1]=nt>>>8&255,O.check=xt(O.check,Rn,2,0)),nt=0,_t=0}else O.head&&(O.head.extra=null);O.mode=zu;case zu:if(O.flags&1024&&(Lr=O.length,Lr>ct&&(Lr=ct),Lr&&(O.head&&(Bn=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Uint8Array(O.head.extra_len)),O.head.extra.set(be.subarray(Le,Le+Lr),Bn)),O.flags&512&&O.wrap&4&&(O.check=xt(O.check,be,Lr,Le)),ct-=Lr,Le+=Lr,O.length-=Lr),O.length))break e;O.length=0,O.mode=Md;case Md:if(O.flags&2048){if(ct===0)break e;Lr=0;do Bn=be[Le+Lr++],O.head&&Bn&&O.length<65536&&(O.head.name+=String.fromCharCode(Bn));while(Bn&&Lr<ct);if(O.flags&512&&O.wrap&4&&(O.check=xt(O.check,be,Lr,Le)),ct-=Lr,Le+=Lr,Bn)break e}else O.head&&(O.head.name=null);O.length=0,O.mode=Nd;case Nd:if(O.flags&4096){if(ct===0)break e;Lr=0;do Bn=be[Le+Lr++],O.head&&Bn&&O.length<65536&&(O.head.comment+=String.fromCharCode(Bn));while(Bn&&Lr<ct);if(O.flags&512&&O.wrap&4&&(O.check=xt(O.check,be,Lr,Le)),ct-=Lr,Le+=Lr,Bn)break e}else O.head&&(O.head.comment=null);O.mode=zd;case zd:if(O.flags&512){for(;_t<16;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}if(O.wrap&4&&nt!==(O.check&65535)){I.msg="header crc mismatch",O.mode=ui;break}nt=0,_t=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),I.adler=O.check=0,O.mode=Ls;break;case Id:for(;_t<32;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}I.adler=O.check=Bu(nt),nt=0,_t=0,O.mode=Uc;case Uc:if(O.havedict===0)return I.next_out=St,I.avail_out=Kr,I.next_in=Le,I.avail_in=ct,O.hold=nt,O.bits=_t,Rd;I.adler=O.check=1,O.mode=Ls;case Ls:if(K===Uh||K===Lc)break e;case bl:if(O.last){nt>>>=_t&7,_t-=_t&7,O.mode=el;break}for(;_t<3;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}switch(O.last=nt&1,nt>>>=1,_t-=1,nt&3){case 0:O.mode=Iu;break;case 1:if(Uu(O),O.mode=$c,K===Lc){nt>>>=2,_t-=2;break e}break;case 2:O.mode=Du;break;case 3:I.msg="invalid block type",O.mode=ui}nt>>>=2,_t-=2;break;case Iu:for(nt>>>=_t&7,_t-=_t&7;_t<32;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}if((nt&65535)!==(nt>>>16^65535)){I.msg="invalid stored block lengths",O.mode=ui;break}if(O.length=nt&65535,nt=0,_t=0,O.mode=Vc,K===Lc)break e;case Vc:O.mode=Pu;case Pu:if(Lr=O.length,Lr){if(Lr>ct&&(Lr=ct),Lr>Kr&&(Lr=Kr),Lr===0)break e;Ee.set(be.subarray(Le,Le+Lr),St),ct-=Lr,Le+=Lr,Kr-=Lr,St+=Lr,O.length-=Lr;break}O.mode=Ls;break;case Du:for(;_t<14;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}if(O.nlen=(nt&31)+257,nt>>>=5,_t-=5,O.ndist=(nt&31)+1,nt>>>=5,_t-=5,O.ncode=(nt&15)+4,nt>>>=4,_t-=4,O.nlen>286||O.ndist>30){I.msg="too many length or distance symbols",O.mode=ui;break}O.have=0,O.mode=Wc;case Wc:for(;O.have<O.ncode;){for(;_t<3;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}O.lens[ba[O.have++]]=nt&7,nt>>>=3,_t-=3}for(;O.have<19;)O.lens[ba[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,Fn={bits:O.lenbits},li=jl(Cd,O.lens,0,19,O.lencode,0,O.work,Fn),O.lenbits=Fn.bits,li){I.msg="invalid code lengths set",O.mode=ui;break}O.have=0,O.mode=Pd;case Pd:for(;O.have<O.nlen+O.ndist;){for(;ti=O.lencode[nt&(1<<O.lenbits)-1],Cn=ti>>>24,En=ti>>>16&255,Wr=ti&65535,!(Cn<=_t);){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}if(Wr<16)nt>>>=Cn,_t-=Cn,O.lens[O.have++]=Wr;else{if(Wr===16){for(Qs=Cn+2;_t<Qs;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}if(nt>>>=Cn,_t-=Cn,O.have===0){I.msg="invalid bit length repeat",O.mode=ui;break}Bn=O.lens[O.have-1],Lr=3+(nt&3),nt>>>=2,_t-=2}else if(Wr===17){for(Qs=Cn+3;_t<Qs;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}nt>>>=Cn,_t-=Cn,Bn=0,Lr=3+(nt&7),nt>>>=3,_t-=3}else{for(Qs=Cn+7;_t<Qs;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}nt>>>=Cn,_t-=Cn,Bn=0,Lr=11+(nt&127),nt>>>=7,_t-=7}if(O.have+Lr>O.nlen+O.ndist){I.msg="invalid bit length repeat",O.mode=ui;break}for(;Lr--;)O.lens[O.have++]=Bn}}if(O.mode===ui)break;if(O.lens[256]===0){I.msg="invalid code -- missing end-of-block",O.mode=ui;break}if(O.lenbits=9,Fn={bits:O.lenbits},li=jl(ku,O.lens,0,O.nlen,O.lencode,0,O.work,Fn),O.lenbits=Fn.bits,li){I.msg="invalid literal/lengths set",O.mode=ui;break}if(O.distbits=6,O.distcode=O.distdyn,Fn={bits:O.distbits},li=jl(Tu,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,Fn),O.distbits=Fn.bits,li){I.msg="invalid distances set",O.mode=ui;break}if(O.mode=$c,K===Lc)break e;case $c:O.mode=Ua;case Ua:if(ct>=6&&Kr>=258){I.next_out=St,I.avail_out=Kr,I.next_in=Le,I.avail_in=ct,O.hold=nt,O.bits=_t,Bh(I,Hr),St=I.next_out,Ee=I.output,Kr=I.avail_out,Le=I.next_in,be=I.input,ct=I.avail_in,nt=O.hold,_t=O.bits,O.mode===Ls&&(O.back=-1);break}for(O.back=0;ti=O.lencode[nt&(1<<O.lenbits)-1],Cn=ti>>>24,En=ti>>>16&255,Wr=ti&65535,!(Cn<=_t);){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}if(En&&!(En&240)){for(An=Cn,ks=En,ni=Wr;ti=O.lencode[ni+((nt&(1<<An+ks)-1)>>An)],Cn=ti>>>24,En=ti>>>16&255,Wr=ti&65535,!(An+Cn<=_t);){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}nt>>>=An,_t-=An,O.back+=An}if(nt>>>=Cn,_t-=Cn,O.back+=Cn,O.length=Wr,En===0){O.mode=dc;break}if(En&32){O.back=-1,O.mode=Ls;break}if(En&64){I.msg="invalid literal/length code",O.mode=ui;break}O.extra=En&15,O.mode=Hc;case Hc:if(O.extra){for(Qs=O.extra;_t<Qs;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}O.length+=nt&(1<<O.extra)-1,nt>>>=O.extra,_t-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=Gl;case Gl:for(;ti=O.distcode[nt&(1<<O.distbits)-1],Cn=ti>>>24,En=ti>>>16&255,Wr=ti&65535,!(Cn<=_t);){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}if(!(En&240)){for(An=Cn,ks=En,ni=Wr;ti=O.distcode[ni+((nt&(1<<An+ks)-1)>>An)],Cn=ti>>>24,En=ti>>>16&255,Wr=ti&65535,!(An+Cn<=_t);){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}nt>>>=An,_t-=An,O.back+=An}if(nt>>>=Cn,_t-=Cn,O.back+=Cn,En&64){I.msg="invalid distance code",O.mode=ui;break}O.offset=Wr,O.extra=En&15,O.mode=Yc;case Yc:if(O.extra){for(Qs=O.extra;_t<Qs;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}O.offset+=nt&(1<<O.extra)-1,nt>>>=O.extra,_t-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){I.msg="invalid distance too far back",O.mode=ui;break}O.mode=Fu;case Fu:if(Kr===0)break e;if(Lr=Hr-Kr,O.offset>Lr){if(Lr=O.offset-Lr,Lr>O.whave&&O.sane){I.msg="invalid distance too far back",O.mode=ui;break}Lr>O.wnext?(Lr-=O.wnext,pi=O.wsize-Lr):pi=O.wnext-Lr,Lr>O.length&&(Lr=O.length),vi=O.window}else vi=Ee,pi=St-O.offset,Lr=O.length;Lr>Kr&&(Lr=Kr),Kr-=Lr,O.length-=Lr;do Ee[St++]=vi[pi++];while(--Lr);O.length===0&&(O.mode=Ua);break;case dc:if(Kr===0)break e;Ee[St++]=O.length,Kr--,O.mode=Ua;break;case el:if(O.wrap){for(;_t<32;){if(ct===0)break e;ct--,nt|=be[Le++]<<_t,_t+=8}if(Hr-=Kr,I.total_out+=Hr,O.total+=Hr,O.wrap&4&&Hr&&(I.adler=O.check=O.flags?xt(O.check,Ee,Hr,St-Hr):et(O.check,Ee,Hr,St-Hr)),Hr=Kr,O.wrap&4&&(O.flags?nt:Bu(nt))!==O.check){I.msg="incorrect data check",O.mode=ui;break}nt=0,_t=0}O.mode=qc;case qc:if(O.wrap&&O.flags){for(;_t<32;){if(ct===0)break e;ct--,nt+=be[Le++]<<_t,_t+=8}if(O.wrap&4&&nt!==(O.total&4294967295)){I.msg="incorrect length check",O.mode=ui;break}nt=0,_t=0}O.mode=Ou;case Ou:li=Ad;break e;case ui:li=Bl;break e;case Lu:return kd;case ju:default:return ra}return I.next_out=St,I.avail_out=Kr,I.next_in=Le,I.avail_in=ct,O.hold=nt,O.bits=_t,(O.wsize||Hr!==I.avail_out&&O.mode<ui&&(O.mode<el||K!==xl))&&hc(I,I.output,I.next_out,Hr-I.avail_out),jn-=I.avail_in,Hr-=I.avail_out,I.total_in+=jn,I.total_out+=Hr,O.total+=Hr,O.wrap&4&&Hr&&(I.adler=O.check=O.flags?xt(O.check,Ee,Hr,I.next_out-Hr):et(O.check,Ee,Hr,I.next_out-Hr)),I.data_type=O.bits+(O.last?64:0)+(O.mode===Ls?128:0)+(O.mode===$c||O.mode===Vc?256:0),(jn===0&&Hr===0||K===xl)&&li===_l&&(li=jc),li},Bd=I=>{if(Va(I))return ra;let K=I.state;return K.window&&(K.window=null),I.state=null,_l},Vu=(I,K)=>{if(Va(I))return ra;const O=I.state;return O.wrap&2?(O.head=K,K.done=!1,_l):ra},pc=(I,K)=>{const O=K.length;let be,Ee,Le;return Va(I)||(be=I.state,be.wrap!==0&&be.mode!==Uc)?ra:be.mode===Uc&&(Ee=1,Ee=et(Ee,K,O,0),Ee!==be.check)?Bl:(Le=hc(I,K,O,O),Le?(be.mode=Lu,kd):(be.havedict=1,_l))};var Qc=Ld,Vl=jd,Gd=Xc,Wh=Vh,$h=Ul,Ud=fc,Zc=Bd,Kc=Vu,Wu=pc,$u="pako inflate (from Nodeca project)",ka={inflateReset:Qc,inflateReset2:Vl,inflateResetKeep:Gd,inflateInit:Wh,inflateInit2:$h,inflate:Ud,inflateEnd:Zc,inflateGetHeader:Kc,inflateSetDictionary:Wu,inflateInfo:$u};function Hu(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Hh=Hu;const Yu=Object.prototype.toString,{Z_NO_FLUSH:Yh,Z_FINISH:qh,Z_OK:wl,Z_STREAM_END:Ia,Z_NEED_DICT:eu,Z_STREAM_ERROR:Wl,Z_DATA_ERROR:Ta,Z_MEM_ERROR:mc}=J;function ya(I){this.options=yl.assign({chunkSize:65536,windowBits:15,to:""},I||{});const K=this.options;K.raw&&K.windowBits>=0&&K.windowBits<16&&(K.windowBits=-K.windowBits,K.windowBits===0&&(K.windowBits=-15)),K.windowBits>=0&&K.windowBits<16&&!(I&&I.windowBits)&&(K.windowBits+=32),K.windowBits>15&&K.windowBits<48&&(K.windowBits&15||(K.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Fl,this.strm.avail_out=0;let O=ka.inflateInit2(this.strm,K.windowBits);if(O!==wl)throw new Error(Vr[O]);if(this.header=new Hh,ka.inflateGetHeader(this.strm,this.header),K.dictionary&&(typeof K.dictionary=="string"?K.dictionary=vl.string2buf(K.dictionary):Yu.call(K.dictionary)==="[object ArrayBuffer]"&&(K.dictionary=new Uint8Array(K.dictionary)),K.raw&&(O=ka.inflateSetDictionary(this.strm,K.dictionary),O!==wl)))throw new Error(Vr[O])}ya.prototype.push=function(I,K){const O=this.strm,be=this.options.chunkSize,Ee=this.options.dictionary;let Le,St,ct;if(this.ended)return!1;for(K===~~K?St=K:St=K===!0?qh:Yh,Yu.call(I)==="[object ArrayBuffer]"?O.input=new Uint8Array(I):O.input=I,O.next_in=0,O.avail_in=O.input.length;;){for(O.avail_out===0&&(O.output=new Uint8Array(be),O.next_out=0,O.avail_out=be),Le=ka.inflate(O,St),Le===eu&&Ee&&(Le=ka.inflateSetDictionary(O,Ee),Le===wl?Le=ka.inflate(O,St):Le===Ta&&(Le=eu));O.avail_in>0&&Le===Ia&&O.state.wrap>0&&I[O.next_in]!==0;)ka.inflateReset(O),Le=ka.inflate(O,St);switch(Le){case Wl:case Ta:case eu:case mc:return this.onEnd(Le),this.ended=!0,!1}if(ct=O.avail_out,O.next_out&&(O.avail_out===0||Le===Ia))if(this.options.to==="string"){let Kr=vl.utf8border(O.output,O.next_out),nt=O.next_out-Kr,_t=vl.buf2string(O.output,Kr);O.next_out=nt,O.avail_out=be-nt,nt&&O.output.set(O.output.subarray(Kr,Kr+nt),0),this.onData(_t)}else this.onData(O.output.length===O.next_out?O.output:O.output.subarray(0,O.next_out));if(!(Le===wl&&ct===0)){if(Le===Ia)return Le=ka.inflateEnd(this.strm),this.onEnd(Le),this.ended=!0,!0;if(O.avail_in===0)break}}return!0},ya.prototype.onData=function(I){this.chunks.push(I)},ya.prototype.onEnd=function(I){I===wl&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=yl.flattenChunks(this.chunks)),this.chunks=[],this.err=I,this.msg=this.strm.msg};function gc(I,K){const O=new ya(K);if(O.push(I),O.err)throw O.msg||Vr[O.err];return O.result}function Xh(I,K){return K=K||{},K.raw=!0,gc(I,K)}var Jh=ya,El=gc,yc=Xh,$l=gc,tu={Inflate:Jh,inflate:El,inflateRaw:yc,ungzip:$l};const{Deflate:qu,deflate:Hl,deflateRaw:rl,gzip:gi}=jh,{Inflate:fi,inflate:nl,inflateRaw:Js,ungzip:la}=tu;var il=qu,Sl=Hl,na=rl,vc=gi,Xu=fi,Ju=nl,xc=Js,Qu=la,Pa=J,ru={Deflate:il,deflate:Sl,deflateRaw:na,gzip:vc,Inflate:Xu,inflate:Ju,inflateRaw:xc,ungzip:Qu,constants:Pa}})},__webpack_module_cache__={};function __webpack_require__(e){var r=__webpack_module_cache__[e];if(r!==void 0)return r.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(t.exports,t,t.exports,__webpack_require__),t.exports}__webpack_require__.n=e=>{var r=e&&e.__esModule?(()=>e.default):(()=>e);return __webpack_require__.d(r,{a:r}),r},__webpack_require__.d=(e,r)=>{for(var t in r)__webpack_require__.o(r,t)&&!__webpack_require__.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},__webpack_require__.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),__webpack_require__.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__("./src/index.ts"),__webpack_require__("./src/SurfaceWorker.js");var __webpack_exports__=__webpack_require__("./src/exporter.js");return __webpack_exports__})())})(_3Dmol);var _3DmolExports=_3Dmol.exports;const covalentRadii={H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.61,Fe:1.52,Co:1.5,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,Pd:1.39,Ag:1.45,Cd:1.44,In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.75,Hf:1.87,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69};function mod(e,r){return(e%r+r)%r}function setCustomBondLengths(){function e(r,t){_3DmolExports.setBondLength(r,t)}Object.keys(covalentRadii).forEach(r=>{e(r,1.05*covalentRadii[r])})}class Visualizer3dmol extends React.Component{constructor(r){super(r),setCustomBondLengths(),this.viewer=null,this.model=null,this.divId="gldiv-"+(Math.random()+1).toString(36).substring(7)}componentDidMount(){let r={backgroundColor:"white",orthographic:!0};this.viewer=_3DmolExports.createViewer(this.divId,r),this.updateView()}componentDidUpdate(r){(r.viewerParams!=this.props.viewerParams||r.cifText!=this.props.cifText)&&this.updateView()}custom3dmolSetup(){if(this.model=this.viewer.addModel(),this.props.cifText){let r=_3DmolExports.Parsers.CIF(this.props.cifText),t=r[0],o=r.modelData[0].cryst;this.model.setCrystData(o.a,o.b,o.c,o.alpha,o.beta,o.gamma);let c=this.model.modelData.cryst.matrix,u=new _3DmolExports.Matrix3().getInverse3(c),v=[],f=[];t.forEach(p=>{let E=new _3DmolExports.Vector3(p.x,p.y,p.z);if(this.props.viewerParams.packedCell){let k=E.clone().applyMatrix3(u);E=new _3DmolExports.Vector3(mod(k.x,1),mod(k.y,1),mod(k.z,1)).applyMatrix3(c)}f.push({elem:p.elem,x:E.x,y:E.y,z:E.z})});let g=.03,_=this.props.viewerParams.supercell;for(let p=-1;p<_[0]+1;p++)for(let E=-1;E<_[1]+1;E++)for(let k=-1;k<_[2]+1;k++){let A=new _3DmolExports.Vector3(p,E,k);if(A.applyMatrix3(c),p==-1||p==_[0]||E==-1||E==_[1]||k==-1||k==_[2])if(this.props.viewerParams.packedCell)f.forEach(z=>{let l=new _3DmolExports.Vector3(z.x,z.y,z.z);l.add(A);let s=l.clone().applyMatrix3(u);s.x>-g&&s.x<_[0]+g&&s.y>-g&&s.y<_[1]+g&&s.z>-g&&s.z<_[2]+g&&v.push({elem:z.elem,x:l.x,y:l.y,z:l.z})});else continue;else f.forEach(z=>{v.push({elem:z.elem,x:z.x+A.x,y:z.y+A.y,z:z.z+A.z})})}this.model.addAtoms(v)}}updateView(){this.viewer.removeAllModels(),this.custom3dmolSetup();let r={sphere:{scale:.3,colorscheme:"Jmol"}};this.props.viewerParams.vdwRadius&&(r.sphere.scale=1),this.props.viewerParams.bonds&&(r.stick={radius:.15,colorscheme:"Jmol"}),this.viewer.setStyle(r),this.viewer.addUnitCell(this.model),this.model.assignBonds(),this.viewer.removeAllLabels(),this.props.viewerParams.atomLabels&&this.model.atoms.forEach(t=>{this.viewer.addLabel(t.elem,{position:{x:t.x,y:t.y,z:t.z},fontColor:"black",bold:!0,fontSize:18,showBackground:!1,backgroundOpacity:1,inFront:!0},null,!0)}),this.viewer.zoomTo(),this.viewer.zoom(1.4),this.viewer.render()}handleEvent(r,t){r=="camera"&&(t=="x"&&this.viewer.setView([0,0,0,0,-.5,-.5,-.5,.5]),t=="y"&&this.viewer.setView([0,0,0,0,.5,.5,.5,.5]),t=="z"&&this.viewer.setView([0,0,0,0,0,0,0,1]),this.viewer.zoomTo(),this.viewer.zoom(1.4))}render(){return jsxRuntimeExports.jsx("div",{id:this.divId,className:"gldiv",children:"No data!"})}}class StructureWindow extends React.Component{constructor(r){super(r)}render(){let r="structure-window";this.props.mouseEnabled||(r+=" disable-mouse");let t="Click to interact",o="mouse-disabled-note";return this.props.mouseEnabled&&(o="mouse-disabled-note on"),jsxRuntimeExports.jsxs("div",{className:"structure-window-outer",children:[jsxRuntimeExports.jsx("div",{className:"structure-window-click-handler",onClick:()=>this.props.setMouseEnabledState(!0),children:jsxRuntimeExports.jsx("div",{className:r,children:jsxRuntimeExports.jsx(Visualizer3dmol,{ref:this.props.visualizerRef,viewerParams:this.props.viewerParams,cifText:this.props.cifText})})}),jsxRuntimeExports.jsx("div",{className:o,onClick:()=>this.props.setMouseEnabledState(!this.props.mouseEnabled),children:t})]})}}const StructureVisualizer=e=>{const[r,t]=reactExports.useState({supercell:e.initSupercell||[2,2,2],bonds:!0,packedCell:!0,atomLabels:!1,vdwRadius:!1}),[o,c]=reactExports.useState(!1),u=reactExports.useRef(null),v=reactExports.useRef(null);reactExports.useEffect(()=>{const p=E=>{v&&!v.current.contains(E.target)&&c(!1)};return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)}},[]);const f=p=>{c(p)},g=(p,E)=>{t(k=>({...k,[p]:E}))},_=(p,E)=>{u.current.handleEvent(p,E)};return jsxRuntimeExports.jsxs("div",{ref:v,className:"structure-visualizer",children:[jsxRuntimeExports.jsx(StructureWindow,{visualizerRef:u,viewerParams:r,cifText:e.cifText,mouseEnabled:o,setMouseEnabledState:f}),jsxRuntimeExports.jsx(ControlBox,{viewerParams:r,onViewerParamChange:g,onViewerEvent:_})]})};function getVol(e,r=4){const t=(u,v)=>[u[1]*v[2]-u[2]*v[1],u[2]*v[0]-u[0]*v[2],u[0]*v[1]-u[1]*v[0]],o=e.attributes.cell,c=Math.abs(o[0].reduce((u,v,f)=>u+v*t(o[1],o[2])[f],0));return parseFloat(c.toFixed(r))}function formatLattice(e){const r=e.attributes.cell,t=Math.hypot(...r[0]),o=Math.hypot(...r[1]),c=Math.hypot(...r[2]);return{a:t,b:o,c}}function StructureVisualiser({nodeData:e,baseUrl:r}){const t=e.download.cifText,o=e.label==="CifData"?[{format:"cif",label:"CIF"}]:[{format:"cif",label:"CIF"},{format:"xsf",label:"XSF"},{format:"xyz",label:"XYZ"}],c=e.derived_properties&&Object.keys(e.derived_properties).length>0,u=e.attributes?.cell?formatLattice(e):null,v=c?e.derived_properties.dimensionality?.value:u?getVol(e):null,f=e.attributes?.sites?.length||0;return jsxRuntimeExports$1.jsxs("div",{className:"p-4",children:[c&&jsxRuntimeExports$1.jsxs("div",{className:"p grid grid-cols-2 gap-4",children:[jsxRuntimeExports$1.jsxs("div",{className:"bg-gray-100 px-2 py-2 rounded shadow-sm",children:[jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Cell Volume:"})," ",v?.toFixed(4)," Å³"]}),jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Formula:"})," ",e.derived_properties.formula]}),jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Dimensionality:"})," ",e.derived_properties.dimensionality?.description||"N/A"]})]}),u&&jsxRuntimeExports$1.jsxs("div",{className:"bg-gray-100 px-2 py-2 rounded shadow-sm",children:[jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Lattice a:"})," ",u.a.toFixed(4)," Å"]}),jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Lattice b:"})," ",u.b.toFixed(4)," Å"]}),jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Lattice c:"})," ",u.c.toFixed(4)," Å"]}),jsxRuntimeExports$1.jsxs("p",{children:[jsxRuntimeExports$1.jsx("strong",{children:"Number of Sites:"})," ",f]})]})]}),jsxRuntimeExports$1.jsxs("div",{className:"w-full h-[500px] pt-4 relative",children:[jsxRuntimeExports$1.jsx("div",{className:"absolute top-8 right-8 z-50",children:jsxRuntimeExports$1.jsx(Au,{aiida_rest_url:r,uuid:e.aiida.uuid,download_formats:o})}),jsxRuntimeExports$1.jsx("div",{className:"w-full h-full relative overflow-hidden",children:jsxRuntimeExports$1.jsx(StructureVisualizer,{cifText:t,initSupercell:[2,2,2]})})]})]})}function FormattedMetaData({nodeData:e,userData:r}){const t=r?.users||[],o=e?.aiida;if(!o)return jsxRuntimeExports$1.jsx("div",{className:"p-4 text-gray-500 italic",children:"No metadata available"});const c=Array.isArray(t)?t.find(u=>u.id===o.user_id):null;return jsxRuntimeExports$1.jsxs("div",{className:"",children:[jsxRuntimeExports$1.jsx("h2",{className:"text-lg font-semibold pb-2",children:e.label||""}),jsxRuntimeExports$1.jsxs("div",{className:"space-y-1 text-sm",children:[o.uuid&&jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("span",{className:"font-medium",children:"UUID:"})," ",o.uuid]}),o.ctime&&jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("span",{className:"font-medium",children:"Created:"})," ",o.ctime]}),o.mtime&&jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("span",{className:"font-medium",children:"Modified:"})," ",o.mtime]}),o.node_type&&jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("span",{className:"font-medium",children:"Node Type:"})," ",o.node_type]}),c&&jsxRuntimeExports$1.jsxs("div",{children:[jsxRuntimeExports$1.jsx("span",{className:"font-medium",children:"Owner:"})," ",c.first_name," ",c.last_name||"",c.institution&&jsxRuntimeExports$1.jsxs("span",{className:"text-gray-500",children:[" (",c.institution,")"]})]})]})]})}function VisualiserPane({baseUrl:e,selectedNode:r,userData:t}){const[o,c]=reactExports.useState("rich"),u=(()=>{if(!r)return null;const{label:f,aiida:g}=r.data;switch(f){case"StructureData":case"CifData":return jsxRuntimeExports$1.jsx(StructureVisualiser,{nodeData:r.data},g?.uuid);case"KpointsData":return jsxRuntimeExports$1.jsx(KpointsDataVisualiser,{nodeData:r.data},g?.uuid);case"UpfData":return jsxRuntimeExports$1.jsx(UpfDataVisualiser,{nodeData:r.data,baseUrl:e},g?.uuid);case"FolderData":return jsxRuntimeExports$1.jsx(FolderDataVisualiser,{nodeData:r.data},g?.uuid);case"CalcJobNode":return jsxRuntimeExports$1.jsx(CalcJobVisualiser,{nodeData:r.data},g?.uuid);default:return null}})();if(reactExports.useEffect(()=>{u||c("raw")},[u]),!r)return jsxRuntimeExports$1.jsx("div",{className:"w-full h-full p-4",children:jsxRuntimeExports$1.jsx("p",{children:"Click a node to see top level details. Double click to traverse the graph."})});const v=!u;return jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full flex flex-col overflow-hidden",children:[jsxRuntimeExports$1.jsx("div",{className:"p-4 border-b bg-slate-50",children:jsxRuntimeExports$1.jsx(FormattedMetaData,{nodeData:r.data,userData:t})}),jsxRuntimeExports$1.jsxs("div",{className:"flex border-b bg-gray-100",children:[jsxRuntimeExports$1.jsx("button",{disabled:v,className:`px-4 py-2 ${o==="rich"?"border-b-2 border-blue-500 font-semibold":v?"text-gray-400 cursor-not-allowed":""}`,onClick:()=>!v&&c("rich"),children:"Rich View"}),jsxRuntimeExports$1.jsx("button",{className:`px-4 py-2 ${o==="raw"?"border-b-2 border-blue-500 font-semibold":""}`,onClick:()=>c("raw"),children:"Raw View"})]}),jsxRuntimeExports$1.jsxs("div",{className:"flex-1 overflow-auto",children:[o==="rich"&&u,o==="raw"&&jsxRuntimeExports$1.jsx(RawDataVisualiser,{nodeData:r.data})]})]})}function Breadcrumbs({trail:e,onClick:r,maxItems:t=10}){const o=e.slice(-t);return jsxRuntimeExports$1.jsx("div",{className:"w-full border-t border-gray-300 p-2 flex gap-2 flex-wrap overflow-x-auto",children:o.map((c,u)=>jsxRuntimeExports$1.jsxs(React.Fragment,{children:[jsxRuntimeExports$1.jsxs("button",{className:"bg-gray-200 hover:bg-gray-300 text-sm px-2 py-1 rounded",onClick:()=>r(c,u),children:[c.data.label," (",c.data.aiida.uuid.split("-")[0],")"]}),u<o.length-1&&jsxRuntimeExports$1.jsx("span",{className:"mx-1",children:"→"})]},`${c.id}-${u}`))})}function Explorer({baseUrl:e="",startingNode:r="",debugMode:t=!0}){const[o,c]=reactExports.useState(null),[u,v]=reactExports.useState(null);reactExports.useEffect(()=>{let B=!0;return fetchUsers(e).then(j=>{B&&(c(j),t&&console.log("users",j))}),()=>{B=!1}},[e]),reactExports.useEffect(()=>{let B=!0;return fetchDownloadFormats(e).then(j=>{B&&(v(j),t&&console.log("downloadFormats",j))}),()=>{B=!1}},[e]);const[f,g]=reactExports.useState([]),[_,p]=reactExports.useState([]),[E,k]=reactExports.useState([]),A=10,[z,l]=useSearchParams(),s=z.get("rootNode")||r,[y,w]=reactExports.useState(s),[S,C]=reactExports.useState(null),[h,x]=reactExports.useState({}),[R,M]=reactExports.useState(()=>s===""?"groupsview":null);reactExports.useEffect(()=>{let B=!0;async function j(){const{nodes:H,edges:$}=await fetchGraphByNodeId(e,y);if(!B)return;const q=H.map(W=>{const{pos:Y,...G}=h[W.id]||{};return{...W,data:{...W.data,...G}}});if(g(q),p($),S){const W=q.find(Y=>Y.id===S.id);C(W||null)}}return j(),()=>{B=!1}},[y]);const P=async B=>{const j=await smartFetchData(e,B,h);return x(H=>({...H,[B.id]:{...H[B.id]||{},...j.data}})),j},D=async B=>{const j=await P(B);C(j),g(H=>H.map($=>$.id===B.id?{...$,data:{...$.data,...j.data}}:$))},L=async B=>{E[E.length-1]?.id!==B.id&&k(H=>[...H,B].slice(-A)),w(B.id),l({rootNode:B.id});const j=await P(B);C(j)},X=async(B,j)=>{k($=>$.slice(0,j+1)),w(B.id),l({rootNode:B.id});const H=await P(B);C(H)};return jsxRuntimeExports$1.jsxs("div",{className:"flex flex-col h-screen relative",children:[!R&&jsxRuntimeExports$1.jsx("div",{className:"absolute top-4 left-4 z-50 flex gap-2",children:jsxRuntimeExports$1.jsxs("button",{className:"group px-3 py-2 rounded-md bg-white shadow-md text-blue-600 text-lg flex items-center gap-1 hover:text-blue-800",onClick:()=>M("groupsview"),children:[jsxRuntimeExports$1.jsx(GroupIcon,{size:24,className:"text-blue-600 group-hover:text-blue-800 transition-colors"}),jsxRuntimeExports$1.jsx("span",{className:"transition-colors",children:"Query database"})]})}),jsxRuntimeExports$1.jsx("button",{className:"absolute top-4 right-2/3 z-50 px-3 py-2 bg-blue-600 text-white rounded-md shadow-md hover:bg-blue-700 transition-colors",onClick:async()=>{if(!f||f.length===0)return;const B=await fetchLinkCounts(e,f);g(B),B.forEach(j=>{console.log(`${j.data.label} - Parent count: ${j.parentCount||0}, Child count: ${j.childCount||0}`)})},children:"Get Counts"}),jsxRuntimeExports$1.jsx("div",{className:`fixed inset-0 z-40 flex items-center justify-center bg-black/30
      transition-all duration-500 ease-in-out
      ${R?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>M(null),children:jsxRuntimeExports$1.jsxs("div",{className:`bg-white w-full mx-4 h-5/6 rounded-xl shadow-xl overflow-auto relative
        transform transition-all duration-500 ease-in-out
        ${R?"scale-100 opacity-100":"scale-95 opacity-0"}`,onClick:B=>B.stopPropagation(),children:[jsxRuntimeExports$1.jsx("button",{className:"absolute top-3 right-3 p-2",onClick:()=>M(null),children:jsxRuntimeExports$1.jsx(XIcon,{size:24,className:"text-slate-800 hover:text-red-800 transition-colors duration-400"})}),R==="groupsview"&&jsxRuntimeExports$1.jsx(GroupsViewer2,{baseUrl:e}),R==="typesview"&&jsxRuntimeExports$1.jsx(GridViewer,{baseUrl:e})]})}),jsxRuntimeExports$1.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[jsxRuntimeExports$1.jsx("div",{className:"flex-1 w-1/2 border-r border-gray-300 h-full",children:jsxRuntimeExports$1.jsx(FlowChart,{nodes:f,edges:_,setNodes:g,setEdges:p,selectedNode:S,onNodeSelect:D,onNodeDoubleSelect:L})}),jsxRuntimeExports$1.jsxs("div",{className:"w-1/2 flex flex-col h-full",children:[t&&jsxRuntimeExports$1.jsx("div",{className:"flex h-1/4 border-b border-gray-300 overflow-y-auto",children:jsxRuntimeExports$1.jsx(DebugPane,{selectedNode:S})}),jsxRuntimeExports$1.jsx("div",{className:"flex-1 overflow-y-auto",children:jsxRuntimeExports$1.jsx(VisualiserPane,{baseUrl:e,selectedNode:S,userData:o})})]})]}),jsxRuntimeExports$1.jsx("div",{className:"flex-none h-12 border-t border-gray-300",children:jsxRuntimeExports$1.jsx(Breadcrumbs,{trail:E,onClick:X,maxItems:A})})]})}function App(){return jsxRuntimeExports$1.jsx(Explorer,{baseUrl:"https://aiida.materialscloud.org/mc3d-pbe-v1/api/v4"})}ReactDOM$1.createRoot(document.getElementById("root")).render(jsxRuntimeExports$1.jsx(React.StrictMode,{children:jsxRuntimeExports$1.jsx(BrowserRouter,{children:jsxRuntimeExports$1.jsx(App,{})})}));
