(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const h of c)if(h.type==="childList")for(const _ of h.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&a(_)}).observe(document,{childList:!0,subtree:!0});function t(c){const h={};return c.integrity&&(h.integrity=c.integrity),c.referrerPolicy&&(h.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?h.credentials="include":c.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function a(c){if(c.ep)return;c.ep=!0;const h=t(c);fetch(c.href,h)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsxRuntime$1={exports:{}},reactJsxRuntime_production_min$1={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),h=Symbol.for("react.provider"),_=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),b=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),E=Symbol.iterator;function M(G){return G===null||typeof G!="object"?null:(G=E&&G[E]||G["@@iterator"],typeof G=="function"?G:null)}var R={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z=Object.assign,l={};function s(G,V,Q){this.props=G,this.context=V,this.refs=l,this.updater=Q||R}s.prototype.isReactComponent={},s.prototype.setState=function(G,V){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,V,"setState")},s.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function v(){}v.prototype=s.prototype;function w(G,V,Q){this.props=G,this.context=V,this.refs=l,this.updater=Q||R}var S=w.prototype=new v;S.constructor=w,z(S,s.prototype),S.isPureReactComponent=!0;var A=Array.isArray,u=Object.prototype.hasOwnProperty,y={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function k(G,V,Q){var xe,ce={},Ne=null,Pe=null;if(V!=null)for(xe in V.ref!==void 0&&(Pe=V.ref),V.key!==void 0&&(Ne=""+V.key),V)u.call(V,xe)&&!C.hasOwnProperty(xe)&&(ce[xe]=V[xe]);var Fe=arguments.length-2;if(Fe===1)ce.children=Q;else if(1<Fe){for(var Me=Array(Fe),je=0;je<Fe;je++)Me[je]=arguments[je+2];ce.children=Me}if(G&&G.defaultProps)for(xe in Fe=G.defaultProps,Fe)ce[xe]===void 0&&(ce[xe]=Fe[xe]);return{$$typeof:e,type:G,key:Ne,ref:Pe,props:ce,_owner:y.current}}function I(G,V){return{$$typeof:e,type:G.type,key:V,ref:G.ref,props:G.props,_owner:G._owner}}function O(G){return typeof G=="object"&&G!==null&&G.$$typeof===e}function D(G){var V={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(Q){return V[Q]})}var X=/\/+/g;function j(G,V){return typeof G=="object"&&G!==null&&G.key!=null?D(""+G.key):V.toString(36)}function B(G,V,Q,xe,ce){var Ne=typeof G;(Ne==="undefined"||Ne==="boolean")&&(G=null);var Pe=!1;if(G===null)Pe=!0;else switch(Ne){case"string":case"number":Pe=!0;break;case"object":switch(G.$$typeof){case e:case r:Pe=!0}}if(Pe)return Pe=G,ce=ce(Pe),G=xe===""?"."+j(Pe,0):xe,A(ce)?(Q="",G!=null&&(Q=G.replace(X,"$&/")+"/"),B(ce,V,Q,"",function(je){return je})):ce!=null&&(O(ce)&&(ce=I(ce,Q+(!ce.key||Pe&&Pe.key===ce.key?"":(""+ce.key).replace(X,"$&/")+"/")+G)),V.push(ce)),1;if(Pe=0,xe=xe===""?".":xe+":",A(G))for(var Fe=0;Fe<G.length;Fe++){Ne=G[Fe];var Me=xe+j(Ne,Fe);Pe+=B(Ne,V,Q,Me,ce)}else if(Me=M(G),typeof Me=="function")for(G=Me.call(G),Fe=0;!(Ne=G.next()).done;)Ne=Ne.value,Me=xe+j(Ne,Fe++),Pe+=B(Ne,V,Q,Me,ce);else if(Ne==="object")throw V=String(G),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.");return Pe}function $(G,V,Q){if(G==null)return G;var xe=[],ce=0;return B(G,xe,"","",function(Ne){return V.call(Q,Ne,ce++)}),xe}function H(G){if(G._status===-1){var V=G._result;V=V(),V.then(function(Q){(G._status===0||G._status===-1)&&(G._status=1,G._result=Q)},function(Q){(G._status===0||G._status===-1)&&(G._status=2,G._result=Q)}),G._status===-1&&(G._status=0,G._result=V)}if(G._status===1)return G._result.default;throw G._result}var q={current:null},W={transition:null},Y={ReactCurrentDispatcher:q,ReactCurrentBatchConfig:W,ReactCurrentOwner:y};return react_production_min.Children={map:$,forEach:function(G,V,Q){$(G,function(){V.apply(this,arguments)},Q)},count:function(G){var V=0;return $(G,function(){V++}),V},toArray:function(G){return $(G,function(V){return V})||[]},only:function(G){if(!O(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},react_production_min.Component=s,react_production_min.Fragment=t,react_production_min.Profiler=c,react_production_min.PureComponent=w,react_production_min.StrictMode=a,react_production_min.Suspense=g,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y,react_production_min.cloneElement=function(G,V,Q){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var xe=z({},G.props),ce=G.key,Ne=G.ref,Pe=G._owner;if(V!=null){if(V.ref!==void 0&&(Ne=V.ref,Pe=y.current),V.key!==void 0&&(ce=""+V.key),G.type&&G.type.defaultProps)var Fe=G.type.defaultProps;for(Me in V)u.call(V,Me)&&!C.hasOwnProperty(Me)&&(xe[Me]=V[Me]===void 0&&Fe!==void 0?Fe[Me]:V[Me])}var Me=arguments.length-2;if(Me===1)xe.children=Q;else if(1<Me){Fe=Array(Me);for(var je=0;je<Me;je++)Fe[je]=arguments[je+2];xe.children=Fe}return{$$typeof:e,type:G.type,key:ce,ref:Ne,props:xe,_owner:Pe}},react_production_min.createContext=function(G){return G={$$typeof:_,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:h,_context:G},G.Consumer=G},react_production_min.createElement=k,react_production_min.createFactory=function(G){var V=k.bind(null,G);return V.type=G,V},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(G){return{$$typeof:f,render:G}},react_production_min.isValidElement=O,react_production_min.lazy=function(G){return{$$typeof:p,_payload:{_status:-1,_result:G},_init:H}},react_production_min.memo=function(G,V){return{$$typeof:b,type:G,compare:V===void 0?null:V}},react_production_min.startTransition=function(G){var V=W.transition;W.transition={};try{G()}finally{W.transition=V}},react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},react_production_min.useCallback=function(G,V){return q.current.useCallback(G,V)},react_production_min.useContext=function(G){return q.current.useContext(G)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(G){return q.current.useDeferredValue(G)},react_production_min.useEffect=function(G,V){return q.current.useEffect(G,V)},react_production_min.useId=function(){return q.current.useId()},react_production_min.useImperativeHandle=function(G,V,Q){return q.current.useImperativeHandle(G,V,Q)},react_production_min.useInsertionEffect=function(G,V){return q.current.useInsertionEffect(G,V)},react_production_min.useLayoutEffect=function(G,V){return q.current.useLayoutEffect(G,V)},react_production_min.useMemo=function(G,V){return q.current.useMemo(G,V)},react_production_min.useReducer=function(G,V,Q){return q.current.useReducer(G,V,Q)},react_production_min.useRef=function(G){return q.current.useRef(G)},react_production_min.useState=function(G){return q.current.useState(G)},react_production_min.useSyncExternalStore=function(G,V,Q){return q.current.useSyncExternalStore(G,V,Q)},react_production_min.useTransition=function(){return q.current.useTransition()},react_production_min.version="18.2.0",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min$1;function requireReactJsxRuntime_production_min$1(){if(hasRequiredReactJsxRuntime_production_min$1)return reactJsxRuntime_production_min$1;hasRequiredReactJsxRuntime_production_min$1=1;var e=requireReact(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h={key:!0,ref:!0,__self:!0,__source:!0};function _(f,g,b){var p,E={},M=null,R=null;b!==void 0&&(M=""+b),g.key!==void 0&&(M=""+g.key),g.ref!==void 0&&(R=g.ref);for(p in g)a.call(g,p)&&!h.hasOwnProperty(p)&&(E[p]=g[p]);if(f&&f.defaultProps)for(p in g=f.defaultProps,g)E[p]===void 0&&(E[p]=g[p]);return{$$typeof:r,type:f,key:M,ref:R,props:E,_owner:c.current}}return reactJsxRuntime_production_min$1.Fragment=t,reactJsxRuntime_production_min$1.jsx=_,reactJsxRuntime_production_min$1.jsxs=_,reactJsxRuntime_production_min$1}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime$1.exports=requireReactJsxRuntime_production_min$1()),jsxRuntime$1.exports}var jsxRuntimeExports$1=requireJsxRuntime(),reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(e){function r(W,Y){var G=W.length;W.push(Y);e:for(;0<G;){var V=G-1>>>1,Q=W[V];if(0<c(Q,Y))W[V]=Y,W[G]=Q,G=V;else break e}}function t(W){return W.length===0?null:W[0]}function a(W){if(W.length===0)return null;var Y=W[0],G=W.pop();if(G!==Y){W[0]=G;e:for(var V=0,Q=W.length,xe=Q>>>1;V<xe;){var ce=2*(V+1)-1,Ne=W[ce],Pe=ce+1,Fe=W[Pe];if(0>c(Ne,G))Pe<Q&&0>c(Fe,Ne)?(W[V]=Fe,W[Pe]=G,V=Pe):(W[V]=Ne,W[ce]=G,V=ce);else if(Pe<Q&&0>c(Fe,G))W[V]=Fe,W[Pe]=G,V=Pe;else break e}}return Y}function c(W,Y){var G=W.sortIndex-Y.sortIndex;return G!==0?G:W.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;e.unstable_now=function(){return h.now()}}else{var _=Date,f=_.now();e.unstable_now=function(){return _.now()-f}}var g=[],b=[],p=1,E=null,M=3,R=!1,z=!1,l=!1,s=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var Y=t(b);Y!==null;){if(Y.callback===null)a(b);else if(Y.startTime<=W)a(b),Y.sortIndex=Y.expirationTime,r(g,Y);else break;Y=t(b)}}function A(W){if(l=!1,S(W),!z)if(t(g)!==null)z=!0,H(u);else{var Y=t(b);Y!==null&&q(A,Y.startTime-W)}}function u(W,Y){z=!1,l&&(l=!1,v(k),k=-1),R=!0;var G=M;try{for(S(Y),E=t(g);E!==null&&(!(E.expirationTime>Y)||W&&!D());){var V=E.callback;if(typeof V=="function"){E.callback=null,M=E.priorityLevel;var Q=V(E.expirationTime<=Y);Y=e.unstable_now(),typeof Q=="function"?E.callback=Q:E===t(g)&&a(g),S(Y)}else a(g);E=t(g)}if(E!==null)var xe=!0;else{var ce=t(b);ce!==null&&q(A,ce.startTime-Y),xe=!1}return xe}finally{E=null,M=G,R=!1}}var y=!1,C=null,k=-1,I=5,O=-1;function D(){return!(e.unstable_now()-O<I)}function X(){if(C!==null){var W=e.unstable_now();O=W;var Y=!0;try{Y=C(!0,W)}finally{Y?j():(y=!1,C=null)}}else y=!1}var j;if(typeof w=="function")j=function(){w(X)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,$=B.port2;B.port1.onmessage=X,j=function(){$.postMessage(null)}}else j=function(){s(X,0)};function H(W){C=W,y||(y=!0,j())}function q(W,Y){k=s(function(){W(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){z||R||(z=!0,H(u))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return M},e.unstable_getFirstCallbackNode=function(){return t(g)},e.unstable_next=function(W){switch(M){case 1:case 2:case 3:var Y=3;break;default:Y=M}var G=M;M=Y;try{return W()}finally{M=G}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,Y){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var G=M;M=W;try{return Y()}finally{M=G}},e.unstable_scheduleCallback=function(W,Y,G){var V=e.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?V+G:V):G=V,W){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=G+Q,W={id:p++,callback:Y,priorityLevel:W,startTime:G,expirationTime:Q,sortIndex:-1},G>V?(W.sortIndex=G,r(b,W),t(g)===null&&W===t(b)&&(l?(v(k),k=-1):l=!0,q(A,G-V))):(W.sortIndex=Q,r(g,W),z||R||(z=!0,H(u))),W},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(W){var Y=M;return function(){var G=M;M=Y;try{return W.apply(this,arguments)}finally{M=G}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var e=requireReact(),r=requireScheduler();function t(n){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+n,x=1;x<arguments.length;x++)o+="&args[]="+encodeURIComponent(arguments[x]);return"Minified React error #"+n+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,c={};function h(n,o){_(n,o),_(n+"Capture",o)}function _(n,o){for(c[n]=o,n=0;n<o.length;n++)a.add(o[n])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),g=Object.prototype.hasOwnProperty,b=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},E={};function M(n){return g.call(E,n)?!0:g.call(p,n)?!1:b.test(n)?E[n]=!0:(p[n]=!0,!1)}function R(n,o,x,F){if(x!==null&&x.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return F?!1:x!==null?!x.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function z(n,o,x,F){if(o===null||typeof o>"u"||R(n,o,x,F))return!0;if(F)return!1;if(x!==null)switch(x.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function l(n,o,x,F,U,J,oe){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=F,this.attributeNamespace=U,this.mustUseProperty=x,this.propertyName=n,this.type=o,this.sanitizeURL=J,this.removeEmptyString=oe}var s={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){s[n]=new l(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var o=n[0];s[o]=new l(o,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){s[n]=new l(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){s[n]=new l(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){s[n]=new l(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){s[n]=new l(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){s[n]=new l(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){s[n]=new l(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){s[n]=new l(n,5,!1,n.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function w(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var o=n.replace(v,w);s[o]=new l(o,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var o=n.replace(v,w);s[o]=new l(o,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var o=n.replace(v,w);s[o]=new l(o,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){s[n]=new l(n,1,!1,n.toLowerCase(),null,!1,!1)}),s.xlinkHref=new l("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){s[n]=new l(n,1,!1,n.toLowerCase(),null,!0,!0)});function S(n,o,x,F){var U=s.hasOwnProperty(o)?s[o]:null;(U!==null?U.type!==0:F||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(z(o,x,U,F)&&(x=null),F||U===null?M(o)&&(x===null?n.removeAttribute(o):n.setAttribute(o,""+x)):U.mustUseProperty?n[U.propertyName]=x===null?U.type===3?!1:"":x:(o=U.attributeName,F=U.attributeNamespace,x===null?n.removeAttribute(o):(U=U.type,x=U===3||U===4&&x===!0?"":""+x,F?n.setAttributeNS(F,o,x):n.setAttribute(o,x))))}var A=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),y=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),D=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),$=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),q=Symbol.for("react.offscreen"),W=Symbol.iterator;function Y(n){return n===null||typeof n!="object"?null:(n=W&&n[W]||n["@@iterator"],typeof n=="function"?n:null)}var G=Object.assign,V;function Q(n){if(V===void 0)try{throw Error()}catch(x){var o=x.stack.trim().match(/\n( *(at )?)/);V=o&&o[1]||""}return`
`+V+n}var xe=!1;function ce(n,o){if(!n||xe)return"";xe=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Vt){var F=Vt}Reflect.construct(n,[],o)}else{try{o.call()}catch(Vt){F=Vt}n.call(o.prototype)}else{try{throw Error()}catch(Vt){F=Vt}n()}}catch(Vt){if(Vt&&F&&typeof Vt.stack=="string"){for(var U=Vt.stack.split(`
`),J=F.stack.split(`
`),oe=U.length-1,Be=J.length-1;1<=oe&&0<=Be&&U[oe]!==J[Be];)Be--;for(;1<=oe&&0<=Be;oe--,Be--)if(U[oe]!==J[Be]){if(oe!==1||Be!==1)do if(oe--,Be--,0>Be||U[oe]!==J[Be]){var st=`
`+U[oe].replace(" at new "," at ");return n.displayName&&st.includes("<anonymous>")&&(st=st.replace("<anonymous>",n.displayName)),st}while(1<=oe&&0<=Be);break}}}finally{xe=!1,Error.prepareStackTrace=x}return(n=n?n.displayName||n.name:"")?Q(n):""}function Ne(n){switch(n.tag){case 5:return Q(n.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return n=ce(n.type,!1),n;case 11:return n=ce(n.type.render,!1),n;case 1:return n=ce(n.type,!0),n;default:return""}}function Pe(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case C:return"Fragment";case y:return"Portal";case I:return"Profiler";case k:return"StrictMode";case j:return"Suspense";case B:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case D:return(n.displayName||"Context")+".Consumer";case O:return(n._context.displayName||"Context")+".Provider";case X:var o=n.render;return n=n.displayName,n||(n=o.displayName||o.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case $:return o=n.displayName||null,o!==null?o:Pe(n.type)||"Memo";case H:o=n._payload,n=n._init;try{return Pe(n(o))}catch{}}return null}function Fe(n){var o=n.type;switch(n.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=o.render,n=n.displayName||n.name||"",o.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pe(o);case 8:return o===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Me(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function je(n){var o=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ft(n){var o=je(n)?"checked":"value",x=Object.getOwnPropertyDescriptor(n.constructor.prototype,o),F=""+n[o];if(!n.hasOwnProperty(o)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var U=x.get,J=x.set;return Object.defineProperty(n,o,{configurable:!0,get:function(){return U.call(this)},set:function(oe){F=""+oe,J.call(this,oe)}}),Object.defineProperty(n,o,{enumerable:x.enumerable}),{getValue:function(){return F},setValue:function(oe){F=""+oe},stopTracking:function(){n._valueTracker=null,delete n[o]}}}}function jt(n){n._valueTracker||(n._valueTracker=ft(n))}function Gt(n){if(!n)return!1;var o=n._valueTracker;if(!o)return!0;var x=o.getValue(),F="";return n&&(F=je(n)?n.checked?"true":"false":n.value),n=F,n!==x?(o.setValue(n),!0):!1}function mt(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Le(n,o){var x=o.checked;return G({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:x??n._wrapperState.initialChecked})}function ht(n,o){var x=o.defaultValue==null?"":o.defaultValue,F=o.checked!=null?o.checked:o.defaultChecked;x=Me(o.value!=null?o.value:x),n._wrapperState={initialChecked:F,initialValue:x,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ar(n,o){o=o.checked,o!=null&&S(n,"checked",o,!1)}function Jt(n,o){ar(n,o);var x=Me(o.value),F=o.type;if(x!=null)F==="number"?(x===0&&n.value===""||n.value!=x)&&(n.value=""+x):n.value!==""+x&&(n.value=""+x);else if(F==="submit"||F==="reset"){n.removeAttribute("value");return}o.hasOwnProperty("value")?Gr(n,o.type,x):o.hasOwnProperty("defaultValue")&&Gr(n,o.type,Me(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(n.defaultChecked=!!o.defaultChecked)}function Wt(n,o,x){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var F=o.type;if(!(F!=="submit"&&F!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+n._wrapperState.initialValue,x||o===n.value||(n.value=o),n.defaultValue=o}x=n.name,x!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,x!==""&&(n.name=x)}function Gr(n,o,x){(o!=="number"||mt(n.ownerDocument)!==n)&&(x==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+x&&(n.defaultValue=""+x))}var Lr=Array.isArray;function zr(n,o,x,F){if(n=n.options,o){o={};for(var U=0;U<x.length;U++)o["$"+x[U]]=!0;for(x=0;x<n.length;x++)U=o.hasOwnProperty("$"+n[x].value),n[x].selected!==U&&(n[x].selected=U),U&&F&&(n[x].defaultSelected=!0)}else{for(x=""+Me(x),o=null,U=0;U<n.length;U++){if(n[U].value===x){n[U].selected=!0,F&&(n[U].defaultSelected=!0);return}o!==null||n[U].disabled||(o=n[U])}o!==null&&(o.selected=!0)}}function Nr(n,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return G({},o,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function At(n,o){var x=o.value;if(x==null){if(x=o.children,o=o.defaultValue,x!=null){if(o!=null)throw Error(t(92));if(Lr(x)){if(1<x.length)throw Error(t(93));x=x[0]}o=x}o==null&&(o=""),x=o}n._wrapperState={initialValue:Me(x)}}function Mt(n,o){var x=Me(o.value),F=Me(o.defaultValue);x!=null&&(x=""+x,x!==n.value&&(n.value=x),o.defaultValue==null&&n.defaultValue!==x&&(n.defaultValue=x)),F!=null&&(n.defaultValue=""+F)}function Jr(n){var o=n.textContent;o===n._wrapperState.initialValue&&o!==""&&o!==null&&(n.value=o)}function qr(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ie(n,o){return n==null||n==="http://www.w3.org/1999/xhtml"?qr(o):n==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var ve,we=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,x,F,U){MSApp.execUnsafeLocalFunction(function(){return n(o,x,F,U)})}:n})(function(n,o){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=o;else{for(ve=ve||document.createElement("div"),ve.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=ve.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;o.firstChild;)n.appendChild(o.firstChild)}});function it(n,o){if(o){var x=n.firstChild;if(x&&x===n.lastChild&&x.nodeType===3){x.nodeValue=o;return}}n.textContent=o}var rt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Yt=["Webkit","ms","Moz","O"];Object.keys(rt).forEach(function(n){Yt.forEach(function(o){o=o+n.charAt(0).toUpperCase()+n.substring(1),rt[o]=rt[n]})});function Ot(n,o,x){return o==null||typeof o=="boolean"||o===""?"":x||typeof o!="number"||o===0||rt.hasOwnProperty(n)&&rt[n]?(""+o).trim():o+"px"}function re(n,o){n=n.style;for(var x in o)if(o.hasOwnProperty(x)){var F=x.indexOf("--")===0,U=Ot(x,o[x],F);x==="float"&&(x="cssFloat"),F?n.setProperty(x,U):n[x]=U}}var tt=G({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lt(n,o){if(o){if(tt[n]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,n));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function cr(n,o){if(n.indexOf("-")===-1)return typeof o.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var et=null;function Ft(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var se=null,_t=null,Wr=null;function Z(n){if(n=yc(n)){if(typeof se!="function")throw Error(t(280));var o=n.stateNode;o&&(o=ru(o),se(n.stateNode,n.type,o))}}function ut(n){_t?Wr?Wr.push(n):Wr=[n]:_t=n}function at(){if(_t){var n=_t,o=Wr;if(Wr=_t=null,Z(n),o)for(n=0;n<o.length;n++)Z(o[n])}}function me(n,o){return n(o)}function Ze(){}var vt=!1;function Qr(n,o,x){if(vt)return n(o,x);vt=!0;try{return me(n,o,x)}finally{vt=!1,(_t!==null||Wr!==null)&&(Ze(),at())}}function Zr(n,o){var x=n.stateNode;if(x===null)return null;var F=ru(x);if(F===null)return null;x=F[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(F=!F.disabled)||(n=n.type,F=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!F;break e;default:n=!1}if(n)return null;if(x&&typeof x!="function")throw Error(t(231,o,typeof x));return x}var Kr=!1;if(f)try{var bn={};Object.defineProperty(bn,"passive",{get:function(){Kr=!0}}),window.addEventListener("test",bn,bn),window.removeEventListener("test",bn,bn)}catch{Kr=!1}function ls(n,o,x,F,U,J,oe,Be,st){var Vt=Array.prototype.slice.call(arguments,3);try{o.apply(x,Vt)}catch(Vr){this.onError(Vr)}}var Pn=!1,On=null,Dn=!1,gi=null,Ei={onError:function(n){Pn=!0,On=n}};function Aa(n,o,x,F,U,J,oe,Be,st){Pn=!1,On=null,ls.apply(Ei,arguments)}function Ta(n,o,x,F,U,J,oe,Be,st){if(Aa.apply(this,arguments),Pn){if(Pn){var Vt=On;Pn=!1,On=null}else throw Error(t(198));Dn||(Dn=!0,gi=Vt)}}function ti(n){var o=n,x=n;if(n.alternate)for(;o.return;)o=o.return;else{n=o;do o=n,(o.flags&4098)!==0&&(x=o.return),n=o.return;while(n)}return o.tag===3?x:null}function li(n){if(n.tag===13){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function ui(n){if(ti(n)!==n)throw Error(t(188))}function Js(n){var o=n.alternate;if(!o){if(o=ti(n),o===null)throw Error(t(188));return o!==n?null:n}for(var x=n,F=o;;){var U=x.return;if(U===null)break;var J=U.alternate;if(J===null){if(F=U.return,F!==null){x=F;continue}break}if(U.child===J.child){for(J=U.child;J;){if(J===x)return ui(U),n;if(J===F)return ui(U),o;J=J.sibling}throw Error(t(188))}if(x.return!==F.return)x=U,F=J;else{for(var oe=!1,Be=U.child;Be;){if(Be===x){oe=!0,x=U,F=J;break}if(Be===F){oe=!0,F=U,x=J;break}Be=Be.sibling}if(!oe){for(Be=J.child;Be;){if(Be===x){oe=!0,x=J,F=U;break}if(Be===F){oe=!0,F=J,x=U;break}Be=Be.sibling}if(!oe)throw Error(t(189))}}if(x.alternate!==F)throw Error(t(190))}if(x.tag!==3)throw Error(t(188));return x.stateNode.current===x?n:o}function Vs(n){return n=Js(n),n!==null?pa(n):null}function pa(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var o=pa(n);if(o!==null)return o;n=n.sibling}return null}var cl=r.unstable_scheduleCallback,ul=r.unstable_cancelCallback,dl=r.unstable_shouldYield,qa=r.unstable_requestPaint,fi=r.unstable_now,hl=r.unstable_getCurrentPriorityLevel,ja=r.unstable_ImmediatePriority,kc=r.unstable_UserBlockingPriority,Bn=r.unstable_NormalPriority,Ra=r.unstable_LowPriority,ma=r.unstable_IdlePriority,Ml=null,Hs=null;function fl(n){if(Hs&&typeof Hs.onCommitFiberRoot=="function")try{Hs.onCommitFiberRoot(Ml,n,void 0,(n.current.flags&128)===128)}catch{}}var ga=Math.clz32?Math.clz32:vu,mu=Math.log,gu=Math.LN2;function vu(n){return n>>>=0,n===0?32:31-(mu(n)/gu|0)|0}var Na=64,Xa=4194304;function Ls(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ga(n,o){var x=n.pendingLanes;if(x===0)return 0;var F=0,U=n.suspendedLanes,J=n.pingedLanes,oe=x&268435455;if(oe!==0){var Be=oe&~U;Be!==0?F=Ls(Be):(J&=oe,J!==0&&(F=Ls(J)))}else oe=x&~U,oe!==0?F=Ls(oe):J!==0&&(F=Ls(J));if(F===0)return 0;if(o!==0&&o!==F&&(o&U)===0&&(U=F&-F,J=o&-o,U>=J||U===16&&(J&4194240)!==0))return o;if((F&4)!==0&&(F|=x&16),o=n.entangledLanes,o!==0)for(n=n.entanglements,o&=F;0<o;)x=31-ga(o),U=1<<x,F|=n[x],o&=~U;return F}function pl(n,o){switch(n){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zl(n,o){for(var x=n.suspendedLanes,F=n.pingedLanes,U=n.expirationTimes,J=n.pendingLanes;0<J;){var oe=31-ga(J),Be=1<<oe,st=U[oe];st===-1?((Be&x)===0||(Be&F)!==0)&&(U[oe]=pl(Be,o)):st<=o&&(n.expiredLanes|=Be),J&=~Be}}function yu(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Za(){var n=Na;return Na<<=1,(Na&4194240)===0&&(Na=64),n}function Mc(n){for(var o=[],x=0;31>x;x++)o.push(n);return o}function ba(n,o,x){n.pendingLanes|=o,o!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,o=31-ga(o),n[o]=x}function wh(n,o){var x=n.pendingLanes&~o;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=o,n.mutableReadLanes&=o,n.entangledLanes&=o,o=n.entanglements;var F=n.eventTimes;for(n=n.expirationTimes;0<x;){var U=31-ga(x),J=1<<U;o[U]=0,F[U]=-1,n[U]=-1,x&=~J}}function Pa(n,o){var x=n.entangledLanes|=o;for(n=n.entanglements;x;){var F=31-ga(x),U=1<<F;U&o|n[F]&o&&(n[F]|=o),x&=~U}}var Fn=0;function aa(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var si,ml,zc,_u,gl,Nc=!1,Nl=[],va=null,Ja=null,Qa=null,la=new Map,Ua=new Map,Ka=[],Sh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pl(n,o){switch(n){case"focusin":case"focusout":va=null;break;case"dragenter":case"dragleave":Ja=null;break;case"mouseover":case"mouseout":Qa=null;break;case"pointerover":case"pointerout":la.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ua.delete(o.pointerId)}}function Il(n,o,x,F,U,J){return n===null||n.nativeEvent!==J?(n={blockedOn:o,domEventName:x,eventSystemFlags:F,nativeEvent:J,targetContainers:[U]},o!==null&&(o=yc(o),o!==null&&ml(o)),n):(n.eventSystemFlags|=F,o=n.targetContainers,U!==null&&o.indexOf(U)===-1&&o.push(U),n)}function pd(n,o,x,F,U){switch(o){case"focusin":return va=Il(va,n,o,x,F,U),!0;case"dragenter":return Ja=Il(Ja,n,o,x,F,U),!0;case"mouseover":return Qa=Il(Qa,n,o,x,F,U),!0;case"pointerover":var J=U.pointerId;return la.set(J,Il(la.get(J)||null,n,o,x,F,U)),!0;case"gotpointercapture":return J=U.pointerId,Ua.set(J,Il(Ua.get(J)||null,n,o,x,F,U)),!0}return!1}function md(n){var o=El(n.target);if(o!==null){var x=ti(o);if(x!==null){if(o=x.tag,o===13){if(o=li(x),o!==null){n.blockedOn=o,gl(n.priority,function(){zc(x)});return}}else if(o===3&&x.stateNode.current.memoizedState.isDehydrated){n.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}n.blockedOn=null}function nc(n){if(n.blockedOn!==null)return!1;for(var o=n.targetContainers;0<o.length;){var x=bu(n.domEventName,n.eventSystemFlags,o[0],n.nativeEvent);if(x===null){x=n.nativeEvent;var F=new x.constructor(x.type,x);et=F,x.target.dispatchEvent(F),et=null}else return o=yc(x),o!==null&&ml(o),n.blockedOn=x,!1;o.shift()}return!0}function gd(n,o,x){nc(n)&&x.delete(o)}function Eh(){Nc=!1,va!==null&&nc(va)&&(va=null),Ja!==null&&nc(Ja)&&(Ja=null),Qa!==null&&nc(Qa)&&(Qa=null),la.forEach(gd),Ua.forEach(gd)}function ic(n,o){n.blockedOn===o&&(n.blockedOn=null,Nc||(Nc=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Eh)))}function sc(n){function o(U){return ic(U,n)}if(0<Nl.length){ic(Nl[0],n);for(var x=1;x<Nl.length;x++){var F=Nl[x];F.blockedOn===n&&(F.blockedOn=null)}}for(va!==null&&ic(va,n),Ja!==null&&ic(Ja,n),Qa!==null&&ic(Qa,n),la.forEach(o),Ua.forEach(o),x=0;x<Ka.length;x++)F=Ka[x],F.blockedOn===n&&(F.blockedOn=null);for(;0<Ka.length&&(x=Ka[0],x.blockedOn===null);)md(x),x.blockedOn===null&&Ka.shift()}var Ol=A.ReactCurrentBatchConfig,Pc=!0;function Ch(n,o,x,F){var U=Fn,J=Ol.transition;Ol.transition=null;try{Fn=1,xu(n,o,x,F)}finally{Fn=U,Ol.transition=J}}function Ah(n,o,x,F){var U=Fn,J=Ol.transition;Ol.transition=null;try{Fn=4,xu(n,o,x,F)}finally{Fn=U,Ol.transition=J}}function xu(n,o,x,F){if(Pc){var U=bu(n,o,x,F);if(U===null)Wu(n,o,F,Ic,x),Pl(n,F);else if(pd(U,n,o,x,F))F.stopPropagation();else if(Pl(n,F),o&4&&-1<Sh.indexOf(n)){for(;U!==null;){var J=yc(U);if(J!==null&&si(J),J=bu(n,o,x,F),J===null&&Wu(n,o,F,Ic,x),J===U)break;U=J}U!==null&&F.stopPropagation()}else Wu(n,o,F,null,x)}}var Ic=null;function bu(n,o,x,F){if(Ic=null,n=Ft(F),n=El(n),n!==null)if(o=ti(n),o===null)n=null;else if(x=o.tag,x===13){if(n=li(o),n!==null)return n;n=null}else if(x===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;n=null}else o!==n&&(n=null);return Ic=n,null}function vd(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hl()){case ja:return 1;case kc:return 4;case Bn:case Ra:return 16;case ma:return 536870912;default:return 16}default:return 16}}var el=null,vl=null,Oc=null;function yd(){if(Oc)return Oc;var n,o=vl,x=o.length,F,U="value"in el?el.value:el.textContent,J=U.length;for(n=0;n<x&&o[n]===U[n];n++);var oe=x-n;for(F=1;F<=oe&&o[x-F]===U[J-F];F++);return Oc=U.slice(n,1<F?1-F:void 0)}function Fc(n){var o=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&o===13&&(n=13)):n=o,n===10&&(n=13),32<=n||n===13?n:0}function yl(){return!0}function wu(){return!1}function $s(n){function o(x,F,U,J,oe){this._reactName=x,this._targetInst=U,this.type=F,this.nativeEvent=J,this.target=oe,this.currentTarget=null;for(var Be in n)n.hasOwnProperty(Be)&&(x=n[Be],this[Be]=x?x(J):J[Be]);return this.isDefaultPrevented=(J.defaultPrevented!=null?J.defaultPrevented:J.returnValue===!1)?yl:wu,this.isPropagationStopped=wu,this}return G(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=yl)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=yl)},persist:function(){},isPersistent:yl}),o}var Fl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Su=$s(Fl),oc=G({},Fl,{view:0,detail:0}),Th=$s(oc),_l,Eu,Ll,ac=G({},oc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cu,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ll&&(Ll&&n.type==="mousemove"?(_l=n.screenX-Ll.screenX,Eu=n.screenY-Ll.screenY):Eu=_l=0,Ll=n),_l)},movementY:function(n){return"movementY"in n?n.movementY:Eu}}),_d=$s(ac),Rh=G({},ac,{dataTransfer:0}),kh=$s(Rh),Mh=G({},oc,{relatedTarget:0}),Dl=$s(Mh),zh=G({},Fl,{animationName:0,elapsedTime:0,pseudoElement:0}),Nh=$s(zh),Ph=G({},Fl,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ih=$s(Ph),lc=G({},Fl,{data:0}),Lc=$s(lc),Oh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Dh(n){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(n):(n=Lh[n])?!!o[n]:!1}function Cu(){return Dh}var Bh=G({},oc,{key:function(n){if(n.key){var o=Oh[n.key]||n.key;if(o!=="Unidentified")return o}return n.type==="keypress"?(n=Fc(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Fh[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cu,charCode:function(n){return n.type==="keypress"?Fc(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Fc(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),jh=$s(Bh),Dc=G({},ac,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xd=$s(Dc),Gh=G({},oc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cu}),Bl=$s(Gh),bd=G({},Fl,{propertyName:0,elapsedTime:0,pseudoElement:0}),wd=$s(bd),Sd=G({},ac,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Tu=$s(Sd),Ed=[9,13,27,32],Ru=f&&"CompositionEvent"in window,uc=null;f&&"documentMode"in document&&(uc=document.documentMode);var Uh=f&&"TextEvent"in window&&!uc,Cd=f&&(!Ru||uc&&8<uc&&11>=uc),jl=" ",Ad=!1;function ku(n,o){switch(n){case"keyup":return Ed.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mu(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var xl=!1;function Vh(n,o){switch(n){case"compositionend":return Mu(o);case"keypress":return o.which!==32?null:(Ad=!0,jl);case"textInput":return n=o.data,n===jl&&Ad?null:n;default:return null}}function Bc(n,o){if(xl)return n==="compositionend"||!Ru&&ku(n,o)?(n=yd(),Oc=vl=el=null,xl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Cd&&o.locale!=="ko"?null:o.data;default:return null}}var bl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Td(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o==="input"?!!bl[n.type]:o==="textarea"}function Rd(n,o,x,F){ut(F),o=Qc(o,"onChange"),0<o.length&&(x=new Su("onChange","change",null,x,F),n.push({event:x,listeners:o}))}var na=null,Gl=null;function kd(n){Jc(n,0)}function jc(n){var o=$l(n);if(Gt(o))return n}function Md(n,o){if(n==="change")return o}var dc=!1;if(f){var Gc;if(f){var Uc="oninput"in document;if(!Uc){var zu=document.createElement("div");zu.setAttribute("oninput","return;"),Uc=typeof zu.oninput=="function"}Gc=Uc}else Gc=!1;dc=Gc&&(!document.documentMode||9<document.documentMode)}function Nu(){na&&(na.detachEvent("onpropertychange",Pu),Gl=na=null)}function Pu(n){if(n.propertyName==="value"&&jc(Gl)){var o=[];Rd(o,Gl,n,Ft(n)),Qr(kd,o)}}function zd(n,o,x){n==="focusin"?(Nu(),na=o,Gl=x,na.attachEvent("onpropertychange",Pu)):n==="focusout"&&Nu()}function Nd(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return jc(Gl)}function Pd(n,o){if(n==="click")return jc(o)}function Id(n,o){if(n==="input"||n==="change")return jc(o)}function Vc(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var Gs=typeof Object.is=="function"?Object.is:Vc;function wl(n,o){if(Gs(n,o))return!0;if(typeof n!="object"||n===null||typeof o!="object"||o===null)return!1;var x=Object.keys(n),F=Object.keys(o);if(x.length!==F.length)return!1;for(F=0;F<x.length;F++){var U=x[F];if(!g.call(o,U)||!Gs(n[U],o[U]))return!1}return!0}function Iu(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Wc(n,o){var x=Iu(n);n=0;for(var F;x;){if(x.nodeType===3){if(F=n+x.textContent.length,n<=o&&F>=o)return{node:x,offset:o-n};n=F}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=Iu(x)}}function Ou(n,o){return n&&o?n===o?!0:n&&n.nodeType===3?!1:o&&o.nodeType===3?Ou(n,o.parentNode):"contains"in n?n.contains(o):n.compareDocumentPosition?!!(n.compareDocumentPosition(o)&16):!1:!1}function Fu(){for(var n=window,o=mt();o instanceof n.HTMLIFrameElement;){try{var x=typeof o.contentWindow.location.href=="string"}catch{x=!1}if(x)n=o.contentWindow;else break;o=mt(n.document)}return o}function Hc(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o&&(o==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||o==="textarea"||n.contentEditable==="true")}function Od(n){var o=Fu(),x=n.focusedElem,F=n.selectionRange;if(o!==x&&x&&x.ownerDocument&&Ou(x.ownerDocument.documentElement,x)){if(F!==null&&Hc(x)){if(o=F.start,n=F.end,n===void 0&&(n=o),"selectionStart"in x)x.selectionStart=o,x.selectionEnd=Math.min(n,x.value.length);else if(n=(o=x.ownerDocument||document)&&o.defaultView||window,n.getSelection){n=n.getSelection();var U=x.textContent.length,J=Math.min(F.start,U);F=F.end===void 0?J:Math.min(F.end,U),!n.extend&&J>F&&(U=F,F=J,J=U),U=Wc(x,J);var oe=Wc(x,F);U&&oe&&(n.rangeCount!==1||n.anchorNode!==U.node||n.anchorOffset!==U.offset||n.focusNode!==oe.node||n.focusOffset!==oe.offset)&&(o=o.createRange(),o.setStart(U.node,U.offset),n.removeAllRanges(),J>F?(n.addRange(o),n.extend(oe.node,oe.offset)):(o.setEnd(oe.node,oe.offset),n.addRange(o)))}}for(o=[],n=x;n=n.parentNode;)n.nodeType===1&&o.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<o.length;x++)n=o[x],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var $c=f&&"documentMode"in document&&11>=document.documentMode,Va=null,Yc=null,Ul=null,qc=!1;function Lu(n,o,x){var F=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;qc||Va==null||Va!==mt(F)||(F=Va,"selectionStart"in F&&Hc(F)?F={start:F.selectionStart,end:F.selectionEnd}:(F=(F.ownerDocument&&F.ownerDocument.defaultView||window).getSelection(),F={anchorNode:F.anchorNode,anchorOffset:F.anchorOffset,focusNode:F.focusNode,focusOffset:F.focusOffset}),Ul&&wl(Ul,F)||(Ul=F,F=Qc(Yc,"onSelect"),0<F.length&&(o=new Su("onSelect","select",null,o,x),n.push({event:o,listeners:F}),o.target=Va)))}function hc(n,o){var x={};return x[n.toLowerCase()]=o.toLowerCase(),x["Webkit"+n]="webkit"+o,x["Moz"+n]="moz"+o,x}var tl={animationend:hc("Animation","AnimationEnd"),animationiteration:hc("Animation","AnimationIteration"),animationstart:hc("Animation","AnimationStart"),transitionend:hc("Transition","TransitionEnd")},Xc={},Du={};f&&(Du=document.createElement("div").style,"AnimationEvent"in window||(delete tl.animationend.animation,delete tl.animationiteration.animation,delete tl.animationstart.animation),"TransitionEvent"in window||delete tl.transitionend.transition);function di(n){if(Xc[n])return Xc[n];if(!tl[n])return n;var o=tl[n],x;for(x in o)if(o.hasOwnProperty(x)&&x in Du)return Xc[n]=o[x];return n}var Bu=di("animationend"),ju=di("animationiteration"),Fd=di("animationstart"),Ld=di("transitionend"),Dd=new Map,Gu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rl(n,o){Dd.set(n,o),h(o,[n])}for(var Wa=0;Wa<Gu.length;Wa++){var Zc=Gu[Wa],Bd=Zc.toLowerCase(),jd=Zc[0].toUpperCase()+Zc.slice(1);rl(Bd,"on"+jd)}rl(Bu,"onAnimationEnd"),rl(ju,"onAnimationIteration"),rl(Fd,"onAnimationStart"),rl("dblclick","onDoubleClick"),rl("focusin","onFocus"),rl("focusout","onBlur"),rl(Ld,"onTransitionEnd"),_("onMouseEnter",["mouseout","mouseover"]),_("onMouseLeave",["mouseout","mouseover"]),_("onPointerEnter",["pointerout","pointerover"]),_("onPointerLeave",["pointerout","pointerover"]),h("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),h("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),h("onBeforeInput",["compositionend","keypress","textInput","paste"]),h("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),h("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),h("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wh=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vl));function Uu(n,o,x){var F=n.type||"unknown-event";n.currentTarget=x,Ta(F,o,void 0,n),n.currentTarget=null}function Jc(n,o){o=(o&4)!==0;for(var x=0;x<n.length;x++){var F=n[x],U=F.event;F=F.listeners;e:{var J=void 0;if(o)for(var oe=F.length-1;0<=oe;oe--){var Be=F[oe],st=Be.instance,Vt=Be.currentTarget;if(Be=Be.listener,st!==J&&U.isPropagationStopped())break e;Uu(U,Be,Vt),J=st}else for(oe=0;oe<F.length;oe++){if(Be=F[oe],st=Be.instance,Vt=Be.currentTarget,Be=Be.listener,st!==J&&U.isPropagationStopped())break e;Uu(U,Be,Vt),J=st}}}if(Dn)throw n=gi,Dn=!1,gi=null,n}function hi(n,o){var x=o[vc];x===void 0&&(x=o[vc]=new Set);var F=n+"__bubble";x.has(F)||(Gd(o,n,2,!1),x.add(F))}function Vu(n,o,x){var F=0;o&&(F|=4),Gd(x,n,F,o)}var fc="_reactListening"+Math.random().toString(36).slice(2);function pc(n){if(!n[fc]){n[fc]=!0,a.forEach(function(x){x!=="selectionchange"&&(Wh.has(x)||Vu(x,!1,n),Vu(x,!0,n))});var o=n.nodeType===9?n:n.ownerDocument;o===null||o[fc]||(o[fc]=!0,Vu("selectionchange",!1,o))}}function Gd(n,o,x,F){switch(vd(o)){case 1:var U=Ch;break;case 4:U=Ah;break;default:U=xu}x=U.bind(null,o,x,n),U=void 0,!Kr||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(U=!0),F?U!==void 0?n.addEventListener(o,x,{capture:!0,passive:U}):n.addEventListener(o,x,!0):U!==void 0?n.addEventListener(o,x,{passive:U}):n.addEventListener(o,x,!1)}function Wu(n,o,x,F,U){var J=F;if((o&1)===0&&(o&2)===0&&F!==null)e:for(;;){if(F===null)return;var oe=F.tag;if(oe===3||oe===4){var Be=F.stateNode.containerInfo;if(Be===U||Be.nodeType===8&&Be.parentNode===U)break;if(oe===4)for(oe=F.return;oe!==null;){var st=oe.tag;if((st===3||st===4)&&(st=oe.stateNode.containerInfo,st===U||st.nodeType===8&&st.parentNode===U))return;oe=oe.return}for(;Be!==null;){if(oe=El(Be),oe===null)return;if(st=oe.tag,st===5||st===6){F=J=oe;continue e}Be=Be.parentNode}}F=F.return}Qr(function(){var Vt=J,Vr=Ft(x),$r=[];e:{var Ur=Dd.get(n);if(Ur!==void 0){var on=Su,xn=n;switch(n){case"keypress":if(Fc(x)===0)break e;case"keydown":case"keyup":on=jh;break;case"focusin":xn="focus",on=Dl;break;case"focusout":xn="blur",on=Dl;break;case"beforeblur":case"afterblur":on=Dl;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":on=_d;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":on=kh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":on=Bl;break;case Bu:case ju:case Fd:on=Nh;break;case Ld:on=wd;break;case"scroll":on=Th;break;case"wheel":on=Tu;break;case"copy":case"cut":case"paste":on=Ih;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":on=xd}var wn=(o&4)!==0,Us=!wn&&n==="scroll",St=wn?Ur!==null?Ur+"Capture":null:Ur;wn=[];for(var ot=Vt,Tt;ot!==null;){Tt=ot;var Xr=Tt.stateNode;if(Tt.tag===5&&Xr!==null&&(Tt=Xr,St!==null&&(Xr=Zr(ot,St),Xr!=null&&wn.push(mc(ot,Xr,Tt)))),Us)break;ot=ot.return}0<wn.length&&(Ur=new on(Ur,xn,null,x,Vr),$r.push({event:Ur,listeners:wn}))}}if((o&7)===0){e:{if(Ur=n==="mouseover"||n==="pointerover",on=n==="mouseout"||n==="pointerout",Ur&&x!==et&&(xn=x.relatedTarget||x.fromElement)&&(El(xn)||xn[ya]))break e;if((on||Ur)&&(Ur=Vr.window===Vr?Vr:(Ur=Vr.ownerDocument)?Ur.defaultView||Ur.parentWindow:window,on?(xn=x.relatedTarget||x.toElement,on=Vt,xn=xn?El(xn):null,xn!==null&&(Us=ti(xn),xn!==Us||xn.tag!==5&&xn.tag!==6)&&(xn=null)):(on=null,xn=Vt),on!==xn)){if(wn=_d,Xr="onMouseLeave",St="onMouseEnter",ot="mouse",(n==="pointerout"||n==="pointerover")&&(wn=xd,Xr="onPointerLeave",St="onPointerEnter",ot="pointer"),Us=on==null?Ur:$l(on),Tt=xn==null?Ur:$l(xn),Ur=new wn(Xr,ot+"leave",on,x,Vr),Ur.target=Us,Ur.relatedTarget=Tt,Xr=null,El(Vr)===Vt&&(wn=new wn(St,ot+"enter",xn,x,Vr),wn.target=Tt,wn.relatedTarget=Us,Xr=wn),Us=Xr,on&&xn)t:{for(wn=on,St=xn,ot=0,Tt=wn;Tt;Tt=Wl(Tt))ot++;for(Tt=0,Xr=St;Xr;Xr=Wl(Xr))Tt++;for(;0<ot-Tt;)wn=Wl(wn),ot--;for(;0<Tt-ot;)St=Wl(St),Tt--;for(;ot--;){if(wn===St||St!==null&&wn===St.alternate)break t;wn=Wl(wn),St=Wl(St)}wn=null}else wn=null;on!==null&&Ud($r,Ur,on,wn,!1),xn!==null&&Us!==null&&Ud($r,Us,xn,wn,!0)}}e:{if(Ur=Vt?$l(Vt):window,on=Ur.nodeName&&Ur.nodeName.toLowerCase(),on==="select"||on==="input"&&Ur.type==="file")var En=Md;else if(Td(Ur))if(dc)En=Id;else{En=Nd;var kn=zd}else(on=Ur.nodeName)&&on.toLowerCase()==="input"&&(Ur.type==="checkbox"||Ur.type==="radio")&&(En=Pd);if(En&&(En=En(n,Vt))){Rd($r,En,x,Vr);break e}kn&&kn(n,Ur,Vt),n==="focusout"&&(kn=Ur._wrapperState)&&kn.controlled&&Ur.type==="number"&&Gr(Ur,"number",Ur.value)}switch(kn=Vt?$l(Vt):window,n){case"focusin":(Td(kn)||kn.contentEditable==="true")&&(Va=kn,Yc=Vt,Ul=null);break;case"focusout":Ul=Yc=Va=null;break;case"mousedown":qc=!0;break;case"contextmenu":case"mouseup":case"dragend":qc=!1,Lu($r,x,Vr);break;case"selectionchange":if($c)break;case"keydown":case"keyup":Lu($r,x,Vr)}var zn;if(Ru)e:{switch(n){case"compositionstart":var In="onCompositionStart";break e;case"compositionend":In="onCompositionEnd";break e;case"compositionupdate":In="onCompositionUpdate";break e}In=void 0}else xl?ku(n,x)&&(In="onCompositionEnd"):n==="keydown"&&x.keyCode===229&&(In="onCompositionStart");In&&(Cd&&x.locale!=="ko"&&(xl||In!=="onCompositionStart"?In==="onCompositionEnd"&&xl&&(zn=yd()):(el=Vr,vl="value"in el?el.value:el.textContent,xl=!0)),kn=Qc(Vt,In),0<kn.length&&(In=new Lc(In,n,null,x,Vr),$r.push({event:In,listeners:kn}),zn?In.data=zn:(zn=Mu(x),zn!==null&&(In.data=zn)))),(zn=Uh?Vh(n,x):Bc(n,x))&&(Vt=Qc(Vt,"onBeforeInput"),0<Vt.length&&(Vr=new Lc("onBeforeInput","beforeinput",null,x,Vr),$r.push({event:Vr,listeners:Vt}),Vr.data=zn))}Jc($r,o)})}function mc(n,o,x){return{instance:n,listener:o,currentTarget:x}}function Qc(n,o){for(var x=o+"Capture",F=[];n!==null;){var U=n,J=U.stateNode;U.tag===5&&J!==null&&(U=J,J=Zr(n,x),J!=null&&F.unshift(mc(n,J,U)),J=Zr(n,o),J!=null&&F.push(mc(n,J,U))),n=n.return}return F}function Wl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Ud(n,o,x,F,U){for(var J=o._reactName,oe=[];x!==null&&x!==F;){var Be=x,st=Be.alternate,Vt=Be.stateNode;if(st!==null&&st===F)break;Be.tag===5&&Vt!==null&&(Be=Vt,U?(st=Zr(x,J),st!=null&&oe.unshift(mc(x,st,Be))):U||(st=Zr(x,J),st!=null&&oe.push(mc(x,st,Be)))),x=x.return}oe.length!==0&&n.push({event:o,listeners:oe})}var Hh=/\r\n?/g,$h=/\u0000|\uFFFD/g;function Vd(n){return(typeof n=="string"?n:""+n).replace(Hh,`
`).replace($h,"")}function Kc(n,o,x){if(o=Vd(o),Vd(n)!==o&&x)throw Error(t(425))}function eu(){}var Hu=null,$u=null;function ka(n,o){return n==="textarea"||n==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Yu=typeof setTimeout=="function"?setTimeout:void 0,Yh=typeof clearTimeout=="function"?clearTimeout:void 0,qu=typeof Promise=="function"?Promise:void 0,qh=typeof queueMicrotask=="function"?queueMicrotask:typeof qu<"u"?function(n){return qu.resolve(null).then(n).catch(Xh)}:Yu;function Xh(n){setTimeout(function(){throw n})}function Sl(n,o){var x=o,F=0;do{var U=x.nextSibling;if(n.removeChild(x),U&&U.nodeType===8)if(x=U.data,x==="/$"){if(F===0){n.removeChild(U),sc(o);return}F--}else x!=="$"&&x!=="$?"&&x!=="$!"||F++;x=U}while(x);sc(o)}function Ia(n){for(;n!=null;n=n.nextSibling){var o=n.nodeType;if(o===1||o===3)break;if(o===8){if(o=n.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return n}function tu(n){n=n.previousSibling;for(var o=0;n;){if(n.nodeType===8){var x=n.data;if(x==="$"||x==="$!"||x==="$?"){if(o===0)return n;o--}else x==="/$"&&o++}n=n.previousSibling}return null}var Hl=Math.random().toString(36).slice(2),Ma="__reactFiber$"+Hl,gc="__reactProps$"+Hl,ya="__reactContainer$"+Hl,vc="__reactEvents$"+Hl,Zh="__reactListeners$"+Hl,Jh="__reactHandles$"+Hl;function El(n){var o=n[Ma];if(o)return o;for(var x=n.parentNode;x;){if(o=x[ya]||x[Ma]){if(x=o.alternate,o.child!==null||x!==null&&x.child!==null)for(n=tu(n);n!==null;){if(x=n[Ma])return x;n=tu(n)}return o}n=x,x=n.parentNode}return null}function yc(n){return n=n[Ma]||n[ya],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function $l(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(t(33))}function ru(n){return n[gc]||null}var Xu=[],Yl=-1;function nl(n){return{current:n}}function vi(n){0>Yl||(n.current=Xu[Yl],Xu[Yl]=null,Yl--)}function pi(n,o){Yl++,Xu[Yl]=n.current,n.current=o}var il={},Qs=nl(il),ca=nl(!1),sl=il;function Cl(n,o){var x=n.type.contextTypes;if(!x)return il;var F=n.stateNode;if(F&&F.__reactInternalMemoizedUnmaskedChildContext===o)return F.__reactInternalMemoizedMaskedChildContext;var U={},J;for(J in x)U[J]=o[J];return F&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=o,n.__reactInternalMemoizedMaskedChildContext=U),U}function ia(n){return n=n.childContextTypes,n!=null}function _c(){vi(ca),vi(Qs)}function Zu(n,o,x){if(Qs.current!==il)throw Error(t(168));pi(Qs,o),pi(ca,x)}function Ju(n,o,x){var F=n.stateNode;if(o=o.childContextTypes,typeof F.getChildContext!="function")return x;F=F.getChildContext();for(var U in F)if(!(U in o))throw Error(t(108,Fe(n)||"Unknown",U));return G({},x,F)}function xc(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||il,sl=Qs.current,pi(Qs,n),pi(ca,ca.current),!0}function Qu(n,o,x){var F=n.stateNode;if(!F)throw Error(t(169));x?(n=Ju(n,o,sl),F.__reactInternalMemoizedMergedChildContext=n,vi(ca),vi(Qs),pi(Qs,n)):vi(ca),pi(ca,x)}var Oa=null,nu=!1,P=!1;function K(n){Oa===null?Oa=[n]:Oa.push(n)}function L(n){nu=!0,K(n)}function be(){if(!P&&Oa!==null){P=!0;var n=0,o=Fn;try{var x=Oa;for(Fn=1;n<x.length;n++){var F=x[n];do F=F(!0);while(F!==null)}Oa=null,nu=!1}catch(U){throw Oa!==null&&(Oa=Oa.slice(n+1)),cl(ja,be),U}finally{Fn=o,P=!1}}return null}var Ee=[],De=0,Et=null,ct=0,sn=[],nt=0,xt=null,jn=1,Yr="";function Br(n,o){Ee[De++]=ct,Ee[De++]=Et,Et=n,ct=o}function mi(n,o,x){sn[nt++]=jn,sn[nt++]=Yr,sn[nt++]=xt,xt=n;var F=jn;n=Yr;var U=32-ga(F)-1;F&=~(1<<U),x+=1;var J=32-ga(o)+U;if(30<J){var oe=U-U%5;J=(F&(1<<oe)-1).toString(32),F>>=oe,U-=oe,jn=1<<32-ga(o)+U|x<<U|F,Yr=J+n}else jn=1<<J|x<<U|F,Yr=n}function xi(n){n.return!==null&&(Br(n,1),mi(n,1,0))}function ni(n){for(;n===Et;)Et=Ee[--De],Ee[De]=null,ct=Ee[--De],Ee[De]=null;for(;n===xt;)xt=sn[--nt],sn[nt]=null,Yr=sn[--nt],sn[nt]=null,jn=sn[--nt],sn[nt]=null}var An=null,Cn=null,Hr=!1,Tn=null;function ks(n,o){var x=Ba(5,null,null,0);x.elementType="DELETED",x.stateNode=o,x.return=n,o=n.deletions,o===null?(n.deletions=[x],n.flags|=16):o.push(x)}function ii(n,o){switch(n.tag){case 5:var x=n.type;return o=o.nodeType!==1||x.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(n.stateNode=o,An=n,Cn=Ia(o.firstChild),!0):!1;case 6:return o=n.pendingProps===""||o.nodeType!==3?null:o,o!==null?(n.stateNode=o,An=n,Cn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(x=xt!==null?{id:jn,overflow:Yr}:null,n.memoizedState={dehydrated:o,treeContext:x,retryLane:1073741824},x=Ba(18,null,null,0),x.stateNode=o,x.return=n,n.child=x,An=n,Cn=null,!0):!1;default:return!1}}function ei(n){return(n.mode&1)!==0&&(n.flags&128)===0}function ci(n){if(Hr){var o=Cn;if(o){var x=o;if(!ii(n,o)){if(ei(n))throw Error(t(418));o=Ia(x.nextSibling);var F=An;o&&ii(n,o)?ks(F,x):(n.flags=n.flags&-4097|2,Hr=!1,An=n)}}else{if(ei(n))throw Error(t(418));n.flags=n.flags&-4097|2,Hr=!1,An=n}}}function Rn(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;An=n}function Ln(n){if(n!==An)return!1;if(!Hr)return Rn(n),Hr=!0,!1;var o;if((o=n.tag!==3)&&!(o=n.tag!==5)&&(o=n.type,o=o!=="head"&&o!=="body"&&!ka(n.type,n.memoizedProps)),o&&(o=Cn)){if(ei(n))throw Ks(),Error(t(418));for(;o;)ks(n,o),o=Ia(o.nextSibling)}if(Rn(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(t(317));e:{for(n=n.nextSibling,o=0;n;){if(n.nodeType===8){var x=n.data;if(x==="/$"){if(o===0){Cn=Ia(n.nextSibling);break e}o--}else x!=="$"&&x!=="$!"&&x!=="$?"||o++}n=n.nextSibling}Cn=null}}else Cn=An?Ia(n.stateNode.nextSibling):null;return!0}function Ks(){for(var n=Cn;n;)n=Ia(n.nextSibling)}function wa(){Cn=An=null,Hr=!1}function iu(n){Tn===null?Tn=[n]:Tn.push(n)}var su=A.ReactCurrentBatchConfig;function ua(n,o){if(n&&n.defaultProps){o=G({},o),n=n.defaultProps;for(var x in n)o[x]===void 0&&(o[x]=n[x]);return o}return o}var Wd=nl(null),Hd=null,ou=null,Qh=null;function Kh(){Qh=ou=Hd=null}function ef(n){var o=Wd.current;vi(Wd),n._currentValue=o}function tf(n,o,x){for(;n!==null;){var F=n.alternate;if((n.childLanes&o)!==o?(n.childLanes|=o,F!==null&&(F.childLanes|=o)):F!==null&&(F.childLanes&o)!==o&&(F.childLanes|=o),n===x)break;n=n.return}}function au(n,o){Hd=n,Qh=ou=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&o)!==0&&(Sa=!0),n.firstContext=null)}function Fa(n){var o=n._currentValue;if(Qh!==n)if(n={context:n,memoizedValue:o,next:null},ou===null){if(Hd===null)throw Error(t(308));ou=n,Hd.dependencies={lanes:0,firstContext:n}}else ou=ou.next=n;return o}var bc=null;function rf(n){bc===null?bc=[n]:bc.push(n)}function Xf(n,o,x,F){var U=o.interleaved;return U===null?(x.next=x,rf(o)):(x.next=U.next,U.next=x),o.interleaved=x,Al(n,F)}function Al(n,o){n.lanes|=o;var x=n.alternate;for(x!==null&&(x.lanes|=o),x=n,n=n.return;n!==null;)n.childLanes|=o,x=n.alternate,x!==null&&(x.childLanes|=o),x=n,n=n.return;return x.tag===3?x.stateNode:null}var ql=!1;function nf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zf(n,o){n=n.updateQueue,o.updateQueue===n&&(o.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Tl(n,o){return{eventTime:n,lane:o,tag:0,payload:null,callback:null,next:null}}function Xl(n,o,x){var F=n.updateQueue;if(F===null)return null;if(F=F.shared,(oi&2)!==0){var U=F.pending;return U===null?o.next=o:(o.next=U.next,U.next=o),F.pending=o,Al(n,x)}return U=F.interleaved,U===null?(o.next=o,rf(F)):(o.next=U.next,U.next=o),F.interleaved=o,Al(n,x)}function $d(n,o,x){if(o=o.updateQueue,o!==null&&(o=o.shared,(x&4194240)!==0)){var F=o.lanes;F&=n.pendingLanes,x|=F,o.lanes=x,Pa(n,x)}}function Jf(n,o){var x=n.updateQueue,F=n.alternate;if(F!==null&&(F=F.updateQueue,x===F)){var U=null,J=null;if(x=x.firstBaseUpdate,x!==null){do{var oe={eventTime:x.eventTime,lane:x.lane,tag:x.tag,payload:x.payload,callback:x.callback,next:null};J===null?U=J=oe:J=J.next=oe,x=x.next}while(x!==null);J===null?U=J=o:J=J.next=o}else U=J=o;x={baseState:F.baseState,firstBaseUpdate:U,lastBaseUpdate:J,shared:F.shared,effects:F.effects},n.updateQueue=x;return}n=x.lastBaseUpdate,n===null?x.firstBaseUpdate=o:n.next=o,x.lastBaseUpdate=o}function Yd(n,o,x,F){var U=n.updateQueue;ql=!1;var J=U.firstBaseUpdate,oe=U.lastBaseUpdate,Be=U.shared.pending;if(Be!==null){U.shared.pending=null;var st=Be,Vt=st.next;st.next=null,oe===null?J=Vt:oe.next=Vt,oe=st;var Vr=n.alternate;Vr!==null&&(Vr=Vr.updateQueue,Be=Vr.lastBaseUpdate,Be!==oe&&(Be===null?Vr.firstBaseUpdate=Vt:Be.next=Vt,Vr.lastBaseUpdate=st))}if(J!==null){var $r=U.baseState;oe=0,Vr=Vt=st=null,Be=J;do{var Ur=Be.lane,on=Be.eventTime;if((F&Ur)===Ur){Vr!==null&&(Vr=Vr.next={eventTime:on,lane:0,tag:Be.tag,payload:Be.payload,callback:Be.callback,next:null});e:{var xn=n,wn=Be;switch(Ur=o,on=x,wn.tag){case 1:if(xn=wn.payload,typeof xn=="function"){$r=xn.call(on,$r,Ur);break e}$r=xn;break e;case 3:xn.flags=xn.flags&-65537|128;case 0:if(xn=wn.payload,Ur=typeof xn=="function"?xn.call(on,$r,Ur):xn,Ur==null)break e;$r=G({},$r,Ur);break e;case 2:ql=!0}}Be.callback!==null&&Be.lane!==0&&(n.flags|=64,Ur=U.effects,Ur===null?U.effects=[Be]:Ur.push(Be))}else on={eventTime:on,lane:Ur,tag:Be.tag,payload:Be.payload,callback:Be.callback,next:null},Vr===null?(Vt=Vr=on,st=$r):Vr=Vr.next=on,oe|=Ur;if(Be=Be.next,Be===null){if(Be=U.shared.pending,Be===null)break;Ur=Be,Be=Ur.next,Ur.next=null,U.lastBaseUpdate=Ur,U.shared.pending=null}}while(!0);if(Vr===null&&(st=$r),U.baseState=st,U.firstBaseUpdate=Vt,U.lastBaseUpdate=Vr,o=U.shared.interleaved,o!==null){U=o;do oe|=U.lane,U=U.next;while(U!==o)}else J===null&&(U.shared.lanes=0);Ec|=oe,n.lanes=oe,n.memoizedState=$r}}function Qf(n,o,x){if(n=o.effects,o.effects=null,n!==null)for(o=0;o<n.length;o++){var F=n[o],U=F.callback;if(U!==null){if(F.callback=null,F=x,typeof U!="function")throw Error(t(191,U));U.call(F)}}}var Kf=new e.Component().refs;function sf(n,o,x,F){o=n.memoizedState,x=x(F,o),x=x==null?o:G({},o,x),n.memoizedState=x,n.lanes===0&&(n.updateQueue.baseState=x)}var qd={isMounted:function(n){return(n=n._reactInternals)?ti(n)===n:!1},enqueueSetState:function(n,o,x){n=n._reactInternals;var F=xa(),U=Kl(n),J=Tl(F,U);J.payload=o,x!=null&&(J.callback=x),o=Xl(n,J,U),o!==null&&(Ya(o,n,U,F),$d(o,n,U))},enqueueReplaceState:function(n,o,x){n=n._reactInternals;var F=xa(),U=Kl(n),J=Tl(F,U);J.tag=1,J.payload=o,x!=null&&(J.callback=x),o=Xl(n,J,U),o!==null&&(Ya(o,n,U,F),$d(o,n,U))},enqueueForceUpdate:function(n,o){n=n._reactInternals;var x=xa(),F=Kl(n),U=Tl(x,F);U.tag=2,o!=null&&(U.callback=o),o=Xl(n,U,F),o!==null&&(Ya(o,n,F,x),$d(o,n,F))}};function ep(n,o,x,F,U,J,oe){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(F,J,oe):o.prototype&&o.prototype.isPureReactComponent?!wl(x,F)||!wl(U,J):!0}function tp(n,o,x){var F=!1,U=il,J=o.contextType;return typeof J=="object"&&J!==null?J=Fa(J):(U=ia(o)?sl:Qs.current,F=o.contextTypes,J=(F=F!=null)?Cl(n,U):il),o=new o(x,J),n.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=qd,n.stateNode=o,o._reactInternals=n,F&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=U,n.__reactInternalMemoizedMaskedChildContext=J),o}function rp(n,o,x,F){n=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(x,F),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(x,F),o.state!==n&&qd.enqueueReplaceState(o,o.state,null)}function of(n,o,x,F){var U=n.stateNode;U.props=x,U.state=n.memoizedState,U.refs=Kf,nf(n);var J=o.contextType;typeof J=="object"&&J!==null?U.context=Fa(J):(J=ia(o)?sl:Qs.current,U.context=Cl(n,J)),U.state=n.memoizedState,J=o.getDerivedStateFromProps,typeof J=="function"&&(sf(n,o,J,x),U.state=n.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof U.getSnapshotBeforeUpdate=="function"||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(o=U.state,typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount(),o!==U.state&&qd.enqueueReplaceState(U,U.state,null),Yd(n,x,U,F),U.state=n.memoizedState),typeof U.componentDidMount=="function"&&(n.flags|=4194308)}function Ku(n,o,x){if(n=x.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(x._owner){if(x=x._owner,x){if(x.tag!==1)throw Error(t(309));var F=x.stateNode}if(!F)throw Error(t(147,n));var U=F,J=""+n;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===J?o.ref:(o=function(oe){var Be=U.refs;Be===Kf&&(Be=U.refs={}),oe===null?delete Be[J]:Be[J]=oe},o._stringRef=J,o)}if(typeof n!="string")throw Error(t(284));if(!x._owner)throw Error(t(290,n))}return n}function Xd(n,o){throw n=Object.prototype.toString.call(o),Error(t(31,n==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":n))}function np(n){var o=n._init;return o(n._payload)}function ip(n){function o(St,ot){if(n){var Tt=St.deletions;Tt===null?(St.deletions=[ot],St.flags|=16):Tt.push(ot)}}function x(St,ot){if(!n)return null;for(;ot!==null;)o(St,ot),ot=ot.sibling;return null}function F(St,ot){for(St=new Map;ot!==null;)ot.key!==null?St.set(ot.key,ot):St.set(ot.index,ot),ot=ot.sibling;return St}function U(St,ot){return St=tc(St,ot),St.index=0,St.sibling=null,St}function J(St,ot,Tt){return St.index=Tt,n?(Tt=St.alternate,Tt!==null?(Tt=Tt.index,Tt<ot?(St.flags|=2,ot):Tt):(St.flags|=2,ot)):(St.flags|=1048576,ot)}function oe(St){return n&&St.alternate===null&&(St.flags|=2),St}function Be(St,ot,Tt,Xr){return ot===null||ot.tag!==6?(ot=Vf(Tt,St.mode,Xr),ot.return=St,ot):(ot=U(ot,Tt),ot.return=St,ot)}function st(St,ot,Tt,Xr){var En=Tt.type;return En===C?Vr(St,ot,Tt.props.children,Xr,Tt.key):ot!==null&&(ot.elementType===En||typeof En=="object"&&En!==null&&En.$$typeof===H&&np(En)===ot.type)?(Xr=U(ot,Tt.props),Xr.ref=Ku(St,ot,Tt),Xr.return=St,Xr):(Xr=ph(Tt.type,Tt.key,Tt.props,null,St.mode,Xr),Xr.ref=Ku(St,ot,Tt),Xr.return=St,Xr)}function Vt(St,ot,Tt,Xr){return ot===null||ot.tag!==4||ot.stateNode.containerInfo!==Tt.containerInfo||ot.stateNode.implementation!==Tt.implementation?(ot=Wf(Tt,St.mode,Xr),ot.return=St,ot):(ot=U(ot,Tt.children||[]),ot.return=St,ot)}function Vr(St,ot,Tt,Xr,En){return ot===null||ot.tag!==7?(ot=Rc(Tt,St.mode,Xr,En),ot.return=St,ot):(ot=U(ot,Tt),ot.return=St,ot)}function $r(St,ot,Tt){if(typeof ot=="string"&&ot!==""||typeof ot=="number")return ot=Vf(""+ot,St.mode,Tt),ot.return=St,ot;if(typeof ot=="object"&&ot!==null){switch(ot.$$typeof){case u:return Tt=ph(ot.type,ot.key,ot.props,null,St.mode,Tt),Tt.ref=Ku(St,null,ot),Tt.return=St,Tt;case y:return ot=Wf(ot,St.mode,Tt),ot.return=St,ot;case H:var Xr=ot._init;return $r(St,Xr(ot._payload),Tt)}if(Lr(ot)||Y(ot))return ot=Rc(ot,St.mode,Tt,null),ot.return=St,ot;Xd(St,ot)}return null}function Ur(St,ot,Tt,Xr){var En=ot!==null?ot.key:null;if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number")return En!==null?null:Be(St,ot,""+Tt,Xr);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case u:return Tt.key===En?st(St,ot,Tt,Xr):null;case y:return Tt.key===En?Vt(St,ot,Tt,Xr):null;case H:return En=Tt._init,Ur(St,ot,En(Tt._payload),Xr)}if(Lr(Tt)||Y(Tt))return En!==null?null:Vr(St,ot,Tt,Xr,null);Xd(St,Tt)}return null}function on(St,ot,Tt,Xr,En){if(typeof Xr=="string"&&Xr!==""||typeof Xr=="number")return St=St.get(Tt)||null,Be(ot,St,""+Xr,En);if(typeof Xr=="object"&&Xr!==null){switch(Xr.$$typeof){case u:return St=St.get(Xr.key===null?Tt:Xr.key)||null,st(ot,St,Xr,En);case y:return St=St.get(Xr.key===null?Tt:Xr.key)||null,Vt(ot,St,Xr,En);case H:var kn=Xr._init;return on(St,ot,Tt,kn(Xr._payload),En)}if(Lr(Xr)||Y(Xr))return St=St.get(Tt)||null,Vr(ot,St,Xr,En,null);Xd(ot,Xr)}return null}function xn(St,ot,Tt,Xr){for(var En=null,kn=null,zn=ot,In=ot=0,ra=null;zn!==null&&In<Tt.length;In++){zn.index>In?(ra=zn,zn=null):ra=zn.sibling;var ai=Ur(St,zn,Tt[In],Xr);if(ai===null){zn===null&&(zn=ra);break}n&&zn&&ai.alternate===null&&o(St,zn),ot=J(ai,ot,In),kn===null?En=ai:kn.sibling=ai,kn=ai,zn=ra}if(In===Tt.length)return x(St,zn),Hr&&Br(St,In),En;if(zn===null){for(;In<Tt.length;In++)zn=$r(St,Tt[In],Xr),zn!==null&&(ot=J(zn,ot,In),kn===null?En=zn:kn.sibling=zn,kn=zn);return Hr&&Br(St,In),En}for(zn=F(St,zn);In<Tt.length;In++)ra=on(zn,St,In,Tt[In],Xr),ra!==null&&(n&&ra.alternate!==null&&zn.delete(ra.key===null?In:ra.key),ot=J(ra,ot,In),kn===null?En=ra:kn.sibling=ra,kn=ra);return n&&zn.forEach(function(rc){return o(St,rc)}),Hr&&Br(St,In),En}function wn(St,ot,Tt,Xr){var En=Y(Tt);if(typeof En!="function")throw Error(t(150));if(Tt=En.call(Tt),Tt==null)throw Error(t(151));for(var kn=En=null,zn=ot,In=ot=0,ra=null,ai=Tt.next();zn!==null&&!ai.done;In++,ai=Tt.next()){zn.index>In?(ra=zn,zn=null):ra=zn.sibling;var rc=Ur(St,zn,ai.value,Xr);if(rc===null){zn===null&&(zn=ra);break}n&&zn&&rc.alternate===null&&o(St,zn),ot=J(rc,ot,In),kn===null?En=rc:kn.sibling=rc,kn=rc,zn=ra}if(ai.done)return x(St,zn),Hr&&Br(St,In),En;if(zn===null){for(;!ai.done;In++,ai=Tt.next())ai=$r(St,ai.value,Xr),ai!==null&&(ot=J(ai,ot,In),kn===null?En=ai:kn.sibling=ai,kn=ai);return Hr&&Br(St,In),En}for(zn=F(St,zn);!ai.done;In++,ai=Tt.next())ai=on(zn,St,In,ai.value,Xr),ai!==null&&(n&&ai.alternate!==null&&zn.delete(ai.key===null?In:ai.key),ot=J(ai,ot,In),kn===null?En=ai:kn.sibling=ai,kn=ai);return n&&zn.forEach(function(Jm){return o(St,Jm)}),Hr&&Br(St,In),En}function Us(St,ot,Tt,Xr){if(typeof Tt=="object"&&Tt!==null&&Tt.type===C&&Tt.key===null&&(Tt=Tt.props.children),typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case u:e:{for(var En=Tt.key,kn=ot;kn!==null;){if(kn.key===En){if(En=Tt.type,En===C){if(kn.tag===7){x(St,kn.sibling),ot=U(kn,Tt.props.children),ot.return=St,St=ot;break e}}else if(kn.elementType===En||typeof En=="object"&&En!==null&&En.$$typeof===H&&np(En)===kn.type){x(St,kn.sibling),ot=U(kn,Tt.props),ot.ref=Ku(St,kn,Tt),ot.return=St,St=ot;break e}x(St,kn);break}else o(St,kn);kn=kn.sibling}Tt.type===C?(ot=Rc(Tt.props.children,St.mode,Xr,Tt.key),ot.return=St,St=ot):(Xr=ph(Tt.type,Tt.key,Tt.props,null,St.mode,Xr),Xr.ref=Ku(St,ot,Tt),Xr.return=St,St=Xr)}return oe(St);case y:e:{for(kn=Tt.key;ot!==null;){if(ot.key===kn)if(ot.tag===4&&ot.stateNode.containerInfo===Tt.containerInfo&&ot.stateNode.implementation===Tt.implementation){x(St,ot.sibling),ot=U(ot,Tt.children||[]),ot.return=St,St=ot;break e}else{x(St,ot);break}else o(St,ot);ot=ot.sibling}ot=Wf(Tt,St.mode,Xr),ot.return=St,St=ot}return oe(St);case H:return kn=Tt._init,Us(St,ot,kn(Tt._payload),Xr)}if(Lr(Tt))return xn(St,ot,Tt,Xr);if(Y(Tt))return wn(St,ot,Tt,Xr);Xd(St,Tt)}return typeof Tt=="string"&&Tt!==""||typeof Tt=="number"?(Tt=""+Tt,ot!==null&&ot.tag===6?(x(St,ot.sibling),ot=U(ot,Tt),ot.return=St,St=ot):(x(St,ot),ot=Vf(Tt,St.mode,Xr),ot.return=St,St=ot),oe(St)):x(St,ot)}return Us}var lu=ip(!0),sp=ip(!1),ed={},ol=nl(ed),td=nl(ed),rd=nl(ed);function wc(n){if(n===ed)throw Error(t(174));return n}function af(n,o){switch(pi(rd,o),pi(td,n),pi(ol,ed),n=o.nodeType,n){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:ie(null,"");break;default:n=n===8?o.parentNode:o,o=n.namespaceURI||null,n=n.tagName,o=ie(o,n)}vi(ol),pi(ol,o)}function cu(){vi(ol),vi(td),vi(rd)}function op(n){wc(rd.current);var o=wc(ol.current),x=ie(o,n.type);o!==x&&(pi(td,n),pi(ol,x))}function lf(n){td.current===n&&(vi(ol),vi(td))}var Ss=nl(0);function Zd(n){for(var o=n;o!==null;){if(o.tag===13){var x=o.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||x.data==="$?"||x.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var cf=[];function uf(){for(var n=0;n<cf.length;n++)cf[n]._workInProgressVersionPrimary=null;cf.length=0}var Jd=A.ReactCurrentDispatcher,df=A.ReactCurrentBatchConfig,Sc=0,Ts=null,qs=null,ea=null,Qd=!1,nd=!1,sd=0,_m=0;function da(){throw Error(t(321))}function hf(n,o){if(o===null)return!1;for(var x=0;x<o.length&&x<n.length;x++)if(!Gs(n[x],o[x]))return!1;return!0}function ff(n,o,x,F,U,J){if(Sc=J,Ts=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Jd.current=n===null||n.memoizedState===null?Sm:Em,n=x(F,U),nd){J=0;do{if(nd=!1,sd=0,25<=J)throw Error(t(301));J+=1,ea=qs=null,o.updateQueue=null,Jd.current=Cm,n=x(F,U)}while(nd)}if(Jd.current=th,o=qs!==null&&qs.next!==null,Sc=0,ea=qs=Ts=null,Qd=!1,o)throw Error(t(300));return n}function pf(){var n=sd!==0;return sd=0,n}function al(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ea===null?Ts.memoizedState=ea=n:ea=ea.next=n,ea}function La(){if(qs===null){var n=Ts.alternate;n=n!==null?n.memoizedState:null}else n=qs.next;var o=ea===null?Ts.memoizedState:ea.next;if(o!==null)ea=o,qs=n;else{if(n===null)throw Error(t(310));qs=n,n={memoizedState:qs.memoizedState,baseState:qs.baseState,baseQueue:qs.baseQueue,queue:qs.queue,next:null},ea===null?Ts.memoizedState=ea=n:ea=ea.next=n}return ea}function od(n,o){return typeof o=="function"?o(n):o}function mf(n){var o=La(),x=o.queue;if(x===null)throw Error(t(311));x.lastRenderedReducer=n;var F=qs,U=F.baseQueue,J=x.pending;if(J!==null){if(U!==null){var oe=U.next;U.next=J.next,J.next=oe}F.baseQueue=U=J,x.pending=null}if(U!==null){J=U.next,F=F.baseState;var Be=oe=null,st=null,Vt=J;do{var Vr=Vt.lane;if((Sc&Vr)===Vr)st!==null&&(st=st.next={lane:0,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null}),F=Vt.hasEagerState?Vt.eagerState:n(F,Vt.action);else{var $r={lane:Vr,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null};st===null?(Be=st=$r,oe=F):st=st.next=$r,Ts.lanes|=Vr,Ec|=Vr}Vt=Vt.next}while(Vt!==null&&Vt!==J);st===null?oe=F:st.next=Be,Gs(F,o.memoizedState)||(Sa=!0),o.memoizedState=F,o.baseState=oe,o.baseQueue=st,x.lastRenderedState=F}if(n=x.interleaved,n!==null){U=n;do J=U.lane,Ts.lanes|=J,Ec|=J,U=U.next;while(U!==n)}else U===null&&(x.lanes=0);return[o.memoizedState,x.dispatch]}function gf(n){var o=La(),x=o.queue;if(x===null)throw Error(t(311));x.lastRenderedReducer=n;var F=x.dispatch,U=x.pending,J=o.memoizedState;if(U!==null){x.pending=null;var oe=U=U.next;do J=n(J,oe.action),oe=oe.next;while(oe!==U);Gs(J,o.memoizedState)||(Sa=!0),o.memoizedState=J,o.baseQueue===null&&(o.baseState=J),x.lastRenderedState=J}return[J,F]}function ap(){}function lp(n,o){var x=Ts,F=La(),U=o(),J=!Gs(F.memoizedState,U);if(J&&(F.memoizedState=U,Sa=!0),F=F.queue,vf(dp.bind(null,x,F,n),[n]),F.getSnapshot!==o||J||ea!==null&&ea.memoizedState.tag&1){if(x.flags|=2048,ad(9,up.bind(null,x,F,U,o),void 0,null),ta===null)throw Error(t(349));(Sc&30)!==0||cp(x,o,U)}return U}function cp(n,o,x){n.flags|=16384,n={getSnapshot:o,value:x},o=Ts.updateQueue,o===null?(o={lastEffect:null,stores:null},Ts.updateQueue=o,o.stores=[n]):(x=o.stores,x===null?o.stores=[n]:x.push(n))}function up(n,o,x,F){o.value=x,o.getSnapshot=F,hp(o)&&fp(n)}function dp(n,o,x){return x(function(){hp(o)&&fp(n)})}function hp(n){var o=n.getSnapshot;n=n.value;try{var x=o();return!Gs(n,x)}catch{return!0}}function fp(n){var o=Al(n,1);o!==null&&Ya(o,n,1,-1)}function pp(n){var o=al();return typeof n=="function"&&(n=n()),o.memoizedState=o.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:od,lastRenderedState:n},o.queue=n,n=n.dispatch=wm.bind(null,Ts,n),[o.memoizedState,n]}function ad(n,o,x,F){return n={tag:n,create:o,destroy:x,deps:F,next:null},o=Ts.updateQueue,o===null?(o={lastEffect:null,stores:null},Ts.updateQueue=o,o.lastEffect=n.next=n):(x=o.lastEffect,x===null?o.lastEffect=n.next=n:(F=x.next,x.next=n,n.next=F,o.lastEffect=n)),n}function mp(){return La().memoizedState}function Kd(n,o,x,F){var U=al();Ts.flags|=n,U.memoizedState=ad(1|o,x,void 0,F===void 0?null:F)}function eh(n,o,x,F){var U=La();F=F===void 0?null:F;var J=void 0;if(qs!==null){var oe=qs.memoizedState;if(J=oe.destroy,F!==null&&hf(F,oe.deps)){U.memoizedState=ad(o,x,J,F);return}}Ts.flags|=n,U.memoizedState=ad(1|o,x,J,F)}function gp(n,o){return Kd(8390656,8,n,o)}function vf(n,o){return eh(2048,8,n,o)}function vp(n,o){return eh(4,2,n,o)}function yp(n,o){return eh(4,4,n,o)}function _p(n,o){if(typeof o=="function")return n=n(),o(n),function(){o(null)};if(o!=null)return n=n(),o.current=n,function(){o.current=null}}function xp(n,o,x){return x=x!=null?x.concat([n]):null,eh(4,4,_p.bind(null,o,n),x)}function yf(){}function bp(n,o){var x=La();o=o===void 0?null:o;var F=x.memoizedState;return F!==null&&o!==null&&hf(o,F[1])?F[0]:(x.memoizedState=[n,o],n)}function wp(n,o){var x=La();o=o===void 0?null:o;var F=x.memoizedState;return F!==null&&o!==null&&hf(o,F[1])?F[0]:(n=n(),x.memoizedState=[n,o],n)}function Sp(n,o,x){return(Sc&21)===0?(n.baseState&&(n.baseState=!1,Sa=!0),n.memoizedState=x):(Gs(x,o)||(x=Za(),Ts.lanes|=x,Ec|=x,n.baseState=!0),o)}function xm(n,o){var x=Fn;Fn=x!==0&&4>x?x:4,n(!0);var F=df.transition;df.transition={};try{n(!1),o()}finally{Fn=x,df.transition=F}}function Ep(){return La().memoizedState}function bm(n,o,x){var F=Kl(n);if(x={lane:F,action:x,hasEagerState:!1,eagerState:null,next:null},Cp(n))Ap(o,x);else if(x=Xf(n,o,x,F),x!==null){var U=xa();Ya(x,n,F,U),Tp(x,o,F)}}function wm(n,o,x){var F=Kl(n),U={lane:F,action:x,hasEagerState:!1,eagerState:null,next:null};if(Cp(n))Ap(o,U);else{var J=n.alternate;if(n.lanes===0&&(J===null||J.lanes===0)&&(J=o.lastRenderedReducer,J!==null))try{var oe=o.lastRenderedState,Be=J(oe,x);if(U.hasEagerState=!0,U.eagerState=Be,Gs(Be,oe)){var st=o.interleaved;st===null?(U.next=U,rf(o)):(U.next=st.next,st.next=U),o.interleaved=U;return}}catch{}finally{}x=Xf(n,o,U,F),x!==null&&(U=xa(),Ya(x,n,F,U),Tp(x,o,F))}}function Cp(n){var o=n.alternate;return n===Ts||o!==null&&o===Ts}function Ap(n,o){nd=Qd=!0;var x=n.pending;x===null?o.next=o:(o.next=x.next,x.next=o),n.pending=o}function Tp(n,o,x){if((x&4194240)!==0){var F=o.lanes;F&=n.pendingLanes,x|=F,o.lanes=x,Pa(n,x)}}var th={readContext:Fa,useCallback:da,useContext:da,useEffect:da,useImperativeHandle:da,useInsertionEffect:da,useLayoutEffect:da,useMemo:da,useReducer:da,useRef:da,useState:da,useDebugValue:da,useDeferredValue:da,useTransition:da,useMutableSource:da,useSyncExternalStore:da,useId:da,unstable_isNewReconciler:!1},Sm={readContext:Fa,useCallback:function(n,o){return al().memoizedState=[n,o===void 0?null:o],n},useContext:Fa,useEffect:gp,useImperativeHandle:function(n,o,x){return x=x!=null?x.concat([n]):null,Kd(4194308,4,_p.bind(null,o,n),x)},useLayoutEffect:function(n,o){return Kd(4194308,4,n,o)},useInsertionEffect:function(n,o){return Kd(4,2,n,o)},useMemo:function(n,o){var x=al();return o=o===void 0?null:o,n=n(),x.memoizedState=[n,o],n},useReducer:function(n,o,x){var F=al();return o=x!==void 0?x(o):o,F.memoizedState=F.baseState=o,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:o},F.queue=n,n=n.dispatch=bm.bind(null,Ts,n),[F.memoizedState,n]},useRef:function(n){var o=al();return n={current:n},o.memoizedState=n},useState:pp,useDebugValue:yf,useDeferredValue:function(n){return al().memoizedState=n},useTransition:function(){var n=pp(!1),o=n[0];return n=xm.bind(null,n[1]),al().memoizedState=n,[o,n]},useMutableSource:function(){},useSyncExternalStore:function(n,o,x){var F=Ts,U=al();if(Hr){if(x===void 0)throw Error(t(407));x=x()}else{if(x=o(),ta===null)throw Error(t(349));(Sc&30)!==0||cp(F,o,x)}U.memoizedState=x;var J={value:x,getSnapshot:o};return U.queue=J,gp(dp.bind(null,F,J,n),[n]),F.flags|=2048,ad(9,up.bind(null,F,J,x,o),void 0,null),x},useId:function(){var n=al(),o=ta.identifierPrefix;if(Hr){var x=Yr,F=jn;x=(F&~(1<<32-ga(F)-1)).toString(32)+x,o=":"+o+"R"+x,x=sd++,0<x&&(o+="H"+x.toString(32)),o+=":"}else x=_m++,o=":"+o+"r"+x.toString(32)+":";return n.memoizedState=o},unstable_isNewReconciler:!1},Em={readContext:Fa,useCallback:bp,useContext:Fa,useEffect:vf,useImperativeHandle:xp,useInsertionEffect:vp,useLayoutEffect:yp,useMemo:wp,useReducer:mf,useRef:mp,useState:function(){return mf(od)},useDebugValue:yf,useDeferredValue:function(n){var o=La();return Sp(o,qs.memoizedState,n)},useTransition:function(){var n=mf(od)[0],o=La().memoizedState;return[n,o]},useMutableSource:ap,useSyncExternalStore:lp,useId:Ep,unstable_isNewReconciler:!1},Cm={readContext:Fa,useCallback:bp,useContext:Fa,useEffect:vf,useImperativeHandle:xp,useInsertionEffect:vp,useLayoutEffect:yp,useMemo:wp,useReducer:gf,useRef:mp,useState:function(){return gf(od)},useDebugValue:yf,useDeferredValue:function(n){var o=La();return qs===null?o.memoizedState=n:Sp(o,qs.memoizedState,n)},useTransition:function(){var n=gf(od)[0],o=La().memoizedState;return[n,o]},useMutableSource:ap,useSyncExternalStore:lp,useId:Ep,unstable_isNewReconciler:!1};function uu(n,o){try{var x="",F=o;do x+=Ne(F),F=F.return;while(F);var U=x}catch(J){U=`
Error generating stack: `+J.message+`
`+J.stack}return{value:n,source:o,stack:U,digest:null}}function _f(n,o,x){return{value:n,source:null,stack:x??null,digest:o??null}}function xf(n,o){try{console.error(o.value)}catch(x){setTimeout(function(){throw x})}}var Am=typeof WeakMap=="function"?WeakMap:Map;function Rp(n,o,x){x=Tl(-1,x),x.tag=3,x.payload={element:null};var F=o.value;return x.callback=function(){lh||(lh=!0,Of=F),xf(n,o)},x}function kp(n,o,x){x=Tl(-1,x),x.tag=3;var F=n.type.getDerivedStateFromError;if(typeof F=="function"){var U=o.value;x.payload=function(){return F(U)},x.callback=function(){xf(n,o)}}var J=n.stateNode;return J!==null&&typeof J.componentDidCatch=="function"&&(x.callback=function(){xf(n,o),typeof F!="function"&&(Jl===null?Jl=new Set([this]):Jl.add(this));var oe=o.stack;this.componentDidCatch(o.value,{componentStack:oe!==null?oe:""})}),x}function Mp(n,o,x){var F=n.pingCache;if(F===null){F=n.pingCache=new Am;var U=new Set;F.set(o,U)}else U=F.get(o),U===void 0&&(U=new Set,F.set(o,U));U.has(x)||(U.add(x),n=jm.bind(null,n,o,x),o.then(n,n))}function zp(n){do{var o;if((o=n.tag===13)&&(o=n.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return n;n=n.return}while(n!==null);return null}function Np(n,o,x,F,U){return(n.mode&1)===0?(n===o?n.flags|=65536:(n.flags|=128,x.flags|=131072,x.flags&=-52805,x.tag===1&&(x.alternate===null?x.tag=17:(o=Tl(-1,1),o.tag=2,Xl(x,o,1))),x.lanes|=1),n):(n.flags|=65536,n.lanes=U,n)}var Tm=A.ReactCurrentOwner,Sa=!1;function _a(n,o,x,F){o.child=n===null?sp(o,null,x,F):lu(o,n.child,x,F)}function Pp(n,o,x,F,U){x=x.render;var J=o.ref;return au(o,U),F=ff(n,o,x,F,J,U),x=pf(),n!==null&&!Sa?(o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~U,Rl(n,o,U)):(Hr&&x&&xi(o),o.flags|=1,_a(n,o,F,U),o.child)}function Ip(n,o,x,F,U){if(n===null){var J=x.type;return typeof J=="function"&&!Uf(J)&&J.defaultProps===void 0&&x.compare===null&&x.defaultProps===void 0?(o.tag=15,o.type=J,Op(n,o,J,F,U)):(n=ph(x.type,null,F,o,o.mode,U),n.ref=o.ref,n.return=o,o.child=n)}if(J=n.child,(n.lanes&U)===0){var oe=J.memoizedProps;if(x=x.compare,x=x!==null?x:wl,x(oe,F)&&n.ref===o.ref)return Rl(n,o,U)}return o.flags|=1,n=tc(J,F),n.ref=o.ref,n.return=o,o.child=n}function Op(n,o,x,F,U){if(n!==null){var J=n.memoizedProps;if(wl(J,F)&&n.ref===o.ref)if(Sa=!1,o.pendingProps=F=J,(n.lanes&U)!==0)(n.flags&131072)!==0&&(Sa=!0);else return o.lanes=n.lanes,Rl(n,o,U)}return bf(n,o,x,F,U)}function Fp(n,o,x){var F=o.pendingProps,U=F.children,J=n!==null?n.memoizedState:null;if(F.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},pi(hu,za),za|=x;else{if((x&1073741824)===0)return n=J!==null?J.baseLanes|x:x,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:n,cachePool:null,transitions:null},o.updateQueue=null,pi(hu,za),za|=n,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},F=J!==null?J.baseLanes:x,pi(hu,za),za|=F}else J!==null?(F=J.baseLanes|x,o.memoizedState=null):F=x,pi(hu,za),za|=F;return _a(n,o,U,x),o.child}function Lp(n,o){var x=o.ref;(n===null&&x!==null||n!==null&&n.ref!==x)&&(o.flags|=512,o.flags|=2097152)}function bf(n,o,x,F,U){var J=ia(x)?sl:Qs.current;return J=Cl(o,J),au(o,U),x=ff(n,o,x,F,J,U),F=pf(),n!==null&&!Sa?(o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~U,Rl(n,o,U)):(Hr&&F&&xi(o),o.flags|=1,_a(n,o,x,U),o.child)}function Dp(n,o,x,F,U){if(ia(x)){var J=!0;xc(o)}else J=!1;if(au(o,U),o.stateNode===null)nh(n,o),tp(o,x,F),of(o,x,F,U),F=!0;else if(n===null){var oe=o.stateNode,Be=o.memoizedProps;oe.props=Be;var st=oe.context,Vt=x.contextType;typeof Vt=="object"&&Vt!==null?Vt=Fa(Vt):(Vt=ia(x)?sl:Qs.current,Vt=Cl(o,Vt));var Vr=x.getDerivedStateFromProps,$r=typeof Vr=="function"||typeof oe.getSnapshotBeforeUpdate=="function";$r||typeof oe.UNSAFE_componentWillReceiveProps!="function"&&typeof oe.componentWillReceiveProps!="function"||(Be!==F||st!==Vt)&&rp(o,oe,F,Vt),ql=!1;var Ur=o.memoizedState;oe.state=Ur,Yd(o,F,oe,U),st=o.memoizedState,Be!==F||Ur!==st||ca.current||ql?(typeof Vr=="function"&&(sf(o,x,Vr,F),st=o.memoizedState),(Be=ql||ep(o,x,Be,F,Ur,st,Vt))?($r||typeof oe.UNSAFE_componentWillMount!="function"&&typeof oe.componentWillMount!="function"||(typeof oe.componentWillMount=="function"&&oe.componentWillMount(),typeof oe.UNSAFE_componentWillMount=="function"&&oe.UNSAFE_componentWillMount()),typeof oe.componentDidMount=="function"&&(o.flags|=4194308)):(typeof oe.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=F,o.memoizedState=st),oe.props=F,oe.state=st,oe.context=Vt,F=Be):(typeof oe.componentDidMount=="function"&&(o.flags|=4194308),F=!1)}else{oe=o.stateNode,Zf(n,o),Be=o.memoizedProps,Vt=o.type===o.elementType?Be:ua(o.type,Be),oe.props=Vt,$r=o.pendingProps,Ur=oe.context,st=x.contextType,typeof st=="object"&&st!==null?st=Fa(st):(st=ia(x)?sl:Qs.current,st=Cl(o,st));var on=x.getDerivedStateFromProps;(Vr=typeof on=="function"||typeof oe.getSnapshotBeforeUpdate=="function")||typeof oe.UNSAFE_componentWillReceiveProps!="function"&&typeof oe.componentWillReceiveProps!="function"||(Be!==$r||Ur!==st)&&rp(o,oe,F,st),ql=!1,Ur=o.memoizedState,oe.state=Ur,Yd(o,F,oe,U);var xn=o.memoizedState;Be!==$r||Ur!==xn||ca.current||ql?(typeof on=="function"&&(sf(o,x,on,F),xn=o.memoizedState),(Vt=ql||ep(o,x,Vt,F,Ur,xn,st)||!1)?(Vr||typeof oe.UNSAFE_componentWillUpdate!="function"&&typeof oe.componentWillUpdate!="function"||(typeof oe.componentWillUpdate=="function"&&oe.componentWillUpdate(F,xn,st),typeof oe.UNSAFE_componentWillUpdate=="function"&&oe.UNSAFE_componentWillUpdate(F,xn,st)),typeof oe.componentDidUpdate=="function"&&(o.flags|=4),typeof oe.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof oe.componentDidUpdate!="function"||Be===n.memoizedProps&&Ur===n.memoizedState||(o.flags|=4),typeof oe.getSnapshotBeforeUpdate!="function"||Be===n.memoizedProps&&Ur===n.memoizedState||(o.flags|=1024),o.memoizedProps=F,o.memoizedState=xn),oe.props=F,oe.state=xn,oe.context=st,F=Vt):(typeof oe.componentDidUpdate!="function"||Be===n.memoizedProps&&Ur===n.memoizedState||(o.flags|=4),typeof oe.getSnapshotBeforeUpdate!="function"||Be===n.memoizedProps&&Ur===n.memoizedState||(o.flags|=1024),F=!1)}return wf(n,o,x,F,J,U)}function wf(n,o,x,F,U,J){Lp(n,o);var oe=(o.flags&128)!==0;if(!F&&!oe)return U&&Qu(o,x,!1),Rl(n,o,J);F=o.stateNode,Tm.current=o;var Be=oe&&typeof x.getDerivedStateFromError!="function"?null:F.render();return o.flags|=1,n!==null&&oe?(o.child=lu(o,n.child,null,J),o.child=lu(o,null,Be,J)):_a(n,o,Be,J),o.memoizedState=F.state,U&&Qu(o,x,!0),o.child}function Bp(n){var o=n.stateNode;o.pendingContext?Zu(n,o.pendingContext,o.pendingContext!==o.context):o.context&&Zu(n,o.context,!1),af(n,o.containerInfo)}function jp(n,o,x,F,U){return wa(),iu(U),o.flags|=256,_a(n,o,x,F),o.child}var Sf={dehydrated:null,treeContext:null,retryLane:0};function Ef(n){return{baseLanes:n,cachePool:null,transitions:null}}function Gp(n,o,x){var F=o.pendingProps,U=Ss.current,J=!1,oe=(o.flags&128)!==0,Be;if((Be=oe)||(Be=n!==null&&n.memoizedState===null?!1:(U&2)!==0),Be?(J=!0,o.flags&=-129):(n===null||n.memoizedState!==null)&&(U|=1),pi(Ss,U&1),n===null)return ci(o),n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((o.mode&1)===0?o.lanes=1:n.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(oe=F.children,n=F.fallback,J?(F=o.mode,J=o.child,oe={mode:"hidden",children:oe},(F&1)===0&&J!==null?(J.childLanes=0,J.pendingProps=oe):J=mh(oe,F,0,null),n=Rc(n,F,x,null),J.return=o,n.return=o,J.sibling=n,o.child=J,o.child.memoizedState=Ef(x),o.memoizedState=Sf,n):Cf(o,oe));if(U=n.memoizedState,U!==null&&(Be=U.dehydrated,Be!==null))return Rm(n,o,oe,F,Be,U,x);if(J){J=F.fallback,oe=o.mode,U=n.child,Be=U.sibling;var st={mode:"hidden",children:F.children};return(oe&1)===0&&o.child!==U?(F=o.child,F.childLanes=0,F.pendingProps=st,o.deletions=null):(F=tc(U,st),F.subtreeFlags=U.subtreeFlags&14680064),Be!==null?J=tc(Be,J):(J=Rc(J,oe,x,null),J.flags|=2),J.return=o,F.return=o,F.sibling=J,o.child=F,F=J,J=o.child,oe=n.child.memoizedState,oe=oe===null?Ef(x):{baseLanes:oe.baseLanes|x,cachePool:null,transitions:oe.transitions},J.memoizedState=oe,J.childLanes=n.childLanes&~x,o.memoizedState=Sf,F}return J=n.child,n=J.sibling,F=tc(J,{mode:"visible",children:F.children}),(o.mode&1)===0&&(F.lanes=x),F.return=o,F.sibling=null,n!==null&&(x=o.deletions,x===null?(o.deletions=[n],o.flags|=16):x.push(n)),o.child=F,o.memoizedState=null,F}function Cf(n,o){return o=mh({mode:"visible",children:o},n.mode,0,null),o.return=n,n.child=o}function rh(n,o,x,F){return F!==null&&iu(F),lu(o,n.child,null,x),n=Cf(o,o.pendingProps.children),n.flags|=2,o.memoizedState=null,n}function Rm(n,o,x,F,U,J,oe){if(x)return o.flags&256?(o.flags&=-257,F=_f(Error(t(422))),rh(n,o,oe,F)):o.memoizedState!==null?(o.child=n.child,o.flags|=128,null):(J=F.fallback,U=o.mode,F=mh({mode:"visible",children:F.children},U,0,null),J=Rc(J,U,oe,null),J.flags|=2,F.return=o,J.return=o,F.sibling=J,o.child=F,(o.mode&1)!==0&&lu(o,n.child,null,oe),o.child.memoizedState=Ef(oe),o.memoizedState=Sf,J);if((o.mode&1)===0)return rh(n,o,oe,null);if(U.data==="$!"){if(F=U.nextSibling&&U.nextSibling.dataset,F)var Be=F.dgst;return F=Be,J=Error(t(419)),F=_f(J,F,void 0),rh(n,o,oe,F)}if(Be=(oe&n.childLanes)!==0,Sa||Be){if(F=ta,F!==null){switch(oe&-oe){case 4:U=2;break;case 16:U=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:U=32;break;case 536870912:U=268435456;break;default:U=0}U=(U&(F.suspendedLanes|oe))!==0?0:U,U!==0&&U!==J.retryLane&&(J.retryLane=U,Al(n,U),Ya(F,n,U,-1))}return Gf(),F=_f(Error(t(421))),rh(n,o,oe,F)}return U.data==="$?"?(o.flags|=128,o.child=n.child,o=Gm.bind(null,n),U._reactRetry=o,null):(n=J.treeContext,Cn=Ia(U.nextSibling),An=o,Hr=!0,Tn=null,n!==null&&(sn[nt++]=jn,sn[nt++]=Yr,sn[nt++]=xt,jn=n.id,Yr=n.overflow,xt=o),o=Cf(o,F.children),o.flags|=4096,o)}function Up(n,o,x){n.lanes|=o;var F=n.alternate;F!==null&&(F.lanes|=o),tf(n.return,o,x)}function Af(n,o,x,F,U){var J=n.memoizedState;J===null?n.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:F,tail:x,tailMode:U}:(J.isBackwards=o,J.rendering=null,J.renderingStartTime=0,J.last=F,J.tail=x,J.tailMode=U)}function Vp(n,o,x){var F=o.pendingProps,U=F.revealOrder,J=F.tail;if(_a(n,o,F.children,x),F=Ss.current,(F&2)!==0)F=F&1|2,o.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=o.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Up(n,x,o);else if(n.tag===19)Up(n,x,o);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===o)break e;for(;n.sibling===null;){if(n.return===null||n.return===o)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}F&=1}if(pi(Ss,F),(o.mode&1)===0)o.memoizedState=null;else switch(U){case"forwards":for(x=o.child,U=null;x!==null;)n=x.alternate,n!==null&&Zd(n)===null&&(U=x),x=x.sibling;x=U,x===null?(U=o.child,o.child=null):(U=x.sibling,x.sibling=null),Af(o,!1,U,x,J);break;case"backwards":for(x=null,U=o.child,o.child=null;U!==null;){if(n=U.alternate,n!==null&&Zd(n)===null){o.child=U;break}n=U.sibling,U.sibling=x,x=U,U=n}Af(o,!0,x,null,J);break;case"together":Af(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function nh(n,o){(o.mode&1)===0&&n!==null&&(n.alternate=null,o.alternate=null,o.flags|=2)}function Rl(n,o,x){if(n!==null&&(o.dependencies=n.dependencies),Ec|=o.lanes,(x&o.childLanes)===0)return null;if(n!==null&&o.child!==n.child)throw Error(t(153));if(o.child!==null){for(n=o.child,x=tc(n,n.pendingProps),o.child=x,x.return=o;n.sibling!==null;)n=n.sibling,x=x.sibling=tc(n,n.pendingProps),x.return=o;x.sibling=null}return o.child}function km(n,o,x){switch(o.tag){case 3:Bp(o),wa();break;case 5:op(o);break;case 1:ia(o.type)&&xc(o);break;case 4:af(o,o.stateNode.containerInfo);break;case 10:var F=o.type._context,U=o.memoizedProps.value;pi(Wd,F._currentValue),F._currentValue=U;break;case 13:if(F=o.memoizedState,F!==null)return F.dehydrated!==null?(pi(Ss,Ss.current&1),o.flags|=128,null):(x&o.child.childLanes)!==0?Gp(n,o,x):(pi(Ss,Ss.current&1),n=Rl(n,o,x),n!==null?n.sibling:null);pi(Ss,Ss.current&1);break;case 19:if(F=(x&o.childLanes)!==0,(n.flags&128)!==0){if(F)return Vp(n,o,x);o.flags|=128}if(U=o.memoizedState,U!==null&&(U.rendering=null,U.tail=null,U.lastEffect=null),pi(Ss,Ss.current),F)break;return null;case 22:case 23:return o.lanes=0,Fp(n,o,x)}return Rl(n,o,x)}var Wp,Tf,Hp,$p;Wp=function(n,o){for(var x=o.child;x!==null;){if(x.tag===5||x.tag===6)n.appendChild(x.stateNode);else if(x.tag!==4&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===o)break;for(;x.sibling===null;){if(x.return===null||x.return===o)return;x=x.return}x.sibling.return=x.return,x=x.sibling}},Tf=function(){},Hp=function(n,o,x,F){var U=n.memoizedProps;if(U!==F){n=o.stateNode,wc(ol.current);var J=null;switch(x){case"input":U=Le(n,U),F=Le(n,F),J=[];break;case"select":U=G({},U,{value:void 0}),F=G({},F,{value:void 0}),J=[];break;case"textarea":U=Nr(n,U),F=Nr(n,F),J=[];break;default:typeof U.onClick!="function"&&typeof F.onClick=="function"&&(n.onclick=eu)}lt(x,F);var oe;x=null;for(Vt in U)if(!F.hasOwnProperty(Vt)&&U.hasOwnProperty(Vt)&&U[Vt]!=null)if(Vt==="style"){var Be=U[Vt];for(oe in Be)Be.hasOwnProperty(oe)&&(x||(x={}),x[oe]="")}else Vt!=="dangerouslySetInnerHTML"&&Vt!=="children"&&Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&Vt!=="autoFocus"&&(c.hasOwnProperty(Vt)?J||(J=[]):(J=J||[]).push(Vt,null));for(Vt in F){var st=F[Vt];if(Be=U?.[Vt],F.hasOwnProperty(Vt)&&st!==Be&&(st!=null||Be!=null))if(Vt==="style")if(Be){for(oe in Be)!Be.hasOwnProperty(oe)||st&&st.hasOwnProperty(oe)||(x||(x={}),x[oe]="");for(oe in st)st.hasOwnProperty(oe)&&Be[oe]!==st[oe]&&(x||(x={}),x[oe]=st[oe])}else x||(J||(J=[]),J.push(Vt,x)),x=st;else Vt==="dangerouslySetInnerHTML"?(st=st?st.__html:void 0,Be=Be?Be.__html:void 0,st!=null&&Be!==st&&(J=J||[]).push(Vt,st)):Vt==="children"?typeof st!="string"&&typeof st!="number"||(J=J||[]).push(Vt,""+st):Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&(c.hasOwnProperty(Vt)?(st!=null&&Vt==="onScroll"&&hi("scroll",n),J||Be===st||(J=[])):(J=J||[]).push(Vt,st))}x&&(J=J||[]).push("style",x);var Vt=J;(o.updateQueue=Vt)&&(o.flags|=4)}},$p=function(n,o,x,F){x!==F&&(o.flags|=4)};function ld(n,o){if(!Hr)switch(n.tailMode){case"hidden":o=n.tail;for(var x=null;o!==null;)o.alternate!==null&&(x=o),o=o.sibling;x===null?n.tail=null:x.sibling=null;break;case"collapsed":x=n.tail;for(var F=null;x!==null;)x.alternate!==null&&(F=x),x=x.sibling;F===null?o||n.tail===null?n.tail=null:n.tail.sibling=null:F.sibling=null}}function ha(n){var o=n.alternate!==null&&n.alternate.child===n.child,x=0,F=0;if(o)for(var U=n.child;U!==null;)x|=U.lanes|U.childLanes,F|=U.subtreeFlags&14680064,F|=U.flags&14680064,U.return=n,U=U.sibling;else for(U=n.child;U!==null;)x|=U.lanes|U.childLanes,F|=U.subtreeFlags,F|=U.flags,U.return=n,U=U.sibling;return n.subtreeFlags|=F,n.childLanes=x,o}function Mm(n,o,x){var F=o.pendingProps;switch(ni(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ha(o),null;case 1:return ia(o.type)&&_c(),ha(o),null;case 3:return F=o.stateNode,cu(),vi(ca),vi(Qs),uf(),F.pendingContext&&(F.context=F.pendingContext,F.pendingContext=null),(n===null||n.child===null)&&(Ln(o)?o.flags|=4:n===null||n.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Tn!==null&&(Df(Tn),Tn=null))),Tf(n,o),ha(o),null;case 5:lf(o);var U=wc(rd.current);if(x=o.type,n!==null&&o.stateNode!=null)Hp(n,o,x,F,U),n.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!F){if(o.stateNode===null)throw Error(t(166));return ha(o),null}if(n=wc(ol.current),Ln(o)){F=o.stateNode,x=o.type;var J=o.memoizedProps;switch(F[Ma]=o,F[gc]=J,n=(o.mode&1)!==0,x){case"dialog":hi("cancel",F),hi("close",F);break;case"iframe":case"object":case"embed":hi("load",F);break;case"video":case"audio":for(U=0;U<Vl.length;U++)hi(Vl[U],F);break;case"source":hi("error",F);break;case"img":case"image":case"link":hi("error",F),hi("load",F);break;case"details":hi("toggle",F);break;case"input":ht(F,J),hi("invalid",F);break;case"select":F._wrapperState={wasMultiple:!!J.multiple},hi("invalid",F);break;case"textarea":At(F,J),hi("invalid",F)}lt(x,J),U=null;for(var oe in J)if(J.hasOwnProperty(oe)){var Be=J[oe];oe==="children"?typeof Be=="string"?F.textContent!==Be&&(J.suppressHydrationWarning!==!0&&Kc(F.textContent,Be,n),U=["children",Be]):typeof Be=="number"&&F.textContent!==""+Be&&(J.suppressHydrationWarning!==!0&&Kc(F.textContent,Be,n),U=["children",""+Be]):c.hasOwnProperty(oe)&&Be!=null&&oe==="onScroll"&&hi("scroll",F)}switch(x){case"input":jt(F),Wt(F,J,!0);break;case"textarea":jt(F),Jr(F);break;case"select":case"option":break;default:typeof J.onClick=="function"&&(F.onclick=eu)}F=U,o.updateQueue=F,F!==null&&(o.flags|=4)}else{oe=U.nodeType===9?U:U.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=qr(x)),n==="http://www.w3.org/1999/xhtml"?x==="script"?(n=oe.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof F.is=="string"?n=oe.createElement(x,{is:F.is}):(n=oe.createElement(x),x==="select"&&(oe=n,F.multiple?oe.multiple=!0:F.size&&(oe.size=F.size))):n=oe.createElementNS(n,x),n[Ma]=o,n[gc]=F,Wp(n,o,!1,!1),o.stateNode=n;e:{switch(oe=cr(x,F),x){case"dialog":hi("cancel",n),hi("close",n),U=F;break;case"iframe":case"object":case"embed":hi("load",n),U=F;break;case"video":case"audio":for(U=0;U<Vl.length;U++)hi(Vl[U],n);U=F;break;case"source":hi("error",n),U=F;break;case"img":case"image":case"link":hi("error",n),hi("load",n),U=F;break;case"details":hi("toggle",n),U=F;break;case"input":ht(n,F),U=Le(n,F),hi("invalid",n);break;case"option":U=F;break;case"select":n._wrapperState={wasMultiple:!!F.multiple},U=G({},F,{value:void 0}),hi("invalid",n);break;case"textarea":At(n,F),U=Nr(n,F),hi("invalid",n);break;default:U=F}lt(x,U),Be=U;for(J in Be)if(Be.hasOwnProperty(J)){var st=Be[J];J==="style"?re(n,st):J==="dangerouslySetInnerHTML"?(st=st?st.__html:void 0,st!=null&&we(n,st)):J==="children"?typeof st=="string"?(x!=="textarea"||st!=="")&&it(n,st):typeof st=="number"&&it(n,""+st):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(c.hasOwnProperty(J)?st!=null&&J==="onScroll"&&hi("scroll",n):st!=null&&S(n,J,st,oe))}switch(x){case"input":jt(n),Wt(n,F,!1);break;case"textarea":jt(n),Jr(n);break;case"option":F.value!=null&&n.setAttribute("value",""+Me(F.value));break;case"select":n.multiple=!!F.multiple,J=F.value,J!=null?zr(n,!!F.multiple,J,!1):F.defaultValue!=null&&zr(n,!!F.multiple,F.defaultValue,!0);break;default:typeof U.onClick=="function"&&(n.onclick=eu)}switch(x){case"button":case"input":case"select":case"textarea":F=!!F.autoFocus;break e;case"img":F=!0;break e;default:F=!1}}F&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return ha(o),null;case 6:if(n&&o.stateNode!=null)$p(n,o,n.memoizedProps,F);else{if(typeof F!="string"&&o.stateNode===null)throw Error(t(166));if(x=wc(rd.current),wc(ol.current),Ln(o)){if(F=o.stateNode,x=o.memoizedProps,F[Ma]=o,(J=F.nodeValue!==x)&&(n=An,n!==null))switch(n.tag){case 3:Kc(F.nodeValue,x,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Kc(F.nodeValue,x,(n.mode&1)!==0)}J&&(o.flags|=4)}else F=(x.nodeType===9?x:x.ownerDocument).createTextNode(F),F[Ma]=o,o.stateNode=F}return ha(o),null;case 13:if(vi(Ss),F=o.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Hr&&Cn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Ks(),wa(),o.flags|=98560,J=!1;else if(J=Ln(o),F!==null&&F.dehydrated!==null){if(n===null){if(!J)throw Error(t(318));if(J=o.memoizedState,J=J!==null?J.dehydrated:null,!J)throw Error(t(317));J[Ma]=o}else wa(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ha(o),J=!1}else Tn!==null&&(Df(Tn),Tn=null),J=!0;if(!J)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=x,o):(F=F!==null,F!==(n!==null&&n.memoizedState!==null)&&F&&(o.child.flags|=8192,(o.mode&1)!==0&&(n===null||(Ss.current&1)!==0?Xs===0&&(Xs=3):Gf())),o.updateQueue!==null&&(o.flags|=4),ha(o),null);case 4:return cu(),Tf(n,o),n===null&&pc(o.stateNode.containerInfo),ha(o),null;case 10:return ef(o.type._context),ha(o),null;case 17:return ia(o.type)&&_c(),ha(o),null;case 19:if(vi(Ss),J=o.memoizedState,J===null)return ha(o),null;if(F=(o.flags&128)!==0,oe=J.rendering,oe===null)if(F)ld(J,!1);else{if(Xs!==0||n!==null&&(n.flags&128)!==0)for(n=o.child;n!==null;){if(oe=Zd(n),oe!==null){for(o.flags|=128,ld(J,!1),F=oe.updateQueue,F!==null&&(o.updateQueue=F,o.flags|=4),o.subtreeFlags=0,F=x,x=o.child;x!==null;)J=x,n=F,J.flags&=14680066,oe=J.alternate,oe===null?(J.childLanes=0,J.lanes=n,J.child=null,J.subtreeFlags=0,J.memoizedProps=null,J.memoizedState=null,J.updateQueue=null,J.dependencies=null,J.stateNode=null):(J.childLanes=oe.childLanes,J.lanes=oe.lanes,J.child=oe.child,J.subtreeFlags=0,J.deletions=null,J.memoizedProps=oe.memoizedProps,J.memoizedState=oe.memoizedState,J.updateQueue=oe.updateQueue,J.type=oe.type,n=oe.dependencies,J.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),x=x.sibling;return pi(Ss,Ss.current&1|2),o.child}n=n.sibling}J.tail!==null&&fi()>fu&&(o.flags|=128,F=!0,ld(J,!1),o.lanes=4194304)}else{if(!F)if(n=Zd(oe),n!==null){if(o.flags|=128,F=!0,x=n.updateQueue,x!==null&&(o.updateQueue=x,o.flags|=4),ld(J,!0),J.tail===null&&J.tailMode==="hidden"&&!oe.alternate&&!Hr)return ha(o),null}else 2*fi()-J.renderingStartTime>fu&&x!==1073741824&&(o.flags|=128,F=!0,ld(J,!1),o.lanes=4194304);J.isBackwards?(oe.sibling=o.child,o.child=oe):(x=J.last,x!==null?x.sibling=oe:o.child=oe,J.last=oe)}return J.tail!==null?(o=J.tail,J.rendering=o,J.tail=o.sibling,J.renderingStartTime=fi(),o.sibling=null,x=Ss.current,pi(Ss,F?x&1|2:x&1),o):(ha(o),null);case 22:case 23:return jf(),F=o.memoizedState!==null,n!==null&&n.memoizedState!==null!==F&&(o.flags|=8192),F&&(o.mode&1)!==0?(za&1073741824)!==0&&(ha(o),o.subtreeFlags&6&&(o.flags|=8192)):ha(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function zm(n,o){switch(ni(o),o.tag){case 1:return ia(o.type)&&_c(),n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 3:return cu(),vi(ca),vi(Qs),uf(),n=o.flags,(n&65536)!==0&&(n&128)===0?(o.flags=n&-65537|128,o):null;case 5:return lf(o),null;case 13:if(vi(Ss),n=o.memoizedState,n!==null&&n.dehydrated!==null){if(o.alternate===null)throw Error(t(340));wa()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 19:return vi(Ss),null;case 4:return cu(),null;case 10:return ef(o.type._context),null;case 22:case 23:return jf(),null;case 24:return null;default:return null}}var ih=!1,fa=!1,Nm=typeof WeakSet=="function"?WeakSet:Set,an=null;function du(n,o){var x=n.ref;if(x!==null)if(typeof x=="function")try{x(null)}catch(F){Ns(n,o,F)}else x.current=null}function Rf(n,o,x){try{x()}catch(F){Ns(n,o,F)}}var Yp=!1;function Pm(n,o){if(Hu=Pc,n=Fu(),Hc(n)){if("selectionStart"in n)var x={start:n.selectionStart,end:n.selectionEnd};else e:{x=(x=n.ownerDocument)&&x.defaultView||window;var F=x.getSelection&&x.getSelection();if(F&&F.rangeCount!==0){x=F.anchorNode;var U=F.anchorOffset,J=F.focusNode;F=F.focusOffset;try{x.nodeType,J.nodeType}catch{x=null;break e}var oe=0,Be=-1,st=-1,Vt=0,Vr=0,$r=n,Ur=null;t:for(;;){for(var on;$r!==x||U!==0&&$r.nodeType!==3||(Be=oe+U),$r!==J||F!==0&&$r.nodeType!==3||(st=oe+F),$r.nodeType===3&&(oe+=$r.nodeValue.length),(on=$r.firstChild)!==null;)Ur=$r,$r=on;for(;;){if($r===n)break t;if(Ur===x&&++Vt===U&&(Be=oe),Ur===J&&++Vr===F&&(st=oe),(on=$r.nextSibling)!==null)break;$r=Ur,Ur=$r.parentNode}$r=on}x=Be===-1||st===-1?null:{start:Be,end:st}}else x=null}x=x||{start:0,end:0}}else x=null;for($u={focusedElem:n,selectionRange:x},Pc=!1,an=o;an!==null;)if(o=an,n=o.child,(o.subtreeFlags&1028)!==0&&n!==null)n.return=o,an=n;else for(;an!==null;){o=an;try{var xn=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(xn!==null){var wn=xn.memoizedProps,Us=xn.memoizedState,St=o.stateNode,ot=St.getSnapshotBeforeUpdate(o.elementType===o.type?wn:ua(o.type,wn),Us);St.__reactInternalSnapshotBeforeUpdate=ot}break;case 3:var Tt=o.stateNode.containerInfo;Tt.nodeType===1?Tt.textContent="":Tt.nodeType===9&&Tt.documentElement&&Tt.removeChild(Tt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Xr){Ns(o,o.return,Xr)}if(n=o.sibling,n!==null){n.return=o.return,an=n;break}an=o.return}return xn=Yp,Yp=!1,xn}function cd(n,o,x){var F=o.updateQueue;if(F=F!==null?F.lastEffect:null,F!==null){var U=F=F.next;do{if((U.tag&n)===n){var J=U.destroy;U.destroy=void 0,J!==void 0&&Rf(o,x,J)}U=U.next}while(U!==F)}}function sh(n,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var x=o=o.next;do{if((x.tag&n)===n){var F=x.create;x.destroy=F()}x=x.next}while(x!==o)}}function kf(n){var o=n.ref;if(o!==null){var x=n.stateNode;switch(n.tag){case 5:n=x;break;default:n=x}typeof o=="function"?o(n):o.current=n}}function qp(n){var o=n.alternate;o!==null&&(n.alternate=null,qp(o)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(o=n.stateNode,o!==null&&(delete o[Ma],delete o[gc],delete o[vc],delete o[Zh],delete o[Jh])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Xp(n){return n.tag===5||n.tag===3||n.tag===4}function Zp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Xp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Mf(n,o,x){var F=n.tag;if(F===5||F===6)n=n.stateNode,o?x.nodeType===8?x.parentNode.insertBefore(n,o):x.insertBefore(n,o):(x.nodeType===8?(o=x.parentNode,o.insertBefore(n,x)):(o=x,o.appendChild(n)),x=x._reactRootContainer,x!=null||o.onclick!==null||(o.onclick=eu));else if(F!==4&&(n=n.child,n!==null))for(Mf(n,o,x),n=n.sibling;n!==null;)Mf(n,o,x),n=n.sibling}function zf(n,o,x){var F=n.tag;if(F===5||F===6)n=n.stateNode,o?x.insertBefore(n,o):x.appendChild(n);else if(F!==4&&(n=n.child,n!==null))for(zf(n,o,x),n=n.sibling;n!==null;)zf(n,o,x),n=n.sibling}var sa=null,Ha=!1;function Zl(n,o,x){for(x=x.child;x!==null;)Jp(n,o,x),x=x.sibling}function Jp(n,o,x){if(Hs&&typeof Hs.onCommitFiberUnmount=="function")try{Hs.onCommitFiberUnmount(Ml,x)}catch{}switch(x.tag){case 5:fa||du(x,o);case 6:var F=sa,U=Ha;sa=null,Zl(n,o,x),sa=F,Ha=U,sa!==null&&(Ha?(n=sa,x=x.stateNode,n.nodeType===8?n.parentNode.removeChild(x):n.removeChild(x)):sa.removeChild(x.stateNode));break;case 18:sa!==null&&(Ha?(n=sa,x=x.stateNode,n.nodeType===8?Sl(n.parentNode,x):n.nodeType===1&&Sl(n,x),sc(n)):Sl(sa,x.stateNode));break;case 4:F=sa,U=Ha,sa=x.stateNode.containerInfo,Ha=!0,Zl(n,o,x),sa=F,Ha=U;break;case 0:case 11:case 14:case 15:if(!fa&&(F=x.updateQueue,F!==null&&(F=F.lastEffect,F!==null))){U=F=F.next;do{var J=U,oe=J.destroy;J=J.tag,oe!==void 0&&((J&2)!==0||(J&4)!==0)&&Rf(x,o,oe),U=U.next}while(U!==F)}Zl(n,o,x);break;case 1:if(!fa&&(du(x,o),F=x.stateNode,typeof F.componentWillUnmount=="function"))try{F.props=x.memoizedProps,F.state=x.memoizedState,F.componentWillUnmount()}catch(Be){Ns(x,o,Be)}Zl(n,o,x);break;case 21:Zl(n,o,x);break;case 22:x.mode&1?(fa=(F=fa)||x.memoizedState!==null,Zl(n,o,x),fa=F):Zl(n,o,x);break;default:Zl(n,o,x)}}function Qp(n){var o=n.updateQueue;if(o!==null){n.updateQueue=null;var x=n.stateNode;x===null&&(x=n.stateNode=new Nm),o.forEach(function(F){var U=Um.bind(null,n,F);x.has(F)||(x.add(F),F.then(U,U))})}}function $a(n,o){var x=o.deletions;if(x!==null)for(var F=0;F<x.length;F++){var U=x[F];try{var J=n,oe=o,Be=oe;e:for(;Be!==null;){switch(Be.tag){case 5:sa=Be.stateNode,Ha=!1;break e;case 3:sa=Be.stateNode.containerInfo,Ha=!0;break e;case 4:sa=Be.stateNode.containerInfo,Ha=!0;break e}Be=Be.return}if(sa===null)throw Error(t(160));Jp(J,oe,U),sa=null,Ha=!1;var st=U.alternate;st!==null&&(st.return=null),U.return=null}catch(Vt){Ns(U,o,Vt)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Kp(o,n),o=o.sibling}function Kp(n,o){var x=n.alternate,F=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if($a(o,n),ll(n),F&4){try{cd(3,n,n.return),sh(3,n)}catch(wn){Ns(n,n.return,wn)}try{cd(5,n,n.return)}catch(wn){Ns(n,n.return,wn)}}break;case 1:$a(o,n),ll(n),F&512&&x!==null&&du(x,x.return);break;case 5:if($a(o,n),ll(n),F&512&&x!==null&&du(x,x.return),n.flags&32){var U=n.stateNode;try{it(U,"")}catch(wn){Ns(n,n.return,wn)}}if(F&4&&(U=n.stateNode,U!=null)){var J=n.memoizedProps,oe=x!==null?x.memoizedProps:J,Be=n.type,st=n.updateQueue;if(n.updateQueue=null,st!==null)try{Be==="input"&&J.type==="radio"&&J.name!=null&&ar(U,J),cr(Be,oe);var Vt=cr(Be,J);for(oe=0;oe<st.length;oe+=2){var Vr=st[oe],$r=st[oe+1];Vr==="style"?re(U,$r):Vr==="dangerouslySetInnerHTML"?we(U,$r):Vr==="children"?it(U,$r):S(U,Vr,$r,Vt)}switch(Be){case"input":Jt(U,J);break;case"textarea":Mt(U,J);break;case"select":var Ur=U._wrapperState.wasMultiple;U._wrapperState.wasMultiple=!!J.multiple;var on=J.value;on!=null?zr(U,!!J.multiple,on,!1):Ur!==!!J.multiple&&(J.defaultValue!=null?zr(U,!!J.multiple,J.defaultValue,!0):zr(U,!!J.multiple,J.multiple?[]:"",!1))}U[gc]=J}catch(wn){Ns(n,n.return,wn)}}break;case 6:if($a(o,n),ll(n),F&4){if(n.stateNode===null)throw Error(t(162));U=n.stateNode,J=n.memoizedProps;try{U.nodeValue=J}catch(wn){Ns(n,n.return,wn)}}break;case 3:if($a(o,n),ll(n),F&4&&x!==null&&x.memoizedState.isDehydrated)try{sc(o.containerInfo)}catch(wn){Ns(n,n.return,wn)}break;case 4:$a(o,n),ll(n);break;case 13:$a(o,n),ll(n),U=n.child,U.flags&8192&&(J=U.memoizedState!==null,U.stateNode.isHidden=J,!J||U.alternate!==null&&U.alternate.memoizedState!==null||(If=fi())),F&4&&Qp(n);break;case 22:if(Vr=x!==null&&x.memoizedState!==null,n.mode&1?(fa=(Vt=fa)||Vr,$a(o,n),fa=Vt):$a(o,n),ll(n),F&8192){if(Vt=n.memoizedState!==null,(n.stateNode.isHidden=Vt)&&!Vr&&(n.mode&1)!==0)for(an=n,Vr=n.child;Vr!==null;){for($r=an=Vr;an!==null;){switch(Ur=an,on=Ur.child,Ur.tag){case 0:case 11:case 14:case 15:cd(4,Ur,Ur.return);break;case 1:du(Ur,Ur.return);var xn=Ur.stateNode;if(typeof xn.componentWillUnmount=="function"){F=Ur,x=Ur.return;try{o=F,xn.props=o.memoizedProps,xn.state=o.memoizedState,xn.componentWillUnmount()}catch(wn){Ns(F,x,wn)}}break;case 5:du(Ur,Ur.return);break;case 22:if(Ur.memoizedState!==null){rm($r);continue}}on!==null?(on.return=Ur,an=on):rm($r)}Vr=Vr.sibling}e:for(Vr=null,$r=n;;){if($r.tag===5){if(Vr===null){Vr=$r;try{U=$r.stateNode,Vt?(J=U.style,typeof J.setProperty=="function"?J.setProperty("display","none","important"):J.display="none"):(Be=$r.stateNode,st=$r.memoizedProps.style,oe=st!=null&&st.hasOwnProperty("display")?st.display:null,Be.style.display=Ot("display",oe))}catch(wn){Ns(n,n.return,wn)}}}else if($r.tag===6){if(Vr===null)try{$r.stateNode.nodeValue=Vt?"":$r.memoizedProps}catch(wn){Ns(n,n.return,wn)}}else if(($r.tag!==22&&$r.tag!==23||$r.memoizedState===null||$r===n)&&$r.child!==null){$r.child.return=$r,$r=$r.child;continue}if($r===n)break e;for(;$r.sibling===null;){if($r.return===null||$r.return===n)break e;Vr===$r&&(Vr=null),$r=$r.return}Vr===$r&&(Vr=null),$r.sibling.return=$r.return,$r=$r.sibling}}break;case 19:$a(o,n),ll(n),F&4&&Qp(n);break;case 21:break;default:$a(o,n),ll(n)}}function ll(n){var o=n.flags;if(o&2){try{e:{for(var x=n.return;x!==null;){if(Xp(x)){var F=x;break e}x=x.return}throw Error(t(160))}switch(F.tag){case 5:var U=F.stateNode;F.flags&32&&(it(U,""),F.flags&=-33);var J=Zp(n);zf(n,J,U);break;case 3:case 4:var oe=F.stateNode.containerInfo,Be=Zp(n);Mf(n,Be,oe);break;default:throw Error(t(161))}}catch(st){Ns(n,n.return,st)}n.flags&=-3}o&4096&&(n.flags&=-4097)}function Im(n,o,x){an=n,em(n)}function em(n,o,x){for(var F=(n.mode&1)!==0;an!==null;){var U=an,J=U.child;if(U.tag===22&&F){var oe=U.memoizedState!==null||ih;if(!oe){var Be=U.alternate,st=Be!==null&&Be.memoizedState!==null||fa;Be=ih;var Vt=fa;if(ih=oe,(fa=st)&&!Vt)for(an=U;an!==null;)oe=an,st=oe.child,oe.tag===22&&oe.memoizedState!==null?nm(U):st!==null?(st.return=oe,an=st):nm(U);for(;J!==null;)an=J,em(J),J=J.sibling;an=U,ih=Be,fa=Vt}tm(n)}else(U.subtreeFlags&8772)!==0&&J!==null?(J.return=U,an=J):tm(n)}}function tm(n){for(;an!==null;){var o=an;if((o.flags&8772)!==0){var x=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:fa||sh(5,o);break;case 1:var F=o.stateNode;if(o.flags&4&&!fa)if(x===null)F.componentDidMount();else{var U=o.elementType===o.type?x.memoizedProps:ua(o.type,x.memoizedProps);F.componentDidUpdate(U,x.memoizedState,F.__reactInternalSnapshotBeforeUpdate)}var J=o.updateQueue;J!==null&&Qf(o,J,F);break;case 3:var oe=o.updateQueue;if(oe!==null){if(x=null,o.child!==null)switch(o.child.tag){case 5:x=o.child.stateNode;break;case 1:x=o.child.stateNode}Qf(o,oe,x)}break;case 5:var Be=o.stateNode;if(x===null&&o.flags&4){x=Be;var st=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":st.autoFocus&&x.focus();break;case"img":st.src&&(x.src=st.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Vt=o.alternate;if(Vt!==null){var Vr=Vt.memoizedState;if(Vr!==null){var $r=Vr.dehydrated;$r!==null&&sc($r)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}fa||o.flags&512&&kf(o)}catch(Ur){Ns(o,o.return,Ur)}}if(o===n){an=null;break}if(x=o.sibling,x!==null){x.return=o.return,an=x;break}an=o.return}}function rm(n){for(;an!==null;){var o=an;if(o===n){an=null;break}var x=o.sibling;if(x!==null){x.return=o.return,an=x;break}an=o.return}}function nm(n){for(;an!==null;){var o=an;try{switch(o.tag){case 0:case 11:case 15:var x=o.return;try{sh(4,o)}catch(st){Ns(o,x,st)}break;case 1:var F=o.stateNode;if(typeof F.componentDidMount=="function"){var U=o.return;try{F.componentDidMount()}catch(st){Ns(o,U,st)}}var J=o.return;try{kf(o)}catch(st){Ns(o,J,st)}break;case 5:var oe=o.return;try{kf(o)}catch(st){Ns(o,oe,st)}}}catch(st){Ns(o,o.return,st)}if(o===n){an=null;break}var Be=o.sibling;if(Be!==null){Be.return=o.return,an=Be;break}an=o.return}}var Om=Math.ceil,oh=A.ReactCurrentDispatcher,Nf=A.ReactCurrentOwner,Da=A.ReactCurrentBatchConfig,oi=0,ta=null,Ws=null,oa=0,za=0,hu=nl(0),Xs=0,ud=null,Ec=0,ah=0,Pf=0,dd=null,Ea=null,If=0,fu=1/0,kl=null,lh=!1,Of=null,Jl=null,ch=!1,Ql=null,uh=0,hd=0,Ff=null,dh=-1,hh=0;function xa(){return(oi&6)!==0?fi():dh!==-1?dh:dh=fi()}function Kl(n){return(n.mode&1)===0?1:(oi&2)!==0&&oa!==0?oa&-oa:su.transition!==null?(hh===0&&(hh=Za()),hh):(n=Fn,n!==0||(n=window.event,n=n===void 0?16:vd(n.type)),n)}function Ya(n,o,x,F){if(50<hd)throw hd=0,Ff=null,Error(t(185));ba(n,x,F),((oi&2)===0||n!==ta)&&(n===ta&&((oi&2)===0&&(ah|=x),Xs===4&&ec(n,oa)),Ca(n,F),x===1&&oi===0&&(o.mode&1)===0&&(fu=fi()+500,nu&&be()))}function Ca(n,o){var x=n.callbackNode;zl(n,o);var F=Ga(n,n===ta?oa:0);if(F===0)x!==null&&ul(x),n.callbackNode=null,n.callbackPriority=0;else if(o=F&-F,n.callbackPriority!==o){if(x!=null&&ul(x),o===1)n.tag===0?L(sm.bind(null,n)):K(sm.bind(null,n)),qh(function(){(oi&6)===0&&be()}),x=null;else{switch(aa(F)){case 1:x=ja;break;case 4:x=kc;break;case 16:x=Bn;break;case 536870912:x=ma;break;default:x=Bn}x=fm(x,im.bind(null,n))}n.callbackPriority=o,n.callbackNode=x}}function im(n,o){if(dh=-1,hh=0,(oi&6)!==0)throw Error(t(327));var x=n.callbackNode;if(pu()&&n.callbackNode!==x)return null;var F=Ga(n,n===ta?oa:0);if(F===0)return null;if((F&30)!==0||(F&n.expiredLanes)!==0||o)o=fh(n,F);else{o=F;var U=oi;oi|=2;var J=am();(ta!==n||oa!==o)&&(kl=null,fu=fi()+500,Ac(n,o));do try{Dm();break}catch(Be){om(n,Be)}while(!0);Kh(),oh.current=J,oi=U,Ws!==null?o=0:(ta=null,oa=0,o=Xs)}if(o!==0){if(o===2&&(U=yu(n),U!==0&&(F=U,o=Lf(n,U))),o===1)throw x=ud,Ac(n,0),ec(n,F),Ca(n,fi()),x;if(o===6)ec(n,F);else{if(U=n.current.alternate,(F&30)===0&&!Fm(U)&&(o=fh(n,F),o===2&&(J=yu(n),J!==0&&(F=J,o=Lf(n,J))),o===1))throw x=ud,Ac(n,0),ec(n,F),Ca(n,fi()),x;switch(n.finishedWork=U,n.finishedLanes=F,o){case 0:case 1:throw Error(t(345));case 2:Tc(n,Ea,kl);break;case 3:if(ec(n,F),(F&130023424)===F&&(o=If+500-fi(),10<o)){if(Ga(n,0)!==0)break;if(U=n.suspendedLanes,(U&F)!==F){xa(),n.pingedLanes|=n.suspendedLanes&U;break}n.timeoutHandle=Yu(Tc.bind(null,n,Ea,kl),o);break}Tc(n,Ea,kl);break;case 4:if(ec(n,F),(F&4194240)===F)break;for(o=n.eventTimes,U=-1;0<F;){var oe=31-ga(F);J=1<<oe,oe=o[oe],oe>U&&(U=oe),F&=~J}if(F=U,F=fi()-F,F=(120>F?120:480>F?480:1080>F?1080:1920>F?1920:3e3>F?3e3:4320>F?4320:1960*Om(F/1960))-F,10<F){n.timeoutHandle=Yu(Tc.bind(null,n,Ea,kl),F);break}Tc(n,Ea,kl);break;case 5:Tc(n,Ea,kl);break;default:throw Error(t(329))}}}return Ca(n,fi()),n.callbackNode===x?im.bind(null,n):null}function Lf(n,o){var x=dd;return n.current.memoizedState.isDehydrated&&(Ac(n,o).flags|=256),n=fh(n,o),n!==2&&(o=Ea,Ea=x,o!==null&&Df(o)),n}function Df(n){Ea===null?Ea=n:Ea.push.apply(Ea,n)}function Fm(n){for(var o=n;;){if(o.flags&16384){var x=o.updateQueue;if(x!==null&&(x=x.stores,x!==null))for(var F=0;F<x.length;F++){var U=x[F],J=U.getSnapshot;U=U.value;try{if(!Gs(J(),U))return!1}catch{return!1}}}if(x=o.child,o.subtreeFlags&16384&&x!==null)x.return=o,o=x;else{if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ec(n,o){for(o&=~Pf,o&=~ah,n.suspendedLanes|=o,n.pingedLanes&=~o,n=n.expirationTimes;0<o;){var x=31-ga(o),F=1<<x;n[x]=-1,o&=~F}}function sm(n){if((oi&6)!==0)throw Error(t(327));pu();var o=Ga(n,0);if((o&1)===0)return Ca(n,fi()),null;var x=fh(n,o);if(n.tag!==0&&x===2){var F=yu(n);F!==0&&(o=F,x=Lf(n,F))}if(x===1)throw x=ud,Ac(n,0),ec(n,o),Ca(n,fi()),x;if(x===6)throw Error(t(345));return n.finishedWork=n.current.alternate,n.finishedLanes=o,Tc(n,Ea,kl),Ca(n,fi()),null}function Bf(n,o){var x=oi;oi|=1;try{return n(o)}finally{oi=x,oi===0&&(fu=fi()+500,nu&&be())}}function Cc(n){Ql!==null&&Ql.tag===0&&(oi&6)===0&&pu();var o=oi;oi|=1;var x=Da.transition,F=Fn;try{if(Da.transition=null,Fn=1,n)return n()}finally{Fn=F,Da.transition=x,oi=o,(oi&6)===0&&be()}}function jf(){za=hu.current,vi(hu)}function Ac(n,o){n.finishedWork=null,n.finishedLanes=0;var x=n.timeoutHandle;if(x!==-1&&(n.timeoutHandle=-1,Yh(x)),Ws!==null)for(x=Ws.return;x!==null;){var F=x;switch(ni(F),F.tag){case 1:F=F.type.childContextTypes,F!=null&&_c();break;case 3:cu(),vi(ca),vi(Qs),uf();break;case 5:lf(F);break;case 4:cu();break;case 13:vi(Ss);break;case 19:vi(Ss);break;case 10:ef(F.type._context);break;case 22:case 23:jf()}x=x.return}if(ta=n,Ws=n=tc(n.current,null),oa=za=o,Xs=0,ud=null,Pf=ah=Ec=0,Ea=dd=null,bc!==null){for(o=0;o<bc.length;o++)if(x=bc[o],F=x.interleaved,F!==null){x.interleaved=null;var U=F.next,J=x.pending;if(J!==null){var oe=J.next;J.next=U,F.next=oe}x.pending=F}bc=null}return n}function om(n,o){do{var x=Ws;try{if(Kh(),Jd.current=th,Qd){for(var F=Ts.memoizedState;F!==null;){var U=F.queue;U!==null&&(U.pending=null),F=F.next}Qd=!1}if(Sc=0,ea=qs=Ts=null,nd=!1,sd=0,Nf.current=null,x===null||x.return===null){Xs=1,ud=o,Ws=null;break}e:{var J=n,oe=x.return,Be=x,st=o;if(o=oa,Be.flags|=32768,st!==null&&typeof st=="object"&&typeof st.then=="function"){var Vt=st,Vr=Be,$r=Vr.tag;if((Vr.mode&1)===0&&($r===0||$r===11||$r===15)){var Ur=Vr.alternate;Ur?(Vr.updateQueue=Ur.updateQueue,Vr.memoizedState=Ur.memoizedState,Vr.lanes=Ur.lanes):(Vr.updateQueue=null,Vr.memoizedState=null)}var on=zp(oe);if(on!==null){on.flags&=-257,Np(on,oe,Be,J,o),on.mode&1&&Mp(J,Vt,o),o=on,st=Vt;var xn=o.updateQueue;if(xn===null){var wn=new Set;wn.add(st),o.updateQueue=wn}else xn.add(st);break e}else{if((o&1)===0){Mp(J,Vt,o),Gf();break e}st=Error(t(426))}}else if(Hr&&Be.mode&1){var Us=zp(oe);if(Us!==null){(Us.flags&65536)===0&&(Us.flags|=256),Np(Us,oe,Be,J,o),iu(uu(st,Be));break e}}J=st=uu(st,Be),Xs!==4&&(Xs=2),dd===null?dd=[J]:dd.push(J),J=oe;do{switch(J.tag){case 3:J.flags|=65536,o&=-o,J.lanes|=o;var St=Rp(J,st,o);Jf(J,St);break e;case 1:Be=st;var ot=J.type,Tt=J.stateNode;if((J.flags&128)===0&&(typeof ot.getDerivedStateFromError=="function"||Tt!==null&&typeof Tt.componentDidCatch=="function"&&(Jl===null||!Jl.has(Tt)))){J.flags|=65536,o&=-o,J.lanes|=o;var Xr=kp(J,Be,o);Jf(J,Xr);break e}}J=J.return}while(J!==null)}cm(x)}catch(En){o=En,Ws===x&&x!==null&&(Ws=x=x.return);continue}break}while(!0)}function am(){var n=oh.current;return oh.current=th,n===null?th:n}function Gf(){(Xs===0||Xs===3||Xs===2)&&(Xs=4),ta===null||(Ec&268435455)===0&&(ah&268435455)===0||ec(ta,oa)}function fh(n,o){var x=oi;oi|=2;var F=am();(ta!==n||oa!==o)&&(kl=null,Ac(n,o));do try{Lm();break}catch(U){om(n,U)}while(!0);if(Kh(),oi=x,oh.current=F,Ws!==null)throw Error(t(261));return ta=null,oa=0,Xs}function Lm(){for(;Ws!==null;)lm(Ws)}function Dm(){for(;Ws!==null&&!dl();)lm(Ws)}function lm(n){var o=hm(n.alternate,n,za);n.memoizedProps=n.pendingProps,o===null?cm(n):Ws=o,Nf.current=null}function cm(n){var o=n;do{var x=o.alternate;if(n=o.return,(o.flags&32768)===0){if(x=Mm(x,o,za),x!==null){Ws=x;return}}else{if(x=zm(x,o),x!==null){x.flags&=32767,Ws=x;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Xs=6,Ws=null;return}}if(o=o.sibling,o!==null){Ws=o;return}Ws=o=n}while(o!==null);Xs===0&&(Xs=5)}function Tc(n,o,x){var F=Fn,U=Da.transition;try{Da.transition=null,Fn=1,Bm(n,o,x,F)}finally{Da.transition=U,Fn=F}return null}function Bm(n,o,x,F){do pu();while(Ql!==null);if((oi&6)!==0)throw Error(t(327));x=n.finishedWork;var U=n.finishedLanes;if(x===null)return null;if(n.finishedWork=null,n.finishedLanes=0,x===n.current)throw Error(t(177));n.callbackNode=null,n.callbackPriority=0;var J=x.lanes|x.childLanes;if(wh(n,J),n===ta&&(Ws=ta=null,oa=0),(x.subtreeFlags&2064)===0&&(x.flags&2064)===0||ch||(ch=!0,fm(Bn,function(){return pu(),null})),J=(x.flags&15990)!==0,(x.subtreeFlags&15990)!==0||J){J=Da.transition,Da.transition=null;var oe=Fn;Fn=1;var Be=oi;oi|=4,Nf.current=null,Pm(n,x),Kp(x,n),Od($u),Pc=!!Hu,$u=Hu=null,n.current=x,Im(x),qa(),oi=Be,Fn=oe,Da.transition=J}else n.current=x;if(ch&&(ch=!1,Ql=n,uh=U),J=n.pendingLanes,J===0&&(Jl=null),fl(x.stateNode),Ca(n,fi()),o!==null)for(F=n.onRecoverableError,x=0;x<o.length;x++)U=o[x],F(U.value,{componentStack:U.stack,digest:U.digest});if(lh)throw lh=!1,n=Of,Of=null,n;return(uh&1)!==0&&n.tag!==0&&pu(),J=n.pendingLanes,(J&1)!==0?n===Ff?hd++:(hd=0,Ff=n):hd=0,be(),null}function pu(){if(Ql!==null){var n=aa(uh),o=Da.transition,x=Fn;try{if(Da.transition=null,Fn=16>n?16:n,Ql===null)var F=!1;else{if(n=Ql,Ql=null,uh=0,(oi&6)!==0)throw Error(t(331));var U=oi;for(oi|=4,an=n.current;an!==null;){var J=an,oe=J.child;if((an.flags&16)!==0){var Be=J.deletions;if(Be!==null){for(var st=0;st<Be.length;st++){var Vt=Be[st];for(an=Vt;an!==null;){var Vr=an;switch(Vr.tag){case 0:case 11:case 15:cd(8,Vr,J)}var $r=Vr.child;if($r!==null)$r.return=Vr,an=$r;else for(;an!==null;){Vr=an;var Ur=Vr.sibling,on=Vr.return;if(qp(Vr),Vr===Vt){an=null;break}if(Ur!==null){Ur.return=on,an=Ur;break}an=on}}}var xn=J.alternate;if(xn!==null){var wn=xn.child;if(wn!==null){xn.child=null;do{var Us=wn.sibling;wn.sibling=null,wn=Us}while(wn!==null)}}an=J}}if((J.subtreeFlags&2064)!==0&&oe!==null)oe.return=J,an=oe;else e:for(;an!==null;){if(J=an,(J.flags&2048)!==0)switch(J.tag){case 0:case 11:case 15:cd(9,J,J.return)}var St=J.sibling;if(St!==null){St.return=J.return,an=St;break e}an=J.return}}var ot=n.current;for(an=ot;an!==null;){oe=an;var Tt=oe.child;if((oe.subtreeFlags&2064)!==0&&Tt!==null)Tt.return=oe,an=Tt;else e:for(oe=ot;an!==null;){if(Be=an,(Be.flags&2048)!==0)try{switch(Be.tag){case 0:case 11:case 15:sh(9,Be)}}catch(En){Ns(Be,Be.return,En)}if(Be===oe){an=null;break e}var Xr=Be.sibling;if(Xr!==null){Xr.return=Be.return,an=Xr;break e}an=Be.return}}if(oi=U,be(),Hs&&typeof Hs.onPostCommitFiberRoot=="function")try{Hs.onPostCommitFiberRoot(Ml,n)}catch{}F=!0}return F}finally{Fn=x,Da.transition=o}}return!1}function um(n,o,x){o=uu(x,o),o=Rp(n,o,1),n=Xl(n,o,1),o=xa(),n!==null&&(ba(n,1,o),Ca(n,o))}function Ns(n,o,x){if(n.tag===3)um(n,n,x);else for(;o!==null;){if(o.tag===3){um(o,n,x);break}else if(o.tag===1){var F=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof F.componentDidCatch=="function"&&(Jl===null||!Jl.has(F))){n=uu(x,n),n=kp(o,n,1),o=Xl(o,n,1),n=xa(),o!==null&&(ba(o,1,n),Ca(o,n));break}}o=o.return}}function jm(n,o,x){var F=n.pingCache;F!==null&&F.delete(o),o=xa(),n.pingedLanes|=n.suspendedLanes&x,ta===n&&(oa&x)===x&&(Xs===4||Xs===3&&(oa&130023424)===oa&&500>fi()-If?Ac(n,0):Pf|=x),Ca(n,o)}function dm(n,o){o===0&&((n.mode&1)===0?o=1:(o=Xa,Xa<<=1,(Xa&130023424)===0&&(Xa=4194304)));var x=xa();n=Al(n,o),n!==null&&(ba(n,o,x),Ca(n,x))}function Gm(n){var o=n.memoizedState,x=0;o!==null&&(x=o.retryLane),dm(n,x)}function Um(n,o){var x=0;switch(n.tag){case 13:var F=n.stateNode,U=n.memoizedState;U!==null&&(x=U.retryLane);break;case 19:F=n.stateNode;break;default:throw Error(t(314))}F!==null&&F.delete(o),dm(n,x)}var hm;hm=function(n,o,x){if(n!==null)if(n.memoizedProps!==o.pendingProps||ca.current)Sa=!0;else{if((n.lanes&x)===0&&(o.flags&128)===0)return Sa=!1,km(n,o,x);Sa=(n.flags&131072)!==0}else Sa=!1,Hr&&(o.flags&1048576)!==0&&mi(o,ct,o.index);switch(o.lanes=0,o.tag){case 2:var F=o.type;nh(n,o),n=o.pendingProps;var U=Cl(o,Qs.current);au(o,x),U=ff(null,o,F,n,U,x);var J=pf();return o.flags|=1,typeof U=="object"&&U!==null&&typeof U.render=="function"&&U.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,ia(F)?(J=!0,xc(o)):J=!1,o.memoizedState=U.state!==null&&U.state!==void 0?U.state:null,nf(o),U.updater=qd,o.stateNode=U,U._reactInternals=o,of(o,F,n,x),o=wf(null,o,F,!0,J,x)):(o.tag=0,Hr&&J&&xi(o),_a(null,o,U,x),o=o.child),o;case 16:F=o.elementType;e:{switch(nh(n,o),n=o.pendingProps,U=F._init,F=U(F._payload),o.type=F,U=o.tag=Wm(F),n=ua(F,n),U){case 0:o=bf(null,o,F,n,x);break e;case 1:o=Dp(null,o,F,n,x);break e;case 11:o=Pp(null,o,F,n,x);break e;case 14:o=Ip(null,o,F,ua(F.type,n),x);break e}throw Error(t(306,F,""))}return o;case 0:return F=o.type,U=o.pendingProps,U=o.elementType===F?U:ua(F,U),bf(n,o,F,U,x);case 1:return F=o.type,U=o.pendingProps,U=o.elementType===F?U:ua(F,U),Dp(n,o,F,U,x);case 3:e:{if(Bp(o),n===null)throw Error(t(387));F=o.pendingProps,J=o.memoizedState,U=J.element,Zf(n,o),Yd(o,F,null,x);var oe=o.memoizedState;if(F=oe.element,J.isDehydrated)if(J={element:F,isDehydrated:!1,cache:oe.cache,pendingSuspenseBoundaries:oe.pendingSuspenseBoundaries,transitions:oe.transitions},o.updateQueue.baseState=J,o.memoizedState=J,o.flags&256){U=uu(Error(t(423)),o),o=jp(n,o,F,x,U);break e}else if(F!==U){U=uu(Error(t(424)),o),o=jp(n,o,F,x,U);break e}else for(Cn=Ia(o.stateNode.containerInfo.firstChild),An=o,Hr=!0,Tn=null,x=sp(o,null,F,x),o.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling;else{if(wa(),F===U){o=Rl(n,o,x);break e}_a(n,o,F,x)}o=o.child}return o;case 5:return op(o),n===null&&ci(o),F=o.type,U=o.pendingProps,J=n!==null?n.memoizedProps:null,oe=U.children,ka(F,U)?oe=null:J!==null&&ka(F,J)&&(o.flags|=32),Lp(n,o),_a(n,o,oe,x),o.child;case 6:return n===null&&ci(o),null;case 13:return Gp(n,o,x);case 4:return af(o,o.stateNode.containerInfo),F=o.pendingProps,n===null?o.child=lu(o,null,F,x):_a(n,o,F,x),o.child;case 11:return F=o.type,U=o.pendingProps,U=o.elementType===F?U:ua(F,U),Pp(n,o,F,U,x);case 7:return _a(n,o,o.pendingProps,x),o.child;case 8:return _a(n,o,o.pendingProps.children,x),o.child;case 12:return _a(n,o,o.pendingProps.children,x),o.child;case 10:e:{if(F=o.type._context,U=o.pendingProps,J=o.memoizedProps,oe=U.value,pi(Wd,F._currentValue),F._currentValue=oe,J!==null)if(Gs(J.value,oe)){if(J.children===U.children&&!ca.current){o=Rl(n,o,x);break e}}else for(J=o.child,J!==null&&(J.return=o);J!==null;){var Be=J.dependencies;if(Be!==null){oe=J.child;for(var st=Be.firstContext;st!==null;){if(st.context===F){if(J.tag===1){st=Tl(-1,x&-x),st.tag=2;var Vt=J.updateQueue;if(Vt!==null){Vt=Vt.shared;var Vr=Vt.pending;Vr===null?st.next=st:(st.next=Vr.next,Vr.next=st),Vt.pending=st}}J.lanes|=x,st=J.alternate,st!==null&&(st.lanes|=x),tf(J.return,x,o),Be.lanes|=x;break}st=st.next}}else if(J.tag===10)oe=J.type===o.type?null:J.child;else if(J.tag===18){if(oe=J.return,oe===null)throw Error(t(341));oe.lanes|=x,Be=oe.alternate,Be!==null&&(Be.lanes|=x),tf(oe,x,o),oe=J.sibling}else oe=J.child;if(oe!==null)oe.return=J;else for(oe=J;oe!==null;){if(oe===o){oe=null;break}if(J=oe.sibling,J!==null){J.return=oe.return,oe=J;break}oe=oe.return}J=oe}_a(n,o,U.children,x),o=o.child}return o;case 9:return U=o.type,F=o.pendingProps.children,au(o,x),U=Fa(U),F=F(U),o.flags|=1,_a(n,o,F,x),o.child;case 14:return F=o.type,U=ua(F,o.pendingProps),U=ua(F.type,U),Ip(n,o,F,U,x);case 15:return Op(n,o,o.type,o.pendingProps,x);case 17:return F=o.type,U=o.pendingProps,U=o.elementType===F?U:ua(F,U),nh(n,o),o.tag=1,ia(F)?(n=!0,xc(o)):n=!1,au(o,x),tp(o,F,U),of(o,F,U,x),wf(null,o,F,!0,n,x);case 19:return Vp(n,o,x);case 22:return Fp(n,o,x)}throw Error(t(156,o.tag))};function fm(n,o){return cl(n,o)}function Vm(n,o,x,F){this.tag=n,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=F,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ba(n,o,x,F){return new Vm(n,o,x,F)}function Uf(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Wm(n){if(typeof n=="function")return Uf(n)?1:0;if(n!=null){if(n=n.$$typeof,n===X)return 11;if(n===$)return 14}return 2}function tc(n,o){var x=n.alternate;return x===null?(x=Ba(n.tag,o,n.key,n.mode),x.elementType=n.elementType,x.type=n.type,x.stateNode=n.stateNode,x.alternate=n,n.alternate=x):(x.pendingProps=o,x.type=n.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=n.flags&14680064,x.childLanes=n.childLanes,x.lanes=n.lanes,x.child=n.child,x.memoizedProps=n.memoizedProps,x.memoizedState=n.memoizedState,x.updateQueue=n.updateQueue,o=n.dependencies,x.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},x.sibling=n.sibling,x.index=n.index,x.ref=n.ref,x}function ph(n,o,x,F,U,J){var oe=2;if(F=n,typeof n=="function")Uf(n)&&(oe=1);else if(typeof n=="string")oe=5;else e:switch(n){case C:return Rc(x.children,U,J,o);case k:oe=8,U|=8;break;case I:return n=Ba(12,x,o,U|2),n.elementType=I,n.lanes=J,n;case j:return n=Ba(13,x,o,U),n.elementType=j,n.lanes=J,n;case B:return n=Ba(19,x,o,U),n.elementType=B,n.lanes=J,n;case q:return mh(x,U,J,o);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case O:oe=10;break e;case D:oe=9;break e;case X:oe=11;break e;case $:oe=14;break e;case H:oe=16,F=null;break e}throw Error(t(130,n==null?n:typeof n,""))}return o=Ba(oe,x,o,U),o.elementType=n,o.type=F,o.lanes=J,o}function Rc(n,o,x,F){return n=Ba(7,n,F,o),n.lanes=x,n}function mh(n,o,x,F){return n=Ba(22,n,F,o),n.elementType=q,n.lanes=x,n.stateNode={isHidden:!1},n}function Vf(n,o,x){return n=Ba(6,n,null,o),n.lanes=x,n}function Wf(n,o,x){return o=Ba(4,n.children!==null?n.children:[],n.key,o),o.lanes=x,o.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},o}function Hm(n,o,x,F,U){this.tag=o,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mc(0),this.expirationTimes=Mc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mc(0),this.identifierPrefix=F,this.onRecoverableError=U,this.mutableSourceEagerHydrationData=null}function Hf(n,o,x,F,U,J,oe,Be,st){return n=new Hm(n,o,x,Be,st),o===1?(o=1,J===!0&&(o|=8)):o=0,J=Ba(3,null,null,o),n.current=J,J.stateNode=n,J.memoizedState={element:F,isDehydrated:x,cache:null,transitions:null,pendingSuspenseBoundaries:null},nf(J),n}function $m(n,o,x){var F=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:y,key:F==null?null:""+F,children:n,containerInfo:o,implementation:x}}function pm(n){if(!n)return il;n=n._reactInternals;e:{if(ti(n)!==n||n.tag!==1)throw Error(t(170));var o=n;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(ia(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(n.tag===1){var x=n.type;if(ia(x))return Ju(n,x,o)}return o}function mm(n,o,x,F,U,J,oe,Be,st){return n=Hf(x,F,!0,n,U,J,oe,Be,st),n.context=pm(null),x=n.current,F=xa(),U=Kl(x),J=Tl(F,U),J.callback=o??null,Xl(x,J,U),n.current.lanes=U,ba(n,U,F),Ca(n,F),n}function gh(n,o,x,F){var U=o.current,J=xa(),oe=Kl(U);return x=pm(x),o.context===null?o.context=x:o.pendingContext=x,o=Tl(J,oe),o.payload={element:n},F=F===void 0?null:F,F!==null&&(o.callback=F),n=Xl(U,o,oe),n!==null&&(Ya(n,U,oe,J),$d(n,U,oe)),oe}function vh(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function gm(n,o){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var x=n.retryLane;n.retryLane=x!==0&&x<o?x:o}}function $f(n,o){gm(n,o),(n=n.alternate)&&gm(n,o)}function Ym(){return null}var vm=typeof reportError=="function"?reportError:function(n){console.error(n)};function Yf(n){this._internalRoot=n}yh.prototype.render=Yf.prototype.render=function(n){var o=this._internalRoot;if(o===null)throw Error(t(409));gh(n,o,null,null)},yh.prototype.unmount=Yf.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var o=n.containerInfo;Cc(function(){gh(null,n,null,null)}),o[ya]=null}};function yh(n){this._internalRoot=n}yh.prototype.unstable_scheduleHydration=function(n){if(n){var o=_u();n={blockedOn:null,target:n,priority:o};for(var x=0;x<Ka.length&&o!==0&&o<Ka[x].priority;x++);Ka.splice(x,0,n),x===0&&md(n)}};function qf(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function _h(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function ym(){}function qm(n,o,x,F,U){if(U){if(typeof F=="function"){var J=F;F=function(){var Vt=vh(oe);J.call(Vt)}}var oe=mm(o,F,n,0,null,!1,!1,"",ym);return n._reactRootContainer=oe,n[ya]=oe.current,pc(n.nodeType===8?n.parentNode:n),Cc(),oe}for(;U=n.lastChild;)n.removeChild(U);if(typeof F=="function"){var Be=F;F=function(){var Vt=vh(st);Be.call(Vt)}}var st=Hf(n,0,!1,null,null,!1,!1,"",ym);return n._reactRootContainer=st,n[ya]=st.current,pc(n.nodeType===8?n.parentNode:n),Cc(function(){gh(o,st,x,F)}),st}function xh(n,o,x,F,U){var J=x._reactRootContainer;if(J){var oe=J;if(typeof U=="function"){var Be=U;U=function(){var st=vh(oe);Be.call(st)}}gh(o,oe,n,U)}else oe=qm(x,o,n,U,F);return vh(oe)}si=function(n){switch(n.tag){case 3:var o=n.stateNode;if(o.current.memoizedState.isDehydrated){var x=Ls(o.pendingLanes);x!==0&&(Pa(o,x|1),Ca(o,fi()),(oi&6)===0&&(fu=fi()+500,be()))}break;case 13:Cc(function(){var F=Al(n,1);if(F!==null){var U=xa();Ya(F,n,1,U)}}),$f(n,1)}},ml=function(n){if(n.tag===13){var o=Al(n,134217728);if(o!==null){var x=xa();Ya(o,n,134217728,x)}$f(n,134217728)}},zc=function(n){if(n.tag===13){var o=Kl(n),x=Al(n,o);if(x!==null){var F=xa();Ya(x,n,o,F)}$f(n,o)}},_u=function(){return Fn},gl=function(n,o){var x=Fn;try{return Fn=n,o()}finally{Fn=x}},se=function(n,o,x){switch(o){case"input":if(Jt(n,x),o=x.name,x.type==="radio"&&o!=null){for(x=n;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<x.length;o++){var F=x[o];if(F!==n&&F.form===n.form){var U=ru(F);if(!U)throw Error(t(90));Gt(F),Jt(F,U)}}}break;case"textarea":Mt(n,x);break;case"select":o=x.value,o!=null&&zr(n,!!x.multiple,o,!1)}},me=Bf,Ze=Cc;var Xm={usingClientEntryPoint:!1,Events:[yc,$l,ru,ut,at,Bf]},fd={findFiberByHostInstance:El,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Zm={bundleType:fd.bundleType,version:fd.version,rendererPackageName:fd.rendererPackageName,rendererConfig:fd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Vs(n),n===null?null:n.stateNode},findFiberByHostInstance:fd.findFiberByHostInstance||Ym,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bh.isDisabled&&bh.supportsFiber)try{Ml=bh.inject(Zm),Hs=bh}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xm,reactDom_production_min.createPortal=function(n,o){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qf(o))throw Error(t(200));return $m(n,o,null,x)},reactDom_production_min.createRoot=function(n,o){if(!qf(n))throw Error(t(299));var x=!1,F="",U=vm;return o!=null&&(o.unstable_strictMode===!0&&(x=!0),o.identifierPrefix!==void 0&&(F=o.identifierPrefix),o.onRecoverableError!==void 0&&(U=o.onRecoverableError)),o=Hf(n,1,!1,null,null,x,!1,F,U),n[ya]=o.current,pc(n.nodeType===8?n.parentNode:n),new Yf(o)},reactDom_production_min.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var o=n._reactInternals;if(o===void 0)throw typeof n.render=="function"?Error(t(188)):(n=Object.keys(n).join(","),Error(t(268,n)));return n=Vs(o),n=n===null?null:n.stateNode,n},reactDom_production_min.flushSync=function(n){return Cc(n)},reactDom_production_min.hydrate=function(n,o,x){if(!_h(o))throw Error(t(200));return xh(null,n,o,!0,x)},reactDom_production_min.hydrateRoot=function(n,o,x){if(!qf(n))throw Error(t(405));var F=x!=null&&x.hydratedSources||null,U=!1,J="",oe=vm;if(x!=null&&(x.unstable_strictMode===!0&&(U=!0),x.identifierPrefix!==void 0&&(J=x.identifierPrefix),x.onRecoverableError!==void 0&&(oe=x.onRecoverableError)),o=mm(o,null,n,1,x??null,U,!1,J,oe),n[ya]=o.current,pc(n),F)for(n=0;n<F.length;n++)x=F[n],U=x._getVersion,U=U(x._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[x,U]:o.mutableSourceEagerHydrationData.push(x,U);return new yh(o)},reactDom_production_min.render=function(n,o,x){if(!_h(o))throw Error(t(200));return xh(null,n,o,!1,x)},reactDom_production_min.unmountComponentAtNode=function(n){if(!_h(n))throw Error(t(40));return n._reactRootContainer?(Cc(function(){xh(null,null,n,!1,function(){n._reactRootContainer=null,n[ya]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=Bf,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(n,o,x,F){if(!_h(x))throw Error(t(200));if(n==null||n._reactInternals===void 0)throw Error(t(38));return xh(n,o,x,!1,F)},reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var e=requireReactDom();return client.createRoot=e.createRoot,client.hydrateRoot=e.hydrateRoot,client}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs(clientExports);/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createBrowserHistory(e={}){function r(a,c){let{pathname:h,search:_,hash:f}=a.location;return createLocation("",{pathname:h,search:_,hash:f},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function t(a,c){return typeof c=="string"?c:createPath(c)}return getUrlBasedHistory(r,t,null,e)}function invariant(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function warning(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(e,r){return{usr:e.state,key:e.key,idx:r}}function createLocation(e,r,t=null,a){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof r=="string"?parsePath(r):r,state:t,key:r&&r.key||a||createKey()}}function createPath({pathname:e="/",search:r="",hash:t=""}){return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function parsePath(e){let r={};if(e){let t=e.indexOf("#");t>=0&&(r.hash=e.substring(t),e=e.substring(0,t));let a=e.indexOf("?");a>=0&&(r.search=e.substring(a),e=e.substring(0,a)),e&&(r.pathname=e)}return r}function getUrlBasedHistory(e,r,t,a={}){let{window:c=document.defaultView,v5Compat:h=!1}=a,_=c.history,f="POP",g=null,b=p();b==null&&(b=0,_.replaceState({..._.state,idx:b},""));function p(){return(_.state||{idx:null}).idx}function E(){f="POP";let s=p(),v=s==null?null:s-b;b=s,g&&g({action:f,location:l.location,delta:v})}function M(s,v){f="PUSH";let w=createLocation(l.location,s,v);b=p()+1;let S=getHistoryState(w,b),A=l.createHref(w);try{_.pushState(S,"",A)}catch(u){if(u instanceof DOMException&&u.name==="DataCloneError")throw u;c.location.assign(A)}h&&g&&g({action:f,location:l.location,delta:1})}function R(s,v){f="REPLACE";let w=createLocation(l.location,s,v);b=p();let S=getHistoryState(w,b),A=l.createHref(w);_.replaceState(S,"",A),h&&g&&g({action:f,location:l.location,delta:0})}function z(s){return createBrowserURLImpl(s)}let l={get action(){return f},get location(){return e(c,_)},listen(s){if(g)throw new Error("A history only accepts one active listener");return c.addEventListener(PopStateEventType,E),g=s,()=>{c.removeEventListener(PopStateEventType,E),g=null}},createHref(s){return r(c,s)},createURL:z,encodeLocation(s){let v=z(s);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:M,replace:R,go(s){return _.go(s)}};return l}function createBrowserURLImpl(e,r=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),invariant(t,"No window.location.(origin|href) available to create URL");let a=typeof e=="string"?e:createPath(e);return a=a.replace(/ $/,"%20"),!r&&a.startsWith("//")&&(a=t+a),new URL(a,t)}function matchRoutes(e,r,t="/"){return matchRoutesImpl(e,r,t,!1)}function matchRoutesImpl(e,r,t,a){let c=typeof r=="string"?parsePath(r):r,h=stripBasename(c.pathname||"/",t);if(h==null)return null;let _=flattenRoutes(e);rankRouteBranches(_);let f=null;for(let g=0;f==null&&g<_.length;++g){let b=decodePath(h);f=matchRouteBranch(_[g],b,a)}return f}function flattenRoutes(e,r=[],t=[],a="",c=!1){let h=(_,f,g=c,b)=>{let p={relativePath:b===void 0?_.path||"":b,caseSensitive:_.caseSensitive===!0,childrenIndex:f,route:_};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(a)&&g)return;invariant(p.relativePath.startsWith(a),`Absolute route path "${p.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(a.length)}let E=joinPaths([a,p.relativePath]),M=t.concat(p);_.children&&_.children.length>0&&(invariant(_.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${E}".`),flattenRoutes(_.children,r,M,E,g)),!(_.path==null&&!_.index)&&r.push({path:E,score:computeScore(E,_.index),routesMeta:M})};return e.forEach((_,f)=>{if(_.path===""||!_.path?.includes("?"))h(_,f);else for(let g of explodeOptionalSegments(_.path))h(_,f,!0,g)}),r}function explodeOptionalSegments(e){let r=e.split("/");if(r.length===0)return[];let[t,...a]=r,c=t.endsWith("?"),h=t.replace(/\?$/,"");if(a.length===0)return c?[h,""]:[h];let _=explodeOptionalSegments(a.join("/")),f=[];return f.push(..._.map(g=>g===""?h:[h,g].join("/"))),c&&f.push(..._),f.map(g=>e.startsWith("/")&&g===""?"/":g)}function rankRouteBranches(e){e.sort((r,t)=>r.score!==t.score?t.score-r.score:compareIndexes(r.routesMeta.map(a=>a.childrenIndex),t.routesMeta.map(a=>a.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,r){let t=e.split("/"),a=t.length;return t.some(isSplat)&&(a+=splatPenalty),r&&(a+=indexRouteValue),t.filter(c=>!isSplat(c)).reduce((c,h)=>c+(paramRe.test(h)?dynamicSegmentValue:h===""?emptySegmentValue:staticSegmentValue),a)}function compareIndexes(e,r){return e.length===r.length&&e.slice(0,-1).every((a,c)=>a===r[c])?e[e.length-1]-r[r.length-1]:0}function matchRouteBranch(e,r,t=!1){let{routesMeta:a}=e,c={},h="/",_=[];for(let f=0;f<a.length;++f){let g=a[f],b=f===a.length-1,p=h==="/"?r:r.slice(h.length)||"/",E=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:b},p),M=g.route;if(!E&&b&&t&&!a[a.length-1].route.index&&(E=matchPath({path:g.relativePath,caseSensitive:g.caseSensitive,end:!1},p)),!E)return null;Object.assign(c,E.params),_.push({params:c,pathname:joinPaths([h,E.pathname]),pathnameBase:normalizePathname(joinPaths([h,E.pathnameBase])),route:M}),E.pathnameBase!=="/"&&(h=joinPaths([h,E.pathnameBase]))}return _}function matchPath(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,a]=compilePath(e.path,e.caseSensitive,e.end),c=r.match(t);if(!c)return null;let h=c[0],_=h.replace(/(.)\/+$/,"$1"),f=c.slice(1);return{params:a.reduce((b,{paramName:p,isOptional:E},M)=>{if(p==="*"){let z=f[M]||"";_=h.slice(0,h.length-z.length).replace(/(.)\/+$/,"$1")}const R=f[M];return E&&!R?b[p]=void 0:b[p]=(R||"").replace(/%2F/g,"/"),b},{}),pathname:h,pathnameBase:_,pattern:e}}function compilePath(e,r=!1,t=!0){warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],c="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(_,f,g)=>(a.push({paramName:f,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(a.push({paramName:"*"}),c+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?c+="\\/*$":e!==""&&e!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,r?void 0:"i"),a]}function decodePath(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return warning(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),e}}function stripBasename(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let t=r.endsWith("/")?r.length-1:r.length,a=e.charAt(t);return a&&a!=="/"?null:e.slice(t)||"/"}function resolvePath(e,r="/"){let{pathname:t,search:a="",hash:c=""}=typeof e=="string"?parsePath(e):e;return{pathname:t?t.startsWith("/")?t:resolvePathname(t,r):r,search:normalizeSearch(a),hash:normalizeHash(c)}}function resolvePathname(e,r){let t=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(c=>{c===".."?t.length>1&&t.pop():c!=="."&&t.push(c)}),t.length>1?t.join("/"):"/"}function getInvalidPathError(e,r,t,a){return`Cannot include a '${e}' character in a manually specified \`to.${r}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(e){return e.filter((r,t)=>t===0||r.route.path&&r.route.path.length>0)}function getResolveToMatches(e){let r=getPathContributingMatches(e);return r.map((t,a)=>a===r.length-1?t.pathname:t.pathnameBase)}function resolveTo(e,r,t,a=!1){let c;typeof e=="string"?c=parsePath(e):(c={...e},invariant(!c.pathname||!c.pathname.includes("?"),getInvalidPathError("?","pathname","search",c)),invariant(!c.pathname||!c.pathname.includes("#"),getInvalidPathError("#","pathname","hash",c)),invariant(!c.search||!c.search.includes("#"),getInvalidPathError("#","search","hash",c)));let h=e===""||c.pathname==="",_=h?"/":c.pathname,f;if(_==null)f=t;else{let E=r.length-1;if(!a&&_.startsWith("..")){let M=_.split("/");for(;M[0]==="..";)M.shift(),E-=1;c.pathname=M.join("/")}f=E>=0?r[E]:"/"}let g=resolvePath(c,f),b=_&&_!=="/"&&_.endsWith("/"),p=(h||_===".")&&t.endsWith("/");return!g.pathname.endsWith("/")&&(b||p)&&(g.pathname+="/"),g}var joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";reactExports.createContext(!1);var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(e,{relative:r}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:a}=reactExports.useContext(NavigationContext),{hash:c,pathname:h,search:_}=useResolvedPath(e,{relative:r}),f=h;return t!=="/"&&(f=h==="/"?t:joinPaths([t,h])),a.createHref({pathname:f,search:_,hash:c})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(e){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let e=reactExports.useContext(DataRouterContext),{basename:r,navigator:t}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),h=JSON.stringify(getResolveToMatches(a)),_=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{_.current=!0}),reactExports.useCallback((g,b={})=>{if(warning(_.current,navigateEffectWarning),!_.current)return;if(typeof g=="number"){t.go(g);return}let p=resolveTo(g,JSON.parse(h),c,b.relative==="path");e==null&&r!=="/"&&(p.pathname=p.pathname==="/"?r:joinPaths([r,p.pathname])),(b.replace?t.replace:t.push)(p,b.state,b)},[r,t,h,c,e])}reactExports.createContext(null);function useResolvedPath(e,{relative:r}={}){let{matches:t}=reactExports.useContext(RouteContext),{pathname:a}=useLocation(),c=JSON.stringify(getResolveToMatches(t));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(c),a,r==="path"),[e,c,a,r])}function useRoutesImpl(e,r,t,a,c){invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:h}=reactExports.useContext(NavigationContext),{matches:_}=reactExports.useContext(RouteContext),f=_[_.length-1],g=f?f.params:{},b=f?f.pathname:"/",p=f?f.pathnameBase:"/",E=f&&f.route;{let w=E&&E.path||"";warningOnce(b,!E||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${b}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let M=useLocation(),R;R=M;let z=R.pathname||"/",l=z;if(p!=="/"){let w=p.replace(/^\//,"").split("/");l="/"+z.replace(/^\//,"").split("/").slice(w.length).join("/")}let s=matchRoutes(e,{pathname:l});return warning(E||s!=null,`No routes matched location "${R.pathname}${R.search}${R.hash}" `),warning(s==null||s[s.length-1].route.element!==void 0||s[s.length-1].route.Component!==void 0||s[s.length-1].route.lazy!==void 0,`Matched leaf route at location "${R.pathname}${R.search}${R.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),_renderMatches(s&&s.map(w=>Object.assign({},w,{params:Object.assign({},g,w.params),pathname:joinPaths([p,h.encodeLocation?h.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?p:joinPaths([p,h.encodeLocation?h.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),_,t,a,c)}function DefaultErrorComponent(){let e=useRouteError(),r=isRouteErrorResponse(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",c={padding:"0.5rem",backgroundColor:a},h={padding:"2px 4px",backgroundColor:a},_=null;return console.error("Error handled by React Router default ErrorBoundary:",e),_=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null," Hey developer "),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:h},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:h},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},r),t?reactExports.createElement("pre",{style:c},t):null,_)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){this.props.unstable_onError?this.props.unstable_onError(e,r):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:e,match:r,children:t}){let a=reactExports.useContext(DataRouterContext);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),reactExports.createElement(RouteContext.Provider,{value:e},t)}function _renderMatches(e,r=[],t=null,a=null,c=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(r.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let h=e,_=t?.errors;if(_!=null){let b=h.findIndex(p=>p.route.id&&_?.[p.route.id]!==void 0);invariant(b>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(_).join(",")}`),h=h.slice(0,Math.min(h.length,b+1))}let f=!1,g=-1;if(t)for(let b=0;b<h.length;b++){let p=h[b];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(g=b),p.route.id){let{loaderData:E,errors:M}=t,R=p.route.loader&&!E.hasOwnProperty(p.route.id)&&(!M||M[p.route.id]===void 0);if(p.route.lazy||R){f=!0,g>=0?h=h.slice(0,g+1):h=[h[0]];break}}}return h.reduceRight((b,p,E)=>{let M,R=!1,z=null,l=null;t&&(M=_&&p.route.id?_[p.route.id]:void 0,z=p.route.errorElement||defaultErrorElement,f&&(g<0&&E===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),R=!0,l=null):g===E&&(R=!0,l=p.route.hydrateFallbackElement||null)));let s=r.concat(h.slice(0,E+1)),v=()=>{let w;return M?w=z:R?w=l:p.route.Component?w=reactExports.createElement(p.route.Component,null):p.route.element?w=p.route.element:w=b,reactExports.createElement(RenderedRoute,{match:p,routeContext:{outlet:b,matches:s,isDataRoute:t!=null},children:w})};return t&&(p.route.ErrorBoundary||p.route.errorElement||E===0)?reactExports.createElement(RenderErrorBoundary,{location:t.location,revalidation:t.revalidation,component:z,error:M,children:v(),routeContext:{outlet:null,matches:s,isDataRoute:!0},unstable_onError:a}):v()},null)}function getDataRouterConsoleError(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(e){let r=reactExports.useContext(DataRouterContext);return invariant(r,getDataRouterConsoleError(e)),r}function useDataRouterState(e){let r=reactExports.useContext(DataRouterStateContext);return invariant(r,getDataRouterConsoleError(e)),r}function useRouteContext(e){let r=reactExports.useContext(RouteContext);return invariant(r,getDataRouterConsoleError(e)),r}function useCurrentRouteId(e){let r=useRouteContext(e),t=r.matches[r.matches.length-1];return invariant(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){let e=reactExports.useContext(RouteErrorContext),r=useDataRouterState("useRouteError"),t=useCurrentRouteId("useRouteError");return e!==void 0?e:r.errors?.[t]}function useNavigateStable(){let{router:e}=useDataRouterContext("useNavigate"),r=useCurrentRouteId("useNavigate"),t=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{t.current=!0}),reactExports.useCallback(async(c,h={})=>{warning(t.current,navigateEffectWarning),t.current&&(typeof c=="number"?e.navigate(c):await e.navigate(c,{fromRouteId:r,...h}))},[e,r])}var alreadyWarned={};function warningOnce(e,r,t){!r&&!alreadyWarned[e]&&(alreadyWarned[e]=!0,warning(!1,t))}reactExports.memo(DataRoutes);function DataRoutes({routes:e,future:r,state:t,unstable_onError:a}){return useRoutesImpl(e,void 0,t,a,r)}function Router({basename:e="/",children:r=null,location:t,navigationType:a="POP",navigator:c,static:h=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let _=e.replace(/^\/*/,"/"),f=reactExports.useMemo(()=>({basename:_,navigator:c,static:h,future:{}}),[_,c,h]);typeof t=="string"&&(t=parsePath(t));let{pathname:g="/",search:b="",hash:p="",state:E=null,key:M="default"}=t,R=reactExports.useMemo(()=>{let z=stripBasename(g,_);return z==null?null:{location:{pathname:z,search:b,hash:p,state:E,key:M},navigationType:a}},[_,g,b,p,E,M,a]);return warning(R!=null,`<Router basename="${_}"> is not able to match the URL "${g}${b}${p}" because it does not start with the basename, so the <Router> won't render anything.`),R==null?null:reactExports.createElement(NavigationContext.Provider,{value:f},reactExports.createElement(LocationContext.Provider,{children:r,value:R}))}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(e){return e!=null&&typeof e.tagName=="string"}function isButtonElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="button"}function isFormElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="form"}function isInputElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="input"}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,r){return e.button===0&&(!r||r==="_self")&&!isModifiedEvent(e)}function createSearchParams(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((r,t)=>{let a=e[t];return r.concat(Array.isArray(a)?a.map(c=>[t,c]):[[t,a]])},[]))}function getSearchParamsForLocation(e,r){let t=createSearchParams(e);return r&&r.forEach((a,c)=>{t.has(c)||r.getAll(c).forEach(h=>{t.append(c,h)})}),t}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(e){return e!=null&&!supportedFormEncTypes.has(e)?(warning(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):e}function getFormSubmissionInfo(e,r){let t,a,c,h,_;if(isFormElement(e)){let f=e.getAttribute("action");a=f?stripBasename(f,r):null,t=e.getAttribute("method")||defaultMethod,c=getFormEncType(e.getAttribute("enctype"))||defaultEncType,h=new FormData(e)}else if(isButtonElement(e)||isInputElement(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let g=e.getAttribute("formaction")||f.getAttribute("action");if(a=g?stripBasename(g,r):null,t=e.getAttribute("formmethod")||f.getAttribute("method")||defaultMethod,c=getFormEncType(e.getAttribute("formenctype"))||getFormEncType(f.getAttribute("enctype"))||defaultEncType,h=new FormData(f,e),!isFormDataSubmitterSupported()){let{name:b,type:p,value:E}=e;if(p==="image"){let M=b?`${b}.`:"";h.append(`${M}x`,"0"),h.append(`${M}y`,"0")}else b&&h.append(b,E)}}else{if(isHtmlElement(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=defaultMethod,a=null,c=defaultEncType,_=e}return h&&c==="text/plain"&&(_=h,h=void 0),{action:a,method:t.toLowerCase(),encType:c,formData:h,body:_}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function invariant2(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function singleFetchUrl(e,r,t){let a=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return a.pathname==="/"?a.pathname=`_root.${t}`:r&&stripBasename(a.pathname,r)==="/"?a.pathname=`${r.replace(/\/$/,"")}/_root.${t}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${t}`,a}async function loadRouteModule(e,r){if(e.id in r)return r[e.id];try{let t=await import(e.module);return r[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function getKeyedPrefetchLinks(e,r,t){let a=await Promise.all(e.map(async c=>{let h=r.routes[c.route.id];if(h){let _=await loadRouteModule(h,t);return _.links?_.links():[]}return[]}));return dedupeLinkDescriptors(a.flat(1).filter(isHtmlLinkDescriptor).filter(c=>c.rel==="stylesheet"||c.rel==="preload").map(c=>c.rel==="stylesheet"?{...c,rel:"prefetch",as:"style"}:{...c,rel:"prefetch"}))}function getNewMatchesForLinks(e,r,t,a,c,h){let _=(g,b)=>t[b]?g.route.id!==t[b].route.id:!0,f=(g,b)=>t[b].pathname!==g.pathname||t[b].route.path?.endsWith("*")&&t[b].params["*"]!==g.params["*"];return h==="assets"?r.filter((g,b)=>_(g,b)||f(g,b)):h==="data"?r.filter((g,b)=>{let p=a.routes[g.route.id];if(!p||!p.hasLoader)return!1;if(_(g,b)||f(g,b))return!0;if(g.route.shouldRevalidate){let E=g.route.shouldRevalidate({currentUrl:new URL(c.pathname+c.search+c.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:g.params,defaultShouldRevalidate:!0});if(typeof E=="boolean")return E}return!0}):[]}function getModuleLinkHrefs(e,r,{includeHydrateFallback:t}={}){return dedupeHrefs(e.map(a=>{let c=r.routes[a.route.id];if(!c)return[];let h=[c.module];return c.clientActionModule&&(h=h.concat(c.clientActionModule)),c.clientLoaderModule&&(h=h.concat(c.clientLoaderModule)),t&&c.hydrateFallbackModule&&(h=h.concat(c.hydrateFallbackModule)),c.imports&&(h=h.concat(c.imports)),h}).flat(1))}function dedupeHrefs(e){return[...new Set(e)]}function sortKeys(e){let r={},t=Object.keys(e).sort();for(let a of t)r[a]=e[a];return r}function dedupeLinkDescriptors(e,r){let t=new Set;return new Set(r),e.reduce((a,c)=>{let h=JSON.stringify(sortKeys(c));return t.has(h)||(t.add(h),a.push({key:h,link:c})),a},[])}function useDataRouterContext2(){let e=reactExports.useContext(DataRouterContext);return invariant2(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function useDataRouterStateContext(){let e=reactExports.useContext(DataRouterStateContext);return invariant2(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let e=reactExports.useContext(FrameworkContext);return invariant2(e,"You must render this element inside a <HydratedRouter> element"),e}function usePrefetchBehavior(e,r){let t=reactExports.useContext(FrameworkContext),[a,c]=reactExports.useState(!1),[h,_]=reactExports.useState(!1),{onFocus:f,onBlur:g,onMouseEnter:b,onMouseLeave:p,onTouchStart:E}=r,M=reactExports.useRef(null);reactExports.useEffect(()=>{if(e==="render"&&_(!0),e==="viewport"){let l=v=>{v.forEach(w=>{_(w.isIntersecting)})},s=new IntersectionObserver(l,{threshold:.5});return M.current&&s.observe(M.current),()=>{s.disconnect()}}},[e]),reactExports.useEffect(()=>{if(a){let l=setTimeout(()=>{_(!0)},100);return()=>{clearTimeout(l)}}},[a]);let R=()=>{c(!0)},z=()=>{c(!1),_(!1)};return t?e!=="intent"?[h,M,{}]:[h,M,{onFocus:composeEventHandlers(f,R),onBlur:composeEventHandlers(g,z),onMouseEnter:composeEventHandlers(b,R),onMouseLeave:composeEventHandlers(p,z),onTouchStart:composeEventHandlers(E,R)}]:[!1,M,{}]}function composeEventHandlers(e,r){return t=>{e&&e(t),t.defaultPrevented||r(t)}}function PrefetchPageLinks({page:e,...r}){let{router:t}=useDataRouterContext2(),a=reactExports.useMemo(()=>matchRoutes(t.routes,e,t.basename),[t.routes,e,t.basename]);return a?reactExports.createElement(PrefetchPageLinksImpl,{page:e,matches:a,...r}):null}function useKeyedPrefetchLinks(e){let{manifest:r,routeModules:t}=useFrameworkContext(),[a,c]=reactExports.useState([]);return reactExports.useEffect(()=>{let h=!1;return getKeyedPrefetchLinks(e,r,t).then(_=>{h||c(_)}),()=>{h=!0}},[e,r,t]),a}function PrefetchPageLinksImpl({page:e,matches:r,...t}){let a=useLocation(),{manifest:c,routeModules:h}=useFrameworkContext(),{basename:_}=useDataRouterContext2(),{loaderData:f,matches:g}=useDataRouterStateContext(),b=reactExports.useMemo(()=>getNewMatchesForLinks(e,r,g,c,a,"data"),[e,r,g,c,a]),p=reactExports.useMemo(()=>getNewMatchesForLinks(e,r,g,c,a,"assets"),[e,r,g,c,a]),E=reactExports.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let z=new Set,l=!1;if(r.forEach(v=>{let w=c.routes[v.route.id];!w||!w.hasLoader||(!b.some(S=>S.route.id===v.route.id)&&v.route.id in f&&h[v.route.id]?.shouldRevalidate||w.hasClientLoader?l=!0:z.add(v.route.id))}),z.size===0)return[];let s=singleFetchUrl(e,_,"data");return l&&z.size>0&&s.searchParams.set("_routes",r.filter(v=>z.has(v.route.id)).map(v=>v.route.id).join(",")),[s.pathname+s.search]},[_,f,a,c,b,r,e,h]),M=reactExports.useMemo(()=>getModuleLinkHrefs(p,c),[p,c]),R=useKeyedPrefetchLinks(p);return reactExports.createElement(reactExports.Fragment,null,E.map(z=>reactExports.createElement("link",{key:z,rel:"prefetch",as:"fetch",href:z,...t})),M.map(z=>reactExports.createElement("link",{key:z,rel:"modulepreload",href:z,...t})),R.map(({key:z,link:l})=>reactExports.createElement("link",{key:z,nonce:t.nonce,...l})))}function mergeRefs(...e){return r=>{e.forEach(t=>{typeof t=="function"?t(r):t!=null&&(t.current=r)})}}var isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser&&(window.__reactRouterVersion="7.8.2")}catch{}function BrowserRouter({basename:e,children:r,window:t}){let a=reactExports.useRef();a.current==null&&(a.current=createBrowserHistory({window:t,v5Compat:!0}));let c=a.current,[h,_]=reactExports.useState({action:c.action,location:c.location}),f=reactExports.useCallback(g=>{reactExports.startTransition(()=>_(g))},[_]);return reactExports.useLayoutEffect(()=>c.listen(f),[c,f]),reactExports.createElement(Router,{basename:e,children:r,location:h.location,navigationType:h.action,navigator:c})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:r,discover:t="render",prefetch:a="none",relative:c,reloadDocument:h,replace:_,state:f,target:g,to:b,preventScrollReset:p,viewTransition:E,...M},R){let{basename:z}=reactExports.useContext(NavigationContext),l=typeof b=="string"&&ABSOLUTE_URL_REGEX2.test(b),s,v=!1;if(typeof b=="string"&&l&&(s=b,isBrowser))try{let I=new URL(window.location.href),O=b.startsWith("//")?new URL(I.protocol+b):new URL(b),D=stripBasename(O.pathname,z);O.origin===I.origin&&D!=null?b=D+O.search+O.hash:v=!0}catch{warning(!1,`<Link to="${b}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=useHref(b,{relative:c}),[S,A,u]=usePrefetchBehavior(a,M),y=useLinkClickHandler(b,{replace:_,state:f,target:g,preventScrollReset:p,relative:c,viewTransition:E});function C(I){r&&r(I),I.defaultPrevented||y(I)}let k=reactExports.createElement("a",{...M,...u,href:s||w,onClick:v||h?r:C,ref:mergeRefs(R,A),target:g,"data-discover":!l&&t==="render"?"true":void 0});return S&&!l?reactExports.createElement(reactExports.Fragment,null,k,reactExports.createElement(PrefetchPageLinks,{page:w})):k});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":r="page",caseSensitive:t=!1,className:a="",end:c=!1,style:h,to:_,viewTransition:f,children:g,...b},p){let E=useResolvedPath(_,{relative:b.relative}),M=useLocation(),R=reactExports.useContext(DataRouterStateContext),{navigator:z,basename:l}=reactExports.useContext(NavigationContext),s=R!=null&&useViewTransitionState(E)&&f===!0,v=z.encodeLocation?z.encodeLocation(E).pathname:E.pathname,w=M.pathname,S=R&&R.navigation&&R.navigation.location?R.navigation.location.pathname:null;t||(w=w.toLowerCase(),S=S?S.toLowerCase():null,v=v.toLowerCase()),S&&l&&(S=stripBasename(S,l)||S);const A=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let u=w===v||!c&&w.startsWith(v)&&w.charAt(A)==="/",y=S!=null&&(S===v||!c&&S.startsWith(v)&&S.charAt(v.length)==="/"),C={isActive:u,isPending:y,isTransitioning:s},k=u?r:void 0,I;typeof a=="function"?I=a(C):I=[a,u?"active":null,y?"pending":null,s?"transitioning":null].filter(Boolean).join(" ");let O=typeof h=="function"?h(C):h;return reactExports.createElement(Link,{...b,"aria-current":k,className:I,ref:p,style:O,to:_,viewTransition:f},typeof g=="function"?g(C):g)});NavLink.displayName="NavLink";var Form$2=reactExports.forwardRef(({discover:e="render",fetcherKey:r,navigate:t,reloadDocument:a,replace:c,state:h,method:_=defaultMethod,action:f,onSubmit:g,relative:b,preventScrollReset:p,viewTransition:E,...M},R)=>{let z=useSubmit(),l=useFormAction(f,{relative:b}),s=_.toLowerCase()==="get"?"get":"post",v=typeof f=="string"&&ABSOLUTE_URL_REGEX2.test(f),w=S=>{if(g&&g(S),S.defaultPrevented)return;S.preventDefault();let A=S.nativeEvent.submitter,u=A?.getAttribute("formmethod")||_;z(A||S.currentTarget,{fetcherKey:r,method:u,navigate:t,replace:c,state:h,relative:b,preventScrollReset:p,viewTransition:E})};return reactExports.createElement("form",{ref:R,method:s,action:l,onSubmit:a?g:w,...M,"data-discover":!v&&e==="render"?"true":void 0})});Form$2.displayName="Form";function getDataRouterConsoleError2(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(e){let r=reactExports.useContext(DataRouterContext);return invariant(r,getDataRouterConsoleError2(e)),r}function useLinkClickHandler(e,{target:r,replace:t,state:a,preventScrollReset:c,relative:h,viewTransition:_}={}){let f=useNavigate(),g=useLocation(),b=useResolvedPath(e,{relative:h});return reactExports.useCallback(p=>{if(shouldProcessLinkClick(p,r)){p.preventDefault();let E=t!==void 0?t:createPath(g)===createPath(b);f(e,{replace:E,state:a,preventScrollReset:c,relative:h,viewTransition:_})}},[g,f,b,t,a,r,e,c,h,_])}function useSearchParams(e){warning(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let r=reactExports.useRef(createSearchParams(e)),t=reactExports.useRef(!1),a=useLocation(),c=reactExports.useMemo(()=>getSearchParamsForLocation(a.search,t.current?null:r.current),[a.search]),h=useNavigate(),_=reactExports.useCallback((f,g)=>{const b=createSearchParams(typeof f=="function"?f(new URLSearchParams(c)):f);t.current=!0,h("?"+b,g)},[h,c]);return[c,_]}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:e}=useDataRouterContext3("useSubmit"),{basename:r}=reactExports.useContext(NavigationContext),t=useRouteId();return reactExports.useCallback(async(a,c={})=>{let{action:h,method:_,encType:f,formData:g,body:b}=getFormSubmissionInfo(a,r);if(c.navigate===!1){let p=c.fetcherKey||getUniqueFetcherId();await e.fetch(p,t,c.action||h,{preventScrollReset:c.preventScrollReset,formData:g,body:b,formMethod:c.method||_,formEncType:c.encType||f,flushSync:c.flushSync})}else await e.navigate(c.action||h,{preventScrollReset:c.preventScrollReset,formData:g,body:b,formMethod:c.method||_,formEncType:c.encType||f,replace:c.replace,state:c.state,fromRouteId:t,flushSync:c.flushSync,viewTransition:c.viewTransition})},[e,r,t])}function useFormAction(e,{relative:r}={}){let{basename:t}=reactExports.useContext(NavigationContext),a=reactExports.useContext(RouteContext);invariant(a,"useFormAction must be used inside a RouteContext");let[c]=a.matches.slice(-1),h={...useResolvedPath(e||".",{relative:r})},_=useLocation();if(e==null){h.search=_.search;let f=new URLSearchParams(h.search),g=f.getAll("index");if(g.some(p=>p==="")){f.delete("index"),g.filter(E=>E).forEach(E=>f.append("index",E));let p=f.toString();h.search=p?`?${p}`:""}}return(!e||e===".")&&c.route.index&&(h.search=h.search?h.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(h.pathname=h.pathname==="/"?t:joinPaths([t,h.pathname])),createPath(h)}function useViewTransitionState(e,{relative:r}={}){let t=reactExports.useContext(ViewTransitionContext);invariant(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=useDataRouterContext3("useViewTransitionState"),c=useResolvedPath(e,{relative:r});if(!t.isTransitioning)return!1;let h=stripBasename(t.currentLocation.pathname,a)||t.currentLocation.pathname,_=stripBasename(t.nextLocation.pathname,a)||t.nextLocation.pathname;return matchPath(c.pathname,_)!=null||matchPath(c.pathname,h)!=null}var reactDomExports=requireReactDom();const Kt=getDefaultExportFromCjs(reactDomExports);function cc(e){if(typeof e=="string"||typeof e=="number")return""+e;let r="";if(Array.isArray(e))for(let t=0,a;t<e.length;t++)(a=cc(e[t]))!==""&&(r+=(r&&" ")+a);else for(let t in e)e[t]&&(r+=(r&&" ")+t);return r}var withSelector={exports:{}},withSelector_production={},shim={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredUseSyncExternalStoreShim_production;function requireUseSyncExternalStoreShim_production(){if(hasRequiredUseSyncExternalStoreShim_production)return useSyncExternalStoreShim_production;hasRequiredUseSyncExternalStoreShim_production=1;var e=requireReact();function r(E,M){return E===M&&(E!==0||1/E===1/M)||E!==E&&M!==M}var t=typeof Object.is=="function"?Object.is:r,a=e.useState,c=e.useEffect,h=e.useLayoutEffect,_=e.useDebugValue;function f(E,M){var R=M(),z=a({inst:{value:R,getSnapshot:M}}),l=z[0].inst,s=z[1];return h(function(){l.value=R,l.getSnapshot=M,g(l)&&s({inst:l})},[E,R,M]),c(function(){return g(l)&&s({inst:l}),E(function(){g(l)&&s({inst:l})})},[E]),_(R),R}function g(E){var M=E.getSnapshot;E=E.value;try{var R=M();return!t(E,R)}catch{return!0}}function b(E,M){return M()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?b:f;return useSyncExternalStoreShim_production.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:p,useSyncExternalStoreShim_production}var hasRequiredShim;function requireShim(){return hasRequiredShim||(hasRequiredShim=1,shim.exports=requireUseSyncExternalStoreShim_production()),shim.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredWithSelector_production;function requireWithSelector_production(){if(hasRequiredWithSelector_production)return withSelector_production;hasRequiredWithSelector_production=1;var e=requireReact(),r=requireShim();function t(b,p){return b===p&&(b!==0||1/b===1/p)||b!==b&&p!==p}var a=typeof Object.is=="function"?Object.is:t,c=r.useSyncExternalStore,h=e.useRef,_=e.useEffect,f=e.useMemo,g=e.useDebugValue;return withSelector_production.useSyncExternalStoreWithSelector=function(b,p,E,M,R){var z=h(null);if(z.current===null){var l={hasValue:!1,value:null};z.current=l}else l=z.current;z=f(function(){function v(y){if(!w){if(w=!0,S=y,y=M(y),R!==void 0&&l.hasValue){var C=l.value;if(R(C,y))return A=C}return A=y}if(C=A,a(S,y))return C;var k=M(y);return R!==void 0&&R(C,k)?(S=y,C):(S=y,A=k)}var w=!1,S,A,u=E===void 0?null:E;return[function(){return v(p())},u===null?void 0:function(){return v(u())}]},[p,E,M,R]);var s=c(b,z[0],z[1]);return _(function(){l.hasValue=!0,l.value=s},[s]),g(s),s},withSelector_production}var hasRequiredWithSelector;function requireWithSelector(){return hasRequiredWithSelector||(hasRequiredWithSelector=1,withSelector.exports=requireWithSelector_production()),withSelector.exports}var withSelectorExports=requireWithSelector();const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports),__vite_import_meta_env__={},createStoreImpl=e=>{let r;const t=new Set,a=(p,E)=>{const M=typeof p=="function"?p(r):p;if(!Object.is(M,r)){const R=r;r=E??(typeof M!="object"||M===null)?M:Object.assign({},r,M),t.forEach(z=>z(r,R))}},c=()=>r,g={setState:a,getState:c,getInitialState:()=>b,subscribe:p=>(t.add(p),()=>t.delete(p)),destroy:()=>{(__vite_import_meta_env__?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},b=r=e(a,c,g);return g},createStore=e=>e?createStoreImpl(e):createStoreImpl,{useDebugValue}=React,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports,identity$2=e=>e;function useStoreWithEqualityFn(e,r=identity$2,t){const a=useSyncExternalStoreWithSelector(e.subscribe,e.getState,e.getServerState||e.getInitialState,r,t);return useDebugValue(a),a}const createWithEqualityFnImpl=(e,r)=>{const t=createStore(e),a=(c,h=r)=>useStoreWithEqualityFn(t,c,h);return Object.assign(a,t),a},createWithEqualityFn=(e,r)=>e?createWithEqualityFnImpl(e,r):createWithEqualityFnImpl;function shallow$1(e,r){if(Object.is(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;if(e instanceof Map&&r instanceof Map){if(e.size!==r.size)return!1;for(const[a,c]of e)if(!Object.is(c,r.get(a)))return!1;return!0}if(e instanceof Set&&r instanceof Set){if(e.size!==r.size)return!1;for(const a of e)if(!r.has(a))return!1;return!0}const t=Object.keys(e);if(t.length!==Object.keys(r).length)return!1;for(const a of t)if(!Object.prototype.hasOwnProperty.call(r,a)||!Object.is(e[a],r[a]))return!1;return!0}var noop$1={value:()=>{}};function dispatch(){for(var e=0,r=arguments.length,t={},a;e<r;++e){if(!(a=arguments[e]+"")||a in t||/[\s.]/.test(a))throw new Error("illegal type: "+a);t[a]=[]}return new Dispatch(t)}function Dispatch(e){this._=e}function parseTypenames$1(e,r){return e.trim().split(/^|\s+/).map(function(t){var a="",c=t.indexOf(".");if(c>=0&&(a=t.slice(c+1),t=t.slice(0,c)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:a}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(e,r){var t=this._,a=parseTypenames$1(e+"",t),c,h=-1,_=a.length;if(arguments.length<2){for(;++h<_;)if((c=(e=a[h]).type)&&(c=get$1(t[c],e.name)))return c;return}if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++h<_;)if(c=(e=a[h]).type)t[c]=set$1(t[c],e.name,r);else if(r==null)for(c in t)t[c]=set$1(t[c],e.name,null);return this},copy:function(){var e={},r=this._;for(var t in r)e[t]=r[t].slice();return new Dispatch(e)},call:function(e,r){if((c=arguments.length-2)>0)for(var t=new Array(c),a=0,c,h;a<c;++a)t[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(h=this._[e],a=0,c=h.length;a<c;++a)h[a].value.apply(r,t)},apply:function(e,r,t){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var a=this._[e],c=0,h=a.length;c<h;++c)a[c].value.apply(r,t)}};function get$1(e,r){for(var t=0,a=e.length,c;t<a;++t)if((c=e[t]).name===r)return c.value}function set$1(e,r,t){for(var a=0,c=e.length;a<c;++a)if(e[a].name===r){e[a]=noop$1,e=e.slice(0,a).concat(e.slice(a+1));break}return t!=null&&e.push({name:r,value:t}),e}var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(e){var r=e+="",t=r.indexOf(":");return t>=0&&(r=e.slice(0,t))!=="xmlns"&&(e=e.slice(t+1)),namespaces.hasOwnProperty(r)?{space:namespaces[r],local:e}:e}function creatorInherit(e){return function(){var r=this.ownerDocument,t=this.namespaceURI;return t===xhtml&&r.documentElement.namespaceURI===xhtml?r.createElement(e):r.createElementNS(t,e)}}function creatorFixed(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function creator(e){var r=namespace(e);return(r.local?creatorFixed:creatorInherit)(r)}function none(){}function selector$h(e){return e==null?none:function(){return this.querySelector(e)}}function selection_select(e){typeof e!="function"&&(e=selector$h(e));for(var r=this._groups,t=r.length,a=new Array(t),c=0;c<t;++c)for(var h=r[c],_=h.length,f=a[c]=new Array(_),g,b,p=0;p<_;++p)(g=h[p])&&(b=e.call(g,g.__data__,p,h))&&("__data__"in g&&(b.__data__=g.__data__),f[p]=b);return new Selection$1(a,this._parents)}function array(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function empty(){return[]}function selectorAll(e){return e==null?empty:function(){return this.querySelectorAll(e)}}function arrayAll(e){return function(){return array(e.apply(this,arguments))}}function selection_selectAll(e){typeof e=="function"?e=arrayAll(e):e=selectorAll(e);for(var r=this._groups,t=r.length,a=[],c=[],h=0;h<t;++h)for(var _=r[h],f=_.length,g,b=0;b<f;++b)(g=_[b])&&(a.push(e.call(g,g.__data__,b,_)),c.push(g));return new Selection$1(a,c)}function matcher(e){return function(){return this.matches(e)}}function childMatcher(e){return function(r){return r.matches(e)}}var find=Array.prototype.find;function childFind(e){return function(){return find.call(this.children,e)}}function childFirst(){return this.firstElementChild}function selection_selectChild(e){return this.select(e==null?childFirst:childFind(typeof e=="function"?e:childMatcher(e)))}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(e){return function(){return filter.call(this.children,e)}}function selection_selectChildren(e){return this.selectAll(e==null?children:childrenFilter(typeof e=="function"?e:childMatcher(e)))}function selection_filter(e){typeof e!="function"&&(e=matcher(e));for(var r=this._groups,t=r.length,a=new Array(t),c=0;c<t;++c)for(var h=r[c],_=h.length,f=a[c]=[],g,b=0;b<_;++b)(g=h[b])&&e.call(g,g.__data__,b,h)&&f.push(g);return new Selection$1(a,this._parents)}function sparse(e){return new Array(e.length)}function selection_enter(){return new Selection$1(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(e,r){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=r}EnterNode.prototype={constructor:EnterNode,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,r){return this._parent.insertBefore(e,r)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function constant$3(e){return function(){return e}}function bindIndex(e,r,t,a,c,h){for(var _=0,f,g=r.length,b=h.length;_<b;++_)(f=r[_])?(f.__data__=h[_],a[_]=f):t[_]=new EnterNode(e,h[_]);for(;_<g;++_)(f=r[_])&&(c[_]=f)}function bindKey(e,r,t,a,c,h,_){var f,g,b=new Map,p=r.length,E=h.length,M=new Array(p),R;for(f=0;f<p;++f)(g=r[f])&&(M[f]=R=_.call(g,g.__data__,f,r)+"",b.has(R)?c[f]=g:b.set(R,g));for(f=0;f<E;++f)R=_.call(e,h[f],f,h)+"",(g=b.get(R))?(a[f]=g,g.__data__=h[f],b.delete(R)):t[f]=new EnterNode(e,h[f]);for(f=0;f<p;++f)(g=r[f])&&b.get(M[f])===g&&(c[f]=g)}function datum(e){return e.__data__}function selection_data(e,r){if(!arguments.length)return Array.from(this,datum);var t=r?bindKey:bindIndex,a=this._parents,c=this._groups;typeof e!="function"&&(e=constant$3(e));for(var h=c.length,_=new Array(h),f=new Array(h),g=new Array(h),b=0;b<h;++b){var p=a[b],E=c[b],M=E.length,R=arraylike(e.call(p,p&&p.__data__,b,a)),z=R.length,l=f[b]=new Array(z),s=_[b]=new Array(z),v=g[b]=new Array(M);t(p,E,l,s,v,R,r);for(var w=0,S=0,A,u;w<z;++w)if(A=l[w]){for(w>=S&&(S=w+1);!(u=s[S])&&++S<z;);A._next=u||null}}return _=new Selection$1(_,a),_._enter=f,_._exit=g,_}function arraylike(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function selection_exit(){return new Selection$1(this._exit||this._groups.map(sparse),this._parents)}function selection_join(e,r,t){var a=this.enter(),c=this,h=this.exit();return typeof e=="function"?(a=e(a),a&&(a=a.selection())):a=a.append(e+""),r!=null&&(c=r(c),c&&(c=c.selection())),t==null?h.remove():t(h),a&&c?a.merge(c).order():c}function selection_merge(e){for(var r=e.selection?e.selection():e,t=this._groups,a=r._groups,c=t.length,h=a.length,_=Math.min(c,h),f=new Array(c),g=0;g<_;++g)for(var b=t[g],p=a[g],E=b.length,M=f[g]=new Array(E),R,z=0;z<E;++z)(R=b[z]||p[z])&&(M[z]=R);for(;g<c;++g)f[g]=t[g];return new Selection$1(f,this._parents)}function selection_order(){for(var e=this._groups,r=-1,t=e.length;++r<t;)for(var a=e[r],c=a.length-1,h=a[c],_;--c>=0;)(_=a[c])&&(h&&_.compareDocumentPosition(h)^4&&h.parentNode.insertBefore(_,h),h=_);return this}function selection_sort(e){e||(e=ascending);function r(E,M){return E&&M?e(E.__data__,M.__data__):!E-!M}for(var t=this._groups,a=t.length,c=new Array(a),h=0;h<a;++h){for(var _=t[h],f=_.length,g=c[h]=new Array(f),b,p=0;p<f;++p)(b=_[p])&&(g[p]=b);g.sort(r)}return new Selection$1(c,this._parents).order()}function ascending(e,r){return e<r?-1:e>r?1:e>=r?0:NaN}function selection_call(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var e=this._groups,r=0,t=e.length;r<t;++r)for(var a=e[r],c=0,h=a.length;c<h;++c){var _=a[c];if(_)return _}return null}function selection_size(){let e=0;for(const r of this)++e;return e}function selection_empty(){return!this.node()}function selection_each(e){for(var r=this._groups,t=0,a=r.length;t<a;++t)for(var c=r[t],h=0,_=c.length,f;h<_;++h)(f=c[h])&&e.call(f,f.__data__,h,c);return this}function attrRemove$1(e){return function(){this.removeAttribute(e)}}function attrRemoveNS$1(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant$1(e,r){return function(){this.setAttribute(e,r)}}function attrConstantNS$1(e,r){return function(){this.setAttributeNS(e.space,e.local,r)}}function attrFunction$1(e,r){return function(){var t=r.apply(this,arguments);t==null?this.removeAttribute(e):this.setAttribute(e,t)}}function attrFunctionNS$1(e,r){return function(){var t=r.apply(this,arguments);t==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}function selection_attr(e,r){var t=namespace(e);if(arguments.length<2){var a=this.node();return t.local?a.getAttributeNS(t.space,t.local):a.getAttribute(t)}return this.each((r==null?t.local?attrRemoveNS$1:attrRemove$1:typeof r=="function"?t.local?attrFunctionNS$1:attrFunction$1:t.local?attrConstantNS$1:attrConstant$1)(t,r))}function defaultView(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function styleRemove$1(e){return function(){this.style.removeProperty(e)}}function styleConstant$1(e,r,t){return function(){this.style.setProperty(e,r,t)}}function styleFunction$1(e,r,t){return function(){var a=r.apply(this,arguments);a==null?this.style.removeProperty(e):this.style.setProperty(e,a,t)}}function selection_style(e,r,t){return arguments.length>1?this.each((r==null?styleRemove$1:typeof r=="function"?styleFunction$1:styleConstant$1)(e,r,t??"")):styleValue(this.node(),e)}function styleValue(e,r){return e.style.getPropertyValue(r)||defaultView(e).getComputedStyle(e,null).getPropertyValue(r)}function propertyRemove(e){return function(){delete this[e]}}function propertyConstant(e,r){return function(){this[e]=r}}function propertyFunction(e,r){return function(){var t=r.apply(this,arguments);t==null?delete this[e]:this[e]=t}}function selection_property(e,r){return arguments.length>1?this.each((r==null?propertyRemove:typeof r=="function"?propertyFunction:propertyConstant)(e,r)):this.node()[e]}function classArray(e){return e.trim().split(/^|\s+/)}function classList(e){return e.classList||new ClassList(e)}function ClassList(e){this._node=e,this._names=classArray(e.getAttribute("class")||"")}ClassList.prototype={add:function(e){var r=this._names.indexOf(e);r<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var r=this._names.indexOf(e);r>=0&&(this._names.splice(r,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function classedAdd(e,r){for(var t=classList(e),a=-1,c=r.length;++a<c;)t.add(r[a])}function classedRemove(e,r){for(var t=classList(e),a=-1,c=r.length;++a<c;)t.remove(r[a])}function classedTrue(e){return function(){classedAdd(this,e)}}function classedFalse(e){return function(){classedRemove(this,e)}}function classedFunction(e,r){return function(){(r.apply(this,arguments)?classedAdd:classedRemove)(this,e)}}function selection_classed(e,r){var t=classArray(e+"");if(arguments.length<2){for(var a=classList(this.node()),c=-1,h=t.length;++c<h;)if(!a.contains(t[c]))return!1;return!0}return this.each((typeof r=="function"?classedFunction:r?classedTrue:classedFalse)(t,r))}function textRemove(){this.textContent=""}function textConstant$1(e){return function(){this.textContent=e}}function textFunction$1(e){return function(){var r=e.apply(this,arguments);this.textContent=r??""}}function selection_text(e){return arguments.length?this.each(e==null?textRemove:(typeof e=="function"?textFunction$1:textConstant$1)(e)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(e){return function(){this.innerHTML=e}}function htmlFunction(e){return function(){var r=e.apply(this,arguments);this.innerHTML=r??""}}function selection_html(e){return arguments.length?this.each(e==null?htmlRemove:(typeof e=="function"?htmlFunction:htmlConstant)(e)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(e){var r=typeof e=="function"?e:creator(e);return this.select(function(){return this.appendChild(r.apply(this,arguments))})}function constantNull(){return null}function selection_insert(e,r){var t=typeof e=="function"?e:creator(e),a=r==null?constantNull:typeof r=="function"?r:selector$h(r);return this.select(function(){return this.insertBefore(t.apply(this,arguments),a.apply(this,arguments)||null)})}function remove(){var e=this.parentNode;e&&e.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var e=this.cloneNode(!1),r=this.parentNode;return r?r.insertBefore(e,this.nextSibling):e}function selection_cloneDeep(){var e=this.cloneNode(!0),r=this.parentNode;return r?r.insertBefore(e,this.nextSibling):e}function selection_clone(e){return this.select(e?selection_cloneDeep:selection_cloneShallow)}function selection_datum(e){return arguments.length?this.property("__data__",e):this.node().__data__}function contextListener(e){return function(r){e.call(this,r,this.__data__)}}function parseTypenames(e){return e.trim().split(/^|\s+/).map(function(r){var t="",a=r.indexOf(".");return a>=0&&(t=r.slice(a+1),r=r.slice(0,a)),{type:r,name:t}})}function onRemove(e){return function(){var r=this.__on;if(r){for(var t=0,a=-1,c=r.length,h;t<c;++t)h=r[t],(!e.type||h.type===e.type)&&h.name===e.name?this.removeEventListener(h.type,h.listener,h.options):r[++a]=h;++a?r.length=a:delete this.__on}}}function onAdd(e,r,t){return function(){var a=this.__on,c,h=contextListener(r);if(a){for(var _=0,f=a.length;_<f;++_)if((c=a[_]).type===e.type&&c.name===e.name){this.removeEventListener(c.type,c.listener,c.options),this.addEventListener(c.type,c.listener=h,c.options=t),c.value=r;return}}this.addEventListener(e.type,h,t),c={type:e.type,name:e.name,value:r,listener:h,options:t},a?a.push(c):this.__on=[c]}}function selection_on(e,r,t){var a=parseTypenames(e+""),c,h=a.length,_;if(arguments.length<2){var f=this.node().__on;if(f){for(var g=0,b=f.length,p;g<b;++g)for(c=0,p=f[g];c<h;++c)if((_=a[c]).type===p.type&&_.name===p.name)return p.value}return}for(f=r?onAdd:onRemove,c=0;c<h;++c)this.each(f(a[c],r,t));return this}function dispatchEvent(e,r,t){var a=defaultView(e),c=a.CustomEvent;typeof c=="function"?c=new c(r,t):(c=a.document.createEvent("Event"),t?(c.initEvent(r,t.bubbles,t.cancelable),c.detail=t.detail):c.initEvent(r,!1,!1)),e.dispatchEvent(c)}function dispatchConstant(e,r){return function(){return dispatchEvent(this,e,r)}}function dispatchFunction(e,r){return function(){return dispatchEvent(this,e,r.apply(this,arguments))}}function selection_dispatch(e,r){return this.each((typeof r=="function"?dispatchFunction:dispatchConstant)(e,r))}function*selection_iterator(){for(var e=this._groups,r=0,t=e.length;r<t;++r)for(var a=e[r],c=0,h=a.length,_;c<h;++c)(_=a[c])&&(yield _)}var root=[null];function Selection$1(e,r){this._groups=e,this._parents=r}function selection(){return new Selection$1([[document.documentElement]],root)}function selection_selection(){return this}Selection$1.prototype=selection.prototype={constructor:Selection$1,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};function select(e){return typeof e=="string"?new Selection$1([[document.querySelector(e)]],[document.documentElement]):new Selection$1([[e]],root)}function sourceEvent(e){let r;for(;r=e.sourceEvent;)e=r;return e}function pointer(e,r){if(e=sourceEvent(e),r===void 0&&(r=e.currentTarget),r){var t=r.ownerSVGElement||r;if(t.createSVGPoint){var a=t.createSVGPoint();return a.x=e.clientX,a.y=e.clientY,a=a.matrixTransform(r.getScreenCTM().inverse()),[a.x,a.y]}if(r.getBoundingClientRect){var c=r.getBoundingClientRect();return[e.clientX-c.left-r.clientLeft,e.clientY-c.top-r.clientTop]}}return[e.pageX,e.pageY]}const nonpassive={passive:!1},nonpassivecapture={capture:!0,passive:!1};function nopropagation$1(e){e.stopImmediatePropagation()}function noevent$1(e){e.preventDefault(),e.stopImmediatePropagation()}function dragDisable(e){var r=e.document.documentElement,t=select(e).on("dragstart.drag",noevent$1,nonpassivecapture);"onselectstart"in r?t.on("selectstart.drag",noevent$1,nonpassivecapture):(r.__noselect=r.style.MozUserSelect,r.style.MozUserSelect="none")}function yesdrag(e,r){var t=e.document.documentElement,a=select(e).on("dragstart.drag",null);r&&(a.on("click.drag",noevent$1,nonpassivecapture),setTimeout(function(){a.on("click.drag",null)},0)),"onselectstart"in t?a.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const constant$2=e=>()=>e;function DragEvent(e,{sourceEvent:r,subject:t,target:a,identifier:c,active:h,x:_,y:f,dx:g,dy:b,dispatch:p}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:r,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},identifier:{value:c,enumerable:!0,configurable:!0},active:{value:h,enumerable:!0,configurable:!0},x:{value:_,enumerable:!0,configurable:!0},y:{value:f,enumerable:!0,configurable:!0},dx:{value:g,enumerable:!0,configurable:!0},dy:{value:b,enumerable:!0,configurable:!0},_:{value:p}})}DragEvent.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function defaultFilter$1(e){return!e.ctrlKey&&!e.button}function defaultContainer(){return this.parentNode}function defaultSubject(e,r){return r??{x:e.x,y:e.y}}function defaultTouchable$1(){return navigator.maxTouchPoints||"ontouchstart"in this}function drag(){var e=defaultFilter$1,r=defaultContainer,t=defaultSubject,a=defaultTouchable$1,c={},h=dispatch("start","drag","end"),_=0,f,g,b,p,E=0;function M(A){A.on("mousedown.drag",R).filter(a).on("touchstart.drag",s).on("touchmove.drag",v,nonpassive).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function R(A,u){if(!(p||!e.call(this,A,u))){var y=S(this,r.call(this,A,u),A,u,"mouse");y&&(select(A.view).on("mousemove.drag",z,nonpassivecapture).on("mouseup.drag",l,nonpassivecapture),dragDisable(A.view),nopropagation$1(A),b=!1,f=A.clientX,g=A.clientY,y("start",A))}}function z(A){if(noevent$1(A),!b){var u=A.clientX-f,y=A.clientY-g;b=u*u+y*y>E}c.mouse("drag",A)}function l(A){select(A.view).on("mousemove.drag mouseup.drag",null),yesdrag(A.view,b),noevent$1(A),c.mouse("end",A)}function s(A,u){if(e.call(this,A,u)){var y=A.changedTouches,C=r.call(this,A,u),k=y.length,I,O;for(I=0;I<k;++I)(O=S(this,C,A,u,y[I].identifier,y[I]))&&(nopropagation$1(A),O("start",A,y[I]))}}function v(A){var u=A.changedTouches,y=u.length,C,k;for(C=0;C<y;++C)(k=c[u[C].identifier])&&(noevent$1(A),k("drag",A,u[C]))}function w(A){var u=A.changedTouches,y=u.length,C,k;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),C=0;C<y;++C)(k=c[u[C].identifier])&&(nopropagation$1(A),k("end",A,u[C]))}function S(A,u,y,C,k,I){var O=h.copy(),D=pointer(I||y,u),X,j,B;if((B=t.call(A,new DragEvent("beforestart",{sourceEvent:y,target:M,identifier:k,active:_,x:D[0],y:D[1],dx:0,dy:0,dispatch:O}),C))!=null)return X=B.x-D[0]||0,j=B.y-D[1]||0,function $(H,q,W){var Y=D,G;switch(H){case"start":c[k]=$,G=_++;break;case"end":delete c[k],--_;case"drag":D=pointer(W||q,u),G=_;break}O.call(H,A,new DragEvent(H,{sourceEvent:q,subject:B,target:M,identifier:k,active:G,x:D[0]+X,y:D[1]+j,dx:D[0]-Y[0],dy:D[1]-Y[1],dispatch:O}),C)}}return M.filter=function(A){return arguments.length?(e=typeof A=="function"?A:constant$2(!!A),M):e},M.container=function(A){return arguments.length?(r=typeof A=="function"?A:constant$2(A),M):r},M.subject=function(A){return arguments.length?(t=typeof A=="function"?A:constant$2(A),M):t},M.touchable=function(A){return arguments.length?(a=typeof A=="function"?A:constant$2(!!A),M):a},M.on=function(){var A=h.on.apply(h,arguments);return A===h?M:A},M.clickDistance=function(A){return arguments.length?(E=(A=+A)*A,M):Math.sqrt(E)},M}function define(e,r,t){e.prototype=r.prototype=t,t.constructor=e}function extend(e,r){var t=Object.create(e.prototype);for(var a in r)t[a]=r[a];return t}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(e){var r,t;return e=(e+"").trim().toLowerCase(),(r=reHex.exec(e))?(t=r[1].length,r=parseInt(r[1],16),t===6?rgbn(r):t===3?new Rgb(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):t===8?rgba(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):t===4?rgba(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=reRgbInteger.exec(e))?new Rgb(r[1],r[2],r[3],1):(r=reRgbPercent.exec(e))?new Rgb(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=reRgbaInteger.exec(e))?rgba(r[1],r[2],r[3],r[4]):(r=reRgbaPercent.exec(e))?rgba(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=reHslPercent.exec(e))?hsla(r[1],r[2]/100,r[3]/100,1):(r=reHslaPercent.exec(e))?hsla(r[1],r[2]/100,r[3]/100,r[4]):named.hasOwnProperty(e)?rgbn(named[e]):e==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,e&255,1)}function rgba(e,r,t,a){return a<=0&&(e=r=t=NaN),new Rgb(e,r,t,a)}function rgbConvert(e){return e instanceof Color||(e=color(e)),e?(e=e.rgb(),new Rgb(e.r,e.g,e.b,e.opacity)):new Rgb}function rgb(e,r,t,a){return arguments.length===1?rgbConvert(e):new Rgb(e,r,t,a??1)}function Rgb(e,r,t,a){this.r=+e,this.g=+r,this.b=+t,this.opacity=+a}define(Rgb,rgb,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const e=clampa(this.opacity);return`${e===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${e===1?")":`, ${e})`}`}function clampa(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function clampi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hex(e){return e=clampi(e),(e<16?"0":"")+e.toString(16)}function hsla(e,r,t,a){return a<=0?e=r=t=NaN:t<=0||t>=1?e=r=NaN:r<=0&&(e=NaN),new Hsl(e,r,t,a)}function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color||(e=color(e)),!e)return new Hsl;if(e instanceof Hsl)return e;e=e.rgb();var r=e.r/255,t=e.g/255,a=e.b/255,c=Math.min(r,t,a),h=Math.max(r,t,a),_=NaN,f=h-c,g=(h+c)/2;return f?(r===h?_=(t-a)/f+(t<a)*6:t===h?_=(a-r)/f+2:_=(r-t)/f+4,f/=g<.5?h+c:2-h-c,_*=60):f=g>0&&g<1?0:_,new Hsl(_,f,g,e.opacity)}function hsl(e,r,t,a){return arguments.length===1?hslConvert(e):new Hsl(e,r,t,a??1)}function Hsl(e,r,t,a){this.h=+e,this.s=+r,this.l=+t,this.opacity=+a}define(Hsl,hsl,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,a=t+(t<.5?t:1-t)*r,c=2*t-a;return new Rgb(hsl2rgb(e>=240?e-240:e+120,c,a),hsl2rgb(e,c,a),hsl2rgb(e<120?e+240:e-120,c,a),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=clampa(this.opacity);return`${e===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function clamph(e){return e=(e||0)%360,e<0?e+360:e}function clampt(e){return Math.max(0,Math.min(1,e||0))}function hsl2rgb(e,r,t){return(e<60?r+(t-r)*e/60:e<180?t:e<240?r+(t-r)*(240-e)/60:r)*255}const constant$1=e=>()=>e;function linear(e,r){return function(t){return e+t*r}}function exponential(e,r,t){return e=Math.pow(e,t),r=Math.pow(r,t)-e,t=1/t,function(a){return Math.pow(e+a*r,t)}}function gamma(e){return(e=+e)==1?nogamma:function(r,t){return t-r?exponential(r,t,e):constant$1(isNaN(r)?t:r)}}function nogamma(e,r){var t=r-e;return t?linear(e,t):constant$1(isNaN(e)?r:e)}const interpolateRgb=(function e(r){var t=gamma(r);function a(c,h){var _=t((c=rgb(c)).r,(h=rgb(h)).r),f=t(c.g,h.g),g=t(c.b,h.b),b=nogamma(c.opacity,h.opacity);return function(p){return c.r=_(p),c.g=f(p),c.b=g(p),c.opacity=b(p),c+""}}return a.gamma=e,a})(1);function interpolateNumber(e,r){return e=+e,r=+r,function(t){return e*(1-t)+r*t}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(e){return function(){return e}}function one(e){return function(r){return e(r)+""}}function interpolateString(e,r){var t=reA.lastIndex=reB.lastIndex=0,a,c,h,_=-1,f=[],g=[];for(e=e+"",r=r+"";(a=reA.exec(e))&&(c=reB.exec(r));)(h=c.index)>t&&(h=r.slice(t,h),f[_]?f[_]+=h:f[++_]=h),(a=a[0])===(c=c[0])?f[_]?f[_]+=c:f[++_]=c:(f[++_]=null,g.push({i:_,x:interpolateNumber(a,c)})),t=reB.lastIndex;return t<r.length&&(h=r.slice(t),f[_]?f[_]+=h:f[++_]=h),f.length<2?g[0]?one(g[0].x):zero(r):(r=g.length,function(b){for(var p=0,E;p<r;++p)f[(E=g[p]).i]=E.x(b);return f.join("")})}var degrees=180/Math.PI,identity$1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(e,r,t,a,c,h){var _,f,g;return(_=Math.sqrt(e*e+r*r))&&(e/=_,r/=_),(g=e*t+r*a)&&(t-=e*g,a-=r*g),(f=Math.sqrt(t*t+a*a))&&(t/=f,a/=f,g/=f),e*a<r*t&&(e=-e,r=-r,g=-g,_=-_),{translateX:c,translateY:h,rotate:Math.atan2(r,e)*degrees,skewX:Math.atan(g)*degrees,scaleX:_,scaleY:f}}var svgNode;function parseCss(e){const r=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return r.isIdentity?identity$1:decompose(r.a,r.b,r.c,r.d,r.e,r.f)}function parseSvg(e){return e==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",e),!(e=svgNode.transform.baseVal.consolidate()))?identity$1:(e=e.matrix,decompose(e.a,e.b,e.c,e.d,e.e,e.f))}function interpolateTransform(e,r,t,a){function c(b){return b.length?b.pop()+" ":""}function h(b,p,E,M,R,z){if(b!==E||p!==M){var l=R.push("translate(",null,r,null,t);z.push({i:l-4,x:interpolateNumber(b,E)},{i:l-2,x:interpolateNumber(p,M)})}else(E||M)&&R.push("translate("+E+r+M+t)}function _(b,p,E,M){b!==p?(b-p>180?p+=360:p-b>180&&(b+=360),M.push({i:E.push(c(E)+"rotate(",null,a)-2,x:interpolateNumber(b,p)})):p&&E.push(c(E)+"rotate("+p+a)}function f(b,p,E,M){b!==p?M.push({i:E.push(c(E)+"skewX(",null,a)-2,x:interpolateNumber(b,p)}):p&&E.push(c(E)+"skewX("+p+a)}function g(b,p,E,M,R,z){if(b!==E||p!==M){var l=R.push(c(R)+"scale(",null,",",null,")");z.push({i:l-4,x:interpolateNumber(b,E)},{i:l-2,x:interpolateNumber(p,M)})}else(E!==1||M!==1)&&R.push(c(R)+"scale("+E+","+M+")")}return function(b,p){var E=[],M=[];return b=e(b),p=e(p),h(b.translateX,b.translateY,p.translateX,p.translateY,E,M),_(b.rotate,p.rotate,E,M),f(b.skewX,p.skewX,E,M),g(b.scaleX,b.scaleY,p.scaleX,p.scaleY,E,M),b=p=null,function(R){for(var z=-1,l=M.length,s;++z<l;)E[(s=M[z]).i]=s.x(R);return E.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),epsilon2=1e-12;function cosh(e){return((e=Math.exp(e))+1/e)/2}function sinh(e){return((e=Math.exp(e))-1/e)/2}function tanh(e){return((e=Math.exp(2*e))-1)/(e+1)}const interpolateZoom=(function e(r,t,a){function c(h,_){var f=h[0],g=h[1],b=h[2],p=_[0],E=_[1],M=_[2],R=p-f,z=E-g,l=R*R+z*z,s,v;if(l<epsilon2)v=Math.log(M/b)/r,s=function(C){return[f+C*R,g+C*z,b*Math.exp(r*C*v)]};else{var w=Math.sqrt(l),S=(M*M-b*b+a*l)/(2*b*t*w),A=(M*M-b*b-a*l)/(2*M*t*w),u=Math.log(Math.sqrt(S*S+1)-S),y=Math.log(Math.sqrt(A*A+1)-A);v=(y-u)/r,s=function(C){var k=C*v,I=cosh(u),O=b/(t*w)*(I*tanh(r*k+u)-sinh(u));return[f+O*R,g+O*z,b*I/cosh(r*k+u)]}}return s.duration=v*1e3*r/Math.SQRT2,s}return c.rho=function(h){var _=Math.max(.001,+h),f=_*_,g=f*f;return e(_,f,g)},c})(Math.SQRT2,2,4);var frame=0,timeout$1=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(e,r,t){if(typeof e!="function")throw new TypeError("callback is not a function");t=(t==null?now():+t)+(r==null?0:+r),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=e,this._time=t,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(e,r,t){var a=new Timer;return a.restart(e,r,t),a}function timerFlush(){now(),++frame;for(var e=taskHead,r;e;)(r=clockNow-e._time)>=0&&e._call.call(void 0,r),e=e._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var e=clock.now(),r=e-clockLast;r>pokeDelay&&(clockSkew-=r,clockLast=e)}function nap(){for(var e,r=taskHead,t,a=1/0;r;)r._call?(a>r._time&&(a=r._time),e=r,r=r._next):(t=r._next,r._next=null,r=e?e._next=t:taskHead=t);taskTail=e,sleep(a)}function sleep(e){if(!frame){timeout$1&&(timeout$1=clearTimeout(timeout$1));var r=e-clockNow;r>24?(e<1/0&&(timeout$1=setTimeout(wake,e-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout(e,r,t){var a=new Timer;return r=r==null?0:+r,a.restart(c=>{a.stop(),e(c+r)},r,t),a}var emptyOn=dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(e,r,t,a,c,h){var _=e.__transition;if(!_)e.__transition={};else if(t in _)return;create(e,t,{name:r,index:a,group:c,on:emptyOn,tween:emptyTween,time:h.time,delay:h.delay,duration:h.duration,ease:h.ease,timer:null,state:CREATED})}function init(e,r){var t=get(e,r);if(t.state>CREATED)throw new Error("too late; already scheduled");return t}function set(e,r){var t=get(e,r);if(t.state>STARTED)throw new Error("too late; already running");return t}function get(e,r){var t=e.__transition;if(!t||!(t=t[r]))throw new Error("transition not found");return t}function create(e,r,t){var a=e.__transition,c;a[r]=t,t.timer=timer(h,0,t.time);function h(b){t.state=SCHEDULED,t.timer.restart(_,t.delay,t.time),t.delay<=b&&_(b-t.delay)}function _(b){var p,E,M,R;if(t.state!==SCHEDULED)return g();for(p in a)if(R=a[p],R.name===t.name){if(R.state===STARTED)return timeout(_);R.state===RUNNING?(R.state=ENDED,R.timer.stop(),R.on.call("interrupt",e,e.__data__,R.index,R.group),delete a[p]):+p<r&&(R.state=ENDED,R.timer.stop(),R.on.call("cancel",e,e.__data__,R.index,R.group),delete a[p])}if(timeout(function(){t.state===STARTED&&(t.state=RUNNING,t.timer.restart(f,t.delay,t.time),f(b))}),t.state=STARTING,t.on.call("start",e,e.__data__,t.index,t.group),t.state===STARTING){for(t.state=STARTED,c=new Array(M=t.tween.length),p=0,E=-1;p<M;++p)(R=t.tween[p].value.call(e,e.__data__,t.index,t.group))&&(c[++E]=R);c.length=E+1}}function f(b){for(var p=b<t.duration?t.ease.call(null,b/t.duration):(t.timer.restart(g),t.state=ENDING,1),E=-1,M=c.length;++E<M;)c[E].call(e,p);t.state===ENDING&&(t.on.call("end",e,e.__data__,t.index,t.group),g())}function g(){t.state=ENDED,t.timer.stop(),delete a[r];for(var b in a)return;delete e.__transition}}function interrupt(e,r){var t=e.__transition,a,c,h=!0,_;if(t){r=r==null?null:r+"";for(_ in t){if((a=t[_]).name!==r){h=!1;continue}c=a.state>STARTING&&a.state<ENDING,a.state=ENDED,a.timer.stop(),a.on.call(c?"interrupt":"cancel",e,e.__data__,a.index,a.group),delete t[_]}h&&delete e.__transition}}function selection_interrupt(e){return this.each(function(){interrupt(this,e)})}function tweenRemove(e,r){var t,a;return function(){var c=set(this,e),h=c.tween;if(h!==t){a=t=h;for(var _=0,f=a.length;_<f;++_)if(a[_].name===r){a=a.slice(),a.splice(_,1);break}}c.tween=a}}function tweenFunction(e,r,t){var a,c;if(typeof t!="function")throw new Error;return function(){var h=set(this,e),_=h.tween;if(_!==a){c=(a=_).slice();for(var f={name:r,value:t},g=0,b=c.length;g<b;++g)if(c[g].name===r){c[g]=f;break}g===b&&c.push(f)}h.tween=c}}function transition_tween(e,r){var t=this._id;if(e+="",arguments.length<2){for(var a=get(this.node(),t).tween,c=0,h=a.length,_;c<h;++c)if((_=a[c]).name===e)return _.value;return null}return this.each((r==null?tweenRemove:tweenFunction)(t,e,r))}function tweenValue(e,r,t){var a=e._id;return e.each(function(){var c=set(this,a);(c.value||(c.value={}))[r]=t.apply(this,arguments)}),function(c){return get(c,a).value[r]}}function interpolate(e,r){var t;return(typeof r=="number"?interpolateNumber:r instanceof color?interpolateRgb:(t=color(r))?(r=t,interpolateRgb):interpolateString)(e,r)}function attrRemove(e){return function(){this.removeAttribute(e)}}function attrRemoveNS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant(e,r,t){var a,c=t+"",h;return function(){var _=this.getAttribute(e);return _===c?null:_===a?h:h=r(a=_,t)}}function attrConstantNS(e,r,t){var a,c=t+"",h;return function(){var _=this.getAttributeNS(e.space,e.local);return _===c?null:_===a?h:h=r(a=_,t)}}function attrFunction(e,r,t){var a,c,h;return function(){var _,f=t(this),g;return f==null?void this.removeAttribute(e):(_=this.getAttribute(e),g=f+"",_===g?null:_===a&&g===c?h:(c=g,h=r(a=_,f)))}}function attrFunctionNS(e,r,t){var a,c,h;return function(){var _,f=t(this),g;return f==null?void this.removeAttributeNS(e.space,e.local):(_=this.getAttributeNS(e.space,e.local),g=f+"",_===g?null:_===a&&g===c?h:(c=g,h=r(a=_,f)))}}function transition_attr(e,r){var t=namespace(e),a=t==="transform"?interpolateTransformSvg:interpolate;return this.attrTween(e,typeof r=="function"?(t.local?attrFunctionNS:attrFunction)(t,a,tweenValue(this,"attr."+e,r)):r==null?(t.local?attrRemoveNS:attrRemove)(t):(t.local?attrConstantNS:attrConstant)(t,a,r))}function attrInterpolate(e,r){return function(t){this.setAttribute(e,r.call(this,t))}}function attrInterpolateNS(e,r){return function(t){this.setAttributeNS(e.space,e.local,r.call(this,t))}}function attrTweenNS(e,r){var t,a;function c(){var h=r.apply(this,arguments);return h!==a&&(t=(a=h)&&attrInterpolateNS(e,h)),t}return c._value=r,c}function attrTween(e,r){var t,a;function c(){var h=r.apply(this,arguments);return h!==a&&(t=(a=h)&&attrInterpolate(e,h)),t}return c._value=r,c}function transition_attrTween(e,r){var t="attr."+e;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(r==null)return this.tween(t,null);if(typeof r!="function")throw new Error;var a=namespace(e);return this.tween(t,(a.local?attrTweenNS:attrTween)(a,r))}function delayFunction(e,r){return function(){init(this,e).delay=+r.apply(this,arguments)}}function delayConstant(e,r){return r=+r,function(){init(this,e).delay=r}}function transition_delay(e){var r=this._id;return arguments.length?this.each((typeof e=="function"?delayFunction:delayConstant)(r,e)):get(this.node(),r).delay}function durationFunction(e,r){return function(){set(this,e).duration=+r.apply(this,arguments)}}function durationConstant(e,r){return r=+r,function(){set(this,e).duration=r}}function transition_duration(e){var r=this._id;return arguments.length?this.each((typeof e=="function"?durationFunction:durationConstant)(r,e)):get(this.node(),r).duration}function easeConstant(e,r){if(typeof r!="function")throw new Error;return function(){set(this,e).ease=r}}function transition_ease(e){var r=this._id;return arguments.length?this.each(easeConstant(r,e)):get(this.node(),r).ease}function easeVarying(e,r){return function(){var t=r.apply(this,arguments);if(typeof t!="function")throw new Error;set(this,e).ease=t}}function transition_easeVarying(e){if(typeof e!="function")throw new Error;return this.each(easeVarying(this._id,e))}function transition_filter(e){typeof e!="function"&&(e=matcher(e));for(var r=this._groups,t=r.length,a=new Array(t),c=0;c<t;++c)for(var h=r[c],_=h.length,f=a[c]=[],g,b=0;b<_;++b)(g=h[b])&&e.call(g,g.__data__,b,h)&&f.push(g);return new Transition(a,this._parents,this._name,this._id)}function transition_merge(e){if(e._id!==this._id)throw new Error;for(var r=this._groups,t=e._groups,a=r.length,c=t.length,h=Math.min(a,c),_=new Array(a),f=0;f<h;++f)for(var g=r[f],b=t[f],p=g.length,E=_[f]=new Array(p),M,R=0;R<p;++R)(M=g[R]||b[R])&&(E[R]=M);for(;f<a;++f)_[f]=r[f];return new Transition(_,this._parents,this._name,this._id)}function start(e){return(e+"").trim().split(/^|\s+/).every(function(r){var t=r.indexOf(".");return t>=0&&(r=r.slice(0,t)),!r||r==="start"})}function onFunction(e,r,t){var a,c,h=start(r)?init:set;return function(){var _=h(this,e),f=_.on;f!==a&&(c=(a=f).copy()).on(r,t),_.on=c}}function transition_on(e,r){var t=this._id;return arguments.length<2?get(this.node(),t).on.on(e):this.each(onFunction(t,e,r))}function removeFunction(e){return function(){var r=this.parentNode;for(var t in this.__transition)if(+t!==e)return;r&&r.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(e){var r=this._name,t=this._id;typeof e!="function"&&(e=selector$h(e));for(var a=this._groups,c=a.length,h=new Array(c),_=0;_<c;++_)for(var f=a[_],g=f.length,b=h[_]=new Array(g),p,E,M=0;M<g;++M)(p=f[M])&&(E=e.call(p,p.__data__,M,f))&&("__data__"in p&&(E.__data__=p.__data__),b[M]=E,schedule(b[M],r,t,M,b,get(p,t)));return new Transition(h,this._parents,r,t)}function transition_selectAll(e){var r=this._name,t=this._id;typeof e!="function"&&(e=selectorAll(e));for(var a=this._groups,c=a.length,h=[],_=[],f=0;f<c;++f)for(var g=a[f],b=g.length,p,E=0;E<b;++E)if(p=g[E]){for(var M=e.call(p,p.__data__,E,g),R,z=get(p,t),l=0,s=M.length;l<s;++l)(R=M[l])&&schedule(R,r,t,l,M,z);h.push(M),_.push(p)}return new Transition(h,_,r,t)}var Selection=selection.prototype.constructor;function transition_selection(){return new Selection(this._groups,this._parents)}function styleNull(e,r){var t,a,c;return function(){var h=styleValue(this,e),_=(this.style.removeProperty(e),styleValue(this,e));return h===_?null:h===t&&_===a?c:c=r(t=h,a=_)}}function styleRemove(e){return function(){this.style.removeProperty(e)}}function styleConstant(e,r,t){var a,c=t+"",h;return function(){var _=styleValue(this,e);return _===c?null:_===a?h:h=r(a=_,t)}}function styleFunction(e,r,t){var a,c,h;return function(){var _=styleValue(this,e),f=t(this),g=f+"";return f==null&&(g=f=(this.style.removeProperty(e),styleValue(this,e))),_===g?null:_===a&&g===c?h:(c=g,h=r(a=_,f))}}function styleMaybeRemove(e,r){var t,a,c,h="style."+r,_="end."+h,f;return function(){var g=set(this,e),b=g.on,p=g.value[h]==null?f||(f=styleRemove(r)):void 0;(b!==t||c!==p)&&(a=(t=b).copy()).on(_,c=p),g.on=a}}function transition_style(e,r,t){var a=(e+="")=="transform"?interpolateTransformCss:interpolate;return r==null?this.styleTween(e,styleNull(e,a)).on("end.style."+e,styleRemove(e)):typeof r=="function"?this.styleTween(e,styleFunction(e,a,tweenValue(this,"style."+e,r))).each(styleMaybeRemove(this._id,e)):this.styleTween(e,styleConstant(e,a,r),t).on("end.style."+e,null)}function styleInterpolate(e,r,t){return function(a){this.style.setProperty(e,r.call(this,a),t)}}function styleTween(e,r,t){var a,c;function h(){var _=r.apply(this,arguments);return _!==c&&(a=(c=_)&&styleInterpolate(e,_,t)),a}return h._value=r,h}function transition_styleTween(e,r,t){var a="style."+(e+="");if(arguments.length<2)return(a=this.tween(a))&&a._value;if(r==null)return this.tween(a,null);if(typeof r!="function")throw new Error;return this.tween(a,styleTween(e,r,t??""))}function textConstant(e){return function(){this.textContent=e}}function textFunction(e){return function(){var r=e(this);this.textContent=r??""}}function transition_text(e){return this.tween("text",typeof e=="function"?textFunction(tweenValue(this,"text",e)):textConstant(e==null?"":e+""))}function textInterpolate(e){return function(r){this.textContent=e.call(this,r)}}function textTween(e){var r,t;function a(){var c=e.apply(this,arguments);return c!==t&&(r=(t=c)&&textInterpolate(c)),r}return a._value=e,a}function transition_textTween(e){var r="text";if(arguments.length<1)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,textTween(e))}function transition_transition(){for(var e=this._name,r=this._id,t=newId(),a=this._groups,c=a.length,h=0;h<c;++h)for(var _=a[h],f=_.length,g,b=0;b<f;++b)if(g=_[b]){var p=get(g,r);schedule(g,e,t,b,_,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new Transition(a,this._parents,e,t)}function transition_end(){var e,r,t=this,a=t._id,c=t.size();return new Promise(function(h,_){var f={value:_},g={value:function(){--c===0&&h()}};t.each(function(){var b=set(this,a),p=b.on;p!==e&&(r=(e=p).copy(),r._.cancel.push(f),r._.interrupt.push(f),r._.end.push(g)),b.on=r}),c===0&&h()})}var id=0;function Transition(e,r,t,a){this._groups=e,this._parents=r,this._name=t,this._id=a}function newId(){return++id}var selection_prototype=selection.prototype;Transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,easeVarying:transition_easeVarying,end:transition_end,[Symbol.iterator]:selection_prototype[Symbol.iterator]};function cubicInOut(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(e,r){for(var t;!(t=e.__transition)||!(t=t[r]);)if(!(e=e.parentNode))throw new Error(`transition ${r} not found`);return t}function selection_transition(e){var r,t;e instanceof Transition?(r=e._id,e=e._name):(r=newId(),(t=defaultTiming).time=now(),e=e==null?null:e+"");for(var a=this._groups,c=a.length,h=0;h<c;++h)for(var _=a[h],f=_.length,g,b=0;b<f;++b)(g=_[b])&&schedule(g,e,r,b,_,t||inherit(g,r));return new Transition(a,this._parents,e,r)}selection.prototype.interrupt=selection_interrupt;selection.prototype.transition=selection_transition;const constant=e=>()=>e;function ZoomEvent(e,{sourceEvent:r,target:t,transform:a,dispatch:c}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:r,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:a,enumerable:!0,configurable:!0},_:{value:c}})}function Transform(e,r,t){this.k=e,this.x=r,this.y=t}Transform.prototype={constructor:Transform,scale:function(e){return e===1?this:new Transform(this.k*e,this.x,this.y)},translate:function(e,r){return e===0&r===0?this:new Transform(this.k,this.x+this.k*e,this.y+this.k*r)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity=new Transform(1,0,0);Transform.prototype;function nopropagation(e){e.stopImmediatePropagation()}function noevent(e){e.preventDefault(),e.stopImmediatePropagation()}function defaultFilter(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function defaultExtent(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function defaultTransform(){return this.__zoom||identity}function defaultWheelDelta(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function defaultConstrain(e,r,t){var a=e.invertX(r[0][0])-t[0][0],c=e.invertX(r[1][0])-t[1][0],h=e.invertY(r[0][1])-t[0][1],_=e.invertY(r[1][1])-t[1][1];return e.translate(c>a?(a+c)/2:Math.min(0,a)||Math.max(0,c),_>h?(h+_)/2:Math.min(0,h)||Math.max(0,_))}function zoom(){var e=defaultFilter,r=defaultExtent,t=defaultConstrain,a=defaultWheelDelta,c=defaultTouchable,h=[0,1/0],_=[[-1/0,-1/0],[1/0,1/0]],f=250,g=interpolateZoom,b=dispatch("start","zoom","end"),p,E,M,R=500,z=150,l=0,s=10;function v(B){B.property("__zoom",defaultTransform).on("wheel.zoom",k,{passive:!1}).on("mousedown.zoom",I).on("dblclick.zoom",O).filter(c).on("touchstart.zoom",D).on("touchmove.zoom",X).on("touchend.zoom touchcancel.zoom",j).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}v.transform=function(B,$,H,q){var W=B.selection?B.selection():B;W.property("__zoom",defaultTransform),B!==W?u(B,$,H,q):W.interrupt().each(function(){y(this,arguments).event(q).start().zoom(null,typeof $=="function"?$.apply(this,arguments):$).end()})},v.scaleBy=function(B,$,H,q){v.scaleTo(B,function(){var W=this.__zoom.k,Y=typeof $=="function"?$.apply(this,arguments):$;return W*Y},H,q)},v.scaleTo=function(B,$,H,q){v.transform(B,function(){var W=r.apply(this,arguments),Y=this.__zoom,G=H==null?A(W):typeof H=="function"?H.apply(this,arguments):H,V=Y.invert(G),Q=typeof $=="function"?$.apply(this,arguments):$;return t(S(w(Y,Q),G,V),W,_)},H,q)},v.translateBy=function(B,$,H,q){v.transform(B,function(){return t(this.__zoom.translate(typeof $=="function"?$.apply(this,arguments):$,typeof H=="function"?H.apply(this,arguments):H),r.apply(this,arguments),_)},null,q)},v.translateTo=function(B,$,H,q,W){v.transform(B,function(){var Y=r.apply(this,arguments),G=this.__zoom,V=q==null?A(Y):typeof q=="function"?q.apply(this,arguments):q;return t(identity.translate(V[0],V[1]).scale(G.k).translate(typeof $=="function"?-$.apply(this,arguments):-$,typeof H=="function"?-H.apply(this,arguments):-H),Y,_)},q,W)};function w(B,$){return $=Math.max(h[0],Math.min(h[1],$)),$===B.k?B:new Transform($,B.x,B.y)}function S(B,$,H){var q=$[0]-H[0]*B.k,W=$[1]-H[1]*B.k;return q===B.x&&W===B.y?B:new Transform(B.k,q,W)}function A(B){return[(+B[0][0]+ +B[1][0])/2,(+B[0][1]+ +B[1][1])/2]}function u(B,$,H,q){B.on("start.zoom",function(){y(this,arguments).event(q).start()}).on("interrupt.zoom end.zoom",function(){y(this,arguments).event(q).end()}).tween("zoom",function(){var W=this,Y=arguments,G=y(W,Y).event(q),V=r.apply(W,Y),Q=H==null?A(V):typeof H=="function"?H.apply(W,Y):H,xe=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),ce=W.__zoom,Ne=typeof $=="function"?$.apply(W,Y):$,Pe=g(ce.invert(Q).concat(xe/ce.k),Ne.invert(Q).concat(xe/Ne.k));return function(Fe){if(Fe===1)Fe=Ne;else{var Me=Pe(Fe),je=xe/Me[2];Fe=new Transform(je,Q[0]-Me[0]*je,Q[1]-Me[1]*je)}G.zoom(null,Fe)}})}function y(B,$,H){return!H&&B.__zooming||new C(B,$)}function C(B,$){this.that=B,this.args=$,this.active=0,this.sourceEvent=null,this.extent=r.apply(B,$),this.taps=0}C.prototype={event:function(B){return B&&(this.sourceEvent=B),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(B,$){return this.mouse&&B!=="mouse"&&(this.mouse[1]=$.invert(this.mouse[0])),this.touch0&&B!=="touch"&&(this.touch0[1]=$.invert(this.touch0[0])),this.touch1&&B!=="touch"&&(this.touch1[1]=$.invert(this.touch1[0])),this.that.__zoom=$,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(B){var $=select(this.that).datum();b.call(B,this.that,new ZoomEvent(B,{sourceEvent:this.sourceEvent,target:v,transform:this.that.__zoom,dispatch:b}),$)}};function k(B,...$){if(!e.apply(this,arguments))return;var H=y(this,$).event(B),q=this.__zoom,W=Math.max(h[0],Math.min(h[1],q.k*Math.pow(2,a.apply(this,arguments)))),Y=pointer(B);if(H.wheel)(H.mouse[0][0]!==Y[0]||H.mouse[0][1]!==Y[1])&&(H.mouse[1]=q.invert(H.mouse[0]=Y)),clearTimeout(H.wheel);else{if(q.k===W)return;H.mouse=[Y,q.invert(Y)],interrupt(this),H.start()}noevent(B),H.wheel=setTimeout(G,z),H.zoom("mouse",t(S(w(q,W),H.mouse[0],H.mouse[1]),H.extent,_));function G(){H.wheel=null,H.end()}}function I(B,...$){if(M||!e.apply(this,arguments))return;var H=B.currentTarget,q=y(this,$,!0).event(B),W=select(B.view).on("mousemove.zoom",Q,!0).on("mouseup.zoom",xe,!0),Y=pointer(B,H),G=B.clientX,V=B.clientY;dragDisable(B.view),nopropagation(B),q.mouse=[Y,this.__zoom.invert(Y)],interrupt(this),q.start();function Q(ce){if(noevent(ce),!q.moved){var Ne=ce.clientX-G,Pe=ce.clientY-V;q.moved=Ne*Ne+Pe*Pe>l}q.event(ce).zoom("mouse",t(S(q.that.__zoom,q.mouse[0]=pointer(ce,H),q.mouse[1]),q.extent,_))}function xe(ce){W.on("mousemove.zoom mouseup.zoom",null),yesdrag(ce.view,q.moved),noevent(ce),q.event(ce).end()}}function O(B,...$){if(e.apply(this,arguments)){var H=this.__zoom,q=pointer(B.changedTouches?B.changedTouches[0]:B,this),W=H.invert(q),Y=H.k*(B.shiftKey?.5:2),G=t(S(w(H,Y),q,W),r.apply(this,$),_);noevent(B),f>0?select(this).transition().duration(f).call(u,G,q,B):select(this).call(v.transform,G,q,B)}}function D(B,...$){if(e.apply(this,arguments)){var H=B.touches,q=H.length,W=y(this,$,B.changedTouches.length===q).event(B),Y,G,V,Q;for(nopropagation(B),G=0;G<q;++G)V=H[G],Q=pointer(V,this),Q=[Q,this.__zoom.invert(Q),V.identifier],W.touch0?!W.touch1&&W.touch0[2]!==Q[2]&&(W.touch1=Q,W.taps=0):(W.touch0=Q,Y=!0,W.taps=1+!!p);p&&(p=clearTimeout(p)),Y&&(W.taps<2&&(E=Q[0],p=setTimeout(function(){p=null},R)),interrupt(this),W.start())}}function X(B,...$){if(this.__zooming){var H=y(this,$).event(B),q=B.changedTouches,W=q.length,Y,G,V,Q;for(noevent(B),Y=0;Y<W;++Y)G=q[Y],V=pointer(G,this),H.touch0&&H.touch0[2]===G.identifier?H.touch0[0]=V:H.touch1&&H.touch1[2]===G.identifier&&(H.touch1[0]=V);if(G=H.that.__zoom,H.touch1){var xe=H.touch0[0],ce=H.touch0[1],Ne=H.touch1[0],Pe=H.touch1[1],Fe=(Fe=Ne[0]-xe[0])*Fe+(Fe=Ne[1]-xe[1])*Fe,Me=(Me=Pe[0]-ce[0])*Me+(Me=Pe[1]-ce[1])*Me;G=w(G,Math.sqrt(Fe/Me)),V=[(xe[0]+Ne[0])/2,(xe[1]+Ne[1])/2],Q=[(ce[0]+Pe[0])/2,(ce[1]+Pe[1])/2]}else if(H.touch0)V=H.touch0[0],Q=H.touch0[1];else return;H.zoom("touch",t(S(G,V,Q),H.extent,_))}}function j(B,...$){if(this.__zooming){var H=y(this,$).event(B),q=B.changedTouches,W=q.length,Y,G;for(nopropagation(B),M&&clearTimeout(M),M=setTimeout(function(){M=null},R),Y=0;Y<W;++Y)G=q[Y],H.touch0&&H.touch0[2]===G.identifier?delete H.touch0:H.touch1&&H.touch1[2]===G.identifier&&delete H.touch1;if(H.touch1&&!H.touch0&&(H.touch0=H.touch1,delete H.touch1),H.touch0)H.touch0[1]=this.__zoom.invert(H.touch0[0]);else if(H.end(),H.taps===2&&(G=pointer(G,this),Math.hypot(E[0]-G[0],E[1]-G[1])<s)){var V=select(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return v.wheelDelta=function(B){return arguments.length?(a=typeof B=="function"?B:constant(+B),v):a},v.filter=function(B){return arguments.length?(e=typeof B=="function"?B:constant(!!B),v):e},v.touchable=function(B){return arguments.length?(c=typeof B=="function"?B:constant(!!B),v):c},v.extent=function(B){return arguments.length?(r=typeof B=="function"?B:constant([[+B[0][0],+B[0][1]],[+B[1][0],+B[1][1]]]),v):r},v.scaleExtent=function(B){return arguments.length?(h[0]=+B[0],h[1]=+B[1],v):[h[0],h[1]]},v.translateExtent=function(B){return arguments.length?(_[0][0]=+B[0][0],_[1][0]=+B[1][0],_[0][1]=+B[0][1],_[1][1]=+B[1][1],v):[[_[0][0],_[0][1]],[_[1][0],_[1][1]]]},v.constrain=function(B){return arguments.length?(t=B,v):t},v.duration=function(B){return arguments.length?(f=+B,v):f},v.interpolate=function(B){return arguments.length?(g=B,v):g},v.on=function(){var B=b.on.apply(b,arguments);return B===b?v:B},v.clickDistance=function(B){return arguments.length?(l=(B=+B)*B,v):Math.sqrt(l)},v.tapDistance=function(B){return arguments.length?(s=+B,v):s},v}const StoreContext=reactExports.createContext(null),Provider$1=StoreContext.Provider,errorMessages={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,r)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?r.targetHandle:r.sourceHandle}", edge id: ${r.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},zustandErrorMessage=errorMessages.error001();function useStore(e,r){const t=reactExports.useContext(StoreContext);if(t===null)throw new Error(zustandErrorMessage);return useStoreWithEqualityFn(t,e,r)}const useStoreApi=()=>{const e=reactExports.useContext(StoreContext);if(e===null)throw new Error(zustandErrorMessage);return reactExports.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},selector$g=e=>e.userSelectionActive?"none":"all";function Panel({position:e,children:r,className:t,style:a,...c}){const h=useStore(selector$g),_=`${e}`.split("-");return React.createElement("div",{className:cc(["react-flow__panel",t,..._]),style:{...a,pointerEvents:h},...c},r)}function Attribution({proOptions:e,position:r="bottom-right"}){return e?.hideAttribution?null:React.createElement(Panel,{position:r,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},React.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const EdgeText=({x:e,y:r,label:t,labelStyle:a={},labelShowBg:c=!0,labelBgStyle:h={},labelBgPadding:_=[2,4],labelBgBorderRadius:f=2,children:g,className:b,...p})=>{const E=reactExports.useRef(null),[M,R]=reactExports.useState({x:0,y:0,width:0,height:0}),z=cc(["react-flow__edge-textwrapper",b]);return reactExports.useEffect(()=>{if(E.current){const l=E.current.getBBox();R({x:l.x,y:l.y,width:l.width,height:l.height})}},[t]),typeof t>"u"||!t?null:React.createElement("g",{transform:`translate(${e-M.width/2} ${r-M.height/2})`,className:z,visibility:M.width?"visible":"hidden",...p},c&&React.createElement("rect",{width:M.width+2*_[0],x:-_[0],y:-_[1],height:M.height+2*_[1],className:"react-flow__edge-textbg",style:h,rx:f,ry:f}),React.createElement("text",{className:"react-flow__edge-text",y:M.height/2,dy:"0.3em",ref:E,style:a},t),g)};var EdgeText$1=reactExports.memo(EdgeText);const getDimensions=e=>({width:e.offsetWidth,height:e.offsetHeight}),clamp=(e,r=0,t=1)=>Math.min(Math.max(e,r),t),clampPosition=(e={x:0,y:0},r)=>({x:clamp(e.x,r[0][0],r[1][0]),y:clamp(e.y,r[0][1],r[1][1])}),calcAutoPanVelocity=(e,r,t)=>e<r?clamp(Math.abs(e-r),1,50)/50:e>t?-clamp(Math.abs(e-t),1,50)/50:0,calcAutoPan=(e,r)=>{const t=calcAutoPanVelocity(e.x,35,r.width-35)*20,a=calcAutoPanVelocity(e.y,35,r.height-35)*20;return[t,a]},getHostForElement=e=>e.getRootNode?.()||window?.document,getBoundsOfBoxes=(e,r)=>({x:Math.min(e.x,r.x),y:Math.min(e.y,r.y),x2:Math.max(e.x2,r.x2),y2:Math.max(e.y2,r.y2)}),rectToBox=({x:e,y:r,width:t,height:a})=>({x:e,y:r,x2:e+t,y2:r+a}),boxToRect=({x:e,y:r,x2:t,y2:a})=>({x:e,y:r,width:t-e,height:a-r}),nodeToRect=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),getOverlappingArea=(e,r)=>{const t=Math.max(0,Math.min(e.x+e.width,r.x+r.width)-Math.max(e.x,r.x)),a=Math.max(0,Math.min(e.y+e.height,r.y+r.height)-Math.max(e.y,r.y));return Math.ceil(t*a)},isRectObject=e=>isNumeric(e.width)&&isNumeric(e.height)&&isNumeric(e.x)&&isNumeric(e.y),isNumeric=e=>!isNaN(e)&&isFinite(e),internalsSymbol=Symbol.for("internals"),elementSelectionKeys=["Enter"," ","Escape"],devWarn=(e,r)=>{},isReactKeyboardEvent=e=>"nativeEvent"in e;function isInputDOMNode(e){const t=(isReactKeyboardEvent(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(t?.nodeName)||t?.hasAttribute("contenteditable")||!!t?.closest(".nokey")}const isMouseEvent=e=>"clientX"in e,getEventPosition=(e,r)=>{const t=isMouseEvent(e),a=t?e.clientX:e.touches?.[0].clientX,c=t?e.clientY:e.touches?.[0].clientY;return{x:a-(r?.left??0),y:c-(r?.top??0)}},isMacOs=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,BaseEdge=({id:e,path:r,labelX:t,labelY:a,label:c,labelStyle:h,labelShowBg:_,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:b,style:p,markerEnd:E,markerStart:M,interactionWidth:R=20})=>React.createElement(React.Fragment,null,React.createElement("path",{id:e,style:p,d:r,fill:"none",className:"react-flow__edge-path",markerEnd:E,markerStart:M}),R&&React.createElement("path",{d:r,fill:"none",strokeOpacity:0,strokeWidth:R,className:"react-flow__edge-interaction"}),c&&isNumeric(t)&&isNumeric(a)?React.createElement(EdgeText$1,{x:t,y:a,label:c,labelStyle:h,labelShowBg:_,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:b}):null);BaseEdge.displayName="BaseEdge";function getMouseHandler$1(e,r,t){return t===void 0?t:a=>{const c=r().edges.find(h=>h.id===e);c&&t(a,{...c})}}function getEdgeCenter({sourceX:e,sourceY:r,targetX:t,targetY:a}){const c=Math.abs(t-e)/2,h=t<e?t+c:t-c,_=Math.abs(a-r)/2,f=a<r?a+_:a-_;return[h,f,c,_]}function getBezierEdgeCenter({sourceX:e,sourceY:r,targetX:t,targetY:a,sourceControlX:c,sourceControlY:h,targetControlX:_,targetControlY:f}){const g=e*.125+c*.375+_*.375+t*.125,b=r*.125+h*.375+f*.375+a*.125,p=Math.abs(g-e),E=Math.abs(b-r);return[g,b,p,E]}var ConnectionMode;(function(e){e.Strict="strict",e.Loose="loose"})(ConnectionMode||(ConnectionMode={}));var PanOnScrollMode;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(PanOnScrollMode||(PanOnScrollMode={}));var SelectionMode;(function(e){e.Partial="partial",e.Full="full"})(SelectionMode||(SelectionMode={}));var ConnectionLineType;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ConnectionLineType||(ConnectionLineType={}));var MarkerType;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(MarkerType||(MarkerType={}));var Position;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Position||(Position={}));function getControl({pos:e,x1:r,y1:t,x2:a,y2:c}){return e===Position.Left||e===Position.Right?[.5*(r+a),t]:[r,.5*(t+c)]}function getSimpleBezierPath({sourceX:e,sourceY:r,sourcePosition:t=Position.Bottom,targetX:a,targetY:c,targetPosition:h=Position.Top}){const[_,f]=getControl({pos:t,x1:e,y1:r,x2:a,y2:c}),[g,b]=getControl({pos:h,x1:a,y1:c,x2:e,y2:r}),[p,E,M,R]=getBezierEdgeCenter({sourceX:e,sourceY:r,targetX:a,targetY:c,sourceControlX:_,sourceControlY:f,targetControlX:g,targetControlY:b});return[`M${e},${r} C${_},${f} ${g},${b} ${a},${c}`,p,E,M,R]}const SimpleBezierEdge=reactExports.memo(({sourceX:e,sourceY:r,targetX:t,targetY:a,sourcePosition:c=Position.Bottom,targetPosition:h=Position.Top,label:_,labelStyle:f,labelShowBg:g,labelBgStyle:b,labelBgPadding:p,labelBgBorderRadius:E,style:M,markerEnd:R,markerStart:z,interactionWidth:l})=>{const[s,v,w]=getSimpleBezierPath({sourceX:e,sourceY:r,sourcePosition:c,targetX:t,targetY:a,targetPosition:h});return React.createElement(BaseEdge,{path:s,labelX:v,labelY:w,label:_,labelStyle:f,labelShowBg:g,labelBgStyle:b,labelBgPadding:p,labelBgBorderRadius:E,style:M,markerEnd:R,markerStart:z,interactionWidth:l})});SimpleBezierEdge.displayName="SimpleBezierEdge";const handleDirections={[Position.Left]:{x:-1,y:0},[Position.Right]:{x:1,y:0},[Position.Top]:{x:0,y:-1},[Position.Bottom]:{x:0,y:1}},getDirection=({source:e,sourcePosition:r=Position.Bottom,target:t})=>r===Position.Left||r===Position.Right?e.x<t.x?{x:1,y:0}:{x:-1,y:0}:e.y<t.y?{x:0,y:1}:{x:0,y:-1},distance=(e,r)=>Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));function getPoints({source:e,sourcePosition:r=Position.Bottom,target:t,targetPosition:a=Position.Top,center:c,offset:h}){const _=handleDirections[r],f=handleDirections[a],g={x:e.x+_.x*h,y:e.y+_.y*h},b={x:t.x+f.x*h,y:t.y+f.y*h},p=getDirection({source:g,sourcePosition:r,target:b}),E=p.x!==0?"x":"y",M=p[E];let R=[],z,l;const s={x:0,y:0},v={x:0,y:0},[w,S,A,u]=getEdgeCenter({sourceX:e.x,sourceY:e.y,targetX:t.x,targetY:t.y});if(_[E]*f[E]===-1){z=c.x??w,l=c.y??S;const C=[{x:z,y:g.y},{x:z,y:b.y}],k=[{x:g.x,y:l},{x:b.x,y:l}];_[E]===M?R=E==="x"?C:k:R=E==="x"?k:C}else{const C=[{x:g.x,y:b.y}],k=[{x:b.x,y:g.y}];if(E==="x"?R=_.x===M?k:C:R=_.y===M?C:k,r===a){const j=Math.abs(e[E]-t[E]);if(j<=h){const B=Math.min(h-1,h-j);_[E]===M?s[E]=(g[E]>e[E]?-1:1)*B:v[E]=(b[E]>t[E]?-1:1)*B}}if(r!==a){const j=E==="x"?"y":"x",B=_[E]===f[j],$=g[j]>b[j],H=g[j]<b[j];(_[E]===1&&(!B&&$||B&&H)||_[E]!==1&&(!B&&H||B&&$))&&(R=E==="x"?C:k)}const I={x:g.x+s.x,y:g.y+s.y},O={x:b.x+v.x,y:b.y+v.y},D=Math.max(Math.abs(I.x-R[0].x),Math.abs(O.x-R[0].x)),X=Math.max(Math.abs(I.y-R[0].y),Math.abs(O.y-R[0].y));D>=X?(z=(I.x+O.x)/2,l=R[0].y):(z=R[0].x,l=(I.y+O.y)/2)}return[[e,{x:g.x+s.x,y:g.y+s.y},...R,{x:b.x+v.x,y:b.y+v.y},t],z,l,A,u]}function getBend(e,r,t,a){const c=Math.min(distance(e,r)/2,distance(r,t)/2,a),{x:h,y:_}=r;if(e.x===h&&h===t.x||e.y===_&&_===t.y)return`L${h} ${_}`;if(e.y===_){const b=e.x<t.x?-1:1,p=e.y<t.y?1:-1;return`L ${h+c*b},${_}Q ${h},${_} ${h},${_+c*p}`}const f=e.x<t.x?1:-1,g=e.y<t.y?-1:1;return`L ${h},${_+c*g}Q ${h},${_} ${h+c*f},${_}`}function getSmoothStepPath({sourceX:e,sourceY:r,sourcePosition:t=Position.Bottom,targetX:a,targetY:c,targetPosition:h=Position.Top,borderRadius:_=5,centerX:f,centerY:g,offset:b=20}){const[p,E,M,R,z]=getPoints({source:{x:e,y:r},sourcePosition:t,target:{x:a,y:c},targetPosition:h,center:{x:f,y:g},offset:b});return[p.reduce((s,v,w)=>{let S="";return w>0&&w<p.length-1?S=getBend(p[w-1],v,p[w+1],_):S=`${w===0?"M":"L"}${v.x} ${v.y}`,s+=S,s},""),E,M,R,z]}const SmoothStepEdge=reactExports.memo(({sourceX:e,sourceY:r,targetX:t,targetY:a,label:c,labelStyle:h,labelShowBg:_,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:b,style:p,sourcePosition:E=Position.Bottom,targetPosition:M=Position.Top,markerEnd:R,markerStart:z,pathOptions:l,interactionWidth:s})=>{const[v,w,S]=getSmoothStepPath({sourceX:e,sourceY:r,sourcePosition:E,targetX:t,targetY:a,targetPosition:M,borderRadius:l?.borderRadius,offset:l?.offset});return React.createElement(BaseEdge,{path:v,labelX:w,labelY:S,label:c,labelStyle:h,labelShowBg:_,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:b,style:p,markerEnd:R,markerStart:z,interactionWidth:s})});SmoothStepEdge.displayName="SmoothStepEdge";const StepEdge=reactExports.memo(e=>React.createElement(SmoothStepEdge,{...e,pathOptions:reactExports.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));StepEdge.displayName="StepEdge";function getStraightPath({sourceX:e,sourceY:r,targetX:t,targetY:a}){const[c,h,_,f]=getEdgeCenter({sourceX:e,sourceY:r,targetX:t,targetY:a});return[`M ${e},${r}L ${t},${a}`,c,h,_,f]}const StraightEdge=reactExports.memo(({sourceX:e,sourceY:r,targetX:t,targetY:a,label:c,labelStyle:h,labelShowBg:_,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:b,style:p,markerEnd:E,markerStart:M,interactionWidth:R})=>{const[z,l,s]=getStraightPath({sourceX:e,sourceY:r,targetX:t,targetY:a});return React.createElement(BaseEdge,{path:z,labelX:l,labelY:s,label:c,labelStyle:h,labelShowBg:_,labelBgStyle:f,labelBgPadding:g,labelBgBorderRadius:b,style:p,markerEnd:E,markerStart:M,interactionWidth:R})});StraightEdge.displayName="StraightEdge";function calculateControlOffset(e,r){return e>=0?.5*e:r*25*Math.sqrt(-e)}function getControlWithCurvature({pos:e,x1:r,y1:t,x2:a,y2:c,c:h}){switch(e){case Position.Left:return[r-calculateControlOffset(r-a,h),t];case Position.Right:return[r+calculateControlOffset(a-r,h),t];case Position.Top:return[r,t-calculateControlOffset(t-c,h)];case Position.Bottom:return[r,t+calculateControlOffset(c-t,h)]}}function getBezierPath({sourceX:e,sourceY:r,sourcePosition:t=Position.Bottom,targetX:a,targetY:c,targetPosition:h=Position.Top,curvature:_=.25}){const[f,g]=getControlWithCurvature({pos:t,x1:e,y1:r,x2:a,y2:c,c:_}),[b,p]=getControlWithCurvature({pos:h,x1:a,y1:c,x2:e,y2:r,c:_}),[E,M,R,z]=getBezierEdgeCenter({sourceX:e,sourceY:r,targetX:a,targetY:c,sourceControlX:f,sourceControlY:g,targetControlX:b,targetControlY:p});return[`M${e},${r} C${f},${g} ${b},${p} ${a},${c}`,E,M,R,z]}const BezierEdge=reactExports.memo(({sourceX:e,sourceY:r,targetX:t,targetY:a,sourcePosition:c=Position.Bottom,targetPosition:h=Position.Top,label:_,labelStyle:f,labelShowBg:g,labelBgStyle:b,labelBgPadding:p,labelBgBorderRadius:E,style:M,markerEnd:R,markerStart:z,pathOptions:l,interactionWidth:s})=>{const[v,w,S]=getBezierPath({sourceX:e,sourceY:r,sourcePosition:c,targetX:t,targetY:a,targetPosition:h,curvature:l?.curvature});return React.createElement(BaseEdge,{path:v,labelX:w,labelY:S,label:_,labelStyle:f,labelShowBg:g,labelBgStyle:b,labelBgPadding:p,labelBgBorderRadius:E,style:M,markerEnd:R,markerStart:z,interactionWidth:s})});BezierEdge.displayName="BezierEdge";const NodeIdContext=reactExports.createContext(null),Provider$2=NodeIdContext.Provider;NodeIdContext.Consumer;const useNodeId=()=>reactExports.useContext(NodeIdContext),isEdge=e=>"id"in e&&"source"in e&&"target"in e,getEdgeId=({source:e,sourceHandle:r,target:t,targetHandle:a})=>`reactflow__edge-${e}${r||""}-${t}${a||""}`,getMarkerId=(e,r)=>typeof e>"u"?"":typeof e=="string"?e:`${r?`${r}__`:""}${Object.keys(e).sort().map(a=>`${a}=${e[a]}`).join("&")}`,connectionExists=(e,r)=>r.some(t=>t.source===e.source&&t.target===e.target&&(t.sourceHandle===e.sourceHandle||!t.sourceHandle&&!e.sourceHandle)&&(t.targetHandle===e.targetHandle||!t.targetHandle&&!e.targetHandle)),addEdge=(e,r)=>{if(!e.source||!e.target)return r;let t;return isEdge(e)?t={...e}:t={...e,id:getEdgeId(e)},connectionExists(t,r)?r:r.concat(t)},pointToRendererPoint=({x:e,y:r},[t,a,c],h,[_,f])=>{const g={x:(e-t)/c,y:(r-a)/c};return h?{x:_*Math.round(g.x/_),y:f*Math.round(g.y/f)}:g},rendererPointToPoint=({x:e,y:r},[t,a,c])=>({x:e*c+t,y:r*c+a}),getNodePositionWithOrigin=(e,r=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const t=(e.width??0)*r[0],a=(e.height??0)*r[1],c={x:e.position.x-t,y:e.position.y-a};return{...c,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-t,y:e.positionAbsolute.y-a}:c}},getNodesBounds=(e,r=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const t=e.reduce((a,c)=>{const{x:h,y:_}=getNodePositionWithOrigin(c,r).positionAbsolute;return getBoundsOfBoxes(a,rectToBox({x:h,y:_,width:c.width||0,height:c.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return boxToRect(t)},getNodesInside=(e,r,[t,a,c]=[0,0,1],h=!1,_=!1,f=[0,0])=>{const g={x:(r.x-t)/c,y:(r.y-a)/c,width:r.width/c,height:r.height/c},b=[];return e.forEach(p=>{const{width:E,height:M,selectable:R=!0,hidden:z=!1}=p;if(_&&!R||z)return!1;const{positionAbsolute:l}=getNodePositionWithOrigin(p,f),s={x:l.x,y:l.y,width:E||0,height:M||0},v=getOverlappingArea(g,s),w=typeof E>"u"||typeof M>"u"||E===null||M===null,S=h&&v>0,A=(E||0)*(M||0);(w||S||v>=A||p.dragging)&&b.push(p)}),b},getConnectedEdges=(e,r)=>{const t=e.map(a=>a.id);return r.filter(a=>t.includes(a.source)||t.includes(a.target))},getViewportForBounds=(e,r,t,a,c,h=.1)=>{const _=r/(e.width*(1+h)),f=t/(e.height*(1+h)),g=Math.min(_,f),b=clamp(g,a,c),p=e.x+e.width/2,E=e.y+e.height/2,M=r/2-p*b,R=t/2-E*b;return{x:M,y:R,zoom:b}},getD3Transition=(e,r=0)=>e.transition().duration(r);function getHandles(e,r,t,a){return(r[t]||[]).reduce((c,h)=>(`${e.id}-${h.id}-${t}`!==a&&c.push({id:h.id||null,type:t,nodeId:e.id,x:(e.positionAbsolute?.x??0)+h.x+h.width/2,y:(e.positionAbsolute?.y??0)+h.y+h.height/2}),c),[])}function getClosestHandle(e,r,t,a,c,h){const{x:_,y:f}=getEventPosition(e),b=r.elementsFromPoint(_,f).find(z=>z.classList.contains("react-flow__handle"));if(b){const z=b.getAttribute("data-nodeid");if(z){const l=getHandleType(void 0,b),s=b.getAttribute("data-handleid"),v=h({nodeId:z,id:s,type:l});if(v){const w=c.find(S=>S.nodeId===z&&S.type===l&&S.id===s);return{handle:{id:s,type:l,nodeId:z,x:w?.x||t.x,y:w?.y||t.y},validHandleResult:v}}}}let p=[],E=1/0;if(c.forEach(z=>{const l=Math.sqrt((z.x-t.x)**2+(z.y-t.y)**2);if(l<=a){const s=h(z);l<=E&&(l<E?p=[{handle:z,validHandleResult:s}]:l===E&&p.push({handle:z,validHandleResult:s}),E=l)}}),!p.length)return{handle:null,validHandleResult:defaultResult()};if(p.length===1)return p[0];const M=p.some(({validHandleResult:z})=>z.isValid),R=p.some(({handle:z})=>z.type==="target");return p.find(({handle:z,validHandleResult:l})=>R?z.type==="target":M?l.isValid:!0)||p[0]}const nullConnection={source:null,target:null,sourceHandle:null,targetHandle:null},defaultResult=()=>({handleDomNode:null,isValid:!1,connection:nullConnection,endHandle:null});function isValidHandle(e,r,t,a,c,h,_){const f=c==="target",g=_.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),b={...defaultResult(),handleDomNode:g};if(g){const p=getHandleType(void 0,g),E=g.getAttribute("data-nodeid"),M=g.getAttribute("data-handleid"),R=g.classList.contains("connectable"),z=g.classList.contains("connectableend"),l={source:f?E:t,sourceHandle:f?M:a,target:f?t:E,targetHandle:f?a:M};b.connection=l,R&&z&&(r===ConnectionMode.Strict?f&&p==="source"||!f&&p==="target":E!==t||M!==a)&&(b.endHandle={nodeId:E,handleId:M,type:p},b.isValid=h(l))}return b}function getHandleLookup({nodes:e,nodeId:r,handleId:t,handleType:a}){return e.reduce((c,h)=>{if(h[internalsSymbol]){const{handleBounds:_}=h[internalsSymbol];let f=[],g=[];_&&(f=getHandles(h,_,"source",`${r}-${t}-${a}`),g=getHandles(h,_,"target",`${r}-${t}-${a}`)),c.push(...f,...g)}return c},[])}function getHandleType(e,r){return e||(r?.classList.contains("target")?"target":r?.classList.contains("source")?"source":null)}function resetRecentHandle(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function getConnectionStatus(e,r){let t=null;return r?t="valid":e&&!r&&(t="invalid"),t}function handlePointerDown({event:e,handleId:r,nodeId:t,onConnect:a,isTarget:c,getState:h,setState:_,isValidConnection:f,edgeUpdaterType:g,onReconnectEnd:b}){const p=getHostForElement(e.target),{connectionMode:E,domNode:M,autoPanOnConnect:R,connectionRadius:z,onConnectStart:l,panBy:s,getNodes:v,cancelConnection:w}=h();let S=0,A;const{x:u,y}=getEventPosition(e),C=p?.elementFromPoint(u,y),k=getHandleType(g,C),I=M?.getBoundingClientRect();if(!I||!k)return;let O,D=getEventPosition(e,I),X=!1,j=null,B=!1,$=null;const H=getHandleLookup({nodes:v(),nodeId:t,handleId:r,handleType:k}),q=()=>{if(!R)return;const[G,V]=calcAutoPan(D,I);s({x:G,y:V}),S=requestAnimationFrame(q)};_({connectionPosition:D,connectionStatus:null,connectionNodeId:t,connectionHandleId:r,connectionHandleType:k,connectionStartHandle:{nodeId:t,handleId:r,type:k},connectionEndHandle:null}),l?.(e,{nodeId:t,handleId:r,handleType:k});function W(G){const{transform:V}=h();D=getEventPosition(G,I);const{handle:Q,validHandleResult:xe}=getClosestHandle(G,p,pointToRendererPoint(D,V,!1,[1,1]),z,H,ce=>isValidHandle(ce,E,t,r,c?"target":"source",f,p));if(A=Q,X||(q(),X=!0),$=xe.handleDomNode,j=xe.connection,B=xe.isValid,_({connectionPosition:A&&B?rendererPointToPoint({x:A.x,y:A.y},V):D,connectionStatus:getConnectionStatus(!!A,B),connectionEndHandle:xe.endHandle}),!A&&!B&&!$)return resetRecentHandle(O);j.source!==j.target&&$&&(resetRecentHandle(O),O=$,$.classList.add("connecting","react-flow__handle-connecting"),$.classList.toggle("valid",B),$.classList.toggle("react-flow__handle-valid",B))}function Y(G){(A||$)&&j&&B&&a?.(j),h().onConnectEnd?.(G),g&&b?.(G),resetRecentHandle(O),w(),cancelAnimationFrame(S),X=!1,B=!1,j=null,$=null,p.removeEventListener("mousemove",W),p.removeEventListener("mouseup",Y),p.removeEventListener("touchmove",W),p.removeEventListener("touchend",Y)}p.addEventListener("mousemove",W),p.addEventListener("mouseup",Y),p.addEventListener("touchmove",W),p.addEventListener("touchend",Y)}const alwaysValid=()=>!0,selector$f=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),connectingSelector=(e,r,t)=>a=>{const{connectionStartHandle:c,connectionEndHandle:h,connectionClickStartHandle:_}=a;return{connecting:c?.nodeId===e&&c?.handleId===r&&c?.type===t||h?.nodeId===e&&h?.handleId===r&&h?.type===t,clickConnecting:_?.nodeId===e&&_?.handleId===r&&_?.type===t}},Handle=reactExports.forwardRef(({type:e="source",position:r=Position.Top,isValidConnection:t,isConnectable:a=!0,isConnectableStart:c=!0,isConnectableEnd:h=!0,id:_,onConnect:f,children:g,className:b,onMouseDown:p,onTouchStart:E,...M},R)=>{const z=_||null,l=e==="target",s=useStoreApi(),v=useNodeId(),{connectOnClick:w,noPanClassName:S}=useStore(selector$f,shallow$1),{connecting:A,clickConnecting:u}=useStore(connectingSelector(v,z,e),shallow$1);v||s.getState().onError?.("010",errorMessages.error010());const y=I=>{const{defaultEdgeOptions:O,onConnect:D,hasDefaultEdges:X}=s.getState(),j={...O,...I};if(X){const{edges:B,setEdges:$}=s.getState();$(addEdge(j,B))}D?.(j),f?.(j)},C=I=>{if(!v)return;const O=isMouseEvent(I);c&&(O&&I.button===0||!O)&&handlePointerDown({event:I,handleId:z,nodeId:v,onConnect:y,isTarget:l,getState:s.getState,setState:s.setState,isValidConnection:t||s.getState().isValidConnection||alwaysValid}),O?p?.(I):E?.(I)},k=I=>{const{onClickConnectStart:O,onClickConnectEnd:D,connectionClickStartHandle:X,connectionMode:j,isValidConnection:B}=s.getState();if(!v||!X&&!c)return;if(!X){O?.(I,{nodeId:v,handleId:z,handleType:e}),s.setState({connectionClickStartHandle:{nodeId:v,type:e,handleId:z}});return}const $=getHostForElement(I.target),H=t||B||alwaysValid,{connection:q,isValid:W}=isValidHandle({nodeId:v,id:z,type:e},j,X.nodeId,X.handleId||null,X.type,H,$);W&&y(q),D?.(I),s.setState({connectionClickStartHandle:null})};return React.createElement("div",{"data-handleid":z,"data-nodeid":v,"data-handlepos":r,"data-id":`${v}-${z}-${e}`,className:cc(["react-flow__handle",`react-flow__handle-${r}`,"nodrag",S,b,{source:!l,target:l,connectable:a,connectablestart:c,connectableend:h,connecting:u,connectionindicator:a&&(c&&!A||h&&A)}]),onMouseDown:C,onTouchStart:C,onClick:w?k:void 0,ref:R,...M},g)});Handle.displayName="Handle";var Handle$1=reactExports.memo(Handle);const DefaultNode=({data:e,isConnectable:r,targetPosition:t=Position.Top,sourcePosition:a=Position.Bottom})=>React.createElement(React.Fragment,null,React.createElement(Handle$1,{type:"target",position:t,isConnectable:r}),e?.label,React.createElement(Handle$1,{type:"source",position:a,isConnectable:r}));DefaultNode.displayName="DefaultNode";var DefaultNode$1=reactExports.memo(DefaultNode);const InputNode=({data:e,isConnectable:r,sourcePosition:t=Position.Bottom})=>React.createElement(React.Fragment,null,e?.label,React.createElement(Handle$1,{type:"source",position:t,isConnectable:r}));InputNode.displayName="InputNode";var InputNode$1=reactExports.memo(InputNode);const OutputNode=({data:e,isConnectable:r,targetPosition:t=Position.Top})=>React.createElement(React.Fragment,null,React.createElement(Handle$1,{type:"target",position:t,isConnectable:r}),e?.label);OutputNode.displayName="OutputNode";var OutputNode$1=reactExports.memo(OutputNode);const GroupNode=()=>null;GroupNode.displayName="GroupNode";const selector$e=e=>({selectedNodes:e.getNodes().filter(r=>r.selected),selectedEdges:e.edges.filter(r=>r.selected).map(r=>({...r}))}),selectId=e=>e.id;function areEqual(e,r){return shallow$1(e.selectedNodes.map(selectId),r.selectedNodes.map(selectId))&&shallow$1(e.selectedEdges.map(selectId),r.selectedEdges.map(selectId))}const SelectionListener=reactExports.memo(({onSelectionChange:e})=>{const r=useStoreApi(),{selectedNodes:t,selectedEdges:a}=useStore(selector$e,areEqual);return reactExports.useEffect(()=>{const c={nodes:t,edges:a};e?.(c),r.getState().onSelectionChange.forEach(h=>h(c))},[t,a,e]),null});SelectionListener.displayName="SelectionListener";const changeSelector=e=>!!e.onSelectionChange;function Wrapper$1({onSelectionChange:e}){const r=useStore(changeSelector);return e||r?React.createElement(SelectionListener,{onSelectionChange:e}):null}const selector$d=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function useStoreUpdater(e,r){reactExports.useEffect(()=>{typeof e<"u"&&r(e)},[e])}function useDirectStoreUpdater(e,r,t){reactExports.useEffect(()=>{typeof r<"u"&&t({[e]:r})},[r])}const StoreUpdater=({nodes:e,edges:r,defaultNodes:t,defaultEdges:a,onConnect:c,onConnectStart:h,onConnectEnd:_,onClickConnectStart:f,onClickConnectEnd:g,nodesDraggable:b,nodesConnectable:p,nodesFocusable:E,edgesFocusable:M,edgesUpdatable:R,elevateNodesOnSelect:z,minZoom:l,maxZoom:s,nodeExtent:v,onNodesChange:w,onEdgesChange:S,elementsSelectable:A,connectionMode:u,snapGrid:y,snapToGrid:C,translateExtent:k,connectOnClick:I,defaultEdgeOptions:O,fitView:D,fitViewOptions:X,onNodesDelete:j,onEdgesDelete:B,onNodeDrag:$,onNodeDragStart:H,onNodeDragStop:q,onSelectionDrag:W,onSelectionDragStart:Y,onSelectionDragStop:G,noPanClassName:V,nodeOrigin:Q,rfId:xe,autoPanOnConnect:ce,autoPanOnNodeDrag:Ne,onError:Pe,connectionRadius:Fe,isValidConnection:Me,nodeDragThreshold:je})=>{const{setNodes:ft,setEdges:jt,setDefaultNodesAndEdges:Gt,setMinZoom:mt,setMaxZoom:Le,setTranslateExtent:ht,setNodeExtent:ar,reset:Jt}=useStore(selector$d,shallow$1),Wt=useStoreApi();return reactExports.useEffect(()=>{const Gr=a?.map(Lr=>({...Lr,...O}));return Gt(t,Gr),()=>{Jt()}},[]),useDirectStoreUpdater("defaultEdgeOptions",O,Wt.setState),useDirectStoreUpdater("connectionMode",u,Wt.setState),useDirectStoreUpdater("onConnect",c,Wt.setState),useDirectStoreUpdater("onConnectStart",h,Wt.setState),useDirectStoreUpdater("onConnectEnd",_,Wt.setState),useDirectStoreUpdater("onClickConnectStart",f,Wt.setState),useDirectStoreUpdater("onClickConnectEnd",g,Wt.setState),useDirectStoreUpdater("nodesDraggable",b,Wt.setState),useDirectStoreUpdater("nodesConnectable",p,Wt.setState),useDirectStoreUpdater("nodesFocusable",E,Wt.setState),useDirectStoreUpdater("edgesFocusable",M,Wt.setState),useDirectStoreUpdater("edgesUpdatable",R,Wt.setState),useDirectStoreUpdater("elementsSelectable",A,Wt.setState),useDirectStoreUpdater("elevateNodesOnSelect",z,Wt.setState),useDirectStoreUpdater("snapToGrid",C,Wt.setState),useDirectStoreUpdater("snapGrid",y,Wt.setState),useDirectStoreUpdater("onNodesChange",w,Wt.setState),useDirectStoreUpdater("onEdgesChange",S,Wt.setState),useDirectStoreUpdater("connectOnClick",I,Wt.setState),useDirectStoreUpdater("fitViewOnInit",D,Wt.setState),useDirectStoreUpdater("fitViewOnInitOptions",X,Wt.setState),useDirectStoreUpdater("onNodesDelete",j,Wt.setState),useDirectStoreUpdater("onEdgesDelete",B,Wt.setState),useDirectStoreUpdater("onNodeDrag",$,Wt.setState),useDirectStoreUpdater("onNodeDragStart",H,Wt.setState),useDirectStoreUpdater("onNodeDragStop",q,Wt.setState),useDirectStoreUpdater("onSelectionDrag",W,Wt.setState),useDirectStoreUpdater("onSelectionDragStart",Y,Wt.setState),useDirectStoreUpdater("onSelectionDragStop",G,Wt.setState),useDirectStoreUpdater("noPanClassName",V,Wt.setState),useDirectStoreUpdater("nodeOrigin",Q,Wt.setState),useDirectStoreUpdater("rfId",xe,Wt.setState),useDirectStoreUpdater("autoPanOnConnect",ce,Wt.setState),useDirectStoreUpdater("autoPanOnNodeDrag",Ne,Wt.setState),useDirectStoreUpdater("onError",Pe,Wt.setState),useDirectStoreUpdater("connectionRadius",Fe,Wt.setState),useDirectStoreUpdater("isValidConnection",Me,Wt.setState),useDirectStoreUpdater("nodeDragThreshold",je,Wt.setState),useStoreUpdater(e,ft),useStoreUpdater(r,jt),useStoreUpdater(l,mt),useStoreUpdater(s,Le),useStoreUpdater(k,ht),useStoreUpdater(v,ar),null},style={display:"none"},ariaLiveStyle={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ARIA_NODE_DESC_KEY="react-flow__node-desc",ARIA_EDGE_DESC_KEY="react-flow__edge-desc",ARIA_LIVE_MESSAGE="react-flow__aria-live",selector$c=e=>e.ariaLiveMessage;function AriaLiveMessage({rfId:e}){const r=useStore(selector$c);return React.createElement("div",{id:`${ARIA_LIVE_MESSAGE}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:ariaLiveStyle},r)}function A11yDescriptions({rfId:e,disableKeyboardA11y:r}){return React.createElement(React.Fragment,null,React.createElement("div",{id:`${ARIA_NODE_DESC_KEY}-${e}`,style},"Press enter or space to select a node.",!r&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),React.createElement("div",{id:`${ARIA_EDGE_DESC_KEY}-${e}`,style},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!r&&React.createElement(AriaLiveMessage,{rfId:e}))}var useKeyPress=(e=null,r={actInsideInputWithModifier:!0})=>{const[t,a]=reactExports.useState(!1),c=reactExports.useRef(!1),h=reactExports.useRef(new Set([])),[_,f]=reactExports.useMemo(()=>{if(e!==null){const b=(Array.isArray(e)?e:[e]).filter(E=>typeof E=="string").map(E=>E.split("+")),p=b.reduce((E,M)=>E.concat(...M),[]);return[b,p]}return[[],[]]},[e]);return reactExports.useEffect(()=>{const g=typeof document<"u"?document:null,b=r?.target||g;if(e!==null){const p=R=>{if(c.current=R.ctrlKey||R.metaKey||R.shiftKey,(!c.current||c.current&&!r.actInsideInputWithModifier)&&isInputDOMNode(R))return!1;const l=useKeyOrCode(R.code,f);h.current.add(R[l]),isMatchingKey(_,h.current,!1)&&(R.preventDefault(),a(!0))},E=R=>{if((!c.current||c.current&&!r.actInsideInputWithModifier)&&isInputDOMNode(R))return!1;const l=useKeyOrCode(R.code,f);isMatchingKey(_,h.current,!0)?(a(!1),h.current.clear()):h.current.delete(R[l]),R.key==="Meta"&&h.current.clear(),c.current=!1},M=()=>{h.current.clear(),a(!1)};return b?.addEventListener("keydown",p),b?.addEventListener("keyup",E),window.addEventListener("blur",M),()=>{b?.removeEventListener("keydown",p),b?.removeEventListener("keyup",E),window.removeEventListener("blur",M)}}},[e,a]),t};function isMatchingKey(e,r,t){return e.filter(a=>t||a.length===r.size).some(a=>a.every(c=>r.has(c)))}function useKeyOrCode(e,r){return r.includes(e)?"code":"key"}function calculateXYZPosition(e,r,t,a){const c=e.parentNode||e.parentId;if(!c)return t;const h=r.get(c),_=getNodePositionWithOrigin(h,a);return calculateXYZPosition(h,r,{x:(t.x??0)+_.x,y:(t.y??0)+_.y,z:(h[internalsSymbol]?.z??0)>(t.z??0)?h[internalsSymbol]?.z??0:t.z??0},a)}function updateAbsoluteNodePositions(e,r,t){e.forEach(a=>{const c=a.parentNode||a.parentId;if(c&&!e.has(c))throw new Error(`Parent node ${c} not found`);if(c||t?.[a.id]){const{x:h,y:_,z:f}=calculateXYZPosition(a,e,{...a.position,z:a[internalsSymbol]?.z??0},r);a.positionAbsolute={x:h,y:_},a[internalsSymbol].z=f,t?.[a.id]&&(a[internalsSymbol].isParent=!0)}})}function createNodeInternals(e,r,t,a){const c=new Map,h={},_=a?1e3:0;return e.forEach(f=>{const g=(isNumeric(f.zIndex)?f.zIndex:0)+(f.selected?_:0),b=r.get(f.id),p={...f,positionAbsolute:{x:f.position.x,y:f.position.y}},E=f.parentNode||f.parentId;E&&(h[E]=!0);const M=b?.type&&b?.type!==f.type;Object.defineProperty(p,internalsSymbol,{enumerable:!1,value:{handleBounds:M?void 0:b?.[internalsSymbol]?.handleBounds,z:g}}),c.set(f.id,p)}),updateAbsoluteNodePositions(c,t,h),c}function fitView(e,r={}){const{getNodes:t,width:a,height:c,minZoom:h,maxZoom:_,d3Zoom:f,d3Selection:g,fitViewOnInitDone:b,fitViewOnInit:p,nodeOrigin:E}=e(),M=r.initial&&!b&&p;if(f&&g&&(M||!r.initial)){const z=t().filter(s=>{const v=r.includeHiddenNodes?s.width&&s.height:!s.hidden;return r.nodes?.length?v&&r.nodes.some(w=>w.id===s.id):v}),l=z.every(s=>s.width&&s.height);if(z.length>0&&l){const s=getNodesBounds(z,E),{x:v,y:w,zoom:S}=getViewportForBounds(s,a,c,r.minZoom??h,r.maxZoom??_,r.padding??.1),A=identity.translate(v,w).scale(S);return typeof r.duration=="number"&&r.duration>0?f.transform(getD3Transition(g,r.duration),A):f.transform(g,A),!0}}return!1}function handleControlledNodeSelectionChange(e,r){return e.forEach(t=>{const a=r.get(t.id);a&&r.set(a.id,{...a,[internalsSymbol]:a[internalsSymbol],selected:t.selected})}),new Map(r)}function handleControlledEdgeSelectionChange(e,r){return r.map(t=>{const a=e.find(c=>c.id===t.id);return a&&(t.selected=a.selected),t})}function updateNodesAndEdgesSelections({changedNodes:e,changedEdges:r,get:t,set:a}){const{nodeInternals:c,edges:h,onNodesChange:_,onEdgesChange:f,hasDefaultNodes:g,hasDefaultEdges:b}=t();e?.length&&(g&&a({nodeInternals:handleControlledNodeSelectionChange(e,c)}),_?.(e)),r?.length&&(b&&a({edges:handleControlledEdgeSelectionChange(r,h)}),f?.(r))}const noop=()=>{},initialViewportHelper={zoomIn:noop,zoomOut:noop,zoomTo:noop,getZoom:()=>1,setViewport:noop,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:noop,fitBounds:noop,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},selector$b=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),useViewportHelper=()=>{const e=useStoreApi(),{d3Zoom:r,d3Selection:t}=useStore(selector$b,shallow$1);return reactExports.useMemo(()=>t&&r?{zoomIn:c=>r.scaleBy(getD3Transition(t,c?.duration),1.2),zoomOut:c=>r.scaleBy(getD3Transition(t,c?.duration),1/1.2),zoomTo:(c,h)=>r.scaleTo(getD3Transition(t,h?.duration),c),getZoom:()=>e.getState().transform[2],setViewport:(c,h)=>{const[_,f,g]=e.getState().transform,b=identity.translate(c.x??_,c.y??f).scale(c.zoom??g);r.transform(getD3Transition(t,h?.duration),b)},getViewport:()=>{const[c,h,_]=e.getState().transform;return{x:c,y:h,zoom:_}},fitView:c=>fitView(e.getState,c),setCenter:(c,h,_)=>{const{width:f,height:g,maxZoom:b}=e.getState(),p=typeof _?.zoom<"u"?_.zoom:b,E=f/2-c*p,M=g/2-h*p,R=identity.translate(E,M).scale(p);r.transform(getD3Transition(t,_?.duration),R)},fitBounds:(c,h)=>{const{width:_,height:f,minZoom:g,maxZoom:b}=e.getState(),{x:p,y:E,zoom:M}=getViewportForBounds(c,_,f,g,b,h?.padding??.1),R=identity.translate(p,E).scale(M);r.transform(getD3Transition(t,h?.duration),R)},project:c=>{const{transform:h,snapToGrid:_,snapGrid:f}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),pointToRendererPoint(c,h,_,f)},screenToFlowPosition:c=>{const{transform:h,snapToGrid:_,snapGrid:f,domNode:g}=e.getState();if(!g)return c;const{x:b,y:p}=g.getBoundingClientRect(),E={x:c.x-b,y:c.y-p};return pointToRendererPoint(E,h,_,f)},flowToScreenPosition:c=>{const{transform:h,domNode:_}=e.getState();if(!_)return c;const{x:f,y:g}=_.getBoundingClientRect(),b=rendererPointToPoint(c,h);return{x:b.x+f,y:b.y+g}},viewportInitialized:!0}:initialViewportHelper,[r,t])};function useReactFlow(){const e=useViewportHelper(),r=useStoreApi(),t=reactExports.useCallback(()=>r.getState().getNodes().map(l=>({...l})),[]),a=reactExports.useCallback(l=>r.getState().nodeInternals.get(l),[]),c=reactExports.useCallback(()=>{const{edges:l=[]}=r.getState();return l.map(s=>({...s}))},[]),h=reactExports.useCallback(l=>{const{edges:s=[]}=r.getState();return s.find(v=>v.id===l)},[]),_=reactExports.useCallback(l=>{const{getNodes:s,setNodes:v,hasDefaultNodes:w,onNodesChange:S}=r.getState(),A=s(),u=typeof l=="function"?l(A):l;if(w)v(u);else if(S){const y=u.length===0?A.map(C=>({type:"remove",id:C.id})):u.map(C=>({item:C,type:"reset"}));S(y)}},[]),f=reactExports.useCallback(l=>{const{edges:s=[],setEdges:v,hasDefaultEdges:w,onEdgesChange:S}=r.getState(),A=typeof l=="function"?l(s):l;if(w)v(A);else if(S){const u=A.length===0?s.map(y=>({type:"remove",id:y.id})):A.map(y=>({item:y,type:"reset"}));S(u)}},[]),g=reactExports.useCallback(l=>{const s=Array.isArray(l)?l:[l],{getNodes:v,setNodes:w,hasDefaultNodes:S,onNodesChange:A}=r.getState();if(S){const y=[...v(),...s];w(y)}else if(A){const u=s.map(y=>({item:y,type:"add"}));A(u)}},[]),b=reactExports.useCallback(l=>{const s=Array.isArray(l)?l:[l],{edges:v=[],setEdges:w,hasDefaultEdges:S,onEdgesChange:A}=r.getState();if(S)w([...v,...s]);else if(A){const u=s.map(y=>({item:y,type:"add"}));A(u)}},[]),p=reactExports.useCallback(()=>{const{getNodes:l,edges:s=[],transform:v}=r.getState(),[w,S,A]=v;return{nodes:l().map(u=>({...u})),edges:s.map(u=>({...u})),viewport:{x:w,y:S,zoom:A}}},[]),E=reactExports.useCallback(({nodes:l,edges:s})=>{const{nodeInternals:v,getNodes:w,edges:S,hasDefaultNodes:A,hasDefaultEdges:u,onNodesDelete:y,onEdgesDelete:C,onNodesChange:k,onEdgesChange:I}=r.getState(),O=(l||[]).map($=>$.id),D=(s||[]).map($=>$.id),X=w().reduce(($,H)=>{const q=H.parentNode||H.parentId,W=!O.includes(H.id)&&q&&$.find(G=>G.id===q);return(typeof H.deletable=="boolean"?H.deletable:!0)&&(O.includes(H.id)||W)&&$.push(H),$},[]),j=S.filter($=>typeof $.deletable=="boolean"?$.deletable:!0),B=j.filter($=>D.includes($.id));if(X||B){const $=getConnectedEdges(X,j),H=[...B,...$],q=H.reduce((W,Y)=>(W.includes(Y.id)||W.push(Y.id),W),[]);if((u||A)&&(u&&r.setState({edges:S.filter(W=>!q.includes(W.id))}),A&&(X.forEach(W=>{v.delete(W.id)}),r.setState({nodeInternals:new Map(v)}))),q.length>0&&(C?.(H),I&&I(q.map(W=>({id:W,type:"remove"})))),X.length>0&&(y?.(X),k)){const W=X.map(Y=>({id:Y.id,type:"remove"}));k(W)}}},[]),M=reactExports.useCallback(l=>{const s=isRectObject(l),v=s?null:r.getState().nodeInternals.get(l.id);return!s&&!v?[null,null,s]:[s?l:nodeToRect(v),v,s]},[]),R=reactExports.useCallback((l,s=!0,v)=>{const[w,S,A]=M(l);return w?(v||r.getState().getNodes()).filter(u=>{if(!A&&(u.id===S.id||!u.positionAbsolute))return!1;const y=nodeToRect(u),C=getOverlappingArea(y,w);return s&&C>0||C>=w.width*w.height}):[]},[]),z=reactExports.useCallback((l,s,v=!0)=>{const[w]=M(l);if(!w)return!1;const S=getOverlappingArea(w,s);return v&&S>0||S>=w.width*w.height},[]);return reactExports.useMemo(()=>({...e,getNodes:t,getNode:a,getEdges:c,getEdge:h,setNodes:_,setEdges:f,addNodes:g,addEdges:b,toObject:p,deleteElements:E,getIntersectingNodes:R,isNodeIntersecting:z}),[e,t,a,c,h,_,f,g,b,p,E,R,z])}const deleteKeyOptions={actInsideInputWithModifier:!1};var useGlobalKeyHandler=({deleteKeyCode:e,multiSelectionKeyCode:r})=>{const t=useStoreApi(),{deleteElements:a}=useReactFlow(),c=useKeyPress(e,deleteKeyOptions),h=useKeyPress(r);reactExports.useEffect(()=>{if(c){const{edges:_,getNodes:f}=t.getState(),g=f().filter(p=>p.selected),b=_.filter(p=>p.selected);a({nodes:g,edges:b}),t.setState({nodesSelectionActive:!1})}},[c]),reactExports.useEffect(()=>{t.setState({multiSelectionActive:h})},[h])};function useResizeHandler(e){const r=useStoreApi();reactExports.useEffect(()=>{let t;const a=()=>{if(!e.current)return;const c=getDimensions(e.current);(c.height===0||c.width===0)&&r.getState().onError?.("004",errorMessages.error004()),r.setState({width:c.width||500,height:c.height||500})};return a(),window.addEventListener("resize",a),e.current&&(t=new ResizeObserver(()=>a()),t.observe(e.current)),()=>{window.removeEventListener("resize",a),t&&e.current&&t.unobserve(e.current)}},[])}const containerStyle={position:"absolute",width:"100%",height:"100%",top:0,left:0},viewChanged=(e,r)=>e.x!==r.x||e.y!==r.y||e.zoom!==r.k,eventToFlowTransform=e=>({x:e.x,y:e.y,zoom:e.k}),isWrappedWithClass=(e,r)=>e.target.closest(`.${r}`),isRightClickPan=(e,r)=>r===2&&Array.isArray(e)&&e.includes(2),wheelDelta=e=>{const r=e.ctrlKey&&isMacOs()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*r},selector$a=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),ZoomPane=({onMove:e,onMoveStart:r,onMoveEnd:t,onPaneContextMenu:a,zoomOnScroll:c=!0,zoomOnPinch:h=!0,panOnScroll:_=!1,panOnScrollSpeed:f=.5,panOnScrollMode:g=PanOnScrollMode.Free,zoomOnDoubleClick:b=!0,elementsSelectable:p,panOnDrag:E=!0,defaultViewport:M,translateExtent:R,minZoom:z,maxZoom:l,zoomActivationKeyCode:s,preventScrolling:v=!0,children:w,noWheelClassName:S,noPanClassName:A})=>{const u=reactExports.useRef(),y=useStoreApi(),C=reactExports.useRef(!1),k=reactExports.useRef(!1),I=reactExports.useRef(null),O=reactExports.useRef({x:0,y:0,zoom:0}),{d3Zoom:D,d3Selection:X,d3ZoomHandler:j,userSelectionActive:B}=useStore(selector$a,shallow$1),$=useKeyPress(s),H=reactExports.useRef(0),q=reactExports.useRef(!1),W=reactExports.useRef();return useResizeHandler(I),reactExports.useEffect(()=>{if(I.current){const Y=I.current.getBoundingClientRect(),G=zoom().scaleExtent([z,l]).translateExtent(R),V=select(I.current).call(G),Q=identity.translate(M.x,M.y).scale(clamp(M.zoom,z,l)),xe=[[0,0],[Y.width,Y.height]],ce=G.constrain()(Q,xe,R);G.transform(V,ce),G.wheelDelta(wheelDelta),y.setState({d3Zoom:G,d3Selection:V,d3ZoomHandler:V.on("wheel.zoom"),transform:[ce.x,ce.y,ce.k],domNode:I.current.closest(".react-flow")})}},[]),reactExports.useEffect(()=>{X&&D&&(_&&!$&&!B?X.on("wheel.zoom",Y=>{if(isWrappedWithClass(Y,S))return!1;Y.preventDefault(),Y.stopImmediatePropagation();const G=X.property("__zoom").k||1;if(Y.ctrlKey&&h){const Me=pointer(Y),je=wheelDelta(Y),ft=G*Math.pow(2,je);D.scaleTo(X,ft,Me,Y);return}const V=Y.deltaMode===1?20:1;let Q=g===PanOnScrollMode.Vertical?0:Y.deltaX*V,xe=g===PanOnScrollMode.Horizontal?0:Y.deltaY*V;!isMacOs()&&Y.shiftKey&&g!==PanOnScrollMode.Vertical&&(Q=Y.deltaY*V,xe=0),D.translateBy(X,-(Q/G)*f,-(xe/G)*f,{internal:!0});const ce=eventToFlowTransform(X.property("__zoom")),{onViewportChangeStart:Ne,onViewportChange:Pe,onViewportChangeEnd:Fe}=y.getState();clearTimeout(W.current),q.current||(q.current=!0,r?.(Y,ce),Ne?.(ce)),q.current&&(e?.(Y,ce),Pe?.(ce),W.current=setTimeout(()=>{t?.(Y,ce),Fe?.(ce),q.current=!1},150))},{passive:!1}):typeof j<"u"&&X.on("wheel.zoom",function(Y,G){if(!v&&Y.type==="wheel"&&!Y.ctrlKey||isWrappedWithClass(Y,S))return null;Y.preventDefault(),j.call(this,Y,G)},{passive:!1}))},[B,_,g,X,D,j,$,h,v,S,r,e,t]),reactExports.useEffect(()=>{D&&D.on("start",Y=>{if(!Y.sourceEvent||Y.sourceEvent.internal)return null;H.current=Y.sourceEvent?.button;const{onViewportChangeStart:G}=y.getState(),V=eventToFlowTransform(Y.transform);C.current=!0,O.current=V,Y.sourceEvent?.type==="mousedown"&&y.setState({paneDragging:!0}),G?.(V),r?.(Y.sourceEvent,V)})},[D,r]),reactExports.useEffect(()=>{D&&(B&&!C.current?D.on("zoom",null):B||D.on("zoom",Y=>{const{onViewportChange:G}=y.getState();if(y.setState({transform:[Y.transform.x,Y.transform.y,Y.transform.k]}),k.current=!!(a&&isRightClickPan(E,H.current??0)),(e||G)&&!Y.sourceEvent?.internal){const V=eventToFlowTransform(Y.transform);G?.(V),e?.(Y.sourceEvent,V)}}))},[B,D,e,E,a]),reactExports.useEffect(()=>{D&&D.on("end",Y=>{if(!Y.sourceEvent||Y.sourceEvent.internal)return null;const{onViewportChangeEnd:G}=y.getState();if(C.current=!1,y.setState({paneDragging:!1}),a&&isRightClickPan(E,H.current??0)&&!k.current&&a(Y.sourceEvent),k.current=!1,(t||G)&&viewChanged(O.current,Y.transform)){const V=eventToFlowTransform(Y.transform);O.current=V,clearTimeout(u.current),u.current=setTimeout(()=>{G?.(V),t?.(Y.sourceEvent,V)},_?150:0)}})},[D,_,E,t,a]),reactExports.useEffect(()=>{D&&D.filter(Y=>{const G=$||c,V=h&&Y.ctrlKey;if((E===!0||Array.isArray(E)&&E.includes(1))&&Y.button===1&&Y.type==="mousedown"&&(isWrappedWithClass(Y,"react-flow__node")||isWrappedWithClass(Y,"react-flow__edge")))return!0;if(!E&&!G&&!_&&!b&&!h||B||!b&&Y.type==="dblclick"||isWrappedWithClass(Y,S)&&Y.type==="wheel"||isWrappedWithClass(Y,A)&&(Y.type!=="wheel"||_&&Y.type==="wheel"&&!$)||!h&&Y.ctrlKey&&Y.type==="wheel"||!G&&!_&&!V&&Y.type==="wheel"||!E&&(Y.type==="mousedown"||Y.type==="touchstart")||Array.isArray(E)&&!E.includes(Y.button)&&Y.type==="mousedown")return!1;const Q=Array.isArray(E)&&E.includes(Y.button)||!Y.button||Y.button<=1;return(!Y.ctrlKey||Y.type==="wheel")&&Q})},[B,D,c,h,_,b,E,p,$]),React.createElement("div",{className:"react-flow__renderer",ref:I,style:containerStyle},w)},selector$9=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function UserSelection(){const{userSelectionActive:e,userSelectionRect:r}=useStore(selector$9,shallow$1);return e&&r?React.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:r.width,height:r.height,transform:`translate(${r.x}px, ${r.y}px)`}}):null}function handleParentExpand(e,r){const t=r.parentNode||r.parentId,a=e.find(c=>c.id===t);if(a){const c=r.position.x+r.width-a.width,h=r.position.y+r.height-a.height;if(c>0||h>0||r.position.x<0||r.position.y<0){if(a.style={...a.style},a.style.width=a.style.width??a.width,a.style.height=a.style.height??a.height,c>0&&(a.style.width+=c),h>0&&(a.style.height+=h),r.position.x<0){const _=Math.abs(r.position.x);a.position.x=a.position.x-_,a.style.width+=_,r.position.x=0}if(r.position.y<0){const _=Math.abs(r.position.y);a.position.y=a.position.y-_,a.style.height+=_,r.position.y=0}a.width=a.style.width,a.height=a.style.height}}}function applyChanges(e,r){if(e.some(a=>a.type==="reset"))return e.filter(a=>a.type==="reset").map(a=>a.item);const t=e.filter(a=>a.type==="add").map(a=>a.item);return r.reduce((a,c)=>{const h=e.filter(f=>f.id===c.id);if(h.length===0)return a.push(c),a;const _={...c};for(const f of h)if(f)switch(f.type){case"select":{_.selected=f.selected;break}case"position":{typeof f.position<"u"&&(_.position=f.position),typeof f.positionAbsolute<"u"&&(_.positionAbsolute=f.positionAbsolute),typeof f.dragging<"u"&&(_.dragging=f.dragging),_.expandParent&&handleParentExpand(a,_);break}case"dimensions":{typeof f.dimensions<"u"&&(_.width=f.dimensions.width,_.height=f.dimensions.height),typeof f.updateStyle<"u"&&(_.style={..._.style||{},...f.dimensions}),typeof f.resizing=="boolean"&&(_.resizing=f.resizing),_.expandParent&&handleParentExpand(a,_);break}case"remove":return a}return a.push(_),a},t)}function applyNodeChanges(e,r){return applyChanges(e,r)}function applyEdgeChanges(e,r){return applyChanges(e,r)}const createSelectionChange=(e,r)=>({id:e,type:"select",selected:r});function getSelectionChanges(e,r){return e.reduce((t,a)=>{const c=r.includes(a.id);return!a.selected&&c?(a.selected=!0,t.push(createSelectionChange(a.id,!0))):a.selected&&!c&&(a.selected=!1,t.push(createSelectionChange(a.id,!1))),t},[])}const wrapHandler=(e,r)=>t=>{t.target===r.current&&e?.(t)},selector$8=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Pane=reactExports.memo(({isSelecting:e,selectionMode:r=SelectionMode.Full,panOnDrag:t,onSelectionStart:a,onSelectionEnd:c,onPaneClick:h,onPaneContextMenu:_,onPaneScroll:f,onPaneMouseEnter:g,onPaneMouseMove:b,onPaneMouseLeave:p,children:E})=>{const M=reactExports.useRef(null),R=useStoreApi(),z=reactExports.useRef(0),l=reactExports.useRef(0),s=reactExports.useRef(),{userSelectionActive:v,elementsSelectable:w,dragging:S}=useStore(selector$8,shallow$1),A=()=>{R.setState({userSelectionActive:!1,userSelectionRect:null}),z.current=0,l.current=0},u=j=>{h?.(j),R.getState().resetSelectedElements(),R.setState({nodesSelectionActive:!1})},y=j=>{if(Array.isArray(t)&&t?.includes(2)){j.preventDefault();return}_?.(j)},C=f?j=>f(j):void 0,k=j=>{const{resetSelectedElements:B,domNode:$}=R.getState();if(s.current=$?.getBoundingClientRect(),!w||!e||j.button!==0||j.target!==M.current||!s.current)return;const{x:H,y:q}=getEventPosition(j,s.current);B(),R.setState({userSelectionRect:{width:0,height:0,startX:H,startY:q,x:H,y:q}}),a?.(j)},I=j=>{const{userSelectionRect:B,nodeInternals:$,edges:H,transform:q,onNodesChange:W,onEdgesChange:Y,nodeOrigin:G,getNodes:V}=R.getState();if(!e||!s.current||!B)return;R.setState({userSelectionActive:!0,nodesSelectionActive:!1});const Q=getEventPosition(j,s.current),xe=B.startX??0,ce=B.startY??0,Ne={...B,x:Q.x<xe?Q.x:xe,y:Q.y<ce?Q.y:ce,width:Math.abs(Q.x-xe),height:Math.abs(Q.y-ce)},Pe=V(),Fe=getNodesInside($,Ne,q,r===SelectionMode.Partial,!0,G),Me=getConnectedEdges(Fe,H).map(ft=>ft.id),je=Fe.map(ft=>ft.id);if(z.current!==je.length){z.current=je.length;const ft=getSelectionChanges(Pe,je);ft.length&&W?.(ft)}if(l.current!==Me.length){l.current=Me.length;const ft=getSelectionChanges(H,Me);ft.length&&Y?.(ft)}R.setState({userSelectionRect:Ne})},O=j=>{if(j.button!==0)return;const{userSelectionRect:B}=R.getState();!v&&B&&j.target===M.current&&u?.(j),R.setState({nodesSelectionActive:z.current>0}),A(),c?.(j)},D=j=>{v&&(R.setState({nodesSelectionActive:z.current>0}),c?.(j)),A()},X=w&&(e||v);return React.createElement("div",{className:cc(["react-flow__pane",{dragging:S,selection:e}]),onClick:X?void 0:wrapHandler(u,M),onContextMenu:wrapHandler(y,M),onWheel:wrapHandler(C,M),onMouseEnter:X?void 0:g,onMouseDown:X?k:void 0,onMouseMove:X?I:b,onMouseUp:X?O:void 0,onMouseLeave:X?D:p,ref:M,style:containerStyle},E,React.createElement(UserSelection,null))});Pane.displayName="Pane";function isParentSelected(e,r){const t=e.parentNode||e.parentId;if(!t)return!1;const a=r.get(t);return a?a.selected?!0:isParentSelected(a,r):!1}function hasSelector(e,r,t){let a=e;do{if(a?.matches(r))return!0;if(a===t.current)return!1;a=a.parentElement}while(a);return!1}function getDragItems(e,r,t,a){return Array.from(e.values()).filter(c=>(c.selected||c.id===a)&&(!c.parentNode||c.parentId||!isParentSelected(c,e))&&(c.draggable||r&&typeof c.draggable>"u")).map(c=>({id:c.id,position:c.position||{x:0,y:0},positionAbsolute:c.positionAbsolute||{x:0,y:0},distance:{x:t.x-(c.positionAbsolute?.x??0),y:t.y-(c.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:c.extent,parentNode:c.parentNode||c.parentId,parentId:c.parentNode||c.parentId,width:c.width,height:c.height,expandParent:c.expandParent}))}function clampNodeExtent(e,r){return!r||r==="parent"?r:[r[0],[r[1][0]-(e.width||0),r[1][1]-(e.height||0)]]}function calcNextPosition(e,r,t,a,c=[0,0],h){const _=clampNodeExtent(e,e.extent||a);let f=_;const g=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(g&&e.width&&e.height){const E=t.get(g),{x:M,y:R}=getNodePositionWithOrigin(E,c).positionAbsolute;f=E&&isNumeric(M)&&isNumeric(R)&&isNumeric(E.width)&&isNumeric(E.height)?[[M+e.width*c[0],R+e.height*c[1]],[M+E.width-e.width+e.width*c[0],R+E.height-e.height+e.height*c[1]]]:f}else h?.("005",errorMessages.error005()),f=_;else if(e.extent&&g&&e.extent!=="parent"){const E=t.get(g),{x:M,y:R}=getNodePositionWithOrigin(E,c).positionAbsolute;f=[[e.extent[0][0]+M,e.extent[0][1]+R],[e.extent[1][0]+M,e.extent[1][1]+R]]}let b={x:0,y:0};if(g){const E=t.get(g);b=getNodePositionWithOrigin(E,c).positionAbsolute}const p=f&&f!=="parent"?clampPosition(r,f):r;return{position:{x:p.x-b.x,y:p.y-b.y},positionAbsolute:p}}function getEventHandlerParams({nodeId:e,dragItems:r,nodeInternals:t}){const a=r.map(c=>({...t.get(c.id),position:c.position,positionAbsolute:c.positionAbsolute}));return[e?a.find(c=>c.id===e):a[0],a]}const getHandleBounds=(e,r,t,a)=>{const c=r.querySelectorAll(e);if(!c||!c.length)return null;const h=Array.from(c),_=r.getBoundingClientRect(),f={x:_.width*a[0],y:_.height*a[1]};return h.map(g=>{const b=g.getBoundingClientRect();return{id:g.getAttribute("data-handleid"),position:g.getAttribute("data-handlepos"),x:(b.left-_.left-f.x)/t,y:(b.top-_.top-f.y)/t,...getDimensions(g)}})};function getMouseHandler(e,r,t){return t===void 0?t:a=>{const c=r().nodeInternals.get(e);c&&t(a,{...c})}}function handleNodeClick({id:e,store:r,unselect:t=!1,nodeRef:a}){const{addSelectedNodes:c,unselectNodesAndEdges:h,multiSelectionActive:_,nodeInternals:f,onError:g}=r.getState(),b=f.get(e);if(!b){g?.("012",errorMessages.error012(e));return}r.setState({nodesSelectionActive:!1}),b.selected?(t||b.selected&&_)&&(h({nodes:[b],edges:[]}),requestAnimationFrame(()=>a?.current?.blur())):c([e])}function useGetPointerPosition(){const e=useStoreApi();return reactExports.useCallback(({sourceEvent:t})=>{const{transform:a,snapGrid:c,snapToGrid:h}=e.getState(),_=t.touches?t.touches[0].clientX:t.clientX,f=t.touches?t.touches[0].clientY:t.clientY,g={x:(_-a[0])/a[2],y:(f-a[1])/a[2]};return{xSnapped:h?c[0]*Math.round(g.x/c[0]):g.x,ySnapped:h?c[1]*Math.round(g.y/c[1]):g.y,...g}},[])}function wrapSelectionDragFunc(e){return(r,t,a)=>e?.(r,a)}function useDrag({nodeRef:e,disabled:r=!1,noDragClassName:t,handleSelector:a,nodeId:c,isSelectable:h,selectNodesOnDrag:_}){const f=useStoreApi(),[g,b]=reactExports.useState(!1),p=reactExports.useRef([]),E=reactExports.useRef({x:null,y:null}),M=reactExports.useRef(0),R=reactExports.useRef(null),z=reactExports.useRef({x:0,y:0}),l=reactExports.useRef(null),s=reactExports.useRef(!1),v=reactExports.useRef(!1),w=reactExports.useRef(!1),S=useGetPointerPosition();return reactExports.useEffect(()=>{if(e?.current){const A=select(e.current),u=({x:k,y:I})=>{const{nodeInternals:O,onNodeDrag:D,onSelectionDrag:X,updateNodePositions:j,nodeExtent:B,snapGrid:$,snapToGrid:H,nodeOrigin:q,onError:W}=f.getState();E.current={x:k,y:I};let Y=!1,G={x:0,y:0,x2:0,y2:0};if(p.current.length>1&&B){const Q=getNodesBounds(p.current,q);G=rectToBox(Q)}if(p.current=p.current.map(Q=>{const xe={x:k-Q.distance.x,y:I-Q.distance.y};H&&(xe.x=$[0]*Math.round(xe.x/$[0]),xe.y=$[1]*Math.round(xe.y/$[1]));const ce=[[B[0][0],B[0][1]],[B[1][0],B[1][1]]];p.current.length>1&&B&&!Q.extent&&(ce[0][0]=Q.positionAbsolute.x-G.x+B[0][0],ce[1][0]=Q.positionAbsolute.x+(Q.width??0)-G.x2+B[1][0],ce[0][1]=Q.positionAbsolute.y-G.y+B[0][1],ce[1][1]=Q.positionAbsolute.y+(Q.height??0)-G.y2+B[1][1]);const Ne=calcNextPosition(Q,xe,O,ce,q,W);return Y=Y||Q.position.x!==Ne.position.x||Q.position.y!==Ne.position.y,Q.position=Ne.position,Q.positionAbsolute=Ne.positionAbsolute,Q}),!Y)return;j(p.current,!0,!0),b(!0);const V=c?D:wrapSelectionDragFunc(X);if(V&&l.current){const[Q,xe]=getEventHandlerParams({nodeId:c,dragItems:p.current,nodeInternals:O});V(l.current,Q,xe)}},y=()=>{if(!R.current)return;const[k,I]=calcAutoPan(z.current,R.current);if(k!==0||I!==0){const{transform:O,panBy:D}=f.getState();E.current.x=(E.current.x??0)-k/O[2],E.current.y=(E.current.y??0)-I/O[2],D({x:k,y:I})&&u(E.current)}M.current=requestAnimationFrame(y)},C=k=>{const{nodeInternals:I,multiSelectionActive:O,nodesDraggable:D,unselectNodesAndEdges:X,onNodeDragStart:j,onSelectionDragStart:B}=f.getState();v.current=!0;const $=c?j:wrapSelectionDragFunc(B);(!_||!h)&&!O&&c&&(I.get(c)?.selected||X()),c&&h&&_&&handleNodeClick({id:c,store:f,nodeRef:e});const H=S(k);if(E.current=H,p.current=getDragItems(I,D,H,c),$&&p.current){const[q,W]=getEventHandlerParams({nodeId:c,dragItems:p.current,nodeInternals:I});$(k.sourceEvent,q,W)}};if(r)A.on(".drag",null);else{const k=drag().on("start",I=>{const{domNode:O,nodeDragThreshold:D}=f.getState();D===0&&C(I),w.current=!1;const X=S(I);E.current=X,R.current=O?.getBoundingClientRect()||null,z.current=getEventPosition(I.sourceEvent,R.current)}).on("drag",I=>{const O=S(I),{autoPanOnNodeDrag:D,nodeDragThreshold:X}=f.getState();if(I.sourceEvent.type==="touchmove"&&I.sourceEvent.touches.length>1&&(w.current=!0),!w.current){if(!s.current&&v.current&&D&&(s.current=!0,y()),!v.current){const j=O.xSnapped-(E?.current?.x??0),B=O.ySnapped-(E?.current?.y??0);Math.sqrt(j*j+B*B)>X&&C(I)}(E.current.x!==O.xSnapped||E.current.y!==O.ySnapped)&&p.current&&v.current&&(l.current=I.sourceEvent,z.current=getEventPosition(I.sourceEvent,R.current),u(O))}}).on("end",I=>{if(!(!v.current||w.current)&&(b(!1),s.current=!1,v.current=!1,cancelAnimationFrame(M.current),p.current)){const{updateNodePositions:O,nodeInternals:D,onNodeDragStop:X,onSelectionDragStop:j}=f.getState(),B=c?X:wrapSelectionDragFunc(j);if(O(p.current,!1,!1),B){const[$,H]=getEventHandlerParams({nodeId:c,dragItems:p.current,nodeInternals:D});B(I.sourceEvent,$,H)}}}).filter(I=>{const O=I.target;return!I.button&&(!t||!hasSelector(O,`.${t}`,e))&&(!a||hasSelector(O,a,e))});return A.call(k),()=>{A.on(".drag",null)}}}},[e,r,t,a,h,f,c,_,S]),g}function useUpdateNodePositions(){const e=useStoreApi();return reactExports.useCallback(t=>{const{nodeInternals:a,nodeExtent:c,updateNodePositions:h,getNodes:_,snapToGrid:f,snapGrid:g,onError:b,nodesDraggable:p}=e.getState(),E=_().filter(w=>w.selected&&(w.draggable||p&&typeof w.draggable>"u")),M=f?g[0]:5,R=f?g[1]:5,z=t.isShiftPressed?4:1,l=t.x*M*z,s=t.y*R*z,v=E.map(w=>{if(w.positionAbsolute){const S={x:w.positionAbsolute.x+l,y:w.positionAbsolute.y+s};f&&(S.x=g[0]*Math.round(S.x/g[0]),S.y=g[1]*Math.round(S.y/g[1]));const{positionAbsolute:A,position:u}=calcNextPosition(w,S,a,c,void 0,b);w.position=u,w.positionAbsolute=A}return w});h(v,!0,!1)},[])}const arrowKeyDiffs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var wrapNode=e=>{const r=({id:t,type:a,data:c,xPos:h,yPos:_,xPosOrigin:f,yPosOrigin:g,selected:b,onClick:p,onMouseEnter:E,onMouseMove:M,onMouseLeave:R,onContextMenu:z,onDoubleClick:l,style:s,className:v,isDraggable:w,isSelectable:S,isConnectable:A,isFocusable:u,selectNodesOnDrag:y,sourcePosition:C,targetPosition:k,hidden:I,resizeObserver:O,dragHandle:D,zIndex:X,isParent:j,noDragClassName:B,noPanClassName:$,initialized:H,disableKeyboardA11y:q,ariaLabel:W,rfId:Y,hasHandleBounds:G})=>{const V=useStoreApi(),Q=reactExports.useRef(null),xe=reactExports.useRef(null),ce=reactExports.useRef(C),Ne=reactExports.useRef(k),Pe=reactExports.useRef(a),Fe=S||w||p||E||M||R,Me=useUpdateNodePositions(),je=getMouseHandler(t,V.getState,E),ft=getMouseHandler(t,V.getState,M),jt=getMouseHandler(t,V.getState,R),Gt=getMouseHandler(t,V.getState,z),mt=getMouseHandler(t,V.getState,l),Le=Jt=>{const{nodeDragThreshold:Wt}=V.getState();if(S&&(!y||!w||Wt>0)&&handleNodeClick({id:t,store:V,nodeRef:Q}),p){const Gr=V.getState().nodeInternals.get(t);Gr&&p(Jt,{...Gr})}},ht=Jt=>{if(!isInputDOMNode(Jt)&&!q)if(elementSelectionKeys.includes(Jt.key)&&S){const Wt=Jt.key==="Escape";handleNodeClick({id:t,store:V,unselect:Wt,nodeRef:Q})}else w&&b&&Object.prototype.hasOwnProperty.call(arrowKeyDiffs,Jt.key)&&(V.setState({ariaLiveMessage:`Moved selected node ${Jt.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~h}, y: ${~~_}`}),Me({x:arrowKeyDiffs[Jt.key].x,y:arrowKeyDiffs[Jt.key].y,isShiftPressed:Jt.shiftKey}))};reactExports.useEffect(()=>()=>{xe.current&&(O?.unobserve(xe.current),xe.current=null)},[]),reactExports.useEffect(()=>{if(Q.current&&!I){const Jt=Q.current;(!H||!G||xe.current!==Jt)&&(xe.current&&O?.unobserve(xe.current),O?.observe(Jt),xe.current=Jt)}},[I,H,G]),reactExports.useEffect(()=>{const Jt=Pe.current!==a,Wt=ce.current!==C,Gr=Ne.current!==k;Q.current&&(Jt||Wt||Gr)&&(Jt&&(Pe.current=a),Wt&&(ce.current=C),Gr&&(Ne.current=k),V.getState().updateNodeDimensions([{id:t,nodeElement:Q.current,forceUpdate:!0}]))},[t,a,C,k]);const ar=useDrag({nodeRef:Q,disabled:I||!w,noDragClassName:B,handleSelector:D,nodeId:t,isSelectable:S,selectNodesOnDrag:y});return I?null:React.createElement("div",{className:cc(["react-flow__node",`react-flow__node-${a}`,{[$]:w},v,{selected:b,selectable:S,parent:j,dragging:ar}]),ref:Q,style:{zIndex:X,transform:`translate(${f}px,${g}px)`,pointerEvents:Fe?"all":"none",visibility:H?"visible":"hidden",...s},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:je,onMouseMove:ft,onMouseLeave:jt,onContextMenu:Gt,onClick:Le,onDoubleClick:mt,onKeyDown:u?ht:void 0,tabIndex:u?0:void 0,role:u?"button":void 0,"aria-describedby":q?void 0:`${ARIA_NODE_DESC_KEY}-${Y}`,"aria-label":W},React.createElement(Provider$2,{value:t},React.createElement(e,{id:t,data:c,type:a,xPos:h,yPos:_,selected:b,isConnectable:A,sourcePosition:C,targetPosition:k,dragging:ar,dragHandle:D,zIndex:X})))};return r.displayName="NodeWrapper",reactExports.memo(r)};const selector$7=e=>{const r=e.getNodes().filter(t=>t.selected);return{...getNodesBounds(r,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function NodesSelection({onSelectionContextMenu:e,noPanClassName:r,disableKeyboardA11y:t}){const a=useStoreApi(),{width:c,height:h,x:_,y:f,transformString:g,userSelectionActive:b}=useStore(selector$7,shallow$1),p=useUpdateNodePositions(),E=reactExports.useRef(null);if(reactExports.useEffect(()=>{t||E.current?.focus({preventScroll:!0})},[t]),useDrag({nodeRef:E}),b||!c||!h)return null;const M=e?z=>{const l=a.getState().getNodes().filter(s=>s.selected);e(z,l)}:void 0,R=z=>{Object.prototype.hasOwnProperty.call(arrowKeyDiffs,z.key)&&p({x:arrowKeyDiffs[z.key].x,y:arrowKeyDiffs[z.key].y,isShiftPressed:z.shiftKey})};return React.createElement("div",{className:cc(["react-flow__nodesselection","react-flow__container",r]),style:{transform:g}},React.createElement("div",{ref:E,className:"react-flow__nodesselection-rect",onContextMenu:M,tabIndex:t?void 0:-1,onKeyDown:t?void 0:R,style:{width:c,height:h,top:f,left:_}}))}var NodesSelection$1=reactExports.memo(NodesSelection);const selector$6=e=>e.nodesSelectionActive,FlowRenderer=({children:e,onPaneClick:r,onPaneMouseEnter:t,onPaneMouseMove:a,onPaneMouseLeave:c,onPaneContextMenu:h,onPaneScroll:_,deleteKeyCode:f,onMove:g,onMoveStart:b,onMoveEnd:p,selectionKeyCode:E,selectionOnDrag:M,selectionMode:R,onSelectionStart:z,onSelectionEnd:l,multiSelectionKeyCode:s,panActivationKeyCode:v,zoomActivationKeyCode:w,elementsSelectable:S,zoomOnScroll:A,zoomOnPinch:u,panOnScroll:y,panOnScrollSpeed:C,panOnScrollMode:k,zoomOnDoubleClick:I,panOnDrag:O,defaultViewport:D,translateExtent:X,minZoom:j,maxZoom:B,preventScrolling:$,onSelectionContextMenu:H,noWheelClassName:q,noPanClassName:W,disableKeyboardA11y:Y})=>{const G=useStore(selector$6),V=useKeyPress(E),Q=useKeyPress(v),xe=Q||O,ce=Q||y,Ne=V||M&&xe!==!0;return useGlobalKeyHandler({deleteKeyCode:f,multiSelectionKeyCode:s}),React.createElement(ZoomPane,{onMove:g,onMoveStart:b,onMoveEnd:p,onPaneContextMenu:h,elementsSelectable:S,zoomOnScroll:A,zoomOnPinch:u,panOnScroll:ce,panOnScrollSpeed:C,panOnScrollMode:k,zoomOnDoubleClick:I,panOnDrag:!V&&xe,defaultViewport:D,translateExtent:X,minZoom:j,maxZoom:B,zoomActivationKeyCode:w,preventScrolling:$,noWheelClassName:q,noPanClassName:W},React.createElement(Pane,{onSelectionStart:z,onSelectionEnd:l,onPaneClick:r,onPaneMouseEnter:t,onPaneMouseMove:a,onPaneMouseLeave:c,onPaneContextMenu:h,onPaneScroll:_,panOnDrag:xe,isSelecting:!!Ne,selectionMode:R},e,G&&React.createElement(NodesSelection$1,{onSelectionContextMenu:H,noPanClassName:W,disableKeyboardA11y:Y})))};FlowRenderer.displayName="FlowRenderer";var FlowRenderer$1=reactExports.memo(FlowRenderer);function useVisibleNodes(e){return useStore(reactExports.useCallback(t=>e?getNodesInside(t.nodeInternals,{x:0,y:0,width:t.width,height:t.height},t.transform,!0):t.getNodes(),[e]))}function createNodeTypes(e){const r={input:wrapNode(e.input||InputNode$1),default:wrapNode(e.default||DefaultNode$1),output:wrapNode(e.output||OutputNode$1),group:wrapNode(e.group||GroupNode)},t={},a=Object.keys(e).filter(c=>!["input","default","output","group"].includes(c)).reduce((c,h)=>(c[h]=wrapNode(e[h]||DefaultNode$1),c),t);return{...r,...a}}const getPositionWithOrigin=({x:e,y:r,width:t,height:a,origin:c})=>!t||!a?{x:e,y:r}:c[0]<0||c[1]<0||c[0]>1||c[1]>1?{x:e,y:r}:{x:e-t*c[0],y:r-a*c[1]},selector$5=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),NodeRenderer=e=>{const{nodesDraggable:r,nodesConnectable:t,nodesFocusable:a,elementsSelectable:c,updateNodeDimensions:h,onError:_}=useStore(selector$5,shallow$1),f=useVisibleNodes(e.onlyRenderVisibleElements),g=reactExports.useRef(),b=reactExports.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const p=new ResizeObserver(E=>{const M=E.map(R=>({id:R.target.getAttribute("data-id"),nodeElement:R.target,forceUpdate:!0}));h(M)});return g.current=p,p},[]);return reactExports.useEffect(()=>()=>{g?.current?.disconnect()},[]),React.createElement("div",{className:"react-flow__nodes",style:containerStyle},f.map(p=>{let E=p.type||"default";e.nodeTypes[E]||(_?.("003",errorMessages.error003(E)),E="default");const M=e.nodeTypes[E]||e.nodeTypes.default,R=!!(p.draggable||r&&typeof p.draggable>"u"),z=!!(p.selectable||c&&typeof p.selectable>"u"),l=!!(p.connectable||t&&typeof p.connectable>"u"),s=!!(p.focusable||a&&typeof p.focusable>"u"),v=e.nodeExtent?clampPosition(p.positionAbsolute,e.nodeExtent):p.positionAbsolute,w=v?.x??0,S=v?.y??0,A=getPositionWithOrigin({x:w,y:S,width:p.width??0,height:p.height??0,origin:e.nodeOrigin});return React.createElement(M,{key:p.id,id:p.id,className:p.className,style:p.style,type:E,data:p.data,sourcePosition:p.sourcePosition||Position.Bottom,targetPosition:p.targetPosition||Position.Top,hidden:p.hidden,xPos:w,yPos:S,xPosOrigin:A.x,yPosOrigin:A.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!p.selected,isDraggable:R,isSelectable:z,isConnectable:l,isFocusable:s,resizeObserver:b,dragHandle:p.dragHandle,zIndex:p[internalsSymbol]?.z??0,isParent:!!p[internalsSymbol]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!p.width&&!!p.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:p.ariaLabel,hasHandleBounds:!!p[internalsSymbol]?.handleBounds})}))};NodeRenderer.displayName="NodeRenderer";var NodeRenderer$1=reactExports.memo(NodeRenderer);const shiftX=(e,r,t)=>t===Position.Left?e-r:t===Position.Right?e+r:e,shiftY=(e,r,t)=>t===Position.Top?e-r:t===Position.Bottom?e+r:e,EdgeUpdaterClassName="react-flow__edgeupdater",EdgeAnchor=({position:e,centerX:r,centerY:t,radius:a=10,onMouseDown:c,onMouseEnter:h,onMouseOut:_,type:f})=>React.createElement("circle",{onMouseDown:c,onMouseEnter:h,onMouseOut:_,className:cc([EdgeUpdaterClassName,`${EdgeUpdaterClassName}-${f}`]),cx:shiftX(r,a,e),cy:shiftY(t,a,e),r:a,stroke:"transparent",fill:"transparent"}),alwaysValidConnection=()=>!0;var wrapEdge=e=>{const r=({id:t,className:a,type:c,data:h,onClick:_,onEdgeDoubleClick:f,selected:g,animated:b,label:p,labelStyle:E,labelShowBg:M,labelBgStyle:R,labelBgPadding:z,labelBgBorderRadius:l,style:s,source:v,target:w,sourceX:S,sourceY:A,targetX:u,targetY:y,sourcePosition:C,targetPosition:k,elementsSelectable:I,hidden:O,sourceHandleId:D,targetHandleId:X,onContextMenu:j,onMouseEnter:B,onMouseMove:$,onMouseLeave:H,reconnectRadius:q,onReconnect:W,onReconnectStart:Y,onReconnectEnd:G,markerEnd:V,markerStart:Q,rfId:xe,ariaLabel:ce,isFocusable:Ne,isReconnectable:Pe,pathOptions:Fe,interactionWidth:Me,disableKeyboardA11y:je})=>{const ft=reactExports.useRef(null),[jt,Gt]=reactExports.useState(!1),[mt,Le]=reactExports.useState(!1),ht=useStoreApi(),ar=reactExports.useMemo(()=>`url('#${getMarkerId(Q,xe)}')`,[Q,xe]),Jt=reactExports.useMemo(()=>`url('#${getMarkerId(V,xe)}')`,[V,xe]);if(O)return null;const Wt=rt=>{const{edges:Yt,addSelectedEdges:Ot,unselectNodesAndEdges:re,multiSelectionActive:tt}=ht.getState(),lt=Yt.find(cr=>cr.id===t);lt&&(I&&(ht.setState({nodesSelectionActive:!1}),lt.selected&&tt?(re({nodes:[],edges:[lt]}),ft.current?.blur()):Ot([t])),_&&_(rt,lt))},Gr=getMouseHandler$1(t,ht.getState,f),Lr=getMouseHandler$1(t,ht.getState,j),zr=getMouseHandler$1(t,ht.getState,B),Nr=getMouseHandler$1(t,ht.getState,$),At=getMouseHandler$1(t,ht.getState,H),Mt=(rt,Yt)=>{if(rt.button!==0)return;const{edges:Ot,isValidConnection:re}=ht.getState(),tt=Yt?w:v,lt=(Yt?X:D)||null,cr=Yt?"target":"source",et=re||alwaysValidConnection,Ft=Yt,se=Ot.find(Z=>Z.id===t);Le(!0),Y?.(rt,se,cr);const _t=Z=>{Le(!1),G?.(Z,se,cr)};handlePointerDown({event:rt,handleId:lt,nodeId:tt,onConnect:Z=>W?.(se,Z),isTarget:Ft,getState:ht.getState,setState:ht.setState,isValidConnection:et,edgeUpdaterType:cr,onReconnectEnd:_t})},Jr=rt=>Mt(rt,!0),qr=rt=>Mt(rt,!1),ie=()=>Gt(!0),ve=()=>Gt(!1),we=!I&&!_,it=rt=>{if(!je&&elementSelectionKeys.includes(rt.key)&&I){const{unselectNodesAndEdges:Yt,addSelectedEdges:Ot,edges:re}=ht.getState();rt.key==="Escape"?(ft.current?.blur(),Yt({edges:[re.find(lt=>lt.id===t)]})):Ot([t])}};return React.createElement("g",{className:cc(["react-flow__edge",`react-flow__edge-${c}`,a,{selected:g,animated:b,inactive:we,updating:jt}]),onClick:Wt,onDoubleClick:Gr,onContextMenu:Lr,onMouseEnter:zr,onMouseMove:Nr,onMouseLeave:At,onKeyDown:Ne?it:void 0,tabIndex:Ne?0:void 0,role:Ne?"button":"img","data-testid":`rf__edge-${t}`,"aria-label":ce===null?void 0:ce||`Edge from ${v} to ${w}`,"aria-describedby":Ne?`${ARIA_EDGE_DESC_KEY}-${xe}`:void 0,ref:ft},!mt&&React.createElement(e,{id:t,source:v,target:w,selected:g,animated:b,label:p,labelStyle:E,labelShowBg:M,labelBgStyle:R,labelBgPadding:z,labelBgBorderRadius:l,data:h,style:s,sourceX:S,sourceY:A,targetX:u,targetY:y,sourcePosition:C,targetPosition:k,sourceHandleId:D,targetHandleId:X,markerStart:ar,markerEnd:Jt,pathOptions:Fe,interactionWidth:Me}),Pe&&React.createElement(React.Fragment,null,(Pe==="source"||Pe===!0)&&React.createElement(EdgeAnchor,{position:C,centerX:S,centerY:A,radius:q,onMouseDown:Jr,onMouseEnter:ie,onMouseOut:ve,type:"source"}),(Pe==="target"||Pe===!0)&&React.createElement(EdgeAnchor,{position:k,centerX:u,centerY:y,radius:q,onMouseDown:qr,onMouseEnter:ie,onMouseOut:ve,type:"target"})))};return r.displayName="EdgeWrapper",reactExports.memo(r)};function createEdgeTypes(e){const r={default:wrapEdge(e.default||BezierEdge),straight:wrapEdge(e.bezier||StraightEdge),step:wrapEdge(e.step||StepEdge),smoothstep:wrapEdge(e.step||SmoothStepEdge),simplebezier:wrapEdge(e.simplebezier||SimpleBezierEdge)},t={},a=Object.keys(e).filter(c=>!["default","bezier"].includes(c)).reduce((c,h)=>(c[h]=wrapEdge(e[h]||BezierEdge),c),t);return{...r,...a}}function getHandlePosition(e,r,t=null){const a=(t?.x||0)+r.x,c=(t?.y||0)+r.y,h=t?.width||r.width,_=t?.height||r.height;switch(e){case Position.Top:return{x:a+h/2,y:c};case Position.Right:return{x:a+h,y:c+_/2};case Position.Bottom:return{x:a+h/2,y:c+_};case Position.Left:return{x:a,y:c+_/2}}}function getHandle(e,r){return e?e.length===1||!r?e[0]:r&&e.find(t=>t.id===r)||null:null}const getEdgePositions=(e,r,t,a,c,h)=>{const _=getHandlePosition(t,e,r),f=getHandlePosition(h,a,c);return{sourceX:_.x,sourceY:_.y,targetX:f.x,targetY:f.y}};function isEdgeVisible({sourcePos:e,targetPos:r,sourceWidth:t,sourceHeight:a,targetWidth:c,targetHeight:h,width:_,height:f,transform:g}){const b={x:Math.min(e.x,r.x),y:Math.min(e.y,r.y),x2:Math.max(e.x+t,r.x+c),y2:Math.max(e.y+a,r.y+h)};b.x===b.x2&&(b.x2+=1),b.y===b.y2&&(b.y2+=1);const p=rectToBox({x:(0-g[0])/g[2],y:(0-g[1])/g[2],width:_/g[2],height:f/g[2]}),E=Math.max(0,Math.min(p.x2,b.x2)-Math.max(p.x,b.x)),M=Math.max(0,Math.min(p.y2,b.y2)-Math.max(p.y,b.y));return Math.ceil(E*M)>0}function getNodeData(e){const r=e?.[internalsSymbol]?.handleBounds||null,t=r&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},r,!!t]}const defaultEdgeTree=[{level:0,isMaxLevel:!0,edges:[]}];function groupEdgesByZLevel(e,r,t=!1){let a=-1;const c=e.reduce((_,f)=>{const g=isNumeric(f.zIndex);let b=g?f.zIndex:0;if(t){const p=r.get(f.target),E=r.get(f.source),M=f.selected||p?.selected||E?.selected,R=Math.max(E?.[internalsSymbol]?.z||0,p?.[internalsSymbol]?.z||0,1e3);b=(g?f.zIndex:0)+(M?R:0)}return _[b]?_[b].push(f):_[b]=[f],a=b>a?b:a,_},{}),h=Object.entries(c).map(([_,f])=>{const g=+_;return{edges:f,level:g,isMaxLevel:g===a}});return h.length===0?defaultEdgeTree:h}function useVisibleEdges(e,r,t){const a=useStore(reactExports.useCallback(c=>e?c.edges.filter(h=>{const _=r.get(h.source),f=r.get(h.target);return _?.width&&_?.height&&f?.width&&f?.height&&isEdgeVisible({sourcePos:_.positionAbsolute||{x:0,y:0},targetPos:f.positionAbsolute||{x:0,y:0},sourceWidth:_.width,sourceHeight:_.height,targetWidth:f.width,targetHeight:f.height,width:c.width,height:c.height,transform:c.transform})}):c.edges,[e,r]));return groupEdgesByZLevel(a,r,t)}const ArrowSymbol=({color:e="none",strokeWidth:r=1})=>React.createElement("polyline",{style:{stroke:e,strokeWidth:r},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),ArrowClosedSymbol=({color:e="none",strokeWidth:r=1})=>React.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:r},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),MarkerSymbols={[MarkerType.Arrow]:ArrowSymbol,[MarkerType.ArrowClosed]:ArrowClosedSymbol};function useMarkerSymbol(e){const r=useStoreApi();return reactExports.useMemo(()=>Object.prototype.hasOwnProperty.call(MarkerSymbols,e)?MarkerSymbols[e]:(r.getState().onError?.("009",errorMessages.error009(e)),null),[e])}const Marker=({id:e,type:r,color:t,width:a=12.5,height:c=12.5,markerUnits:h="strokeWidth",strokeWidth:_,orient:f="auto-start-reverse"})=>{const g=useMarkerSymbol(r);return g?React.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${a}`,markerHeight:`${c}`,viewBox:"-10 -10 20 20",markerUnits:h,orient:f,refX:"0",refY:"0"},React.createElement(g,{color:t,strokeWidth:_})):null},markerSelector=({defaultColor:e,rfId:r})=>t=>{const a=[];return t.edges.reduce((c,h)=>([h.markerStart,h.markerEnd].forEach(_=>{if(_&&typeof _=="object"){const f=getMarkerId(_,r);a.includes(f)||(c.push({id:f,color:_.color||e,..._}),a.push(f))}}),c),[]).sort((c,h)=>c.id.localeCompare(h.id))},MarkerDefinitions=({defaultColor:e,rfId:r})=>{const t=useStore(reactExports.useCallback(markerSelector({defaultColor:e,rfId:r}),[e,r]),(a,c)=>!(a.length!==c.length||a.some((h,_)=>h.id!==c[_].id)));return React.createElement("defs",null,t.map(a=>React.createElement(Marker,{id:a.id,key:a.id,type:a.type,color:a.color,width:a.width,height:a.height,markerUnits:a.markerUnits,strokeWidth:a.strokeWidth,orient:a.orient})))};MarkerDefinitions.displayName="MarkerDefinitions";var MarkerDefinitions$1=reactExports.memo(MarkerDefinitions);const selector$4=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),EdgeRenderer=({defaultMarkerColor:e,onlyRenderVisibleElements:r,elevateEdgesOnSelect:t,rfId:a,edgeTypes:c,noPanClassName:h,onEdgeContextMenu:_,onEdgeMouseEnter:f,onEdgeMouseMove:g,onEdgeMouseLeave:b,onEdgeClick:p,onEdgeDoubleClick:E,onReconnect:M,onReconnectStart:R,onReconnectEnd:z,reconnectRadius:l,children:s,disableKeyboardA11y:v})=>{const{edgesFocusable:w,edgesUpdatable:S,elementsSelectable:A,width:u,height:y,connectionMode:C,nodeInternals:k,onError:I}=useStore(selector$4,shallow$1),O=useVisibleEdges(r,k,t);return u?React.createElement(React.Fragment,null,O.map(({level:D,edges:X,isMaxLevel:j})=>React.createElement("svg",{key:D,style:{zIndex:D},width:u,height:y,className:"react-flow__edges react-flow__container"},j&&React.createElement(MarkerDefinitions$1,{defaultColor:e,rfId:a}),React.createElement("g",null,X.map(B=>{const[$,H,q]=getNodeData(k.get(B.source)),[W,Y,G]=getNodeData(k.get(B.target));if(!q||!G)return null;let V=B.type||"default";c[V]||(I?.("011",errorMessages.error011(V)),V="default");const Q=c[V]||c.default,xe=C===ConnectionMode.Strict?Y.target:(Y.target??[]).concat(Y.source??[]),ce=getHandle(H.source,B.sourceHandle),Ne=getHandle(xe,B.targetHandle),Pe=ce?.position||Position.Bottom,Fe=Ne?.position||Position.Top,Me=!!(B.focusable||w&&typeof B.focusable>"u"),je=B.reconnectable||B.updatable,ft=typeof M<"u"&&(je||S&&typeof je>"u");if(!ce||!Ne)return I?.("008",errorMessages.error008(ce,B)),null;const{sourceX:jt,sourceY:Gt,targetX:mt,targetY:Le}=getEdgePositions($,ce,Pe,W,Ne,Fe);return React.createElement(Q,{key:B.id,id:B.id,className:cc([B.className,h]),type:V,data:B.data,selected:!!B.selected,animated:!!B.animated,hidden:!!B.hidden,label:B.label,labelStyle:B.labelStyle,labelShowBg:B.labelShowBg,labelBgStyle:B.labelBgStyle,labelBgPadding:B.labelBgPadding,labelBgBorderRadius:B.labelBgBorderRadius,style:B.style,source:B.source,target:B.target,sourceHandleId:B.sourceHandle,targetHandleId:B.targetHandle,markerEnd:B.markerEnd,markerStart:B.markerStart,sourceX:jt,sourceY:Gt,targetX:mt,targetY:Le,sourcePosition:Pe,targetPosition:Fe,elementsSelectable:A,onContextMenu:_,onMouseEnter:f,onMouseMove:g,onMouseLeave:b,onClick:p,onEdgeDoubleClick:E,onReconnect:M,onReconnectStart:R,onReconnectEnd:z,reconnectRadius:l,rfId:a,ariaLabel:B.ariaLabel,isFocusable:Me,isReconnectable:ft,pathOptions:"pathOptions"in B?B.pathOptions:void 0,interactionWidth:B.interactionWidth,disableKeyboardA11y:v})})))),s):null};EdgeRenderer.displayName="EdgeRenderer";var EdgeRenderer$1=reactExports.memo(EdgeRenderer);const selector$3=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Viewport({children:e}){const r=useStore(selector$3);return React.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:r}},e)}function useOnInitHandler(e){const r=useReactFlow(),t=reactExports.useRef(!1);reactExports.useEffect(()=>{!t.current&&r.viewportInitialized&&e&&(setTimeout(()=>e(r),1),t.current=!0)},[e,r.viewportInitialized])}const oppositePosition={[Position.Left]:Position.Right,[Position.Right]:Position.Left,[Position.Top]:Position.Bottom,[Position.Bottom]:Position.Top},ConnectionLine=({nodeId:e,handleType:r,style:t,type:a=ConnectionLineType.Bezier,CustomComponent:c,connectionStatus:h})=>{const{fromNode:_,handleId:f,toX:g,toY:b,connectionMode:p}=useStore(reactExports.useCallback(y=>({fromNode:y.nodeInternals.get(e),handleId:y.connectionHandleId,toX:(y.connectionPosition.x-y.transform[0])/y.transform[2],toY:(y.connectionPosition.y-y.transform[1])/y.transform[2],connectionMode:y.connectionMode}),[e]),shallow$1),E=_?.[internalsSymbol]?.handleBounds;let M=E?.[r];if(p===ConnectionMode.Loose&&(M=M||E?.[r==="source"?"target":"source"]),!_||!M)return null;const R=f?M.find(y=>y.id===f):M[0],z=R?R.x+R.width/2:(_.width??0)/2,l=R?R.y+R.height/2:_.height??0,s=(_.positionAbsolute?.x??0)+z,v=(_.positionAbsolute?.y??0)+l,w=R?.position,S=w?oppositePosition[w]:null;if(!w||!S)return null;if(c)return React.createElement(c,{connectionLineType:a,connectionLineStyle:t,fromNode:_,fromHandle:R,fromX:s,fromY:v,toX:g,toY:b,fromPosition:w,toPosition:S,connectionStatus:h});let A="";const u={sourceX:s,sourceY:v,sourcePosition:w,targetX:g,targetY:b,targetPosition:S};return a===ConnectionLineType.Bezier?[A]=getBezierPath(u):a===ConnectionLineType.Step?[A]=getSmoothStepPath({...u,borderRadius:0}):a===ConnectionLineType.SmoothStep?[A]=getSmoothStepPath(u):a===ConnectionLineType.SimpleBezier?[A]=getSimpleBezierPath(u):A=`M${s},${v} ${g},${b}`,React.createElement("path",{d:A,fill:"none",className:"react-flow__connection-path",style:t})};ConnectionLine.displayName="ConnectionLine";const selector$2=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function ConnectionLineWrapper({containerStyle:e,style:r,type:t,component:a}){const{nodeId:c,handleType:h,nodesConnectable:_,width:f,height:g,connectionStatus:b}=useStore(selector$2,shallow$1);return!(c&&h&&f&&_)?null:React.createElement("svg",{style:e,width:f,height:g,className:"react-flow__edges react-flow__connectionline react-flow__container"},React.createElement("g",{className:cc(["react-flow__connection",b])},React.createElement(ConnectionLine,{nodeId:c,handleType:h,style:r,type:t,CustomComponent:a,connectionStatus:b})))}function useNodeOrEdgeTypes(e,r){return reactExports.useRef(null),useStoreApi(),reactExports.useMemo(()=>r(e),[e])}const GraphView=({nodeTypes:e,edgeTypes:r,onMove:t,onMoveStart:a,onMoveEnd:c,onInit:h,onNodeClick:_,onEdgeClick:f,onNodeDoubleClick:g,onEdgeDoubleClick:b,onNodeMouseEnter:p,onNodeMouseMove:E,onNodeMouseLeave:M,onNodeContextMenu:R,onSelectionContextMenu:z,onSelectionStart:l,onSelectionEnd:s,connectionLineType:v,connectionLineStyle:w,connectionLineComponent:S,connectionLineContainerStyle:A,selectionKeyCode:u,selectionOnDrag:y,selectionMode:C,multiSelectionKeyCode:k,panActivationKeyCode:I,zoomActivationKeyCode:O,deleteKeyCode:D,onlyRenderVisibleElements:X,elementsSelectable:j,selectNodesOnDrag:B,defaultViewport:$,translateExtent:H,minZoom:q,maxZoom:W,preventScrolling:Y,defaultMarkerColor:G,zoomOnScroll:V,zoomOnPinch:Q,panOnScroll:xe,panOnScrollSpeed:ce,panOnScrollMode:Ne,zoomOnDoubleClick:Pe,panOnDrag:Fe,onPaneClick:Me,onPaneMouseEnter:je,onPaneMouseMove:ft,onPaneMouseLeave:jt,onPaneScroll:Gt,onPaneContextMenu:mt,onEdgeContextMenu:Le,onEdgeMouseEnter:ht,onEdgeMouseMove:ar,onEdgeMouseLeave:Jt,onReconnect:Wt,onReconnectStart:Gr,onReconnectEnd:Lr,reconnectRadius:zr,noDragClassName:Nr,noWheelClassName:At,noPanClassName:Mt,elevateEdgesOnSelect:Jr,disableKeyboardA11y:qr,nodeOrigin:ie,nodeExtent:ve,rfId:we})=>{const it=useNodeOrEdgeTypes(e,createNodeTypes),rt=useNodeOrEdgeTypes(r,createEdgeTypes);return useOnInitHandler(h),React.createElement(FlowRenderer$1,{onPaneClick:Me,onPaneMouseEnter:je,onPaneMouseMove:ft,onPaneMouseLeave:jt,onPaneContextMenu:mt,onPaneScroll:Gt,deleteKeyCode:D,selectionKeyCode:u,selectionOnDrag:y,selectionMode:C,onSelectionStart:l,onSelectionEnd:s,multiSelectionKeyCode:k,panActivationKeyCode:I,zoomActivationKeyCode:O,elementsSelectable:j,onMove:t,onMoveStart:a,onMoveEnd:c,zoomOnScroll:V,zoomOnPinch:Q,zoomOnDoubleClick:Pe,panOnScroll:xe,panOnScrollSpeed:ce,panOnScrollMode:Ne,panOnDrag:Fe,defaultViewport:$,translateExtent:H,minZoom:q,maxZoom:W,onSelectionContextMenu:z,preventScrolling:Y,noDragClassName:Nr,noWheelClassName:At,noPanClassName:Mt,disableKeyboardA11y:qr},React.createElement(Viewport,null,React.createElement(EdgeRenderer$1,{edgeTypes:rt,onEdgeClick:f,onEdgeDoubleClick:b,onlyRenderVisibleElements:X,onEdgeContextMenu:Le,onEdgeMouseEnter:ht,onEdgeMouseMove:ar,onEdgeMouseLeave:Jt,onReconnect:Wt,onReconnectStart:Gr,onReconnectEnd:Lr,reconnectRadius:zr,defaultMarkerColor:G,noPanClassName:Mt,elevateEdgesOnSelect:!!Jr,disableKeyboardA11y:qr,rfId:we},React.createElement(ConnectionLineWrapper,{style:w,type:v,component:S,containerStyle:A})),React.createElement("div",{className:"react-flow__edgelabel-renderer"}),React.createElement(NodeRenderer$1,{nodeTypes:it,onNodeClick:_,onNodeDoubleClick:g,onNodeMouseEnter:p,onNodeMouseMove:E,onNodeMouseLeave:M,onNodeContextMenu:R,selectNodesOnDrag:B,onlyRenderVisibleElements:X,noPanClassName:Mt,noDragClassName:Nr,disableKeyboardA11y:qr,nodeOrigin:ie,nodeExtent:ve,rfId:we})))};GraphView.displayName="GraphView";var GraphView$1=reactExports.memo(GraphView);const infiniteExtent=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],initialState={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:infiniteExtent,nodeExtent:infiniteExtent,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:ConnectionMode.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:devWarn,isValidConnection:void 0},createRFStore=()=>createWithEqualityFn((e,r)=>({...initialState,setNodes:t=>{const{nodeInternals:a,nodeOrigin:c,elevateNodesOnSelect:h}=r();e({nodeInternals:createNodeInternals(t,a,c,h)})},getNodes:()=>Array.from(r().nodeInternals.values()),setEdges:t=>{const{defaultEdgeOptions:a={}}=r();e({edges:t.map(c=>({...a,...c}))})},setDefaultNodesAndEdges:(t,a)=>{const c=typeof t<"u",h=typeof a<"u",_=c?createNodeInternals(t,new Map,r().nodeOrigin,r().elevateNodesOnSelect):new Map;e({nodeInternals:_,edges:h?a:[],hasDefaultNodes:c,hasDefaultEdges:h})},updateNodeDimensions:t=>{const{onNodesChange:a,nodeInternals:c,fitViewOnInit:h,fitViewOnInitDone:_,fitViewOnInitOptions:f,domNode:g,nodeOrigin:b}=r(),p=g?.querySelector(".react-flow__viewport");if(!p)return;const E=window.getComputedStyle(p),{m22:M}=new window.DOMMatrixReadOnly(E.transform),R=t.reduce((l,s)=>{const v=c.get(s.id);if(v?.hidden)c.set(v.id,{...v,[internalsSymbol]:{...v[internalsSymbol],handleBounds:void 0}});else if(v){const w=getDimensions(s.nodeElement);!!(w.width&&w.height&&(v.width!==w.width||v.height!==w.height||s.forceUpdate))&&(c.set(v.id,{...v,[internalsSymbol]:{...v[internalsSymbol],handleBounds:{source:getHandleBounds(".source",s.nodeElement,M,b),target:getHandleBounds(".target",s.nodeElement,M,b)}},...w}),l.push({id:v.id,type:"dimensions",dimensions:w}))}return l},[]);updateAbsoluteNodePositions(c,b);const z=_||h&&!_&&fitView(r,{initial:!0,...f});e({nodeInternals:new Map(c),fitViewOnInitDone:z}),R?.length>0&&a?.(R)},updateNodePositions:(t,a=!0,c=!1)=>{const{triggerNodeChanges:h}=r(),_=t.map(f=>{const g={id:f.id,type:"position",dragging:c};return a&&(g.positionAbsolute=f.positionAbsolute,g.position=f.position),g});h(_)},triggerNodeChanges:t=>{const{onNodesChange:a,nodeInternals:c,hasDefaultNodes:h,nodeOrigin:_,getNodes:f,elevateNodesOnSelect:g}=r();if(t?.length){if(h){const b=applyNodeChanges(t,f()),p=createNodeInternals(b,c,_,g);e({nodeInternals:p})}a?.(t)}},addSelectedNodes:t=>{const{multiSelectionActive:a,edges:c,getNodes:h}=r();let _,f=null;a?_=t.map(g=>createSelectionChange(g,!0)):(_=getSelectionChanges(h(),t),f=getSelectionChanges(c,[])),updateNodesAndEdgesSelections({changedNodes:_,changedEdges:f,get:r,set:e})},addSelectedEdges:t=>{const{multiSelectionActive:a,edges:c,getNodes:h}=r();let _,f=null;a?_=t.map(g=>createSelectionChange(g,!0)):(_=getSelectionChanges(c,t),f=getSelectionChanges(h(),[])),updateNodesAndEdgesSelections({changedNodes:f,changedEdges:_,get:r,set:e})},unselectNodesAndEdges:({nodes:t,edges:a}={})=>{const{edges:c,getNodes:h}=r(),_=t||h(),f=a||c,g=_.map(p=>(p.selected=!1,createSelectionChange(p.id,!1))),b=f.map(p=>createSelectionChange(p.id,!1));updateNodesAndEdgesSelections({changedNodes:g,changedEdges:b,get:r,set:e})},setMinZoom:t=>{const{d3Zoom:a,maxZoom:c}=r();a?.scaleExtent([t,c]),e({minZoom:t})},setMaxZoom:t=>{const{d3Zoom:a,minZoom:c}=r();a?.scaleExtent([c,t]),e({maxZoom:t})},setTranslateExtent:t=>{r().d3Zoom?.translateExtent(t),e({translateExtent:t})},resetSelectedElements:()=>{const{edges:t,getNodes:a}=r(),h=a().filter(f=>f.selected).map(f=>createSelectionChange(f.id,!1)),_=t.filter(f=>f.selected).map(f=>createSelectionChange(f.id,!1));updateNodesAndEdgesSelections({changedNodes:h,changedEdges:_,get:r,set:e})},setNodeExtent:t=>{const{nodeInternals:a}=r();a.forEach(c=>{c.positionAbsolute=clampPosition(c.position,t)}),e({nodeExtent:t,nodeInternals:new Map(a)})},panBy:t=>{const{transform:a,width:c,height:h,d3Zoom:_,d3Selection:f,translateExtent:g}=r();if(!_||!f||!t.x&&!t.y)return!1;const b=identity.translate(a[0]+t.x,a[1]+t.y).scale(a[2]),p=[[0,0],[c,h]],E=_?.constrain()(b,p,g);return _.transform(f,E),a[0]!==E.x||a[1]!==E.y||a[2]!==E.k},cancelConnection:()=>e({connectionNodeId:initialState.connectionNodeId,connectionHandleId:initialState.connectionHandleId,connectionHandleType:initialState.connectionHandleType,connectionStatus:initialState.connectionStatus,connectionStartHandle:initialState.connectionStartHandle,connectionEndHandle:initialState.connectionEndHandle}),reset:()=>e({...initialState})}),Object.is),ReactFlowProvider=({children:e})=>{const r=reactExports.useRef(null);return r.current||(r.current=createRFStore()),React.createElement(Provider$1,{value:r.current},e)};ReactFlowProvider.displayName="ReactFlowProvider";const Wrapper=({children:e})=>reactExports.useContext(StoreContext)?React.createElement(React.Fragment,null,e):React.createElement(ReactFlowProvider,null,e);Wrapper.displayName="ReactFlowWrapper";const defaultNodeTypes={input:InputNode$1,default:DefaultNode$1,output:OutputNode$1,group:GroupNode},defaultEdgeTypes={default:BezierEdge,straight:StraightEdge,step:StepEdge,smoothstep:SmoothStepEdge,simplebezier:SimpleBezierEdge},initNodeOrigin=[0,0],initSnapGrid=[15,15],initDefaultViewport={x:0,y:0,zoom:1},wrapperStyle={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ReactFlow=reactExports.forwardRef(({nodes:e,edges:r,defaultNodes:t,defaultEdges:a,className:c,nodeTypes:h=defaultNodeTypes,edgeTypes:_=defaultEdgeTypes,onNodeClick:f,onEdgeClick:g,onInit:b,onMove:p,onMoveStart:E,onMoveEnd:M,onConnect:R,onConnectStart:z,onConnectEnd:l,onClickConnectStart:s,onClickConnectEnd:v,onNodeMouseEnter:w,onNodeMouseMove:S,onNodeMouseLeave:A,onNodeContextMenu:u,onNodeDoubleClick:y,onNodeDragStart:C,onNodeDrag:k,onNodeDragStop:I,onNodesDelete:O,onEdgesDelete:D,onSelectionChange:X,onSelectionDragStart:j,onSelectionDrag:B,onSelectionDragStop:$,onSelectionContextMenu:H,onSelectionStart:q,onSelectionEnd:W,connectionMode:Y=ConnectionMode.Strict,connectionLineType:G=ConnectionLineType.Bezier,connectionLineStyle:V,connectionLineComponent:Q,connectionLineContainerStyle:xe,deleteKeyCode:ce="Backspace",selectionKeyCode:Ne="Shift",selectionOnDrag:Pe=!1,selectionMode:Fe=SelectionMode.Full,panActivationKeyCode:Me="Space",multiSelectionKeyCode:je=isMacOs()?"Meta":"Control",zoomActivationKeyCode:ft=isMacOs()?"Meta":"Control",snapToGrid:jt=!1,snapGrid:Gt=initSnapGrid,onlyRenderVisibleElements:mt=!1,selectNodesOnDrag:Le=!0,nodesDraggable:ht,nodesConnectable:ar,nodesFocusable:Jt,nodeOrigin:Wt=initNodeOrigin,edgesFocusable:Gr,edgesUpdatable:Lr,elementsSelectable:zr,defaultViewport:Nr=initDefaultViewport,minZoom:At=.5,maxZoom:Mt=2,translateExtent:Jr=infiniteExtent,preventScrolling:qr=!0,nodeExtent:ie,defaultMarkerColor:ve="#b1b1b7",zoomOnScroll:we=!0,zoomOnPinch:it=!0,panOnScroll:rt=!1,panOnScrollSpeed:Yt=.5,panOnScrollMode:Ot=PanOnScrollMode.Free,zoomOnDoubleClick:re=!0,panOnDrag:tt=!0,onPaneClick:lt,onPaneMouseEnter:cr,onPaneMouseMove:et,onPaneMouseLeave:Ft,onPaneScroll:se,onPaneContextMenu:_t,children:Wr,onEdgeContextMenu:Z,onEdgeDoubleClick:ut,onEdgeMouseEnter:at,onEdgeMouseMove:me,onEdgeMouseLeave:Ze,onEdgeUpdate:vt,onEdgeUpdateStart:Qr,onEdgeUpdateEnd:Zr,onReconnect:Kr,onReconnectStart:bn,onReconnectEnd:ls,reconnectRadius:Pn=10,edgeUpdaterRadius:On=10,onNodesChange:Dn,onEdgesChange:gi,noDragClassName:Ei="nodrag",noWheelClassName:Aa="nowheel",noPanClassName:Ta="nopan",fitView:ti=!1,fitViewOptions:li,connectOnClick:ui=!0,attributionPosition:Js,proOptions:Vs,defaultEdgeOptions:pa,elevateNodesOnSelect:cl=!0,elevateEdgesOnSelect:ul=!1,disableKeyboardA11y:dl=!1,autoPanOnConnect:qa=!0,autoPanOnNodeDrag:fi=!0,connectionRadius:hl=20,isValidConnection:ja,onError:kc,style:Bn,id:Ra,nodeDragThreshold:ma,...Ml},Hs)=>{const fl=Ra||"1";return React.createElement("div",{...Ml,style:{...Bn,...wrapperStyle},ref:Hs,className:cc(["react-flow",c]),"data-testid":"rf__wrapper",id:Ra},React.createElement(Wrapper,null,React.createElement(GraphView$1,{onInit:b,onMove:p,onMoveStart:E,onMoveEnd:M,onNodeClick:f,onEdgeClick:g,onNodeMouseEnter:w,onNodeMouseMove:S,onNodeMouseLeave:A,onNodeContextMenu:u,onNodeDoubleClick:y,nodeTypes:h,edgeTypes:_,connectionLineType:G,connectionLineStyle:V,connectionLineComponent:Q,connectionLineContainerStyle:xe,selectionKeyCode:Ne,selectionOnDrag:Pe,selectionMode:Fe,deleteKeyCode:ce,multiSelectionKeyCode:je,panActivationKeyCode:Me,zoomActivationKeyCode:ft,onlyRenderVisibleElements:mt,selectNodesOnDrag:Le,defaultViewport:Nr,translateExtent:Jr,minZoom:At,maxZoom:Mt,preventScrolling:qr,zoomOnScroll:we,zoomOnPinch:it,zoomOnDoubleClick:re,panOnScroll:rt,panOnScrollSpeed:Yt,panOnScrollMode:Ot,panOnDrag:tt,onPaneClick:lt,onPaneMouseEnter:cr,onPaneMouseMove:et,onPaneMouseLeave:Ft,onPaneScroll:se,onPaneContextMenu:_t,onSelectionContextMenu:H,onSelectionStart:q,onSelectionEnd:W,onEdgeContextMenu:Z,onEdgeDoubleClick:ut,onEdgeMouseEnter:at,onEdgeMouseMove:me,onEdgeMouseLeave:Ze,onReconnect:Kr??vt,onReconnectStart:bn??Qr,onReconnectEnd:ls??Zr,reconnectRadius:Pn??On,defaultMarkerColor:ve,noDragClassName:Ei,noWheelClassName:Aa,noPanClassName:Ta,elevateEdgesOnSelect:ul,rfId:fl,disableKeyboardA11y:dl,nodeOrigin:Wt,nodeExtent:ie}),React.createElement(StoreUpdater,{nodes:e,edges:r,defaultNodes:t,defaultEdges:a,onConnect:R,onConnectStart:z,onConnectEnd:l,onClickConnectStart:s,onClickConnectEnd:v,nodesDraggable:ht,nodesConnectable:ar,nodesFocusable:Jt,edgesFocusable:Gr,edgesUpdatable:Lr,elementsSelectable:zr,elevateNodesOnSelect:cl,minZoom:At,maxZoom:Mt,nodeExtent:ie,onNodesChange:Dn,onEdgesChange:gi,snapToGrid:jt,snapGrid:Gt,connectionMode:Y,translateExtent:Jr,connectOnClick:ui,defaultEdgeOptions:pa,fitView:ti,fitViewOptions:li,onNodesDelete:O,onEdgesDelete:D,onNodeDragStart:C,onNodeDrag:k,onNodeDragStop:I,onSelectionDrag:B,onSelectionDragStart:j,onSelectionDragStop:$,noPanClassName:Ta,nodeOrigin:Wt,rfId:fl,autoPanOnConnect:qa,autoPanOnNodeDrag:fi,onError:kc,connectionRadius:hl,isValidConnection:ja,nodeDragThreshold:ma}),React.createElement(Wrapper$1,{onSelectionChange:X}),Wr,React.createElement(Attribution,{proOptions:Vs,position:Js}),React.createElement(A11yDescriptions,{rfId:fl,disableKeyboardA11y:dl})))});ReactFlow.displayName="ReactFlow";function PlusIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},React.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function MinusIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},React.createElement("path",{d:"M0 0h32v4.2H0z"}))}function FitViewIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},React.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function LockIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},React.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function UnlockIcon(){return React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},React.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const ControlButton=({children:e,className:r,...t})=>React.createElement("button",{type:"button",className:cc(["react-flow__controls-button",r]),...t},e);ControlButton.displayName="ControlButton";const selector$1=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Controls=({style:e,showZoom:r=!0,showFitView:t=!0,showInteractive:a=!0,fitViewOptions:c,onZoomIn:h,onZoomOut:_,onFitView:f,onInteractiveChange:g,className:b,children:p,position:E="bottom-left"})=>{const M=useStoreApi(),[R,z]=reactExports.useState(!1),{isInteractive:l,minZoomReached:s,maxZoomReached:v}=useStore(selector$1,shallow$1),{zoomIn:w,zoomOut:S,fitView:A}=useReactFlow();if(reactExports.useEffect(()=>{z(!0)},[]),!R)return null;const u=()=>{w(),h?.()},y=()=>{S(),_?.()},C=()=>{A(c),f?.()},k=()=>{M.setState({nodesDraggable:!l,nodesConnectable:!l,elementsSelectable:!l}),g?.(!l)};return React.createElement(Panel,{className:cc(["react-flow__controls",b]),position:E,style:e,"data-testid":"rf__controls"},r&&React.createElement(React.Fragment,null,React.createElement(ControlButton,{onClick:u,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:v},React.createElement(PlusIcon,null)),React.createElement(ControlButton,{onClick:y,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:s},React.createElement(MinusIcon,null))),t&&React.createElement(ControlButton,{className:"react-flow__controls-fitview",onClick:C,title:"fit view","aria-label":"fit view"},React.createElement(FitViewIcon,null)),a&&React.createElement(ControlButton,{className:"react-flow__controls-interactive",onClick:k,title:"toggle interactivity","aria-label":"toggle interactivity"},l?React.createElement(UnlockIcon,null):React.createElement(LockIcon,null)),p)};Controls.displayName="Controls";var Controls$1=reactExports.memo(Controls),BackgroundVariant;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(BackgroundVariant||(BackgroundVariant={}));function LinePattern({color:e,dimensions:r,lineWidth:t}){return React.createElement("path",{stroke:e,strokeWidth:t,d:`M${r[0]/2} 0 V${r[1]} M0 ${r[1]/2} H${r[0]}`})}function DotPattern({color:e,radius:r}){return React.createElement("circle",{cx:r,cy:r,r,fill:e})}const defaultColor={[BackgroundVariant.Dots]:"#91919a",[BackgroundVariant.Lines]:"#eee",[BackgroundVariant.Cross]:"#e2e2e2"},defaultSize={[BackgroundVariant.Dots]:1,[BackgroundVariant.Lines]:1,[BackgroundVariant.Cross]:6},selector=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Background({id:e,variant:r=BackgroundVariant.Dots,gap:t=20,size:a,lineWidth:c=1,offset:h=2,color:_,style:f,className:g}){const b=reactExports.useRef(null),{transform:p,patternId:E}=useStore(selector,shallow$1),M=_||defaultColor[r],R=a||defaultSize[r],z=r===BackgroundVariant.Dots,l=r===BackgroundVariant.Cross,s=Array.isArray(t)?t:[t,t],v=[s[0]*p[2]||1,s[1]*p[2]||1],w=R*p[2],S=l?[w,w]:v,A=z?[w/h,w/h]:[S[0]/h,S[1]/h];return React.createElement("svg",{className:cc(["react-flow__background",g]),style:{...f,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:b,"data-testid":"rf__background"},React.createElement("pattern",{id:E+e,x:p[0]%v[0],y:p[1]%v[1],width:v[0],height:v[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${A[0]},-${A[1]})`},z?React.createElement(DotPattern,{color:M,radius:w/h}):React.createElement(LinePattern,{dimensions:S,color:M,lineWidth:c})),React.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${E+e})`}))}Background.displayName="Background";var Background$1=reactExports.memo(Background);function darkenColorWithAlpha(e,r){let t=parseInt(e.slice(1,3),16),a=parseInt(e.slice(3,5),16),c=parseInt(e.slice(5,7),16),h=e.length===9?parseInt(e.slice(7,9),16)/255:1;return t=Math.max(0,t-t*r),a=Math.max(0,a-a*r),c=Math.max(0,c-c*r),`rgba(${t|0}, ${a|0}, ${c|0}, ${h})`}function getColors(e){return e?.startsWith("process")?{background:"#fc5e5eff",color:"#000"}:e?.startsWith("data")?{background:"#9aff86ff",color:"#000"}:{background:"#ccc",color:"#000"}}function HorizontalNode({data:e,selected:r}){const t=getColors(e.node_type),a=r?"#000":e.pos==="center"?darkenColorWithAlpha(t.background,.3):"transparent";return jsxRuntimeExports$1.jsxs("div",{style:{...t,border:`3px solid ${a}`,minWidth:100,textAlign:"center",padding:10,borderRadius:5},children:[jsxRuntimeExports$1.jsx(Handle$1,{type:"target",position:Position.Left}),jsxRuntimeExports$1.jsx("div",{children:e.label}),jsxRuntimeExports$1.jsx(Handle$1,{type:"source",position:Position.Right})]})}const nodeTypes={custom:HorizontalNode};function FlowChart({nodes:e,edges:r,setNodes:t,setEdges:a,selectedNode:c,onNodeSelect:h,onNodeDoubleSelect:_}){const f=reactExports.useCallback((p,E)=>{h&&h(E)},[h]),g=reactExports.useCallback((p,E)=>{_&&_(E)},[_]),b=e.map(p=>({...p,type:"custom",selected:c?.id===p.id}));return jsxRuntimeExports$1.jsx("div",{className:"w-full h-full",children:jsxRuntimeExports$1.jsxs(ReactFlow,{nodes:b,edges:r,nodeTypes,onNodesChange:p=>t(E=>applyNodeChanges(p,E)),onEdgesChange:p=>a(E=>applyEdgeChanges(p,E)),onNodeClick:f,onNodeDoubleClick:g,fitView:!0,nodesDraggable:!0,nodesConnectable:!1,children:[jsxRuntimeExports$1.jsx(Controls$1,{}),jsxRuntimeExports$1.jsx(Background$1,{variant:"dots",gap:12,size:1})]})})}function SidePane({selectedNode:e}){return jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4",children:[jsxRuntimeExports$1.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Node Info"}),e?jsxRuntimeExports$1.jsxs("pre",{className:"bg-gray-100 p-2 rounded overflow-x-auto",children:[" ",JSON.stringify(e.data,null,2)]}):jsxRuntimeExports$1.jsx("p",{children:"Click a node to see top level details. Double click fetch the node and get all the details."})]})}var classnames={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var hasRequiredClassnames;function requireClassnames(){return hasRequiredClassnames||(hasRequiredClassnames=1,(function(e){(function(){var r={}.hasOwnProperty;function t(){for(var h="",_=0;_<arguments.length;_++){var f=arguments[_];f&&(h=c(h,a(f)))}return h}function a(h){if(typeof h=="string"||typeof h=="number")return h;if(typeof h!="object")return"";if(Array.isArray(h))return t.apply(null,h);if(h.toString!==Object.prototype.toString&&!h.toString.toString().includes("[native code]"))return h.toString();var _="";for(var f in h)r.call(h,f)&&h[f]&&(_=c(_,f));return _}function c(h,_){return _?h?h+" "+_:h+_:h}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(classnames)),classnames.exports}var classnamesExports=requireClassnames();const classNames=getDefaultExportFromCjs(classnamesExports),DEFAULT_BREAKPOINTS=["xxl","xl","lg","md","sm","xs"],DEFAULT_MIN_BREAKPOINT="xs",ThemeContext=reactExports.createContext({prefixes:{},breakpoints:DEFAULT_BREAKPOINTS,minBreakpoint:DEFAULT_MIN_BREAKPOINT}),{Consumer,Provider}=ThemeContext;function useBootstrapPrefix(e,r){const{prefixes:t}=reactExports.useContext(ThemeContext);return e||t[r]||r}function useBootstrapBreakpoints(){const{breakpoints:e}=reactExports.useContext(ThemeContext);return e}function useBootstrapMinBreakpoint(){const{minBreakpoint:e}=reactExports.useContext(ThemeContext);return e}var propTypes$2={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=e,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var e=requireReactPropTypesSecret();function r(){}function t(){}return t.resetWarningCache=r,factoryWithThrowingShims=function(){function a(_,f,g,b,p,E){if(E!==e){var M=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw M.name="Invariant Violation",M}}a.isRequired=a;function c(){return a}var h={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:c,element:a,elementType:a,instanceOf:c,node:a,objectOf:c,oneOf:c,oneOfType:c,shape:c,exact:c,checkPropTypes:t,resetWarningCache:r};return h.PropTypes=h,h},factoryWithThrowingShims}var hasRequiredPropTypes;function requirePropTypes(){return hasRequiredPropTypes||(hasRequiredPropTypes=1,propTypes$2.exports=requireFactoryWithThrowingShims()()),propTypes$2.exports}var propTypesExports=requirePropTypes();const PropTypes=getDefaultExportFromCjs(propTypesExports),_excluded=["as","disabled"];function _objectWithoutPropertiesLoose(e,r){if(e==null)return{};var t={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(r.indexOf(a)>=0)continue;t[a]=e[a]}return t}function isTrivialHref(e){return!e||e.trim()==="#"}function useButtonProps({tagName:e,disabled:r,href:t,target:a,rel:c,role:h,onClick:_,tabIndex:f=0,type:g}){e||(t!=null||a!=null||c!=null?e="a":e="button");const b={tagName:e};if(e==="button")return[{type:g||"button",disabled:r},b];const p=M=>{if((r||e==="a"&&isTrivialHref(t))&&M.preventDefault(),r){M.stopPropagation();return}_?.(M)},E=M=>{M.key===" "&&(M.preventDefault(),p(M))};return e==="a"&&(t||(t="#"),r&&(t=void 0)),[{role:h??"button",disabled:void 0,tabIndex:r?void 0:f,href:t,target:e==="a"?a:void 0,"aria-disabled":r||void 0,rel:e==="a"?c:void 0,onClick:p,onKeyDown:E},b]}const Button$1=reactExports.forwardRef((e,r)=>{let{as:t,disabled:a}=e,c=_objectWithoutPropertiesLoose(e,_excluded);const[h,{tagName:_}]=useButtonProps(Object.assign({tagName:t,disabled:a},c));return jsxRuntimeExports$1.jsx(_,Object.assign({},c,h,{ref:r}))});Button$1.displayName="Button";const Button=reactExports.forwardRef(({as:e,bsPrefix:r,variant:t="primary",size:a,active:c=!1,disabled:h=!1,className:_,...f},g)=>{const b=useBootstrapPrefix(r,"btn"),[p,{tagName:E}]=useButtonProps({tagName:e,disabled:h,...f}),M=E;return jsxRuntimeExports$1.jsx(M,{...p,...f,ref:g,disabled:h,className:classNames(_,b,c&&"active",t&&`${b}-${t}`,a&&`${b}-${a}`,f.href&&h&&"disabled")})});Button.displayName="Button";function hasChildOfType(e,r){return reactExports.Children.toArray(e).some(t=>reactExports.isValidElement(t)&&t.type===r)}function useCol({as:e,bsPrefix:r,className:t,...a}){r=useBootstrapPrefix(r,"col");const c=useBootstrapBreakpoints(),h=useBootstrapMinBreakpoint(),_=[],f=[];return c.forEach(g=>{const b=a[g];delete a[g];let p,E,M;typeof b=="object"&&b!=null?{span:p,offset:E,order:M}=b:p=b;const R=g!==h?`-${g}`:"";p&&_.push(p===!0?`${r}${R}`:`${r}${R}-${p}`),M!=null&&f.push(`order${R}-${M}`),E!=null&&f.push(`offset${R}-${E}`)}),[{...a,className:classNames(t,..._,...f)},{as:e,bsPrefix:r,spans:_}]}const Col=reactExports.forwardRef((e,r)=>{const[{className:t,...a},{as:c="div",bsPrefix:h,spans:_}]=useCol(e);return jsxRuntimeExports$1.jsx(c,{...a,ref:r,className:classNames(t,!_.length&&h)})});Col.displayName="Col";const propTypes$1={type:PropTypes.string,tooltip:PropTypes.bool,as:PropTypes.elementType},Feedback=reactExports.forwardRef(({as:e="div",className:r,type:t="valid",tooltip:a=!1,...c},h)=>jsxRuntimeExports$1.jsx(e,{...c,ref:h,className:classNames(r,`${t}-${a?"tooltip":"feedback"}`)}));Feedback.displayName="Feedback";Feedback.propTypes=propTypes$1;const FormContext=reactExports.createContext({}),FormCheckInput=reactExports.forwardRef(({id:e,bsPrefix:r,className:t,type:a="checkbox",isValid:c=!1,isInvalid:h=!1,as:_="input",...f},g)=>{const{controlId:b}=reactExports.useContext(FormContext);return r=useBootstrapPrefix(r,"form-check-input"),jsxRuntimeExports$1.jsx(_,{...f,ref:g,type:a,id:e||b,className:classNames(t,r,c&&"is-valid",h&&"is-invalid")})});FormCheckInput.displayName="FormCheckInput";const FormCheckLabel=reactExports.forwardRef(({bsPrefix:e,className:r,htmlFor:t,...a},c)=>{const{controlId:h}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-check-label"),jsxRuntimeExports$1.jsx("label",{...a,ref:c,htmlFor:t||h,className:classNames(r,e)})});FormCheckLabel.displayName="FormCheckLabel";const FormCheck=reactExports.forwardRef(({id:e,bsPrefix:r,bsSwitchPrefix:t,inline:a=!1,reverse:c=!1,disabled:h=!1,isValid:_=!1,isInvalid:f=!1,feedbackTooltip:g=!1,feedback:b,feedbackType:p,className:E,style:M,title:R="",type:z="checkbox",label:l,children:s,as:v="input",...w},S)=>{r=useBootstrapPrefix(r,"form-check"),t=useBootstrapPrefix(t,"form-switch");const{controlId:A}=reactExports.useContext(FormContext),u=reactExports.useMemo(()=>({controlId:e||A}),[A,e]),y=!s&&l!=null&&l!==!1||hasChildOfType(s,FormCheckLabel),C=jsxRuntimeExports$1.jsx(FormCheckInput,{...w,type:z==="switch"?"checkbox":z,ref:S,isValid:_,isInvalid:f,disabled:h,as:v});return jsxRuntimeExports$1.jsx(FormContext.Provider,{value:u,children:jsxRuntimeExports$1.jsx("div",{style:M,className:classNames(E,y&&r,a&&`${r}-inline`,c&&`${r}-reverse`,z==="switch"&&t),children:s||jsxRuntimeExports$1.jsxs(jsxRuntimeExports$1.Fragment,{children:[C,y&&jsxRuntimeExports$1.jsx(FormCheckLabel,{title:R,children:l}),b&&jsxRuntimeExports$1.jsx(Feedback,{type:p,tooltip:g,children:b})]})})})});FormCheck.displayName="FormCheck";const FormCheck$1=Object.assign(FormCheck,{Input:FormCheckInput,Label:FormCheckLabel}),FormControl=reactExports.forwardRef(({bsPrefix:e,type:r,size:t,htmlSize:a,id:c,className:h,isValid:_=!1,isInvalid:f=!1,plaintext:g,readOnly:b,as:p="input",...E},M)=>{const{controlId:R}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-control"),jsxRuntimeExports$1.jsx(p,{...E,type:r,size:a,ref:M,readOnly:b,id:c||R,className:classNames(h,g?`${e}-plaintext`:e,t&&`${e}-${t}`,r==="color"&&`${e}-color`,_&&"is-valid",f&&"is-invalid")})});FormControl.displayName="FormControl";const FormControl$1=Object.assign(FormControl,{Feedback}),FormFloating=reactExports.forwardRef(({className:e,bsPrefix:r,as:t="div",...a},c)=>(r=useBootstrapPrefix(r,"form-floating"),jsxRuntimeExports$1.jsx(t,{ref:c,className:classNames(e,r),...a})));FormFloating.displayName="FormFloating";const FormGroup=reactExports.forwardRef(({controlId:e,as:r="div",...t},a)=>{const c=reactExports.useMemo(()=>({controlId:e}),[e]);return jsxRuntimeExports$1.jsx(FormContext.Provider,{value:c,children:jsxRuntimeExports$1.jsx(r,{...t,ref:a})})});FormGroup.displayName="FormGroup";const FormLabel=reactExports.forwardRef(({as:e="label",bsPrefix:r,column:t=!1,visuallyHidden:a=!1,className:c,htmlFor:h,..._},f)=>{const{controlId:g}=reactExports.useContext(FormContext);r=useBootstrapPrefix(r,"form-label");let b="col-form-label";typeof t=="string"&&(b=`${b} ${b}-${t}`);const p=classNames(c,r,a&&"visually-hidden",t&&b);return h=h||g,t?jsxRuntimeExports$1.jsx(Col,{ref:f,as:"label",className:p,htmlFor:h,..._}):jsxRuntimeExports$1.jsx(e,{ref:f,className:p,htmlFor:h,..._})});FormLabel.displayName="FormLabel";const FormRange=reactExports.forwardRef(({bsPrefix:e,className:r,id:t,...a},c)=>{const{controlId:h}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-range"),jsxRuntimeExports$1.jsx("input",{...a,type:"range",ref:c,className:classNames(r,e),id:t||h})});FormRange.displayName="FormRange";const FormSelect=reactExports.forwardRef(({bsPrefix:e,size:r,htmlSize:t,className:a,isValid:c=!1,isInvalid:h=!1,id:_,...f},g)=>{const{controlId:b}=reactExports.useContext(FormContext);return e=useBootstrapPrefix(e,"form-select"),jsxRuntimeExports$1.jsx("select",{...f,size:t,ref:g,className:classNames(a,e,r&&`${e}-${r}`,c&&"is-valid",h&&"is-invalid"),id:_||b})});FormSelect.displayName="FormSelect";const FormText=reactExports.forwardRef(({bsPrefix:e,className:r,as:t="small",muted:a,...c},h)=>(e=useBootstrapPrefix(e,"form-text"),jsxRuntimeExports$1.jsx(t,{...c,ref:h,className:classNames(r,e,a&&"text-muted")})));FormText.displayName="FormText";const Switch=reactExports.forwardRef((e,r)=>jsxRuntimeExports$1.jsx(FormCheck$1,{...e,ref:r,type:"switch"}));Switch.displayName="Switch";const Switch$1=Object.assign(Switch,{Input:FormCheck$1.Input,Label:FormCheck$1.Label}),FloatingLabel=reactExports.forwardRef(({bsPrefix:e,className:r,children:t,controlId:a,label:c,...h},_)=>(e=useBootstrapPrefix(e,"form-floating"),jsxRuntimeExports$1.jsxs(FormGroup,{ref:_,className:classNames(r,e),controlId:a,...h,children:[t,jsxRuntimeExports$1.jsx("label",{htmlFor:a,children:c})]})));FloatingLabel.displayName="FloatingLabel";const propTypes={_ref:PropTypes.any,validated:PropTypes.bool,as:PropTypes.elementType},Form=reactExports.forwardRef(({className:e,validated:r,as:t="form",...a},c)=>jsxRuntimeExports$1.jsx(t,{...a,ref:c,className:classNames(e,r&&"was-validated")}));Form.displayName="Form";Form.propTypes=propTypes;const Form$1=Object.assign(Form,{Group:FormGroup,Control:FormControl$1,Floating:FormFloating,Check:FormCheck$1,Switch:Switch$1,Label:FormLabel,Text:FormText,Range:FormRange,Select:FormSelect,FloatingLabel});var Zs=Object.defineProperty,Ys=(e,r,t)=>r in e?Zs(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,Ci$1=(e,r,t)=>(Ys(e,typeof r!="symbol"?r+"":r,t),t),commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},jsxRuntime={exports:{}},reactJsxRuntime_production_min={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var e=React,r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h={key:!0,ref:!0,__self:!0,__source:!0};function _(f,g,b){var p,E={},M=null,R=null;b!==void 0&&(M=""+b),g.key!==void 0&&(M=""+g.key),g.ref!==void 0&&(R=g.ref);for(p in g)a.call(g,p)&&!h.hasOwnProperty(p)&&(E[p]=g[p]);if(f&&f.defaultProps)for(p in g=f.defaultProps,g)E[p]===void 0&&(E[p]=g[p]);return{$$typeof:r,type:f,key:M,ref:R,props:E,_owner:c.current}}return reactJsxRuntime_production_min.Fragment=t,reactJsxRuntime_production_min.jsx=_,reactJsxRuntime_production_min.jsxs=_,reactJsxRuntime_production_min}jsxRuntime.exports=requireReactJsxRuntime_production_min();var jsxRuntimeExports=jsxRuntime.exports;class ControlBox extends React.Component{constructor(){super(...arguments),Ci$1(this,"handleSupercellChange",(r,t)=>{let a=this.props.viewerParams.supercell;a[r]=parseInt(t),this.props.onViewerParamChange("supercell",a)}),Ci$1(this,"handleOptionChange",r=>{this.props.onViewerParamChange(r,!this.props.viewerParams[r])}),Ci$1(this,"handleCameraEvent",r=>{this.props.onViewerEvent("camera",r)})}render(){return jsxRuntimeExports.jsxs("div",{className:"control-box",children:[jsxRuntimeExports.jsxs("div",{className:"control-box-row",children:[jsxRuntimeExports.jsxs("div",{className:"supercell-container",children:[jsxRuntimeExports.jsx(Form$1.Label,{children:"Supercell: "}),jsxRuntimeExports.jsx("div",{style:{display:"flex"},children:[0,1,2].map(r=>jsxRuntimeExports.jsx(Form$1.Control,{className:"supercell-input",type:"number",min:"1",max:"99",value:this.props.viewerParams.supercell[r],onChange:t=>this.handleSupercellChange(r,t.target.value)},r))})]}),jsxRuntimeExports.jsxs("div",{className:"camera-controls",children:[jsxRuntimeExports.jsx(Form$1.Label,{children:"Camera: "}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("x"),children:"x"}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("y"),children:"y"}),jsxRuntimeExports.jsx(Button,{className:"camera-button",onClick:()=>this.handleCameraEvent("z"),children:"z"})]})]}),jsxRuntimeExports.jsxs("div",{className:"control-box-row",style:{display:"flex"},children:[jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.bonds,onChange:()=>this.handleOptionChange("bonds"),label:"Bonds"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.packedCell,onChange:()=>this.handleOptionChange("packedCell"),label:"Packed cell"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.atomLabels,onChange:()=>this.handleOptionChange("atomLabels"),label:"Atom labels"}),jsxRuntimeExports.jsx(Form$1.Check,{className:"option-checkbox",type:"checkbox",checked:this.props.viewerParams.spaceFilling,onChange:()=>this.handleOptionChange("vdwRadius"),label:"vdW radius"})]})]})}}var _3Dmol={exports:{}};/*!
 * 3dmol v2.3.0
 * JavaScript/TypeScript molecular visualization library
 * Author: David Koes and contributors
 */(function(module,exports){(function(e,r){module.exports=r()})(commonjsGlobal,()=>(()=>{var __webpack_modules__={"./node_modules/iobuffer/lib-esm/IOBuffer.js":((e,r,t)=>{t.r(r),t.d(r,{IOBuffer:()=>f});var a=t("./node_modules/iobuffer/lib-esm/text.browser.js");const c=1024*8,h=(()=>{const g=new Uint8Array(4),b=new Uint32Array(g.buffer);return!((b[0]=1)&g[0])})(),_={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class f{constructor(b=c,p={}){let E=!1;typeof b=="number"?b=new ArrayBuffer(b):(E=!0,this.lastWrittenByte=b.byteLength);const M=p.offset?p.offset>>>0:0,R=b.byteLength-M;let z=M;(ArrayBuffer.isView(b)||b instanceof f)&&(b.byteLength!==b.buffer.byteLength&&(z=b.byteOffset+M),b=b.buffer),E?this.lastWrittenByte=R:this.lastWrittenByte=0,this.buffer=b,this.length=R,this.byteLength=R,this.byteOffset=z,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,z,R),this._mark=0,this._marks=[]}available(b=1){return this.offset+b<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(b=1){return this.offset+=b,this}back(b=1){return this.offset-=b,this}seek(b){return this.offset=b,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const b=this._marks.pop();if(b===void 0)throw new Error("Mark stack empty");return this.seek(b),this}rewind(){return this.offset=0,this}ensureAvailable(b=1){if(!this.available(b)){const p=(this.offset+b)*2,E=new Uint8Array(p);E.set(new Uint8Array(this.buffer)),this.buffer=E.buffer,this.length=this.byteLength=p,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(b=1){return this.readArray(b,"uint8")}readArray(b,p){const E=_[p].BYTES_PER_ELEMENT*b,M=this.byteOffset+this.offset,R=this.buffer.slice(M,M+E);if(this.littleEndian===h&&p!=="uint8"&&p!=="int8"){const l=new Uint8Array(this.buffer.slice(M,M+E));l.reverse();const s=new _[p](l.buffer);return this.offset+=E,s.reverse(),s}const z=new _[p](R);return this.offset+=E,z}readInt16(){const b=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,b}readUint16(){const b=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,b}readInt32(){const b=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,b}readUint32(){const b=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,b}readFloat32(){const b=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,b}readFloat64(){const b=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,b}readBigInt64(){const b=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,b}readBigUint64(){const b=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,b}readChar(){return String.fromCharCode(this.readInt8())}readChars(b=1){let p="";for(let E=0;E<b;E++)p+=this.readChar();return p}readUtf8(b=1){return(0,a.decode)(this.readBytes(b))}decodeText(b=1,p="utf-8"){return(0,a.decode)(this.readBytes(b),p)}writeBoolean(b){return this.writeUint8(b?255:0),this}writeInt8(b){return this.ensureAvailable(1),this._data.setInt8(this.offset++,b),this._updateLastWrittenByte(),this}writeUint8(b){return this.ensureAvailable(1),this._data.setUint8(this.offset++,b),this._updateLastWrittenByte(),this}writeByte(b){return this.writeUint8(b)}writeBytes(b){this.ensureAvailable(b.length);for(let p=0;p<b.length;p++)this._data.setUint8(this.offset++,b[p]);return this._updateLastWrittenByte(),this}writeInt16(b){return this.ensureAvailable(2),this._data.setInt16(this.offset,b,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(b){return this.ensureAvailable(2),this._data.setUint16(this.offset,b,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(b){return this.ensureAvailable(4),this._data.setInt32(this.offset,b,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(b){return this.ensureAvailable(4),this._data.setUint32(this.offset,b,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(b){return this.ensureAvailable(4),this._data.setFloat32(this.offset,b,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(b){return this.ensureAvailable(8),this._data.setFloat64(this.offset,b,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(b){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,b,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(b){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,b,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(b){return this.writeUint8(b.charCodeAt(0))}writeChars(b){for(let p=0;p<b.length;p++)this.writeUint8(b.charCodeAt(p));return this}writeUtf8(b){return this.writeBytes((0,a.encode)(b))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}}),"./node_modules/iobuffer/lib-esm/text-encoding-polyfill.js":(function(){(function(e){if(e.TextEncoder&&e.TextDecoder)return!1;function r(a="utf-8"){if(a!=="utf-8")throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${a}') is invalid.`)}Object.defineProperty(r.prototype,"encoding",{value:"utf-8"}),r.prototype.encode=function(a,c={stream:!1}){if(c.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let h=0;const _=a.length;let f=0,g=Math.max(32,_+(_>>1)+7),b=new Uint8Array(g>>3<<3);for(;h<_;){let p=a.charCodeAt(h++);if(p>=55296&&p<=56319){if(h<_){const E=a.charCodeAt(h);(E&64512)===56320&&(++h,p=((p&1023)<<10)+(E&1023)+65536)}if(p>=55296&&p<=56319)continue}if(f+4>b.length){g+=8,g*=1+h/a.length*2,g=g>>3<<3;const E=new Uint8Array(g);E.set(b),b=E}if(p&4294967168)if(!(p&4294965248))b[f++]=p>>6&31|192;else if(!(p&4294901760))b[f++]=p>>12&15|224,b[f++]=p>>6&63|128;else if(!(p&4292870144))b[f++]=p>>18&7|240,b[f++]=p>>12&63|128,b[f++]=p>>6&63|128;else continue;else{b[f++]=p;continue}b[f++]=p&63|128}return b.slice(0,f)};function t(a="utf-8",c={fatal:!1}){if(a!=="utf-8")throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${a}') is invalid.`);if(c.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(t.prototype,"fatal",{value:!1}),Object.defineProperty(t.prototype,"ignoreBOM",{value:!1}),t.prototype.decode=function(a,c={stream:!1}){if(c.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const h=new Uint8Array(a);let _=0;const f=h.length,g=[];for(;_<f;){const b=h[_++];if(b===0)break;if(!(b&128))g.push(b);else if((b&224)===192){const p=h[_++]&63;g.push((b&31)<<6|p)}else if((b&240)===224){const p=h[_++]&63,E=h[_++]&63;g.push((b&31)<<12|p<<6|E)}else if((b&248)===240){const p=h[_++]&63,E=h[_++]&63,M=h[_++]&63;let R=(b&7)<<18|p<<12|E<<6|M;R>65535&&(R-=65536,g.push(R>>>10&1023|55296),R=56320|R&1023),g.push(R)}}return String.fromCharCode.apply(null,g)},e.TextEncoder=r,e.TextDecoder=t})(typeof window<"u"?window:typeof self<"u"?self:this)}),"./node_modules/iobuffer/lib-esm/text.browser.js":((e,r,t)=>{t.r(r),t.d(r,{decode:()=>a,encode:()=>h}),t("./node_modules/iobuffer/lib-esm/text-encoding-polyfill.js");function a(_,f="utf8"){return new TextDecoder(f).decode(_)}const c=new TextEncoder;function h(_){return c.encode(_)}}),"./node_modules/netcdfjs/lib-esm/data.js":((e,r,t)=>{t.r(r),t.d(r,{nonRecord:()=>c,record:()=>h});var a=t("./node_modules/netcdfjs/lib-esm/types.js");function c(_,f){const g=(0,a.str2num)(f.type),b=f.size/(0,a.num2bytes)(g),p=new Array(b);for(let E=0;E<b;E++)p[E]=(0,a.readType)(_,g,1);return p}function h(_,f,g){const b=(0,a.str2num)(f.type),p=f.size?f.size/(0,a.num2bytes)(b):1,E=g.length,M=new Array(E),R=g.recordStep;if(R)for(let z=0;z<E;z++){const l=_.offset;M[z]=(0,a.readType)(_,b,p),_.seek(l+R)}else throw new Error("recordDimension.recordStep is undefined");return M}}),"./node_modules/netcdfjs/lib-esm/header.js":((e,r,t)=>{t.r(r),t.d(r,{header:()=>p});var a=t("./node_modules/netcdfjs/lib-esm/types.js"),c=t("./node_modules/netcdfjs/lib-esm/utils.js");const h=0,_=10,f=11,g=12,b=0;function p(z,l){const s={version:l},v={length:z.readUint32()},w=E(z);Array.isArray(w)||(v.id=w.recordId,v.name=w.recordName,s.dimensions=w.dimensions),s.globalAttributes=M(z);const S=R(z,v?.id,l);return Array.isArray(S)||(s.variables=S.variables,v.recordStep=S.recordStep),s.recordDimension=v,s}function E(z){const l={};let s,v;const w=z.readUint32();let S;if(w===h)return(0,c.notNetcdf)(z.readUint32()!==h,"wrong empty tag for list of dimensions"),[];{(0,c.notNetcdf)(w!==_,"wrong tag for list of dimensions");const A=z.readUint32();S=new Array(A);for(let u=0;u<A;u++){const y=(0,c.readName)(z),C=z.readUint32();C===b&&(s=u,v=y),S[u]={name:y,size:C}}}return s!==void 0&&(l.recordId=s),v!==void 0&&(l.recordName=v),l.dimensions=S,l}function M(z){const l=z.readUint32();let s;if(l===h)return(0,c.notNetcdf)(z.readUint32()!==h,"wrong empty tag for list of attributes"),[];{(0,c.notNetcdf)(l!==g,"wrong tag for list of attributes");const v=z.readUint32();s=new Array(v);for(let w=0;w<v;w++){const S=(0,c.readName)(z),A=z.readUint32();(0,c.notNetcdf)(A<1||A>6,`non valid type ${A}`);const u=z.readUint32(),y=(0,a.readType)(z,A,u);(0,c.padding)(z),s[w]={name:S,type:(0,a.num2str)(A),value:y}}}return s}function R(z,l,s){const v=z.readUint32();let w=0,S;if(v===h)return(0,c.notNetcdf)(z.readUint32()!==h,"wrong empty tag for list of variables"),[];{(0,c.notNetcdf)(v!==f,"wrong tag for list of variables");const A=z.readUint32();S=new Array(A);for(let u=0;u<A;u++){const y=(0,c.readName)(z),C=z.readUint32(),k=new Array(C);for(let B=0;B<C;B++)k[B]=z.readUint32();const I=M(z),O=z.readUint32();(0,c.notNetcdf)(O<1&&O>6,`non valid type ${O}`);const D=z.readUint32();let X=z.readUint32();s===2&&((0,c.notNetcdf)(X>0,"offsets larger than 4GB not supported"),X=z.readUint32());let j=!1;typeof l<"u"&&k[0]===l&&(w+=D,j=!0),S[u]={name:y,dimensions:k,attributes:I,type:(0,a.num2str)(O),size:D,offset:X,record:j}}}return{variables:S,recordStep:w}}}),"./node_modules/netcdfjs/lib-esm/index.js":((e,r,t)=>{t.r(r),t.d(r,{NetCDFReader:()=>a.NetCDFReader});var a=t("./node_modules/netcdfjs/lib-esm/parser.js")}),"./node_modules/netcdfjs/lib-esm/parser.js":((e,r,t)=>{t.r(r),t.d(r,{NetCDFReader:()=>g});var a=t("./node_modules/iobuffer/lib-esm/IOBuffer.js"),c=t("./node_modules/netcdfjs/lib-esm/data.js"),h=t("./node_modules/netcdfjs/lib-esm/header.js"),_=t("./node_modules/netcdfjs/lib-esm/toString.js"),f=t("./node_modules/netcdfjs/lib-esm/utils.js");class g{constructor(p){this.toString=_.toString;const E=new a.IOBuffer(p);E.setBigEndian(),(0,f.notNetcdf)(E.readChars(3)!=="CDF","should start with CDF");const M=E.readByte();(0,f.notNetcdf)(M>2,"unknown version"),this.header=(0,h.header)(E,M),this.buffer=E}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(p){const E=this.globalAttributes.find(M=>M.name===p);return E?E.value:null}getDataVariableAsString(p){const E=this.getDataVariable(p);return E?E.join(""):null}get variables(){return this.header.variables}getDataVariable(p){let E;if(typeof p=="string"?E=this.header.variables.find(M=>M.name===p):E=p,E===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(E.offset),E.record?(0,c.record)(this.buffer,E,this.header.recordDimension):(0,c.nonRecord)(this.buffer,E)}dataVariableExists(p){return this.header.variables.find(E=>E.name===p)!==void 0}attributeExists(p){return this.globalAttributes.find(E=>E.name===p)!==void 0}}}),"./node_modules/netcdfjs/lib-esm/toString.js":((e,r,t)=>{t.r(r),t.d(r,{toString:()=>a});function a(){const c=[];c.push("DIMENSIONS");for(const _ of this.dimensions)c.push(`  ${_.name.padEnd(30)} = size: ${_.size}`);c.push(""),c.push("GLOBAL ATTRIBUTES");for(const _ of this.globalAttributes)c.push(`  ${_.name.padEnd(30)} = ${_.value}`);const h=JSON.parse(JSON.stringify(this.variables));c.push(""),c.push("VARIABLES:");for(const _ of h){_.value=this.getDataVariable(_);let f=JSON.stringify(_.value);f.length>50&&(f=f.substring(0,50)),isNaN(_.value.length)||(f+=` (length: ${_.value.length})`),c.push(`  ${_.name.padEnd(30)} = ${f}`)}return c.join(`
`)}}),"./node_modules/netcdfjs/lib-esm/types.js":((e,r,t)=>{t.r(r),t.d(r,{num2bytes:()=>h,num2str:()=>c,readType:()=>g,str2num:()=>_});const a={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function c(p){switch(Number(p)){case a.BYTE:return"byte";case a.CHAR:return"char";case a.SHORT:return"short";case a.INT:return"int";case a.FLOAT:return"float";case a.DOUBLE:return"double";default:return"undefined"}}function h(p){switch(Number(p)){case a.BYTE:return 1;case a.CHAR:return 1;case a.SHORT:return 2;case a.INT:return 4;case a.FLOAT:return 4;case a.DOUBLE:return 8;default:return-1}}function _(p){switch(String(p)){case"byte":return a.BYTE;case"char":return a.CHAR;case"short":return a.SHORT;case"int":return a.INT;case"float":return a.FLOAT;case"double":return a.DOUBLE;default:return-1}}function f(p,E){if(p!==1){const M=new Array(p);for(let R=0;R<p;R++)M[R]=E();return M}else return E()}function g(p,E,M){switch(E){case a.BYTE:return Array.from(p.readBytes(M));case a.CHAR:return b(p.readChars(M));case a.SHORT:return f(M,p.readInt16.bind(p));case a.INT:return f(M,p.readInt32.bind(p));case a.FLOAT:return f(M,p.readFloat32.bind(p));case a.DOUBLE:return f(M,p.readFloat64.bind(p));default:throw new Error(`non valid type ${E}`)}}function b(p){return p.charCodeAt(p.length-1)===0?p.substring(0,p.length-1):p}}),"./node_modules/netcdfjs/lib-esm/utils.js":((e,r,t)=>{t.r(r),t.d(r,{notNetcdf:()=>a,padding:()=>c,readName:()=>h});function a(_,f){if(_)throw new TypeError(`Not a valid NetCDF v3.x file: ${f}`)}function c(_){_.offset%4!==0&&_.skip(4-_.offset%4)}function h(_){const f=_.readUint32(),g=_.readChars(f);return c(_),g}}),"./src/WebGL/shaders/lib/basic/basic.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;
    float fogFactor = smoothstep( fogNear, fogFar, depth );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
}`}),"./src/WebGL/shaders/lib/basic/basic.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`}),"./src/WebGL/shaders/lib/blur/blur.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`}),"./src/WebGL/shaders/lib/blur/blur.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/instanced/instanced.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`}),"./src/WebGL/shaders/lib/instanced/instanced.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`}),"./src/WebGL/shaders/lib/lambert/lambert.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}`}),"./src/WebGL/shaders/lib/lambert/lambert.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`}),"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`}),"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`}),"./src/WebGL/shaders/lib/outline/outline.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );
}


`}),"./src/WebGL/shaders/lib/outline/outline.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    gl_Position = projectionMatrix * mvPosition;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`}),"./src/WebGL/shaders/lib/screen/screen.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `}),"./src/WebGL/shaders/lib/screen/screen.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/screenaa/screenaa.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec3 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP).xyz;
    vec3 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP).xyz;
    vec3 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP).xyz;
    vec3 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP).xyz;
    vec3 rgbM  = texture2D(tex, fragCoord  * inverseVP).xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)).xyz +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5).xyz +
        texture2D(tex, fragCoord  + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, 1.0);
    else
        color = vec4(rgbB, 1.0);
    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        `}),"./src/WebGL/shaders/lib/screenaa/screenaa.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    float fogFactor = smoothstep( fogNear, fogFar, gl_FragDepthEXT/gl_FragCoord.w );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );


}

`}),"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`}),"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );
}


`}),"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);
    vec4 adjust = projectionMatrix* vec4(norm,normal.z,0.0); adjust.z = 0.0; adjust.w = 0.0;
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+adjust;
}

`}),"./src/WebGL/shaders/lib/sprite/sprite.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform int fogType;
uniform vec3 fogColor;
uniform float fogDensity;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogType > 0) {

        float depth = gl_FragCoord.z / gl_FragCoord.w;
        float fogFactor = 0.0;

        if (fogType == 1) {
            fogFactor = smoothstep(fogNear, fogFar, depth);
        }

        else {
            const float LOG2 = 1.442695;
            float fogFactor = exp2(- fogDensity * fogDensity * depth * depth * LOG2);
            fogFactor = 1.0 - clamp(fogFactor, 0.0, 1.0);
        }

        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);

    }
}

`}),"./src/WebGL/shaders/lib/sprite/sprite.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`}),"./src/WebGL/shaders/lib/ssao/ssao.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`}),"./src/WebGL/shaders/lib/ssao/ssao.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `}),"./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    float fogFactor = smoothstep( fogNear, fogFar, depth );
    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
}`}),"./src/WebGL/shaders/lib/stickimposter/stickimposter.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(projectionMatrix[3][3] == 0.0) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(projectionMatrix[3][3] == 0.0) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }
    vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
    mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`}),"./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`}),"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    to.xyz += normalize(to.xyz)*outlinePushback;
    pt.xyz += normalize(pt.xyz)*outlinePushback;

    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }
    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`}),"./src/WebGL/shaders/lib/volumetric/volumetric.frag":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `}),"./src/WebGL/shaders/lib/volumetric/volumetric.vert":((e,r,t)=>{t.r(r),t.d(r,{default:()=>a});const a=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`}),"./src/GLDraw.ts":((e,r,t)=>{t.r(r),t.d(r,{CAP:()=>c,GLDraw:()=>h});var a=t("./src/WebGL/math/index.ts"),c;(function(_){_[_.NONE=0]="NONE",_[_.FLAT=1]="FLAT",_[_.ROUND=2]="ROUND"})(c||(c={}));var h;(function(_){function f(l,s,v){var w=Math.hypot(l,s),S,A,u,y,C;w<1e-4?(A=0,u=1):(A=-l/w,u=s/w),s=-A*l+u*s,S=Math.hypot(s,v),S<1e-4?(y=0,C=1):(y=v/S,C=s/S);var k=new Float32Array(9);return k[0]=u,k[1]=A,k[2]=0,k[3]=-A*C,k[4]=u*C,k[5]=y,k[6]=A*y,k[7]=-u*y,k[8]=C,k}class g{constructor(){this.cache={};let s=[],v=4,w=Math.pow(2,v),S=2,A=Math.pow(2,S),u=w/A,y;for(s[0]=new a.Vector3(-1,0,0),s[u]=new a.Vector3(0,0,1),s[u*2]=new a.Vector3(1,0,0),s[u*3]=new a.Vector3(0,0,-1),S=3;S<=v;S++){for(A=Math.pow(2,S-1),u=w/A,y=0;y<A-1;y++)s[u/2+y*u]=s[y*u].clone().add(s[(y+1)*u]).normalize();y=A-1,s[u/2+y*u]=s[y*u].clone().add(s[0]).normalize()}this.basisVectors=s}getVerticesForRadius(s,v,w){if(typeof this.cache<"u"&&this.cache[s]!==void 0&&this.cache[s][v+w]!==void 0)return this.cache[s][v+w];for(var S=this.basisVectors.length,A=[],u=[],y,C=0;C<S;C++)A.push(this.basisVectors[C].clone().multiplyScalar(s)),A.push(this.basisVectors[C].clone().multiplyScalar(s)),y=this.basisVectors[C].clone().normalize(),u.push(y),u.push(y);var k=[],I=10,O=S,D=0,X=Math.PI*2,j=0,B=Math.PI,$,H,q=!1,W=!1;for(H=0;H<=I;H++){q=H===0||H===I,W=H===I/2;var Y=[],G=[];for($=0;$<=O;$++){if(W){var V=$<O?2*$:0;G.push(V+1),Y.push(V);continue}var Q=$/O,xe=H/I;if(!q||$===0)if($<O){var ce=new a.Vector3;ce.x=-s*Math.cos(D+Q*X)*Math.sin(j+xe*B),v==1?ce.y=0:ce.y=s*Math.cos(j+xe*B),ce.z=s*Math.sin(D+Q*X)*Math.sin(j+xe*B),Math.abs(ce.x)<1e-5&&(ce.x=0),Math.abs(ce.y)<1e-5&&(ce.y=0),Math.abs(ce.z)<1e-5&&(ce.z=0),v==c.FLAT?(y=new a.Vector3(0,Math.cos(j+xe*B),0),y.normalize()):(y=new a.Vector3(ce.x,ce.y,ce.z),y.normalize()),A.push(ce),u.push(y),Y.push(A.length-1)}else Y.push(A.length-O);else q&&Y.push(A.length-1)}W&&k.push(G),k.push(Y)}var Ne={vertices:A,normals:u,verticesRows:k,w:O,h:I};return s in this.cache||(this.cache[s]={}),this.cache[s][v+w]=Ne,Ne}}var b=new g;function p(l,s,v,w,S,A=0,u=0){if(!s||!v)return;let y=function(vt){if(typeof vt=="string"){let Qr=vt;return Qr.toLowerCase()=="flat"?c.FLAT:Qr.toLowerCase()=="round"?c.ROUND:c.NONE}else return vt};A=y(A),u=y(u);var C=u||A;S=S||{r:0,g:0,b:0};var k=f(v.x-s.x,v.y-s.y,v.z-s.z),I=b.getVerticesForRadius(w,u,"to"),O=I.w,D=I.h,X=C?D*O+2:2*O,j=l.updateGeoGroup(X),B=I.vertices,$=I.normals,H=I.verticesRows,q=H[D/2],W=H[D/2+1],Y=j.vertices,G,V,Q,xe,ce,Ne,Pe=j.vertexArray,Fe=j.normalArray,Me=j.colorArray,je=j.faceArray;for(Q=0;Q<O;++Q){var ft=2*Q;xe=k[0]*B[ft].x+k[3]*B[ft].y+k[6]*B[ft].z,ce=k[1]*B[ft].x+k[4]*B[ft].y+k[7]*B[ft].z,Ne=k[5]*B[ft].y+k[8]*B[ft].z,G=3*(Y+ft),V=j.faceidx,Pe[G]=xe+s.x,Pe[G+1]=ce+s.y,Pe[G+2]=Ne+s.z,Pe[G+3]=xe+v.x,Pe[G+4]=ce+v.y,Pe[G+5]=Ne+v.z,Fe[G]=xe,Fe[G+3]=xe,Fe[G+1]=ce,Fe[G+4]=ce,Fe[G+2]=Ne,Fe[G+5]=Ne,Me[G]=S.r,Me[G+3]=S.r,Me[G+1]=S.g,Me[G+4]=S.g,Me[G+2]=S.b,Me[G+5]=S.b,je[V]=W[Q]+Y,je[V+1]=W[Q+1]+Y,je[V+2]=q[Q]+Y,je[V+3]=q[Q]+Y,je[V+4]=W[Q+1]+Y,je[V+5]=q[Q+1]+Y,j.faceidx+=6}if(C){var jt=u?0:D/2,Gt=A?D+1:D/2+1,mt,Le,ht,ar,Jt,Wt,Gr,Lr,zr,Nr,At,Mt,Jr,qr,ie,ve,we,it,rt,Yt,Ot,re,tt,lt,cr,et,Ft,se,_t,Wr,Z,ut;for(ce=jt;ce<Gt;ce++)if(ce!==D/2){var at=ce<=D/2?v:s,me=b.getVerticesForRadius(w,u,"to"),Ze=b.getVerticesForRadius(w,A,"from");for(at===v?(B=me.vertices,$=me.normals,H=me.verticesRows):at==s&&(B=Ze.vertices,$=Ze.normals,H=Ze.verticesRows),xe=0;xe<O;xe++)V=j.faceidx,mt=H[ce][xe+1],_t=(mt+Y)*3,Le=H[ce][xe],Wr=(Le+Y)*3,ht=H[ce+1][xe],Z=(ht+Y)*3,ar=H[ce+1][xe+1],ut=(ar+Y)*3,Jt=k[0]*B[mt].x+k[3]*B[mt].y+k[6]*B[mt].z,Wt=k[0]*B[Le].x+k[3]*B[Le].y+k[6]*B[Le].z,Gr=k[0]*B[ht].x+k[3]*B[ht].y+k[6]*B[ht].z,Lr=k[0]*B[ar].x+k[3]*B[ar].y+k[6]*B[ar].z,zr=k[1]*B[mt].x+k[4]*B[mt].y+k[7]*B[mt].z,Nr=k[1]*B[Le].x+k[4]*B[Le].y+k[7]*B[Le].z,At=k[1]*B[ht].x+k[4]*B[ht].y+k[7]*B[ht].z,Mt=k[1]*B[ar].x+k[4]*B[ar].y+k[7]*B[ar].z,Jr=k[5]*B[mt].y+k[8]*B[mt].z,qr=k[5]*B[Le].y+k[8]*B[Le].z,ie=k[5]*B[ht].y+k[8]*B[ht].z,ve=k[5]*B[ar].y+k[8]*B[ar].z,Pe[_t]=Jt+at.x,Pe[Wr]=Wt+at.x,Pe[Z]=Gr+at.x,Pe[ut]=Lr+at.x,Pe[_t+1]=zr+at.y,Pe[Wr+1]=Nr+at.y,Pe[Z+1]=At+at.y,Pe[ut+1]=Mt+at.y,Pe[_t+2]=Jr+at.z,Pe[Wr+2]=qr+at.z,Pe[Z+2]=ie+at.z,Pe[ut+2]=ve+at.z,Me[_t]=S.r,Me[Wr]=S.r,Me[Z]=S.r,Me[ut]=S.r,Me[_t+1]=S.g,Me[Wr+1]=S.g,Me[Z+1]=S.g,Me[ut+1]=S.g,Me[_t+2]=S.b,Me[Wr+2]=S.b,Me[Z+2]=S.b,Me[ut+2]=S.b,we=k[0]*$[mt].x+k[3]*$[mt].y+k[6]*$[mt].z,it=k[0]*$[Le].x+k[3]*$[Le].y+k[6]*$[Le].z,rt=k[0]*$[ht].x+k[3]*$[ht].y+k[6]*$[ht].z,Yt=k[0]*$[ar].x+k[3]*$[ar].y+k[6]*$[ar].z,Ot=k[1]*$[mt].x+k[4]*$[mt].y+k[7]*$[mt].z,re=k[1]*$[Le].x+k[4]*$[Le].y+k[7]*$[Le].z,tt=k[1]*$[ht].x+k[4]*$[ht].y+k[7]*$[ht].z,lt=k[1]*$[ar].x+k[4]*$[ar].y+k[7]*$[ar].z,cr=k[5]*$[mt].y+k[8]*$[mt].z,et=k[5]*$[Le].y+k[8]*$[Le].z,Ft=k[5]*$[ht].y+k[8]*$[ht].z,se=k[5]*$[ar].y+k[8]*$[ar].z,ce===0?(Fe[_t]=we,Fe[Z]=rt,Fe[ut]=Yt,Fe[_t+1]=Ot,Fe[Z+1]=tt,Fe[ut+1]=lt,Fe[_t+2]=cr,Fe[Z+2]=Ft,Fe[ut+2]=se,je[V]=mt+Y,je[V+1]=ht+Y,je[V+2]=ar+Y,j.faceidx+=3):ce===Gt-1?(Fe[_t]=we,Fe[Wr]=it,Fe[Z]=rt,Fe[_t+1]=Ot,Fe[Wr+1]=re,Fe[Z+1]=tt,Fe[_t+2]=cr,Fe[Wr+2]=et,Fe[Z+2]=Ft,je[V]=mt+Y,je[V+1]=Le+Y,je[V+2]=ht+Y,j.faceidx+=3):(Fe[_t]=we,Fe[Wr]=it,Fe[ut]=Yt,Fe[_t+1]=Ot,Fe[Wr+1]=re,Fe[ut+1]=lt,Fe[_t+2]=cr,Fe[Wr+2]=et,Fe[ut+2]=se,Fe[Wr]=it,Fe[Z]=rt,Fe[ut]=Yt,Fe[Wr+1]=re,Fe[Z+1]=tt,Fe[ut+1]=lt,Fe[Wr+2]=et,Fe[Z+2]=Ft,Fe[ut+2]=se,je[V]=mt+Y,je[V+1]=Le+Y,je[V+2]=ar+Y,je[V+3]=Le+Y,je[V+4]=ht+Y,je[V+5]=ar+Y,j.faceidx+=6)}}j.vertices+=X}_.drawCylinder=p;function E(l,s,v,w,S){if(!s||!v)return;S=S||{r:0,g:0,b:0};let A=new a.Vector3(v.x-s.x,v.y-s.y,v.z-s.z);var u=f(A.x,A.y,A.z);A=A.normalize();var y=b.basisVectors.length,C=b.basisVectors,k=y+2,I=l.updateGeoGroup(k),O=I.vertices,D,X,j,B,$,H,q=I.vertexArray,W=I.normalArray,Y=I.colorArray,G=I.faceArray;for(D=O*3,q[D]=s.x,q[D+1]=s.y,q[D+2]=s.z,W[D]=-A.x,W[D+1]=-A.y,W[D+2]=-A.z,Y[D]=S.r,Y[D+1]=S.g,Y[D+2]=S.b,q[D+3]=v.x,q[D+4]=v.y,q[D+5]=v.z,W[D+3]=A.x,W[D+4]=A.y,W[D+5]=A.z,Y[D+3]=S.r,Y[D+4]=S.g,Y[D+5]=S.b,D+=6,j=0;j<y;++j){var V=C[j].clone();V.multiplyScalar(w),B=u[0]*V.x+u[3]*V.y+u[6]*V.z,$=u[1]*V.x+u[4]*V.y+u[7]*V.z,H=u[5]*V.y+u[8]*V.z,q[D]=B+s.x,q[D+1]=$+s.y,q[D+2]=H+s.z,W[D]=B,W[D+1]=$,W[D+2]=H,Y[D]=S.r,Y[D+1]=S.g,Y[D+2]=S.b,D+=3}for(I.vertices+=y+2,X=I.faceidx,j=0;j<y;j++){var Q=O+2+j,xe=O+2+(j+1)%y;G[X]=Q,G[X+1]=xe,G[X+2]=O,X+=3,G[X]=Q,G[X+1]=xe,G[X+2]=O+1,X+=3}I.faceidx+=6*y}_.drawCone=E;class M{constructor(){this.cache=new Map}getVerticesForRadius(s,v){v=v||2,this.cache.has(v)||this.cache.set(v,new Map);let w=this.cache.get(v);if(w.has(s))return w.get(s);var S={vertices:[],verticesRows:[],normals:[]},A=16*v,u=10*v;s<1&&(A=10*v,u=8*v);var y=0,C=Math.PI*2,k=0,I=Math.PI,O,D;for(D=0;D<=u;D++){let j=[];for(O=0;O<=A;O++){let B=O/A,$=D/u,H=-s*Math.cos(y+B*C)*Math.sin(k+$*I),q=s*Math.cos(k+$*I),W=s*Math.sin(y+B*C)*Math.sin(k+$*I);var X=new a.Vector3(H,q,W);X.normalize(),S.vertices.push({x:H,y:q,z:W}),S.normals.push(X),j.push(S.vertices.length-1)}S.verticesRows.push(j)}return w.set(s,S),S}}var R=new M;function z(l,s,v,w,S){var A=R.getVerticesForRadius(v,S),u=A.vertices,y=A.normals,C=l.updateGeoGroup(u.length),k=C.vertices,I=C.vertexArray,O=C.colorArray,D=C.faceArray,X=C.lineArray,j=C.normalArray;for(let H=0,q=u.length;H<q;++H){let W=3*(k+H),Y=u[H];I[W]=Y.x+s.x,I[W+1]=Y.y+s.y,I[W+2]=Y.z+s.z,O[W]=w.r,O[W+1]=w.g,O[W+2]=w.b}C.vertices+=u.length;let B=A.verticesRows,$=B.length-1;for(let H=0;H<$;H++){let q=B[H].length-1;for(let W=0;W<q;W++){let Y=C.faceidx,G=C.lineidx,V=B[H][W+1]+k,Q=V*3,xe=B[H][W]+k,ce=xe*3,Ne=B[H+1][W]+k,Pe=Ne*3,Fe=B[H+1][W+1]+k,Me=Fe*3,je=y[V-k],ft=y[xe-k],jt=y[Ne-k],Gt=y[Fe-k];Math.abs(u[V-k].y)===v?(j[Q]=je.x,j[Pe]=jt.x,j[Me]=Gt.x,j[Q+1]=je.y,j[Pe+1]=jt.y,j[Me+1]=Gt.y,j[Q+2]=je.z,j[Pe+2]=jt.z,j[Me+2]=Gt.z,D[Y]=V,D[Y+1]=Ne,D[Y+2]=Fe,X[G]=V,X[G+1]=Ne,X[G+2]=V,X[G+3]=Fe,X[G+4]=Ne,X[G+5]=Fe,C.faceidx+=3,C.lineidx+=6):Math.abs(u[Ne-k].y)===v?(j[Q]=je.x,j[ce]=ft.x,j[Pe]=jt.x,j[Q+1]=je.y,j[ce+1]=ft.y,j[Pe+1]=jt.y,j[Q+2]=je.z,j[ce+2]=ft.z,j[Pe+2]=jt.z,D[Y]=V,D[Y+1]=xe,D[Y+2]=Ne,X[G]=V,X[G+1]=xe,X[G+2]=V,X[G+3]=Ne,X[G+4]=xe,X[G+5]=Ne,C.faceidx+=3,C.lineidx+=6):(j[Q]=je.x,j[ce]=ft.x,j[Me]=Gt.x,j[Q+1]=je.y,j[ce+1]=ft.y,j[Me+1]=Gt.y,j[Q+2]=je.z,j[ce+2]=ft.z,j[Me+2]=Gt.z,j[ce]=ft.x,j[Pe]=jt.x,j[Me]=Gt.x,j[ce+1]=ft.y,j[Pe+1]=jt.y,j[Me+1]=Gt.y,j[ce+2]=ft.z,j[Pe+2]=jt.z,j[Me+2]=Gt.z,D[Y]=V,D[Y+1]=xe,D[Y+2]=Fe,D[Y+3]=xe,D[Y+4]=Ne,D[Y+5]=Fe,X[G]=V,X[G+1]=xe,X[G+2]=V,X[G+3]=Fe,X[G+4]=xe,X[G+5]=Ne,X[G+6]=Ne,X[G+7]=Fe,C.faceidx+=6,C.lineidx+=8)}}}_.drawSphere=z})(h||(h={}))}),"./src/GLModel.ts":((e,r,t)=>{t.r(r),t.d(r,{GLModel:()=>z});var a=t("./src/WebGL/index.ts"),c=t("./src/WebGL/shapes/index.ts"),h=t("./src/WebGL/math/index.ts"),_=t("./src/colors.ts"),f=t("./src/GLDraw.ts"),g=t("./src/glcartoon.ts"),b=t("./src/utilities.ts"),p=t("./src/Gradient.ts"),E=t("./src/parsers/index.ts"),M=t("./node_modules/netcdfjs/lib-esm/index.js"),R=t("./src/parsers/utils/assignBonds.ts");class z{static sameObj(s,v){return s&&v?JSON.stringify(s)==JSON.stringify(v):s==v}constructor(s,v){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new h.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=_.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=v||{},this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:_.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=s}getRadiusFromStyle(s,v){var w=this.defaultSphereRadius;if(typeof v.radius<"u")w=v.radius;else if(z.vdwRadii[s.elem])w=z.vdwRadii[s.elem];else if(s.elem.length>1){let S=s.elem;S=S[0].toUpperCase()+S[1].toLowerCase(),z.vdwRadii[S]&&(w=z.vdwRadii[S])}return typeof v.scale<"u"&&(w*=v.scale),w}drawAtomCross(s,v){if(s.style.cross){var w=s.style.cross;if(!w.hidden){var S=w.linewidth||z.defaultlineWidth;v[S]||(v[S]=new a.Geometry);var A=v[S].updateGeoGroup(6),u=this.getRadiusFromStyle(s,w),y=[[u,0,0],[-u,0,0],[0,u,0],[0,-u,0],[0,0,u],[0,0,-u]],C=s.clickable||s.hoverable;C&&s.intersectionShape===void 0&&(s.intersectionShape={sphere:[],cylinder:[],line:[]});for(var k=(0,b.getColorFromStyle)(s,w),I=A.vertexArray,O=A.colorArray,D=0;D<6;D++){var X=A.vertices*3;if(A.vertices++,I[X]=s.x+y[D][0],I[X+1]=s.y+y[D][1],I[X+2]=s.z+y[D][2],O[X]=k.r,O[X+1]=k.g,O[X+2]=k.b,C){var j=new h.Vector3(y[D][0],y[D][1],y[D][2]);j.multiplyScalar(.1),j.set(j.x+s.x,j.y+s.y,j.z+s.z),s.intersectionShape.line.push(j)}}}}}getGoodCross(s,v,w,S){for(var A=null,u=-1,y=0,C=s.bonds.length;y<C;y++)if(s.bonds[y]!=v.index){let I=s.bonds[y],O=this.atoms[I],D=new h.Vector3(O.x,O.y,O.z).clone();D.sub(w);let X=D.clone();X.cross(S);var k=X.lengthSq();if(k>u&&(u=k,A=X,u>.1))return A}return A}getSideBondV(s,v,w){var S,A,u,y,C,k=new h.Vector3(s.x,s.y,s.z),I=new h.Vector3(v.x,v.y,v.z),O=I.clone(),D=null;if(O.sub(k),s.bonds.length===1)v.bonds.length===1?(D=O.clone(),Math.abs(D.x)>1e-4?D.y+=1:D.x+=1):(S=(w+1)%v.bonds.length,A=v.bonds[S],u=this.atoms[A],u.index==s.index&&(S=(S+1)%v.bonds.length,A=v.bonds[S],u=this.atoms[A]),y=new h.Vector3(u.x,u.y,u.z),C=y.clone(),C.sub(k),D=C.clone(),D.cross(O));else if(D=this.getGoodCross(s,v,k,O),D.lengthSq()<.01){var X=this.getGoodCross(v,s,k,O);X!=null&&(D=X)}return D.lengthSq()<.01&&(D=O.clone(),Math.abs(D.x)>1e-4?D.y+=1:D.x+=1),D.cross(O),D.normalize(),D}addLine(s,v,w,S,A,u){s[w]=S.x,s[w+1]=S.y,s[w+2]=S.z,v[w]=u.r,v[w+1]=u.g,v[w+2]=u.b,s[w+3]=A.x,s[w+4]=A.y,s[w+5]=A.z,v[w+3]=u.r,v[w+4]=u.g,v[w+5]=u.b}drawBondLines(s,v,w){if(s.style.line){var S=s.style.line;if(!S.hidden){var A,u,y,C,k=S.linewidth||z.defaultlineWidth;w[k]||(w[k]=new a.Geometry);for(var I=w[k].updateGeoGroup(6*s.bonds.length),O=I.vertexArray,D=I.colorArray,X=0;X<s.bonds.length;X++){var j=s.bonds[X],B=v[j];if(B.style.line&&!(s.index>=B.index)){var $=new h.Vector3(s.x,s.y,s.z),H=new h.Vector3(B.x,B.y,B.z),q=$.clone().add(H).multiplyScalar(.5),W=!1,Y=s.clickable||s.hoverable,G=B.clickable||B.hoverable;(Y||G)&&(Y&&(s.intersectionShape===void 0&&(s.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),s.intersectionShape.line.push($),s.intersectionShape.line.push(q)),G&&(B.intersectionShape===void 0&&(B.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),B.intersectionShape.line.push(q),B.intersectionShape.line.push(H)));var V=(0,b.getColorFromStyle)(s,s.style.line),Q=(0,b.getColorFromStyle)(B,B.style.line);if(s.bondStyles&&s.bondStyles[X]){var xe=s.bondStyles[X];if(!xe.iswire)continue;xe.singleBond&&(W=!0),typeof xe.color1<"u"&&(V=_.CC.color(xe.color1)),typeof xe.color2<"u"&&(Q=_.CC.color(xe.color2))}var ce=I.vertices*3,Ne,Pe;if(s.bondOrder[X]>1&&s.bondOrder[X]<4&&!W){var Fe=this.getSideBondV(s,B,X),Me=H.clone();Me.sub($),s.bondOrder[X]==2?(Fe.multiplyScalar(.1),A=$.clone(),A.add(Fe),u=$.clone(),u.sub(Fe),y=A.clone(),y.add(Me),C=u.clone(),C.add(Me),V==Q?(I.vertices+=4,this.addLine(O,D,ce,A,y,V),this.addLine(O,D,ce+6,u,C,V)):(I.vertices+=8,Me.multiplyScalar(.5),Ne=A.clone(),Ne.add(Me),Pe=u.clone(),Pe.add(Me),this.addLine(O,D,ce,A,Ne,V),this.addLine(O,D,ce+6,Ne,y,Q),this.addLine(O,D,ce+12,u,Pe,V),this.addLine(O,D,ce+18,Pe,C,Q))):s.bondOrder[X]==3&&(Fe.multiplyScalar(.1),A=$.clone(),A.add(Fe),u=$.clone(),u.sub(Fe),y=A.clone(),y.add(Me),C=u.clone(),C.add(Me),V==Q?(I.vertices+=6,this.addLine(O,D,ce,$,H,V),this.addLine(O,D,ce+6,A,y,V),this.addLine(O,D,ce+12,u,C,V)):(I.vertices+=12,Me.multiplyScalar(.5),Ne=A.clone(),Ne.add(Me),Pe=u.clone(),Pe.add(Me),this.addLine(O,D,ce,$,q,V),this.addLine(O,D,ce+6,q,H,Q),this.addLine(O,D,ce+12,A,Ne,V),this.addLine(O,D,ce+18,Ne,y,Q),this.addLine(O,D,ce+24,u,Pe,V),this.addLine(O,D,ce+30,Pe,C,Q)))}else V==Q?(I.vertices+=2,this.addLine(O,D,ce,$,H,V)):(I.vertices+=4,this.addLine(O,D,ce,$,q,V),this.addLine(O,D,ce+6,q,H,Q))}}}}}drawAtomSphere(s,v){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var S=(0,b.getColorFromStyle)(s,w),A=this.getRadiusFromStyle(s,w);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var u=new h.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(u,A))}f.GLDraw.drawSphere(v,s,A,S)}}}drawAtomClickSphere(s){if(s.style.clicksphere){var v=s.style.clicksphere;if(!v.hidden){var w=this.getRadiusFromStyle(s,v);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var S=new h.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(S,w))}}}}drawAtomInstanced(s,v){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var S=this.getRadiusFromStyle(s,w),A=(0,b.getColorFromStyle)(s,w),u=v.updateGeoGroup(1),y=u.vertices,C=y*3,k=u.vertexArray,I=u.colorArray,O=u.radiusArray;if(k[C]=s.x,k[C+1]=s.y,k[C+2]=s.z,I[C]=A.r,I[C+1]=A.g,I[C+2]=A.b,O[y]=S,(s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var D=new h.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(D,S))}u.vertices+=1}}}drawSphereImposter(s,v,w,S){var A=s.updateGeoGroup(4),u,y=A.vertices,C=y*3,k=A.vertexArray,I=A.colorArray;for(u=0;u<4;u++)k[C+3*u]=v.x,k[C+3*u+1]=v.y,k[C+3*u+2]=v.z;var O=A.normalArray;for(u=0;u<4;u++)I[C+3*u]=S.r,I[C+3*u+1]=S.g,I[C+3*u+2]=S.b;O[C+0]=-w,O[C+1]=w,O[C+2]=0,O[C+3]=-w,O[C+4]=-w,O[C+5]=0,O[C+6]=w,O[C+7]=-w,O[C+8]=0,O[C+9]=w,O[C+10]=w,O[C+11]=0,A.vertices+=4;var D=A.faceArray,X=A.faceidx;D[X+0]=y,D[X+1]=y+1,D[X+2]=y+2,D[X+3]=y+2,D[X+4]=y+3,D[X+5]=y,A.faceidx+=6}drawAtomImposter(s,v){if(s.style.sphere){var w=s.style.sphere;if(!w.hidden){var S=this.getRadiusFromStyle(s,w),A=(0,b.getColorFromStyle)(s,w);if((s.clickable===!0||s.hoverable)&&s.intersectionShape!==void 0){var u=new h.Vector3(s.x,s.y,s.z);s.intersectionShape.sphere.push(new c.Sphere(u,S))}this.drawSphereImposter(v,s,S,A)}}}calculateDashes(s,v,w,S,A){var u=Math.sqrt(Math.pow(s.x-v.x,2)+Math.pow(s.y-v.y,2)+Math.pow(s.z-v.z,2));w=Math.max(w,0),A=Math.max(A,0)+2*w,S=Math.max(S,.001),S+A>u&&(S=u,A=0);var y=Math.floor((u-S)/(S+A))+1,C=y*S;A=(u-C)/y;for(var k,I=new h.Vector3(s.x,s.y,s.z),O=new h.Vector3((v.x-s.x)/(u/A),(v.y-s.y)/(u/A),(v.z-s.z)/(u/A)),D=new h.Vector3((v.x-s.x)/(u/S),(v.y-s.y)/(u/S),(v.z-s.z)/(u/S)),X=[],j=0;j<y;j++)k=new h.Vector3(I.x+D.x,I.y+D.y,I.z+D.z),X.push({from:I,to:k}),I=new h.Vector3(k.x+O.x,k.y+O.y,k.z+O.z);return X}static drawStickImposter(s,v,w,S,A,u=0,y=0){for(var C=s.updateGeoGroup(4),k=C.vertices,I=k*3,O=C.vertexArray,D=C.colorArray,X=C.radiusArray,j=C.normalArray,B=A.r,$=A.g,H=A.b,q=function(Q){var xe=-Q;return xe==0&&(xe=-1e-4),xe},W=I,Y=0;Y<4;Y++)O[W]=v.x,j[W]=w.x,D[W]=B,W++,O[W]=v.y,j[W]=w.y,D[W]=$,W++,O[W]=v.z,j[W]=w.z,Y<2?D[W]=H:D[W]=q(H),W++;C.vertices+=4,X[k]=-S,X[k+1]=S,X[k+2]=-S,X[k+3]=S;var G=C.faceArray,V=C.faceidx;G[V+0]=k,G[V+1]=k+1,G[V+2]=k+2,G[V+3]=k+2,G[V+4]=k+3,G[V+5]=k,C.faceidx+=6}drawBondSticks(s,v,w){var S,A;if(s.style.stick){var u=s.style.stick;if(!u.hidden){var y=u.radius||this.defaultStickRadius,C=u.doubleBondScaling||.4,k=u.tripleBondScaling||.25,I=((S=u.dashedBondConfig)===null||S===void 0?void 0:S.dashLength)||.1,O=((A=u.dashedBondConfig)===null||A===void 0?void 0:A.gapLength)||.25,D=y,X=u.singleBonds||!1,j=u.dashedBonds||!1,B=0,$=0,H,q,W,Y,G,V,Q,xe,ce,Ne,Pe,Fe=(0,b.getColorFromStyle)(s,u),Me,je,ft;!s.capDrawn&&s.bonds.length<4&&(B=2);var jt=tt=>{var lt=w.imposter?z.drawStickImposter:f.GLDraw.drawCylinder;return!j&&tt>=1?lt:(cr,et,Ft,se,_t,Wr=0,Z=0,ut=.1,at=.25)=>{var me=this.calculateDashes(et,Ft,se,ut,at);me.forEach(Ze=>{lt(cr,Ze.from,Ze.to,se,_t,Wr,Z)})}};for(W=0;W<s.bonds.length;W++){var Gt=jt(s.bondOrder[W]),mt=s.bonds[W],Le=v[mt];if(Me=je=ft=null,s.index<Le.index){var ht=Le.style;if(!ht.stick||ht.stick.hidden)continue;var ar=(0,b.getColorFromStyle)(Le,ht.stick);if(D=y,Y=X,s.bondStyles&&s.bondStyles[W]){if(G=s.bondStyles[W],G.iswire)continue;G.radius&&(D=G.radius),G.singleBond&&(Y=!0),typeof G.color1<"u"&&(Fe=_.CC.color(G.color1)),typeof G.color2<"u"&&(ar=_.CC.color(G.color2))}var Jt=new h.Vector3(s.x,s.y,s.z),Wt=new h.Vector3(Le.x,Le.y,Le.z);if(s.bondOrder[W]<=1||Y||s.bondOrder[W]>3){if(s.bondOrder[W]<1&&(D*=s.bondOrder[W]),!Le.capDrawn&&Le.bonds.length<4&&($=2),Fe!=ar?(Me=new h.Vector3().addVectors(Jt,Wt).multiplyScalar(.5),Gt(w,Jt,Me,D,Fe,B,0,I,O),Gt(w,Me,Wt,D,ar,0,$,I,O)):Gt(w,Jt,Wt,D,Fe,B,$,I,O),H=s.clickable||s.hoverable,q=Le.clickable||Le.hoverable,H||q){if(Me||(Me=new h.Vector3().addVectors(Jt,Wt).multiplyScalar(.5)),H){var Gr=new c.Cylinder(Jt,Me,D),Lr=new c.Sphere(Jt,D);s.intersectionShape.cylinder.push(Gr),s.intersectionShape.sphere.push(Lr)}if(q){var zr=new c.Cylinder(Wt,Me,D),Nr=new c.Sphere(Wt,D);Le.intersectionShape.cylinder.push(zr),Le.intersectionShape.sphere.push(Nr)}}}else if(s.bondOrder[W]>1){var At=0,Mt=0;D!=y&&(At=2,Mt=2);var Jr=Wt.clone(),qr=null;Jr.sub(Jt);var ie,ve,we,it,rt;qr=this.getSideBondV(s,Le,W),s.bondOrder[W]==2?(ie=D*C,qr.multiplyScalar(ie*1.5),ve=Jt.clone(),ve.add(qr),we=Jt.clone(),we.sub(qr),it=ve.clone(),it.add(Jr),rt=we.clone(),rt.add(Jr),Fe!=ar?(Me=new h.Vector3().addVectors(ve,it).multiplyScalar(.5),je=new h.Vector3().addVectors(we,rt).multiplyScalar(.5),Gt(w,ve,Me,ie,Fe,At,0),Gt(w,Me,it,ie,ar,0,Mt),Gt(w,we,je,ie,Fe,At,0),Gt(w,je,rt,ie,ar,0,Mt)):(Gt(w,ve,it,ie,Fe,At,Mt),Gt(w,we,rt,ie,Fe,At,Mt)),H=s.clickable||s.hoverable,q=Le.clickable||Le.hoverable,(H||q)&&(Me||(Me=new h.Vector3().addVectors(ve,it).multiplyScalar(.5)),je||(je=new h.Vector3().addVectors(we,rt).multiplyScalar(.5)),H&&(V=new c.Cylinder(ve,Me,ie),Q=new c.Cylinder(we,je,ie),s.intersectionShape.cylinder.push(V),s.intersectionShape.cylinder.push(Q)),q&&(ce=new c.Cylinder(it,Me,ie),Ne=new c.Cylinder(rt,je,ie),Le.intersectionShape.cylinder.push(ce),Le.intersectionShape.cylinder.push(Ne)))):s.bondOrder[W]==3&&(ie=D*k,qr.cross(Jr),qr.normalize(),qr.multiplyScalar(ie*3),ve=Jt.clone(),ve.add(qr),we=Jt.clone(),we.sub(qr),it=ve.clone(),it.add(Jr),rt=we.clone(),rt.add(Jr),Fe!=ar?(Me=new h.Vector3().addVectors(ve,it).multiplyScalar(.5),je=new h.Vector3().addVectors(we,rt).multiplyScalar(.5),ft=new h.Vector3().addVectors(Jt,Wt).multiplyScalar(.5),Gt(w,ve,Me,ie,Fe,At,0),Gt(w,Me,it,ie,ar,0,Mt),Gt(w,Jt,ft,ie,Fe,B,0),Gt(w,ft,Wt,ie,ar,0,$),Gt(w,we,je,ie,Fe,At,0),Gt(w,je,rt,ie,ar,0,Mt)):(Gt(w,ve,it,ie,Fe,At,Mt),Gt(w,Jt,Wt,ie,Fe,B,$),Gt(w,we,rt,ie,Fe,At,Mt)),H=s.clickable||s.hoverable,q=Le.clickable||Le.hoverable,(H||q)&&(Me||(Me=new h.Vector3().addVectors(ve,it).multiplyScalar(.5)),je||(je=new h.Vector3().addVectors(we,rt).multiplyScalar(.5)),ft||(ft=new h.Vector3().addVectors(Jt,Wt).multiplyScalar(.5)),H&&(V=new c.Cylinder(ve.clone(),Me.clone(),ie),Q=new c.Cylinder(we.clone(),je.clone(),ie),xe=new c.Cylinder(Jt.clone(),ft.clone(),ie),s.intersectionShape.cylinder.push(V),s.intersectionShape.cylinder.push(Q),s.intersectionShape.cylinder.push(xe)),q&&(ce=new c.Cylinder(it.clone(),Me.clone(),ie),Ne=new c.Cylinder(rt.clone(),je.clone(),ie),Pe=new c.Cylinder(Wt.clone(),ft.clone(),ie),Le.intersectionShape.cylinder.push(ce),Le.intersectionShape.cylinder.push(Ne),Le.intersectionShape.cylinder.push(Pe))))}}}var Yt=!1,Ot=0,re=!1;for(W=0;W<s.bonds.length;W++)Y=X,s.bondStyles&&s.bondStyles[W]&&(G=s.bondStyles[W],G.singleBond&&(Y=!0),G.radius&&G.radius!=y&&(re=!0)),(Y||s.bondOrder[W]==1)&&Ot++;re?Ot>0&&(Yt=!0):Ot==0&&(s.bonds.length>0||u.showNonBonded)&&(Yt=!0),Yt&&(D=y,w.imposter?this.drawSphereImposter(w.sphereGeometry,s,D,Fe):f.GLDraw.drawSphere(w,s,D,Fe))}}}createMolObj(s,v){v=v||{};var w=new a.Object3D,S=[],A={},u={},y=this.drawAtomSphere,C=null,k=null;v.supportsImposters?(y=this.drawAtomImposter,C=new a.Geometry(!0),C.imposter=!0,k=new a.Geometry(!0,!0),k.imposter=!0,k.sphereGeometry=new a.Geometry(!0),k.sphereGeometry.imposter=!0,k.drawnCaps={}):v.supportsAIA?(y=this.drawAtomInstanced,C=new a.Geometry(!1,!0,!0),C.instanced=!0,k=new a.Geometry(!0)):(C=new a.Geometry(!0),k=new a.Geometry(!0));var I,O,D,X,j={},B=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(I=0,D=s.length;I<D;I++){var $=s[I];if($&&$.style){($.clickable||$.hoverable)&&$.intersectionShape===void 0&&($.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),X={line:void 0,cross:void 0,stick:void 0,sphere:void 0};for(O in X)$.style[O]?$.style[O].opacity?X[O]=parseFloat($.style[O].opacity):X[O]=1:X[O]=void 0,j[O]?X[O]!=null&&j[O]!=X[O]&&(console.log("Warning: "+O+" opacity is ambiguous"),j[O]=1):j[O]=X[O];y.call(this,$,C),this.drawAtomClickSphere($),this.drawAtomCross($,u),this.drawBondLines($,s,A),this.drawBondSticks($,s,k),typeof $.style.cartoon<"u"&&!$.style.cartoon.hidden&&($.style.cartoon.color==="spectrum"&&typeof $.resi=="number"&&!$.hetflag&&($.resi<B[0]&&(B[0]=$.resi),$.resi>B[1]&&(B[1]=$.resi)),S.push($))}}if(S.length>0&&(0,g.drawCartoon)(w,S,B,this.defaultCartoonQuality),C&&C.vertices>0){C.initTypedArrays();var H=null,q=null;C.imposter?H=new a.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):C.instanced?(q=new a.Geometry(!0),f.GLDraw.drawSphere(q,{x:0,y:0,z:0},1,new _.Color(.5,.5,.5)),q.initTypedArrays(),H=new a.InstancedMaterial({sphereMaterial:new a.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:q})):H=new a.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),j.sphere<1&&j.sphere>=0&&(H.transparent=!0,H.opacity=j.sphere),q=new a.Mesh(C,H),w.add(q)}if(k.vertices>0){var W=null,Y=null,G=k.sphereGeometry;(!G||typeof G.vertices>"u"||G.vertices==0)&&(G=null),k.initTypedArrays(),G&&G.initTypedArrays();var V={ambient:0,vertexColors:!0,reflectivity:0};k.imposter?(W=new a.StickImposterMaterial(V),Y=new a.SphereImposterMaterial(V)):(W=new a.MeshLambertMaterial(V),Y=new a.MeshLambertMaterial(V),W.wireframe&&(k.setUpWireframe(),G&&G.setUpWireframe())),j.stick<1&&j.stick>=0&&(W.transparent=!0,W.opacity=j.stick,Y.transparent=!0,Y.opacity=j.stick);var Q=new a.Mesh(k,W);if(w.add(Q),G){var xe=new a.Mesh(G,Y);w.add(xe)}}var ce;for(I in A)if(A.hasOwnProperty(I)){ce=I;var Ne=new a.LineBasicMaterial({linewidth:ce,vertexColors:!0});j.line<1&&j.line>=0&&(Ne.transparent=!0,Ne.opacity=j.line),A[I].initTypedArrays();var Pe=new a.Line(A[I],Ne,a.LineStyle.LinePieces);w.add(Pe)}for(I in u)if(u.hasOwnProperty(I)){ce=I;var Fe=new a.LineBasicMaterial({linewidth:ce,vertexColors:!0});j.cross<1&&j.cross>=0&&(Fe.transparent=!0,Fe.opacity=j.cross),u[I].initTypedArrays();var Me=new a.Line(u[I],Fe,a.LineStyle.LinePieces);w.add(Me)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var je=new a.Object3D,ft;for(ft=0;ft<this.modelData.symmetries.length;ft++){var jt=new a.Object3D;jt=w.clone(),jt.matrix.copy(this.modelData.symmetries[ft]),jt.matrixAutoUpdate=!1,je.add(jt)}return je}return w}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(s){this.atoms=s.atoms,this.frames=s.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const s=this.modelData.cryst;this.modelData.cryst.matrix=(0,h.conversionMatrix3)(s.a,s.b,s.c,s.alpha,s.beta,s.gamma)}return this.modelData.cryst}else return null}setCrystData(s,v,w,S,A,u){s=s||1,v=v||1,w=w||1,S=S||90,A=A||90,u=u||90;const y=(0,h.conversionMatrix3)(s,v,w,S,A,u);this.modelData.cryst={a:s,b:v,c:w,alpha:S,beta:A,gamma:u,matrix:y}}setCrystMatrix(s){s=s||new h.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:s}}getSymmetries(){return typeof this.modelData.symmetries>"u"&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(s){typeof s>"u"?this.modelData.symmetries=[this.idMatrix]:this.modelData.symmetries=s}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(s,v,w,S){var A=v-s;return A<-w?v+S:A>w?v-S:v}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var s=this.box[0],v=this.box[1],w=this.box[2],S=s*.9,A=v*.9,u=w*.9,y=0;y<this.atomdfs.length;y++)for(var C=this.atomdfs[y],k=1;k<C.length;k++){var I=this.atoms[C[k][0]],O=this.atoms[C[k][1]];I.x=this.adjustCoord(O.x,I.x,S,s),I.y=this.adjustCoord(O.y,I.y,A,v),I.z=this.adjustCoord(O.z,I.z,u,w)}}setFrame(s,v){var w=this.getNumFrames();let S=this;return new Promise(function(A,u){if(w==0&&A(),(s<0||s>=w)&&(s=w-1),S.frames.url!=null){var y=S.frames.url;(0,b.getbin)(y+"/traj/frame/"+s+"/"+S.frames.path,void 0,"POST",void 0).then(function(C){for(var k=new Float32Array(C,44),I=0,O=0;O<S.atoms.length;O++)S.atoms[O].x=k[I++],S.atoms[O].y=k[I++],S.atoms[O].z=k[I++];S.box&&S.atomdfs&&S.adjustCoordinatesToBox(),A()}).catch(u)}else S.atoms=S.frames[s],A();S.molObj=null,S.modelDatas&&s<S.modelDatas.length&&(S.modelData=S.modelDatas[s],S.unitCellObjects&&v&&(v.removeUnitCell(S),v.addUnitCell(S)))})}addFrame(s){this.frames.push(s)}vibrate(s=10,v=1,w=!1,S,A){var u=0,y=s;w&&(u=-s,y=s),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),u<y&&(this.frames=[]),w&&(this.frames.origIndex=s);for(var C=u;C<y;C++){var k=[],I=this.frames.length;if(C==0&&!A){this.frames.push(this.atoms);continue}for(var O=0;O<this.atoms.length;O++){var D=(0,b.getAtomProperty)(this.atoms[O],"dx"),X=(0,b.getAtomProperty)(this.atoms[O],"dy"),j=(0,b.getAtomProperty)(this.atoms[O],"dz"),B=new h.Vector3(D,X,j),$=new h.Vector3(this.atoms[O].x,this.atoms[O].y,this.atoms[O].z),H=C*v/s;B.multiplyScalar(H),$.add(B);var q={};for(var W in this.atoms[O])q[W]=this.atoms[O][W];if(q.x=$.x,q.y=$.y,q.z=$.z,k.push(q),S&&A){var Y=(0,b.extend)({},A),G=new h.Vector3(D,X,j);if(G.multiplyScalar(v),G.add($),Y.start=$,Y.end=G,Y.frame=I,!Y.color){var V=q.style.sphere;V||(V=q.style.stick),V||(V=q.style.line),Y.color=(0,b.getColorFromStyle)(q,V)}S.addArrow(Y)}}this.frames.push(k)}}setAtomDefaults(s){for(let v=0;v<s.length;v++){let w=s[v];w&&(w.style=w.style||(0,b.deepCopy)(z.defaultAtomStyle),w.color=w.color||this.ElementColors[w.elem]||this.defaultColor,w.model=this.id,(w.clickable||w.hoverable)&&(w.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(s,v,w={}){var S=z.parseMolData(s,v,w);this.dontDuplicateAtoms=!w.duplicateAssemblyAtoms;var A=S.modelData;if(A&&(Array.isArray(A)?(this.modelData=A[0],w.frames&&(this.modelDatas=A)):this.modelData=A),S.box?this.box=S.box:this.box=null,this.frames.length==0){for(let y=0;y<S.length;y++)S[y].length!=0&&this.frames.push(S[y]);this.frames[0]&&(this.atoms=this.frames[0])}else if(w.frames)for(let y=0;y<S.length;y++)this.frames.push(S[y]);else for(var u=0;u<S.length;u++)this.addAtoms(S[u]);for(let y=0;y<this.frames.length;y++)this.setAtomDefaults(this.frames[y]);w.vibrate&&w.vibrate.frames&&w.vibrate.amplitude&&this.vibrate(w.vibrate.frames,w.vibrate.amplitude),w.style&&this.setStyle({},w.style)}setDontDuplicateAtoms(s){this.dontDuplicateAtoms=s}setModelData(s){this.modelData=s}propertyMatches(s,v){if(s==v)return!0;if(typeof v=="string"&&typeof s=="number"){var w=v.match(/(-?\d+)\s*-\s*(-?\d+)/);if(w){var S=parseInt(w[1]),A=parseInt(w[2]);if(w&&s>=S&&s<=A)return!0}}return!1}static deepCopyAndCache(s,v){if(typeof s!="object"||s==null||s.__cache_created)return s;const w={};for(const S in s){const A=s[S];if(Array.isArray(A)){w[S]=[];for(let u=0;u<A.length;u++)w[S].push(z.deepCopyAndCache(A[u],v))}else typeof A=="object"&&S!="properties"&&S!="model"?w[S]=z.deepCopyAndCache(A,v):w[S]=A;if(S=="and"||S=="or"){const u=[];for(const y of w[S]){const C=new Set;for(const k of v.selectedAtoms(y))C.add(k.index);u.push(C)}if(S=="and"){const y=function(k,I){const O=new Set;for(const D of I)k.has(D)&&O.add(D);return O};let C=new Set(u[0]);for(const k of u.splice(1))C=y(C,k);w[S].__cached_results=C}else if(S=="or"){const y=new Set;for(const C of u)for(const k of C)y.add(k);w[S].__cached_results=y}}}return w.__cache_created=!0,w}atomIsSelected(s,v){if(typeof v>"u")return!0;var w=!!v.invert,S=!0;for(var A in v)if(A=="and"||A=="or"||A=="not"){if(A=="not"){if(this.atomIsSelected(s,v[A])){S=!1;break}}else if(v[A].__cached_results===void 0&&(v=z.deepCopyAndCache(v,this)),S=v[A].__cached_results.has(s.index),!S)break}else if(A==="predicate"){if(!v.predicate(s)){S=!1;break}}else if(A=="properties"&&s[A]){for(var u in v.properties)if(!u.startsWith("__cache")){if(typeof s.properties[u]>"u"){S=!1;break}if(s.properties[u]!=v.properties[u]){S=!1;break}}}else if(v.hasOwnProperty(A)&&!z.ignoredKeys.has(A)&&!A.startsWith("__cache")){if(typeof s[A]>"u"){S=!1;break}var y=!1;if(A==="bonds"){var C=v[A];if(C!=s.bonds.length){S=!1;break}}else if(Array.isArray(v[A])){var k=v[A],I=s[A];for(let O=0;O<k.length;O++)if(this.propertyMatches(I,k[O])){y=!0;break}if(!y){S=!1;break}}else{let O=v[A];if(!this.propertyMatches(s[A],O)){S=!1;break}}}return w?!S:S}static squaredDistance(s,v){var w=v.x-s.x,S=v.y-s.y,A=v.z-s.z;return w*w+S*S+A*A}expandAtomList(s,v){if(v<=0)return s;for(var w=(0,b.getExtent)(s,void 0),S=[[],[],[]],A=0;A<3;A++)S[0][A]=w[0][A]-v,S[1][A]=w[1][A]+v,S[2][A]=w[2][A];var u=[];for(let I=0;I<this.atoms.length;I++){var y=this.atoms[I].x,C=this.atoms[I].y,k=this.atoms[I].z;y>=S[0][0]&&y<=S[1][0]&&C>=S[0][1]&&C<=S[1][1]&&k>=S[0][2]&&k<=S[1][2]&&(y>=w[0][0]&&y<=w[1][0]&&C>=w[0][1]&&C<=w[1][1]&&k>=w[0][2]&&k<=w[1][2]||u.push(this.atoms[I]))}return u}static getFloat(s){return typeof s=="number"?s:parseFloat(s)}selectedAtoms(s,v){var w=[];s=z.deepCopyAndCache(s||{},this),v||(v=this.atoms);for(var S=v.length,A=0;A<S;A++){var u=v[A];u&&this.atomIsSelected(u,s)&&w.push(u)}if(s.hasOwnProperty("expand")){const q=z.getFloat(s.expand);let W=this.expandAtomList(w,q),Y=w.length;const G=q*q;for(let V=0;V<W.length;V++)for(let Q=0;Q<Y;Q++){var y=z.squaredDistance(W[V],w[Q]);y<G&&y>0&&w.push(W[V])}}if(s.hasOwnProperty("within")&&s.within.hasOwnProperty("sel")&&s.within.hasOwnProperty("distance")){var C=this.selectedAtoms(s.within.sel,this.atoms),k={};const q=z.getFloat(s.within.distance),W=q*q;for(let Y=0;Y<C.length;Y++)for(let G=0;G<w.length;G++){let V=z.squaredDistance(C[Y],w[G]);V<W&&V>0&&(k[G]=1)}var I=[];if(s.within.invert)for(let Y=0;Y<w.length;Y++)k[Y]||I.push(w[Y]);else for(let Y in k)I.push(w[Y]);w=I}if(s.hasOwnProperty("byres")){var O={},D=[],X=[];for(let q=0;q<w.length;q++){let W=w[q];var j=W.chain,B=W.resi;if(O[j]===void 0&&(O[j]={}),W.hasOwnProperty("resi")&&O[j][B]===void 0){for(O[j][B]=!0,X.push(W);X.length>0;)if(W=X.pop(),j=W.chain,B=W.resi,D[W.index]===void 0){D[W.index]=!0;for(var $=0;$<W.bonds.length;$++){var H=this.atoms[W.bonds[$]];D[H.index]===void 0&&H.hasOwnProperty("resi")&&H.chain==j&&H.resi==B&&(X.push(H),w.push(H))}}}}}return w}addAtoms(s){this.molObj=null;var v=this.atoms.length,w=[],S;for(S=0;S<s.length;S++)typeof s[S].index>"u"&&(s[S].index=S),typeof s[S].serial>"u"&&(s[S].serial=S),w[s[S].index]=v+S;for(S=0;S<s.length;S++){var A=s[S],u=w[A.index],y=(0,b.extend)({},A);y.index=u,y.bonds=[],y.bondOrder=[],y.model=this.id,y.style=y.style||(0,b.deepCopy)(z.defaultAtomStyle),typeof y.color>"u"&&(y.color=this.ElementColors[y.elem]||this.defaultColor);for(var C=A.bonds?A.bonds.length:0,k=0;k<C;k++){var I=w[A.bonds[k]];typeof I<"u"&&(y.bonds.push(I),y.bondOrder.push(A.bondOrder?A.bondOrder[k]:1))}this.atoms.push(y)}}assignBonds(){(0,R.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(s){this.molObj=null;var v=[],w;for(w=0;w<s.length;w++)v[s[w].index]=!0;var S=[];for(w=0;w<this.atoms.length;w++){var A=this.atoms[w];v[A.index]||S.push(A)}this.atoms=[],this.addAtoms(S)}setStyle(s,v,w){typeof v>"u"&&typeof w>"u"&&(v=s,s={}),s=s,typeof v=="string"&&(v=(0,b.specStringToObject)(v));var S=!1,A=this,u=function(C){var k=A.selectedAtoms(s,C);for(let I=0;I<C.length;I++)C[I]&&(C[I].capDrawn=!1);for(let I=0;I<k.length;I++){S=!0,(k[I].clickable||k[I].hoverable)&&(k[I].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),w||(k[I].style={});for(let O in v)v.hasOwnProperty(O)&&(k[I].style[O]=k[I].style[O]||{},Object.assign(k[I].style[O],v[O]))}};if(s.frame!==void 0&&s.frame<this.frames.length){let C=s.frame;C<0&&(C=this.frames.length+C),u(this.frames[C])}else{u(this.atoms);for(var y=0;y<this.frames.length;y++)this.frames[y]!==this.atoms&&u(this.frames[y])}S&&(this.molObj=null)}setClickable(s,v,w){if(v=!!v,w=(0,b.makeFunction)(w),w===null){console.log("Callback is not a function");return}var S=this.selectedAtoms(s,this.atoms),A=S.length;for(let u=0;u<A;u++)S[u].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},S[u].clickable=v,w&&(S[u].callback=w);A>0&&(this.molObj=null)}setHoverable(s,v,w,S){if(v=!!v,w=(0,b.makeFunction)(w),S=(0,b.makeFunction)(S),w===null){console.log("Hover_callback is not a function");return}if(S===null){console.log("Unhover_callback is not a function");return}var A=this.selectedAtoms(s,this.atoms),u=A.length;for(let y=0;y<u;y++)A[y].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},A[y].hoverable=v,w&&(A[y].hover_callback=w),S&&(A[y].unhover_callback=S);u>0&&(this.molObj=null)}enableContextMenu(s,v){v=!!v;var w,S=this.selectedAtoms(s,this.atoms),A=S.length;for(w=0;w<A;w++)S[w].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},S[w].contextMenuEnabled=v;A>0&&(this.molObj=null)}setColorByElement(s,v){if(!(this.molObj!==null&&z.sameObj(v,this.lastColors))){this.lastColors=v;var w=this.selectedAtoms(s,w);w.length>0&&(this.molObj=null);for(var S=0;S<w.length;S++){var A=w[S];typeof v[A.elem]<"u"&&(A.color=v[A.elem])}}}setColorByProperty(s,v,w,S){var A,u,y=this.selectedAtoms(s,y);for(this.lastColors=null,y.length>0&&(this.molObj=null),typeof w=="string"&&typeof p.Gradient.builtinGradients[w]<"u"&&(w=new p.Gradient.builtinGradients[w]),w=w,S||(S=w.range()),S||(S=(0,b.getPropertyRange)(y,v)),A=0;A<y.length;A++){u=y[A];var C=(0,b.getAtomProperty)(u,v);C!=null&&(u.color=w.valueToHex(parseFloat(u.properties[v]),S))}}setColorByFunction(s,v){var w=this.selectedAtoms(s,w);if(typeof v=="function"){this.lastColors=null,w.length>0&&(this.molObj=null);for(let S=0;S<w.length;S++){let A=w[S];A.color=v(A)}}}toCDObject(s=!1){var v={a:[],b:[]};s&&(v.s=[]);for(let S=0;S<this.atoms.length;S++){let A={},u=this.atoms[S];if(A.x=u.x,A.y=u.y,A.z=u.z,u.elem!="C"&&(A.l=u.elem),s){for(var w=0;w<v.s.length&&JSON.stringify(u.style)!==JSON.stringify(v.s[w]);)w++;w===v.s.length&&v.s.push(u.style),w!==0&&(A.s=w)}v.a.push(A);for(let y=0;y<u.bonds.length;y++){let C=S,k=u.bonds[y];if(C>=k)continue;let I={b:C,e:k},O=u.bondOrder[y];O!=1&&(I.o=O),v.b.push(I)}}return v}globj(s,v){(this.molObj===null||v.regen)&&(this.molObj=this.createMolObj(this.atoms,v),this.renderedMolObj&&(s.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),s.add(this.renderedMolObj))}exportVRML(){var s=this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1});return s.vrml()}removegl(s){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),s.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(s,v,w,S){for(var A=this.selectedAtoms(v,A),u=(0,b.deepCopy)(S),y=0;y<A.length;y++){var C=A[y],k=null;typeof C[s]<"u"?k=String(C[s]):typeof C.properties[s]<"u"&&(k=String(C.properties[s])),k!=null&&(u.position=C,w.addLabel(k,u))}}addResLabels(s,v,w,S=!1){var A=[],u=function(C,k){for(var I=C.selectedAtoms(s,I),O={},D=0;D<I.length;D++){var X=I[D],j=X.chain,B=X.resn,$=X.resi,H=B+""+$;O[j]||(O[j]={}),O[j][H]||(O[j][H]=[]),O[j][H].push(X)}var q=(0,b.deepCopy)(w);for(let Y in O)if(O.hasOwnProperty(Y)){var W=O[Y];for(let G in W)if(W.hasOwnProperty(G)){let V=W[G],Q=new h.Vector3(0,0,0);for(let ce=0;ce<V.length;ce++){let Ne=V[ce];Q.x+=Ne.x,Q.y+=Ne.y,Q.z+=Ne.z}Q.divideScalar(V.length),q.position=Q,q.frame=k;let xe=v.addLabel(G,q,void 0,!0);A.push(xe)}}};if(S){var y=this.getNumFrames();let C=this.atoms;for(let k=0;k<y;k++)this.frames[k]&&(this.atoms=this.frames[k],u(this,k));this.atoms=C}else u(this);return A}setupDFS(){this.atomdfs=[];var s=this,v=new Int8Array(this.atoms.length);v.fill(0);for(var w=function(y,C,k){k.push([y,C]);var I=s.atoms[y];v[y]=1;for(var O=0;O<I.bonds.length;O++){var D=I.bonds[O];s.atoms[D]&&!v[D]&&w(D,y,k)}},S=0;S<this.atoms.length;S++){var A=this.atoms[S];if(A&&!v[S]){var u=[];w(S,-1,u),this.atomdfs.push(u)}}}setCoordinatesFromURL(s,v){this.frames=[];var w=this;return this.box&&this.setupDFS(),s.startsWith("http")||(s="http://"+s),(0,b.get)(s+"/traj/numframes/"+v,function(S){if(!isNaN(parseInt(S)))return w.frames.push(w.atoms),w.frames.numFrames=S,w.frames.url=s,w.frames.path=v,w.setFrame(0)})}setCoordinates(s,v){if(v=v||"",!s)return[];if(/\.gz$/.test(v)){v=v.replace(/\.gz$/,"");try{s=(0,b.inflateString)(s)}catch(O){console.log(O)}}var w={mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""};if(w.hasOwnProperty(v)){this.frames=[];for(var S=this.atoms.length,A=z.parseCrd(s,v),u=0;u<A.length;){for(var y=[],C=0;C<S;C++){var k={};for(var I in this.atoms[C])k[I]=this.atoms[C][I];y[C]=k,y[C].x=A[u++],y[C].y=A[u++],y[C].z=A[u++]}this.frames.push(y)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(s){}static parseCrd(s,v){var w=[],S=0;if(v=="pdb")for(var A=s.indexOf(`
ATOM`);A!=-1;){for(;s.slice(A,A+5)==`
ATOM`||s.slice(A,A+7)==`
HETATM`;)w[S++]=parseFloat(s.slice(A+31,A+39)),w[S++]=parseFloat(s.slice(A+39,A+47)),w[S++]=parseFloat(s.slice(A+47,A+55)),A=s.indexOf(`
`,A+54),s.slice(A,A+4)==`
TER`&&(A=s.indexOf(`
`,A+5));A=s.indexOf(`
ATOM`,A)}else if(v=="netcdf"){var u=new M.NetCDFReader(s);w=[].concat.apply([],u.getDataVariable("coordinates"))}else{if(v=="array"||Array.isArray(s))return s.flat(2);{let y=s.indexOf(`
`);v=="inpcrd"&&(y=s.indexOf(`
`,y+1)),s=s.slice(y+1),w=s.match(/\S+/g).map(parseFloat)}}return w}static parseMolData(s,v="",w){if(!s)return[];if(/\.gz$/.test(v)){v=v.replace(/\.gz$/,"");try{v.match(/bcif/i)?s=(0,b.inflateString)(s,!1):s=(0,b.inflateString)(s)}catch(u){console.log(u)}}typeof E.Parsers[v]>"u"&&(v=v.split(".").pop(),typeof E.Parsers[v]>"u"&&(console.log("Unknown format: "+v),s instanceof Uint8Array?v="bcif":s.match(/^@<TRIPOS>MOLECULE/gm)?v="mol2":s.match(/^data_/gm)&&s.match(/^loop_/gm)?v="cif":s.match(/^HETATM/gm)||s.match(/^ATOM/gm)?v="pdb":s.match(/ITEM: TIMESTEP/gm)?v="lammpstrj":s.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?v="sdf":s.match(/^%VERSION\s+VERSION_STAMP/gm)?v="prmtop":v="xyz",console.log("Best guess: "+v)));var S=E.Parsers[v],A=S(s,w);return A}}z.defaultAtomStyle={line:{}},z.defaultlineWidth=1,z.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},z.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"])}),"./src/GLShape.ts":((e,r,t)=>{t.r(r),t.d(r,{GLShape:()=>M,splitMesh:()=>R});var a=t("./src/WebGL/index.ts"),c=t("./src/WebGL/shapes/index.ts"),h=t("./src/WebGL/math/index.ts"),_=t("./src/colors.ts"),f=t("./src/ProteinSurface4.ts"),g=t("./src/VolumeData.ts"),b=t("./src/GLDraw.ts"),p=t("./src/glcartoon.ts"),E=t("./src/utilities.ts");class M{static finalizeGeo(l){var s=l.updateGeoGroup(0);s.vertices>0&&s.truncateArrayBuffers(!0,!0)}static updateColor(l,s){s=s||_.CC.color(s),l.colorsNeedUpdate=!0;var v,w,S;s.constructor!==Array&&(v=s.r,w=s.g,S=s.b);for(let A in l.geometryGroups){let u=l.geometryGroups[A],y=u.colorArray;for(let C=0,k=u.vertices;C<k;++C){if(s.constructor===Array){let I=s[C];v=I.r,w=I.g,S=I.b}y[C*3]=v,y[C*3+1]=w,y[C*3+2]=S}}}static drawArrow(l,s,v){var w=v.start,S=v.end,A=v.radius,u=v.radiusRatio,y=v.mid,C=v.midpos;if(!(w&&S))return;var k=s.updateGeoGroup(51),I=new h.Vector3(S.x,S.y,S.z).sub(w);if(C){let et=I.length();C>0?y=C/et:y=(et+C)/et}I.multiplyScalar(y);var O=new h.Vector3(w.x,w.y,w.z).add(I),D=I.clone().negate();let X=new h.Vector3(w.x,w.y,w.z);l.intersectionShape.cylinder.push(new c.Cylinder(X,O.clone(),A)),l.intersectionShape.sphere.push(new c.Sphere(X,A));var j=[];j[0]=I.clone(),Math.abs(j[0].x)>1e-4?j[0].y+=1:j[0].x+=1,j[0].cross(I),j[0].normalize(),j[4]=j[0].clone(),j[4].crossVectors(j[0],I),j[4].normalize(),j[8]=j[0].clone().negate(),j[12]=j[4].clone().negate(),j[2]=j[0].clone().add(j[4]).normalize(),j[6]=j[4].clone().add(j[8]).normalize(),j[10]=j[8].clone().add(j[12]).normalize(),j[14]=j[12].clone().add(j[0]).normalize(),j[1]=j[0].clone().add(j[2]).normalize(),j[3]=j[2].clone().add(j[4]).normalize(),j[5]=j[4].clone().add(j[6]).normalize(),j[7]=j[6].clone().add(j[8]).normalize(),j[9]=j[8].clone().add(j[10]).normalize(),j[11]=j[10].clone().add(j[12]).normalize(),j[13]=j[12].clone().add(j[14]).normalize(),j[15]=j[14].clone().add(j[0]).normalize();var B=k.vertices,$=k.vertexArray,H=k.faceArray,q=k.normalArray,W=k.lineArray,Y,G,V;for(G=0,V=j.length;G<V;++G){Y=3*(B+3*G);var Q=j[G].clone().multiplyScalar(A).add(w),xe=j[G].clone().multiplyScalar(A).add(O),ce=j[G].clone().multiplyScalar(A*u).add(O);if($[Y]=Q.x,$[Y+1]=Q.y,$[Y+2]=Q.z,$[Y+3]=xe.x,$[Y+4]=xe.y,$[Y+5]=xe.z,$[Y+6]=ce.x,$[Y+7]=ce.y,$[Y+8]=ce.z,G>0){var Ne=$[Y-3],Pe=$[Y-2],Fe=$[Y-1],Me=new h.Vector3(Ne,Pe,Fe),je=new h.Vector3(S.x,S.y,S.z),ft=O.clone(),jt=new h.Vector3(ce.x,ce.y,ce.z);l.intersectionShape.triangle.push(new c.Triangle(jt,je,Me)),l.intersectionShape.triangle.push(new c.Triangle(Me.clone(),ft,jt.clone()))}}k.vertices+=48,Y=k.vertices*3,$[Y]=w.x,$[Y+1]=w.y,$[Y+2]=w.z,$[Y+3]=O.x,$[Y+4]=O.y,$[Y+5]=O.z,$[Y+6]=S.x,$[Y+7]=S.y,$[Y+8]=S.z,k.vertices+=3;var Gt,mt,Le,ht,ar,Jt,Wt,Gr,Lr,zr,Nr,At,Mt,Jr,qr,ie,ve,we,it,rt=k.vertices-3,Yt=k.vertices-2,Ot=k.vertices-1,re=rt*3,tt=Yt*3,lt=Ot*3;for(G=0,V=j.length-1;G<V;++G){var cr=B+3*G;Y=cr*3,mt=k.faceidx,Le=k.lineidx,ht=cr,zr=ht*3,ar=cr+1,Nr=ar*3,Jt=cr+2,At=Jt*3,Wt=cr+4,Mt=Wt*3,Gr=cr+5,Jr=Gr*3,Lr=cr+3,qr=Lr*3,ie=ve=j[G],we=it=j[G+1],q[zr]=ie.x,q[Nr]=ve.x,q[qr]=it.x,q[zr+1]=ie.y,q[Nr+1]=ve.y,q[qr+1]=it.y,q[zr+2]=ie.z,q[Nr+2]=ve.z,q[qr+2]=it.z,q[Nr]=ve.x,q[Mt]=we.x,q[qr]=it.x,q[Nr+1]=ve.y,q[Mt+1]=we.y,q[qr+1]=it.y,q[Nr+2]=ve.z,q[Mt+2]=we.z,q[qr+2]=it.z,q[At]=ve.x,q[Jr]=we.x,q[At+1]=ve.y,q[Jr+1]=we.y,q[At+2]=ve.z,q[Jr+2]=we.z,H[mt]=ht,H[mt+1]=ar,H[mt+2]=Lr,H[mt+3]=ar,H[mt+4]=Wt,H[mt+5]=Lr,H[mt+6]=ht,H[mt+7]=Lr,H[mt+8]=rt,H[mt+9]=Jt,H[mt+10]=Yt,H[mt+11]=Gr,H[mt+12]=Jt,H[mt+13]=Ot,H[mt+14]=Gr,W[Le]=ht,W[Le+1]=ar,W[Le+2]=ht,W[Le+3]=Lr,W[Le+4]=Wt,W[Le+5]=Lr,W[Le+6]=ht,W[Le+7]=Lr,W[Le+8]=Jt,W[Le+9]=ar,W[Le+10]=Jt,W[Le+11]=Gr,W[Le+12]=Wt,W[Le+13]=Gr,W[Le+14]=Jt,W[Le+15]=Ot,W[Le+16]=Jt,W[Le+17]=Gr,W[Le+18]=Ot,W[Le+19]=Gr,k.faceidx+=15,k.lineidx+=20}Gt=[B+45,B+46,B+1,B,B+47,B+2],mt=k.faceidx,Le=k.lineidx,ht=Gt[0],zr=ht*3,ar=Gt[1],Nr=ar*3,Jt=Gt[4],At=Jt*3,Wt=Gt[2],Mt=Wt*3,Gr=Gt[5],Jr=Gr*3,Lr=Gt[3],qr=Lr*3,ie=ve=j[15],we=it=j[0],q[zr]=ie.x,q[Nr]=ve.x,q[qr]=it.x,q[zr+1]=ie.y,q[Nr+1]=ve.y,q[qr+1]=it.y,q[zr+2]=ie.z,q[Nr+2]=ve.z,q[qr+2]=it.z,q[Nr]=ve.x,q[Mt]=we.x,q[qr]=it.x,q[Nr+1]=ve.y,q[Mt+1]=we.y,q[qr+1]=it.y,q[Nr+2]=ve.z,q[Mt+2]=we.z,q[qr+2]=it.z,q[At]=ve.x,q[Jr]=we.x,q[At+1]=ve.y,q[Jr+1]=we.y,q[At+2]=ve.z,q[Jr+2]=we.z,I.normalize(),D.normalize(),q[re]=D.x,q[tt]=q[lt]=I.x,q[re+1]=D.y,q[tt+1]=q[lt+1]=I.y,q[re+2]=D.z,q[tt+2]=q[lt+2]=I.z,H[mt]=ht,H[mt+1]=ar,H[mt+2]=Lr,H[mt+3]=ar,H[mt+4]=Wt,H[mt+5]=Lr,H[mt+6]=ht,H[mt+7]=Lr,H[mt+8]=rt,H[mt+9]=Jt,H[mt+10]=Yt,H[mt+11]=Gr,H[mt+12]=Jt,H[mt+13]=Ot,H[mt+14]=Gr,W[Le]=ht,W[Le+1]=ar,W[Le+2]=ht,W[Le+3]=Lr,W[Le+4]=Wt,W[Le+5]=Lr,W[Le+6]=ht,W[Le+7]=Lr,W[Le+8]=Jt,W[Le+9]=ar,W[Le+10]=Jt,W[Le+11]=Gr,W[Le+12]=Wt,W[Le+13]=Gr,W[Le+14]=Jt,W[Le+15]=Ot,W[Le+16]=Jt,W[Le+17]=Gr,W[Le+18]=Ot,W[Le+19]=Gr,k.faceidx+=15,k.lineidx+=20}static updateBoundingFromPoints(l,s,v,w){l.center.set(0,0,0);let S=1/0,A=1/0,u=1/0,y=-1/0,C=-1/0,k=-1/0;l.box&&(S=l.box.min.x,y=l.box.max.x,A=l.box.min.y,C=l.box.max.y,u=l.box.min.z,k=l.box.max.z);for(let X=0,j=w;X<j;X++){var I=v[X*3],O=v[X*3+1],D=v[X*3+2];I<S&&(S=I),O<A&&(A=O),D<u&&(u=D),I>y&&(y=I),O>C&&(C=O),D>k&&(k=D)}l.center.set((y+S)/2,(C+A)/2,(k+u)/2),l.radius=l.center.distanceTo({x:y,y:C,z:k}),l.box={min:{x:S,y:A,z:u},max:{x:y,y:C,z:k}}}static addCustomGeo(l,s,v,w,S){var A=s.addGeoGroup(),u=v.vertexArr,y=v.normalArr,C=v.faceArr;A.vertices=u.length,A.faceidx=C.length;var k,I,O,D,X,j,B,$,H,q=A.vertexArray,W=A.colorArray;for(w.constructor!==Array&&($=w.r,H=w.g,D=w.b),j=0,B=A.vertices;j<B;++j)k=j*3,I=u[j],q[k]=I.x,q[k+1]=I.y,q[k+2]=I.z,w.constructor===Array&&(X=w[j],$=X.r,H=X.g,D=X.b),W[k]=$,W[k+1]=H,W[k+2]=D;if(S)for(j=0,B=A.faceidx/3;j<B;++j){k=j*3,O=C[k],D=C[k+1],X=C[k+2];var Y=new h.Vector3,G=new h.Vector3,V=new h.Vector3;l.intersectionShape.triangle.push(new c.Triangle(Y.copy(u[O]),G.copy(u[D]),V.copy(u[X])))}if(S){var Q=new h.Vector3(0,0,0),xe=0;for(let Pe=0;Pe<s.geometryGroups.length;Pe++)Q.add(s.geometryGroups[Pe].getCentroid()),xe++;Q.divideScalar(xe),M.updateBoundingFromPoints(l.boundingSphere,{centroid:Q},q,A.vertices)}if(A.faceArray=new Uint16Array(C),A.truncateArrayBuffers(!0,!0),y.length<A.vertices)A.setNormals();else{var ce=A.normalArray=new Float32Array(A.vertices*3),Ne;for(j=0,B=A.vertices;j<B;++j)k=j*3,Ne=y[j],ce[k]=Ne.x,ce[k+1]=Ne.y,ce[k+2]=Ne.z}A.setLineIndices(),A.lineidx=A.lineArray.length}static updateFromStyle(l,s){typeof s.color<"u"?(l.color=s.color||new _.Color,s.color instanceof _.Color||(l.color=_.CC.color(s.color))):l.color=_.CC.color(0),l.wireframe=!!s.wireframe,l.opacity=s.alpha?(0,h.clamp)(s.alpha,0,1):1,typeof s.opacity<"u"&&(l.opacity=(0,h.clamp)(s.opacity,0,1)),l.side=s.side!==void 0?s.side:a.DoubleSide,l.linewidth=typeof s.linewidth>"u"?1:s.linewidth,l.clickable=!!s.clickable,l.callback=(0,E.makeFunction)(s.callback),l.hoverable=!!s.hoverable,l.hover_callback=(0,E.makeFunction)(s.hover_callback),l.unhover_callback=(0,E.makeFunction)(s.unhover_callback),l.contextMenuEnabled=!!s.contextMenuEnabled,l.hidden=s.hidden,l.frame=s.frame}constructor(l){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=a.DoubleSide,this.stylespec=l||{},this.boundingSphere=new c.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},M.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new a.Geometry(!0),this.linegeo=new a.Geometry(!0)}updateStyle(l){for(var s in l)this.stylespec[s]=l[s];if(M.updateFromStyle(this,this.stylespec),l.voldata&&l.volscheme){(0,E.adjustVolumeStyle)(l);const v=l.volscheme,w=l.voldata,S=_.CC,A=v.range()||[-1,1];this.geo.setColors(function(u,y,C){let k=w.getVal(u,y,C);return S.color(v.valueToHex(k,A))}),delete this.color}}addCustom(l){l.vertexArr=l.vertexArr||[],l.faceArr=l.faceArr||[],l.normalArr=l.normalArr||[],M.drawCustom(this,this.geo,l)}addSphere(l){l.center||(l.center=new h.Vector3(0,0,0)),l.radius=l.radius?(0,h.clamp)(l.radius,0,1/0):1.5,l.color=_.CC.color(l.color),this.intersectionShape.sphere.push(new c.Sphere(l.center,l.radius)),b.GLDraw.drawSphere(this.geo,l.center,l.radius,l.color,l.quality),this.components.push({centroid:new h.Vector3(l.center.x,l.center.y,l.center.z)});var s=this.geo.updateGeoGroup(0);M.updateBoundingFromPoints(this.boundingSphere,this.components,s.vertexArray,s.vertices)}addBox(l){var s=l.dimensions||{w:1,h:1,d:1},v;typeof s.w=="number"?v={x:s.w,y:0,z:0}:v=s.w;var w;typeof s.h=="number"?w={x:0,y:s.h,z:0}:w=s.h;var S;typeof s.d=="number"?S={x:0,y:0,z:s.d}:S=s.d;var A=l.corner;A==null&&(l.center!==void 0?A={x:l.center.x-.5*(v.x+w.x+S.x),y:l.center.y-.5*(v.y+w.y+S.y),z:l.center.z-.5*(v.z+w.z+S.z)}:A={x:0,y:0,z:0});var u=[{x:A.x,y:A.y,z:A.z},{x:A.x+v.x,y:A.y+v.y,z:A.z+v.z},{x:A.x+w.x,y:A.y+w.y,z:A.z+w.z},{x:A.x+v.x+w.x,y:A.y+v.y+w.y,z:A.z+v.z+w.z},{x:A.x+S.x,y:A.y+S.y,z:A.z+S.z},{x:A.x+v.x+S.x,y:A.y+v.y+S.y,z:A.z+v.z+S.z},{x:A.x+w.x+S.x,y:A.y+w.y+S.y,z:A.z+w.z+S.z},{x:A.x+v.x+w.x+S.x,y:A.y+v.y+w.y+S.y,z:A.z+v.z+w.z+S.z}],y=[],C=[];y.splice(y.length,0,u[0],u[1],u[2],u[3]),C.splice(C.length,0,0,2,1,1,2,3);var k=4;y.splice(y.length,0,u[2],u[3],u[6],u[7]),C.splice(C.length,0,k+0,k+2,k+1,k+1,k+2,k+3),k+=4,y.splice(y.length,0,u[4],u[5],u[0],u[1]),C.splice(C.length,0,k+0,k+2,k+1,k+1,k+2,k+3),k+=4,y.splice(y.length,0,u[6],u[7],u[4],u[5]),C.splice(C.length,0,k+0,k+2,k+1,k+1,k+2,k+3),k+=4,y.splice(y.length,0,u[3],u[1],u[7],u[5]),C.splice(C.length,0,k+0,k+2,k+1,k+1,k+2,k+3),k+=4,y.splice(y.length,0,u[2],u[6],u[0],u[4]),C.splice(C.length,0,k+0,k+2,k+1,k+1,k+2,k+3),k+=4;var I=(0,E.extend)({},l);I.vertexArr=y,I.faceArr=C,I.normalArr=[],M.drawCustom(this,this.geo,I);var O=new h.Vector3;this.components.push({centroid:O.addVectors(u[0],u[7]).multiplyScalar(.5)});var D=this.geo.updateGeoGroup(0);M.updateBoundingFromPoints(this.boundingSphere,this.components,D.vertexArray,D.vertices)}addCylinder(l){var s,v;l.start?s=new h.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):s=new h.Vector3(0,0,0),l.end?(v=new h.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof v.x>"u"&&(v.x=3)):v=new h.Vector3(0,0,0);var w=l.radius||.1,S=_.CC.color(l.color);this.intersectionShape.cylinder.push(new c.Cylinder(s,v,w)),b.GLDraw.drawCylinder(this.geo,s,v,w,S,l.fromCap,l.toCap);var A=new h.Vector3;this.components.push({centroid:A.addVectors(s,v).multiplyScalar(.5)});var u=this.geo.updateGeoGroup(0);M.updateBoundingFromPoints(this.boundingSphere,this.components,u.vertexArray,u.vertices)}addDashedCylinder(l){l.dashLength=l.dashLength||.25,l.gapLength=l.gapLength||.25;var s;l.start?s=new h.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):s=new h.Vector3(0,0,0);var v;l.end?(v=new h.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof v.x>"u"&&(v.x=3)):v=new h.Vector3(3,0,0);for(var w=l.radius||.1,S=_.CC.color(l.color),A=Math.sqrt(Math.pow(s.x-v.x,2)+Math.pow(s.y-v.y,2)+Math.pow(s.z-v.z,2)),u=A/(l.gapLength+l.dashLength),y=new h.Vector3(l.start.x||0,l.start.y||0,l.start.z||0),C=new h.Vector3(l.end.x,l.end.y||0,l.end.z||0),k=new h.Vector3((v.x-s.x)/(A/l.gapLength),(v.y-s.y)/(A/l.gapLength),(v.z-s.z)/(A/l.gapLength)),I=new h.Vector3((v.x-s.x)/(A/l.dashLength),(v.y-s.y)/(A/l.dashLength),(v.z-s.z)/(A/l.dashLength)),O=0;O<u;O++)C=new h.Vector3(y.x+I.x,y.y+I.y,y.z+I.z),this.intersectionShape.cylinder.push(new c.Cylinder(y,C,w)),b.GLDraw.drawCylinder(this.geo,y,C,w,S,l.fromCap,l.toCap),y=new h.Vector3(C.x+k.x,C.y+k.y,C.z+k.z);var D=new h.Vector3;this.components.push({centroid:D.addVectors(s,v).multiplyScalar(.5)});var X=this.geo.updateGeoGroup(0);M.updateBoundingFromPoints(this.boundingSphere,this.components,X.vertexArray,X.vertices)}addCurve(l){l.points=l.points||[],l.smooth=l.smooth||10,typeof l.fromCap>"u"&&(l.fromCap=2),typeof l.toCap>"u"&&(l.toCap=2);var s=(0,p.subdivide_spline)(l.points,l.smooth);if(s.length<3){console.log("Too few points in addCurve");return}var v=l.radius||.1,w=_.CC.color(l.color),S=0,A=s.length-1,u=s[0].distanceTo(s[1]),y=Math.ceil(2*v/u);if(l.toArrow){A-=y;let O={start:s[A],end:s[s.length-1],radius:v,color:w,mid:1e-4};this.addArrow(O)}if(l.fromArrow){S+=y;let O={start:s[S],end:s[0],radius:v,color:w,mid:1e-4};this.addArrow(O)}for(var C=Math.ceil(s.length/2),k={radius:v,color:w,fromCap:2,toCap:2},I=S;I<A;I++)k.start=s[I],k.end=s[I+1],k.fromCap=2,k.toCap=2,I<C?(k.fromCap=2,k.toCap=0):I>C?(k.fromCap=0,k.toCap=2):(k.fromCap=2,k.toCap=2),this.addCylinder(k)}addLine(l){var s,v;l.start?s=new h.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):s=new h.Vector3(0,0,0),l.end?(v=new h.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof v.x>"u"&&(v.x=3)):v=new h.Vector3(3,0,0);var w=this.geo.updateGeoGroup(2),S=w.vertices,A=S*3,u=w.vertexArray;u[A]=s.x,u[A+1]=s.y,u[A+2]=s.z,u[A+3]=v.x,u[A+4]=v.y,u[A+5]=v.z,w.vertices+=2;var y=w.lineArray,C=w.lineidx;y[C]=S,y[C+1]=S+1,w.lineidx+=2;var k=new h.Vector3;this.components.push({centroid:k.addVectors(s,v).multiplyScalar(.5)}),w=this.geo.updateGeoGroup(0),M.updateBoundingFromPoints(this.boundingSphere,this.components,w.vertexArray,w.vertices)}addArrow(l){if(l.start?l.start=new h.Vector3(l.start.x||0,l.start.y||0,l.start.z||0):l.start=new h.Vector3(0,0,0),l.dir instanceof h.Vector3&&typeof l.length=="number"){var s=l.dir.clone().multiplyScalar(l.length).add(l.start);l.end=s}else l.end?(l.end=new h.Vector3(l.end.x,l.end.y||0,l.end.z||0),typeof l.end.x>"u"&&(l.end.x=3)):l.end=new h.Vector3(3,0,0);l.radius=l.radius||.1,l.radiusRatio=l.radiusRatio||1.618034,l.mid=0<l.mid&&l.mid<1?l.mid:.618034,M.drawArrow(this,this.geo,l);var v=new h.Vector3;this.components.push({centroid:v.addVectors(l.start,l.end).multiplyScalar(.5)});var w=this.geo.updateGeoGroup(0);M.updateBoundingFromPoints(this.boundingSphere,this.components,w.vertexArray,w.vertices)}static distance_from(l,s){return Math.sqrt(Math.pow(l.x-s.x,2)+Math.pow(l.y-s.y,2)+Math.pow(l.z-s.z,2))}static inSelectedRegion(l,s,v){for(var w=0;w<s.length;w++)if(M.distance_from(s[w],l)<=v)return!0;return!1}addIsosurface(l,s,v,w){var S=s.isoval!==void 0&&typeof s.isoval=="number"?s.isoval:0,A=!!s.voxel,u=s.smoothness===void 0?1:s.smoothness,y=l.size.x,C=l.size.y,k=l.size.z,I=new Int16Array(y*C*k),O=l.data,D,X;for(D=0,X=I.length;D<X;++D)I[D]=-1;var j=new Uint8Array(y*C*k);for(D=0,X=O.length;D<X;++D){var B=S>=0?O[D]-S:S-O[D];B>0&&(j[D]|=M.ISDONE)}var $=[],H=[];f.MarchingCube.march(j,$,H,{fulltable:!0,voxel:A,unitCube:l.unit,origin:l.origin,matrix:l.matrix,nX:y,nY:C,nZ:k}),!A&&u>0&&f.MarchingCube.laplacianSmooth(u,$,H);var q=[],W=[],Y=[];if(s.selectedRegion&&s.coords===void 0&&(s.coords=s.selectedRegion),s.coords===void 0&&s.selection!==void 0&&(w?s.coords=w.selectedAtoms(s.selection):console.log("addIsosurface needs viewer is selection provided.")),s.coords!==void 0){var G=s.coords[0].x,V=s.coords[0].y,Q=s.coords[0].z,xe=s.coords[0].x,ce=s.coords[0].y,Ne=s.coords[0].z;for(let Le=0;Le<s.coords.length;Le++)s.coords[Le].x>G?G=s.coords[Le].x:s.coords[Le].x<xe&&(xe=s.coords[Le].x),s.coords[Le].y>V?V=s.coords[Le].y:s.coords[Le].y<ce&&(ce=s.coords[Le].y),s.coords[Le].z>Q?Q=s.coords[Le].z:s.coords[Le].z<Ne&&(Ne=s.coords[Le].z);var Pe=2;s.radius!==void 0&&(Pe=s.radius),s.selectedOffset!==void 0&&(Pe=s.selectedOffset),s.seldist!==void 0&&(Pe=s.seldist),xe-=Pe,G+=Pe,ce-=Pe,V+=Pe,Ne-=Pe,Q+=Pe;for(let Le=0;Le<$.length;Le++)$[Le].x>xe&&$[Le].x<G&&$[Le].y>ce&&$[Le].y<V&&$[Le].z>Ne&&$[Le].z<Q&&M.inSelectedRegion($[Le],s.coords,Pe)?(q.push(W.length),W.push($[Le])):q.push(-1);for(let Le=0;Le+2<H.length;Le+=3)q[H[Le]]!==-1&&q[H[Le+1]]!==-1&&q[H[Le+2]]!==-1&&(Y.push(H[Le]-(H[Le]-q[H[Le]])),Y.push(H[Le+1]-(H[Le+1]-q[H[Le+1]])),Y.push(H[Le+2]-(H[Le+2]-q[H[Le+2]])));$=W,H=Y}M.drawCustom(this,this.geo,{vertexArr:$,faceArr:H,normalArr:[],clickable:s.clickable,hoverable:s.hoverable}),this.updateStyle(s);var Fe=new h.Vector3(l.origin.x,l.origin.y,l.origin.z),Me=new h.Vector3(l.size.x*l.unit.x,l.size.y*l.unit.y,l.size.z*l.unit.z),je=new h.Vector3(0,0,0),ft=Fe.clone(),jt=Fe.clone().add(Me);for(let Le=0;Le<$.length;Le++)je.add($[Le]),ft.max($[Le]),jt.min($[Le]);je.divideScalar($.length);var Gt=je.distanceTo(jt),mt=je.distanceTo(ft);this.boundingSphere.center=je,this.boundingSphere.radius=Math.max(Gt,mt),typeof v=="function"&&v()}addVolumetricData(l,s,v){l=new g.VolumeData(l,s),this.addIsosurface(l,v)}finalize(){return M.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj(l){if(this.renderedShapeObj&&(l.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){M.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),typeof this.color<"u"&&M.updateColor(this.geo,this.color),this.shapeObj=new a.Object3D;var s=null;this.side==a.DoubleSide?s=new a.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:a.Coloring.VertexColors}):s=new a.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:a.Coloring.VertexColors});var v=new a.Mesh(this.geo,s);if(this.shapeObj.add(v),this.linegeo&&this.linegeo.vertices>0){var w=new a.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),S=new a.Line(this.linegeo,w,a.LineStyle.LinePieces);this.shapeObj.add(S)}this.renderedShapeObj=this.shapeObj.clone(),l.add(this.renderedShapeObj)}}removegl(l){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),l.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}M.ISDONE=2,M.drawCustom=function(z,l,s){var v=s,w=v.vertexArr,S=v.faceArr;(w.length===0||S.length===0)&&console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var A=s.color;typeof A>"u"&&(A=z.color),A=_.CC.color(A);for(var u=R(v),y=0,C=u.length;y<C;y++)M.addCustomGeo(z,l,u[y],u[y].colorArr?u[y].colorArr:A,s.clickable)};function R(z){var l=64e3;if(z.vertexArr.length<l)return[z];var s=[{vertexArr:[],normalArr:[],faceArr:[]}];z.colorArr&&(s.colorArr=[]);var v=[],w=[],S=0,A=z.faceArr;for(let y=0,C=A.length;y<C;y+=3){let k=s[S];for(let I=0;I<3;I++){var u=A[y+I];v[u]!==S&&(v[u]=S,w[u]=k.vertexArr.length,k.vertexArr.push(z.vertexArr[u]),z.normalArr&&z.normalArr[u]&&k.normalArr.push(z.normalArr[u]),z.colorArr&&z.colorArr[u]&&k.colorArr.push(z.colorArr[u])),k.faceArr.push(w[u])}k.vertexArr.length>=l&&(s.push({vertexArr:[],normalArr:[],faceArr:[]}),z.colorArr&&(s.colorArr=[]),S++)}return s}}),"./src/GLViewer.ts":((e,r,t)=>{t.r(r),t.d(r,{CONTEXTS_PER_VIEWPORT:()=>l,GLViewer:()=>s,createStereoViewer:()=>S,createViewer:()=>v,createViewerGrid:()=>w});var a=t("./src/WebGL/index.ts"),c=t("./src/WebGL/math/index.ts"),h=t("./src/colors.ts"),_=t("./src/utilities.ts"),f=t("./src/Gradient.ts"),g=t("./src/GLModel.ts"),b=t("./src/Label.ts"),p=t("./src/GLShape.ts"),E=t("./src/VolumeData.ts"),M=t("./src/ProteinSurface4.ts"),R=t("./src/VolumetricRender.ts"),z=t("./node_modules/upng-js/UPNG.js");const l=16;class s{getWidth(){let u=this.container,y=u.offsetWidth;if(y==0&&u.style.display==="none"){let C=u.style.position,k=u.style.visibility;u.style.display="block",u.style.visibility="hidden",u.style.position="absolute",y=u.offsetWidth,u.style.display="none",u.style.visibility=k,u.style.position=C}return y}getHeight(){let u=this.container,y=u.offsetHeight;if(y==0&&u.style.display==="none"){let C=u.style.position,k=u.style.visibility;u.style.display="block",u.style.visibility="hidden",u.style.position="absolute",y=u.offsetHeight,u.style.display="none",u.style.visibility=k,u.style.position=C}return y}setupRenderer(){this.renderer=new a.Renderer({antialias:this.config.antialias,preserveDrawingBuffer:!0,premultipliedAlpha:!1,id:this.config.id,row:this.config.row,col:this.config.col,rows:this.config.rows,cols:this.config.cols,canvas:this.config.canvas,containerWidth:this.WIDTH,containerHeight:this.HEIGHT,ambientOcclusion:this.config.ambientOcclusion,outline:this.config.outline}),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new a.Scene,this.scene.fog=new a.Fog(this.bgColor,100,200),this.modelGroup=new a.Object3D,this.rotationGroup=new a.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new c.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var u=new a.Light(16777215);u.position=new c.Vector3(.2,.2,1).normalize(),u.intensity=1,this.scene.add(u)}_handleLostContext(u){const y=function(C){const k=C.getBoundingClientRect();return!(k.right<0||k.bottom<0||k.top>(window.innerHeight||document.documentElement.clientHeight)||k.left>(window.innerWidth||document.documentElement.clientWidth))};if(y(this.container)){let C=0;for(let k of document.getElementsByTagName("canvas"))if(y(k)&&k._3dmol_viewer!=null&&(k._3dmol_viewer.resize(),C+=1,C>=l))break}}initContainer(u){this.container=u,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var u=0;for(let C in this.surfaces)if(this.surfaces.hasOwnProperty(C)){var y=parseInt(C);isNaN(y)||y>u&&(u=y)}return u+1}setSlabAndFog(){let u=this.camera.position.z-this.rotationGroup.position.z;u<1&&(u=1),this.camera.near=u+this.slabNear,this.camera.near<1&&(this.camera.near=1),this.camera.far=u+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=u*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.far,this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(u){if(this.renderer.setViewport(),!!this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!u&&this.linkedViewers.length>0))for(var y=this._viewer.getView(),C=0;C<this.linkedViewers.length;C++){var k=this.linkedViewers[C];k.setView(y,!0)}}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let u=0,y=this.models.length;u<y;u++){let C=this.models[u];if(C){let k=C.selectedAtoms({clickable:!0}),I=C.selectedAtoms({hoverable:!0}),O=C.selectedAtoms({contextMenuEnabled:!0});for(let D=0;D<I.length;D++)this.hoverables.push(I[D]);for(let D=0;D<k.length;D++)this.clickables.push(k[D]);for(let D=0;D<O.length;D++)this.contextMenuEnabledObjects.push(O[D])}}for(let u=0,y=this.shapes.length;u<y;u++){let C=this.shapes[u];C&&C.clickable&&this.clickables.push(C),C&&C.hoverable&&this.hoverables.push(C),C&&C.contextMenuEnabled&&this.contextMenuEnabledObjects.push(C)}}handleClickSelection(u,y,C){let k=this.targetedObjects(u,y,this.clickables);if(k.length){var I=k[0].clickable;I.callback!==void 0&&(typeof I.callback!="function"&&(I.callback=(0,_.makeFunction)(I.callback)),typeof I.callback=="function"&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(I)&&this.userContextMenuHandler||I.callback(I,this._viewer,C,this.container,k)))}}canvasOffset(){let u=this.glDOM,y=u.getBoundingClientRect(),C=u.ownerDocument,k=C.documentElement,I=C.defaultView;return{top:y.top+I.pageYOffset-k.clientTop,left:y.left+I.pageXOffset-k.clientLeft}}setHover(u,y,C){this.current_hover!=u&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,_.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,y,this.container,C)),this.current_hover=u,u&&u.hover_callback!==void 0&&(typeof u.hover_callback!="function"&&(u.hover_callback=(0,_.makeFunction)(u.hover_callback)),typeof u.hover_callback=="function"&&u.hover_callback(u,this._viewer,y,this.container,C)))}handleHoverSelection(u,y,C){if(this.hoverables.length==0)return;let k=this.targetedObjects(u,y,this.hoverables);if(k.length){var I=k[0].clickable;this.setHover(I,C,k),this.current_hover=I}else this.setHover(null)}handleHoverContinue(u,y){let C=this.targetedObjects(u,y,this.hoverables);(C.length==0||C[0]===void 0)&&this.setHover(null),C[0]!==void 0&&C[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(u,{allowTolerance:y=u.targetTouches,tolerance:C=5}={}){const k=this.getX(u),I=this.getY(u);if(y){const O=Math.abs(k-this.mouseStartX),D=Math.abs(I-this.mouseStartY);return O<=C&&D<=C}else return k===this.mouseStartX&&I===this.mouseStartY}calcTouchDistance(u){var y=u.targetTouches[0].pageX-u.targetTouches[1].pageX,C=u.targetTouches[0].pageY-u.targetTouches[1].pageY;return Math.hypot(y,C)}getX(u){var y=u.pageX;return y==null&&(y=u.pageX),u.targetTouches&&u.targetTouches[0]?y=u.targetTouches[0].pageX:u.changedTouches&&u.changedTouches[0]&&(y=u.changedTouches[0].pageX),y}getY(u){var y=u.pageY;return y==null&&(y=u.pageY),u.targetTouches&&u.targetTouches[0]?y=u.targetTouches[0].pageY:u.changedTouches&&u.changedTouches[0]&&(y=u.changedTouches[0].pageY),y}isInViewer(u,y){if(this.viewers!=null){var C=this.WIDTH/this.cols,k=this.HEIGHT/this.rows,I=this.canvasOffset(),O=u-I.left,D=y-I.top,X=this.rows-Math.floor(D/k)-1,j=Math.floor(O/C);if(X!=this.row||j!=this.col)return!1}return!0}adjustZoomToLimits(u){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let y=this.CAMERA_Z-this.config.lowerZoomLimit;u>y&&(u=y)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let y=this.CAMERA_Z-this.config.upperZoomLimit;u<y&&(u=y)}return u>this.CAMERA_Z-1&&(u=this.CAMERA_Z-1),u}static slerp(u,y,C){if(C==1)return y.clone();if(C==0)return u.clone();let k=u.x*y.x+u.y*y.y+u.z*y.z+u.w*y.w;if(k>.9995){let $=new c.Quaternion(u.x+C*(y.x-u.x),u.y+C*(y.y-u.y),u.z+C*(y.z-u.z),u.w+C*(y.w-u.w));return $.normalize(),$}k<0&&(y=y.clone().multiplyScalar(-1),k=-k),k>1?k=1:k<-1&&(k=-1);var I=Math.acos(k),O=I*C,D=y.clone();D.sub(u.clone().multiplyScalar(k)),D.normalize();var X=Math.cos(O),j=Math.sin(O),B=new c.Quaternion(u.x*X+D.x*j,u.y*X+D.y*j,u.z*X+D.z*j,u.w*X+D.w*j);return B.normalize(),B}constructor(u,y={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.slabNear=-50,this.slabFar=50,this.cq=new c.Quaternion(0,0,0,1),this.dq=new c.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=y,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=h.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",typeof this.config.backgroundColor<"u"&&(this.bgColor=h.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,typeof this.config.camerax<"u"&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=u,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new a.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new c.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new c.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new a.Raycaster(new c.Vector3(0,0,0),new c.Vector3(0,0,0)),this.projector=new a.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=h.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),typeof window.ResizeObserver<"u"&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),typeof window.IntersectionObserver<"u"){let C=(k,I)=>{k.forEach(O=>{O.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(C),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(C){console.log("error with glviewer callback: "+C)}}targetedObjects(u,y,C){var k={x:u,y,z:-1};return Array.isArray(C)||(C=this.selectedAtoms(C)),C.length==0?[]:(this.raycaster.setFromCamera(k,this.camera),this.raycaster.intersectObjects(this.modelGroup,C))}modelToScreen(u){let y=!1;Array.isArray(u)||(u=[u],y=!0);let C=this.renderer.getXRatio(),k=this.renderer.getYRatio(),I=this.col,O=this.row,D=I*(this.WIDTH/C),X=(k-O-1)*(this.HEIGHT/k),j=[],B=this.canvasOffset();return u.forEach($=>{let H=new c.Vector3($.x,$.y,$.z);H.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector(H,this.camera);let q=this.WIDTH/C*(H.x+1)/2+B.left+D,W=-(this.HEIGHT/k)*(H.y-1)/2+B.top+X;j.push({x:q,y:W})}),y&&(j=j[0]),j}screenOffsetToModel(u,y,C){var k=u/this.WIDTH,I=y/this.HEIGHT,O=C===void 0?this.rotationGroup.position.z:C,D=this.rotationGroup.quaternion,X=new c.Vector3(0,0,O);return this.projector.projectVector(X,this.camera),X.x+=k*2,X.y-=I*2,this.projector.unprojectVector(X,this.camera),X.z=0,X.applyQuaternion(D),X}screenToModelDistance(u,y){let C=this.canvasOffset(),k=new c.Vector3(y.x,y.y,y.z);k.applyMatrix4(this.modelGroup.matrixWorld);let I=k.clone();this.projector.projectVector(k,this.camera);let O=new c.Vector3((u.x-C.left)*2/this.WIDTH-1,(u.y-C.top)*2/-this.HEIGHT+1,k.z);return this.projector.unprojectVector(O,this.camera),O.distanceTo(I)}setViewChangeCallback(u){(typeof u=="function"||u==null)&&(this.viewChangeCallback=u)}setStateChangeCallback(u){(typeof u=="function"||u==null)&&(this.stateChangeCallback=u)}getConfig(){return this.config}setConfig(u){this.config=u,u.ambientOcclusion&&this.renderer.enableAmbientOcclusion(u.ambientOcclusion)}getInternalState(){var u={models:[],surfaces:[],shapes:[],labels:[]};for(let y=0;y<this.models.length;y++)this.models[y]&&(u.models[y]=this.models[y].getInternalState());return u}setInternalState(u){this.clear();var y=u.models;for(let C=0;C<y.length;C++)y[C]&&(this.models[C]=new g.GLModel(C),this.models[C].setInternalState(y[C]));this.render()}setZoomLimits(u,y){typeof u<"u"&&(this.config.lowerZoomLimit=u),y&&(this.config.upperZoomLimit=y),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(u){u.fov!==void 0&&(this.fov=u.fov,this.camera.fov=this.fov),u.z!==void 0&&(this.CAMERA_Z=u.z,this.camera.z=this.CAMERA_Z),u.orthographic!==void 0&&(this.camera.ortho=u.orthographic)}_handleMouseDown(u){if(u.preventDefault(),!this.scene)return;var y=this.getX(u),C=this.getY(u);if(y===void 0)return;this.isDragging=!0,this.mouseButton=u.which,this.mouseStartX=y,this.mouseStartY=C,this.touchHold=!0,this.touchDistanceStart=0,u.targetTouches&&u.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(u)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let k=this;u.targetTouches&&u.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(k.touchHold==!0){k.glDOM=k.renderer.domElement;const I=u.targetTouches[0],O=new PointerEvent("contextmenu",Object.assign(Object.assign({},u),{pageX:I.pageX,pageY:I.pageY,screenX:I.screenX,screenY:I.screenY,clientX:I.clientX,clientY:I.clientY}));k.glDOM.dispatchEvent(O)}},this.longTouchDuration))}_handleMouseUp(u){if(this.touchHold=!1,this.isDragging&&this.scene){var y=this.getX(u),C=this.getY(u);if(this.closeEnoughForClick(u)&&this.isInViewer(y,C)){let k=this.mouseXY(y,C);this.handleClickSelection(k.x,k.y,u)}}this.isDragging=!1}_handleMouseScroll(u){if(u.preventDefault(),!!this.scene){var y=this.getX(u),C=this.getY(u);if(y!==void 0&&!(!this.control_all&&!this.isInViewer(y,C))){var k=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,I=1;if(u.ctrlKey&&(I=-1),u.detail)this.rotationGroup.position.z+=I*k*u.detail/10;else if(u.wheelDelta){let O=u.wheelDelta*600/(u.wheelDelta+600);this.rotationGroup.position.z-=I*k*O/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(u){let y=this;return u=u||1,new Promise(function(C){let k=0,I=y.viewChangeCallback,O=[],D=[],X=Date.now();y.viewChangeCallback=function(){D.push(Date.now()-X),X=Date.now(),O.push(new Promise(j=>{y.getCanvas().toBlob(function(B){B.arrayBuffer().then(j)},"image/png")})),k+=1,k==u&&(y.viewChangeCallback=I,Promise.all(O).then(j=>{let B=[];for(let G=0;G<j.length;G++){let V=(0,z.decode)(j[G]);B.push((0,z.toRGBA8)(V)[0])}let $=y.getCanvas().width,H=y.getCanvas().height,q=(0,z.encode)(B,$,H,0,D),W=new Blob([q],{type:"image/png"}),Y=new FileReader;Y.onload=function(G){C(G.target.result)},Y.readAsDataURL(W)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(u){this.hoverDuration=u}mouseXY(u,y){let C=this.canvasOffset(),k=this.renderer.getXRatio(),I=this.renderer.getYRatio(),O=this.col,D=this.row,X=O*(this.WIDTH/k),j=(I-D-1)*(this.HEIGHT/I),B=(u-C.left-X)/(this.WIDTH/k)*2-1,$=-((y-C.top-j)/(this.HEIGHT/I))*2+1;return{x:B,y:$}}_handleMouseMove(u){clearTimeout(this.hoverTimeout),u.preventDefault();let y=this.getX(u),C=this.getY(u);if(y===void 0)return;let k=this.renderer.getXRatio(),I=this.renderer.getYRatio(),O=this.mouseXY(y,C),D=this;this.current_hover!==null&&this.handleHoverContinue(O.x,O.y);var X=0;if(!(!this.control_all&&!this.isInViewer(y,C))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){D.handleHoverSelection(O.x,O.y,u)},this.hoverDuration)),!!this.isDragging)){u.targetTouches&&(u.targetTouches.length>1||u.targetTouches.length===1&&!this.closeEnoughForClick(u))&&clearTimeout(this.longTouchTimeout);var j=(y-this.mouseStartX)/this.WIDTH,B=(C-this.mouseStartY)/this.HEIGHT;if(this.touchDistanceStart!=0&&u.targetTouches&&u.targetTouches.length==2){var $=this.calcTouchDistance(u);X=2,B=($-this.touchDistanceStart)*2/(this.WIDTH+this.HEIGHT)}else u.targetTouches&&u.targetTouches.length==3&&(X=1);j*=k,B*=I;var H=Math.hypot(j,B),q;if(X==3||this.mouseButton==3&&u.ctrlKey)this.slabNear=this.cslabNear+j*100,this.slabFar=this.cslabFar-B*100;else if(X==2||this.mouseButton==3||u.shiftKey)q=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,q<80&&(q=80),this.rotationGroup.position.z=this.cz+B*q,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(X==1||this.mouseButton==2||u.ctrlKey){var W=this.screenOffsetToModel(k*(y-this.mouseStartX),I*(C-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,W)}else if((X===0||this.mouseButton==1)&&H!==0){var Y=Math.sin(H*Math.PI)/H;this.dq.x=Math.cos(H*Math.PI),this.dq.y=0,this.dq.z=Y*j,this.dq.w=-Y*B,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(u){if(u.preventDefault(),this.closeEnoughForClick(u)){var k=this.mouseStartX,I=this.mouseStartY,C=this.canvasOffset();let O=this.mouseXY(k,I),D=O.x,X=O.y,j=this.targetedObjects(D,X,this.contextMenuEnabledObjects);var y=null;j.length&&(y=j[0].clickable);var C=this.canvasOffset(),k=this.mouseStartX-C.left,I=this.mouseStartY-C.top;this.userContextMenuHandler&&(this.userContextMenuHandler(y,k,I,j,u),this.isDragging=!1)}}setContainer(u){let y=(0,_.getElement)(u)||this.container;return this.initContainer(y),this}setBackgroundColor(u,y){(typeof y>"u"||y<0||y>1)&&(y=1);var C=h.CC.color(u);return this.scene.fog.color=C,this.bgColor=C.getHex(),this.renderer.setClearColorHex(C.getHex(),y),this.show(),this}setProjection(u){this.camera.ortho=u==="orthographic",this.setSlabAndFog()}setViewStyle(u){if(u=u||{},u.style=u.style||"",u.style.includes("outline")){var y={};u.color&&(y.color=h.CC.color(u.color)),u.width&&(y.width=u.width),this.renderer.enableOutline(y)}else this.renderer.disableOutline();if(u.style.includes("ambientOcclusion")){var y={};u.strength&&(y.strength=u.strength),u.radius&&(y.radius=u.radius),this.renderer.enableAmbientOcclusion(y)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(u){return this.WIDTH=u||this.WIDTH,this.updateSize(),this}setHeight(u){return this.HEIGHT=u||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let u=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let y=!1,C=this.container.querySelector("canvas");C&&C!=this.renderer.getCanvas()?this.config.canvas=C:(C.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,y=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),u=!0,y&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),u){let y=this.renderer.supportedExtensions();if(y.regen=!0,this.viewers)for(let C=0,k=this.viewers.length;C<k;C++)for(let I=0,O=this.viewers[C].length;I<O;I++)this.viewers[C][I].render(null,y);this._viewer.render(null,y)}else this.show();return this}getModel(u){return u===void 0?this.models.length==0?null:this.models[this.models.length-1]:u instanceof g.GLModel?u:u in this.models?this.models[u]:this.models.length==0?null:this.models[this.models.length-1]}spin(u,y=1){if(clearInterval(this.spinInterval),typeof u>"u"&&(u="y"),typeof u=="boolean")if(u)u="y";else return;Array.isArray(u)&&(u={x:u[0],y:u[1],z:u[2]});var C=this;this.spinInterval=setInterval(function(){!C.getCanvas().isConnected&&C.renderer.isLost()&&clearInterval(C.spinInterval),C.rotate(1*y,u)},25)}animateMotion(u,y,C,k,I,O){var D=20,X=Math.ceil(u/D);X<1&&(X=1),this.incAnim();var j={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(y){let H=new Array(X);for(let G=0;G<X;G++){let V=(G+1)/X,Q={mpos:j.mpos,rz:j.rz,rot:j.rot};Q.mpos=C.clone().sub(j.mpos).multiplyScalar(V).add(j.mpos),Q.rz=j.rz+V*(k-j.rz),Q.rot=s.slerp(j.rot,I,V),Q.cam=O.clone().sub(j.cam).multiplyScalar(V).add(j.cam),H[G]=Q}let q=0,W=this,Y=function(){var G=H[q];q+=1,W.modelGroup.position=G.mpos,W.rotationGroup.position.z=G.rz,W.rotationGroup.quaternion=G.rot,W.camera.lookAt(G.cam),q<H.length?setTimeout(Y,D):W.decAnim(),W.show()};setTimeout(Y,D)}else{var B={};let H=1/X;if(C&&(B.mpos=C.clone().sub(j.mpos).multiplyScalar(H)),typeof k<"u"&&k!=null&&(B.rz=H*(k-j.rz)),I){var $=s.slerp(j.rot,I,H);B.rot=j.rot.clone().inverse().multiply($)}O&&(B.cam=O.clone().sub(j.cam).multiplyScalar(H));let q=0,W=this,Y=function(){q+=1,B.mpos&&W.modelGroup.position.add(B.mpos),B.rz&&(W.rotationGroup.position.z+=B.rz),B.rot&&W.rotationGroup.quaternion.multiply(B.rot),B.cam&&(W.lookingAt.add(B.cam),W.camera.lookAt(W.lookingAt)),q<X?setTimeout(Y,D):W.decAnim(),W.show()};setTimeout(Y,D)}}rotate(u,y="y",C=0,k=!1){if(y=="x"?y={x:1,y:0,z:0}:y=="y"?y={x:0,y:1,z:0}:y=="z"&&(y={x:0,y:0,z:1}),y=="vx"?y={vx:1,vy:0,vz:0}:y=="vy"?y={vx:0,vy:1,vz:0}:y=="vz"&&(y={vx:0,vy:0,vz:1}),typeof y.vx<"u"){var I=new c.Vector3(y.vx,y.vy,y.vz);I.applyQuaternion(this.rotationGroup.quaternion),y={x:I.x,y:I.y,z:I.z}}var O=function(B){var $=Math.sin(B/2),H=Math.cos(B/2),q=0,W=0,Y=0;return q=y.x*$,W=y.y*$,Y=y.z*$,new c.Quaternion(q,W,Y,H).normalize()},D=Math.PI*u/180,X=O(D);if(C){var j=new c.Quaternion().copy(this.rotationGroup.quaternion).multiply(X);this.animateMotion(C,k,this.modelGroup.position,this.rotationGroup.position.z,j,this.lookingAt)}else this.rotationGroup.quaternion.multiply(X),this.show();return this}surfacesFinished(){for(var u in this.surfaces)if(!this.surfaces[u][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var u=this.modelGroup.position,y=this.rotationGroup.quaternion;return[u.x,u.y,u.z,this.rotationGroup.position.z,y.x,y.y,y.z,y.w]}setView(u,y){return u===void 0||!(u instanceof Array||u.length!==8)?this:!this.modelGroup||!this.rotationGroup?this:(this.modelGroup.position.x=u[0],this.modelGroup.position.y=u[1],this.modelGroup.position.z=u[2],this.rotationGroup.position.z=u[3],this.rotationGroup.quaternion.x=u[4],this.rotationGroup.quaternion.y=u[5],this.rotationGroup.quaternion.z=u[6],this.rotationGroup.quaternion.w=u[7],typeof u[8]<"u"&&(this.rotationGroup.position.x=u[8],this.rotationGroup.position.y=u[9]),this.show(y),this)}render(u,y){this.renderer.setViewport(),this.updateClickables();var C=this.getView();this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState());var k,I;for(y||(y=this.renderer.supportedExtensions()),k=0;k<this.models.length;k++)this.models[k]&&this.models[k].globj(this.modelGroup,y);for(k=0;k<this.shapes.length;k++)this.shapes[k]&&(typeof this.shapes[k].frame>"u"||this.viewer_frame<0||this.shapes[k].frame<0||this.shapes[k].frame==this.viewer_frame?this.shapes[k].globj(this.modelGroup,y):this.shapes[k].removegl(this.modelGroup));for(k=0;k<this.labels.length;k++)y.regen&&(this.labels[k].dispose(),this.modelGroup.remove(this.labels[k].sprite),this.labels[k].setContext(),this.modelGroup.add(this.labels[k].sprite)),this.labels[k]&&typeof this.labels[k].frame<"u"&&this.labels[k].frame>=0&&(this.modelGroup.remove(this.labels[k].sprite),(this.viewer_frame<0||this.labels[k].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[k].sprite));for(k in this.surfaces)if(this.surfaces.hasOwnProperty(k)){var O=this.surfaces[k];for(I=0;I<O.length;I++)if(O.hasOwnProperty(I)){var D=O[I].geo;if(!O[I].finished||y.regen){D.verticesNeedUpdate=!0,D.elementsNeedUpdate=!0,D.normalsNeedUpdate=!0,D.colorsNeedUpdate=!0,D.buffersNeedUpdate=!0,D.boundingSphere=null,O[I].mat.needsUpdate=!0,O[I].done&&(O[I].finished=!0),O[I].lastGL&&this.modelGroup.remove(O[I].lastGL);var X=null;if(O[I].mat instanceof a.LineBasicMaterial?X=new a.Line(D,O[I].mat):X=new a.Mesh(D,O[I].mat),O[I].mat.transparent&&O[I].mat.opacity==0?X.visible=!1:X.visible=!0,O[I].symmetries.length>1||O[I].symmetries.length==1&&!O[I].symmetries[I].isIdentity()){var j,B=new a.Object3D;for(j=0;j<O[I].symmetries.length;j++){var $=X.clone();$.matrix=O[I].symmetries[j],$.matrixAutoUpdate=!1,B.add($)}O[I].lastGL=B,this.modelGroup.add(B)}else O[I].lastGL=X,this.modelGroup.add(X)}}}return this.setView(C),typeof u=="function"&&u(this),this}getModelList(u){let y=[];if(typeof u>"u"||typeof u.model>"u")for(let k=0;k<this.models.length;k++)this.models[k]&&y.push(this.models[k]);else{let k=u.model;Array.isArray(k)||(k=[k]);for(let I=0;I<k.length;I++)if(typeof k[I]=="number"){var C=k[I];C<0&&(C+=this.models.length),y.push(this.models[C])}else y.push(k[I])}return y}getAtomsFromSel(u){var y=[];typeof u>"u"&&(u={});var C=this.getModelList(u);for(let k=0;k<C.length;k++)y=y.concat(C[k].selectedAtoms(u));return y}atomIsSelected(u,y){typeof y>"u"&&(y={});for(var C=this.getModelList(y),k=0;k<C.length;k++)if(C[k].atomIsSelected(u,y))return!0;return!1}selectedAtoms(u){return this.getAtomsFromSel(u)}getUniqueValues(u,y){typeof y>"u"&&(y={});var C=this.getAtomsFromSel(y),k={};for(var I in C)if(C[I].hasOwnProperty(u)){var O=C[I][u];k[O]=!0}return Object.keys(k)}pdbData(u){for(var y=this.getAtomsFromSel(u),C="",k=0,I=y.length;k<I;++k)C+=y[k].pdbline+`
`;return C}zoom(u=2,y=0,C=!1){var k=(this.CAMERA_Z-this.rotationGroup.position.z)/u,I=this.CAMERA_Z-k;return y>0?this.animateMotion(y,C,this.modelGroup.position,this.adjustZoomToLimits(I),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(I),this.show()),this}translate(u,y,C=0,k=!1){var I=u/this.WIDTH,O=y/this.HEIGHT,D=new c.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(D,this.camera),D.x-=I,D.y-=O,this.projector.unprojectVector(D,this.camera),D.z=0;var X=this.lookingAt.clone().add(D);return C>0?this.animateMotion(C,k,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,X):(this.lookingAt=X,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(u,y,C=0,k=!1){var I=this.screenOffsetToModel(u,y),O=this.modelGroup.position.clone().add(I);return C>0?this.animateMotion(C,k,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=O,this.show()),this}fitSlab(u){u=u||{};var y=this.getAtomsFromSel(u),C=(0,_.getExtent)(y),k=C[1][0]-C[0][0],I=C[1][1]-C[0][1],O=C[1][2]-C[0][2],D=Math.hypot(k,I,O);return D<5&&(D=5),this.slabNear=-D/1.9,this.slabFar=D/2,this}center(u={},y=0,C=!1){var k,I,O=this.getAtomsFromSel(u),D=(0,_.getExtent)(O);(0,_.isEmptyObject)(u)?(this.shapes.forEach(V=>{if(V&&V.boundingSphere&&V.boundingSphere.center){var Q=V.boundingSphere.center,xe=V.boundingSphere.radius;xe>0?(O.push(new c.Vector3(Q.x+xe,Q.y,Q.z)),O.push(new c.Vector3(Q.x-xe,Q.y,Q.z)),O.push(new c.Vector3(Q.x,Q.y+xe,Q.z)),O.push(new c.Vector3(Q.x,Q.y-xe,Q.z)),O.push(new c.Vector3(Q.x,Q.y,Q.z+xe)),O.push(new c.Vector3(Q.x,Q.y,Q.z-xe))):O.push(Q)}}),D=(0,_.getExtent)(O),k=O,I=D):(k=this.getAtomsFromSel({}),I=(0,_.getExtent)(k));var X=new c.Vector3(D[2][0],D[2][1],D[2][2]),j=I[1][0]-I[0][0],B=I[1][1]-I[0][1],$=I[1][2]-I[0][2],H=Math.hypot(j,B,$);H<5&&(H=5),this.slabNear=-H/1.9,this.slabFar=H/2,j=D[1][0]-D[0][0],B=D[1][1]-D[0][1],$=D[1][2]-D[0][2],H=Math.hypot(j,B,$),H<5&&(H=5);for(var q=25,W=0;W<O.length;W++)if(O[W]){var Y=X.distanceToSquared(O[W]);Y>q&&(q=Y)}H=Math.sqrt(q)*2;var G=X.clone().multiplyScalar(-1);return y>0?this.animateMotion(y,C,G,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=G,this.show()),this}zoomTo(u={},y=0,C=!1){let k=this.getAtomsFromSel(u),I=(0,_.getExtent)(k),O=I;if((0,_.isEmptyObject)(u)){let Q=k&&k.length;if(this.shapes.forEach(xe=>{if(xe&&xe.boundingSphere){if(xe.boundingSphere.box){let Pe=xe.boundingSphere.box;k.push(new c.Vector3(Pe.min.x,Pe.min.y,Pe.min.z)),k.push(new c.Vector3(Pe.max.x,Pe.max.y,Pe.max.z))}else if(xe.boundingSphere.center){var ce=xe.boundingSphere.center,Ne=xe.boundingSphere.radius;Ne>0?(k.push(new c.Vector3(ce.x+Ne,ce.y,ce.z)),k.push(new c.Vector3(ce.x-Ne,ce.y,ce.z)),k.push(new c.Vector3(ce.x,ce.y+Ne,ce.z)),k.push(new c.Vector3(ce.x,ce.y-Ne,ce.z)),k.push(new c.Vector3(ce.x,ce.y,ce.z+Ne)),k.push(new c.Vector3(ce.x,ce.y,ce.z-Ne))):k.push(ce)}}}),O=(0,_.getExtent)(k),!Q)for(let xe=0;xe<3;xe++)I[2][xe]=(O[0][xe]+O[1][xe])/2}else{let Q=this.getAtomsFromSel({});O=(0,_.getExtent)(Q)}var D=new c.Vector3(I[2][0],I[2][1],I[2][2]),X=O[1][0]-O[0][0],j=O[1][1]-O[0][1],B=O[1][2]-O[0][2],$=Math.hypot(X,j,B);$<5&&($=5),this.slabNear=-$/1.9,this.slabFar=$/2,Object.keys(u).length===0&&(this.slabNear=Math.min(-$*2,-50),this.slabFar=Math.max($*2,50));var H=this.config.minimumZoomToDistance||5;X=I[1][0]-I[0][0],j=I[1][1]-I[0][1],B=I[1][2]-I[0][2],$=Math.hypot(X,j,B),$<H&&($=H);for(var q=H*H,W=0;W<k.length;W++)if(k[W]){var Y=D.distanceToSquared(k[W]);Y>q&&(q=Y)}$=Math.sqrt(q)*2;var G=D.clone().multiplyScalar(-1),V=-($*.5/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return V=this.adjustZoomToLimits(V),y>0?this.animateMotion(y,C,G,V,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=G,this.rotationGroup.position.z=V,this.show()),this}setSlab(u,y){this.slabNear=u,this.slabFar=y}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(u,y={},C,k=!1){if(C){var I=(0,_.getExtent)(this.getAtomsFromSel(C));y.position={x:I[2][0],y:I[2][1],z:I[2][2]}}var O=new b.Label(u,y);return O.setContext(),this.modelGroup.add(O.sprite),this.labels.push(O),k||this.show(),O}addResLabels(u,y,C=!1){let k=this.labels.length;return this.applyToModels("addResLabels",u,this,y,C),this.show(),this.labels.slice(k)}addPropertyLabels(u,y,C){return this.applyToModels("addPropertyLabels",u,y,this,C),this.show(),this}removeLabel(u){for(var y=0;y<this.labels.length;y++)if(this.labels[y]==u){this.labels.splice(y,1),u.dispose(),this.modelGroup.remove(u.sprite);break}return this.show(),this}removeAllLabels(){for(var u=0;u<this.labels.length;u++)this.labels[u]&&this.labels[u].sprite&&this.modelGroup.remove(this.labels[u].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}setLabelStyle(u,y){return this.modelGroup.remove(u.sprite),u.dispose(),u.stylespec=y,u.setContext(),this.modelGroup.add(u.sprite),this.show(),u}setLabelText(u,y){return this.modelGroup.remove(u.sprite),u.dispose(),u.text=y,u.setContext(),this.modelGroup.add(u.sprite),this.show(),u}addShape(u){u=u||{};var y=new p.GLShape(u);return y.shapePosition=this.shapes.length,this.shapes.push(y),y}removeShape(u){if(!u)return this;for(u.removegl(this.modelGroup),delete this.shapes[u.shapePosition];this.shapes.length>0&&typeof this.shapes[this.shapes.length-1]>"u";)this.shapes.pop();return this}removeAllShapes(){for(var u=0;u<this.shapes.length;u++){var y=this.shapes[u];y&&y.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(u){if(u.hasOwnProperty("x")&&u.hasOwnProperty("y")&&u.hasOwnProperty("z"))return u;var y=this.getAtomsFromSel(u);if(y.length==0)return{x:0,y:0,z:0};var C=(0,_.getExtent)(y);return{x:C[0][0]+(C[1][0]-C[0][0])/2,y:C[0][1]+(C[1][1]-C[0][1])/2,z:C[0][2]+(C[1][2]-C[0][2])/2}}addSphere(u){u=u||{},u.center=this.getSelectionCenter(u.center);var y=new p.GLShape(u);return y.shapePosition=this.shapes.length,y.addSphere(u),this.shapes.push(y),y.finalize(),y}addBox(u={}){u.corner!=null&&(u.corner=this.getSelectionCenter(u.corner)),u.center!=null&&(u.center=this.getSelectionCenter(u.center));var y=new p.GLShape(u);return y.shapePosition=this.shapes.length,y.addBox(u),this.shapes.push(y),y.finalize(),y}addArrow(u={}){u.start=this.getSelectionCenter(u.start),u.end=this.getSelectionCenter(u.end);var y=new p.GLShape(u);return y.shapePosition=this.shapes.length,y.addArrow(u),this.shapes.push(y),y.finalize(),y}addCylinder(u={}){u.start=this.getSelectionCenter(u.start),u.end=this.getSelectionCenter(u.end);var y=new p.GLShape(u);return y.shapePosition=this.shapes.length,u.dashed?y.addDashedCylinder(u):y.addCylinder(u),this.shapes.push(y),y.finalize(),y}addCurve(u={}){var y=new p.GLShape(u);return y.shapePosition=this.shapes.length,y.addCurve(u),this.shapes.push(y),y.finalize(),y}addLine(u={}){u.start=this.getSelectionCenter(u.start),u.end=this.getSelectionCenter(u.end),u.wireframe=!0;var y=new p.GLShape(u);return y.shapePosition=this.shapes.length,u.dashed?y=this.addLineDashed(u,y):y.addLine(u),this.shapes.push(y),y.finalize(),y}addUnitCell(u,y){u=this.getModel(u),y=y||{alabel:"a",blabel:"b",clabel:"c"},y.box=y.box||{},y.astyle=y.astyle||{color:"red",radius:.1,midpos:-1},y.bstyle=y.bstyle||{color:"green",radius:.1,midpos:-1},y.cstyle=y.cstyle||{color:"blue",radius:.1,midpos:-1},y.alabelstyle=y.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},y.blabelstyle=y.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},y.clabelstyle=y.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},u.unitCellObjects&&this.removeUnitCell(u),u.unitCellObjects={shapes:[],labels:[]};var C=u.getCrystData(),k=null;if(C){if(C.matrix)k=C.matrix;else{var I=C.a,O=C.b,D=C.c,X=C.alpha,j=C.beta,B=C.gamma;X=X*Math.PI/180,j=j*Math.PI/180,B=B*Math.PI/180;var $,H,q;$=Math.cos(j),H=(Math.cos(X)-Math.cos(j)*Math.cos(B))/Math.sin(B),q=Math.sqrt(Math.max(0,1-$*$-H*H)),k=new c.Matrix3(I,O*Math.cos(B),D*$,0,O*Math.sin(B),D*H,0,0,D*q)}var W=[new c.Vector3(0,0,0),new c.Vector3(1,0,0),new c.Vector3(0,1,0),new c.Vector3(0,0,1),new c.Vector3(1,1,0),new c.Vector3(0,1,1),new c.Vector3(1,0,1),new c.Vector3(1,1,1)];if(C.matrix4)for(let G=0;G<W.length;G++)C.size&&W[G].multiplyVectors(W[G],C.size),W[G]=W[G].applyMatrix4(C.matrix4);else for(let G=0;G<W.length;G++)W[G]=W[G].applyMatrix3(k);if(y.box&&!y.box.hidden){y.box.wireframe=!0;var Y=new p.GLShape(y.box);Y.shapePosition=this.shapes.length,Y.addLine({start:W[0],end:W[1]}),Y.addLine({start:W[0],end:W[2]}),Y.addLine({start:W[1],end:W[4]}),Y.addLine({start:W[2],end:W[4]}),Y.addLine({start:W[0],end:W[3]}),Y.addLine({start:W[3],end:W[5]}),Y.addLine({start:W[2],end:W[5]}),Y.addLine({start:W[1],end:W[6]}),Y.addLine({start:W[4],end:W[7]}),Y.addLine({start:W[6],end:W[7]}),Y.addLine({start:W[3],end:W[6]}),Y.addLine({start:W[5],end:W[7]}),this.shapes.push(Y),u.unitCellObjects.shapes.push(Y),Y.finalize()}if(!y.astyle.hidden){y.astyle.start=W[0],y.astyle.end=W[1];let G=this.addArrow(y.astyle);u.unitCellObjects.shapes.push(G)}if(!y.bstyle.hidden){y.bstyle.start=W[0],y.bstyle.end=W[2];let G=this.addArrow(y.bstyle);u.unitCellObjects.shapes.push(G)}if(!y.cstyle.hidden){y.cstyle.start=W[0],y.cstyle.end=W[3];let G=this.addArrow(y.cstyle);u.unitCellObjects.shapes.push(G)}if(y.alabel){y.alabelstyle.position=W[1];let G=this.addLabel(y.alabel,y.alabelstyle);u.unitCellObjects.labels.push(G)}if(y.blabel){y.blabelstyle.position=W[2];let G=this.addLabel(y.blabel,y.blabelstyle);u.unitCellObjects.labels.push(G)}if(y.clabel){y.clabelstyle.position=W[3];let G=this.addLabel(y.clabel,y.clabelstyle);u.unitCellObjects.labels.push(G)}}}removeUnitCell(u){if(u=this.getModel(u),u.unitCellObjects){let y=this;u.unitCellObjects.shapes.forEach(function(C){y.removeShape(C)}),u.unitCellObjects.labels.forEach(function(C){y.removeLabel(C)})}delete u.unitCellObjects}replicateUnitCell(u=3,y=u,C=y,k,I,O){k=this.getModel(k);let D=k.getCrystData();if(D){const X=k.selectedAtoms({}),j=D.matrix;let B=function(H){return H%2==0?-H/2:Math.ceil(H/2)};u<=1&&y<=1&&C<=1&&(O=!0,u=y=C=3);let $=function(H,q,W){return!1};if(O){const H=new c.Matrix3().getInverse3(j);$=function(q,W,Y){let G=new c.Vector3(q,W,Y).applyMatrix3(H);return!(G.x>-1e-4&&G.x<1.0001&&G.y>-1e-4&&G.y<1.0001&&G.z>-1e-4&&G.z<1.0001)}}for(let H=0;H<u;H++)for(let q=0;q<y;q++)for(let W=0;W<C;W++){if(H==0&&q==0&&W==0)continue;let Y=new c.Vector3(B(H),B(q),B(W));Y.applyMatrix3(j);let G=[];for(let V=0;V<X.length;V++){let Q=X[V].x+Y.x,xe=X[V].y+Y.y,ce=X[V].z+Y.z;if($(Q,xe,ce))continue;let Ne={};for(let Pe in X[V])Ne[Pe]=X[V][Pe];Ne.x=Q,Ne.y=xe,Ne.z=ce,G.push(Ne)}k.addAtoms(G)}I&&k.assignBonds()}}addLineDashed(u,y){u.dashLength=u.dashLength||.5,u.gapLength=u.gapLength||.5;var C;u.start?C=new c.Vector3(u.start.x||0,u.start.y||0,u.start.z||0):C=new c.Vector3(0,0,0);var k;u.end?k=new c.Vector3(u.end.x,u.end.y||0,u.end.z||0):k=new c.Vector3(0,0,0);var I=new c.Vector3,O=new c.Vector3,D=new c.Vector3,X,j,B,$=C.clone(),H=0;for(I.subVectors(k,C),X=I.length(),I.normalize(),O=I.clone(),D=I.clone(),O.multiplyScalar(u.dashLength),D.multiplyScalar(u.gapLength),j=O.length(),B=D.length();H<X;){if(H+j>X){u.start=C,u.end=k,y.addLine(u);break}$.addVectors(C,O),u.start=C,u.end=$,y.addLine(u),C=$.clone(),H+=j,$.addVectors(C,D),C=$.clone(),H+=B}return y.finalize(),y}addCustom(u){u=u||{};var y=new p.GLShape(u);return y.shapePosition=this.shapes.length,y.addCustom(u),this.shapes.push(y),y.finalize(),y}addVolumetricData(u,y,C={}){var k=new E.VolumeData(u,y);return C.hasOwnProperty("transferfn")?this.addVolumetricRender(k,C):this.addIsosurface(k,C)}addIsosurface(u,y={},C){var k=new p.GLShape(y);return k.shapePosition=this.shapes.length,k.addIsosurface(u,y,C,this),this.shapes.push(k),k}addVolumetricRender(u,y){y=y||{};var C=new R.GLVolumetricRender(u,y,this);return C.shapePosition=this.shapes.length,this.shapes.push(C),C}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(u){u?this.scene.fog=new a.Fog(this.bgColor,100,200):(this.config.disableFog=!0,this.show())}setFrame(u){this.viewer_frame=u;let y=this;return new Promise(function(C){var k=y.models.map(function(I){return I.setFrame(u,y)});Promise.all(k).then(function(){C()})})}getFrame(){return this.viewer_frame}getNumFrames(){var u=0;for(let y=0;y<this.models.length;y++)this.models[y].getNumFrames()>u&&(u=this.models[y].getNumFrames());for(let y=0;y<this.shapes.length;y++)this.shapes[y].frame&&this.shapes[y].frame>=u&&(u=this.shapes[y].frame+1);for(let y=0;y<this.labels.length;y++)this.labels[y].frame&&this.labels[y].frame>=u&&(u=this.labels[y].frame+1);return u}animate(u){this.incAnim();var y=100,C="forward",k=1/0;u=u||{},u.interval&&(y=u.interval),u.loop&&(C=u.loop),u.reps&&(k=u.reps);var I=this.getNumFrames(),O=this,D=0;u.startFrame&&(D=u.startFrame%I);var X=1;u.step&&(X=u.step,k/=X);var j=0,B=I*k,$=new Date,H,q,W=function(Y){$=new Date,Y=="forward"?O.setFrame(D).then(function(){D=(D+X)%I,H()}):Y=="backward"?O.setFrame(I-1-D).then(function(){D=(D+X)%I,H()}):O.setFrame(D).then(function(){D+=X,X*=D%(I-1)==0?-1:1,H()})};return H=function(){if(O.render(),!O.getCanvas().isConnected)O.stopAnimate();else if(++j>=B||!O.isAnimated())q.cancel(),O.animationTimers.delete(q),O.decAnim();else{var Y=y-(new Date().getTime()-$.getTime());Y=Y>0?Y:0,O.animationTimers.delete(q),q=new _.PausableTimer(W,Y,C),O.animationTimers.add(q)}},q=new _.PausableTimer(W,0,C),this.animationTimers.add(q),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(u){u.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(u){u.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(u){u.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(u){return u&&!u.defaultcolors?(u.defaultcolors=this.defaultcolors,u.cartoonQuality=u.cartoonQuality||this.config.cartoonQuality):typeof u>"u"&&(u={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),u}addModel(u,y="",C){C=this.getModelOpt(C);var k=new g.GLModel(this.models.length,C);return k.addMolData(u,y,C),this.models.push(k),k}addModels(u,y,C){C=this.getModelOpt(C),C.multimodel=!0,C.frames=!0;for(var k=g.GLModel.parseMolData(u,y,C),I=0;I<k.length;I++){var O=new g.GLModel(this.models.length,C);O.setAtomDefaults(k[I]),O.addFrame(k[I]),O.setFrame(0),k.modelData&&O.setModelData(k.modelData[I]),O.setDontDuplicateAtoms(!C.duplicateAssemblyAtoms),this.models.push(O)}return this.models}addModelsAsFrames(u,y,C){C=this.getModelOpt(C),C.multimodel=!0,C.frames=!0;var k=new g.GLModel(this.models.length,C);return k.addMolData(u,y,C),this.models.push(k),k}addAsOneMolecule(u,y,C){C=this.getModelOpt(C),C.multimodel=!0,C.onemol=!0;var k=new g.GLModel(this.models.length,C);return k.addMolData(u,y,C),this.models.push(k),k}removeModel(u){if(u=this.getModel(u),!!u){for(u.removegl(this.modelGroup),delete this.models[u.getID()];this.models.length>0&&typeof this.models[this.models.length-1]>"u";)this.models.pop();return this}}removeAllModels(){for(var u=0;u<this.models.length;u++){var y=this.models[u];y&&y.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(u,y){var C={};return y===void 0?C.m=this.models.map(function(k){return k.toCDObject(u)}):C.m=[this.models[y].toCDObject()],JSON.stringify(C)}exportVRML(){var u=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new a.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var y=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=u,y}createModelFrom(u,y=!1){for(var C=new g.GLModel(this.models.length,this.defaultcolors),k=0;k<this.models.length;k++)if(this.models[k]){var I=this.models[k].selectedAtoms(u);C.addAtoms(I),y&&this.models[k].removeAtoms(I)}return this.models.push(C),C}applyToModels(u,y,C,k,I,O,D){for(var X=this.getModelList(y),j=0;j<X.length;j++)X[j][u](y,C,k,I,O,D)}setStyle(u,y){return typeof y>"u"&&(y=u,u={}),this.applyToModels("setStyle",u,y,!1),this}addStyle(u,y){return typeof y>"u"&&(y=u,u={}),this.applyToModels("setStyle",u,y,!0),this}setClickable(u,y,C){return this.applyToModels("setClickable",u,y,C),this}setHoverable(u,y,C,k){return this.applyToModels("setHoverable",u,y,C,k),this}enableContextMenu(u,y){return this.applyToModels("enableContextMenu",u,y),this}vibrate(u,y,C,k){return this.applyToModels("vibrate",u,y,C,this,k),this}setColorByProperty(u,y,C,k){return this.applyToModels("setColorByProperty",u,y,C,k),this}setColorByElement(u,y){return this.applyToModels("setColorByElement",u,y),this}static getAtomsWithin(u,y){var C=[];for(let I=0;I<u.length;I++){var k=u[I];typeof k>"u"||k.x<y[0][0]||k.x>y[1][0]||k.y<y[0][1]||k.y>y[1][1]||k.z<y[0][2]||k.z>y[1][2]||C.push(k)}return C}static volume(u){var y=u[1][0]-u[0][0],C=u[1][1]-u[0][1],k=u[1][2]-u[0][2];return y*C*k}carveUpExtent(u,y,C){let k=[],I={};for(let $=0,H=y.length;$<H;$++)I[y[$].index]=$;let O=function($){let H=[];for(let q=0,W=$.length;q<W;q++)$[q].index in I&&H.push(I[$[q].index]);return H},D=function($){let H=[];return H[0]=[$[0][0],$[0][1],$[0][2]],H[1]=[$[1][0],$[1][1],$[1][2]],H},X=function($){if(s.volume($)<s.maxVolume)return[$];var H=$[1][0]-$[0][0],q=$[1][1]-$[0][1],W=$[1][2]-$[0][2],Y;H>q&&H>W?Y=0:q>H&&q>W?Y=1:Y=2;var G=D($),V=D($),Q=($[1][Y]-$[0][Y])/2+$[0][Y];G[1][Y]=Q,V[0][Y]=Q;var xe=X(G),ce=X(V);return xe.concat(ce)},j=X(u),B=6;for(let $=0,H=j.length;$<H;$++){let q=D(j[$]);q[0][0]-=B,q[0][1]-=B,q[0][2]-=B,q[1][0]+=B,q[1][1]+=B,q[1][2]+=B;let W=s.getAtomsWithin(y,q),Y=s.getAtomsWithin(C,j[$]);k.push({extent:j[$],atoms:O(W),toshow:O(Y)})}return k}static generateSurfaceMesh(u,y,C){var k=new a.Geometry(!0),I=k.updateGeoGroup(0),O=[];for(let Gt=0,mt=u.length;Gt<mt;Gt++){var D=u[Gt];D&&(typeof D.surfaceColor<"u"?O[Gt]=D.surfaceColor:D.color&&(O[Gt]=h.CC.color(D.color)))}var X=I.vertexArray,j=y.vertices;for(let Gt=0,mt=j.length;Gt<mt;Gt++){let Le=I.vertices*3;X[Le]=j[Gt].x,X[Le+1]=j[Gt].y,X[Le+2]=j[Gt].z,I.vertices++}var B=I.colorArray;if(C.voldata&&C.volscheme){var $=C.volscheme,H=C.voldata,q=$.range()||[-1,1];for(let Gt=0,mt=j.length;Gt<mt;Gt++){let Le=H.getVal(j[Gt].x,j[Gt].y,j[Gt].z),ht=h.CC.color($.valueToHex(Le,q)),ar=Gt*3;B[ar]=ht.r,B[ar+1]=ht.g,B[ar+2]=ht.b}}else if(O.length>0)for(let Gt=0,mt=j.length;Gt<mt;Gt++){let Le=j[Gt].atomid,ht=Gt*3;B[ht]=O[Le].r,B[ht+1]=O[Le].g,B[ht+2]=O[Le].b}var W=y.faces;I.faceidx=W.length,k.initTypedArrays();var Y=I.vertexArray,G=I.normalArray,V,Q,xe,ce;for(let Gt=0,mt=W.length;Gt<mt;Gt+=3){var Ne=W[Gt],Pe=W[Gt+1],Fe=W[Gt+2],Me=Ne*3,je=Pe*3,ft=Fe*3;V=new c.Vector3(Y[Me],Y[Me+1],Y[Me+2]),Q=new c.Vector3(Y[je],Y[je+1],Y[je+2]),xe=new c.Vector3(Y[ft],Y[ft+1],Y[ft+2]),xe.subVectors(xe,Q),V.subVectors(V,Q),xe.cross(V),ce=xe,ce.normalize(),G[Me]+=ce.x,G[je]+=ce.x,G[ft]+=ce.x,G[Me+1]+=ce.y,G[je+1]+=ce.y,G[ft+1]+=ce.y,G[Me+2]+=ce.z,G[je+2]+=ce.z,G[ft+2]+=ce.z}I.faceArray=new Uint16Array(W);var jt=new a.Mesh(k,C);return jt}static generateMeshSyncHelper(u,y,C,k,I,O){var D=new M.ProteinSurface;return D.initparm(y,u!==1,O),D.fillvoxels(I,C),D.buildboundary(),(u==M.SurfaceType.SES||u==M.SurfaceType.MS)&&(D.fastdistancemap(),D.boundingatom(!1),D.fillvoxelswaals(I,C)),D.marchingcube(u),D.getFacesAndVertices(k)}static getMatWithStyle(u){let y=null;u.onesided?y=new a.MeshLambertMaterial:y=new a.MeshDoubleLambertMaterial,y.vertexColors=a.Coloring.VertexColors;for(var C in u)C==="color"||C==="map"||u.hasOwnProperty(C)&&(y[C]=u[C]);return u.opacity!==void 0&&(u.opacity===1?y.transparent=!1:y.transparent=!0),y}addMesh(u){var y={geo:u.geometry,mat:u.material,done:!0,finished:!1},C=this.nextSurfID();return this.surfaces[C]=y,C}static shallowCopy(u){var y=[];let C=u.length;for(let k=0;k<C;k++)y[k]=(0,_.extend)({},u[k]);return y}addSurface(u,y={},C={},k,I,O){let D=this.nextSurfID(),X=null,j=this,B=M.SurfaceType.VDW;typeof u=="string"?s.surfaceTypeMap[u.toUpperCase()]!==void 0?B=s.surfaceTypeMap[u]:console.log("Surface type : "+u+" is not recognized"):typeof u=="number"&&(B=u);var $=null,H=null,q=s.shallowCopy(this.getAtomsFromSel(C));k?$=s.shallowCopy(this.getAtomsFromSel(k)):$=q,(0,_.adjustVolumeStyle)(y);var W=!1,Y;for(Y=0;Y<this.models.length;Y++)if(this.models[Y]){var G=this.models[Y].getSymmetries();if(G.length>1||G.length==1&&!G[0].isIdentity()){W=!0;break}}var V=function(Fe,Me,je){I?H=s.shallowCopy(j.getAtomsFromSel(I)):H=je;var ft,jt=(0,_.getExtent)(je,!0);if(y.map&&y.map.prop){var Gt=y.map.prop;let At=(0,f.getGradient)(y.map.scheme||y.map.gradient||new f.Gradient.RWB),Mt=At.range();Mt||(Mt=(0,_.getPropertyRange)(je,Gt)),y.colorscheme={prop:Gt,gradient:At}}for(let At=0,Mt=Me.length;At<Mt;At++)ft=Me[At],ft.surfaceColor=(0,_.getColorFromStyle)(ft,y);var mt=s.volume(jt),Le=j.carveUpExtent(jt,Me,je);if(H&&H.length&&H.length>0){var ht=(0,_.getExtent)(H,!0),ar=function(At,Mt){var Jr=function(ve,we){var it=ve.extent,rt=it[1][0]-it[0][0],Yt=it[1][1]-it[0][1],Ot=it[1][2]-it[0][2],re=rt-we[2][0];re*=re;var tt=Yt-we[2][1];tt*=tt;var lt=Ot-we[2][2];return lt*=lt,re+tt+lt},qr=Jr(At,ht),ie=Jr(Mt,ht);return qr-ie};Le.sort(ar)}var Jt=[];for(let At=0,Mt=Me.length;At<Mt;At++)ft=Me[At],Jt[At]={x:ft.x,y:ft.y,z:ft.z,serial:At,elem:ft.elem};var Wt=!!M.syncSurface;if(Wt){var Gr=function(At){return new Promise(function(Mt){for(var Jr=s.generateMeshSyncHelper(B,Le[At].extent,Le[At].atoms,Le[At].toshow,Jt,mt),qr=(0,p.splitMesh)({vertexArr:Jr.vertices,faceArr:Jr.faces}),ie=0,ve=qr.length;ie<ve;ie++){Jr={vertices:qr[ie].vertexArr,faces:qr[ie].faceArr};var we=s.generateSurfaceMesh(Me,Jr,X);(0,_.mergeGeos)(Fe.geo,we)}j.render(),Mt()})},Lr=[];for(let At=0;At<Le.length;At++)Lr.push(Gr(At));return Promise.all(Lr).then(function(){return Fe.done=!0,Promise.resolve(D)})}else{var zr=[];B<0&&(B=0);for(let At=0,Mt=s.numWorkers;At<Mt;At++){var Nr=new Worker($3Dmol.SurfaceWorker);zr.push(Nr),Nr.postMessage({type:-1,atoms:Jt,volume:mt})}return new Promise(function(At,Mt){var Jr=0,qr=function(){!zr||!zr.length||zr.forEach(function(it){it&&it.terminate&&it.terminate()})},ie=function(it){for(var rt=(0,p.splitMesh)({vertexArr:it.data.vertices,faceArr:it.data.faces}),Yt=0,Ot=rt.length;Yt<Ot;Yt++){var re={vertices:rt[Yt].vertexArr,faces:rt[Yt].faceArr},tt=s.generateSurfaceMesh(Me,re,X);(0,_.mergeGeos)(Fe.geo,tt)}j.render(),Jr++,Jr==Le.length&&(Fe.done=!0,qr(),At(D))},ve=function(it){qr(),console.log(it.message+" ("+it.filename+":"+it.lineno+")"),Mt(it)};for(let it=0;it<Le.length;it++){var we=zr[it%zr.length];we.onmessage=ie,we.onerror=ve,we.postMessage({type:B,expandedExtent:Le[it].extent,extendedAtoms:Le[it].atoms,atomsToShow:Le[it].toshow})}})}};y=y||{},X=s.getMatWithStyle(y);var Q=[];Q.style=y,Q.atomsel=C,Q.allsel=k,Q.focus=I;var xe=null;if(W){var ce={},Ne={};for(Y=0;Y<this.models.length;Y++)ce[Y]=[],Ne[Y]=[];for(Y=0;Y<$.length;Y++)ce[$[Y].model].push($[Y]);for(Y=0;Y<q.length;Y++)Ne[q[Y].model].push(q[Y]);var Pe=[];for(Y=0;Y<this.models.length;Y++)Ne[Y].length>0&&(Q.push({geo:new a.Geometry(!0),mat:X,done:!1,finished:!1,symmetries:this.models[Y].getSymmetries()}),Pe.push(V(Q[Q.length-1],ce[Y],Ne[Y])));xe=Promise.all(Pe)}else Q.push({geo:new a.Geometry(!0),mat:X,done:!1,finished:!1,symmetries:[new c.Matrix4]}),xe=V(Q[Q.length-1],$,q);return this.surfaces[D]=Q,xe.surfid=D,O&&typeof O=="function"?(xe.then(function(Fe){O(Fe)}),D):xe}setSurfaceMaterialStyle(u,y){if((0,_.adjustVolumeStyle)(y),this.surfaces[u]){var C=this.surfaces[u];C.style=y;for(var k=0;k<C.length;k++){var I=C[k].mat=s.getMatWithStyle(y);if(C[k].mat.side=a.FrontSide,y.color){C[k].mat.color=y.color,C[k].geo.colorsNeedUpdate=!0;const O=h.CC.color(y.color);C[k].geo.setColors(function(){return O})}else if(I.voldata&&I.volscheme){const O=I.volscheme,D=I.voldata,X=h.CC,j=O.range()||[-1,1];C[k].geo.setColors(function(B,$,H){let q=D.getVal(B,$,H);return X.color(O.valueToHex(q,j))})}C[k].finished=!1}}return this}getSurface(u){return this.surfaces[u]}removeSurface(u){for(var y=this.surfaces[u],C=0;C<y.length;C++)y[C]&&y[C].lastGL&&(y[C].geo!==void 0&&y[C].geo.dispose(),y[C].mat!==void 0&&y[C].mat.dispose(),this.modelGroup.remove(y[C].lastGL));return delete this.surfaces[u],this.show(),this}removeAllSurfaces(){for(var u in this.surfaces)if(this.surfaces.hasOwnProperty(u)){for(var y=this.surfaces[u],C=0;C<y.length;C++)y[C]&&y[C].lastGL&&(y[C].geo!==void 0&&y[C].geo.dispose(),y[C].mat!==void 0&&y[C].mat.dispose(),this.modelGroup.remove(y[C].lastGL));delete this.surfaces[u]}return this.show(),this}jmolMoveTo(){var u=this.modelGroup.position,y="center { "+-u.x+" "+-u.y+" "+-u.z+" }; ",C=this.rotationGroup.quaternion;return y+="moveto .5 quaternion { "+C.x+" "+C.y+" "+C.z+" "+C.w+" };",y}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(u,y){y=y||{};var C=this.getAtomsFromSel(y);if(typeof u=="function")for(let O=0,D=C.length;O<D;O++){let X=C[O];u(X)}else for(let O=0,D=C.length;O<D;O++){var k=C[O];for(let X=0,j=u.length;X<j;X++){let B=u[X];if(B.props)for(var I in B.props)B.props.hasOwnProperty(I)&&this.atomIsSelected(k,B)&&(k.properties||(k.properties={}),k.properties[I]=B.props[I])}}return this}linkViewer(u){return this.linkedViewers.push(u),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(u){this.rotationGroup.position.z=this.CAMERA_Z-u}setAutoEyeSeparation(u,y){var C=this.getPerceivedDistance();return y||(y=5),u||this.camera.position.x>0?this.camera.position.x=C*Math.tan(Math.PI/180*y):this.camera.position.x=-C*Math.tan(Math.PI/180*y),this.camera.lookAt(new c.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(u){this.config.cartoonQuality=u}}s.numWorkers=4,s.maxVolume=64e3,s.surfaceTypeMap={VDW:M.SurfaceType.VDW,MS:M.SurfaceType.MS,SAS:M.SurfaceType.SAS,SES:M.SurfaceType.SES};function v(A,u){if(A=(0,_.getElement)(A),!!A){u=u||{};try{var y=new s(A,u);return y}catch(C){throw"error creating viewer: "+C}}}function w(A,u={},y={}){if(A=(0,_.getElement)(A),!!A){var C=[],k=document.createElement("canvas");y.rows=u.rows,y.cols=u.cols,y.control_all=u.control_all!=null?u.control_all:!1,A.appendChild(k);try{for(var I=0;I<u.rows;I++){for(var O=[],D=0;D<u.cols;D++){y.row=I,y.col=D,y.canvas=k,y.viewers=C,y.control_all=u.control_all;var X=v(A,(0,_.extend)({},y));O.push(X)}C.unshift(O)}}catch(j){throw"error creating viewer grid: "+j}return C}}function S(A){var u=this;if(A=(0,_.getElement)(A),!!A){var y=w(A,{rows:1,cols:2,control_all:!0});this.glviewer1=y[0][0],this.glviewer2=y[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var C=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(I){return typeof u.glviewer1[I]=="function"}),k=0;k<C.length;k++)this[C[k]]=(function(I){return function(){var O=this.glviewer1[I].apply(this.glviewer1,arguments),D=this.glviewer2[I].apply(this.glviewer2,arguments);return[O,D]}})(C[k]);this.setCoordinates=function(I,O,D){for(var X=0;X<I.length;X++)I[X].setCoordinates(O,D)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(I){this.glviewer1.render(),this.glviewer2.render(),I&&I(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}}),"./src/Gradient.ts":((e,r,t)=>{t.r(r),t.d(r,{CustomLinear:()=>p,Gradient:()=>M,GradientType:()=>c,ROYGB:()=>g,RWB:()=>f,Sinebow:()=>b,builtinGradients:()=>E,getGradient:()=>_,normalizeValue:()=>h});var a=t("./src/colors.ts");class c{}function h(R,z,l){return z>=R?(l<R&&(l=R),l>z&&(l=z),{lo:R,hi:z,val:l}):(l>R&&(l=R),l<z&&(l=z),l=R-l+z,{lo:z,hi:R,val:l})}function _(R){if(R instanceof c)return R;if(R.gradient!==void 0&&E[R.gradient]){let z=R.min===void 0?-1:R.min,l=R.max===void 0?1:R.max;return R.mid===void 0?R.colors===void 0?new E[R.gradient](z,l):new E[R.gradient](z,l,R.colors):new E[R.gradient](z,l,R.mid)}else if(typeof R.gradient=="string"&&R.gradient.startsWith("linear_")){let z=R.gradient.split("_");z.shift();let l=R.min===void 0?-1:R.min,s=R.max===void 0?1:R.max;return new p(l,s,z)}return R}class f extends c{constructor(z,l,s){super(),this.gradient="RWB",this.mult=1,this.mid=s,this.min=z,this.max=l,typeof l>"u"&&Array.isArray(z)&&z.length>=2?(this.max=z[1],this.min=z[0]):z&&l&&!Array.isArray(z)&&(this.min=z,this.max=l)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(z,l){var s,v;if(z=this.mult*z,l?(s=l[0],v=l[1]):(s=this.min,v=this.max),z===void 0)return 16777215;var w=h(s,v,z);s=w.lo,v=w.hi,z=w.val;var S=(v+s)/2;l&&typeof l[2]<"u"?S=l[2]:typeof this.mid<"u"?S=this.mid:S=(s+v)/2;var A,u;return z<S?(A=Math.floor(255*Math.sqrt((z-s)/(S-s))),u=16711680+256*A+A,u):z>S?(A=Math.floor(255*Math.sqrt(1-(z-S)/(v-S))),u=65536*A+256*A+255,u):16777215}}class g extends c{constructor(z,l){super(),this.gradient="ROYGB",this.mult=1,this.min=z,this.max=l,typeof l>"u"&&Array.isArray(z)&&z.length>=2?(this.max=z[1],this.min=z[0]):z&&l&&!Array.isArray(z)&&(this.min=z,this.max=l)}valueToHex(z,l){var s,v;if(z=this.mult*z,l?(s=l[0],v=l[1]):(s=this.min,v=this.max),typeof z>"u")return 16777215;var w=h(s,v,z);s=w.lo,v=w.hi,z=w.val;var S=(s+v)/2,A=(s+S)/2,u=(S+v)/2,y,C;return z<A?(y=Math.floor(255*Math.sqrt((z-s)/(A-s))),C=16711680+256*y+0,C):z<S?(y=Math.floor(255*Math.sqrt(1-(z-A)/(S-A))),C=65536*y+65280+0,C):z<u?(y=Math.floor(255*Math.sqrt((z-S)/(u-S))),C=65280+1*y,C):(y=Math.floor(255*Math.sqrt(1-(z-u)/(v-u))),C=0+256*y+255,C)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class b extends c{constructor(z,l){super(),this.gradient="Sinebow",this.mult=1,this.min=z,this.max=l,typeof l>"u"&&Array.isArray(z)&&z.length>=2&&(this.max=z[1],this.min=z[0]),l<z&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(z,l){var s,v;if(z=this.mult*z,l?(s=l[0],v=l[1]):(s=this.min,v=this.max),typeof z>"u")return 16777215;var w=M.normalizeValue(s,v,z);s=w.lo,v=w.hi,z=w.val;var S=(z-s)/(v-s),A=5*S/6+.5,u=Math.sin(Math.PI*A);u*=u*255;var y=Math.sin(Math.PI*(A+1/3));y*=y*255;var C=Math.sin(Math.PI*(A+2/3));return C*=C*255,65536*Math.floor(u)+256*Math.floor(C)+1*Math.floor(y)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class p extends c{constructor(z,l,s){super(),this.gradient="linear",this.colors=new Array;var v;if(Array.isArray(z)&&z.length>=2?(this.max=z[1],this.min=z[0],v=l):(this.min=z,this.max=l,v=s),v)for(let w of v)this.colors.push(a.CC.color(w));else this.colors.push(a.CC.color(0))}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(z,l){var s,v;if(l?(s=l[0],v=l[1]):(s=this.min,v=this.max),z===void 0)return 16777215;var w=h(s,v,z);s=w.lo,v=w.hi,z=w.val;let S=this.colors.length,A=(v-s)/S,u=Math.min(Math.floor((z-s)/A),S-1),y=Math.min(u+1,S-1),C=(z-s-u*A)/A,k=this.colors[u],I=this.colors[y];return new a.Color(k.r+C*(I.r-k.r),k.g+C*(I.g-k.g),k.b+C*(I.b-k.b)).getHex()}}const E={rwb:f,RWB:f,roygb:g,ROYGB:g,sinebow:b,linear:p};class M extends c{valueToHex(z,l){return 0}range(){return null}}M.RWB=f,M.ROYGB=g,M.Sinebow=b,M.CustomLinear=p,M.builtinGradients=E,M.normalizeValue=h,M.getGradient=_}),"./src/Label.ts":((e,r,t)=>{t.r(r),t.d(r,{Label:()=>b,LabelCount:()=>_});var a=t("./src/WebGL/index.ts"),c=t("./src/Gradient.ts"),h=t("./src/colors.ts");let _=0;function f(p,E,M,R,z,l,s){p.beginPath(),p.moveTo(E+l,M),p.lineTo(E+R-l,M),p.quadraticCurveTo(E+R,M,E+R,M+l),p.lineTo(E+R,M+z-l),p.quadraticCurveTo(E+R,M+z,E+R-l,M+z),p.lineTo(E+l,M+z),p.quadraticCurveTo(E,M+z,E,M+z-l),p.lineTo(E,M+l),p.quadraticCurveTo(E,M,E+l,M),p.closePath(),p.fill(),s&&p.stroke()}function g(p,E,M){var R=M;return typeof p<"u"&&(p instanceof h.Color?R=p.scaled():(R=h.CC.color(p),typeof R.scaled<"u"&&(R=R.scaled()))),typeof E<"u"&&(R.a=parseFloat(E)),R}class b{constructor(E,M){this.id=_++,this.stylespec=M||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new a.Sprite,this.text=E,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}setContext(){var E=this.stylespec,M=typeof E.useScreen>"u"?!1:E.useScreen,R=E.showBackground;(R==="0"||R==="false")&&(R=!1),typeof R>"u"&&(R=!0);var z=E.font?E.font:"sans-serif",l=parseInt(E.fontSize)?parseInt(E.fontSize):18,s=g(E.fontColor,E.fontOpacity,{r:255,g:255,b:255,a:1}),v=E.padding?E.padding:4,w=E.borderThickness?E.borderThickness:0,S=g(E.backgroundColor,E.backgroundOpacity,{r:0,g:0,b:0,a:1}),A=g(E.borderColor,E.borderOpacity,S),u=E.position?E.position:{x:-10,y:1,z:1},y=E.inFront!==void 0?E.inFront:!0;(y==="false"||y==="0")&&(y=!1);var C=E.alignment||a.SpriteAlignment.topLeft;typeof C=="string"&&C in a.SpriteAlignment&&(C=a.SpriteAlignment[C]);var k="";E.bold&&(k="bold "),this.context.font=k+l+"px  "+z;var I=this.context.measureText(this.text),O=I.width;R||(w=0);var D=O+2.5*w+2*v,X=l*1.25+2*w+2*v;if(E.backgroundImage){var j=E.backgroundImage,B=E.backgroundWidth?E.backgroundWidth:j.width,$=E.backgroundHeight?E.backgroundHeight:j.height;B>D&&(D=B),$>X&&(X=$)}if(this.canvas.width=D,this.canvas.height=X,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),k="",E.bold&&(k="bold "),this.context.font=k+l+"px  "+z,this.context.fillStyle="rgba("+S.r+","+S.g+","+S.b+","+S.a+")",this.context.strokeStyle="rgba("+A.r+","+A.g+","+A.b+","+A.a+")",E.backgroundGradient){let q=this.context.createLinearGradient(0,X/2,D,X/2),W=c.Gradient.getGradient(E.backgroundGradient),Y=W.range(),G=-1,V=1;Y&&(G=Y[0],V=Y[1]);let Q=V-G;for(let xe=0;xe<1.01;xe+=.1){let ce=g(W.valueToHex(G+Q*xe)),Ne="rgba("+ce.r+","+ce.g+","+ce.b+","+ce.a+")";q.addColorStop(xe,Ne)}this.context.fillStyle=q}this.context.lineWidth=w,R&&f(this.context,w,w,D-2*w,X-2*w,6,w>0),E.backgroundImage&&this.context.drawImage(j,0,0,D,X),this.context.fillStyle="rgba("+s.r+","+s.g+","+s.b+","+s.a+")",this.context.fillText(this.text,w+v,l+w+v,O);var H=new a.Texture(this.canvas);H.needsUpdate=!0,this.sprite.material=new a.SpriteMaterial({map:H,useScreenCoordinates:M,alignment:C,depthTest:!y,screenOffset:E.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(u.x,u.y,u.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}}),"./src/ProteinSurface4.ts":((e,r,t)=>{t.r(r),t.d(r,{MarchingCube:()=>g,MarchingCubeInitializer:()=>f,PointGrid:()=>b,ProteinSurface:()=>p,SurfaceType:()=>c,setSyncSurface:()=>_,syncSurface:()=>h});var a=t("./src/WebGL/math/index.ts"),c;(function(E){E[E.VDW=1]="VDW",E[E.MS=2]="MS",E[E.SAS=3]="SAS",E[E.SES=4]="SES"})(c||(c={}));var h=!1;function _(E){h=E}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&(h=!0);class f{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(M,R,z,l){let s=!!l.fulltable,v=l.hasOwnProperty("origin")&&l.origin.hasOwnProperty("x")?l.origin:{x:0,y:0,z:0},w=!!l.voxel,S=l.matrix,A=l.nX||0,u=l.nY||0,y=l.nZ||0,C=l.scale||1,k=null;l.unitCube?k=l.unitCube:k={x:C,y:C,z:C};let I=new Int32Array(A*u*y),O,D;for(O=0,D=I.length;O<D;++O)I[O]=-1;let X=function(H,q,W,Y,G,V){let Q={x:0,y:0,z:0},xe=!!(Y&1<<G),ce=!!(Y&1<<V),Ne=G;if(!xe&&ce&&(Ne=V),Ne&1&&W++,Ne&2&&q++,Ne&4&&H++,S){let Fe=new a.Vector3(H,q,W);Fe=Fe.applyMatrix4(S),Q={x:Fe.x,y:Fe.y,z:Fe.z}}else Q.x=v.x+k.x*H,Q.y=v.y+k.y*q,Q.z=v.z+k.z*W;let Pe=(u*H+q)*y+W;return w?(R.push(Q),R.length-1):(I[Pe]<0&&(I[Pe]=R.length,R.push(Q)),I[Pe])},j=new Int32Array(12),B=s?this.edgeTable2:this.edgeTable,$=s?this.triTable2:this.triTable;for(O=0;O<A-1;++O)for(let H=0;H<u-1;++H)for(let q=0;q<y-1;++q){let W=0;for(let V=0;V<8;++V){let Q=(u*(O+((V&4)>>2))+H+((V&2)>>1))*y+q+(V&1),xe=!!(M[Q]&this.ISDONE);W|=xe<<V}if(W===0||W===255)continue;let Y=B[W];if(Y===0)continue;let G=$[W];Y&1&&(j[0]=X(O,H,q,W,0,1)),Y&2&&(j[1]=X(O,H,q,W,1,3)),Y&4&&(j[2]=X(O,H,q,W,3,2)),Y&8&&(j[3]=X(O,H,q,W,2,0)),Y&16&&(j[4]=X(O,H,q,W,4,5)),Y&32&&(j[5]=X(O,H,q,W,5,7)),Y&64&&(j[6]=X(O,H,q,W,7,6)),Y&128&&(j[7]=X(O,H,q,W,6,4)),Y&256&&(j[8]=X(O,H,q,W,0,4)),Y&512&&(j[9]=X(O,H,q,W,1,5)),Y&1024&&(j[10]=X(O,H,q,W,3,7)),Y&2048&&(j[11]=X(O,H,q,W,2,6));for(let V=0;V<G.length;V+=3){let Q=j[G[V]],xe=j[G[V+1]],ce=j[G[V+2]];w&&V>=3&&(R.push(R[Q]),Q=R.length-1,R.push(R[xe]),xe=R.length-1,R.push(R[ce]),ce=R.length-1),z.push(Q),z.push(xe),z.push(ce)}}}laplacianSmooth(M,R,z){let l=new Array(R.length),s,v,w,S,A;for(s=0,v=R.length;s<v;s++)l[s]={x:0,y:0,z:0};let u=new Array(20),y;for(s=0;s<20;s++)u[s]=new Array(R.length);for(s=0,v=R.length;s<v;s++)u[0][s]=0;for(s=0,v=z.length/3;s<v;s++){let I=s*3,O=s*3+1,D=s*3+2;for(y=!0,w=0,S=u[0][z[I]];w<S;w++)if(z[O]==u[w+1][z[I]]){y=!1;break}for(y&&(u[0][z[I]]++,u[u[0][z[I]]][z[I]]=z[O]),y=!0,w=0,S=u[0][z[I]];w<S;w++)if(z[D]==u[w+1][z[I]]){y=!1;break}for(y&&(u[0][z[I]]++,u[u[0][z[I]]][z[I]]=z[D]),y=!0,w=0,S=u[0][z[O]];w<S;w++)if(z[I]==u[w+1][z[O]]){y=!1;break}for(y&&(u[0][z[O]]++,u[u[0][z[O]]][z[O]]=z[I]),y=!0,w=0,S=u[0][z[O]];w<S;w++)if(z[D]==u[w+1][z[O]]){y=!1;break}for(y&&(u[0][z[O]]++,u[u[0][z[O]]][z[O]]=z[D]),y=!0,w=0;w<u[0][z[D]];w++)if(z[I]==u[w+1][z[D]]){y=!1;break}for(y&&(u[0][z[D]]++,u[u[0][z[D]]][z[D]]=z[I]),y=!0,w=0,S=u[0][z[D]];w<S;w++)if(z[O]==u[w+1][z[D]]){y=!1;break}y&&(u[0][z[D]]++,u[u[0][z[D]]][z[D]]=z[O])}let C=1,k=.5;for(A=0;A<M;A++){for(s=0,v=R.length;s<v;s++)if(u[0][s]<3)l[s].x=R[s].x,l[s].y=R[s].y,l[s].z=R[s].z;else if(u[0][s]==3||u[0][s]==4){for(l[s].x=0,l[s].y=0,l[s].z=0,w=0,S=u[0][s];w<S;w++)l[s].x+=R[u[w+1][s]].x,l[s].y+=R[u[w+1][s]].y,l[s].z+=R[u[w+1][s]].z;l[s].x+=k*R[s].x,l[s].y+=k*R[s].y,l[s].z+=k*R[s].z,l[s].x/=k+u[0][s],l[s].y/=k+u[0][s],l[s].z/=k+u[0][s]}else{for(l[s].x=0,l[s].y=0,l[s].z=0,w=0,S=u[0][s];w<S;w++)l[s].x+=R[u[w+1][s]].x,l[s].y+=R[u[w+1][s]].y,l[s].z+=R[u[w+1][s]].z;l[s].x+=C*R[s].x,l[s].y+=C*R[s].y,l[s].z+=C*R[s].z,l[s].x/=C+u[0][s],l[s].y/=C+u[0][s],l[s].z/=C+u[0][s]}for(s=0,v=R.length;s<v;s++)R[s].x=l[s].x,R[s].y=l[s].y,R[s].z=l[s].z}}}let g=new f;class b{constructor(M,R,z){this.data=new Int32Array(M*R*z*3),this.width=R,this.height=z}set(M,R,z,l){let s=((M*this.width+R)*this.height+z)*3;this.data[s]=l.ix,this.data[s+1]=l.iy,this.data[s+2]=l.iz}get(M,R,z){let l=((M*this.width+R)*this.height+z)*3;return{ix:this.data[l],iy:this.data[l+1],iz:this.data[l+2]}}}class p{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],p.MarchingCube||(p.MarchingCube=new f)}getVDWIndex(M){return!M.elem||typeof this.vdwRadii[M.elem]>"u"?"X":M.elem}getFacesAndVertices(M){let R={};for(let s=0,v=M.length;s<v;s++)R[M[s]]=!0;let z=this.verts;for(let s=0,v=z.length;s<v;s++)z[s].x=z[s].x/this.scaleFactor-this.ptranx,z[s].y=z[s].y/this.scaleFactor-this.ptrany,z[s].z=z[s].z/this.scaleFactor-this.ptranz;let l=[];for(let s=0,v=this.faces.length;s<v;s+=3){let w=this.faces[s],S=this.faces[s+1],A=this.faces[s+2],u=z[w].atomid,y=z[S].atomid,C=z[A].atomid,k=u;y<k&&(k=y),C<k&&(k=C),R[k]&&w!==S&&S!==A&&w!==A&&(l.push(w),l.push(S),l.push(A))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:z,faces:l}}initparm(M,R,z){z>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let l=1/this.scaleFactor*5.5;this.pminx=M[0][0],this.pmaxx=M[1][0],this.pminy=M[0][1],this.pmaxy=M[1][1],this.pminz=M[0][2],this.pmaxz=M[1][2],R?(this.pminx-=this.probeRadius+l,this.pminy-=this.probeRadius+l,this.pminz-=this.probeRadius+l,this.pmaxx+=this.probeRadius+l,this.pmaxy+=this.probeRadius+l,this.pmaxz+=this.probeRadius+l):(this.pminx-=l,this.pminy-=l,this.pminz-=l,this.pmaxx+=l,this.pmaxy+=l,this.pmaxz+=l),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(R),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(M){let R={};for(const z in this.vdwRadii){let l=this.vdwRadii[z];M?R[z]=(l+this.probeRadius)*this.scaleFactor+.5:R[z]=l*this.scaleFactor+.5;let s=R[z]*R[z];this.widxz[z]=Math.floor(R[z])+1,this.depty[z]=new Int32Array(this.widxz[z]*this.widxz[z]);let v=0;for(let w=0;w<this.widxz[z];w++)for(let S=0;S<this.widxz[z];S++){let A=w*w+S*S;if(A>s)this.depty[z][v]=-1;else{let u=Math.sqrt(s-A);this.depty[z][v]=Math.floor(u)}v++}}}fillvoxels(M,R){for(let z=0,l=this.vpBits.length;z<l;z++)this.vpBits[z]=0,this.vpDistance[z]=-1,this.vpAtomID[z]=-1;for(let z in R){let l=M[R[z]];l!==void 0&&this.fillAtom(l,M)}for(let z=0,l=this.vpBits.length;z<l;z++)this.vpBits[z]&this.INOUT&&(this.vpBits[z]|=this.ISDONE)}fillAtom(M,R){let z=Math.floor(.5+this.scaleFactor*(M.x+this.ptranx)),l=Math.floor(.5+this.scaleFactor*(M.y+this.ptrany)),s=Math.floor(.5+this.scaleFactor*(M.z+this.ptranz)),v=this.getVDWIndex(M),w=0,S=this.pWidth*this.pHeight;for(let A=0,u=this.widxz[v];A<u;A++)for(let y=0;y<u;y++){if(this.depty[v][w]!=-1){for(let C=-1;C<2;C++)for(let k=-1;k<2;k++)for(let I=-1;I<2;I++)if(C!==0&&k!==0&&I!==0){let O=C*A,D=I*y;for(let X=0;X<=this.depty[v][w];X++){let j=X*k,B=z+O,$=l+j,H=s+D;if(B<0||$<0||H<0||B>=this.pLength||$>=this.pWidth||H>=this.pHeight)continue;let q=B*S+$*this.pHeight+H;if(!(this.vpBits[q]&this.INOUT))this.vpBits[q]|=this.INOUT,this.vpAtomID[q]=M.serial;else{let W=R[this.vpAtomID[q]];if(W.serial!=M.serial){let Y=z+O-Math.floor(.5+this.scaleFactor*(W.x+this.ptranx)),G=l+j-Math.floor(.5+this.scaleFactor*(W.y+this.ptrany)),V=s+D-Math.floor(.5+this.scaleFactor*(W.z+this.ptranz));O*O+j*j+D*D<Y*Y+G*G+V*V&&(this.vpAtomID[q]=M.serial)}}}}}w++}}fillvoxelswaals(M,R){for(let z=0,l=this.vpBits.length;z<l;z++)this.vpBits[z]&=~this.ISDONE;for(let z in R){let l=M[R[z]];l!==void 0&&this.fillAtomWaals(l,M)}}fillAtomWaals(M,R){let z=0,l=Math.floor(.5+this.scaleFactor*(M.x+this.ptranx)),s=Math.floor(.5+this.scaleFactor*(M.y+this.ptrany)),v=Math.floor(.5+this.scaleFactor*(M.z+this.ptranz)),w=this.getVDWIndex(M),S=this.pWidth*this.pHeight;for(let A=0,u=this.widxz[w];A<u;A++)for(let y=0;y<u;y++){if(this.depty[w][z]!=-1){for(let C=-1;C<2;C++)for(let k=-1;k<2;k++)for(let I=-1;I<2;I++)if(C!==0&&k!==0&&I!==0){let O=C*A,D=I*y;for(let X=0;X<=this.depty[w][z];X++){let j=X*k,B=l+O,$=s+j,H=v+D;if(B<0||$<0||H<0||B>=this.pLength||$>=this.pWidth||H>=this.pHeight)continue;let q=B*S+$*this.pHeight+H;if(!(this.vpBits[q]&this.ISDONE))this.vpBits[q]|=this.ISDONE,this.vpAtomID[q]=M.serial;else{let W=R[this.vpAtomID[q]];if(W.serial!=M.serial){let Y=l+O-Math.floor(.5+this.scaleFactor*(W.x+this.ptranx)),G=s+j-Math.floor(.5+this.scaleFactor*(W.y+this.ptrany)),V=v+D-Math.floor(.5+this.scaleFactor*(W.z+this.ptranz));O*O+j*j+D*D<Y*Y+G*G+V*V&&(this.vpAtomID[q]=M.serial)}}}}}z++}}buildboundary(){let M=this.pWidth*this.pHeight;for(let R=0;R<this.pLength;R++)for(let z=0;z<this.pHeight;z++)for(let l=0;l<this.pWidth;l++){let s=R*M+l*this.pHeight+z;if(this.vpBits[s]&this.INOUT){let v=0;for(;v<26;){let w=R+this.nb[v][0],S=z+this.nb[v][2],A=l+this.nb[v][1];if(w>-1&&w<this.pLength&&A>-1&&A<this.pWidth&&S>-1&&S<this.pHeight&&!(this.vpBits[w*M+A*this.pHeight+S]&this.INOUT)){this.vpBits[s]|=this.ISBOUND;break}else v++}}}}fastdistancemap(){let M=new b(this.pLength,this.pWidth,this.pHeight),R=this.pWidth*this.pHeight,z=this.cutRadius*this.cutRadius,l=[],s=[],v;for(let A=0;A<this.pLength;A++)for(let u=0;u<this.pWidth;u++)for(let y=0;y<this.pHeight;y++)if(v=A*R+u*this.pHeight+y,this.vpBits[v]&=~this.ISDONE,this.vpBits[v]&this.INOUT&&this.vpBits[v]&this.ISBOUND){let C={ix:A,iy:u,iz:y};M.set(A,u,y,C),l.push(C),this.vpDistance[v]=0,this.vpBits[v]|=this.ISDONE,this.vpBits[v]&=~this.ISBOUND}do{s=this.fastoneshell(l,M),l=[];for(let A=0,u=s.length;A<u;A++)v=R*s[A].ix+this.pHeight*s[A].iy+s[A].iz,this.vpBits[v]&=~this.ISBOUND,this.vpDistance[v]<=1.0404*z&&l.push({ix:s[A].ix,iy:s[A].iy,iz:s[A].iz})}while(l.length!==0);l=[],s=[],M=null;let w=this.scaleFactor-.5;w<0&&(w=0);let S=z-.5/(.1+w);for(let A=0;A<this.pLength;A++)for(let u=0;u<this.pWidth;u++)for(let y=0;y<this.pHeight;y++)v=A*R+u*this.pHeight+y,this.vpBits[v]&=~this.ISBOUND,this.vpBits[v]&this.INOUT&&(!(this.vpBits[v]&this.ISDONE)||this.vpBits[v]&this.ISDONE&&this.vpDistance[v]>=S)&&(this.vpBits[v]|=this.ISBOUND)}fastoneshell(M,R){let z,l,s,v,w,S,A,u,y,C=[];if(M.length===0)return C;let k={ix:-1,iy:-1,iz:-1},I=this.pWidth*this.pHeight;for(let O=0,D=M.length;O<D;O++){z=M[O].ix,l=M[O].iy,s=M[O].iz,u=R.get(z,l,s);for(let X=0;X<6;X++)k.ix=z+this.nb[X][0],k.iy=l+this.nb[X][1],k.iz=s+this.nb[X][2],k.ix<this.pLength&&k.ix>-1&&k.iy<this.pWidth&&k.iy>-1&&k.iz<this.pHeight&&k.iz>-1&&(y=k.ix*I+this.pHeight*k.iy+k.iz,this.vpBits[y]&this.INOUT&&!(this.vpBits[y]&this.ISDONE)?(R.set(k.ix,k.iy,s+this.nb[X][2],u),v=k.ix-u.ix,w=k.iy-u.iy,S=k.iz-u.iz,A=v*v+w*w+S*S,this.vpDistance[y]=A,this.vpBits[y]|=this.ISDONE,this.vpBits[y]|=this.ISBOUND,C.push({ix:k.ix,iy:k.iy,iz:k.iz})):this.vpBits[y]&this.INOUT&&this.vpBits[y]&this.ISDONE&&(v=k.ix-u.ix,w=k.iy-u.iy,S=k.iz-u.iz,A=v*v+w*w+S*S,A<this.vpDistance[y]&&(R.set(k.ix,k.iy,k.iz,u),this.vpDistance[y]=A,this.vpBits[y]&this.ISBOUND||(this.vpBits[y]|=this.ISBOUND,C.push({ix:k.ix,iy:k.iy,iz:k.iz})))))}for(let O=0,D=M.length;O<D;O++){z=M[O].ix,l=M[O].iy,s=M[O].iz,u=R.get(z,l,s);for(let X=6;X<18;X++)k.ix=z+this.nb[X][0],k.iy=l+this.nb[X][1],k.iz=s+this.nb[X][2],k.ix<this.pLength&&k.ix>-1&&k.iy<this.pWidth&&k.iy>-1&&k.iz<this.pHeight&&k.iz>-1&&(y=k.ix*I+this.pHeight*k.iy+k.iz,this.vpBits[y]&this.INOUT&&!(this.vpBits[y]&this.ISDONE)?(R.set(k.ix,k.iy,s+this.nb[X][2],u),v=k.ix-u.ix,w=k.iy-u.iy,S=k.iz-u.iz,A=v*v+w*w+S*S,this.vpDistance[y]=A,this.vpBits[y]|=this.ISDONE,this.vpBits[y]|=this.ISBOUND,C.push({ix:k.ix,iy:k.iy,iz:k.iz})):this.vpBits[y]&this.INOUT&&this.vpBits[y]&this.ISDONE&&(v=k.ix-u.ix,w=k.iy-u.iy,S=k.iz-u.iz,A=v*v+w*w+S*S,A<this.vpDistance[y]&&(R.set(k.ix,k.iy,k.iz,u),this.vpDistance[y]=A,this.vpBits[y]&this.ISBOUND||(this.vpBits[y]|=this.ISBOUND,C.push({ix:k.ix,iy:k.iy,iz:k.iz})))))}for(let O=0,D=M.length;O<D;O++){z=M[O].ix,l=M[O].iy,s=M[O].iz,u=R.get(z,l,s);for(let X=18;X<26;X++)k.ix=z+this.nb[X][0],k.iy=l+this.nb[X][1],k.iz=s+this.nb[X][2],k.ix<this.pLength&&k.ix>-1&&k.iy<this.pWidth&&k.iy>-1&&k.iz<this.pHeight&&k.iz>-1&&(y=k.ix*I+this.pHeight*k.iy+k.iz,this.vpBits[y]&this.INOUT&&!(this.vpBits[y]&this.ISDONE)?(R.set(k.ix,k.iy,s+this.nb[X][2],u),v=k.ix-u.ix,w=k.iy-u.iy,S=k.iz-u.iz,A=v*v+w*w+S*S,this.vpDistance[y]=A,this.vpBits[y]|=this.ISDONE,this.vpBits[y]|=this.ISBOUND,C.push({ix:k.ix,iy:k.iy,iz:k.iz})):this.vpBits[y]&this.INOUT&&this.vpBits[y]&this.ISDONE&&(v=k.ix-u.ix,w=k.iy-u.iy,S=k.iz-u.iz,A=v*v+w*w+S*S,A<this.vpDistance[y]&&(R.set(k.ix,k.iy,k.iz,u),this.vpDistance[y]=A,this.vpBits[y]&this.ISBOUND||(this.vpBits[y]|=this.ISBOUND,C.push({ix:k.ix,iy:k.iy,iz:k.iz})))))}return C}marchingcubeinit(M){for(let R=0,z=this.vpBits.length;R<z;R++)M==1?this.vpBits[R]&=~this.ISBOUND:M==4?(this.vpBits[R]&=~this.ISDONE,this.vpBits[R]&this.ISBOUND&&(this.vpBits[R]|=this.ISDONE),this.vpBits[R]&=~this.ISBOUND):M==2?this.vpBits[R]&this.ISBOUND&&this.vpBits[R]&this.ISDONE?this.vpBits[R]&=~this.ISBOUND:this.vpBits[R]&this.ISBOUND&&!(this.vpBits[R]&this.ISDONE)&&(this.vpBits[R]|=this.ISDONE):M==3&&(this.vpBits[R]&=~this.ISBOUND)}marchingcube(M){this.marchingcubeinit(M),this.verts=[],this.faces=[],p.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let R=this.pWidth*this.pHeight;for(let z=0,l=this.verts.length;z<l;z++)this.verts[z].atomid=this.vpAtomID[this.verts[z].x*R+this.pHeight*this.verts[z].y+this.verts[z].z];p.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}p.MarchingCube=new f}),"./src/VolumeData.ts":((e,r,t)=>{t.r(r),t.d(r,{VolumeData:()=>g});var a=t("./src/utilities.ts"),c=t("./src/WebGL/math/index.ts"),h=t("./src/parsers/VASP.ts"),_=t("./src/parsers/CUBE.ts"),f=t("./node_modules/pako/dist/pako.esm.mjs");class g{constructor(p,E,M){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(v){var w=v/(this.size.y*this.size.z),S=v%(this.size.y*this.size.z),A=v%this.size.z;return w*=this.unit.x,S*=this.unit.y,A*=this.unit.z,w+=this.origin.x,S+=this.origin.y,A+=this.origin.z,{x:w,y:S,z:A}},this.vasp=function(v){var w=v.replace(/^\s+/,"").split(/[\n\r]/),S=(0,h.VASP)(v)[0],A=S.length;if(A==0){console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),this.data=[];return}var u=1.889725992,y=.036749309,C=parseFloat(w[1]),k;k=w[2].replace(/^\s+/,"").split(/\s+/);var I=new c.Vector3(parseFloat(k[0]),parseFloat(k[1]),parseFloat(k[2])).multiplyScalar(C*u);k=w[3].replace(/^\s+/,"").split(/\s+/);var O=new c.Vector3(parseFloat(k[0]),parseFloat(k[1]),parseFloat(k[2])).multiplyScalar(C*u);k=w[4].replace(/^\s+/,"").split(/\s+/);var D=new c.Vector3(parseFloat(k[0]),parseFloat(k[1]),parseFloat(k[2])).multiplyScalar(C*u),X=I.x*(O.y*D.z-D.y*O.z)-O.x*(I.y*D.z-D.y*I.z)+D.x*(I.y*O.z-O.y*I.z);X=Math.abs(X)/Math.pow(u,3);var j=1/X;w.splice(0,8+A+1);var B=w[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),$=Math.abs(parseFloat(B[0])),H=Math.abs(parseFloat(B[1])),q=Math.abs(parseFloat(B[2])),W=this.origin=new c.Vector3(0,0,0);this.size={x:$,y:H,z:q},this.unit=new c.Vector3(I.x,O.y,D.z),I=I.multiplyScalar(1/(u*$)),O=O.multiplyScalar(1/(u*H)),D=D.multiplyScalar(1/(u*q)),(I.y!=0||I.z!=0||O.x!=0||O.z!=0||D.x!=0||D.y!=0)&&(this.matrix=new c.Matrix4(I.x,O.x,D.x,0,I.y,O.y,D.y,0,I.z,O.z,D.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new c.Matrix4().makeTranslation(W.x,W.y,W.z)),this.origin=new c.Vector3(0,0,0),this.unit=new c.Vector3(1,1,1)),w.splice(0,1);var Y=w.join(" ");Y=Y.replace(/^\s+/,"");var G=Y.split(/[\s\r]+/);G.splice($*H*q+1);for(var V=Float32Array.from(G,parseFloat),Q=0;Q<V.length;Q++)V[Q]=V[Q]*j*y;this.data=V},this.dx=function(v){var w=v.split(/[\n\r]+/),S,A=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,u=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,y=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,C=/data follows/,k=0;for(k=0;k<w.length;k++){var I=w[k];if(S=A.exec(I)){var O=parseInt(S[1]),D=parseInt(S[2]),X=parseInt(S[3]);this.size={x:O,y:D,z:X}}else if(S=y.exec(I)){var j=parseFloat(S[1]);if((parseFloat(S[2])!=0||parseFloat(S[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),k+=1,I=w[k],S=y.exec(I),S==null){console.error("Parse error in dx delta matrix");return}var B=parseFloat(S[2]);if((parseFloat(S[1])!=0||parseFloat(S[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),k+=1,I=w[k],S=y.exec(I),S==null){console.error("Parse error in dx delta matrix");return}var $=parseFloat(S[3]);(parseFloat(S[1])!=0||parseFloat(S[2])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new c.Vector3(j,B,$)}else if(S=u.exec(I)){var H=parseFloat(S[1]),q=parseFloat(S[2]),W=parseFloat(S[3]);this.origin=new c.Vector3(H,q,W)}else if(S=C.exec(I))break}if(k+=1,!this.size||!this.origin||!this.unit||!this.size){console.error("Error parsing dx format");return}var Y=w.splice(k).join(" "),G=Y.split(/[\s\r]+/);this.data=Float32Array.from(G,parseFloat)},E=E.toLowerCase(),/\.gz$/.test(E)){E=E.replace(/\.gz$/,"");try{this[E]&&this.isbinary.has(E)?(typeof p=="string"&&(p=(0,a.base64ToArray)(p)),p=(0,f.inflate)(p)):p=new TextDecoder("utf-8").decode((0,f.inflate)(p))}catch(v){console.error(v)}}if(this[E]&&(this.isbinary.has(E)&&typeof p=="string"&&(p=(0,a.base64ToArray)(p)),this[E](p)),M){if(M.negate)for(let v=0,w=this.data.length;v<w;v++)this.data[v]=-this.data[v];if(M.normalize){var R=0;for(let v=0,w=this.data.length;v<w;v++)R+=this.data[v];var z=R/this.data.length;R=0;for(let v=0,w=this.data.length;v<w;v++){var l=this.data[v]-z;R+=l*l}var s=R/this.data.length;for(let v=0,w=this.data.length;v<w;v++)this.data[v]=(this.data[v]-z)/s}}}getIndex(p,E,M){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new c.Matrix4().getInverse(this.matrix));var R=new c.Vector3(p,E,M);R=R.applyMatrix4(this.inversematrix),p=R.x,E=R.y,M=R.z}else p-=this.origin.x,E-=this.origin.y,M-=this.origin.z,p/=this.unit.x,E/=this.unit.y,M/=this.unit.z;return p=Math.round(p),E=Math.round(E),M=Math.round(M),p<0||p>=this.size.x||E<0||E>=this.size.y||M<0||M>=this.size.z?-1:p*this.size.y*this.size.z+E*this.size.z+M}getVal(p,E,M){let R=this.getIndex(p,E,M);return R<0?0:this.data[R]}cube(p){var E=p.split(/\r?\n/);if(!(E.length<6)){var M=(0,_.CUBE)(p,{}).modelData[0].cryst,R=E[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),z=parseFloat(R[0]),l=Math.abs(z);this.origin=M.origin,this.size=M.size,this.unit=M.unit,this.matrix=M.matrix4;var s=6;z<0&&s++;var v=E.splice(l+s).join(" ");v=v.replace(/^\s+/,"");var w=v.split(/[\s\r]+/);this.data=Float32Array.from(w,parseFloat)}}ccp4(p){var E={};p=new Int8Array(p);var M=new Int32Array(p.buffer,0,56),R=new Float32Array(p.buffer,0,56),z=new DataView(p.buffer);if(E.MAP=String.fromCharCode(z.getUint8(208),z.getUint8(209),z.getUint8(210),z.getUint8(211)),E.MACHST=[z.getUint8(212),z.getUint8(213)],E.MACHST[0]===17&&E.MACHST[1]===17)for(var l=p.byteLength,s=0;s<l;s+=4)z.setFloat32(s,z.getFloat32(s),!0);E.NX=M[0],E.NY=M[1],E.NZ=M[2],E.MODE=M[3],E.NXSTART=M[4],E.NYSTART=M[5],E.NZSTART=M[6],E.MX=M[7],E.MY=M[8],E.MZ=M[9],E.xlen=R[10],E.ylen=R[11],E.zlen=R[12],E.alpha=R[13],E.beta=R[14],E.gamma=R[15],E.MAPC=M[16],E.MAPR=M[17],E.MAPS=M[18],E.DMIN=R[19],E.DMAX=R[20],E.DMEAN=R[21],E.ISPG=M[22],E.NSYMBT=M[23],E.LSKFLG=M[24],E.originX=R[49],E.originY=R[50],E.originZ=R[51],E.ARMS=R[54];var v=E,w=[v.xlen,0,0],S=[v.ylen*Math.cos(Math.PI/180*v.gamma),v.ylen*Math.sin(Math.PI/180*v.gamma),0],A=[v.zlen*Math.cos(Math.PI/180*v.beta),v.zlen*(Math.cos(Math.PI/180*v.alpha)-Math.cos(Math.PI/180*v.gamma)*Math.cos(Math.PI/180*v.beta))/Math.sin(Math.PI/180*v.gamma),0];A[2]=Math.sqrt(v.zlen*v.zlen*Math.sin(Math.PI/180*v.beta)*Math.sin(Math.PI/180*v.beta)-A[1]*A[1]);var u=[0,w,S,A],y=[0,v.MX,v.MY,v.MZ],C=[0,v.MAPC,v.MAPR,v.MAPS];this.matrix=new c.Matrix4,this.matrix.set(u[C[1]][0]/y[C[1]],u[C[2]][0]/y[C[2]],u[C[3]][0]/y[C[3]],0,u[C[1]][1]/y[C[1]],u[C[2]][1]/y[C[2]],u[C[3]][1]/y[C[3]],0,u[C[1]][2]/y[C[1]],u[C[2]][2]/y[C[2]],u[C[3]][2]/y[C[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new c.Matrix4().makeTranslation(v.NXSTART+v.originX,v.NYSTART+v.originY,v.NZSTART+v.originZ)),this.origin=new c.Vector3(0,0,0),this.unit=new c.Vector3(1,1,1),this.size={x:E.NX,y:E.NY,z:E.NZ},this.dimensionorder=[E.MAPC,E.MAPR,E.MAPS];var k=new Float32Array(p.buffer,1024+E.NSYMBT),I=E.NX,O=E.NY,D=E.NZ;this.data=new Float32Array(I*O*D);for(let X=0;X<I;X++)for(let j=0;j<O;j++)for(let B=0;B<D;B++)this.data[(X*O+j)*D+B]=k[(B*O+j)*I+X]}}}),"./src/VolumetricRender.ts":((e,r,t)=>{t.r(r),t.d(r,{GLVolumetricRender:()=>g});var a=t("./src/WebGL/shapes/index.ts"),c=t("./src/WebGL/math/index.ts"),h=t("./src/WebGL/index.ts"),_=t("./src/colors.ts"),f=t("./src/GLShape.ts");class g{static interpolateArray(p,E){function M(A,u,y){return A+(u-A)*y}var R=[],z=(p.length-1)/(E-1);R[0]=p[0];for(var l=1;l<E-1;l++){var s=l*z,v=Math.floor(s),w=Math.ceil(s),S=s-v;R[l]=M(p[v],p[w],S)}return R[E-1]=p[p.length-1],R}constructor(p,E,M){this.hidden=!1,this.boundingSphere=new a.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,E=E||{};var R=Object.assign([],E.transferfn);this.subsamples=E.subsamples||5;let z=256;R.forEach(function(O){O.value=parseFloat(O.value)}),R.sort(function(O,D){return O.value-D.value}),this.min=R[0].value,R.length==0&&R.push(R[0]),this.max=R[R.length-1].value;var l,s,v,w,S,A,u,y,C,k;for(let O=0;O<R.length-1;O++)if(v=_.CC.color(R[O].color),w=_.CC.color(R[O+1].color),C=R[O].opacity,k=R[O+1].opacity,l=Math.floor((R[O].value-this.min)*z/(this.max-this.min)),s=Math.floor((R[O+1].value-this.min)*z/(this.max-this.min)),l!=s){S=g.interpolateArray([v.r*255,w.r*255],s-l),A=g.interpolateArray([v.g*255,w.g*255],s-l),u=g.interpolateArray([v.b*255,w.b*255],s-l),y=g.interpolateArray([C*255,k*255],s-l);for(let D=0;D<S.length;D++)this.transferfunctionbuffer.push(S[D]),this.transferfunctionbuffer.push(A[D]),this.transferfunctionbuffer.push(u[D]),this.transferfunctionbuffer.push(y[D])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),p.matrix){let O=new c.Vector3(0,0,0),D=new c.Vector3(p.size.x,p.size.y,p.size.z),X=new c.Vector3(1,1,1);O.applyMatrix4(p.matrix),D.applyMatrix4(p.matrix),X.applyMatrix4(p.matrix).sub(O),this.extent=[[O.x,O.y,O.z],[D.x,D.y,D.z]];for(let H=1;H<7;H++)D.x=H&1?p.size.x:0,D.y=H&2?p.size.y:0,D.z=H&4?p.size.z:0,D.applyMatrix4(p.matrix),this.extent[0][0]=Math.min(this.extent[0][0],D.x),this.extent[0][1]=Math.min(this.extent[0][1],D.y),this.extent[0][2]=Math.min(this.extent[0][2],D.z),this.extent[1][0]=Math.max(this.extent[1][0],D.x),this.extent[1][1]=Math.max(this.extent[1][1],D.y),this.extent[1][2]=Math.max(this.extent[1][2],D.z);let j=D.x-O.x,B=D.y-O.y,$=D.z-O.z;this.maxdepth=Math.sqrt(j*j+B*B+$*$),this.minunit=Math.min(Math.min(X.x,X.y),X.z),this.texmatrix=new c.Matrix4().identity().scale({x:p.size.x,y:p.size.y,z:p.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(p.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new c.Matrix4().identity();let O=p.unit.x*p.size.x,D=p.unit.y*p.size.y,X=p.unit.z*p.size.z;this.texmatrix.makeTranslation(-p.origin.x/O,-p.origin.y/D,-p.origin.z/X),this.texmatrix.scale({x:1/O,y:1/D,z:1/X}),this.minunit=Math.min(Math.min(p.unit.x,p.unit.y),p.unit.z),this.extent=[[p.origin.x,p.origin.y,p.origin.z],[p.origin.x+O,p.origin.y+D,p.origin.z+X]],this.maxdepth=Math.sqrt(O*O+D*D+X*X)}var I=new f.GLShape({});if(I.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=I.finalize(),this.boundingSphere.center=new c.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,E.coords===void 0&&E.selection!==void 0&&(M?E.coords=M.selectedAtoms(E.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),E.coords!==void 0&&E.seldist!==void 0){let O=new Uint8Array(p.data.length),D=E.seldist,X=D*D;for(let j=0,B=E.coords.length;j<B;j++){let $=E.coords[j],H=$.x-D,q=$.y-D,W=$.z-D,Y=$.x+D,G=$.y+D,V=$.z+D;if(p.getIndex(H,q,W)>=0||p.getIndex(Y,G,V)>=0)for(let Q=H;Q<Y;Q+=this.minunit)for(let xe=q;xe<G;xe+=this.minunit)for(let ce=W;ce<V;ce+=this.minunit){let Ne=p.getIndex(Q,xe,ce);Ne>=0&&!O[Ne]&&(Q-$.x)*(Q-$.x)+(xe-$.y)*(xe-$.y)+(ce-$.z)*(ce-$.z)<X&&(O[Ne]=1)}}for(let j=0,B=p.data.length;j<B;j++)O[j]==0&&(p.data[j]=1/0)}this.data=p}globj(p){if(this.renderedShapeObj&&(p.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new h.Object3D;var E=null,M=new h.Texture(this.data,!0),R=new h.Texture(this.transferfunctionbuffer,!1);M.needsUpdate=!0,R.needsUpdate=!0,R.flipY=!1,E=new h.VolumetricMaterial({transferfn:R,transfermin:this.min,transfermax:this.max,map:M,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var z=new h.Mesh(this.geo,E);this.shapeObj.add(z),this.renderedShapeObj=this.shapeObj.clone(),p.add(this.renderedShapeObj)}}removegl(p){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),p.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}}),"./src/WebGL/Camera.ts":((e,r,t)=>{t.r(r),t.d(r,{Camera:()=>h});var a=t("./src/WebGL/core/index.ts"),c=t("./src/WebGL/math/index.ts");class h extends a.Object3D{constructor(f=50,g=1,b=.1,p=2e3,E=!1){super(),this.projectionMatrix=new c.Matrix4,this.projectionMatrixInverse=new c.Matrix4,this.matrixWorldInverse=new c.Matrix4,this.fov=f,this.aspect=g,this.near=b,this.far=p;var M=this.position.z;this.right=M*Math.tan(Math.PI/180*f),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!E,this.updateProjectionMatrix()}lookAt(f){this.matrix.lookAt(this.position,f,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof c.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}}),"./src/WebGL/Fog.ts":((e,r,t)=>{t.r(r),t.d(r,{Fog:()=>c});var a=t("./src/colors.ts");class c{constructor(_,f=1,g=1e3){this.name="",this.color=new a.Color(_),this.near=f,this.far=g}clone(){return new c(this.color.getHex(),this.near,this.far)}}}),"./src/WebGL/Renderer.ts":((e,r,t)=>{t.r(r),t.d(r,{Renderer:()=>R});var a=t("./src/WebGL/Camera.ts"),c=t("./src/WebGL/constants/Sides.ts"),h=t("./src/WebGL/constants/TextureConstants.ts"),_=t("./src/WebGL/core/index.ts"),f=t("./src/colors.ts"),g=t("./src/WebGL/materials/index.ts"),b=t("./src/WebGL/math/index.ts"),p=t("./src/WebGL/objects/index.ts"),E=t("./src/WebGL/shaders/index.ts"),M=t("./src/WebGL/SpritePlugin.ts");class R{constructor(l){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new b.Vector3,this._worldInverse=new b.Matrix4,this._projInverse=new b.Matrix4,this._textureMatrix=new b.Matrix4,this._fullProjModelMatrix=new b.Matrix4,this._fullProjModelMatrixInv=new b.Matrix4,this._direction=new b.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new M.SpritePlugin,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,l=l||{},this.row=l.row,this.col=l.col,this.rows=l.rows,this.cols=l.cols,this._canvas=l.canvas!==void 0?l.canvas:document.createElement("canvas"),this._precision=l.precision!==void 0?l.precision:"highp",this._alpha=l.alpha!==void 0?l.alpha:!0,this._premultipliedAlpha=l.premultipliedAlpha!==void 0?l.premultipliedAlpha:!0,this._antialias=l.antialias!==void 0?l.antialias:!1,this._preserveDrawingBuffer=l.preserveDrawingBuffer!==void 0?l.preserveDrawingBuffer:!1,this._clearColor=l.clearColor!==void 0?new f.Color(l.clearColor):new f.Color(0),this._clearAlpha=l.clearAlpha!==void 0?l.clearAlpha:0,this._outlineMaterial=new g.MeshOutlineMaterial(l.outline),this._outlineSphereImposterMaterial=new g.SphereImposterOutlineMaterial(l.outline),this._outlineStickImposterMaterial=new g.StickImposterOutlineMaterial(l.outline),this._outlineEnabled=!!l.outline,this._AOEnabled=!!l.ambientOcclusion,l.ambientOcclusion&&typeof l.ambientOcclusion.strength<"u"&&(this._AOstrength=parseFloat(l.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),l.ambientOcclusion&&typeof l.ambientOcclusion.radius<"u"&&(this._AOradius=parseFloat(l.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=l.id,!(l.containerWidth==0||l.containerHeight==0)&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(l,s){this._clearColor.setHex(l),this._clearAlpha=s,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(l){this._outlineMaterial=new g.MeshOutlineMaterial(l),this._outlineSphereImposterMaterial=new g.SphereImposterOutlineMaterial(l),this._outlineStickImposterMaterial=new g.StickImposterOutlineMaterial(l),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(l){l&&(l.strength&&(this._AOstrength=l.strength),l.scale&&(this._AOradius=l.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var l=this._canvas.width/this.cols,s=this._canvas.height/this.rows;this._viewportWidth=l,this._viewportHeight=s,this.isLost()||(this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(l*this.col,s*this.row,l,s),this._gl.viewport(l*this.col,s*this.row,l,s))}}setSize(l,s){if(this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._antialias&&this.devicePixelRatio<2&&(this.devicePixelRatio*=2),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var v=l/this.cols,w=s/this.rows;this._canvas.width=l*this.devicePixelRatio,this._canvas.height=s*this.devicePixelRatio,this._viewportWidth=v*this.devicePixelRatio,this._viewportHeight=w*this.devicePixelRatio,this._canvas.style.width=l+"px",this._canvas.style.height=s+"px",this.setViewport()}else this._viewportWidth=this._canvas.width=l*this.devicePixelRatio,this._viewportHeight=this._canvas.height=s*this.devicePixelRatio,this._canvas.style.width=l+"px",this._canvas.style.height=s+"px",this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight);this.initFrameBuffer()}clear(l,s,v){var w=0;(l===void 0||l)&&(w|=this._gl.COLOR_BUFFER_BIT),(s===void 0||s)&&(w|=this._gl.DEPTH_BUFFER_BIT),(v===void 0||v)&&(w|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(w)}setMaterialFaces(l,s){var v=l.side===c.DoubleSide,w=l.side===c.BackSide;l.imposter||(w=s?!w:w),this._oldDoubleSided!==v&&(v?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=v),this._oldFlipSided!==w&&(w?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=w),this._gl.cullFace(this._gl.BACK)}setDepthTest(l){this._oldDepthTest!==l&&(l?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=l)}setDepthWrite(l){this._oldDepthWrite!==l&&(this._gl.depthMask(l),this._oldDepthWrite=l)}setBlending(l){l?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(l,s,v,w){l.addEventListener("dispose",this.onMaterialDispose.bind(this));var S,A;if(A=l.shaderID,A){var u=E.ShaderLib[A];l.vertexShader=u.vertexShader,l.fragmentShader=u.fragmentShader,l.uniforms=E.ShaderUtils.clone(u.uniforms),l.shaded&&l.makeShaded(this.SHADE_TEXTURE)}S={wireframe:l.wireframe,fragdepth:l.imposter,volumetric:l.volumetric,shaded:l.shaded},l.program=this.buildProgram(l.fragmentShader,l.vertexShader,l.uniforms,S)}renderBuffer(l,s,v,w,S,A){if(w.visible){var u,y;if(u=this.setProgram(l,s,v,w,A,this),!!u){y=u.attributes;var C=!1,k=w.wireframe?1:0,I=S.id*16777215+u.id*2+k;I!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=I,C=!0),C&&(this.disableAttributes(),y.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglVertexBuffer),this.enableAttribute(y.position),this._gl.vertexAttribPointer(y.position,3,this._gl.FLOAT,!1,0,0)),y.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglColorBuffer),this.enableAttribute(y.color),this._gl.vertexAttribPointer(y.color,3,this._gl.FLOAT,!1,0,0)),y.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglNormalBuffer),this.enableAttribute(y.normal),this._gl.vertexAttribPointer(y.normal,3,this._gl.FLOAT,!1,0,0)),y.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglOffsetBuffer),this.enableAttribute(y.offset),this._gl.vertexAttribPointer(y.offset,3,this._gl.FLOAT,!1,0,0)),y.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglRadiusBuffer),this.enableAttribute(y.radius),this._gl.vertexAttribPointer(y.radius,1,this._gl.FLOAT,!1,0,0)));var O,D;if(A instanceof p.Mesh){if(w.shaderID==="instanced"){var X=w.sphere.geometryGroups[0];C&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,X.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,S.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,X.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,S.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,X.faceArray,this._gl.STATIC_DRAW)),O=X.faceidx,this._extInstanced.vertexAttribDivisorANGLE(y.offset,1),this._extInstanced.vertexAttribDivisorANGLE(y.radius,1),this._extInstanced.vertexAttribDivisorANGLE(y.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,O,this._gl.UNSIGNED_SHORT,0,S.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(y.offset,0),this._extInstanced.vertexAttribDivisorANGLE(y.radius,0),this._extInstanced.vertexAttribDivisorANGLE(y.color,0)}else w.wireframe?(D=S.lineidx,this.setLineWidth(w.wireframeLinewidth),C&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,S.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,D,this._gl.UNSIGNED_SHORT,0)):(O=S.faceidx,C&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,S.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,O,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=O,this.info.render.faces+=O/3}else A instanceof p.Line&&(D=S.vertices,this.setLineWidth(w.linewidth),this._gl.drawArrays(this._gl.LINES,0,D),this.info.render.calls++)}}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(l,s,v){let w=l.__lights,S=l.fog,A=[];for(let C=0,k=l.__webglObjects.length;C<k;C++){let I=l.__webglObjects[C];I.render&&I[v]&&A.push(I)}if(A.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(l.__webglObjects,!0,v+"Depth",s,w,S,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let u=this._AOshader.uniforms;this._gl.uniform1f(u.total_strength,this._AOstrength),this._gl.uniform1f(u.radius,this._AOradius),this._fullProjModelMatrix=new b.Matrix4,this._fullProjModelMatrixInv=new b.Matrix4;let y=A[0].object;this._fullProjModelMatrix.multiplyMatrices(s.projectionMatrix,y._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(u.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(u.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(l,s){if(!(s instanceof a.Camera)){console.error("Renderer.render: camera is not an instance of Camera.");return}var v,w,S,A,u,y=l.__lights,C=l.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&l.updateMatrixWorld(),s.parent===void 0&&s.updateMatrixWorld(),s.matrixWorldInverse.getInverse(s.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(l),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),u=l.__webglObjects;let k=!1,I=this._AOEnabled;for(v=0,w=u.length;v<w;v++)S=u[v],A=S.object,S.render=!1,A.visible&&(this.setupMatrices(A,s),this.unrollBufferMaterial(S),S.render=!0,S.volumetric&&(k=!0),S.hasAO&&(I=!0));this.setBlending(!1),I&&this.setShading(l,s,"opaque"),this.renderObjects(l.__webglObjects,!0,"opaque",s,y,C,!1),I&&this.clearShading(),this.renderSprites(l,s,!1),this.renderObjects(l.__webglObjects,!0,"transparentDepth",s,y,C,!0),this.renderObjects(l.__webglObjects,!1,"transparent",s,y,C,!0),k&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(l.__webglObjects,!1,"volumetric",s,y,C,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(l,s,!0)}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let l=this._viewportWidth,s=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,l,s),this._gl.viewport(0,0,l,s),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,l,s,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,l,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,l,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,l,s,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let l=this._viewportWidth,s=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,l,s),this._gl.viewport(0,0,l,s),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var v=this._antialias?E.ShaderLib.screenaa:E.ShaderLib.screen;this._screenshader=this.buildProgram(v.fragmentShader,v.vertexShader,v.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition");var w=[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1];this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(w),this._gl.STATIC_DRAW);let S=E.ShaderLib.ssao;this._AOshader=this.buildProgram(S.fragmentShader,S.vertexShader,S.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let A=E.ShaderLib.blur;this._blurshader=this.buildProgram(A.fragmentShader,A.vertexShader,A.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(l){if(l.__webglObjects||(l.__webglObjects=[],l.__webglObjectsImmediate=[],l.__webglSprites=[],l.__webglFlares=[]),l.__objectsAdded.length){for(;l.__objectsAdded.length;)this.addObject(l.__objectsAdded[0],l),l.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;l.__objectsRemoved.length;)this.removeObject(l.__objectsRemoved[0],l),l.__objectsRemoved.splice(0,1);for(var s=0,v=l.__webglObjects.length;s<v;s++)this.updateObject(l.__webglObjects[s].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(l,s){(l==null||s==null)&&(l=this._canvas.width,s=this._canvas.height);var v=l/s;if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var w=l/this.cols,S=s/this.rows;v=w/S}return v}setTexture(l,s,v){if(l.needsUpdate){l.__webglInit||(l.__webglInit=!0,l.addEventListener("dispose",this.onTextureDispose.bind(this)),l.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+s);var w=v?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(w,l.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,l.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,l.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,l.unpackAlignment);var S=this.paramToGL(l.format),A=this.paramToGL(l.type);if(v)this.setTextureParameters(this._gl.TEXTURE_3D,l),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,l.image.size.z,l.image.size.y,l.image.size.x,0,this._gl.RED,this._gl.FLOAT,l.image.data);else{var u=l.image,y=u.width,C=u.height;typeof y>"u"&&(y=u.length,S==this._gl.RGBA&&(y/=4),C=1),this.setTextureParameters(this._gl.TEXTURE_2D,l),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,S,S,A,l.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,S,y,C,0,S,A,l.image)}l.needsUpdate=!1,l.onUpdate&&l.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+s),v?this._gl.bindTexture(this._gl.TEXTURE_3D,l.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,l.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(l){this._enabledAttributes[l]||(this._gl.enableVertexAttribArray(l),this._enabledAttributes[l]=!0)}disableAttributes(){for(let l in this._enabledAttributes)this._enabledAttributes[l]&&(this._gl.disableVertexAttribArray(l),this._enabledAttributes[l]=!1)}setPolygonOffset(l,s,v){this._oldPolygonOffset!==l&&(l?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(l){l!==this._oldLineWidth&&(this._gl.lineWidth(l),this._oldLineWidth=l)}deallocateGeometry(l){if(l.__webglInit=void 0,l.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(l.__webglVertexBuffer),l.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(l.__webglColorBuffer),l.geometryGroups!==void 0)for(var s=0,v=l.groups;s<v;s++){var w=l.geometryGroups[s];w.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(w.__webglVertexBuffer),w.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(w.__webglColorBuffer),w.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(w.__webglNormalBuffer),w.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(w.__webglFaceBuffer),w.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(w.__webglLineBuffer)}}deallocateMaterial(l){var s=l.program;if(s!==void 0){l.program=void 0;var v,w,S,A=!1;for(v=0,w=this._programs.length;v<w;v++)if(S=this._programs[v],S.program===s){S.usedTimes--,S.usedTimes===0&&(A=!0);break}if(A===!0){var u=[];for(v=0,w=this._programs.length;v<w;v++)S=this._programs[v],S.program!==s&&u.push(S);this._programs=u,this._gl.deleteProgram(s),this.info.memory.programs--}}}deallocateTexture(l){if(l.image&&l.image.__webglTextureCube)this._gl.deleteTexture(l.image.__webglTextureCube);else{if(!l.__webglInit)return;l.__webglInit=!1,this._gl.deleteTexture(l.__webglTexture)}}onGeometryDispose(l){var s=l.target;s.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(s),this.info.memory.geometries--}onTextureDispose(l){var s=l.target;s.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(s),this.info.memory.textures--}onMaterialDispose(l){var s=l.target;s.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(s)}getShader(l,s){var v;return!this.isWebGL1()&&!s.startsWith("#version")&&(s=s.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),l=="fragment"?s=s.replace(/varying/g,"in"):s=s.replace(/varying/g,"out"),s=s.replace(/attribute/g,"in"),s=s.replace(/texture2D/g,"texture"),s=s.replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;"),s=s.replace(/gl_FragColor/g,"glFragColor"),s=`#version 300 es
`+s),l==="fragment"?v=this._gl.createShader(this._gl.FRAGMENT_SHADER):l==="vertex"&&(v=this._gl.createShader(this._gl.VERTEX_SHADER)),v==null?null:(this._gl.shaderSource(v,s),this._gl.compileShader(v),this._gl.getShaderParameter(v,this._gl.COMPILE_STATUS)?v:(console.error(this._gl.getShaderInfoLog(v)),console.error("could not initialize shader"),null))}buildProgram(l,s,v,w){var S,A,u,y,C=[];C.push(l),C.push(s);for(S in w)C.push(S),C.push(w[S]);for(y=C.join(),S=0,A=this._programs.length;S<A;S++){var k=this._programs[S];if(k.code===y)return k.usedTimes++,k.program}if(this.isWebGL1()&&w.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if(u=this._gl.createProgram(),u==null)return null;var I=this._precision,O="precision "+I+" float;",D=[w.volumetric?"#version 300 es":"",O].join(`
`),X=[w.volumetric?"#version 300 es":"",w.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",w.shaded?"#define SHADED 1":"",w.wireframe?"#define WIREFRAME 1":"",O].join(`
`),j=this.getShader("fragment",X+l),B=this.getShader("vertex",D+s);B!=null&&this._gl.attachShader(u,B),j!=null&&this._gl.attachShader(u,j),this._gl.linkProgram(u),this._gl.getProgramParameter(u,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),u.uniforms={},u.attributes={};var $,H,q;$=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix"];for(H in v)$.push(H);for(q=0;q<$.length;q++){var W=$[q];u.uniforms[W]=this._gl.getUniformLocation(u,W)}for($=["position","normal","color","lineDistance","offset","radius"],q=0;q<$.length;q++){var Y=$[q];u.attributes[Y]=this._gl.getAttribLocation(u,Y)}return u.id=this._programs_counter++,this._programs.push({program:u,code:y,usedTimes:1}),this.info.memory.programs=this._programs.length,u}setProgram(l,s,v,w,S,A){if(w.needsUpdate&&(w.program&&this.deallocateMaterial(w),this.initMaterial(w,s,v,S),w.needsUpdate=!1),w.program==null)return null;var u=!1,y=w.program,C=y.uniforms,k=w.uniforms;if(y!=this._currentProgram&&(this._gl.useProgram(y),this._currentProgram=y,u=!0),w.id!=this._currentMaterialId&&(this._currentMaterialId=w.id,u=!0),l!=this._currentCamera&&(this._currentCamera=l,u=!0),C.projectionMatrix&&this._gl.uniformMatrix4fv(C.projectionMatrix,!1,l.projectionMatrix.elements),C.modelViewMatrix&&this._gl.uniformMatrix4fv(C.modelViewMatrix,!1,S._modelViewMatrix.elements),C.normalMatrix&&this._gl.uniformMatrix3fv(C.normalMatrix,!1,S._normalMatrix.elements),C.projinv&&(this._projInverse.getInverse(l.projectionMatrix),this._gl.uniformMatrix4fv(C.projinv,!1,this._projInverse.elements)),C.viewMatrix&&this._gl.uniformMatrix4fv(C.viewMatrix,!1,l.matrixWorldInverse.elements),u){if(k.fogColor.value=v.color,k.fogNear.value=v.near,k.fogFar.value=v.far,w.shaderID.startsWith("lambert")||w.shaderID==="instanced"||w.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(y,s),this._lightsNeedUpdate=!1),k.directionalLightColor.value=this._lights.directional.colors,k.directionalLightDirection.value=this._lights.directional.positions;else if(w.shaderID.endsWith("outline"))k.outlineColor.value=w.outlineColor,k.outlineWidth.value=w.outlineWidth,k.outlinePushback.value=w.outlinePushback;else if(w.shaderID==="volumetric"){S._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(S._modelViewMatrix),this._projInverse.getInverse(l.projectionMatrix),this._textureMatrix.multiplyMatrices(S.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(C.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(C.projinv,!1,this._projInverse.elements);let I=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);k.step.value=S.material.unit*I,k.maxdepth.value=S.material.maxdepth*I,k.transfermax.value=S.material.transfermax,k.transfermin.value=S.material.transfermin,k.subsamples.value=S.material.subsamples,A.setTexture(S.material.transferfn,4,!1),A.setTexture(S.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}k.opacity.value=w.opacity,this.loadMaterialUniforms(C,k)}return k.shading&&(k.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),y}loadMaterialUniforms(l,s){var v,w,S,A;for(v in s)l[v]&&(w=s[v].type,S=s[v].value,A=l[v],w==="f"?this._gl.uniform1f(A,S):w==="i"?this._gl.uniform1i(A,S):w==="fv"?this._gl.uniform3fv(A,S):w==="c"?this._gl.uniform3f(A,S.r,S.g,S.b):w==="f4"&&this._gl.uniform4f(A,S[0],S[1],S[2],S[3]))}addObject(l,s){var v,w,S,A;if(!l.__webglInit&&(l.__webglInit=!0,l._modelViewMatrix=new b.Matrix4,l._normalMatrix=new b.Matrix3,l.geometry!==void 0&&l.geometry.__webglInit===void 0&&(l.geometry.__webglInit=!0,l.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),l instanceof p.Mesh||l instanceof p.Line))for(S=l.geometry,v=0,w=S.geometryGroups.length;v<w;v++)A=S.geometryGroups[v],A.id=this._geometryGroupCounter++,A.__webglVertexBuffer||(l instanceof p.Mesh?(this.createMeshBuffers(A),S.elementsNeedUpdate=!0,S.normalsNeedUpdate=!0):l instanceof p.Line&&this.createLineBuffers(A),S.verticesNeedUpdate=!0,S.colorsNeedUpdate=!0);if(!l.__webglActive){if(l instanceof p.Mesh||l instanceof p.Line)for(S=l.geometry,v=0,w=S.geometryGroups.length;v<w;v++)A=S.geometryGroups[v],this.addBuffer(s.__webglObjects,A,l);else l instanceof p.Sprite&&s.__webglSprites.push(l);l.__webglActive=!0}}updateObject(l){var s=l.geometry,v;if(l instanceof p.Mesh||l instanceof p.Line){for(var w=0,S=s.geometryGroups.length;w<S;w++)v=s.geometryGroups[w],(s.verticesNeedUpdate||s.elementsNeedUpdate||s.colorsNeedUpdate||s.normalsNeedUpdate)&&this.setBuffers(v,this._gl.STATIC_DRAW);s.verticesNeedUpdate=!1,s.elementsNeedUpdate=!1,s.normalsNeedUpdate=!1,s.colorsNeedUpdate=!1,s.buffersNeedUpdate=!1}}removeObject(l,s){l instanceof p.Mesh||l instanceof p.Line?this.removeInstances(s.__webglObjects,l):l instanceof p.Sprite&&this.removeInstancesDirect(s.__webglSprites,l),l.__webglActive=!1}removeInstances(l,s){for(var v=l.length-1;v>=0;--v)l[v].object===s&&l.splice(v,1)}removeInstancesDirect(l,s){for(var v=l.length-1;v>=0;--v)l[v]===s&&l.splice(v,1)}unrollBufferMaterial(l){var s=l.object,v=s.material;if(v.volumetric)l.opaque=null,l.transparent=null,l.volumetric=v;else if(v.transparent){if(l.opaque=null,l.volumetric=null,l.transparent=v,!v.wireframe){let w=v.clone();w.opacity=0,l.transparentDepth=w}}else{if(l.opaque=v,l.transparent=null,l.volumetric=null,!v.wireframe){let w=v.clone();w.opacity=0,l.opaqueDepth=w}v.hasAO&&(l.hasAO=!0),(this._AOEnabled||l.hasAO)&&(l.opaqueShaded=v.clone(),l.opaqueShaded.shaded=!0)}}setBuffers(l,s){var v=l.vertexArray,w=l.colorArray;if(l.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,v,s)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,v,s)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,w,s),l.normalArray&&l.__webglNormalBuffer!==void 0){var S=l.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,S,s)}if(l.radiusArray&&l.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,l.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,l.radiusArray,s)),l.faceArray&&l.__webglFaceBuffer!==void 0){var A=l.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,l.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,A,s)}if(l.lineArray&&l.__webglLineBuffer!==void 0){var u=l.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,l.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,u,s)}}createMeshBuffers(l){l.radiusArray&&(l.__webglRadiusBuffer=this._gl.createBuffer()),l.useOffset&&(l.__webglOffsetBuffer=this._gl.createBuffer()),l.__webglVertexBuffer=this._gl.createBuffer(),l.__webglNormalBuffer=this._gl.createBuffer(),l.__webglColorBuffer=this._gl.createBuffer(),l.__webglFaceBuffer=this._gl.createBuffer(),l.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(l){l.__webglVertexBuffer=this._gl.createBuffer(),l.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(l,s,v){l.push({buffer:s,object:v,opaque:null,transparent:null})}setupMatrices(l,s){l._modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,l.matrixWorld),l._normalMatrix.getInverse(l._modelViewMatrix),l._normalMatrix.transpose()}filterFallback(l){return this._gl.LINEAR}setTextureParameters(l,s){l==this._gl.TEXTURE_2D?(this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(s.magFilter)),this._gl.texParameteri(l,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(s.minFilter))):(this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(l,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(l,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(l,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(l,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(l,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(l){return l===h.UnsignedByteType?this._gl.UNSIGNED_BYTE:l===h.RGBAFormat?this._gl.RGBA:l===h.NearestFilter?this._gl.NEAREST:0}setupLights(l,s){var v,w,S,A=0,u=0,y=0,C,k,I=this._lights,O=I.directional.colors,D=I.directional.positions,X=0,j=0;for(v=0,w=s.length;v<w;v++)if(S=s[v],C=S.color,k=S.intensity,S instanceof _.Light){if(this._direction.getPositionFromMatrix(S.matrixWorld),this._vector3.getPositionFromMatrix(S.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;D[j]=this._direction.x,D[j+1]=this._direction.y,D[j+2]=this._direction.z,O[j]=C.r*k,O[j+1]=C.g*k,O[j+2]=C.b*k,j+=3,X++}I.ambient[0]=A,I.ambient[1]=u,I.ambient[2]=y,I.directional.length=X}initGL(){try{if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context.";var l=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(l[6])}catch(s){console.error(s)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearColor(0,0,0,1),this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(l,s,v,w,S,A,u){var y,C,k,I,O,D,X;s?(O=l.length-1,D=-1,X=-1):(O=0,D=l.length,X=1);for(var j=O;j!==D;j+=X)if(y=l[j],y.render){if(C=y.object,k=y.buffer,I=y[v],(y.hasAO||this._AOEnabled)&&y[v+"Shaded"]&&(I=y[v+"Shaded"]),!I)continue;u&&this.setBlending(!0),this.setDepthTest(I.depthTest),this.setDepthWrite(I.depthWrite),this.setPolygonOffset(I.polygonOffset,I.polygonOffsetFactor,I.polygonOffsetUnits);var B=C._modelViewMatrix.isReflected();if(this.setMaterialFaces(I,B),this.renderBuffer(w,S,A,I,k,C),(this._outlineEnabled||I.outline)&&!I.wireframe&&I.shaderID!=="basic"&&I.opacity!==0){let $=this._outlineMaterial;I.shaderID=="sphereimposter"?$=this._outlineSphereImposterMaterial:I.shaderID=="stickimposter"&&($=this._outlineStickImposterMaterial),this.renderBuffer(w,S,A,$,k,C)}}}renderSprites(l,s,v){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(l,s,this._currentWidth,this._currentHeight,v),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}}),"./src/WebGL/SpritePlugin.ts":((e,r,t)=>{t.r(r),t.d(r,{SpritePlugin:()=>c});var a=t("./src/WebGL/shaders/index.ts");class c{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(f){this.gl=f.context,this.renderer=f,this.precision=f.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var g=0;this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=-1,this.sprite.vertices[g++]=1,this.sprite.vertices[g++]=0,this.sprite.vertices[g++]=1,g=0,this.sprite.faces[g++]=0,this.sprite.faces[g++]=1,this.sprite.faces[g++]=2,this.sprite.faces[g++]=0,this.sprite.faces[g++]=2,this.sprite.faces[g++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(a.ShaderLib.sprite,this.precision||1),this.sprite.attributes={};const b={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),b.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),b.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),b.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),b.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),b.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),b.color=this.gl.getUniformLocation(this.sprite.program,"color"),b.map=this.gl.getUniformLocation(this.sprite.program,"map"),b.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),b.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),b.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),b.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),b.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),b.fogType=this.gl.getUniformLocation(this.sprite.program,"fogType"),b.fogDensity=this.gl.getUniformLocation(this.sprite.program,"fogDensity"),b.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),b.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),b.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),b.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=b}render(f,g,b,p,E){var M,R,z,l,s,v,w,S,A,u;if(!this.gl)throw new Error("WebGLRenderer not initialized");let y=[];(M=f?.__webglSprites)===null||M===void 0||M.forEach(xe=>{(E&&xe.material.depthTest==!1||!E&&xe.material.depthTest)&&y.push(xe)});let C=y.length;if(!C)return;const k=this.sprite.attributes,I=this.sprite.uniforms;if(!I)throw new Error("Uniforms not defined");var O=b*.5,D=p*.5;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(k.position),this.gl.enableVertexAttribArray(k.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(k.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(k.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(I.projectionMatrix,!1,g.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(I.map,0);var X=0,j=0,B=f.fog;B?(this.gl.uniform3f(I.fogColor,B.color.r,B.color.g,B.color.b),this.gl.uniform1f(I.fogNear,B.near),this.gl.uniform1f(I.fogFar,B.far),this.gl.uniform1i(I.fogType,1),X=1,j=1):(this.gl.uniform1i(I.fogType,0),X=0,j=0);var $;let H,q,W,Y,G=[];for($=0;$<C;$++)H=y[$],q=H.material,q&&(q.depthTest==!1&&!E||!H.visible||q.opacity===0||(q.useScreenCoordinates?H.z=-H.position.z:(H._modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,H.matrixWorld),H.z=-H._modelViewMatrix.elements[14])));for(y.sort(h),$=0;$<C;$++)if(H=y[$],q=H.material,!!q&&!(!H.visible||q.opacity===0)&&q.map&&q.map.image&&q.map.image.width){this.gl.uniform1f(I?.alphaTest||null,q.alphaTest);var V=q.map.image.width,Q=q.map.image.height;G[0]=V*this.renderer.devicePixelRatio/b,G[1]=Q*this.renderer.devicePixelRatio/p,q.useScreenCoordinates===!0?(this.gl.uniform1i(I.useScreenCoordinates,1),this.gl.uniform3f(I.screenPosition,(H.position.x*this.renderer.devicePixelRatio-O)/O,(D-H.position.y*this.renderer.devicePixelRatio)/D,Math.max(0,Math.min(1,H.position.z)))):(this.gl.uniform1i(I.useScreenCoordinates,0),this.gl.uniformMatrix4fv(I.modelViewMatrix,!1,H._modelViewMatrix.elements)),f.fog&&q.fog?Y=j:Y=0,X!==Y&&(this.gl.uniform1i(I.fogType,Y),X=Y),W=1/(q.scaleByViewport?p:1),G[0]*=W*H.scale.x,G[1]*=W*H.scale.y;let xe=(R=q?.alignment)===null||R===void 0?void 0:R.x,ce=(z=q?.alignment)===null||z===void 0?void 0:z.y;q.screenOffset&&(xe=(xe||0)+2*q.screenOffset.x/V,ce=(ce||0)+2*q.screenOffset.y/Q),this.gl.uniform2f(I.uvScale,((l=q?.uvScale)===null||l===void 0?void 0:l.x)||1,((s=q?.uvScale)===null||s===void 0?void 0:s.y)||1),this.gl.uniform2f(I.uvOffset,((v=q?.uvOffset)===null||v===void 0?void 0:v.x)||0,((w=q?.uvOffset)===null||w===void 0?void 0:w.y)||0),this.gl.uniform2f(I.alignment,xe||0,ce||0),this.gl.uniform1f(I.opacity,q.opacity),this.gl.uniform3f(I.color,((S=q?.color)===null||S===void 0?void 0:S.r)||0,((A=q?.color)===null||A===void 0?void 0:A.g)||0,((u=q?.color)===null||u===void 0?void 0:u.b)||0),this.gl.uniform1f(I.rotation,H.rotation),this.gl.uniform2fv(I.scale,G),this.renderer.setDepthTest(q.depthTest),this.renderer.setDepthWrite(q.depthWrite),this.renderer.setTexture(q.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(f,g){if(!this.gl)throw new Error("WebGL Rendering context not found");var b=this.gl.createProgram();if(!b)throw new Error("Error creating webgl program");var p=this.gl.createShader(this.gl.FRAGMENT_SHADER),E=this.gl.createShader(this.gl.VERTEX_SHADER);if(!p)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!E)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var M="precision "+g+` float;
`;if(this.gl.shaderSource(p,M+f.fragmentShader),this.gl.shaderSource(E,M+f.vertexShader),this.gl.compileShader(p),this.gl.compileShader(E),!this.gl.getShaderParameter(p,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(E,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(p)} 
      ${this.gl.getShaderInfoLog(E)}`);return this.gl.attachShader(b,p),this.gl.attachShader(b,E),this.gl.linkProgram(b),this.gl.getProgramParameter(b,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),b}}function h(_,f){return _.z!==f.z?f.z-_.z:f.id-_.id}}),"./src/WebGL/constants/Coloring.ts":((e,r,t)=>{t.r(r),t.d(r,{Coloring:()=>a});var a;(function(c){c[c.NoColors=0]="NoColors",c[c.FaceColors=1]="FaceColors",c[c.VertexColors=2]="VertexColors"})(a||(a={}))}),"./src/WebGL/constants/Shading.ts":((e,r,t)=>{t.r(r),t.d(r,{Shading:()=>a});var a;(function(c){c[c.NoShading=0]="NoShading",c[c.FlatShading=1]="FlatShading",c[c.SmoothShading=2]="SmoothShading"})(a||(a={}))}),"./src/WebGL/constants/Sides.ts":((e,r,t)=>{t.r(r),t.d(r,{BackSide:()=>c,DoubleSide:()=>h,FrontSide:()=>a});const a=0,c=1,h=2}),"./src/WebGL/constants/SpriteAlignment.ts":((e,r,t)=>{t.r(r),t.d(r,{SpriteAlignment:()=>c});var a=t("./src/WebGL/math/index.ts");const c={topLeft:new a.Vector2(1,-1),topCenter:new a.Vector2(0,-1),topRight:new a.Vector2(-1,-1),centerLeft:new a.Vector2(1,0),center:new a.Vector2(0,0),centerRight:new a.Vector2(-1,0),bottomLeft:new a.Vector2(1,1),bottomCenter:new a.Vector2(0,1),bottomRight:new a.Vector2(-1,1)}}),"./src/WebGL/constants/TextureConstants.ts":((e,r,t)=>{t.r(r),t.d(r,{ClampToEdgeWrapping:()=>a,FloatType:()=>g,LinearFilter:()=>c,LinearMipMapLinearFilter:()=>_,NearestFilter:()=>h,R32Format:()=>E,RFormat:()=>p,RGBAFormat:()=>b,UnsignedByteType:()=>f});const a=1001,c=1006,h=1007,_=1008,f=1009,g=1010,b=1021,p=1022,E=1023}),"./src/WebGL/constants/TextureOperations.ts":((e,r,t)=>{t.r(r),t.d(r,{TextureOperations:()=>a});var a;(function(c){c[c.MultiplyOperation=0]="MultiplyOperation",c[c.MixOperation=1]="MixOperation",c[c.AddOperation=2]="AddOperation"})(a||(a={}))}),"./src/WebGL/constants/index.ts":((e,r,t)=>{t.r(r),t.d(r,{BackSide:()=>c.BackSide,ClampToEdgeWrapping:()=>f.ClampToEdgeWrapping,Coloring:()=>a.Coloring,DoubleSide:()=>c.DoubleSide,FloatType:()=>f.FloatType,FrontSide:()=>c.FrontSide,LinearFilter:()=>f.LinearFilter,LinearMipMapLinearFilter:()=>f.LinearMipMapLinearFilter,NearestFilter:()=>f.NearestFilter,R32Format:()=>f.R32Format,RFormat:()=>f.RFormat,RGBAFormat:()=>f.RGBAFormat,Shading:()=>h.Shading,SpriteAlignment:()=>_.SpriteAlignment,TextureOperations:()=>g.TextureOperations,UnsignedByteType:()=>f.UnsignedByteType});var a=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Sides.ts"),h=t("./src/WebGL/constants/Shading.ts"),_=t("./src/WebGL/constants/SpriteAlignment.ts"),f=t("./src/WebGL/constants/TextureConstants.ts"),g=t("./src/WebGL/constants/TextureOperations.ts")}),"./src/WebGL/core/EventDispatcher.ts":((e,r,t)=>{t.r(r),t.d(r,{EventDispatcher:()=>a});class a{constructor(){this.listeners={}}dispatchEvent(h){var _=this.listeners[h.type];if(_!==void 0){h.target=this;for(var f=0,g=_.length;f<g;f++)_[f].call(this,h)}}removeEventListener(h,_){if(!_)this.listeners[h]=[];else{var f=this.listeners[h].indexOf(_);f!==-1&&this.listeners[h].splice(f,1)}}addEventListener(h,_){this.listeners[h]===void 0&&(this.listeners[h]=[]),this.listeners[h].indexOf(_)===-1&&this.listeners[h].push(_)}}}),"./src/WebGL/core/Geometry.ts":((e,r,t)=>{t.r(r),t.d(r,{Geometry:()=>b,GeometryGroup:()=>g,GeometryIDCount:()=>p});var a=t("./src/WebGL/materials/LineBasicMaterial.ts"),c=t("./src/WebGL/core/EventDispatcher.ts"),h=t("./src/WebGL/math/index.ts"),_=t("./src/colors.ts");const f=65535;class g{constructor(M=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=M}setColors(M){var R=this.vertexArray,z=this.colorArray;if(!R)throw new Error("vertex array not initialized");if(!z)throw new Error("color array not initialized");if(R.length!=z.length){console.log("Cannot re-color geometry group due to mismatched lengths.");return}for(var l=0;l<R.length;l+=3){var s=M(R[l],R[l+1],R[l+2]);s instanceof _.Color||(s=_.CC.color(s)),z[l]=s.r,z[l+1]=s.g,z[l+2]=s.b}}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var M=new h.Vector3,R,z,l,s,v=0;v<this.vertices;++v)R=v*3,z=this.vertexArray[R],l=this.vertexArray[R+1],s=this.vertexArray[R+2],M.x+=z,M.y+=l,M.z+=s;return M.divideScalar(this.vertices),M}setNormals(){var M=this.faceArray,R=this.vertexArray,z=this.normalArray;if(!(!this.vertices||!this.faceidx)){if(!M)throw new Error("face array not initialized");if(!R)throw new Error("vertex array not initialized");if(!z)throw new Error("normal array not initialized");for(var l,s,v,w,S,A,u,y=0;y<M.length/3;++y)l=M[y*3]*3,s=M[y*3+1]*3,v=M[y*3+2]*3,w=new h.Vector3(R[l],R[l+1],R[l+2]),S=new h.Vector3(R[s],R[s+1],R[s+2]),A=new h.Vector3(R[v],R[v+1],R[v+2]),w.subVectors(w,S),A.subVectors(A,S),A.cross(w),u=A,u.normalize(),z[l]+=u.x,z[s]+=u.x,z[v]+=u.x,z[l+1]+=u.y,z[s+1]+=u.y,z[v+1]+=u.y,z[l+2]+=u.z,z[s+2]+=u.z,z[v+2]+=u.z}}setLineIndices(){if(this.faceidx&&!(this.lineArray&&this.lineArray.length==this.faceidx*2&&this.lineidx==this.faceidx*2)){var M=this.faceArray,R=this.lineArray=new Uint16Array(this.faceidx*2);if(this.lineidx=this.faceidx*2,!M)throw new Error("face array not initialized");for(var z=0;z<this.faceidx/3;++z){var l=z*3,s=l*2,v=M[l],w=M[l+1],S=M[l+2];R[s]=v,R[s+1]=w,R[s+2]=v,R[s+3]=S,R[s+4]=w,R[s+5]=S}}}vrml(M,R){var z,l,s,v,w,S,A,u,y,C,k,I,O,D,X,j,B,$,H="";if(H+=M+`Shape {
`+M+` appearance Appearance {
`+M+`  material Material {
`+M+"   diffuseColor "+((z=R?.color)===null||z===void 0?void 0:z.r)+" "+((l=R?.color)===null||l===void 0?void 0:l.g)+" "+((s=R?.color)===null||s===void 0?void 0:s.b)+`
`,R.wireframe&&this.colorArray){let W=this.colorArray;H+=M+"    emissiveColor "+W[0]+" "+W[1]+" "+W[2]+`
`}R!=null&&R.transparent&&(H+=M+"   transparency "+(1-R.opacity)+`
`),H+=M+`  }
`,H+=M+` }
`;var q=M;if(M+=" ",R instanceof a.LineBasicMaterial||R.wireframe){H+=M+`geometry IndexedLineSet {
`+M+` colorPerVertex TRUE
`+M+` coord Coordinate {
`+M+`  point [
`;let W,Y,G;for(let V=0;V<this.vertices;++V){let Q=V*3;W=(v=this.vertexArray)===null||v===void 0?void 0:v[Q],Y=(w=this.vertexArray)===null||w===void 0?void 0:w[Q+1],G=(S=this.vertexArray)===null||S===void 0?void 0:S[Q+2],H+=M+"   "+W+" "+Y+" "+G+`,
`}if(H+=M+`  ]
`,H+=M+` }
`,this.colorArray&&!R.wireframe){H+=M+` color Color {
`+M+`  color [
`;for(let V=0;V<this.vertices;++V){let Q=V*3;W=this.colorArray[Q],Y=this.colorArray[Q+1],G=this.colorArray[Q+2],H+=M+"   "+W+" "+Y+" "+G+`,
`}H+=M+`  ]
`,H+=M+` }
`}if(H+=M+` coordIndex [
`,R.wireframe&&this.faceArray)for(let V=0;V<this.faceidx;V+=3)W=(A=this.faceArray)===null||A===void 0?void 0:A[V],Y=(u=this.faceArray)===null||u===void 0?void 0:u[V+1],G=(y=this.faceArray)===null||y===void 0?void 0:y[V+2],H+=M+"  "+W+", "+Y+", "+G+`, -1,
`;else for(let V=0;V<this.vertices-1;V+=2)H+=M+"  "+V+", "+(V+1)+`, -1,
`;H+=M+` ]
`,H+=M+`}
`}else{H+=M+`geometry IndexedFaceSet {
`+M+` colorPerVertex TRUE
`+M+` normalPerVertex TRUE
`+M+` solid FALSE
`,H+=M+` coord Coordinate {
`+M+`  point [
`;let W,Y,G;for(let V=0;V<this.vertices;++V){let Q=V*3;W=(C=this.vertexArray)===null||C===void 0?void 0:C[Q],Y=(k=this.vertexArray)===null||k===void 0?void 0:k[Q+1],G=(I=this.vertexArray)===null||I===void 0?void 0:I[Q+2],H+=M+"   "+W+" "+Y+" "+G+`,
`}H+=M+`  ]
`,H+=M+` }
`,H+=M+` normal Normal {
`+M+`  vector [
`;for(let V=0;V<this.vertices;++V){let Q=V*3;W=(O=this.normalArray)===null||O===void 0?void 0:O[Q],Y=(D=this.normalArray)===null||D===void 0?void 0:D[Q+1],G=(X=this.normalArray)===null||X===void 0?void 0:X[Q+2],H+=M+"   "+W+" "+Y+" "+G+`,
`}if(H+=M+`  ]
`,H+=M+` }
`,this.colorArray){H+=M+` color Color {
`+M+`  color [
`;for(let V=0;V<this.vertices;++V){let Q=V*3;W=this.colorArray[Q],Y=this.colorArray[Q+1],G=this.colorArray[Q+2],H+=M+"   "+W+" "+Y+" "+G+`,
`}H+=M+`  ]
`,H+=M+` }
`}H+=M+` coordIndex [
`;for(let V=0;V<this.faceidx;V+=3)W=(j=this.faceArray)===null||j===void 0?void 0:j[V],Y=(B=this.faceArray)===null||B===void 0?void 0:B[V+1],G=($=this.faceArray)===null||$===void 0?void 0:$[V+2],H+=M+"  "+W+", "+Y+", "+G+`, -1,
`;H+=M+` ]
`,H+=M+`}
`}return H+=q+"}",H}truncateArrayBuffers(M=!0,R=!1){var z=this.vertexArray,l=this.colorArray,s=this.normalArray,v=this.faceArray,w=this.lineArray,S=this.radiusArray;this.vertexArray=z?.subarray(0,this.vertices*3)||null,this.colorArray=l?.subarray(0,this.vertices*3)||null,M?(this.normalArray=s?.subarray(0,this.vertices*3)||null,this.faceArray=v?.subarray(0,this.faceidx)||null,this.lineidx>0?this.lineArray=w?.subarray(0,this.lineidx)||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),S&&(this.radiusArray=S.subarray(0,this.vertices)),R&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class b extends c.EventDispatcher{constructor(M=!1,R=!1,z=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=p++,this.mesh=M,this.radii=R,this.offset=z}updateGeoGroup(M=0){var R,z=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!z||z.vertices+M>(((R=z?.vertexArray)===null||R===void 0?void 0:R.length)||0)/3)&&(z=this.addGeoGroup()),z}vrml(M,R){for(var z="",l=this.geometryGroups.length,s=0;s<l;s++){var v=this.geometryGroups[s];z+=v.vrml(M,R)+`,
`}return z}addGeoGroup(){var M=new g(this.geometryGroups.length);return this.geometryGroups.push(M),this.groups=this.geometryGroups.length,M.vertexArray=new Float32Array(f*3),M.colorArray=new Float32Array(f*3),this.mesh&&(M.normalArray=new Float32Array(f*3),M.faceArray=new Uint16Array(f*6),M.lineArray=new Uint16Array(f*6)),this.radii&&(M.radiusArray=new Float32Array(f)),M.useOffset=this.offset,M}setUpNormals(...M){for(var R=0;R<this.groups;R++){var z=this.geometryGroups[R];z.setNormals(...M)}}setColors(...M){for(var R=this.geometryGroups.length,z=0;z<R;z++){var l=this.geometryGroups[z];l.setColors(...M)}}setUpWireframe(...M){for(var R=0;R<this.groups;R++){var z=this.geometryGroups[R];z.setLineIndices(...M)}}initTypedArrays(){for(var M=0;M<this.groups;M++){var R=this.geometryGroups[M];R.__inittedArrays!==!0&&R.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var M=0,R=0;R<this.groups;R++)M+=this.geometryGroups[R].vertices;return M}}let p=0}),"./src/WebGL/core/Object3D.ts":((e,r,t)=>{t.r(r),t.d(r,{Light:()=>g,Object3D:()=>_,Object3DIDCount:()=>h,Scene:()=>f});var a=t("./src/WebGL/math/index.ts"),c=t("./src/colors.ts");let h=0;class _{constructor(){this.id=h++,this.name="",this.children=[],this.position=new a.Vector3,this.rotation=new a.Vector3,this.matrix=new a.Matrix4,this.matrixWorld=new a.Matrix4,this.quaternion=new a.Quaternion,this.eulerOrder="XYZ",this.up=new a.Vector3(0,1,0),this.scale=new a.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(p){this.matrix.lookAt(p,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof a.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(p){if(p===this){console.error("Can't add $3Dmol.Object3D to itself");return}p.parent=this,this.children.push(p);for(var E=this;E.parent!==void 0;)E=E.parent;E!==void 0&&E instanceof f&&E.__addObject(p)}remove(p){var E=this.children.indexOf(p);if(E!==-1){p.parent=void 0,this.children.splice(E,1);for(var M=this;M.parent!==void 0;)M=M.parent;M!==void 0&&M instanceof f&&M.__removeObject(p)}}vrml(p){p||(p=" ");var E=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),M=0,R=0,z=0;if(E!=0){let v=Math.sin(E/2);M=this.quaternion.x/v,R=this.quaternion.y/v,z=this.quaternion.z/v}var l=p+`Transform {
`+p+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+p+" rotation "+M+" "+R+" "+z+" "+E+`
`+p+` children [
`;this.geometry&&(l+=this.geometry.vrml(p,this.material));for(var s=0;s<this.children.length;s++)l+=this.children[s].vrml(p+" ")+`,
`;return l+=` ]
`,l+="}",l}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof a.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),(this.scale.x!==1||this.scale.y!==1||this.scale.z!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(p){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||p===!0)&&(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var E=0;E<this.children.length;E++)this.children[E].updateMatrixWorld(!0)}clone(p){p===void 0&&(p=new _),p.name=this.name,p.up.copy(this.up),p.position.copy(this.position),p.rotation instanceof a.Vector3&&this.rotation instanceof a.Vector3?p.rotation.copy(this.rotation):p.rotation=this.rotation,p.eulerOrder=this.eulerOrder,p.scale.copy(this.scale),p.rotationAutoUpdate=this.rotationAutoUpdate,p.matrix.copy(this.matrix),p.matrixWorld.copy(this.matrixWorld),p.quaternion.copy(this.quaternion),p.matrixAutoUpdate=this.matrixAutoUpdate,p.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,p.useQuaternion=this.useQuaternion,p.visible=this.visible;for(var E=0;E<this.children.length;E++){var M=this.children[E];p.add(M.clone())}return p}setVisible(p){this.visible=p;for(var E=0;E<this.children.length;E++){var M=this.children[E];M.setVisible(p)}}}class f extends _{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(p){if(p instanceof g)this.__lights.indexOf(p)===-1&&this.__lights.push(p),p.target&&p.target.parent===void 0&&this.add(p.target);else if(this.__objects.indexOf(p)===-1){this.__objects.push(p),this.__objectsAdded.push(p);var E=this.__objectsRemoved.indexOf(p);E!==-1&&this.__objectsRemoved.splice(E,1)}for(var M=0;M<p.children.length;M++)this.__addObject(p.children[M])}__removeObject(p){var E;if(p instanceof g)E=this.__lights.indexOf(p),E!==-1&&this.__lights.splice(E,1);else if(E=this.__objects.indexOf(p),E!==-1){this.__objects.splice(E,1),this.__objectsRemoved.push(p);var M=this.__objectsAdded.indexOf(p);M!==-1&&this.__objectsAdded.splice(E,1)}for(var R=0;R<p.children.length;R++)this.__removeObject(p.children[R])}}class g extends _{constructor(p,E=1){super(),this.position=new a.Vector3(0,1,0),this.target=new _,this.castShadow=!1,this.onlyShadow=!1,this.color=new c.Color(p),this.intensity=E}}}),"./src/WebGL/core/Projector.ts":((e,r,t)=>{t.r(r),t.d(r,{Projector:()=>h});var a=t("./src/WebGL/math/index.ts");const c=new a.Matrix4;class h{static unprojectVector(f,g){return g.projectionMatrixInverse.getInverse(g.projectionMatrix),c.multiplyMatrices(g.matrixWorld,g.projectionMatrixInverse),f.applyProjection(c)}static projectVector(f,g){return g.matrixWorldInverse.getInverse(g.matrixWorld),c.multiplyMatrices(g.projectionMatrix,g.matrixWorldInverse),f.applyProjection(c)}projectVector(f,g){return h.projectVector(f,g)}unprojectVector(f,g){return h.unprojectVector(f,g)}}}),"./src/WebGL/core/Raycaster.ts":((e,r,t)=>{t.r(r),t.d(r,{Raycaster:()=>f,intersectObject:()=>v});var a=t("./src/WebGL/math/index.ts"),c=t("./src/WebGL/shapes/index.ts");const h=(w,S)=>w.distance-S.distance,_=new a.Matrix4;class f{constructor(S,A,u,y){this.precision=1e-4,this.linePrecision=.2,this.ray=new a.Ray(S,A),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=y||0,this.far=u||1/0}set(S,A){this.ray.set(S,A)}setFromCamera(S,A){A.ortho?(this.ray.origin.set(S.x,S.y,(A.near+A.far)/(A.near-A.far)).unproject(A),this.ray.direction.set(0,0,-1).transformDirection(A.matrixWorld)):(this.ray.origin.setFromMatrixPosition(A.matrixWorld),this.ray.direction.set(S.x,S.y,S.z),A.projectionMatrixInverse.getInverse(A.projectionMatrix),_.multiplyMatrices(A.matrixWorld,A.projectionMatrixInverse),this.ray.direction.applyProjection(_),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(S,A){for(var u=[],y=0,C=A.length;y<C;y++)v(S,A[y],this,u);return u.sort(h),u}}const g=w=>Math.min(Math.max(w,-1),1);var b=new c.Sphere,p=new c.Cylinder,E=new c.Triangle,M=new a.Vector3,R=new a.Vector3,z=new a.Vector3,l=new a.Vector3,s=new a.Vector3;function v(w,S,A,u){if(s.getPositionFromMatrix(w.matrixWorld),S.intersectionShape===void 0)return u;var y=S.intersectionShape,C=A.linePrecision;C*=w.matrixWorld.getMaxScaleOnAxis();var k=C*C;if(S.boundingSphere!==void 0&&S.boundingSphere instanceof c.Sphere&&(b.copy(S.boundingSphere),b.applyMatrix4(w.matrixWorld),!A.ray.isIntersectionSphere(b)))return u;var I,O,D,X,j,B,$,H,q,W,Y,G,V,Q;for(I=0,O=y.triangle.length;I<O;I++)if(y.triangle[I]instanceof c.Triangle){if(E.copy(y.triangle[I]),E.applyMatrix4(w.matrixWorld),D=E.getNormal(),X=A.ray.direction.dot(D),X>=0||(M.subVectors(E.a,A.ray.origin),$=D.dot(M)/X,$<0))continue;R.copy(A.ray.direction).multiplyScalar($).add(A.ray.origin),R.sub(E.a),z.copy(E.b).sub(E.a),l.copy(E.c).sub(E.a);var xe=z.dot(l),ce=z.lengthSq(),Ne=l.lengthSq();if(G=(ce*R.dot(l)-xe*R.dot(z))/(ce*Ne-xe*xe),G<0||G>1||(Y=(R.dot(z)-G*xe)/ce,Y<0||Y>1||Y+G>1))continue;u.push({clickable:S,distance:$})}for(I=0,O=y.cylinder.length;I<O;I++)if(y.cylinder[I]instanceof c.Cylinder){if(p.copy(y.cylinder[I]),p.applyMatrix4(w.matrixWorld),M.subVectors(p.c1,A.ray.origin),j=M.dot(p.direction),B=M.dot(A.ray.direction),X=g(A.ray.direction.dot(p.direction)),q=1-X*X,q===0)continue;V=(X*B-j)/q,Q=(B-X*j)/q,R.copy(p.direction).multiplyScalar(V).add(p.c1),z.copy(A.ray.direction).multiplyScalar(Q).add(A.ray.origin),H=l.subVectors(R,z).lengthSq();var Pe=p.radius*p.radius;if(H<=Pe){if(W=(X*j-B)*(X*j-B)-q*(M.lengthSq()-j*j-Pe),W<=0?G=$=Math.sqrt(H):G=$=(B-X*j-Math.sqrt(W))/q,Y=X*G-j,Y<0||Y*Y>p.lengthSq()||G<0)continue;u.push({clickable:S,distance:$})}}for(I=0,O=y.line.length;I<O;I+=2){R.copy(y.line[I]),R.applyMatrix4(w.matrixWorld),z.copy(y.line[I+1]),z.applyMatrix4(w.matrixWorld),l.subVectors(z,R);var Fe=l.lengthSq();l.normalize(),M.subVectors(R,A.ray.origin);var Me=M.dot(l);B=M.dot(A.ray.direction),X=g(A.ray.direction.dot(l)),q=1-X*X,q!==0&&(V=(X*B-Me)/q,Q=(B-X*Me)/q,R.add(l.multiplyScalar(V)),z.copy(A.ray.direction).multiplyScalar(Q).add(A.ray.origin),H=l.subVectors(z,R).lengthSq(),H<k&&V*V<Fe&&u.push({clickable:S,distance:Q}))}for(I=0,O=y.sphere.length;I<O;I++)if(y.sphere[I]instanceof c.Sphere&&(b.copy(y.sphere[I]),b.applyMatrix4(w.matrixWorld),A.ray.isIntersectionSphere(b))){R.subVectors(b.center,A.ray.origin);var je=R.dot(A.ray.direction);if(W=je*je-(R.lengthSq()-b.radius*b.radius),je<0)return u;W<=0?$=je:$=je-Math.sqrt(W),u.push({clickable:S,distance:$})}return u}}),"./src/WebGL/core/Texture.ts":((e,r,t)=>{t.r(r),t.d(r,{Texture:()=>f,TextureIdCount:()=>g});var a=t("./src/WebGL/constants/TextureConstants.ts"),c=t("./src/WebGL/math/index.ts"),h=t("./src/WebGL/core/EventDispatcher.ts"),_=t("./src/WebGL/core/UVMapping.ts");class f extends h.EventDispatcher{constructor(p,E){super(),this.id=g++,this.name="",this.image=p,this.mapping=new _.UVMapping,this.wrapS=a.ClampToEdgeWrapping,this.wrapT=a.ClampToEdgeWrapping,this.anisotropy=1,E?(this.format=a.RFormat,this.type=a.FloatType,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=a.NearestFilter,this.minFilter=a.NearestFilter):(this.format=a.RGBAFormat,this.type=a.UnsignedByteType,this.offset=new c.Vector2(0,0),this.repeat=new c.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=a.LinearFilter,this.minFilter=a.LinearMipMapLinearFilter),this.needsUpdate=!1,this.onUpdate=null}clone(p=new f){return p.image=this.image,p.mapping=this.mapping,p.wrapS=this.wrapS,p.wrapT=this.wrapT,p.magFilter=this.magFilter,p.minFilter=this.minFilter,p.anisotropy=this.anisotropy,p.format=this.format,p.type=this.type,p.offset.copy(this.offset),p.repeat.copy(this.repeat),p.premultiplyAlpha=this.premultiplyAlpha,p.flipY=this.flipY,p.unpackAlignment=this.unpackAlignment,p}dispose(){this.dispatchEvent({type:"dispose"})}}let g=0}),"./src/WebGL/core/UVMapping.ts":((e,r,t)=>{t.r(r),t.d(r,{UVMapping:()=>a});class a{}}),"./src/WebGL/core/index.ts":((e,r,t)=>{t.r(r),t.d(r,{EventDispatcher:()=>a.EventDispatcher,Geometry:()=>c.Geometry,GeometryGroup:()=>c.GeometryGroup,GeometryIDCount:()=>c.GeometryIDCount,Light:()=>h.Light,Object3D:()=>h.Object3D,Object3DIDCount:()=>h.Object3DIDCount,Projector:()=>_.Projector,Raycaster:()=>f.Raycaster,Scene:()=>h.Scene,Texture:()=>g.Texture,TextureIdCount:()=>g.TextureIdCount,UVMapping:()=>b.UVMapping,intersectObject:()=>f.intersectObject});var a=t("./src/WebGL/core/EventDispatcher.ts"),c=t("./src/WebGL/core/Geometry.ts"),h=t("./src/WebGL/core/Object3D.ts"),_=t("./src/WebGL/core/Projector.ts"),f=t("./src/WebGL/core/Raycaster.ts"),g=t("./src/WebGL/core/Texture.ts"),b=t("./src/WebGL/core/UVMapping.ts")}),"./src/WebGL/index.ts":((e,r,t)=>{t.r(r),t.d(r,{BackSide:()=>a.BackSide,Camera:()=>p.Camera,ClampToEdgeWrapping:()=>a.ClampToEdgeWrapping,Coloring:()=>a.Coloring,Cylinder:()=>b.Cylinder,DoubleSide:()=>a.DoubleSide,EventDispatcher:()=>c.EventDispatcher,FloatType:()=>a.FloatType,Fog:()=>E.Fog,FrontSide:()=>a.FrontSide,Geometry:()=>c.Geometry,GeometryGroup:()=>c.GeometryGroup,GeometryIDCount:()=>c.GeometryIDCount,ImposterMaterial:()=>h.ImposterMaterial,InstancedMaterial:()=>h.InstancedMaterial,Light:()=>c.Light,Line:()=>f.Line,LineBasicMaterial:()=>h.LineBasicMaterial,LineStyle:()=>f.LineStyle,LinearFilter:()=>a.LinearFilter,LinearMipMapLinearFilter:()=>a.LinearMipMapLinearFilter,Material:()=>h.Material,MaterialIdCount:()=>h.MaterialIdCount,Matrix3:()=>_.Matrix3,Matrix4:()=>_.Matrix4,Mesh:()=>f.Mesh,MeshDoubleLambertMaterial:()=>h.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>h.MeshLambertMaterial,MeshOutlineMaterial:()=>h.MeshOutlineMaterial,NearestFilter:()=>a.NearestFilter,Object3D:()=>c.Object3D,Object3DIDCount:()=>c.Object3DIDCount,Projector:()=>c.Projector,Quaternion:()=>_.Quaternion,R32Format:()=>a.R32Format,RFormat:()=>a.RFormat,RGBAFormat:()=>a.RGBAFormat,Ray:()=>_.Ray,Raycaster:()=>c.Raycaster,Renderer:()=>M.Renderer,Scene:()=>c.Scene,ShaderLib:()=>g.ShaderLib,ShaderUtils:()=>g.ShaderUtils,Shading:()=>a.Shading,Sphere:()=>b.Sphere,SphereImposterMaterial:()=>h.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>h.SphereImposterOutlineMaterial,Sprite:()=>f.Sprite,SpriteAlignment:()=>a.SpriteAlignment,SpriteMaterial:()=>h.SpriteMaterial,SpritePlugin:()=>R.SpritePlugin,StickImposterMaterial:()=>h.StickImposterMaterial,StickImposterOutlineMaterial:()=>h.StickImposterOutlineMaterial,Texture:()=>c.Texture,TextureIdCount:()=>c.TextureIdCount,TextureOperations:()=>a.TextureOperations,Triangle:()=>b.Triangle,UVMapping:()=>c.UVMapping,UnsignedByteType:()=>a.UnsignedByteType,Vector2:()=>_.Vector2,Vector3:()=>_.Vector3,VolumetricMaterial:()=>h.VolumetricMaterial,basic:()=>g.basic,clamp:()=>_.clamp,clone:()=>g.clone,conversionMatrix3:()=>_.conversionMatrix3,degToRad:()=>_.degToRad,instanced:()=>g.instanced,intersectObject:()=>c.intersectObject,lambert:()=>g.lambert,lambertdouble:()=>g.lambertdouble,outline:()=>g.outline,screen:()=>g.screen,screenaa:()=>g.screenaa,sphereimposter:()=>g.sphereimposter,sphereimposteroutline:()=>g.sphereimposteroutline,sprite:()=>g.sprite,stickimposter:()=>g.stickimposter,stickimposteroutline:()=>g.stickimposteroutline,volumetric:()=>g.volumetric});var a=t("./src/WebGL/constants/index.ts"),c=t("./src/WebGL/core/index.ts"),h=t("./src/WebGL/materials/index.ts"),_=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/objects/index.ts"),g=t("./src/WebGL/shaders/index.ts"),b=t("./src/WebGL/shapes/index.ts"),p=t("./src/WebGL/Camera.ts"),E=t("./src/WebGL/Fog.ts"),M=t("./src/WebGL/Renderer.ts"),R=t("./src/WebGL/SpritePlugin.ts")}),"./src/WebGL/materials/ImposterMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{ImposterMaterial:()=>g});var a=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Shading.ts"),h=t("./src/colors.ts"),_=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/materials/Material.ts");class g extends f.Material{constructor(p){super(),this.color=new h.Color(16777215),this.ambient=new h.Color(1048575),this.emissive=new h.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new _.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=c.Shading.SmoothShading,this.shaderID=null,this.vertexColors=a.Coloring.NoColors,this.skinning=!1,this.setValues(p)}clone(p=new g){return super.clone.call(this,p),p.color.copy(this.color),p.ambient.copy(this.ambient),p.emissive.copy(this.emissive),p.wrapAround=this.wrapAround,p.wrapRGB.copy(this.wrapRGB),p.map=this.map,p.lightMap=this.lightMap,p.specularMap=this.specularMap,p.envMap=this.envMap,p.combine=this.combine,p.reflectivity=this.reflectivity,p.refractionRatio=this.refractionRatio,p.fog=this.fog,p.shading=this.shading,p.shaderID=this.shaderID,p.vertexColors=this.vertexColors,p.skinning=this.skinning,p.morphTargets=this.morphTargets,p.morphNormals=this.morphNormals,p}}}),"./src/WebGL/materials/InstancedMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{InstancedMaterial:()=>g});var a=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Shading.ts"),h=t("./src/colors.ts"),_=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/materials/Material.ts");class g extends f.Material{constructor(p){super(),this.color=new h.Color(16777215),this.ambient=new h.Color(1048575),this.emissive=new h.Color(0),this.wrapAround=!1,this.wrapRGB=new _.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=c.Shading.SmoothShading,this.shaderID="instanced",this.vertexColors=a.Coloring.NoColors,this.skinning=!1,this.sphere=null,this.setValues(p)}clone(p=new g){return super.clone.call(this,p),p.color.copy(this.color),p.ambient.copy(this.ambient),p.emissive.copy(this.emissive),p.wrapAround=this.wrapAround,p.wrapRGB.copy(this.wrapRGB),p.map=this.map,p.lightMap=this.lightMap,p.specularMap=this.specularMap,p.envMap=this.envMap,p.combine=this.combine,p.reflectivity=this.reflectivity,p.refractionRatio=this.refractionRatio,p.fog=this.fog,p.shading=this.shading,p.shaderID=this.shaderID,p.vertexColors=this.vertexColors,p.skinning=this.skinning,p.morphTargets=this.morphTargets,p.morphNormals=this.morphNormals,p.sphere=this.sphere,p}}}),"./src/WebGL/materials/LineBasicMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{LineBasicMaterial:()=>h});var a=t("./src/colors.ts"),c=t("./src/WebGL/materials/Material.ts");class h extends c.Material{constructor(f){super(),this.color=new a.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(f)}clone(f=new h){return super.clone.call(this,f),f.color.copy(this.color),f}}}),"./src/WebGL/materials/Material.ts":((e,r,t)=>{t.r(r),t.d(r,{Material:()=>f,MaterialIdCount:()=>g});var a=t("./src/WebGL/constants/Sides.ts"),c=t("./src/WebGL/core/index.ts"),h=t("./src/WebGL/math/index.ts"),_=t("./src/colors.ts");class f extends c.EventDispatcher{constructor(){super(...arguments),this.id=g++,this.name="",this.side=a.FrontSide,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(p={}){if(p!==void 0)for(var E in p){var M=p[E];if(M===void 0){console.warn("$3Dmol.Material: '"+E+"' parameter is undefined.");continue}if(E in this){var R=this[E];R instanceof _.Color&&M instanceof _.Color?R.copy(M):R instanceof _.Color?R.set(M):R instanceof h.Vector3&&M instanceof h.Vector3?R.copy(M):this[E]=M}}}clone(p=new f){return p.name=this.name,p.side=this.side,p.opacity=this.opacity,p.transparent=this.transparent,p.depthTest=this.depthTest,p.depthWrite=this.depthWrite,p.polygonOffset=this.polygonOffset,p.polygonOffsetFactor=this.polygonOffsetFactor,p.polygonOffsetUnits=this.polygonOffsetUnits,p.alphaTest=this.alphaTest,p.overdraw=this.overdraw,p.visible=this.visible,p}makeShaded(p){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:p},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let g=0}),"./src/WebGL/materials/MeshDoubleLambertMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{MeshDoubleLambertMaterial:()=>h});var a=t("./src/WebGL/constants/Sides.ts"),c=t("./src/WebGL/materials/MeshLambertMaterial.ts");class h extends c.MeshLambertMaterial{constructor(f){super(f),this.shaderID="lambertdouble",this.side=a.DoubleSide,this.outline=!1}clone(f=new h){return super.clone.call(this,f),f}}}),"./src/WebGL/materials/MeshLambertMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{MeshLambertMaterial:()=>g});var a=t("./src/WebGL/constants/Coloring.ts"),c=t("./src/WebGL/constants/Shading.ts"),h=t("./src/WebGL/materials/Material.ts"),_=t("./src/colors.ts"),f=t("./src/WebGL/math/index.ts");class g extends h.Material{constructor(p){super(),this.color=new _.Color(16777215),this.ambient=new _.Color(1048575),this.emissive=new _.Color(0),this.wrapAround=!1,this.wrapRGB=new f.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=c.Shading.SmoothShading,this.shaderID="lambert",this.vertexColors=a.Coloring.NoColors,this.skinning=!1,this.setValues(p)}clone(p=new g){return super.clone.call(this,p),p.color.copy(this.color),p.ambient.copy(this.ambient),p.emissive.copy(this.emissive),p.wrapAround=this.wrapAround,p.wrapRGB.copy(this.wrapRGB),p.map=this.map,p.lightMap=this.lightMap,p.specularMap=this.specularMap,p.envMap=this.envMap,p.combine=this.combine,p.reflectivity=this.reflectivity,p.refractionRatio=this.refractionRatio,p.fog=this.fog,p.shading=this.shading,p.shaderID=this.shaderID,p.vertexColors=this.vertexColors,p.skinning=this.skinning,p.morphTargets=this.morphTargets,p.morphNormals=this.morphNormals,p}}}),"./src/WebGL/materials/MeshOutlineMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{MeshOutlineMaterial:()=>h});var a=t("./src/colors.ts"),c=t("./src/WebGL/materials/Material.ts");class h extends c.Material{constructor(f){super(),f=f||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=f.color||new a.Color(0,0,0),this.outlineWidth=f.width||.1,this.outlinePushback=f.pushback||1}clone(f=new h){return super.clone.call(this,f),f.fog=this.fog,f.shaderID=this.shaderID,f.wireframe=this.wireframe,f}}}),"./src/WebGL/materials/SphereImposterMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{SphereImposterMaterial:()=>c});var a=t("./src/WebGL/materials/ImposterMaterial.ts");class c extends a.ImposterMaterial{constructor(_){super(_),this.shaderID="sphereimposter",this.setValues(_)}clone(_=new c){return super.clone.call(this,_),_}}}),"./src/WebGL/materials/SphereImposterOutlineMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{SphereImposterOutlineMaterial:()=>h});var a=t("./src/colors.ts"),c=t("./src/WebGL/materials/ImposterMaterial.ts");class h extends c.ImposterMaterial{constructor(f){super(f),f=f||{},this.shaderID="sphereimposteroutline",this.outlineColor=f.color||new a.Color(0,0,0),this.outlineWidth=f.width||.1,this.outlinePushback=f.pushback||1,this.setValues(f)}clone(f=new h){return super.clone.call(this,f),f.outlineColor=this.outlineColor,f.outlineWidth=this.outlineWidth,f.outlinePushback=this.outlinePushback,f}}}),"./src/WebGL/materials/SpriteMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{SpriteMaterial:()=>g});var a=t("./src/WebGL/constants/SpriteAlignment.ts"),c=t("./src/WebGL/core/Texture.ts"),h=t("./src/colors.ts"),_=t("./src/WebGL/math/index.ts"),f=t("./src/WebGL/materials/Material.ts");class g extends f.Material{constructor(p){super(),this.color=new h.Color(16777215),this.map=new c.Texture,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new _.Vector2(0,0),this.uvScale=new _.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=a.SpriteAlignment.center.clone(),this.setValues(p),p=p||{},p.depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),p.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),p.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(p=new g){return super.clone.call(this,p),p.color.copy(this.color),p.map=this.map,p.useScreenCoordinates=this.useScreenCoordinates,p.screenOffset=this.screenOffset,p.sizeAttenuation=this.sizeAttenuation,p.scaleByViewport=this.scaleByViewPort,p.alignment.copy(this.alignment),p.uvOffset.copy(this.uvOffset),p}}}),"./src/WebGL/materials/StickImposterMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{StickImposterMaterial:()=>c});var a=t("./src/WebGL/materials/ImposterMaterial.ts");class c extends a.ImposterMaterial{constructor(_){super(_),this.shaderID="stickimposter",this.setValues(_)}clone(_=new c){return super.clone.call(this,_),_}}}),"./src/WebGL/materials/StickImposterOutlineMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{StickImposterOutlineMaterial:()=>h});var a=t("./src/colors.ts"),c=t("./src/WebGL/materials/ImposterMaterial.ts");class h extends c.ImposterMaterial{constructor(f={}){super(f),this.shaderID="stickimposteroutline",this.outlineColor=new a.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,f.color&&(this.outlineColor=f.color),f.width&&(this.outlineWidth=f.width),f.pushback&&(this.outlinePushback=f.pushback),this.setValues(f)}clone(f=new h){return super.clone.call(this,f),f.outlineColor=this.outlineColor,f.outlineWidth=this.outlineWidth,f.outlinePushback=this.outlinePushback,f}}}),"./src/WebGL/materials/VolumetricMaterial.ts":((e,r,t)=>{t.r(r),t.d(r,{VolumetricMaterial:()=>_});var a=t("./src/WebGL/constants/Sides.ts"),c=t("./src/colors.ts"),h=t("./src/WebGL/materials/Material.ts");class _ extends h.Material{constructor(g){super(),this.transparent=!1,this.volumetric=!0,this.color=new c.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=a.FrontSide,this.setValues(g)}clone(g=new _){return super.clone.call(this,g),g.transparent=this.transparent,g.volumetric=this.volumetric,g.color=this.color,g.transferfn=this.transferfn,g.map=this.map,g.extent=this.extent,g.maxdepth=this.maxdepth,g.unit=this.unit,g.texmatrix=this.texmatrix,g.transfermin=this.transfermin,g.transfermax=this.transfermax,g.subsamples=this.subsamples,g.shaderID=this.shaderID,g.side=this.side,g}}}),"./src/WebGL/materials/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ImposterMaterial:()=>a.ImposterMaterial,InstancedMaterial:()=>c.InstancedMaterial,LineBasicMaterial:()=>h.LineBasicMaterial,Material:()=>_.Material,MaterialIdCount:()=>_.MaterialIdCount,MeshDoubleLambertMaterial:()=>f.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>g.MeshLambertMaterial,MeshOutlineMaterial:()=>b.MeshOutlineMaterial,SphereImposterMaterial:()=>p.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>E.SphereImposterOutlineMaterial,SpriteMaterial:()=>M.SpriteMaterial,StickImposterMaterial:()=>R.StickImposterMaterial,StickImposterOutlineMaterial:()=>z.StickImposterOutlineMaterial,VolumetricMaterial:()=>l.VolumetricMaterial});var a=t("./src/WebGL/materials/ImposterMaterial.ts"),c=t("./src/WebGL/materials/InstancedMaterial.ts"),h=t("./src/WebGL/materials/LineBasicMaterial.ts"),_=t("./src/WebGL/materials/Material.ts"),f=t("./src/WebGL/materials/MeshDoubleLambertMaterial.ts"),g=t("./src/WebGL/materials/MeshLambertMaterial.ts"),b=t("./src/WebGL/materials/MeshOutlineMaterial.ts"),p=t("./src/WebGL/materials/SphereImposterMaterial.ts"),E=t("./src/WebGL/materials/SphereImposterOutlineMaterial.ts"),M=t("./src/WebGL/materials/SpriteMaterial.ts"),R=t("./src/WebGL/materials/StickImposterMaterial.ts"),z=t("./src/WebGL/materials/StickImposterOutlineMaterial.ts"),l=t("./src/WebGL/materials/VolumetricMaterial.ts")}),"./src/WebGL/math/Quaternion.ts":((e,r,t)=>{t.r(r),t.d(r,{Quaternion:()=>a});class a{constructor(h,_,f,g){this.x=h||0,this.y=_||0,this.z=f||0,this.w=g!==void 0?g:1}set(h,_,f,g){return this.x=h,this.y=_,this.z=f,this.w=g,this}copy(h){return this.x=h.x,this.y=h.y,this.z=h.z,this.w=h.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let h=this.length();return h===0?(this.x=0,this.y=0,this.z=0,this.w=1):(h=1/h,this.x*=h,this.y*=h,this.z*=h,this.w*=h),this}multiply(h){return this.multiplyQuaternions(this,h)}multiplyScalar(h){return this.x*=h,this.y*=h,this.z*=h,this.w*=h,this}multiplyQuaternions(h,_){const f=h.x,g=h.y,b=h.z,p=h.w,E=_.x,M=_.y,R=_.z,z=_.w;return this.x=f*z+p*E+g*R-b*M,this.y=g*z+p*M+b*E-f*R,this.z=b*z+p*R+f*M-g*E,this.w=p*z-f*E-g*M-b*R,this}sub(h){return this.x-=h.x,this.y-=h.y,this.z-=h.z,this.w-=h.w,this}clone(){return new a(this.x,this.y,this.z,this.w)}setFromEuler(h){const _=Math.cos(h.x/2),f=Math.cos(h.y/2),g=Math.cos(h.z/2),b=Math.sin(h.x/2),p=Math.sin(h.y/2),E=Math.sin(h.z/2);return this.x=b*f*g+_*p*E,this.y=_*p*g-b*f*E,this.z=_*f*E+b*p*g,this.w=_*f*g-b*p*E,this}}}),"./src/WebGL/math/Vector2.ts":((e,r,t)=>{t.r(r),t.d(r,{Vector2:()=>a});class a{constructor(h,_){this.x=h||0,this.y=_||0}set(h,_){return this.x=h,this.y=_,this}subVectors(h,_){return this.x=h.x-_.x,this.y=h.y-_.y,this}copy(h){return this.x=h.x,this.y=h.y,this}clone(){return new a(this.x,this.y)}}}),"./src/WebGL/math/index.ts":((e,r,t)=>{t.r(r),t.d(r,{Matrix3:()=>g.Matrix3,Matrix4:()=>g.Matrix4,Quaternion:()=>a.Quaternion,Ray:()=>g.Ray,Vector2:()=>c.Vector2,Vector3:()=>g.Vector3,clamp:()=>h.clamp,conversionMatrix3:()=>_.conversionMatrix3,degToRad:()=>f.degToRad});var a=t("./src/WebGL/math/Quaternion.ts"),c=t("./src/WebGL/math/Vector2.ts"),h=t("./src/WebGL/math/utils/clamp.ts"),_=t("./src/WebGL/math/utils/conversionMatrix3.ts"),f=t("./src/WebGL/math/utils/degToRad.ts"),g=t("./src/WebGL/math/math.ts")}),"./src/WebGL/math/math.ts":((e,r,t)=>{t.r(r),t.d(r,{Matrix3:()=>M,Matrix4:()=>p,Ray:()=>R,Vector3:()=>E});var a=t("./src/WebGL/math/utils/degToRad.ts"),c=t("./src/WebGL/math/utils/clamp.ts"),h,_,f,g,b;class p{constructor(l=1,s=0,v=0,w=0,S=0,A=1,u=0,y=0,C=0,k=0,I=1,O=0,D=0,X=0,j=0,B=1){typeof l<"u"&&typeof l!="number"?this.elements=new Float32Array(l):(this.elements=new Float32Array(16),this.elements[0]=l,this.elements[4]=s,this.elements[8]=v,this.elements[12]=w,this.elements[1]=S,this.elements[5]=A,this.elements[9]=u,this.elements[13]=y,this.elements[2]=C,this.elements[6]=k,this.elements[10]=I,this.elements[14]=O,this.elements[3]=D,this.elements[7]=X,this.elements[11]=j,this.elements[15]=B)}makeScale(l,s,v){throw new Error("Method not implemented.")}set(l,s,v,w,S,A,u,y,C,k,I,O,D,X,j,B){const $=this.elements;return $[0]=l,$[4]=s,$[8]=v,$[12]=w,$[1]=S,$[5]=A,$[9]=u,$[13]=y,$[2]=C,$[6]=k,$[10]=I,$[14]=O,$[3]=D,$[7]=X,$[11]=j,$[15]=B,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(l){const s=l.elements;return this.set(s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14],s[3],s[7],s[11],s[15]),this}matrix3FromTopLeft(){const l=this.elements;return new M(l[0],l[4],l[8],l[1],l[5],l[9],l[2],l[6],l[10])}setRotationFromEuler(l,s){const v=this.elements,{x:w,y:S,z:A}=l,u=Math.cos(w),y=Math.sin(w),C=Math.cos(S),k=Math.sin(S),I=Math.cos(A),O=Math.sin(A);if(s===void 0||s==="XYZ"){const D=u*I,X=u*O,j=y*I,B=y*O;v[0]=C*I,v[4]=-C*O,v[8]=k,v[1]=X+j*k,v[5]=D-B*k,v[9]=-y*C,v[2]=B-D*k,v[6]=j+X*k,v[10]=u*C}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${s}`);return this}setRotationFromQuaternion(l){const s=this.elements,{x:v,y:w,z:S,w:A}=l,u=v+v,y=w+w,C=S+S,k=v*u,I=v*y,O=v*C,D=w*y,X=w*C,j=S*C,B=A*u,$=A*y,H=A*C;return s[0]=1-(D+j),s[4]=I-H,s[8]=O+$,s[1]=I+H,s[5]=1-(k+j),s[9]=X-B,s[2]=O-$,s[6]=X+B,s[10]=1-(k+D),this}multiplyMatrices(l,s){const v=l.elements,w=s.elements,S=this.elements,A=v[0],u=v[4],y=v[8],C=v[12],k=v[1],I=v[5],O=v[9],D=v[13],X=v[2],j=v[6],B=v[10],$=v[14],H=v[3],q=v[7],W=v[11],Y=v[15],G=w[0],V=w[4],Q=w[8],xe=w[12],ce=w[1],Ne=w[5],Pe=w[9],Fe=w[13],Me=w[2],je=w[6],ft=w[10],jt=w[14],Gt=w[3],mt=w[7],Le=w[11],ht=w[15];return S[0]=A*G+u*ce+y*Me+C*Gt,S[4]=A*V+u*Ne+y*je+C*mt,S[8]=A*Q+u*Pe+y*ft+C*Le,S[12]=A*xe+u*Fe+y*jt+C*ht,S[1]=k*G+I*ce+O*Me+D*Gt,S[5]=k*V+I*Ne+O*je+D*mt,S[9]=k*Q+I*Pe+O*ft+D*Le,S[13]=k*xe+I*Fe+O*jt+D*ht,S[2]=X*G+j*ce+B*Me+$*Gt,S[6]=X*V+j*Ne+B*je+$*mt,S[10]=X*Q+j*Pe+B*ft+$*Le,S[14]=X*xe+j*Fe+B*jt+$*ht,S[3]=H*G+q*ce+W*Me+Y*Gt,S[7]=H*V+q*Ne+W*je+Y*mt,S[11]=H*Q+q*Pe+W*ft+Y*Le,S[15]=H*xe+q*Fe+W*jt+Y*ht,this}multiplyScalar(l){const s=this.elements;return s[0]*=l,s[4]*=l,s[8]*=l,s[12]*=l,s[1]*=l,s[5]*=l,s[9]*=l,s[13]*=l,s[2]*=l,s[6]*=l,s[10]*=l,s[14]*=l,s[3]*=l,s[7]*=l,s[11]*=l,s[15]*=l,this}makeTranslation(l,s,v){return this.set(1,0,0,l,0,1,0,s,0,0,1,v,0,0,0,1),this}snap(l){const s=Math.pow(10,4),v=this.elements;for(let w=0;w<16;w++){const S=Math.round(v[w]);S===Math.round(v[w]*s)/s&&(v[w]=S)}return this}transpose(){const l=this.elements;let s;return s=l[1],l[1]=l[4],l[4]=s,s=l[2],l[2]=l[8],l[8]=s,s=l[6],l[6]=l[9],l[9]=s,s=l[3],l[3]=l[12],l[12]=s,s=l[7],l[7]=l[13],l[13]=s,s=l[11],l[11]=l[14],l[14]=s,this}setPosition(l){const s=this.elements;return s[12]=l.x,s[13]=l.y,s[14]=l.z,this}translate(l){const s=this.elements;return s[12]+=l.x,s[13]+=l.y,s[14]+=l.z,this}getInverse(l,s){const v=this.elements,w=l.elements,S=w[0],A=w[4],u=w[8],y=w[12],C=w[1],k=w[5],I=w[9],O=w[13],D=w[2],X=w[6],j=w[10],B=w[14],$=w[3],H=w[7],q=w[11],W=w[15];v[0]=I*B*H-O*j*H+O*X*q-k*B*q-I*X*W+k*j*W,v[4]=y*j*H-u*B*H-y*X*q+A*B*q+u*X*W-A*j*W,v[8]=u*O*H-y*I*H+y*k*q-A*O*q-u*k*W+A*I*W,v[12]=y*I*X-u*O*X-y*k*j+A*O*j+u*k*B-A*I*B,v[1]=O*j*$-I*B*$-O*D*q+C*B*q+I*D*W-C*j*W,v[5]=u*B*$-y*j*$+y*D*q-S*B*q-u*D*W+S*j*W,v[9]=y*I*$-u*O*$-y*C*q+S*O*q+u*C*W-S*I*W,v[13]=u*O*D-y*I*D+y*C*j-S*O*j-u*C*B+S*I*B,v[2]=k*B*$-O*X*$+O*D*H-C*B*H-k*D*W+C*X*W,v[6]=y*X*$-A*B*$-y*D*H+S*B*H+A*D*W-S*X*W,v[10]=A*O*$-y*k*$+y*C*H-S*O*H-A*C*W+S*k*W,v[14]=y*k*D-A*O*D-y*C*X+S*O*X+A*C*B-S*k*B,v[3]=I*X*$-k*j*$-I*D*H+C*j*H+k*D*q-C*X*q,v[7]=A*j*$-u*X*$+u*D*H-S*j*H-A*D*q+S*X*q,v[11]=u*k*$-A*I*$-u*C*H+S*I*H+A*C*q-S*k*q,v[15]=A*I*D-u*k*D+u*C*X-S*I*X-A*C*j+S*k*j;const Y=S*v[0]+C*v[4]+D*v[8]+$*v[12];if(Y===0){const G="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(s)throw new Error(G);return console.warn(G),this.identity(),this}return this.multiplyScalar(1/Y),this}isReflected(){const l=this.elements,s=l[0],v=l[4],w=l[8],S=l[1],A=l[5],u=l[9],y=l[2],C=l[6],k=l[10];return s*A*k+S*C*w+y*v*u-y*A*w-S*v*k-s*C*u<0}scale(l){const s=this.elements,{x:v}=l,{y:w}=l,{z:S}=l;return s[0]*=v,s[4]*=w,s[8]*=S,s[1]*=v,s[5]*=w,s[9]*=S,s[2]*=v,s[6]*=w,s[10]*=S,s[3]*=v,s[7]*=w,s[11]*=S,this}getMaxScaleOnAxis(){const l=this.elements,s=l[0]*l[0]+l[1]*l[1]+l[2]*l[2],v=l[4]*l[4]+l[5]*l[5]+l[6]*l[6],w=l[8]*l[8]+l[9]*l[9]+l[10]*l[10];return Math.sqrt(Math.max(s,Math.max(v,w)))}makeFrustum(l,s,v,w,S,A){const u=this.elements,y=2*S/(s-l),C=2*S/(w-v),k=(s+l)/(s-l),I=(w+v)/(w-v),O=-(A+S)/(A-S),D=-2*A*S/(A-S);return u[0]=y,u[4]=0,u[8]=k,u[12]=0,u[1]=0,u[5]=C,u[9]=I,u[13]=0,u[2]=0,u[6]=0,u[10]=O,u[14]=D,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makePerspective(l,s,v,w){const S=v*Math.tan((0,a.degToRad)(l*.5)),A=-S,u=A*s,y=S*s;return this.makeFrustum(u,y,A,S,v,w)}makeOrthographic(l,s,v,w,S,A){const u=this.elements,y=1/(s-l),C=1/(v-w),k=1/(A-S),I=(s+l)*y,O=(v+w)*C,D=(A+S)*k;return u[0]=2*y,u[4]=0,u[8]=0,u[12]=-I,u[1]=0,u[5]=2*C,u[9]=0,u[13]=-O,u[2]=0,u[6]=0,u[10]=-2*k,u[14]=-D,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}isEqual(l){const s=l.elements,v=this.elements;return v[0]===s[0]&&v[4]===s[4]&&v[8]===s[8]&&v[12]===s[12]&&v[1]===s[1]&&v[5]===s[5]&&v[9]===s[9]&&v[13]===s[13]&&v[2]===s[2]&&v[6]===s[6]&&v[10]===s[10]&&v[14]===s[14]&&v[3]===s[3]&&v[7]===s[7]&&v[11]===s[11]&&v[15]===s[15]}clone(){const l=this.elements;return new p(l[0],l[4],l[8],l[12],l[1],l[5],l[9],l[13],l[2],l[6],l[10],l[14],l[3],l[7],l[11],l[15])}isIdentity(){const l=this.elements;return l[0]===1&&l[4]===0&&l[8]===0&&l[12]===0&&l[1]===0&&l[5]===1&&l[9]===0&&l[13]===0&&l[2]===0&&l[6]===0&&l[10]===1&&l[14]===0&&l[3]===0&&l[7]===0&&l[11]===0&&l[15]===1}isNearlyIdentity(l){return this.clone().snap(l).isIdentity()}getScale(l){const s=this.elements;return l=l||new E,f.set(s[0],s[1],s[2]),g.set(s[4],s[5],s[6]),b.set(s[8],s[9],s[10]),l.x=f.length(),l.y=g.length(),l.z=b.length(),l}lookAt(l,s,v){const w=this.elements;return b.subVectors(l,s).normalize(),b.length()===0&&(b.z=1),f.crossVectors(v,b).normalize(),f.length()===0&&(b.x+=1e-4,f.crossVectors(v,b).normalize()),g.crossVectors(b,f),w[0]=f.x,w[4]=g.x,w[8]=b.x,w[1]=f.y,w[5]=g.y,w[9]=b.y,w[2]=f.z,w[6]=g.z,w[10]=b.z,this}compose(l,s,v){const w=this.elements;return h.identity(),h.setRotationFromQuaternion(s),_.makeScale(v.x,v.y,v.z),this.multiplyMatrices(h,_),w[12]=l.x,w[13]=l.y,w[14]=l.z,this}}h=new p,_=new p;class E{constructor(l,s,v){this.x=l||0,this.y=s||0,this.z=v||0,this.atomid=void 0}set(l,s,v){return this.x=l,this.y=s,this.z=v,this}copy(l){return this.x=l.x,this.y=l.y,this.z=l.z,this}add(l){return this.x+=l.x,this.y+=l.y,this.z+=l.z,this}addVectors(l,s){return this.x=l.x+s.x,this.y=l.y+s.y,this.z=l.z+s.z,this}multiplyVectors(l,s){return this.x=l.x*s.x,this.y=l.y*s.y,this.z=l.z*s.z,this}sub(l){return this.x-=l.x,this.y-=l.y,this.z-=l.z,this}subVectors(l,s){return this.x=l.x-s.x,this.y=l.y-s.y,this.z=l.z-s.z,this}multiplyScalar(l){return this.x*=l,this.y*=l,this.z*=l,this}divideScalar(l){return l!==0?(this.x/=l,this.y/=l,this.z/=l):(this.x=0,this.y=0,this.z=0),this}max(l){return this.x=Math.max(this.x,l.x),this.y=Math.max(this.y,l.y),this.z=Math.max(this.z,l.z),this}min(l){return this.x=Math.min(this.x,l.x),this.y=Math.min(this.y,l.y),this.z=Math.min(this.z,l.z),this}distanceTo(l){return Math.sqrt(this.distanceToSquared(l))}distanceToSquared(l){const s=this.x-l.x,v=this.y-l.y,w=this.z-l.z;return s*s+v*v+w*w}applyMatrix3(l){const{x:s}=this,{y:v}=this,{z:w}=this,S=l.elements;return this.x=S[0]*s+S[3]*v+S[6]*w,this.y=S[1]*s+S[4]*v+S[7]*w,this.z=S[2]*s+S[5]*v+S[8]*w,this}applyMatrix4(l){const{x:s}=this,{y:v}=this,{z:w}=this,S=l.elements;return this.x=S[0]*s+S[4]*v+S[8]*w+S[12],this.y=S[1]*s+S[5]*v+S[9]*w+S[13],this.z=S[2]*s+S[6]*v+S[10]*w+S[14],this}applyProjection(l){const{x:s}=this,{y:v}=this,{z:w}=this,S=l.elements,A=S[3]*s+S[7]*v+S[11]*w+S[15];return this.x=(S[0]*s+S[4]*v+S[8]*w+S[12])/A,this.y=(S[1]*s+S[5]*v+S[9]*w+S[13])/A,this.z=(S[2]*s+S[6]*v+S[10]*w+S[14])/A,this}applyQuaternion(l){const{x:s}=this,{y:v}=this,{z:w}=this,S=l.x,A=l.y,u=l.z,y=l.w,C={};C.x=2*(v*u-w*A),C.y=2*(w*S-s*u),C.z=2*(s*A-v*S);const k={};return k.x=C.y*u-C.z*A,k.y=C.z*S-C.x*u,k.z=C.x*A-C.y*S,this.x=s+y*C.x+k.x,this.y=v+y*C.y+k.y,this.z=w+y*C.z+k.z,this}negate(){return this.multiplyScalar(-1)}dot(l){return this.x*l.x+this.y*l.y+this.z*l.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross(l){const{x:s}=this,{y:v}=this,{z:w}=this;return this.x=v*l.z-w*l.y,this.y=w*l.x-s*l.z,this.z=s*l.y-v*l.x,this}crossVectors(l,s){return this.x=l.y*s.z-l.z*s.y,this.y=l.z*s.x-l.x*s.z,this.z=l.x*s.y-l.y*s.x,this}equals(l){return this.x==l.x&&this.y==l.y&&this.z==l.z}getPositionFromMatrix(l){return this.x=l.elements[12],this.y=l.elements[13],this.z=l.elements[14],this}setEulerFromRotationMatrix(l,s){const v=l.elements,w=v[0],S=v[4],A=v[8],u=v[5],y=v[9],C=v[6],k=v[10];return s===void 0||s==="XYZ"?(this.y=Math.asin((0,c.clamp)(A,-1,1)),Math.abs(A)<.99999?(this.x=Math.atan2(-y,k),this.z=Math.atan2(-S,w)):(this.x=Math.atan2(C,u),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${s}`),this}rotateAboutVector(l,s){l.normalize();const v=Math.cos(s),w=Math.sin(s),S=this.clone().multiplyScalar(v),A=l.clone().cross(this).multiplyScalar(w),u=l.clone().multiplyScalar(l.clone().dot(this)).multiplyScalar(1-v),y=S.add(A).add(u);return this.x=y.x,this.y=y.y,this.z=y.z,this}setFromMatrixPosition(l){const s=l.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}transformDirection(l){const{x:s}=this,{y:v}=this,{z:w}=this,S=l.elements;return this.x=S[0]*s+S[4]*v+S[8]*w,this.y=S[1]*s+S[5]*v+S[9]*w,this.z=S[2]*s+S[6]*v+S[10]*w,this.normalize()}clone(){return new E(this.x,this.y,this.z)}unproject(l){const s=h;return s.multiplyMatrices(l.matrixWorld,s.getInverse(l.projectionMatrix)),this.applyMatrix4(s)}}f=new E,g=new E,b=new E;class M{constructor(l=1,s=0,v=0,w=0,S=1,A=0,u=0,y=0,C=1){this.elements=new Float32Array(9),this.set(l,s,v,w,S,A,u,y,C)}set(l,s,v,w,S,A,u,y,C){const k=this.elements;return k[0]=l,k[3]=s,k[6]=v,k[1]=w,k[4]=S,k[7]=A,k[2]=u,k[5]=y,k[8]=C,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(l){const s=l.elements;this.set(s[0],s[3],s[6],s[1],s[4],s[7],s[2],s[5],s[8])}multiplyScalar(l){const s=this.elements;return s[0]*=l,s[3]*=l,s[6]*=l,s[1]*=l,s[4]*=l,s[7]*=l,s[2]*=l,s[5]*=l,s[8]*=l,this}getInverse3(l){const s=l.elements,v=this.elements;v[0]=s[4]*s[8]-s[5]*s[7],v[3]=s[6]*s[5]-s[3]*s[8],v[6]=s[3]*s[7]-s[6]*s[4],v[1]=s[7]*s[2]-s[1]*s[8],v[4]=s[0]*s[8]-s[6]*s[2],v[7]=s[1]*s[6]-s[0]*s[7],v[2]=s[1]*s[5]-s[2]*s[4],v[5]=s[2]*s[3]-s[0]*s[5],v[8]=s[0]*s[4]-s[1]*s[3];const w=s[0]*v[0]+s[3]*v[1]+s[6]*v[2];return this.multiplyScalar(1/w),this}getInverse(l,s){const v=l.elements,w=this.elements;w[0]=v[10]*v[5]-v[6]*v[9],w[1]=-v[10]*v[1]+v[2]*v[9],w[2]=v[6]*v[1]-v[2]*v[5],w[3]=-v[10]*v[4]+v[6]*v[8],w[4]=v[10]*v[0]-v[2]*v[8],w[5]=-v[6]*v[0]+v[2]*v[4],w[6]=v[9]*v[4]-v[5]*v[8],w[7]=-v[9]*v[0]+v[1]*v[8],w[8]=v[5]*v[0]-v[1]*v[4];const S=v[0]*w[0]+v[1]*w[3]+v[2]*w[6];if(S===0){const A="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(s)throw new Error(A);return console.warn(A),this.identity(),this}return this.multiplyScalar(1/S),this}getDeterminant(){const l=this.elements;return l[0]*l[4]*l[8]+l[1]*l[5]*l[6]+l[2]*l[3]*l[7]-l[2]*l[4]*l[6]-l[1]*l[3]*l[8]-l[0]*l[5]*l[7]}transpose(){let l;const s=this.elements;return l=s[1],s[1]=s[3],s[3]=l,l=s[2],s[2]=s[6],s[6]=l,l=s[5],s[5]=s[7],s[7]=l,this}clone(){const l=this.elements;return new M(l[0],l[3],l[6],l[1],l[4],l[7],l[2],l[5],l[8])}getMatrix4(){const l=this.elements;return new p(l[0],l[3],l[6],0,l[1],l[4],l[7],0,l[2],l[5],l[8],0)}}class R{constructor(l,s){this.origin=l!==void 0?l:new E,this.direction=s!==void 0?s:new E}set(l,s){return this.origin.copy(l),this.direction.copy(s),this}copy(l){return this.origin.copy(l.origin),this.direction.copy(l.direction),this}at(l,s){return(s||new E).copy(this.direction).multiplyScalar(l).add(this.origin)}recast(l){const s=f;return this.origin.copy(this.at(l,s)),this}closestPointToPoint(l,s){const v=s||new E;v.subVectors(l,this.origin);const w=v.dot(this.direction);return v.copy(this.direction).multiplyScalar(w).add(this.origin)}distanceToPoint(l){const s=f,v=s.subVectors(l,this.origin).dot(this.direction);return s.copy(this.direction).multiplyScalar(v).add(this.origin),s.distanceTo(l)}isIntersectionCylinder(){}isIntersectionSphere(l){return this.distanceToPoint(l.center)<=l.radius}isIntersectionPlane(l){return l.normal.dot(this.direction)!==0||l.distanceToPoint(this.origin)===0}distanceToPlane(l){const s=l.normal.dot(this.direction);return s===0?l.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot(l.normal)+l.constant)/s}intersectPlane(l,s){const v=this.distanceToPlane(l);if(v!==void 0)return this.at(v,s)}applyMatrix4(l){return this.direction.add(this.origin).applyMatrix4(l),this.origin.applyMatrix4(l),this.direction.sub(this.origin),this}clone(){return new R().copy(this)}}}),"./src/WebGL/math/utils/clamp.ts":((e,r,t)=>{t.r(r),t.d(r,{clamp:()=>a});function a(c,h,_){return Math.min(Math.max(c,h),_)}}),"./src/WebGL/math/utils/conversionMatrix3.ts":((e,r,t)=>{t.r(r),t.d(r,{conversionMatrix3:()=>c});var a=t("./src/WebGL/math/math.ts");function c(h,_,f,g,b,p){g=g*Math.PI/180,b=b*Math.PI/180,p=p*Math.PI/180;const E=s=>s*s,M=Math.cos(g),R=Math.cos(b),z=Math.cos(p),l=Math.sin(p);return new a.Matrix3(h,_*z,f*R,0,_*l,f*(M-R*z)/l,0,0,f*Math.sqrt(1-E(M)-E(R)-E(z)+2*M*R*z)/l)}}),"./src/WebGL/math/utils/degToRad.ts":((e,r,t)=>{t.r(r),t.d(r,{degToRad:()=>c});const a=Math.PI/180;function c(h){return h*a}}),"./src/WebGL/objects/Line.ts":((e,r,t)=>{t.r(r),t.d(r,{Line:()=>_,LineStyle:()=>h});var a=t("./src/WebGL/materials/index.ts"),c=t("./src/WebGL/core/index.ts"),h;(function(f){f[f.LineStrip=0]="LineStrip",f[f.LinePieces=1]="LinePieces"})(h||(h={}));class _ extends c.Object3D{constructor(g,b=new a.LineBasicMaterial({color:Math.random()*16777215}),p=h.LineStrip){super(),this.geometry=g,this.material=b,this.type=p}clone(g=new _(this.geometry,this.material,this.type)){return super.clone.call(this,g),g}}}),"./src/WebGL/objects/Mesh.ts":((e,r,t)=>{t.r(r),t.d(r,{Mesh:()=>c});var a=t("./src/WebGL/core/index.ts");class c extends a.Object3D{constructor(_,f){super(),this.geometry=_,this.material=f}clone(_){return _===void 0&&(_=new c(this.geometry,this.material)),super.clone.call(this,_),_}}}),"./src/WebGL/objects/Sprite.ts":((e,r,t)=>{t.r(r),t.d(r,{Sprite:()=>h});var a=t("./src/WebGL/materials/index.ts"),c=t("./src/WebGL/core/index.ts");class h extends c.Object3D{constructor(f=new a.SpriteMaterial){super(),this.material=f,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),(this.scale.x!==1||this.scale.y!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(f=new h(this.material)){return c.Object3D.prototype.clone.call(this,f),f}}}),"./src/WebGL/objects/index.ts":((e,r,t)=>{t.r(r),t.d(r,{Line:()=>a.Line,LineStyle:()=>a.LineStyle,Mesh:()=>c.Mesh,Sprite:()=>h.Sprite});var a=t("./src/WebGL/objects/Line.ts"),c=t("./src/WebGL/objects/Mesh.ts"),h=t("./src/WebGL/objects/Sprite.ts")}),"./src/WebGL/shaders/ShaderType.ts":((e,r,t)=>{t.r(r)}),"./src/WebGL/shaders/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ShaderLib:()=>a.ShaderLib,ShaderUtils:()=>c.ShaderUtils,basic:()=>a.basic,clone:()=>c.clone,instanced:()=>a.instanced,lambert:()=>a.lambert,lambertdouble:()=>a.lambertdouble,outline:()=>a.outline,screen:()=>a.screen,screenaa:()=>a.screenaa,sphereimposter:()=>a.sphereimposter,sphereimposteroutline:()=>a.sphereimposteroutline,sprite:()=>a.sprite,stickimposter:()=>a.stickimposter,stickimposteroutline:()=>a.stickimposteroutline,volumetric:()=>a.volumetric});var a=t("./src/WebGL/shaders/lib/index.ts"),c=t("./src/WebGL/shaders/utils/index.ts");t("./src/WebGL/shaders/ShaderType.ts")}),"./src/WebGL/shaders/lib/basic/index.ts":((e,r,t)=>{t.r(r),t.d(r,{basic:()=>_});var a=t("./src/WebGL/shaders/lib/basic/uniforms.ts"),c=t("./src/WebGL/shaders/lib/basic/basic.frag"),h=t("./src/WebGL/shaders/lib/basic/basic.vert");const _={vertexShader:h.default.replace("#define GLSLIFY 1",""),fragmentShader:c.default.replace("#define GLSLIFY 1",""),uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/basic/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var a=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new a.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}}}),"./src/WebGL/shaders/lib/blur/index.ts":((e,r,t)=>{t.r(r),t.d(r,{blur:()=>_});var a=t("./src/WebGL/shaders/lib/blur/uniforms.ts"),c=t("./src/WebGL/shaders/lib/blur/blur.frag"),h=t("./src/WebGL/shaders/lib/blur/blur.vert");const _={fragmentShader:c.default,vertexShader:h.default,uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/blur/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>a});const a={}}),"./src/WebGL/shaders/lib/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ShaderLib:()=>w,basic:()=>a.basic,instanced:()=>c.instanced,lambert:()=>h.lambert,lambertdouble:()=>_.lambertdouble,outline:()=>f.outline,screen:()=>g.screen,screenaa:()=>b.screenaa,sphereimposter:()=>p.sphereimposter,sphereimposteroutline:()=>E.sphereimposteroutline,sprite:()=>M.sprite,stickimposter:()=>R.stickimposter,stickimposteroutline:()=>z.stickimposteroutline,volumetric:()=>l.volumetric});var a=t("./src/WebGL/shaders/lib/basic/index.ts"),c=t("./src/WebGL/shaders/lib/instanced/index.ts"),h=t("./src/WebGL/shaders/lib/lambert/index.ts"),_=t("./src/WebGL/shaders/lib/lambertdouble/index.ts"),f=t("./src/WebGL/shaders/lib/outline/index.ts"),g=t("./src/WebGL/shaders/lib/screen/index.ts"),b=t("./src/WebGL/shaders/lib/screenaa/index.ts"),p=t("./src/WebGL/shaders/lib/sphereimposter/index.ts"),E=t("./src/WebGL/shaders/lib/sphereimposteroutline/index.ts"),M=t("./src/WebGL/shaders/lib/sprite/index.ts"),R=t("./src/WebGL/shaders/lib/stickimposter/index.ts"),z=t("./src/WebGL/shaders/lib/stickimposteroutline/index.ts"),l=t("./src/WebGL/shaders/lib/volumetric/index.ts"),s=t("./src/WebGL/shaders/lib/ssao/index.ts"),v=t("./src/WebGL/shaders/lib/blur/index.ts");const w={basic:a.basic,blur:v.blur,instanced:c.instanced,lambert:h.lambert,lambertdouble:_.lambertdouble,outline:f.outline,screen:g.screen,screenaa:b.screenaa,ssao:s.ssao,sphereimposter:p.sphereimposter,sphereimposteroutline:E.sphereimposteroutline,sprite:M.sprite,stickimposter:R.stickimposter,stickimposteroutline:z.stickimposteroutline,volumetric:l.volumetric}}),"./src/WebGL/shaders/lib/instanced/index.ts":((e,r,t)=>{t.r(r),t.d(r,{instanced:()=>_});var a=t("./src/WebGL/shaders/lib/instanced/uniforms.ts"),c=t("./src/WebGL/shaders/lib/instanced/instanced.frag"),h=t("./src/WebGL/shaders/lib/instanced/instanced.vert");const _={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/instanced/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var a=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new a.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/lambert/index.ts":((e,r,t)=>{t.r(r),t.d(r,{lambert:()=>_});var a=t("./src/WebGL/shaders/lib/lambert/uniforms.ts"),c=t("./src/WebGL/shaders/lib/lambert/lambert.frag"),h=t("./src/WebGL/shaders/lib/lambert/lambert.vert");const _={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/lambert/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var a=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new a.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/lambertdouble/index.ts":((e,r,t)=>{t.r(r),t.d(r,{lambertdouble:()=>_});var a=t("./src/WebGL/shaders/lib/lambertdouble/uniforms.ts"),c=t("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag"),h=t("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert");const _={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/lambertdouble/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var a=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new a.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/outline/index.ts":((e,r,t)=>{t.r(r),t.d(r,{outline:()=>_});var a=t("./src/WebGL/shaders/lib/outline/uniforms.ts"),c=t("./src/WebGL/shaders/lib/outline/outline.frag"),h=t("./src/WebGL/shaders/lib/outline/outline.vert");const _={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/outline/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var a=t("./src/colors.ts");const c={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new a.Color(0,0,0)},fogColor:{type:"c",value:new a.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/screen/index.ts":((e,r,t)=>{t.r(r),t.d(r,{screen:()=>_});var a=t("./src/WebGL/shaders/lib/screen/uniforms.ts"),c=t("./src/WebGL/shaders/lib/screen/screen.frag"),h=t("./src/WebGL/shaders/lib/screen/screen.vert");const _={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/screen/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>a});const a={}}),"./src/WebGL/shaders/lib/screenaa/index.ts":((e,r,t)=>{t.r(r),t.d(r,{screenaa:()=>_});var a=t("./src/WebGL/shaders/lib/screenaa/uniforms.ts"),c=t("./src/WebGL/shaders/lib/screenaa/screenaa.frag"),h=t("./src/WebGL/shaders/lib/screenaa/screenaa.vert");const _={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/screenaa/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>a});const a={}}),"./src/WebGL/shaders/lib/sphereimposter/index.ts":((e,r,t)=>{t.r(r),t.d(r,{sphereimposter:()=>_});var a=t("./src/WebGL/shaders/lib/sphereimposter/uniforms.ts"),c=t("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag"),h=t("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert");const _={vertexShader:h.default.replace("#define GLSLIFY 1",""),fragmentShader:c.default.replace("#define GLSLIFY 1",""),uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/sphereimposter/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var a=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new a.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/sphereimposteroutline/index.ts":((e,r,t)=>{t.r(r),t.d(r,{sphereimposteroutline:()=>_});var a=t("./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts"),c=t("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag"),h=t("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert");const _={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var a=t("./src/colors.ts");const c={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new a.Color(0,0,0)},fogColor:{type:"c",value:new a.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/sprite/index.ts":((e,r,t)=>{t.r(r),t.d(r,{sprite:()=>_});var a=t("./src/WebGL/shaders/lib/sprite/uniforms.ts"),c=t("./src/WebGL/shaders/lib/sprite/sprite.frag"),h=t("./src/WebGL/shaders/lib/sprite/sprite.vert");const _={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/sprite/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>a});const a={}}),"./src/WebGL/shaders/lib/ssao/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ssao:()=>_});var a=t("./src/WebGL/shaders/lib/ssao/uniforms.ts"),c=t("./src/WebGL/shaders/lib/ssao/ssao.frag"),h=t("./src/WebGL/shaders/lib/ssao/ssao.vert");const _={fragmentShader:c.default,vertexShader:h.default,uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/ssao/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>a});const a={total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}}),"./src/WebGL/shaders/lib/stickimposter/index.ts":((e,r,t)=>{t.r(r),t.d(r,{stickimposter:()=>f});var a=t("./src/WebGL/shaders/lib/stickimposter/uniforms.ts"),c=t("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),h=t("./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag"),_=t("./src/WebGL/shaders/lib/stickimposter/stickimposter.vert");const f={fragmentShader:[c.default,h.default].join(`
`),vertexShader:_.default,uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/stickimposter/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var a=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new a.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}}),"./src/WebGL/shaders/lib/stickimposteroutline/index.ts":((e,r,t)=>{t.r(r),t.d(r,{stickimposteroutline:()=>_});var a=t("./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts"),c=t("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),h=t("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert");const _={fragmentShader:c.default+"gl_FragColor = vec4(color,1.0);}",vertexShader:h.default,uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var a=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new a.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new a.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1}}}),"./src/WebGL/shaders/lib/volumetric/index.ts":((e,r,t)=>{t.r(r),t.d(r,{volumetric:()=>_});var a=t("./src/WebGL/shaders/lib/volumetric/uniforms.ts"),c=t("./src/WebGL/shaders/lib/volumetric/volumetric.frag"),h=t("./src/WebGL/shaders/lib/volumetric/volumetric.vert");const _={fragmentShader:c.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:a.uniforms}}),"./src/WebGL/shaders/lib/volumetric/uniforms.ts":((e,r,t)=>{t.r(r),t.d(r,{uniforms:()=>c});var a=t("./src/colors.ts");const c={opacity:{type:"f",value:1},fogColor:{type:"c",value:new a.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}}}),"./src/WebGL/shaders/utils/clone.ts":((e,r,t)=>{t.r(r),t.d(r,{clone:()=>c});var a=t("./src/colors.ts");function c(h){let _={};for(const g in h){_[g]={},_[g].type=h[g].type;var f=h[g].value;f instanceof a.Color?_[g].value=f.clone():typeof f=="number"?_[g].value=f:f instanceof Array?_[g].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return _}}),"./src/WebGL/shaders/utils/index.ts":((e,r,t)=>{t.r(r),t.d(r,{ShaderUtils:()=>c,clone:()=>a.clone});var a=t("./src/WebGL/shaders/utils/clone.ts");const c={clone:a.clone}}),"./src/WebGL/shapes/Cylinder.ts":((e,r,t)=>{t.r(r),t.d(r,{Cylinder:()=>h});var a=t("./src/WebGL/math/index.ts");let c=new a.Vector3;class h{constructor(f=new a.Vector3,g=new a.Vector3,b=0){this.c1=f,this.c2=g,this.radius=b,this.direction=new a.Vector3().subVectors(this.c2,this.c1).normalize()}copy(f){return this.c1.copy(f.c1),this.c2.copy(f.c2),this.direction.copy(f.direction),this.radius=f.radius,this}lengthSq(){return c.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(f){return this.direction.add(this.c1).applyMatrix4(f),this.c1.applyMatrix4(f),this.c2.applyMatrix4(f),this.direction.sub(this.c1).normalize(),this.radius=this.radius*f.getMaxScaleOnAxis(),this}}}),"./src/WebGL/shapes/Sphere.ts":((e,r,t)=>{t.r(r),t.d(r,{Sphere:()=>c});var a=t("./src/WebGL/math/index.ts");class c{constructor(_={x:0,y:0,z:0},f=0){this.center=new a.Vector3(_.x,_.y,_.z),this.radius=f}set(_,f){return this.center.copy(_),this.radius=f,this}copy(_){return this.center.copy(_.center),this.radius=_.radius,this}applyMatrix4(_){return this.center.applyMatrix4(_),this.radius=this.radius*_.getMaxScaleOnAxis(),this}translate(_){return this.center.add(_),this}equals(_){return _.center.equals(this.center)&&_.radius===this.radius}clone(){return new c().copy(this)}}}),"./src/WebGL/shapes/Triangle.ts":((e,r,t)=>{t.r(r),t.d(r,{Triangle:()=>h});var a=t("./src/WebGL/math/index.ts");const c=new a.Vector3;class h{constructor(f=new a.Vector3,g=new a.Vector3,b=new a.Vector3){this.a=f,this.b=g,this.c=b}copy(f){return this.a.copy(f.a),this.b.copy(f.b),this.c.copy(f.c),this}applyMatrix4(f){return this.a.applyMatrix4(f),this.b.applyMatrix4(f),this.c.applyMatrix4(f),this}getNormal(){var f=this.a.clone();return f.sub(this.b),c.subVectors(this.c,this.b),f.cross(c),f.normalize(),f}}}),"./src/WebGL/shapes/index.ts":((e,r,t)=>{t.r(r),t.d(r,{Cylinder:()=>c.Cylinder,Sphere:()=>a.Sphere,Triangle:()=>h.Triangle});var a=t("./src/WebGL/shapes/Sphere.ts"),c=t("./src/WebGL/shapes/Cylinder.ts"),h=t("./src/WebGL/shapes/Triangle.ts")}),"./src/autoload.ts":((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{autoinit:()=>autoinit,autoload:()=>autoload,processing_autoinit:()=>processing_autoinit,viewers:()=>viewers});var _GLViewer__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/GLViewer.ts"),_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/ProteinSurface4.ts"),_utilities__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utilities.ts"),_colors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/colors.ts"),autoinit=!1,processing_autoinit=!1,viewers={};function autoload(viewer,callback){var i,dataname,type;if(document.querySelector(".viewer_3Dmoljs")!=null&&(autoinit=!0),autoinit){processing_autoinit=!0,viewer=viewer??null;var nviewers=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(viewerdiv=>{var datauri=[],datatypes=[],uri="";viewerdiv.style.position=="static"&&(viewerdiv.style.position="relative");var UI=null;if(type=null,viewerdiv.dataset.pdb)datauri.push("https://files.rcsb.org/view/"+viewerdiv.dataset.pdb+".pdb"),datatypes.push("pdb");else if(viewerdiv.dataset.cid)datatypes.push("sdf"),datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+viewerdiv.dataset.cid+"/SDF?record_type=3d");else if(viewerdiv.dataset.href||viewerdiv.dataset.url){if(viewerdiv.dataset.href?uri=viewerdiv.dataset.href:uri=viewerdiv.dataset.url,datauri.push(uri),type=uri.substring(uri.lastIndexOf(".")+1),type=="gz"){let e=uri.substring(0,uri.lastIndexOf(".")).lastIndexOf(".");type=uri.substring(e+1)}datatypes.push(type);var molName=uri.substring(uri.lastIndexOf("/")+1,uri.lastIndexOf("."));molName=="/"&&(molName=uri.substring(uri.lastIndexOf("/")+1)),viewerdiv.dataset[datatypes[datatypes.length-1]]=molName}let divdata=viewerdiv.dataset;for(i in divdata)i.substring(0,3)==="pdb"&&i!=="pdb"?(datauri.push("https://files.rcsb.org/view/"+divdata[i]+".pdb"),datatypes.push("pdb")):i.substring(0,4)==="href"&&i!=="href"?(uri=divdata[i],datauri.push(uri),datatypes.push(uri.substring(uri.lastIndexOf(".")+1))):i.substring(0,3)==="cid"&&i!=="cid"&&(datauri.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+divdata[i]+"/SDF?record_type=3d"),datatypes.push("sdf"));var options={};viewerdiv.dataset.options&&(options=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.options));var bgcolor=_colors__WEBPACK_IMPORTED_MODULE_3__.CC.color(viewerdiv.dataset.backgroundcolor),bgalpha=viewerdiv.dataset.backgroundalpha;bgalpha=bgalpha==null?1:parseFloat(bgalpha);var style={line:{}};viewerdiv.dataset.style&&(style=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.style));var select={};viewerdiv.dataset.select&&(select=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.select));var selectstylelist=[],surfaces=[],labels=[],zoomto={},spin=null,d=viewerdiv.dataset,stylere=/style(.+)/,surfre=/surface(.*)/,reslabre=/labelres(.*)/,keys=[];for(dataname in d)Object.prototype.hasOwnProperty.call(d,dataname)&&keys.push(dataname);for(keys.sort(),i=0;i<keys.length;i++){dataname=keys[i];var m=stylere.exec(dataname),selname,newsel,styleobj;m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),selectstylelist.push([newsel,styleobj])),m=surfre.exec(dataname),m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),surfaces.push([newsel,styleobj])),m=reslabre.exec(dataname),m&&(selname="select"+m[1],newsel=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[selname]),styleobj=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]),labels.push([newsel,styleobj])),dataname=="zoomto"&&(zoomto=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname])),dataname=="spin"&&(spin=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(d[dataname]))}var applyStyles=function(e){for(e.setStyle(select,style),UI&&UI.createSelectionAndStyle(select,style),i=0;i<selectstylelist.length;i++){let r=selectstylelist[i][0]||{},t=selectstylelist[i][1]||{line:{}};e.setStyle(r,t),UI&&UI.createSelectionAndStyle(select,style)}for(i=0;i<surfaces.length;i++){let r=surfaces[i][0]||{},t=surfaces[i][1]||{};UI?e.addSurface(_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__.SurfaceType.VDW,t,r,r).then(a=>{UI.loadSurface("VDW",r,t,a)}):e.addSurface(_ProteinSurface4__WEBPACK_IMPORTED_MODULE_1__.SurfaceType.VDW,t,r,r)}for(i=0;i<labels.length;i++){let r=labels[i][0]||{},t=labels[i][1]||{};e.addResLabels(r,t)}e.render(),e.zoomTo(zoomto),spin&&e.spin(spin.axis,spin.speed)};let glviewer=viewer;try{var config=(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.specStringToObject)(viewerdiv.dataset.config)||{};config.backgroundColor===void 0&&(config.backgroundColor=bgcolor),config.backgroundAlpha===void 0&&(config.backgroundAlpha=bgalpha),glviewer==null?glviewer=viewers[viewerdiv.id||nviewers++]=(0,_GLViewer__WEBPACK_IMPORTED_MODULE_0__.createViewer)(viewerdiv,config):(glviewer.setBackgroundColor(bgcolor,bgalpha),glviewer.setConfig(config),UI&&UI.initiateUI()),viewerdiv.dataset.ui&&$3Dmol.StateManager&&(UI=new $3Dmol.StateManager(glviewer))}catch(e){console.log(e),viewerdiv.textContent="WebGL appears to be disabled."}if(datauri.length!=0){let i=0,process=((viewerdiv,glviewer)=>function(moldata){uri=datauri[i];var type=viewerdiv.dataset.type||viewerdiv.dataset.datatype||datatypes[i];if(glviewer.addModel(moldata,type,options),UI){var modelName=viewerdiv.dataset[datatypes[i]];UI.setModelTitle(modelName)}if(i+=1,i<datauri.length)(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.get)(datauri[i]).then(process);else{if(applyStyles(glviewer),viewerdiv.dataset.callback){var runres=eval(viewerdiv.dataset.callback);typeof runres=="function"&&runres(glviewer)}processing_autoinit=!1,callback&&callback(glviewer)}})(viewerdiv,glviewer);type&&type.endsWith("gz")?(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.getbin)(datauri[0]).then(process):(0,_utilities__WEBPACK_IMPORTED_MODULE_2__.get)(datauri[0]).then(process)}else{if(viewerdiv.dataset.element){var moldataid="#"+viewerdiv.dataset.element,molelem=document.querySelector(moldataid),moldata=molelem?molelem.textContent:"";type=viewerdiv.dataset.type||viewerdiv.dataset.datatype,glviewer.addModel(moldata,type,options)}if(applyStyles(glviewer),viewerdiv.dataset.callback){var runres=eval(viewerdiv.dataset.callback);typeof runres=="function"&&runres(glviewer)}processing_autoinit=!1,callback&&callback(glviewer)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&autoload()}}),"./src/colors.ts":((e,r,t)=>{t.r(r),t.d(r,{CC:()=>c,Color:()=>a,builtinColorSchemes:()=>E,chains:()=>p,elementColors:()=>g,htmlColors:()=>h,residues:()=>b,ssColors:()=>_});class a{constructor(R,z,l){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof R=="number"?(this.r=R||0,this.g=z||0,this.b=l||0,this):this.set(R||0)}set(R){return R instanceof a?R.clone():(typeof R=="number"?this.setHex(R):typeof R=="object"&&(this.r=R?.r||0,this.g=R?.g||0,this.b=R?.b||0),this)}setHex(R){return R=Math.floor(R),this.r=(R>>16&255)/255,this.g=(R>>8&255)/255,this.b=(R&255)/255,this}getHex(){var R=Math.round(this.r*255),z=Math.round(this.g*255),l=Math.round(this.b*255);return R<<16|z<<8|l}clone(){return new a(this.r,this.g,this.b)}copy(R){return this.r=R.r,this.g=R.g,this.b=R.b,this}scaled(){var R={};return R.r=Math.round(this.r*255),R.g=Math.round(this.g*255),R.b=Math.round(this.b*255),R.a=1,R}}class c{static color(R){if(!R)return c.cache[0];if(R instanceof a)return R;if(typeof R=="number"&&typeof c.cache[R]<"u")return c.cache[R];if(R&&Array.isArray(R))return R.map(c.color);let z=c.getHex(R),l=new a(z);return c.cache[z]=l,l}static getHex(R){var z;if(Array.isArray(R))return R.map(c.getHex);if(typeof R=="string"){let l=R;if(!isNaN(parseInt(l)))return parseInt(l);if(l=l.trim(),l.length==4&&l[0]=="#"&&(l="#"+l[1]+l[1]+l[2]+l[2]+l[3]+l[3]),l.length==7&&l[0]=="#")return parseInt(l.substring(1),16);let s=c.rgbRegEx.exec(l);if(s){s[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let v=0;for(let w=2;w<5;w++){v*=256;let S=s[w].endsWith("%")?255*parseFloat(s[w])/100:parseFloat(s[w]);v+=Math.round(S)}return v}return((z=window?.$3Dmol)===null||z===void 0?void 0:z.htmlColors[R.toLowerCase()])||0}return R}}c.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,c.cache={0:new a(0)};const h={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},f={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},g={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:f,defaultColors:Object.assign({},f),greenCarbon:Object.assign(Object.assign({},f),{C:65280}),cyanCarbon:Object.assign(Object.assign({},f),{C:65535}),magentaCarbon:Object.assign(Object.assign({},f),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},f),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},f),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},f),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},f),{C:8388736}),blueCarbon:Object.assign(Object.assign({},f),{C:255})},b={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},p={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},E={ssPyMol:{prop:"ss",map:_.pyMol},ssJmol:{prop:"ss",map:_.Jmol},Jmol:{prop:"elem",map:g.Jmol},amino:{prop:"resn",map:b.amino},shapely:{prop:"resn",map:b.shapely},nucleic:{prop:"resn",map:b.nucleic},chain:{prop:"chain",map:p.atom},rasmol:{prop:"elem",map:g.rasmol},default:{prop:"elem",map:g.defaultColors},greenCarbon:{prop:"elem",map:g.greenCarbon},chainHetatm:{prop:"chain",map:p.hetatm},cyanCarbon:{prop:"elem",map:g.cyanCarbon},magentaCarbon:{prop:"elem",map:g.magentaCarbon},purpleCarbon:{prop:"elem",map:g.purpleCarbon},whiteCarbon:{prop:"elem",map:g.whiteCarbon},orangeCarbon:{prop:"elem",map:g.orangeCarbon},yellowCarbon:{prop:"elem",map:g.yellowCarbon},blueCarbon:{prop:"elem",map:g.blueCarbon}}}),"./src/glcartoon.ts":((e,r,t)=>{t.r(r),t.d(r,{drawCartoon:()=>X,subdivide_spline:()=>p});var a=t("./src/WebGL/math/index.ts"),c=t("./src/WebGL/shapes/index.ts"),h=t("./src/WebGL/index.ts"),_=t("./src/Gradient.ts"),f=t("./src/colors.ts"),g=t("./src/GLDraw.ts"),b=t("./src/utilities.ts");function p(j,B){var $=[],H=j;H=[],H.push(j[0]);var q,W,Y,G,V,Q,xe,ce,Ne;for(q=1,W=j.length-1;q<W;q++)if(V=j[q],Q=j[q+1],V.smoothen){var Pe=new a.Vector3((V.x+Q.x)/2,(V.y+Q.y)/2,(V.z+Q.z)/2);Pe.atom=V.atom,H.push(Pe)}else H.push(V);for(H.push(j[j.length-1]),q=-1,Y=H.length;q<=Y-3;q++)if(G=H[q===-1?0:q],V=H[q+1],Q=H[q+2],xe=H[q===Y-3?Y-1:q+3],ce=new a.Vector3().subVectors(Q,G).multiplyScalar(.5),Ne=new a.Vector3().subVectors(xe,V).multiplyScalar(.5),!Q.skip)for(var Fe=0;Fe<B;Fe++){var Me=1/B*Fe,je=V.x+Me*ce.x+Me*Me*(-3*V.x+3*Q.x-2*ce.x-Ne.x)+Me*Me*Me*(2*V.x-2*Q.x+ce.x+Ne.x),ft=V.y+Me*ce.y+Me*Me*(-3*V.y+3*Q.y-2*ce.y-Ne.y)+Me*Me*Me*(2*V.y-2*Q.y+ce.y+Ne.y),jt=V.z+Me*ce.z+Me*Me*(-3*V.z+3*Q.z-2*ce.z-Ne.z)+Me*Me*Me*(2*V.z-2*Q.z+ce.z+Ne.z),Gt=new a.Vector3(je,ft,jt);Fe<B/2?Gt.atom=V.atom:Gt.atom=Q.atom,$.push(Gt)}return $.push(H[H.length-1]),$}const E=.5,M=1.3,R=.8,z=.4,l=.4;function s(j,B,$,H){for(var q,W,Y,G,V=0,Q=B.length;V<Q;V++){G=Math.round(V*(H.length-1)/Q),Y=f.CC.color(H[G]);var xe=j.updateGeoGroup(2),ce=xe.vertexArray,Ne=xe.colorArray,Pe=xe.faceArray;q=xe.vertices,W=q*3,ce[W]=B[V].x,ce[W+1]=B[V].y,ce[W+2]=B[V].z,ce[W+3]=$[V].x,ce[W+4]=$[V].y,ce[W+5]=$[V].z;for(var Fe=0;Fe<6;++Fe)Ne[W+3*Fe]=Y.r,Ne[W+1+3*Fe]=Y.g,Ne[W+2+3*Fe]=Y.b;if(V>0){var Me=[q,q+1,q-1,q-2],je=xe.faceidx;Pe[je]=Me[0],Pe[je+1]=Me[1],Pe[je+2]=Me[3],Pe[je+3]=Me[1],Pe[je+4]=Me[2],Pe[je+5]=Me[3],xe.faceidx+=6}xe.vertices+=2}}function v(j,B,$,H,q,W,Y){var G,V,Q,xe;if(Q=B.length,Q<2||B[0].length<2)return;for(G=0;G<Q;G++)B[G]=p(B[G],H);if(xe=B[0].length,!q)return s(j,B[0],B[Q-1],$);var ce,Ne,Pe,Fe,Me,je,ft=[],jt=[],Gt=[];for(V=0;V<Q;V++)ft.push(.25+1.5*Math.sqrt((Q-1)*V-Math.pow(V,2))/(Q-1)),jt.push(.5),Gt.push(2*(Math.pow(V/Q,2)-V/Q)+.6);var mt=[];for(V=0;V<Q*2-1;V++)mt[V]=[V,V+1,V+1-2*Q,V-2*Q];mt[Q*2-1]=[V,V+1-2*Q,V+1-4*Q,V-2*Q];var Le,ht,ar,Jt,Wt,Gr,Lr,zr,Nr,At;let Mt=j.updateGeoGroup();for(G=0;G<xe;G++){let ve=j.groups,we=!1;Mt=j.updateGeoGroup(2*Q),ve!=j.groups&&G>0&&(G=G-1,we=!0),Gr=Math.round(G*($.length-1)/xe),Wt=f.CC.color($[Gr]),Me=Pe,je=Fe,Pe=[],Fe=[],ce=[],B[0][G].atom!==void 0&&(Jt=B[0][G].atom,Y==="oval"?Ne=ft:Y==="rectangle"?Ne=jt:Y==="parabola"&&(Ne=Gt)),Ne||(Ne=jt);var Jr,qr;for(V=0;V<Q;V++)G<xe-1?Jr=B[V][G+1].clone().sub(B[V][G]):Jr=B[V][G-1].clone().sub(B[V][G]).negate(),V<Q-1?qr=B[V+1][G].clone().sub(B[V][G]):qr=B[V-1][G].clone().sub(B[V][G]).negate(),ce[V]=qr.cross(Jr).normalize().multiplyScalar(q*Ne[V]);for(V=0;V<Q;V++)Pe[V]=B[V][G].clone().add(ce[V].clone().negate());for(V=0;V<Q;V++)Fe[V]=B[V][G].clone().add(ce[V]);for(Lr=Mt.vertexArray,zr=Mt.colorArray,Nr=Mt.faceArray,Le=Mt.vertices,ht=Le*3,V=0;V<Q;V++)Lr[ht+3*V+0]=Pe[V].x,Lr[ht+3*V+1]=Pe[V].y,Lr[ht+3*V+2]=Pe[V].z;for(V=0;V<Q;V++)Lr[ht+3*V+0+3*Q]=Fe[Q-1-V].x,Lr[ht+3*V+1+3*Q]=Fe[Q-1-V].y,Lr[ht+3*V+2+3*Q]=Fe[Q-1-V].z;for(V=0;V<2*Q;++V)zr[ht+3*V+0]=Wt.r,zr[ht+3*V+1]=Wt.g,zr[ht+3*V+2]=Wt.b;if(G>0&&!we){for(V=0;V<Q*2;V++)At=[Le+mt[V][0],Le+mt[V][1],Le+mt[V][2],Le+mt[V][3]],ar=Mt.faceidx,Nr[ar]=At[0],Nr[ar+1]=At[1],Nr[ar+2]=At[3],Nr[ar+3]=At[1],Nr[ar+4]=At[2],Nr[ar+5]=At[3],Mt.faceidx+=6;if(Jt.clickable||Jt.hoverable){var ie=[];ie.push(new c.Triangle(Me[0],Pe[0],Pe[Q-1])),ie.push(new c.Triangle(Me[0],Pe[Q-1],Me[Q-1])),ie.push(new c.Triangle(Me[Q-1],Pe[Q-1],Fe[Q-1])),ie.push(new c.Triangle(Me[Q-1],Fe[Q-1],je[Q-1])),ie.push(new c.Triangle(Fe[0],je[0],je[Q-1])),ie.push(new c.Triangle(Fe[Q-1],Fe[0],je[Q-1])),ie.push(new c.Triangle(Pe[0],Me[0],je[0])),ie.push(new c.Triangle(Fe[0],Pe[0],je[0]));for(V in ie)Jt.intersectionShape.triangle.push(ie[V])}}Mt.vertices+=2*Q}for(Lr=Mt.vertexArray,zr=Mt.colorArray,Nr=Mt.faceArray,Le=Mt.vertices,ht=Le*3,ar=Mt.faceidx,G=0;G<Q-1;G++)At=[G,G+1,2*Q-2-G,2*Q-1-G],ar=Mt.faceidx,Nr[ar]=At[0],Nr[ar+1]=At[1],Nr[ar+2]=At[3],Nr[ar+3]=At[1],Nr[ar+4]=At[2],Nr[ar+5]=At[3],Mt.faceidx+=6;for(G=0;G<Q-1;G++)At=[Le-1-G,Le-2-G,Le-2*Q+G+1,Le-2*Q+G],ar=Mt.faceidx,Nr[ar]=At[0],Nr[ar+1]=At[1],Nr[ar+2]=At[3],Nr[ar+3]=At[1],Nr[ar+4]=At[2],Nr[ar+5]=At[3],Mt.faceidx+=6}function w(j,B,$,H,q,W){if(!(B.length<2)){var Y,G;if(Y=B[0],G=B[B.length-1],Y=p(Y,H),G=p(G,H),!q)return s(j,Y,G,$);var V=[],Q,xe,ce,Ne,Pe,Fe=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],Me,je,ft,jt,Gt,mt,Le,ht,ar,Jt,Wt,Gr,Lr,zr,Nr,At,Mt;for(ht=0,ar=Y.length;ht<ar;ht++){if(Gt=Math.round(ht*($.length-1)/ar),jt=f.CC.color($[Gt]),V.push(xe=Y[ht]),V.push(xe),V.push(ce=G[ht]),V.push(ce),ht<ar-1){var Jr=Y[ht+1].clone().sub(Y[ht]),qr=G[ht].clone().sub(Y[ht]);Q=qr.cross(Jr).normalize().multiplyScalar(q)}for(V.push(Ne=Y[ht].clone().add(Q)),V.push(Ne),V.push(Pe=G[ht].clone().add(Q)),V.push(Pe),xe.atom!==void 0&&(mt=xe.atom),zr=j.updateGeoGroup(8),Nr=zr.vertexArray,At=zr.colorArray,Mt=zr.faceArray,Me=zr.vertices,je=Me*3,Nr[je]=xe.x,Nr[je+1]=xe.y,Nr[je+2]=xe.z,Nr[je+3]=xe.x,Nr[je+4]=xe.y,Nr[je+5]=xe.z,Nr[je+6]=ce.x,Nr[je+7]=ce.y,Nr[je+8]=ce.z,Nr[je+9]=ce.x,Nr[je+10]=ce.y,Nr[je+11]=ce.z,Nr[je+12]=Ne.x,Nr[je+13]=Ne.y,Nr[je+14]=Ne.z,Nr[je+15]=Ne.x,Nr[je+16]=Ne.y,Nr[je+17]=Ne.z,Nr[je+18]=Pe.x,Nr[je+19]=Pe.y,Nr[je+20]=Pe.z,Nr[je+21]=Pe.x,Nr[je+22]=Pe.y,Nr[je+23]=Pe.z,Jt=0;Jt<8;++Jt)At[je+3*Jt]=jt.r,At[je+1+3*Jt]=jt.g,At[je+2+3*Jt]=jt.b;if(ht>0){var ie=Le!==void 0&&mt!==void 0&&Le.serial!==mt.serial;for(Jt=0;Jt<4;Jt++){var ve=[Me+Fe[Jt][0],Me+Fe[Jt][1],Me+Fe[Jt][2],Me+Fe[Jt][3]];if(ft=zr.faceidx,Mt[ft]=ve[0],Mt[ft+1]=ve[1],Mt[ft+2]=ve[3],Mt[ft+3]=ve[1],Mt[ft+4]=ve[2],Mt[ft+5]=ve[3],zr.faceidx+=6,mt.clickable||Le.clickable||mt.hoverable||Le.hoverable){var we=V[ve[3]].clone(),it=V[ve[0]].clone(),rt=V[ve[2]].clone(),Yt=V[ve[1]].clone();if(we.atom=V[ve[3]].atom||null,rt.atom=V[ve[2]].atom||null,it.atom=V[ve[0]].atom||null,Yt.atom=V[ve[1]].atom||null,ie){var Ot=we.clone().add(it).multiplyScalar(.5),re=rt.clone().add(Yt).multiplyScalar(.5),tt=we.clone().add(Yt).multiplyScalar(.5);Jt%2===0?((Le.clickable||Le.hoverable)&&(Wt=new c.Triangle(Ot,tt,we),Gr=new c.Triangle(re,rt,tt),Lr=new c.Triangle(tt,rt,we),Le.intersectionShape.triangle.push(Wt),Le.intersectionShape.triangle.push(Gr),Le.intersectionShape.triangle.push(Lr)),(mt.clickable||mt.hoverable)&&(Wt=new c.Triangle(it,Yt,tt),Gr=new c.Triangle(Yt,re,tt),Lr=new c.Triangle(it,tt,Ot),mt.intersectionShape.triangle.push(Wt),mt.intersectionShape.triangle.push(Gr),mt.intersectionShape.triangle.push(Lr))):((mt.clickable||mt.hoverable)&&(Wt=new c.Triangle(Ot,tt,we),Gr=new c.Triangle(re,rt,tt),Lr=new c.Triangle(tt,rt,we),mt.intersectionShape.triangle.push(Wt),mt.intersectionShape.triangle.push(Gr),mt.intersectionShape.triangle.push(Lr)),(Le.clickable||Le.hoverable)&&(Wt=new c.Triangle(it,Yt,tt),Gr=new c.Triangle(Yt,re,tt),Lr=new c.Triangle(it,tt,Ot),Le.intersectionShape.triangle.push(Wt),Le.intersectionShape.triangle.push(Gr),Le.intersectionShape.triangle.push(Lr)))}else(mt.clickable||mt.hoverable)&&(Wt=new c.Triangle(it,Yt,we),Gr=new c.Triangle(Yt,rt,we),mt.intersectionShape.triangle.push(Wt),mt.intersectionShape.triangle.push(Gr))}}}zr.vertices+=8,Le=mt}var lt=V.length-8;for(zr=j.updateGeoGroup(8),Nr=zr.vertexArray,At=zr.colorArray,Mt=zr.faceArray,Me=zr.vertices,je=Me*3,ft=zr.faceidx,ht=0;ht<4;ht++){V.push(V[ht*2]),V.push(V[lt+ht*2]);var cr=V[ht*2],et=V[lt+ht*2];Nr[je+6*ht]=cr.x,Nr[je+1+6*ht]=cr.y,Nr[je+2+6*ht]=cr.z,Nr[je+3+6*ht]=et.x,Nr[je+4+6*ht]=et.y,Nr[je+5+6*ht]=et.z,At[je+6*ht]=jt.r,At[je+1+6*ht]=jt.g,At[je+2+6*ht]=jt.b,At[je+3+6*ht]=jt.r,At[je+4+6*ht]=jt.g,At[je+5+6*ht]=jt.b}lt+=8,Wt=[Me,Me+2,Me+6,Me+4],Gr=[Me+1,Me+5,Me+7,Me+3],Mt[ft]=Wt[0],Mt[ft+1]=Wt[1],Mt[ft+2]=Wt[3],Mt[ft+3]=Wt[1],Mt[ft+4]=Wt[2],Mt[ft+5]=Wt[3],Mt[ft+6]=Gr[0],Mt[ft+7]=Gr[1],Mt[ft+8]=Gr[3],Mt[ft+9]=Gr[1],Mt[ft+10]=Gr[2],Mt[ft+11]=Gr[3],zr.faceidx+=12,zr.vertices+=8}}function S(j,B,$,H,q,W,Y){(!Y||Y==="default")&&(Y="rectangle"),Y==="edged"?w(j,B,$,H,q):(Y==="rectangle"||Y==="oval"||Y==="parabola")&&v(j,B,$,H,q,W,Y)}function A(j){return j&&j.elem==="C"&&j.atom==="CA"}function u(j,B){if(j&&B&&j.chain===B.chain){if(!j.hetflag&&!B.hetflag&&j.reschain===B.reschain&&(j.resi===B.resi||j.resi===B.resi-1))return!0;if(j.resi<B.resi){var $=j.x-B.x,H=j.y-B.y,q=j.z-B.z,W=$*$+H*H+q*q;if(j.atom=="CA"&&B.atom=="CA"&&W<16||(j.atom=="P"||B.atom=="P")&&W<64)return!0}}return!1}function y(j,B,$,H,q){if(!(B==null||B.vertices==0)){q&&(B.initTypedArrays(),B.setUpNormals());var W=new h.MeshDoubleLambertMaterial;W.vertexColors=h.Coloring.FaceColors,typeof $=="number"&&$>=0&&$<1&&(W.transparent=!0,W.opacity=$),W.outline=H;var Y=new h.Mesh(B,W);j.add(Y)}}function C(j,B,$,H,q,W,Y,G,V){var Q,xe,ce,Ne,Pe,Fe;if(!(!H||!q||!Y)){var Me=q.sub(H);Me.normalize();var je=G[V];for(xe=V+1;xe<G.length&&(je=G[xe],je.atom!=Y.atom);xe++);if(je=je?new a.Vector3(je.x,je.y,je.z):new a.Vector3(0,0,0),je.sub(H),Y.ss==="arrow start"){var ft=je.clone().multiplyScalar(.3).cross(q);H.add(ft);var jt=je.clone().cross(Me).normalize();Me.rotateAboutVector(jt,.43)}for(Y.style.cartoon.ribbon?Q=Y.style.cartoon.thickness||z:Y.style.cartoon.width?Q=Y.style.cartoon.width:Y.ss==="c"?Y.atom==="P"?Q=R:Q=E:Y.ss==="arrow start"?(Q=M,Pe=!0):Y.ss==="arrow end"||Y.ss==="h"&&Y.style.cartoon.tubes||Y.ss==="tube start"?Q=E:Q=M,W!=null&&Me.dot(W)<0&&Me.negate(),Me.multiplyScalar(Q),xe=0;xe<B;xe++)ce=-1+xe*2/(B-1),Ne=new a.Vector3(H.x+ce*Me.x,H.y+ce*Me.y,H.z+ce*Me.z),Ne.atom=Y,Y.ss==="s"&&(Ne.smoothen=!0),j[xe].push(Ne);if(Pe)for(Me.multiplyScalar(2),xe=0;xe<B;xe++)ce=-1+xe*2/(B-1),Ne=new a.Vector3(H.x+ce*Me.x,H.y+ce*Me.y,H.z+ce*Me.z),Ne.atom=Y,Ne.smoothen=!1,Ne.skip=!0,j[xe].push(Ne);return Fe=Y.style.cartoon.style||"default",j.style?j.style!=Fe&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),j.style="default"):j.style=Fe,(Y.ss==="arrow start"||Y.ss==="arrow end")&&(Y.ss="s"),Pe}}const k={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},I={DA:!0,DG:!0,A:!0,G:!0},O={DT:!0,DC:!0,U:!0,C:!0,T:!0},D={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function X(j,B,$,H=10){let q=H,W=H;var Y,G,V,Q,xe,ce,Ne,Pe,Fe,Me,je,ft,jt,Gt,mt,Le,ht,ar,Jt=new h.Geometry(!0),Wt=new h.Geometry(!0),Gr=[],Lr=[],zr=1,Nr=!1,At={};for(var Mt in _.Gradient.builtinGradients)_.Gradient.builtinGradients.hasOwnProperty(Mt)&&(At[Mt]=new _.Gradient.builtinGradients[Mt]($[1],$[0]));var Jr=function(se,_t){return $&&_t.color==="spectrum"?_t.colorscheme in At?At[_t.colorscheme].valueToHex(se.resi):At.sinebow.valueToHex(se.resi):(0,b.getColorFromStyle)(se,_t).getHex()};for(Pe=0;Pe<q;Pe++)Lr[Pe]=[];var qr=!1,ie=!1,ve=[];for(Pe in B){if(Q=B[Pe],Q.elem==="C"&&Q.atom==="CA"){var we=u(V,Q);we&&Q.ss==="s"?qr=!0:qr&&(V&&G&&V.style.cartoon.arrows&&G.style.cartoon.arrows&&(V.ss="arrow end",G.ss="arrow start"),qr=!1),we&&(V.ss==="h"||V.ss=="tube start")&&V.style.cartoon.tubes?!ie&&V.ss!="tube start"&&Q.style.cartoon.tubes&&(Q.ss="tube start",ie=!0):ie&&(V.ss==="tube start"?V.ss="tube end":G&&G.style.cartoon.tubes&&(G.ss="tube end"),ie=!1),G=V,V=Q}Q&&Q.atom in k&&ve.push(Q)}ie&&V.style.cartoon.tubes&&(V.ss="tube end",ie=!1);var it=function(se){Lr[0].length>0&&S(Wt,Lr,Gr,W,Ne,zr,Lr.style);var _t=[],Wr=null;if(se){for(Pe=0;Pe<q;Pe++)_t[Pe]=Lr[Pe][Lr[Pe].length-1];Wr=Gr[Gr.length-1]}for(Lr=[],Pe=0;Pe<q;Pe++)Lr[Pe]=[];if(Gr=[],se){for(Pe=0;Pe<q;Pe++)Lr[Pe].push(_t[Pe]);Gr.push(Wr)}y(j,Wt,zr,Nr,!0),y(j,Jt,zr,Nr,!1),Wt=new h.Geometry(!0),Jt=new h.Geometry(!0)};V=void 0;for(var rt=0;rt<ve.length;rt++){Q=ve[rt];var Yt=Q.resn.trim(),Ot=Yt in D;if(zr=1,Y=Q.style.cartoon,V&&V.style.cartoon&&(zr=V.style.cartoon.opacity),V&&V.style.cartoon&&V.style.cartoon.outline&&(Nr=V.style.cartoon.outline),V&&V.style.cartoon&&(!Q.style.cartoon||V.style.cartoon.opacity!=Q.style.cartoon.opacity)&&it(V.chain==Q.chain),Y.style==="trace"){if(!Q.hetflag&&(Q.elem==="C"&&Q.atom==="CA"||Ot&&Q.atom==="P"||Q.atom==="BB")){if(ce=Jr(Q,Y),(0,b.isNumeric)(Y.thickness)?Ne=Y.thickness:Ne=z,u(V,Q))if(ce==xe){var re=f.CC.color(ce);g.GLDraw.drawCylinder(Jt,V,Q,Ne,re,2,2)}else{var tt=new a.Vector3().addVectors(V,Q).multiplyScalar(.5),lt=f.CC.color(xe),cr=f.CC.color(ce);g.GLDraw.drawCylinder(Jt,V,tt,Ne,lt,2,0),g.GLDraw.drawCylinder(Jt,tt,Q,Ne,cr,0,2)}if((Q.clickable===!0||Q.hoverable)&&Q.intersectionShape!==void 0){var et=new a.Vector3(Q.x,Q.y,Q.z);Q.intersectionShape.sphere.push(new c.Sphere(et,Ne))}V=Q,xe=ce}}else{if(A(Q)||Ot&&(Q.atom==="P"||Q.atom.indexOf("O5")==0)){if(ar)if(Q.ss==="tube end")ar=!1,ht=new a.Vector3(Q.x,Q.y,Q.z),g.GLDraw.drawCylinder(Jt,Le,ht,2,f.CC.color(xe),1,1),Q.ss="h";else if(V.chain!=Q.chain||V.ss==="tube end")ar=!1,V.ss="h",ht=new a.Vector3(V.x,V.y,V.z),g.GLDraw.drawCylinder(Jt,Le,ht,2,f.CC.color(xe),1,1);else continue;if(V&&(!u(V,Q)||V.ss==="tube start")){for(V.ss==="tube start"&&(ar=!0,Le=new a.Vector3(V.x,V.y,V.z),V.ss="h"),mt&&(ft?Gt=new a.Vector3().addVectors(V,ft).multiplyScalar(.5):Gt=new a.Vector3(V.x,V.y,V.z),g.GLDraw.drawCylinder(Jt,Gt,mt,l,f.CC.color(mt.color),0,2),C(Lr,q,!0,ft,jt,je,V,ve,rt),Gr.push(ce),Gt=null,mt=null),Lr[0].length>0&&S(Wt,Lr,Gr,W,Ne,zr,Lr.style),Lr=[],Pe=0;Pe<q;Pe++)Lr[Pe]=[];Gr=[]}if(V===void 0||V.rescode!=Q.rescode||V.resi!=Q.resi){if(mt&&V!=null){Gt=new a.Vector3().addVectors(V,Q).multiplyScalar(.5);var Ft=Gt.clone().sub(mt).multiplyScalar(.02);Gt.add(Ft),g.GLDraw.drawCylinder(Jt,Gt,mt,l,f.CC.color(mt.color),0,2),Gt=null,mt=null}ce=Jr(Q,Y),Gr.push(ce),(0,b.isNumeric)(Y.thickness)?Ne=Y.thickness:Ne=z,V=Q,Fe=new a.Vector3(V.x,V.y,V.z),Fe.resi=V.resi,xe=ce}(Q.clickable===!0||Q.hoverable===!0)&&(Q.intersectionShape===void 0||Q.intersectionShape.triangle===void 0)&&(Q.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else V!=null&&(A(V)&&Q.atom==="O"||Ot&&V.atom==="P"&&(Q.atom==="OP2"||Q.atom==="O2P")||Ot&&V.atom.indexOf("O5")==0&&Q.atom.indexOf("C5")==0)?(Me=new a.Vector3(Q.x,Q.y,Q.z),Me.resi=Q.resi,(Q.atom==="OP2"||Q.atom==="O2P")&&(jt=new a.Vector3(Q.x,Q.y,Q.z))):Ot&&Q.atom.indexOf("O3")==0?ft=new a.Vector3(Q.x,Q.y,Q.z):(Q.atom==="N1"&&Yt in I||Q.atom==="N3"&&Yt in O)&&(mt=new a.Vector3(Q.x,Q.y,Q.z),mt.color=(0,b.getColorFromStyle)(Q,Y).getHex());Me&&Fe&&Me.resi===Fe.resi&&(C(Lr,q,!0,Fe,Me,je,V,ve,rt),je=Me,Fe=null,Me=null,Gr.push(ce))}}mt&&(ft?Gt=new a.Vector3().addVectors(V,ft).multiplyScalar(.5):Gt=new a.Vector3(V.x,V.y,V.z),g.GLDraw.drawCylinder(Jt,Gt,mt,l,f.CC.color(mt.color),0,2),C(Lr,q,!0,ft,jt,je,V,ve,rt),Gr.push(ce)),it(!1)}}),"./src/index.ts":((e,r,t)=>{t.r(r),t.d(r,{CAP:()=>l.CAP,CC:()=>c.CC,CONTEXTS_PER_VIEWPORT:()=>w.CONTEXTS_PER_VIEWPORT,Color:()=>c.Color,CustomLinear:()=>a.CustomLinear,Cylinder:()=>b.Cylinder,GLDraw:()=>l.GLDraw,GLModel:()=>v.GLModel,GLShape:()=>z.GLShape,GLViewer:()=>w.GLViewer,GLVolumetricRender:()=>R.GLVolumetricRender,Gradient:()=>a.Gradient,GradientType:()=>a.GradientType,Label:()=>h.Label,LabelCount:()=>h.LabelCount,MarchingCube:()=>E.MarchingCube,MarchingCubeInitializer:()=>E.MarchingCubeInitializer,Matrix3:()=>g.Matrix3,Matrix4:()=>g.Matrix4,Parsers:()=>f.Parsers,PausableTimer:()=>p.PausableTimer,PointGrid:()=>E.PointGrid,ProteinSurface:()=>E.ProteinSurface,Quaternion:()=>g.Quaternion,ROYGB:()=>a.ROYGB,RWB:()=>a.RWB,Ray:()=>g.Ray,Sinebow:()=>a.Sinebow,Sphere:()=>b.Sphere,SurfaceType:()=>E.SurfaceType,Triangle:()=>b.Triangle,Vector2:()=>g.Vector2,Vector3:()=>g.Vector3,VolumeData:()=>M.VolumeData,adjustVolumeStyle:()=>p.adjustVolumeStyle,applyPartialCharges:()=>_.applyPartialCharges,autoinit:()=>S.autoinit,autoload:()=>S.autoload,base64ToArray:()=>p.base64ToArray,bondLength:()=>f.bondLength,builtinColorSchemes:()=>c.builtinColorSchemes,builtinGradients:()=>a.builtinGradients,chains:()=>c.chains,clamp:()=>g.clamp,conversionMatrix3:()=>g.conversionMatrix3,createStereoViewer:()=>w.createStereoViewer,createViewer:()=>w.createViewer,createViewerGrid:()=>w.createViewerGrid,deepCopy:()=>p.deepCopy,degToRad:()=>g.degToRad,download:()=>p.download,drawCartoon:()=>s.drawCartoon,elementColors:()=>c.elementColors,extend:()=>p.extend,get:()=>p.get,getAtomProperty:()=>p.getAtomProperty,getColorFromStyle:()=>p.getColorFromStyle,getElement:()=>p.getElement,getExtent:()=>p.getExtent,getGradient:()=>a.getGradient,getPropertyRange:()=>p.getPropertyRange,getbin:()=>p.getbin,htmlColors:()=>c.htmlColors,inflateString:()=>p.inflateString,isEmptyObject:()=>p.isEmptyObject,isNumeric:()=>p.isNumeric,makeFunction:()=>p.makeFunction,mergeGeos:()=>p.mergeGeos,normalizeValue:()=>a.normalizeValue,partialCharges:()=>_.partialCharges,processing_autoinit:()=>S.processing_autoinit,residues:()=>c.residues,setBondLength:()=>f.setBondLength,setSyncSurface:()=>E.setSyncSurface,specStringToObject:()=>p.specStringToObject,splitMesh:()=>z.splitMesh,ssColors:()=>c.ssColors,subdivide_spline:()=>s.subdivide_spline,syncSurface:()=>E.syncSurface,viewers:()=>S.viewers});var a=t("./src/Gradient.ts"),c=t("./src/colors.ts"),h=t("./src/Label.ts"),_=t("./src/partialCharges.ts"),f=t("./src/parsers/index.ts"),g=t("./src/WebGL/math/index.ts"),b=t("./src/WebGL/shapes/index.ts"),p=t("./src/utilities.ts"),E=t("./src/ProteinSurface4.ts"),M=t("./src/VolumeData.ts"),R=t("./src/VolumetricRender.ts"),z=t("./src/GLShape.ts"),l=t("./src/GLDraw.ts"),s=t("./src/glcartoon.ts"),v=t("./src/GLModel.ts"),w=t("./src/GLViewer.ts"),S=t("./src/autoload.ts");t("./src/specs.ts"),window&&(window.$3Dmol=r)}),"./src/parsers/BCIF.ts":((e,r,t)=>{t.r(r),t.d(r,{BCIF:()=>z});var a=t("./src/utilities.ts"),c=t("./src/parsers/utils/computeSecondaryStructure.ts"),h=t("./src/parsers/utils/processSymmetries.ts"),_=t("./src/parsers/cifutils/category.ts"),f=t("./src/parsers/utils/assignPDBBonds.ts"),g=t("./src/WebGL/index.ts"),b=t("./src/parsers/utils/isEmpty.ts"),p=t("./src/vendor/mmtf.js");class E{constructor(s){if(this.C={},s){let v=s.getField("comp_id"),w=s.getField("atom_id_1"),S=s.getField("atom_id_2"),A=s.getField("value_order");for(let u=0;u<v.length;u++){let y=v[u],C=w[u],k=S[u],I=A[u],O=1;I=="doub"?O=2:I=="trip"&&(O=3),this.C[y]==null&&(this.C[y]={}),this.C[y][C]==null&&(this.C[y][C]={}),this.C[y][k]==null&&(this.C[y][k]={}),this.C[y][C][k]=O,this.C[y][k][C]=O}}}order(s,v,w){return this.C[s]!==void 0&&this.C[s][v]!==void 0&&this.C[s][v][w]!==void 0?this.C[s][v][w]:0}}class M{constructor(s){if(this.C=[],s){let v=s.getField("conn_type_id"),w=s.getField("ptnr1_label_asym_id"),S=s.getField("ptnr1_label_seq_id"),A=s.getField("ptnr1_label_comp_id"),u=s.getField("ptnr1_label_atom_id"),y=s.getField("ptnr2_label_asym_id"),C=s.getField("ptnr2_label_seq_id"),k=s.getField("ptnr2_label_comp_id"),I=s.getField("ptnr2_label_atom_id"),O=s.getField("pdbx_value_order");for(let D=0;D<v.length;D++)if(v[D]=="disulf"||v[D]=="covale"){let X=O?O[D]==""?1:parseInt(O[D]):1;this.C.push([[w[D],S[D],A[D],u[D]],[y[D],C[D],k[D],I[D]],X])}}}}class R{constructor(){this.R={}}add(s){this.R[s.lchain]==null&&(this.R[s.lchain]={}),this.R[s.lchain][s.lresi]==null&&(this.R[s.lchain][s.lresi]={}),this.R[s.lchain][s.lresi][s.lresn]==null&&(this.R[s.lchain][s.lresi][s.lresn]=[]),this.R[s.lchain][s.lresi][s.lresn].push(s),this.R[s.lchain][s.lresi][s.lresn][s.atom]=s}geta([s,v,w,S]){if(this.R[s]!==void 0&&this.R[s][v]!==void 0&&this.R[s][v][w]!==void 0)return this.R[s][v][w][S]}setBonds(s,v){for(let w in this.R)for(let S in this.R[w])for(let A in this.R[w][S]){let u=this.R[w][S][A];for(let y=0;y<u.length;y++)for(let C=y+1;C<u.length;C++){let k=u[y],I=u[C],O=s.order(A,k.atom,I.atom);O>0&&(k.bonds.push(I.index),I.bonds.push(k.index),k.bondOrder.push(O),I.bondOrder.push(O))}}for(let w of v.C){let S=w[0],A=w[1],u=w[2],y=this.geta(S),C=this.geta(A);y!=null&&C!=null&&(y.bonds.push(C.index),C.bonds.push(y.index),y.bondOrder.push(u),C.bondOrder.push(u))}}}function z(l,s){var v=!s.keepH,w=s.altLoc?s.altLoc:"A",S=!s.noComputeSecondaryStructure;const A=!s.doAssembly,u=s.assignBonds===void 0?!0:s.assignBonds;if(typeof l=="string")try{l=(0,a.base64ToArray)(l)}catch{l=new TextEncoder().encode(l)}else l=new Uint8Array(l);var y=p.decodeMsgpack(l);y==31&&(l=(0,a.inflateString)(l,!1),y=p.decodeMsgpack(l));var C=[],k=C.modelData=[],I=y.dataBlocks.length;if(I==0)return C;s.multimodel||(I=1);for(let O=0;O<I;O++){let D=C.length;const X=[];k.push({symmetries:[]}),C.push([]);const j=y.dataBlocks[O],B=Object.create(null);for(const At of j.categories)B[At.name.substr(1)]=(0,_.Category)(At);let $={},H=B.struct_conf;if(H){let At=H.getField("conf_type_id"),Mt=H.getField("beg_label_asym_id"),Jr=H.getField("beg_label_seq_id"),qr=H.getField("end_label_seq_id");for(let ie=0;ie<At.length;ie++)if(At[ie].startsWith("H")){let ve=Mt[ie],we=Jr[ie],it=qr[ie];ve in $||($[ve]={}),$[ve][we]="h1";for(let rt=we+1;rt<it;rt++)$[ve][rt]="h";$[ve][it]="h2"}}let q=B.struct_sheet_range;if(q){let At=q.getField("id"),Mt=q.getField("beg_label_asym_id"),Jr=q.getField("beg_label_seq_id"),qr=q.getField("end_label_seq_id");for(let ie=0;ie<At.length;ie++){let ve=Mt[ie],we=Jr[ie],it=qr[ie];ve in $||($[ve]={}),$[ve][we]="s1";for(let rt=we+1;rt<it;rt++)$[ve][rt]="s";$[ve][it]="s2"}}let W=B.pdbx_struct_oper_list,Y=W.getField("id");if(Y&&!A){let At=W.getField("matrix[1][1]"),Mt=W.getField("matrix[1][2]"),Jr=W.getField("matrix[1][3]"),qr=W.getField("matrix[2][1]"),ie=W.getField("matrix[2][2]"),ve=W.getField("matrix[2][3]"),we=W.getField("matrix[3][1]"),it=W.getField("matrix[3][2]"),rt=W.getField("matrix[3][3]"),Yt=W.getField("vector[1]"),Ot=W.getField("vector[2]"),re=W.getField("vector[3]");for(let tt=0;tt<Y.length;tt++){const lt=new g.Matrix4(At[tt],Mt[tt],Jr[tt],Yt[tt],qr[tt],ie[tt],ve[tt],Ot[tt],we[tt],it[tt],rt[tt],re[tt]);k[k.length-1].symmetries.push(lt)}}let G=new E(B.chem_comp_bond),V=new R,Q=new M(B.struct_conn),xe=B.atom_site,ce=xe.rowCount,Ne=xe.getField("group_PDB"),Pe=xe.getField("Cartn_x"),Fe=xe.getField("Cartn_y"),Me=xe.getField("Cartn_z"),je=xe.getField("auth_asym_id"),ft=xe.getField("label_asym_id"),jt=xe.getField("auth_seq_id"),Gt=xe.getField("label_seq_id"),mt=xe.getField("auth_comp_id"),Le=xe.getField("label_comp_id"),ht=xe.getField("auth_atom_id"),ar=xe.getField("label_atom_id"),Jt=xe.getField("type_symbol"),Wt=xe.getField("B_iso_or_equiv"),Gr=xe.getField("id"),Lr=xe.getField("label_alt_id"),zr=xe.getField("pdbx_PDB_model_num"),Nr=zr?zr[0]:0;for(let At=0;At<ce;At++){if(Ne!==void 0&&Ne[At]==="TER")continue;if(zr&&zr[At]!=Nr)if(Nr=zr[At],s.multimodel)s.onemol||(C.push([]),k.push(k[k.length-1]),Nr=zr[At],V.setBonds(G,Q),V=new R);else break;const Mt={};Mt.x=Pe[At],Mt.y=Fe[At],Mt.z=Me[At],Mt.chain=je?je[At]:ft?ft[At]:void 0,Mt.lchain=ft?ft[At]:void 0,Mt.resi=jt?jt[At]:Gt?Gt[At]:void 0,Mt.lresi=Gt?Gt[At]:void 0,Mt.resn=mt?mt[At].trim():Le?Le[At].trim():void 0,Mt.lresn=Le?Le[At].trim():void 0,Mt.atom=ht?ht[At].replace(/"/gm,""):ar?ar[At].replace(/"/gm,""):void 0,Mt.icode=Lr?Lr[At]:void 0,Mt.altLoc=Mt.icode,Mt.hetflag=!Ne||Ne[At]==="HETA"||Ne[At]==="HETATM";let Jr="X";Jt&&(Jr=Jt[At].replace(/\(?\+?\d+.*/,"")),Mt.elem=Jr[0].toUpperCase()+Jr.substring(1,2).toLowerCase(),Wt&&(Mt.b=Wt[At]),!(v&&Mt.elem=="H")&&(Mt.altLoc!=""&&Mt.altLoc!=w&&w!="*"||(Mt.bonds=[],Mt.ss="c",Mt.serial=Gr[At],Mt.model=Nr,Mt.bondOrder=[],Mt.properties={},Mt.index=C[C.length-1].length,X[Mt.serial]=[C.length,Mt.index],C[C.length-1].push(Mt),V.add(Mt)))}if(V.setBonds(G,Q),!(0,b.isEmpty)($))for(let At=D;At<C.length;At++){let Mt=C[At];for(let Jr=0;Jr<Mt.length;Jr++){const qr=Mt[Jr];if(qr!==void 0&&qr.lchain in $&&qr.lresi in $[qr.lchain]){const ie=$[qr.lchain][qr.lresi];qr.ss=ie[0],ie.length>1&&(ie[1]=="1"?qr.ssbegin=!0:ie[1]=="2"&&(qr.ssend=!0))}}}s.multimodel&&O<I-1&&(s.onemol||(C.push([]),k.push({symmetries:[]})))}for(let O=0;O<C.length;O++)u&&!(s.duplicateAssemblyAtoms&&!s.dontConnectDuplicatedAtoms)&&(0,f.assignPDBBonds)(C[O],s),S&&(0,c.computeSecondaryStructure)(C[O],s.hbondCutoff),(0,h.processSymmetries)(k[O].symmetries,C[O],s,k[O].cryst),s.duplicateAssemblyAtoms&&!s.dontConnectDuplicatedAtoms&&u&&(0,f.assignPDBBonds)(C[O],s);return C}}),"./src/parsers/CDJSON.ts":((e,r,t)=>{t.r(r),t.d(r,{CDJSON:()=>a});function a(c,h){var _=[[]];typeof c=="string"&&(c=JSON.parse(c));for(var f=c.m,g=f[0].a,b=f[0].b,p=f[0].s,E=h!==void 0&&h.parseStyle!==void 0?h.parseStyle:p!==void 0,M=_[_.length-1].length,R=0;R<g.length;R++){var z=g[R],l={};l.id=z.i,l.x=z.x,l.y=z.y,l.z=z.z||0,l.bonds=[],l.bondOrder=[];var s=z.l||"C";l.elem=s[0].toUpperCase()+s.substring(1).toLowerCase(),l.serial=_[_.length-1].length,E&&(l.style=p[z.s||0]),_[_.length-1].push(l)}for(let v=0;v<b.length;v++){let w=b[v],S=w.b+M,A=w.e+M,u=w.o||1,y=_[_.length-1][S],C=_[_.length-1][A];y.bonds.push(A),y.bondOrder.push(u),C.bonds.push(S),C.bondOrder.push(u)}return _}}),"./src/parsers/CIF.ts":((e,r,t)=>{t.r(r),t.d(r,{CIF:()=>g});var a=t("./src/parsers/utils/computeSecondaryStructure.ts"),c=t("./src/parsers/utils/processSymmetries.ts"),h=t("./src/WebGL/index.ts"),_=t("./src/parsers/utils/assignPDBBonds.ts");const f=function(b,p,E,M){return new h.Vector3(p,E,M).applyMatrix3(b)};function g(b,p={}){const E=[],M=!p.doAssembly,R=E.modelData=[],z=p.assignBonds===void 0?!0:p.assignBonds;function l(u,y){const C=[];let k=0,I=0;for(;I<u.length;){for(;u.substring(I,I+y.length)!==y&&I<u.length;)if(u[I]==="'"){for(I++;I<u.length&&u[I]!=="'";)I++;for(;u.substring(I,I+y.length)!==y&&I<u.length;)I++}else if(u[I]==='"'){for(I++;I<u.length&&u[I]!=='"';)I++;I++}else I++;C.push(u.substring(k,I)),k=I=I+y.length}return C}const s=b.split(/\r?\n|\r/),v=[];let w=!1;for(let u=0;u<s.length;u++){var S=s[u].split("#")[0];if(w?S[0]===";"&&(w=!1):S[0]===";"&&(w=!0),w||S!==""){if(!w&&(S=S.trim(),S[0]==="_")){const y=S.split(/\s/)[0].indexOf(".");if(y>-1){let C=S.split("");C[y]="_",S=C.join(""),S=S.substring(0,y)+"_"+S.substring(y+1)}}v.push(S)}}let A=0;for(;A<v.length;){for(;!v[A].startsWith("data_")||v[A]==="data_global";)A++;A++;const u={};for(;A<v.length&&!v[A].startsWith("data_");)if(v[A][0]===void 0)A++;else if(v[A][0]==="_"){const I=v[A].split(/\s/)[0].toLowerCase(),O=u[I]=u[I]||[],D=v[A].substring(v[A].indexOf(I)+I.length);if(D==="")if(A++,v[A][0]===";"){let X=v[A].substring(1);for(A++;v[A]!==";";)X=X+`
`+v[A],A++;O.push(X)}else O.push(v[A]);else O.push(D.trim());A++}else if(v[A].substring(0,5)==="loop_"){A++;const I=[];for(;v[A]===""||v[A][0]==="_";){if(v[A]!==""){let D=v[A].split(/\s/)[0].toLowerCase(),X=u[D]=u[D]||[];I.push(X)}A++}let O=0;for(;A<v.length&&v[A][0]!=="_"&&!v[A].startsWith("loop_")&&!v[A].startsWith("data_");){let D=l(v[A]," ");for(let X=0;X<D.length;X++)D[X]!==""&&(I[O].push(D[X]),O=(O+1)%I.length);A++}}else A++;R.push({symmetries:[]}),E.push([]);const y=u._atom_site_id!==void 0?u._atom_site_id.length:u._atom_site_label.length;let C;if(u._cell_length_a!==void 0){const I=parseFloat(u._cell_length_a),O=parseFloat(u._cell_length_b),D=parseFloat(u._cell_length_c),X=parseFloat(u._cell_angle_alpha)||90,j=parseFloat(u._cell_angle_beta)||90,B=parseFloat(u._cell_angle_gamma)||90;C=(0,h.conversionMatrix3)(I,O,D,X,j,B),R[R.length-1].cryst={a:I,b:O,c:D,alpha:X,beta:j,gamma:B}}for(let I=0;I<y;I++){if(u._atom_site_group_pdb!==void 0&&u._atom_site_group_pdb[I]==="TER")continue;const O={};if(u._atom_site_cartn_x!==void 0)O.x=parseFloat(u._atom_site_cartn_x[I]),O.y=parseFloat(u._atom_site_cartn_y[I]),O.z=parseFloat(u._atom_site_cartn_z[I]);else{const X=f(C,parseFloat(u._atom_site_fract_x[I]),parseFloat(u._atom_site_fract_y[I]),parseFloat(u._atom_site_fract_z[I]));O.x=X.x,O.y=X.y,O.z=X.z}O.chain=u._atom_site_auth_asym_id?u._atom_site_auth_asym_id[I]:u._atom_site_label_asym_id?u._atom_site_label_asym_id[I]:void 0,O.resi=u._atom_site_auth_seq_id?parseInt(u._atom_site_auth_seq_id[I]):u._atom_site_label_seq_id?u._atom_site_label_seq_id[I]:void 0,O.resn=u._atom_site_auth_comp_id?u._atom_site_auth_comp_id[I].trim():u._atom_site_label_comp_id?u._atom_site_label_comp_id[I].trim():void 0,O.atom=u._atom_site_auth_atom_id?u._atom_site_auth_atom_id[I].replace(/"/gm,""):u._atom_site_label_atom_id?u._atom_site_label_atom_id[I].replace(/"/gm,""):void 0,O.hetflag=!u._atom_site_group_pdb||u._atom_site_group_pdb[I]==="HETA"||u._atom_site_group_pdb[I]==="HETATM",u._atom_site_b_iso_or_equiv&&(O.b=parseFloat(u._atom_site_b_iso_or_equiv[I]));let D="X";u._atom_site_type_symbol?D=u._atom_site_type_symbol[I].replace(/\(?\+?\d+.*/,""):u._atom_site_label&&(D=u._atom_site_label[I].split("_")[0].replace(/\(?\d+.*/,"")),O.elem=D[0].toUpperCase()+D.substring(1,2).toLowerCase(),O.bonds=[],O.ss="c",O.serial=I,O.bondOrder=[],O.properties={},E[E.length-1].push(O)}if(u._pdbx_struct_oper_list_id!==void 0&&!M)for(let I=0;I<u._pdbx_struct_oper_list_id.length;I++){const O=parseFloat(u["_pdbx_struct_oper_list_matrix[1][1]"][I]),D=parseFloat(u["_pdbx_struct_oper_list_matrix[1][2]"][I]),X=parseFloat(u["_pdbx_struct_oper_list_matrix[1][3]"][I]),j=parseFloat(u["_pdbx_struct_oper_list_vector[1]"][I]),B=parseFloat(u["_pdbx_struct_oper_list_matrix[2][1]"][I]),$=parseFloat(u["_pdbx_struct_oper_list_matrix[2][2]"][I]),H=parseFloat(u["_pdbx_struct_oper_list_matrix[2][3]"][I]),q=parseFloat(u["_pdbx_struct_oper_list_vector[2]"][I]),W=parseFloat(u["_pdbx_struct_oper_list_matrix[3][1]"][I]),Y=parseFloat(u["_pdbx_struct_oper_list_matrix[3][2]"][I]),G=parseFloat(u["_pdbx_struct_oper_list_matrix[3][3]"][I]),V=parseFloat(u["_pdbx_struct_oper_list_vector[3]"][I]),Q=new h.Matrix4(O,D,X,j,B,$,H,q,W,Y,G,V);R[R.length-1].symmetries.push(Q)}const k=function(I){const O=I.match("-");I=I.replace(/[-xyz]/g,"");const D=I.split("/");let X,j;return D[1]===void 0?j=1:j=parseInt(D[1]),D[0]===""?X=1:X=parseInt(D[0]),X/j*(O?-1:1)};if(u._symmetry_equiv_pos_as_xyz!==void 0&&!M)for(let I=0;I<u._symmetry_equiv_pos_as_xyz.length;I++){const O=u._symmetry_equiv_pos_as_xyz[I].replace(/["' ]/g,"").split(",").map(function(B){return B.replace(/-/g,"+-")});let D=new h.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let B=0;B<3;B++){const $=O[B].split("+");for(let H=0;H<$.length;H++){const q=$[H];if(q==="")continue;const W=k(q);q.match("x")?D.elements[B+0]=W:q.match("y")?D.elements[B+4]=W:q.match("z")?D.elements[B+8]=W:D.elements[B+12]=W}}const X=C.getMatrix4(),j=new h.Matrix4().getInverse(X,!0);D=new h.Matrix4().multiplyMatrices(D,j),D=new h.Matrix4().multiplyMatrices(X,D),R[R.length-1].symmetries.push(D)}}for(let u=0;u<E.length;u++)z&&!(p.duplicateAssemblyAtoms&&!p.dontConnectDuplicatedAtoms)&&(0,_.assignPDBBonds)(E[u],p),(0,a.computeSecondaryStructure)(E[u],p.hbondCutoff),(0,c.processSymmetries)(R[u].symmetries,E[u],p,R[u].cryst),p.duplicateAssemblyAtoms&&!p.dontConnectDuplicatedAtoms&&z&&(0,_.assignPDBBonds)(E[u],p);return E}}),"./src/parsers/CUBE.ts":((e,r,t)=>{t.r(r),t.d(r,{CUBE:()=>_});var a=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/assignBonds.ts"),h=t("./src/parsers/utils/anumToSymbol.ts");function _(f,g){g=g||{};const b=[[]];let p=f.split(/\r?\n/);const E=g.assignBonds===void 0?!0:g.assignBonds;if(p.length<6)return b;let M=p[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const R=Math.abs(parseFloat(M[0]));let z={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const l=z.origin=new a.Vector3(parseFloat(M[1]),parseFloat(M[2]),parseFloat(M[3]));M=p[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),M=p[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const s=M[0]>0?.529177:1;l.multiplyScalar(s);const v=Math.abs(M[0]),w=new a.Vector3(parseFloat(M[1]),parseFloat(M[2]),parseFloat(M[3])).multiplyScalar(s);M=p[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const S=Math.abs(M[0]),A=new a.Vector3(parseFloat(M[1]),parseFloat(M[2]),parseFloat(M[3])).multiplyScalar(s);M=p[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const u=Math.abs(M[0]),y=new a.Vector3(parseFloat(M[1]),parseFloat(M[2]),parseFloat(M[3])).multiplyScalar(s);if(z.size={x:v,y:S,z:u},z.unit=new a.Vector3(w.x,A.y,y.z),w.y!=0||w.z!=0||A.x!=0||A.z!=0||y.x!=0||y.y!=0){z.matrix4=new a.Matrix4(w.x,A.x,y.x,0,w.y,A.y,y.y,0,w.z,A.z,y.z,0,0,0,0,1);let j=new a.Matrix4().makeTranslation(l.x,l.y,l.z);z.matrix4=z.matrix4.multiplyMatrices(j,z.matrix4),z.matrix=z.matrix4.matrix3FromTopLeft(),z.origin=new a.Vector3(0,0,0),z.unit=new a.Vector3(1,1,1)}b.modelData=[{cryst:z}],p=p.splice(6,R);for(var C=b[b.length-1].length,k=C+p.length,I=C;I<k;++I){var O={};O.serial=I;var D=p[I-C],X=D.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");O.elem=h.anumToSymbol[X[0]],O.x=parseFloat(X[2])*s,O.y=parseFloat(X[3])*s,O.z=parseFloat(X[4])*s,O.hetflag=!0,O.bonds=[],O.bondOrder=[],O.properties={},b[b.length-1].push(O)}if(E)for(let j=0;j<b.length;j++)(0,c.assignBonds)(b[j],g);return b}}),"./src/parsers/GRO.ts":((e,r,t)=>{t.r(r),t.d(r,{GRO:()=>h});var a=t("./src/parsers/utils/assignPDBBonds.ts"),c=t("./src/parsers/utils/atomNameToElem.ts");function h(_,f){const g=[],b=_.split(/\r?\n|\r/);for(;b.length>0;){const p=parseInt(b[1]);if(b.length<3||isNaN(p)||p<=0||b.length<p+3)break;const E=[];g.push(E);let M=2;const R=E.length,z=R+p;for(let l=R;l<z;l++){const s=b[M++],v={};v.serial=l,v.atom=s.slice(10,15).trim(),v.elem=(0,c.atomNameToElem)(v.atom,!0),v.x=10*parseFloat(s.slice(20,28)),v.y=10*parseFloat(s.slice(28,36)),v.z=10*parseFloat(s.slice(36,44)),v.resi=parseInt(s.slice(0,5)),v.resn=s.slice(5,10).trim(),v.bonds=[],v.bondOrder=[],v.properties={},s.length>44&&(v.dx=10*parseFloat(s.slice(44,52)),v.dy=10*parseFloat(s.slice(52,60)),v.dz=10*parseFloat(s.slice(60,68))),E[l]=v}if(b.length<=M+3){const l=b[M++].trim().split(/\s+/);if(l.length===3){for(let s=0;s<3;s++)l[s]=(parseFloat(l[s])*10).toString();g.box=l}}b.splice(0,++M)}for(let p=0;p<g.length;p++)(0,a.assignPDBBonds)(g[p],f);return g}}),"./src/parsers/LAMMPSTRJ.ts":((e,r,t)=>{t.r(r),t.d(r,{LAMMPSTRJ:()=>h});var a=t("./src/parsers/utils/assignBonds.ts");const c={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function h(_,f){const g=[],b=_.split(/\r?\n|\r/);let p=0,E=0,M=0;for(;M<b.length-9;){for(var R=M;R<b.length;R++)if(b[R].match(/ITEM: NUMBER OF ATOMS/)&&(E=parseInt(b[R+1])),b[R].match(/ITEM: ATOMS/)){p=R+1;break}const z=b[p-1].replace("ITEM: ATOMS ","").split(" ");g.push([]);for(let l=p;l<p+E;l++){const s={},v={},w=b[l].split(" ");for(let S=0;S<w.length;S++){const A=c[z[S]];A!==void 0&&(A==="serial"?s[A]=parseInt(w[S]):A==="x"||A==="y"||A==="z"?s[A]=parseFloat(w[S]):A==="charge"||A==="radius"?v[A]=parseFloat(w[S]):s[A]=w[S]),s.properties=v,s.bonds=[],s.bondOrder=[]}g[g.length-1][l-p]=s}M=p+E-1}if(f.assignBonds)for(let z=0;z<g.length;z++)(0,a.assignBonds)(g[z],f);return g}}),"./src/parsers/MMTF.ts":((e,r,t)=>{t.r(r),t.d(r,{MMTFparser:()=>E});var a=t("./src/utilities.ts"),c=t("./src/WebGL/index.ts"),h=t("./src/parsers/utils/computeSecondaryStructure.ts"),_=t("./src/parsers/utils/processSymmetries.ts"),f=t("./src/vendor/mmtf.js"),g=function(M){return String.fromCharCode.apply(null,M).replace(/\0/g,"")},b=function(M){return M==0||M==2||M==4?"h":M==3?"s":"c"};let p=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function E(M,R){var z=!R.keepH,l=R.altLoc?R.altLoc:"A",s=!!R.noSecondaryStructure,v=!R.noComputeSecondaryStructure,w=!R.doAssembly,S=R.assemblyIndex?R.assemblyIndex:0;typeof M=="string"?M=(0,a.base64ToArray)(M):M=new Uint8Array(M);var A=f.decode(M),u=[[]],y=u.modelData=[],C=0,k=0,I=0,O=A.secStructList,D=A.bFactorList,X=A.altLocList,j=A.occupancyList,B=A.bondAtomList,$=A.bondOrderList,H=A.numModels;if(H==0)return u;R.multimodel||(H=1);var q,W,Y,G,V,Q,xe=[];if(!w&&A.bioAssemblyList&&A.bioAssemblyList.length>0){var ce=A.bioAssemblyList[S].transformList;for(q=0,Q=ce.length;q<Q;q++){var Ne=new c.Matrix4(ce[q].matrix);Ne.transpose(),xe.push(Ne)}}var Pe=null;if(A.unitCell){var Fe=A.unitCell;Pe={a:Fe[0],b:Fe[1],c:Fe[2],alpha:Fe[3],beta:Fe[4],gamma:Fe[5]}}let Me=[];A.entityList.forEach(at=>{at.chainIndexList.forEach(me=>{Me[me]=at.type=="polymer"})});var je=0;for(V=0;V<H;V++){var ft=A.chainsPerModel[V],jt=u[u.length-1],Gt=[];for(y.push({symmetries:xe,cryst:Pe}),q=0;q<ft;++q){var mt=A.groupsPerChain[C],Le=g(A.chainIdList.subarray(C*4,C*4+4));A.chainNameList&&(Le=g(A.chainNameList.subarray(C*4,C*4+4)));var ht=k,ar="";for(W=0;W<mt;++W){var Jt=A.groupList[A.groupTypeList[k]],Wt=Jt.atomNameList.length,Gr=0,Lr=!1,zr=!1;if(O){Gr=O[k];var Nr=b(Gr);(k==0||Nr!=ar)&&(Lr=!0),ar=Nr;var At=k+1;(At>=O.length||b(O[At]!=Nr))&&(zr=!0)}var Mt=A.groupIdList[k],Jr=Jt.groupName;let at=Jt.chemCompType;var qr=I;let me=p.has(at)||!Me[C];for(Y=0;Y<Wt;++Y){var ie=Jt.elementList[Y];if(z&&ie=="H"){I+=1;continue}var ve="";D&&(ve=D[I]);var we="";X&&X[I]&&(we=String.fromCharCode(X[I]));var it="";if(j&&(it=j[I]),we!=""&&we!=l&&l!="*"){I+=1;continue}var rt=A.atomIdList[I],Yt=Jt.atomNameList[Y],Ot=0;Jt.atomChargeList&&(Ot=Jt.atomChargeList[Y]);var re=A.xCoordList[I],tt=A.yCoordList[I],lt=A.zCoordList[I];Gt[I]=jt.length,jt.push({resn:Jr,x:re,y:tt,z:lt,elem:ie,hetflag:me,chain:Le,resi:Mt,icode:we,rescode:Mt+(we!=" "?"^"+we:""),serial:rt,altLoc:we,index:I,atom:Yt,bonds:[],ss:b(Gr),ssbegin:Lr,ssend:zr,bondOrder:[],properties:{charge:Ot,occupancy:it},b:ve}),I+=1}var cr=Jt.bondAtomList;for(Y=0,G=Jt.bondOrderList.length;Y<G;++Y){var et=qr+cr[Y*2],Ft=qr+cr[Y*2+1],se=Jt.bondOrderList[Y],_t=Gt[et],Wr=Gt[Ft],Z=jt[_t],ut=jt[Wr];Z&&ut&&(Z.bonds.push(Wr),Z.bondOrder.push(se),ut.bonds.push(_t),ut.bondOrder.push(se))}k+=1}for(k=ht,W=0;W<mt;++W)k+=1;C+=1}if(B)for(let at=je,me=B.length;at<me;at+=2){let Ze=B[at],vt=B[at+1],Qr=$?$[at/2]:1;if(Ze>=I){je=at;break}let Zr=Gt[Ze],Kr=Gt[vt],bn=jt[Zr],ls=jt[Kr];bn&&ls&&(bn.bonds.push(Kr),bn.bondOrder.push(Qr),ls.bonds.push(Zr),ls.bondOrder.push(Qr))}R.multimodel&&(R.onemol||u.push([]))}if(!w)for(let at=0;at<u.length;at++)(0,_.processSymmetries)(y[at].symmetries,u[at],R,y[at].cryst);return v&&!s&&(0,h.computeSecondaryStructure)(u,R.hbondCutoff),u}}),"./src/parsers/MOL2.ts":((e,r,t)=>{t.r(r),t.d(r,{MOL2:()=>c});let a={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function c(h,_){var f=[[]],g=!1;typeof _.keepH<"u"&&(g=!_.keepH);var b=h.search(/@<TRIPOS>MOLECULE/),p=h.search(/@<TRIPOS>ATOM/);if(b==-1||p==-1)return f;for(var E=h.substring(b).split(/\r?\n|\r/);E.length>0;){var M=[],R=E[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),z=parseInt(R[0]),l=0;R.length>1&&(l=parseInt(R[1]));var s=4,v;for(v=3;v<E.length;v++)if(E[v]=="@<TRIPOS>ATOM"){s=v+1;break}var w=f[f.length-1].length,S=w+z,A;for(v=w;v<S;v++){A=E[s++],R=A.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var u={},y=R[5];if(a[y]!==void 0?y=a[y]:(y=y.split(".")[0],y=y[0].toUpperCase()+y.substring(1).toLowerCase()),u.atom=R[1],u.elem=y,!(u.elem=="H"&&g)){var C=f[f.length-1].length,k=parseInt(R[0]);u.serial=k,u.x=parseFloat(R[2]),u.y=parseFloat(R[3]),u.z=parseFloat(R[4]),u.atom=R[5];var I=parseFloat(R[8]);u.index=C,u.bonds=[],u.bondOrder=[],u.properties={charge:I,partialCharge:I},M[k]=C,f[f.length-1].push(u)}}for(var O=!1;s<E.length;)if(E[s++]=="@<TRIPOS>BOND"){O=!0;break}if(O&&l)for(v=0;v<l;v++){A=E[s++],R=A.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var D=parseInt(R[1]),X=f[f.length-1][M[D]],j=parseInt(R[2]),B=f[f.length-1][M[j]],$=parseInt(R[3]);isNaN($)&&($=1),X!==void 0&&B!==void 0&&(X.bonds.push(M[j]),X.bondOrder.push($),B.bonds.push(M[D]),B.bondOrder.push($))}if(_.multimodel){_.onemol||f.push([]),E.splice(0,s),h=E.join(`
`);continue}else break}return f}}),"./src/parsers/PDB.ts":((e,r,t)=>{t.r(r),t.d(r,{PDB:()=>c});var a=t("./src/parsers/utils/getSinglePDB.ts");function c(h,_){_=_||{};var f=[],g={};f.modelData=[];for(var b=h.split(/\r?\n|\r/);b.length>0;){var p=(0,a.getSinglePDB)(b,_,g),E=p[0],M=p[1];if(b=p[2],E.length!=0){if(_.multimodel&&_.onemol&&f.length>0)for(var R=f[0].length,z=0;z<E.length;z++){var l=E[z];l.index=z;for(var s=0;s<l.bonds.length;s++)l.bonds[s]+=R;f[0].push(l)}else f.modelData.push(M),f.push(E);if(!_.multimodel)break}}return f}}),"./src/parsers/PQR.ts":((e,r,t)=>{t.r(r),t.d(r,{PQR:()=>h});var a=t("./src/parsers/utils/assignPDBBonds.ts"),c=t("./src/parsers/utils/computeSecondaryStructure.ts");function h(_,f){var g=[[]],b=!f.noSecondaryStructure;g.modelData=[{symmetries:[]}];var p=[],E=_.split(/\r?\n|\r/),M;for(let O=0;O<E.length;O++){M=E[O].replace(/^\s*/,"");var R=M.substring(0,6);if(R.indexOf("END")==0)if(f.multimodel){f.onemol||g.push([]);continue}else break;else if(R=="ATOM  "||R=="HETATM"){var z;let D=parseInt(M.substring(6,11)),X=M.substring(12,16).replace(/ /g,""),j=M.substring(17,20).trim(),B=M.substring(21,22),$=parseInt(M.substring(22,26));var l=M.substring(30).trim().split(/\s+/),s=parseFloat(l[0]),v=parseFloat(l[1]),w=parseFloat(l[2]),S=parseFloat(l[3]),A=parseFloat(l[4]),u=X[0];X.length>1&&X[1].toUpperCase()!=X[1]&&(u=X.substring(0,2)),M[0]=="H"?z=!0:z=!1,p[D]=g[g.length-1].length,g[g.length-1].push({resn:j,x:s,y:v,z:w,elem:u,hetflag:z,chain:B,resi:$,serial:D,atom:X,bonds:[],ss:"c",bondOrder:[],properties:{charge:S,partialCharge:S,radius:A},pdbline:M})}else if(R=="CONECT"){var y=parseInt(M.substring(6,11)),C=g[g.length-1][p[y]];for(let D=0;D<4;D++){var k=parseInt(M.substring([11,16,21,26][D],[11,16,21,26][D]+5)),I=g[g.length-1][p[k]];C!==void 0&&I!==void 0&&(C.bonds.push(p[k]),C.bondOrder.push(1))}}}for(let O=0;O<g.length;O++)(0,a.assignPDBBonds)(g[O],f),b&&(0,c.computeSecondaryStructure)(g[O],f.hbondCutoff);return g}}),"./src/parsers/PRMTOP.ts":((e,r,t)=>{t.r(r),t.d(r,{PRMTOP:()=>a});function a(c){var h=[],_,f=0,g=c.split(/\r?\n|\r/);if(g.length>0&&g[0].includes("VERSION")){var b=g.filter(function(s){return s.includes("POINTERS")||s.includes("ATOM_NAME")||s.includes("CHARGE")||s.includes("RADII")||s.includes("BONDS_INC_HYDROGEN")||s.includes("BONDS_WITHOUT_HYDROGEN")}),p=z("POINTERS");if(p==-1)return[];var E=l(p),M=parseInt(g[p+1].slice(0,E[1]));if(isNaN(M)||M<=0)return[];if(p=z("ATOM_NAME"),p==-1)return[];E=l(p);var R=E[0];for(let s=0;s<M/E[0];s++){s==parseInt(M/E[0])&&(R=M%E[0]);for(let v=0;v<R;v++){let w={},S={charge:"",radii:""};w.serial=f,w.x=0,w.y=0,w.z=0,w.atom=g[p+1].slice(E[1]*v,E[1]*(v+1)).trim(),w.elem=g[p+1].slice(E[1]*v,E[1]*v+1).trim(),w.properties=S,w.bonds=[],w.bondOrder=[],h.push(w),f++}p++}if(p=z("CHARGE"),p!=-1){E=l(p),f=0,R=E[0];for(let s=0;s<M/E[0];s++){s==parseInt(M/E[0])&&(R=M%E[0]);for(let v=0;v<R;v++)h[f].properties.charge=parseFloat(g[p+1].slice(E[1]*v,E[1]*(v+1))),f++;p++}}if(p=z("RADII"),p!=-1){E=l(p),f=0,R=E[0];for(let s=0;s<M/E[0];s++){s==parseInt(M/E[0])&&(R=M%E[0]);for(let v=0;v<R;v++)h[f].properties.radii=parseFloat(g[p+1].slice(E[1]*v,E[1]*(v+1))),f++;p++}}if(p=z("BONDS_WITHOUT_HYDROGEN"),p!=-1)for(E=l(p),f=0,R=E[0],p=p+1;!g[p].match(/^%FLAG/);){g[p+1].match(/^%FLAG/)&&(R=M%E[0]);for(let s=0;s<R;s++)f%3==0?_=parseInt(g[p].slice(E[1]*s,E[1]*(s+1))/3):f%3==1&&h[_].bonds.push(parseInt(g[p].slice(E[1]*s,E[1]*(s+1))/3)),f++;p++}if(p=z("BONDS_INC_HYDROGEN"),p!=-1)for(E=l(p),f=0,R=E[0],p=p+1;!g[p].match(/^%FLAG/);){g[p+1].match(/^%FLAG/)&&(R=M%E[0]);for(let s=0;s<R;s++)f%3==0?_=parseInt(g[p].slice(E[1]*s,E[1]*(s+1))/3):f%3==1&&h[_].bonds.push(parseInt(g[p].slice(E[1]*s,E[1]*(s+1))/3)),f++;p++}}else return[];function z(s){var v=g.indexOf(b.filter(function(w){return w.includes(s)})[0]);if(Number.isInteger(v)&&v>0){for(;!g[v].includes("FORMAT");)v++;return v}else return-1}function l(s){var v=g[s].match(/\((\d*)\S*/),w=g[s].match(/[a-zA-Z](\d*)\)\s*/);return w==null&&(w=g[s].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[v[1],w[1]]}return[h]}}),"./src/parsers/SDF.ts":((e,r,t)=>{t.r(r),t.d(r,{SDF:()=>h});var a=function(_,f){var g=[[]],b=!1;for(typeof f.keepH<"u"&&(b=!f.keepH);_.length>0&&!(_.length<4);){var p=parseInt(_[3].substring(0,3));if(isNaN(p)||p<=0)break;var E=parseInt(_[3].substring(3,6)),M=4;if(_.length<4+p+E)break;var R=[],z=g[g.length-1].length,l=z+p,s,v;for(s=z;s<l;s++,M++){v=_[M];var w={},S=v.substring(31,34).replace(/ /g,"");w.atom=w.elem=S[0].toUpperCase()+S.substring(1).toLowerCase(),(w.elem!=="H"||!b)&&(w.serial=s,R[s]=g[g.length-1].length,w.x=parseFloat(v.substring(0,10)),w.y=parseFloat(v.substring(10,20)),w.z=parseFloat(v.substring(20,30)),w.hetflag=!0,w.bonds=[],w.bondOrder=[],w.properties={},w.index=g[g.length-1].length,g[g.length-1].push(w))}for(s=0;s<E;s++,M++){v=_[M];var A=R[parseInt(v.substring(0,3))-1+z],u=R[parseInt(v.substring(3,6))-1+z],y=parseFloat(v.substring(6));typeof A<"u"&&typeof u<"u"&&(g[g.length-1][A].bonds.push(u),g[g.length-1][A].bondOrder.push(y),g[g.length-1][u].bonds.push(A),g[g.length-1][u].bondOrder.push(y))}if(f.multimodel){for(f.onemol||g.push([]);_[M]!=="$$$$"&&M<_.length;)M++;_.splice(0,++M)}else break}return g},c=function(_,f){var g=[[]],b=!1;for(typeof f.keepH<"u"&&(b=!f.keepH);_.length>0&&!(_.length<8||!_[4].startsWith("M  V30 BEGIN CTAB")||!_[5].startsWith("M  V30 COUNTS")||_[5].length<14);){var p=_[5].substring(13).match(/\S+/g);if(p.length<2)break;var E=parseInt(p[0]);if(isNaN(E)||E<=0)break;var M=parseInt(p[1]),R=7;if(_.length<8+E+M)break;var z=[],l=g[g.length-1].length,s=l+E,v,w;for(v=l;v<s;v++,R++){w=_[R];var S=w.substring(6).match(/\S+/g);if(S.length>4){var A={},u=S[1].replace(/ /g,"");A.atom=A.elem=u[0].toUpperCase()+u.substring(1).toLowerCase(),(A.elem!=="H"||!b)&&(A.serial=v,z[v]=g[g.length-1].length,A.x=parseFloat(S[2]),A.y=parseFloat(S[3]),A.z=parseFloat(S[4]),A.hetflag=!0,A.bonds=[],A.bondOrder=[],A.properties={},A.index=g[g.length-1].length,g[g.length-1].push(A))}}if(_[R]==="M  V30 END ATOM")R++;else break;if(M!==0&&_[R]==="M  V30 BEGIN BOND")R++;else break;for(v=0;v<M;v++,R++){w=_[R];var y=w.substring(6).match(/\S+/g);if(y.length>3){var C=z[parseInt(y[2])-1+l],k=z[parseInt(y[3])-1+l],I=parseFloat(y[1]);typeof C<"u"&&typeof k<"u"&&(g[g.length-1][C].bonds.push(k),g[g.length-1][C].bondOrder.push(I),g[g.length-1][k].bonds.push(C),g[g.length-1][k].bondOrder.push(I))}}if(f.multimodel){for(f.onemol||g.push([]);_[R]!=="$$$$"&&R<_.length;)R++;_.splice(0,++R)}else break}return g};function h(_,f){var g="V2000",b=_.split(/\r?\n|\r/);return b.length>3&&b[3].length>38&&(g=b[3].substring(34,39)),g==="V2000"?a(b,f):g==="V3000"?c(b,f):[[""]]}}),"./src/parsers/VASP.ts":((e,r,t)=>{t.r(r),t.d(r,{VASP:()=>h});var a=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/assignBonds.ts");function h(_,f={}){var g=[[]],b={};const p=f.assignBonds===void 0?!0:f.assignBonds;var E=_.replace(/^\s+/,"").split(/\r?\n/);if(E.length<3)return g;if(E[1].match(/\d+/))b.length=parseFloat(E[1]);else return console.log("Warning: second line of the vasp structure file must be a number"),g;if(b.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),g;b.xVec=new Float32Array(E[2].replace(/^\s+/,"").split(/\s+/)),b.yVec=new Float32Array(E[3].replace(/^\s+/,"").split(/\s+/)),b.zVec=new Float32Array(E[4].replace(/^\s+/,"").split(/\s+/));var M=new a.Matrix3(b.xVec[0],b.xVec[1],b.xVec[2],b.yVec[0],b.yVec[1],b.yVec[2],b.zVec[0],b.zVec[1],b.zVec[2]);M.multiplyScalar(b.length),g.modelData=[{symmetries:[],cryst:{matrix:M}}];var R=E[5].replace(/\s+/,"").replace(/\s+$/,"").split(/\s+/),z=new Int16Array(E[6].replace(/^\s+/,"").split(/\s+/)),l=E[7].replace(/\s+/,""),s=!1;if(l.match(/S/)&&(s=!0,l=E[8].replace(/\s+/,"")),l.match(/C/))l="cartesian";else if(l.match(/D/))l="direct";else return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),g;if(R.length!=z.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(R),console.log(z),g;s?E.splice(0,9):E.splice(0,8);for(var v=0,w=0,S=R.length;w<S;w++){for(var A=R[w],u=0,y=z[w];u<y;u++){var C=new Float32Array(E[v+u].replace(/^\s+/,"").split(/\s+/)),k={};k.elem=A,l=="cartesian"?(k.x=b.length*C[0],k.y=b.length*C[1],k.z=b.length*C[2]):(k.x=b.length*(C[0]*b.xVec[0]+C[1]*b.yVec[0]+C[2]*b.zVec[0]),k.y=b.length*(C[0]*b.xVec[1]+C[1]*b.yVec[1]+C[2]*b.zVec[1]),k.z=b.length*(C[0]*b.xVec[2]+C[1]*b.yVec[2]+C[2]*b.zVec[2])),k.bonds=[],k.bondOrder=[],g[0].push(k)}v+=z[w]}if(p)for(let I=0;I<g.length;I++)(0,c.assignBonds)(g[I],f);return g}}),"./src/parsers/XYZ.ts":((e,r,t)=>{t.r(r),t.d(r,{XYZ:()=>h});var a=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/assignBonds.ts");function h(_,f){f=f||{};for(var g=[[]],b=f.assignBonds===void 0?!0:f.assignBonds,p=_.split(/\r?\n|\r/);p.length>0&&!(p.length<3);){var E=parseInt(p[0]);if(isNaN(E)||E<=0||p.length<E+2)break;var M=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi,R=M.exec(p[1]);if(R!=null&&R.length>1){var z=new Float32Array(R[1].split(/\s+/)),l=new a.Matrix3(z[0],z[3],z[6],z[1],z[4],z[7],z[2],z[5],z[8]);g.modelData=[{cryst:{matrix:l}}]}for(var s=2,v=g[g.length-1].length,w=v+E,S=v;S<w;S++){var A=p[s++],u=A.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),y={};y.serial=S;var C=u[0];y.atom=y.elem=C[0].toUpperCase()+C.substring(1,2).toLowerCase(),y.x=parseFloat(u[1]),y.y=parseFloat(u[2]),y.z=parseFloat(u[3]),y.hetflag=!0,y.bonds=[],y.bondOrder=[],y.properties={},g[g.length-1][S]=y,u.length>=7&&(y.dx=parseFloat(u[4]),y.dy=parseFloat(u[5]),y.dz=parseFloat(u[6]))}if(f.multimodel)g.push([]),p.splice(0,s);else break}if(b)for(let I=0;I<g.length;I++)(0,c.assignBonds)(g[I],f);if(f.onemol){var k=g;g=[],g.push(k[0]);for(let I=1;I<k.length;I++){let O=g[0].length;for(let D=0;D<k[I].length;D++){let X=k[I][D];for(let j=0;j<X.bonds.length;j++)X.bonds[j]=X.bonds[j]+O;X.index=g[0].length,X.serial=g[0].length,g[0].push(X)}}}return g}}),"./src/parsers/cifutils/category.ts":((e,r,t)=>{t.r(r),t.d(r,{Category:()=>c});var a=t("./src/parsers/cifutils/decoder.ts");function c(h){const _=Object.create(null),f=Object.create(null);for(const g of h.columns)_[g.name]=g;return{rowCount:h.rowCount,name:h.name.substring(1),fieldNames:h.columns.map(g=>g.name),getField(g){const b=_[g];if(b)return f[g]||(f[g]=(0,a.decode)(b.data)),f[g]}}}}),"./src/parsers/cifutils/decoder.ts":((e,r,t)=>{t.r(r),t.d(r,{decode:()=>_});var a=t("./src/parsers/cifutils/encoding.ts");const c=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function h(O,D){const X=new ArrayBuffer(O.length),j=new Uint8Array(X);for(let B=0,$=O.length;B<$;B+=D)for(let H=0;H<D;H++)j[B+D-H-1]=O[B+H];return X}function _(O){let D=O.data;for(let X=O.encoding.length-1;X>=0;X--)D=f(D,O.encoding[X]);return D}function f(O,D){switch(D.kind){case"ByteArray":switch(D.type){case a.Encoding.IntDataType.Uint8:return O;case a.Encoding.IntDataType.Int8:return p(O);case a.Encoding.IntDataType.Int16:return M(O);case a.Encoding.IntDataType.Uint16:return R(O);case a.Encoding.IntDataType.Int32:return z(O);case a.Encoding.IntDataType.Uint32:return l(O);case a.Encoding.FloatDataType.Float32:return s(O);case a.Encoding.FloatDataType.Float64:return v(O);default:throw new Error("unreachable")}case"FixedPoint":return w(O,D);case"IntervalQuantization":return S(O,D);case"RunLength":return A(O,D);case"Delta":return u(O,D);case"IntegerPacking":return k(O,D);case"StringArray":return I(O,D)}}function g(O,D){switch(O){case a.Encoding.IntDataType.Int8:return new Int8Array(D);case a.Encoding.IntDataType.Int16:return new Int16Array(D);case a.Encoding.IntDataType.Int32:return new Int32Array(D);case a.Encoding.IntDataType.Uint8:return new Uint8Array(D);case a.Encoding.IntDataType.Uint16:return new Uint16Array(D);case a.Encoding.IntDataType.Uint32:return new Uint32Array(D);default:return new Int32Array(D)}}function b(O,D){switch(O){case a.Encoding.FloatDataType.Float32:return new Float32Array(D);case a.Encoding.FloatDataType.Float64:return new Float64Array(D);default:return new Float64Array(D)}}function p(O){return new Int8Array(O.buffer,O.byteOffset)}function E(O,D,X){return(O.byteOffset!=0||O.byteLength!=O.buffer.byteLength)&&(O=new Uint8Array(O)),c?new X(O.buffer):new X(h(O,D))}function M(O){return E(O,2,Int16Array)}function R(O){return E(O,2,Uint16Array)}function z(O){return E(O,4,Int32Array)}function l(O){return E(O,4,Uint32Array)}function s(O){return E(O,4,Float32Array)}function v(O){return E(O,8,Float64Array)}function w(O,D){const X=O.length,j=b(D.srcType,X),B=1/D.factor;for(let $=0;$<X;$++)j[$]=B*O[$];return j}function S(O,D){const X=O.length,j=b(D.srcType,X),B=(D.max-D.min)/(D.numSteps-1),$=D.min;for(let H=0;H<X;H++)j[H]=$+B*O[H];return j}function A(O,D){const X=g(D.srcType,D.srcSize);let j=0;for(let B=0,$=O.length;B<$;B+=2){const H=O[B],q=O[B+1];for(let W=0;W<q;++W)X[j++]=H}return X}function u(O,D){const X=O.length,j=g(D.srcType,X);if(!X)return O;j[0]=O[0]+(D.origin|0);for(let B=1;B<X;++B)j[B]=O[B]+j[B-1];return j}function y(O,D){const X=D.byteCount===1?127:32767,j=-X-1,B=O.length,$=new Int32Array(D.srcSize);let H=0,q=0;for(;H<B;){let W=0,Y=O[H];for(;Y===X||Y===j;)W+=Y,H++,Y=O[H];W+=Y,$[q]=W,H++,q++}return $}function C(O,D){const X=D.byteCount===1?255:65535,j=O.length,B=new Int32Array(D.srcSize);let $=0,H=0;for(;$<j;){let q=0,W=O[$];for(;W===X;)q+=W,$++,W=O[$];q+=W,B[H]=q,$++,H++}return B}function k(O,D){return O.length===D.srcSize?O:D.isUnsigned?C(O,D):y(O,D)}function I(O,D){const X=_({encoding:D.offsetEncoding,data:D.offsets}),j=_({encoding:D.dataEncoding,data:O}),B=D.stringData,$=new Array(X.length);$[0]="";for(let W=1,Y=X.length;W<Y;W++)$[W]=B.substring(X[W-1],X[W]);let H=0;const q=new Array(j.length);for(let W=0,Y=j.length;W<Y;W++)q[H++]=$[j[W]+1];return q}}),"./src/parsers/cifutils/encoding.ts":((e,r,t)=>{t.r(r),t.d(r,{Encoding:()=>c,VERSION:()=>a});const a="0.3.0";var c;(function(h){(function(g){g[g.Int8=1]="Int8",g[g.Int16=2]="Int16",g[g.Int32=3]="Int32",g[g.Uint8=4]="Uint8",g[g.Uint16=5]="Uint16",g[g.Uint32=6]="Uint32"})(h.IntDataType||(h.IntDataType={})),(function(g){g[g.Float32=32]="Float32",g[g.Float64=33]="Float64"})(h.FloatDataType||(h.FloatDataType={}));function _(g){let b;return g instanceof Int8Array?b=h.IntDataType.Int8:g instanceof Int16Array?b=h.IntDataType.Int16:g instanceof Int32Array?b=h.IntDataType.Int32:g instanceof Uint8Array?b=h.IntDataType.Uint8:g instanceof Uint16Array?b=h.IntDataType.Uint16:g instanceof Uint32Array?b=h.IntDataType.Uint32:g instanceof Float32Array?b=h.FloatDataType.Float32:g instanceof Float64Array?b=h.FloatDataType.Float64:b=h.IntDataType.Int32,b}h.getDataType=_;function f(g){if(g instanceof Int8Array||g instanceof Int16Array||g instanceof Int32Array)return!0;for(let b=0,p=g.length;b<p;b++)if(b<0)return!1;return!0}h.isSignedIntegerDataType=f})(c||(c={}))}),"./src/parsers/index.ts":((e,r,t)=>{t.r(r),t.d(r,{Parsers:()=>w,bondLength:()=>v.bondLength,setBondLength:()=>v.setBondLength});var a=t("./src/parsers/VASP.ts"),c=t("./src/parsers/CUBE.ts"),h=t("./src/parsers/XYZ.ts"),_=t("./src/parsers/SDF.ts"),f=t("./src/parsers/CDJSON.ts"),g=t("./src/parsers/CIF.ts"),b=t("./src/parsers/MOL2.ts"),p=t("./src/parsers/PDB.ts"),E=t("./src/parsers/PQR.ts"),M=t("./src/parsers/MMTF.ts"),R=t("./src/parsers/PRMTOP.ts"),z=t("./src/parsers/GRO.ts"),l=t("./src/parsers/LAMMPSTRJ.ts"),s=t("./src/parsers/BCIF.ts"),v=t("./src/parsers/utils/bondLength.ts");const w={vasp:a.VASP,VASP:a.VASP,cube:c.CUBE,CUBE:c.CUBE,xyz:h.XYZ,XYZ:h.XYZ,sdf:_.SDF,SDF:_.SDF,json:f.CDJSON,cdjson:f.CDJSON,CDJSON:f.CDJSON,mcif:g.CIF,cif:g.CIF,CIF:g.CIF,mol2:b.MOL2,MOL2:b.MOL2,pdb:p.PDB,PDB:p.PDB,pdbqt:p.PDB,PDBQT:p.PDB,pqr:E.PQR,PQR:E.PQR,mmtf:M.MMTFparser,MMTF:M.MMTFparser,prmtop:R.PRMTOP,PRMTOP:R.PRMTOP,gro:z.GRO,GRO:z.GRO,lammpstrj:l.LAMMPSTRJ,LAMMPSTRJ:l.LAMMPSTRJ,bcif:s.BCIF,BCIF:s.BCIF}}),"./src/parsers/utils/anumToSymbol.ts":((e,r,t)=>{t.r(r),t.d(r,{anumToSymbol:()=>a});const a={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"}}),"./src/parsers/utils/areConnected.ts":((e,r,t)=>{t.r(r),t.d(r,{areConnected:()=>h});var a=t("./src/parsers/utils/bondLength.ts");const c=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function h(_,f,g){if(g&&g.unboundCations&&(c.has(_.elem)||c.has(f.elem)))return!1;let b=(0,a.bondLength)(_.elem)+(0,a.bondLength)(f.elem);b+=.25,b*=b;let p=_.x-f.x;if(p*=p,p>b)return!1;let E=_.y-f.y;if(E*=E,E>b)return!1;let M=_.z-f.z;if(M*=M,M>b)return!1;const R=p+E+M;return!(isNaN(R)||R<.5||R>b||_.altLoc!==f.altLoc&&_.altLoc.trim()!==""&&f.altLoc.trim()!=="")}}),"./src/parsers/utils/assignBackboneHBonds.ts":((e,r,t)=>{t.r(r),t.d(r,{assignBackboneHBonds:()=>a});function a(c,h){const _=h||3.2,f=_*_,g=[];for(let b=0,p=c.length;b<p;b++){c[b].index=b;const E=c[b];!E.hetflag&&(E.atom==="N"||E.atom==="O")&&(g.push(E),E.hbondOther=null,E.hbondDistanceSq=Number.POSITIVE_INFINITY)}g.sort(function(b,p){return b.z-p.z});for(let b=0,p=g.length;b<p;b++){const E=g[b];for(let M=b+1;M<p;M++){const R=g[M],z=R.z-E.z;if(z>_)break;if(R.atom==E.atom)continue;const l=Math.abs(R.y-E.y);if(l>_)continue;const s=Math.abs(R.x-E.x);if(s>_)continue;const v=s*s+l*l+z*z;v>f||R.chain==E.chain&&Math.abs(R.resi-E.resi)<4||(v<E.hbondDistanceSq&&(E.hbondOther=R,E.hbondDistanceSq=v),v<R.hbondDistanceSq&&(R.hbondOther=E,R.hbondDistanceSq=v))}}}}),"./src/parsers/utils/assignBonds.ts":((e,r,t)=>{t.r(r),t.d(r,{assignBonds:()=>_});var a=t("./src/parsers/utils/areConnected.ts");const c=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],h=4.95;function _(f,g){for(let E=0,M=f.length;E<M;E++)f[E].index||(f[E].index=E);const b={x:{y:{z:[]}}};for(let E=0;E<f.length;E++){const M=f[E],R=Math.floor(M.x/h),z=Math.floor(M.y/h),l=Math.floor(M.z/h);b[R]||(b[R]={}),b[R][z]||(b[R][z]={}),b[R][z][l]||(b[R][z][l]=[]),b[R][z][l].push(M)}function p(E,M){for(let R=0;R<E.length;R++){const z=E[R];for(let l=0;l<M.length;l++){const s=M[l];if((0,a.areConnected)(z,s,g)){const v=z.bonds.indexOf(s.index),w=s.bonds.indexOf(z.index);v===-1&&w===-1?(z.bonds.push(s.index),z.bondOrder.push(1),s.bonds.push(z.index),s.bondOrder.push(1)):v===-1?(z.bonds.push(s.index),z.bondOrder.push(s.bondOrder[w])):w===-1&&(s.bonds.push(z.index),s.bondOrder.push(z.bondOrder[v]))}}}}for(let E in b){const M=parseInt(E);for(let R in b[M]){const z=parseInt(R);for(let l in b[M][z]){const s=parseInt(l),v=b[M][z][s];for(let w=0;w<v.length;w++){const S=v[w];for(let A=w+1;A<v.length;A++){const u=v[A];(0,a.areConnected)(S,u,g)&&S.bonds.indexOf(u.index)==-1&&(S.bonds.push(u.index),S.bondOrder.push(1),u.bonds.push(S.index),u.bondOrder.push(1))}}for(let w=0;w<c.length;w++){const S=c[w];if(!b[M+S.x]||!b[M+S.x][z+S.y]||!b[M+S.x][z+S.y][s+S.z])continue;const A=b[M+S.x][z+S.y][s+S.z];p(v,A)}}}}}}),"./src/parsers/utils/assignPDBBonds.ts":((e,r,t)=>{t.r(r),t.d(r,{assignPDBBonds:()=>_});var a=t("./src/parsers/utils/areConnected.ts"),c=t("./src/parsers/utils/assignBonds.ts"),h=t("./src/parsers/utils/standardResidues.ts");function _(f,g){const b=[],p=[];for(let z=0,l=f.length;z<l;z++){const s=f[z];s.index=z,s.hetflag||!h.standardResidues.has(s.resn)?p.push(s):b.push(s)}(0,c.assignBonds)(p,g),b.sort(function(z,l){return z.chain!==l.chain?z.chain<l.chain?-1:1:z.resi-l.resi});let E=-1,M=-1,R;for(let z=0,l=b.length;z<l;z++){const s=b[z];s.resi!==E&&(E=s.resi,R||M++,R=!1),s.reschain=M;for(let v=z+1;v<b.length;v++){const w=b[v];if(w.chain!==s.chain||w.resi-s.resi>1)break;(0,a.areConnected)(s,w,g)&&(s.bonds.indexOf(w.index)===-1&&(s.bonds.push(w.index),s.bondOrder.push(1),w.bonds.push(s.index),w.bondOrder.push(1)),s.resi!==w.resi&&(R=!0))}}}}),"./src/parsers/utils/atomNameToElem.ts":((e,r,t)=>{t.r(r),t.d(r,{atomNameToElem:()=>c});var a=t("./src/parsers/utils/bondLength.ts");function c(h,_){let f=h.replace(/ /g,"");return f.length>0&&f[0]==="H"&&f!=="Hg"&&f!=="He"&&f!=="Hf"&&f!=="Hs"&&f!=="Ho"&&(f="H"),f.length>1&&(f=f[0].toUpperCase()+f.substring(1).toLowerCase(),a.bondTable[f]===void 0?f=f[0]:_&&(f==="Ca"||f==="Cd")&&(f="C")),f}}),"./src/parsers/utils/bondLength.ts":((e,r,t)=>{t.r(r),t.d(r,{bondLength:()=>c,bondTable:()=>a,setBondLength:()=>h});let a={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function c(_){return a[_]||1.6}function h(_,f){f<0&&(f=0),a[_]=f}}),"./src/parsers/utils/computeSecondaryStructure.ts":((e,r,t)=>{t.r(r),t.d(r,{computeSecondaryStructure:()=>c});var a=t("./src/parsers/utils/assignBackboneHBonds.ts");function c(h,_){(0,a.assignBackboneHBonds)(h,_);const f={};let g,b,p,E,M,R;for(g=0,b=h.length;g<b;g++)if(M=h[g],f[M.chain]===void 0&&(f[M.chain]=[]),isFinite(M.hbondDistanceSq)){const z=M.hbondOther;f[z.chain]===void 0&&(f[z.chain]=[]),Math.abs(z.resi-M.resi)===4&&(f[M.chain][M.resi]="h")}for(p in f)for(E=1;E<f[p].length-1;E++){const z=f[p][E-1],l=f[p][E+1];R=f[p][E],z=="h"&&z==l&&R!=z&&(f[p][E]=z)}for(g=0,b=h.length;g<b;g++)M=h[g],isFinite(M.hbondDistanceSq)&&f[M.chain][M.resi]!="h"&&M.ss!=="h"&&(f[M.chain][M.resi]="maybesheet");for(let z=0,l=h.length;z<l;z++)if(M=h[z],isFinite(M.hbondDistanceSq)&&f[M.chain][M.resi]=="maybesheet"){let s=M.hbondOther,v=f[s.chain][s.resi];(v=="maybesheet"||v=="s")&&(f[M.chain][M.resi]="s",f[s.chain][s.resi]="s")}for(let z in f){for(let l=1;l<f[z].length-1;l++){const s=f[z][l-1],v=f[z][l+1];R=f[z][l],s=="s"&&s==v&&R!=s&&(f[z][l]=s)}for(let l=0;l<f[z].length;l++){const s=f[z][l];(s=="h"||s=="s")&&f[z][l-1]!=s&&f[z][l+1]!=s&&delete f[z][l]}}for(g=0,b=h.length;g<b;g++)M=h[g],R=f[M.chain][M.resi],delete M.hbondOther,delete M.hbondDistanceSq,!(R===void 0||R==="maybesheet")&&(M.ss=R,f[M.chain][M.resi-1]!=R&&(M.ssbegin=!0),f[M.chain][M.resi+1]!=R&&(M.ssend=!0))}}),"./src/parsers/utils/getSinglePDB.ts":((e,r,t)=>{t.r(r),t.d(r,{getSinglePDB:()=>E});var a=t("./src/WebGL/index.ts"),c=t("./src/parsers/utils/atomNameToElem.ts"),h=t("./src/parsers/utils/bondLength.ts"),_=t("./src/parsers/utils/computeSecondaryStructure.ts"),f=t("./src/parsers/utils/isEmpty.ts"),g=t("./src/parsers/utils/processSymmetries.ts"),b=t("./src/parsers/utils/assignPDBBonds.ts"),p=t("./src/parsers/utils/validateBonds.ts");function E(M,R,z){const l=[],s=R.assignBonds===void 0?!0:R.assignBonds,v=!R.keepH,w=!!R.noSecondaryStructure,S=!R.noComputeSecondaryStructure,A=!R.doAssembly,u=R.altLoc?R.altLoc:"A",y={symmetries:[],cryst:void 0};let C,k=[];const I=[];let O;const D={};for(let X=0;X<M.length;X++){O=M[X].replace(/^\s*/,"");const j=O.substring(0,6);let B,$,H;if(j.indexOf("END")===0){if(k=M.slice(X+1),j==="END")for(const q in z)z.hasOwnProperty(q)&&delete z[q];break}else if(j==="ATOM  "||j==="HETATM"){let q,W,Y,G,V,Q,xe,ce,Ne,Pe,Fe,Me;if(Fe=O.substring(16,17),Fe!==" "&&Fe!==u&&u!=="*"||(Pe=parseInt(O.substring(6,11)),C=O.substring(12,16).replace(/ /g,""),q=O.substring(17,20).replace(/ /g,""),W=O.substring(21,22),Y=parseInt(O.substring(22,26)),G=O.substring(26,27),V=parseFloat(O.substring(30,38)),Q=parseFloat(O.substring(38,46)),xe=parseFloat(O.substring(46,54)),Me=parseFloat(O.substring(60,68)),Ne=O.substring(76,78).replace(/ /g,""),Ne===""||h.bondTable[Ne]===void 0?Ne=(0,c.atomNameToElem)(O.substring(12,14),O[0]=="A"):Ne=Ne[0].toUpperCase()+Ne.substring(1).toLowerCase(),Ne==="H"&&v))continue;j[0]=="H"?ce=!0:ce=!1,I[Pe]=l.length,l.push({resn:q,x:V,y:Q,z:xe,elem:Ne,hetflag:ce,altLoc:Fe,chain:W,resi:Y,icode:G,rescode:Y+(G!==" "?"^"+G:""),serial:Pe,atom:C,bonds:[],ss:"c",bondOrder:[],properties:{},b:Me,pdbline:O})}else if(j==="SHEET "){B=O.substring(21,22),$=parseInt(O.substring(22,26)),H=parseInt(O.substring(33,37)),B in z||(z[B]={}),z[B][$]="s1";for(let q=$+1;q<H;q++)z[B][q]="s";z[B][H]="s2"}else if(j==="CONECT"){const q=parseInt(O.substring(6,11)),W=I[q],Y=l[W],G=[11,16,21,26];for(let V=0;V<4;V++){const Q=parseInt(O.substring(G[V],G[V]+5)),xe=I[Q];let ce=W+":"+xe;const Ne=l[xe];if(Y!==void 0&&Ne!==void 0)if(!D[ce])D[ce]=1,(Y.bonds.length==0||Y.bonds[Y.bonds.length-1]!==xe)&&(Y.bonds.push(xe),Y.bondOrder.push(1));else{D[ce]+=1;for(let Pe=0;Pe<Y.bonds.length;Pe++)if(Y.bonds[Pe]==xe){const Fe=D[ce];Fe>=4?Y.bondOrder[Pe]=1:Y.bondOrder[Pe]=Fe}}}}else if(j==="HELIX "){B=O.substring(19,20),$=parseInt(O.substring(21,25)),H=parseInt(O.substring(33,37)),B in z||(z[B]={}),z[B][$]="h1";for(let q=$+1;q<H;q++)z[B][q]="h";z[B][H]="h2"}else if(!A&&j==="REMARK"&&O.substring(13,18)==="BIOMT"){let q,W=new a.Matrix4;for(q=1;q<=3;q++)if(O=M[X].replace(/^\s*/,""),parseInt(O.substring(18,19))==q)W.elements[q-1]=parseFloat(O.substring(23,33)),W.elements[q-1+4]=parseFloat(O.substring(33,43)),W.elements[q-1+8]=parseFloat(O.substring(43,53)),W.elements[q-1+12]=parseFloat(O.substring(53)),X++;else for(;O.substring(13,18)==="BIOMT";)X++,O=M[X].replace(/^\s*/,"");W.elements[3]=0,W.elements[7]=0,W.elements[11]=0,W.elements[15]=1,y.symmetries.push(W),X--}else if(j==="CRYST1"){let q,W,Y,G,V,Q;q=parseFloat(O.substring(7,15)),W=parseFloat(O.substring(16,24)),Y=parseFloat(O.substring(25,33)),G=parseFloat(O.substring(34,40)),V=parseFloat(O.substring(41,47)),Q=parseFloat(O.substring(48,54)),y.cryst={a:q,b:W,c:Y,alpha:G,beta:V,gamma:Q}}else if(j==="ANISOU"){const q=parseInt(O.substring(6,11)),W=I[q],Y=l[W];if(Y){const G=O.substring(30).trim().split(/\s+/),V={u11:parseInt(G[0]),u22:parseInt(G[1]),u33:parseInt(G[2]),u12:parseInt(G[3]),u13:parseInt(G[4]),u23:parseInt(G[5])};Y.uMat=V}}}if((0,p.validateBonds)(l,I),s&&(0,b.assignPDBBonds)(l,R),A||(0,g.processSymmetries)(y.symmetries,l,R,y.cryst),S&&!w&&(0,_.computeSecondaryStructure)(l,R.hbondCutoff),!(0,f.isEmpty)(z))for(let X=0;X<l.length;X++){const j=l[X];if(j!==void 0&&j.chain in z&&j.resi in z[j.chain]){const B=z[j.chain][j.resi];j.ss=B[0],B.length>1&&(B[1]=="1"?j.ssbegin=!0:B[1]=="2"&&(j.ssend=!0))}}return[l,y,k]}}),"./src/parsers/utils/isEmpty.ts":((e,r,t)=>{t.r(r),t.d(r,{isEmpty:()=>a});function a(c){for(const h in c)return!1;return!0}}),"./src/parsers/utils/processSymmetries.ts":((e,r,t)=>{t.r(r),t.d(r,{processSymmetries:()=>c});var a=t("./src/WebGL/index.ts");function c(h,_,f,g){const b=!f.duplicateAssemblyAtoms,p=_.length;let E=p,M=-1,R=null,z=null;(f.normalizeAssembly||f.wrapAtoms)&&g&&(R=(0,a.conversionMatrix3)(g.a,g.b,g.c,g.alpha,g.beta,g.gamma),z=new a.Matrix3,z.getInverse3(R));let l=function(w){let S=w.clone().applyMatrix3(z);const A=[S.x,S.y,S.z],u=[0,0,0];for(let C=0;C<3;C++){for(;A[C]<-.001;)A[C]+=1,u[C]+=1;for(;A[C]>1.001;)A[C]-=1,u[C]-=1}const y=new a.Vector3(u[0],u[1],u[2]);return y.applyMatrix3(R),y};if(f.normalizeAssembly&&g)for(let w=0;w<h.length;w++){const S=new a.Vector3(0,0,0);for(let u=0;u<p;u++){const y=new a.Vector3(_[u].x,_[u].y,_[u].z);y.applyMatrix4(h[w]),S.add(y)}S.divideScalar(p);const A=l(S);h[w].isNearlyIdentity()&&A.lengthSq()>.001&&(M=w),h[w].translate(A)}if(b){if(h.length>1)for(let w=0;w<_.length;w++){var s=[];for(let S=0;S<h.length;S++)if(!h[S].isNearlyIdentity()){var v=new a.Vector3;v.set(_[w].x,_[w].y,_[w].z),v.applyMatrix4(h[S]),s.push(v)}_[w].symmetries=s}}else{for(let w=0;w<p;w++)_[w].sym=-1;for(let w=0;w<h.length;w++)if(!h[w].isNearlyIdentity()&&M!=w){let S=new a.Vector3;for(let A=0;A<p;A++){const u=[];for(let C=0;C<_[A].bonds.length;C++)u.push(_[A].bonds[C]+E);if(S.set(_[A].x,_[A].y,_[A].z),S.applyMatrix4(h[w]),f.wrapAtoms&&g){let C=l(S);S.add(C)}const y={};for(const C in _[A])y[C]=_[A][C];y.x=S.x,y.y=S.y,y.z=S.z,y.bonds=u,y.sym=w,y.index=_.length,_.push(y)}E=_.length}else for(let S=0;S<p;S++)_[S].sym=w;if(f.wrapAtoms&&g){let w=new a.Vector3;for(let S=0;S<p;S++){w.set(_[S].x,_[S].y,_[S].z);let A=l(w);w.add(A),_[S].x=w.x,_[S].y=w.y,_[S].z=w.z}}if(M>=0){const w=new a.Vector3;for(let S=0;S<p;S++)w.set(_[S].x,_[S].y,_[S].z),w.applyMatrix4(h[M]),_[S].x=w.x,_[S].y=w.y,_[S].z=w.z}h.length=0}}}),"./src/parsers/utils/standardResidues.ts":((e,r,t)=>{t.r(r),t.d(r,{standardResidues:()=>a});const a=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"])}),"./src/parsers/utils/validateBonds.ts":((e,r,t)=>{t.r(r),t.d(r,{validateBonds:()=>a});function a(c,h){for(let _=0,f=c.length;_<f;_++){const g=c[_];for(let b=0;b<g.bonds.length;b++){const p=g.bonds[b],E=c[p],M=h[g.serial];E&&M&&E.bonds.indexOf(M)<0&&(E.bonds.push(M),E.bondOrder.push(g.bondOrder[b]))}}}}),"./src/partialCharges.ts":((e,r,t)=>{t.r(r),t.d(r,{applyPartialCharges:()=>c,partialCharges:()=>a});const a={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function c(h,_){if((!_||typeof h.partialCharge>"u")&&h.resn&&h.atom){var f=h.resn+":"+h.atom;h.properties.partialCharge=a[f]}}}),"./src/specs.ts":((e,r,t)=>{t.r(r)}),"./src/utilities.ts":((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/Gradient.ts"),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/VolumeData.ts"),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/colors.ts"),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/pako/dist/pako.esm.mjs");function extend(e,r){for(var t in r)r.hasOwnProperty(t)&&r[t]!==void 0&&(e[t]=r[t]);return e}function deepCopy(e){let r,t,a;if(e==null)return{};if(typeof e!="object"||e===null)return e;r=Array.isArray(e)?[]:{};for(a in e)t=e[a],r[a]=deepCopy(t);return r}function isNumeric(e){var r=typeof e;return(r==="number"||r==="string")&&!isNaN(e-parseFloat(e))}function isEmptyObject(e){var r;for(r in e)return!1;return!0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?null:callback}function adjustVolumeStyle(e){e&&(e.volformat&&!(e.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData)&&(e.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(e.voldata,e.volformat)),e.volscheme&&(e.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(e.volscheme)))}function getExtent(e,r){var t,a,c,h,_,f,g,b,p,E,M=!r;if(t=a=c=9999,h=_=f=-9999,g=b=p=E=0,e.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var R=0;R<e.length;R++){var z=e[R];if(!(typeof z>"u"||!isFinite(z.x)||!isFinite(z.y)||!isFinite(z.z))&&(E++,g+=z.x,b+=z.y,p+=z.z,t=t<z.x?t:z.x,a=a<z.y?a:z.y,c=c<z.z?c:z.z,h=h>z.x?h:z.x,_=_>z.y?_:z.y,f=f>z.z?f:z.z,z.symmetries&&M))for(var l=0;l<z.symmetries.length;l++)E++,g+=z.symmetries[l].x,b+=z.symmetries[l].y,p+=z.symmetries[l].z,t=t<z.symmetries[l].x?t:z.symmetries[l].x,a=a<z.symmetries[l].y?a:z.symmetries[l].y,c=c<z.symmetries[l].z?c:z.symmetries[l].z,h=h>z.symmetries[l].x?h:z.symmetries[l].x,_=_>z.symmetries[l].y?_:z.symmetries[l].y,f=f>z.symmetries[l].z?f:z.symmetries[l].z}return[[t,a,c],[h,_,f],[g/E,b/E,p/E]]}function getPropertyRange(e,r){for(var t=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,c=0,h=e.length;c<h;c++){var _=e[c],f=getAtomProperty(_,r);f!=null&&(f<t&&(t=f),f>a&&(a=f))}return!isFinite(t)&&!isFinite(a)?t=a=0:isFinite(t)?isFinite(a)||(a=t):t=a,[t,a]}class PausableTimer{constructor(r,t,a){this.total_time_run=0,this.fn=r,this.arg=a,this.countdown=t,this.start_time=new Date().getTime(),this.ident=setTimeout(r,t,a)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(e){for(var r=window.atob(e),t=r.length,a=new Uint8Array(t),c=0;c<t;c++)a[c]=r.charCodeAt(c);return a}function getAtomProperty(e,r){var t=null;return e.properties&&typeof e.properties[r]<"u"?t=e.properties[r]:typeof e[r]<"u"&&(t=e[r]),t}function mergeGeos(e,r){var t=r.geometry;t!==void 0&&e.geometryGroups.push(t.geometryGroups[0])}function specStringToObject(e){if(typeof e=="object"||typeof e>"u"||e==null)return e;try{return JSON.parse(e)}catch{}e=e.replace(/%7E/g,"~");var r=function(M){return isNumeric(M)?Math.floor(parseFloat(M))==parseInt(M)||M.indexOf(".")>=0?parseFloat(M):parseInt(M):M==="true"?!0:M==="false"?!1:M},t={};if(e==="all")return t;for(var a=e.split(";"),c=0;c<a.length;c++){var h=a[c].split(":"),_=h[0],f={},g=h[1];if(g)if(g=g.replace(/~/g,"="),g.indexOf("=")!==-1)for(var b=g.split(","),p=0;p<b.length;p++){var E=b[p].split("=",2);f[E[0]]=r(E[1])}else g.indexOf(",")!==-1?f=g.split(","):f=r(g);t[_]=f}return t}function checkStatus(e){if(!e.ok)throw new Error(`HTTP ${e.status} - ${e.statusText}`);return e}function get(e,r){var t=fetch(e).then(checkStatus).then(a=>a.text());return r?t.then(r):t}function getbin(e,r,t,a){var c;return t=="POST"?c=fetch(e,{method:"POST",body:a}).then(h=>checkStatus(h)).then(h=>h.arrayBuffer()):c=fetch(e).then(h=>checkStatus(h)).then(h=>h.arrayBuffer()),r?c.then(r):c}function download(e,r,t,a){var c="",h="",_="",f=null,g=r.addModel();if(e.indexOf(":")<0&&(e.length==4?e="pdb:"+e:isNaN(e)?e="url:"+e:e="cid:"+e),e.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),e="bcif:"+e.slice(5)),e.substring(0,5)==="bcif:")e=e.substring(5).toUpperCase(),_="https://models.rcsb.org/"+e+".bcif.gz",t&&typeof t.noComputeSecondaryStructure>"u"&&(t.noComputeSecondaryStructure=!0),f=new Promise(function(p){getbin(_).then(function(E){g.addMolData(E,"bcif.gz",t),r.zoomTo(),r.render(),p(g)},function(){console.error("fetch of "+_+" failed.")})});else{if(e.substring(0,4)==="pdb:"){if(c="bcif",t&&t.format&&(c=t.format),t&&typeof t.noComputeSecondaryStructure>"u"&&(t.noComputeSecondaryStructure=!0),e=e.substring(4).toUpperCase(),!e.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}c=="bcif"?_="https://models.rcsb.org/"+e.toUpperCase()+".bcif.gz":(h=t&&t.pdbUri?t.pdbUri:"https://files.rcsb.org/view/",_=h+e+"."+c)}else if(e.substring(0,4)=="cid:"){if(c="sdf",e=e.substring(4),!e.match(/^[0-9]+$/)){alert("Wrong Compound ID");return}_="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+e+"/SDF?record_type=3d"}else e.substring(0,4)=="url:"&&(_=e.substring(4),c=_);var b=function(p){g.addMolData(p,c,t),r.zoomTo(),r.render()};f=new Promise(function(p){c=="bcif"?getbin(_).then(function(E){b(E),p(g)}).catch(function(){h=t&&t.pdbUri?t.pdbUri:"https://files.rcsb.org/view/",_=h+e+".pdb",c="pdb",console.warn("falling back to pdb format"),get(_).then(function(E){b(E),p(g)}).catch(function(E){b(""),p(g),console.error("fetch of "+_+" failed: "+E.statusText)})}):get(_).then(function(E){b(E),p(g)}).catch(function(E){b(""),p(g),console.error("fetch of "+_+" failed: "+E.statusText)})})}return a?(f.then(function(p){a(p)}),g):f}function getColorFromStyle(e,r){let t=r.colorscheme;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]<"u")t=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t];else if(typeof t=="string"&&t.endsWith("Carbon")){let h=t.substring(0,t.lastIndexOf("Carbon")).toLowerCase();if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[h]<"u"){let _=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);_.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[h],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]={prop:"elem",map:_},t=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[t]}}let a=e.color;if(typeof r.color<"u"&&r.color!="spectrum"&&(a=r.color),typeof t<"u"){let h,_;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[t]<"u")t=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[t],typeof t[e[t.prop]]<"u"&&(a=t.map[e[t.prop]]);else if(typeof t[e[t.prop]]<"u")a=t.map[e[t.prop]];else if(typeof t.prop<"u"&&typeof t.gradient<"u"){h=t.prop;var c=t.gradient;c instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(c=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(t));let f=c.range()||[-1,1];_=getAtomProperty(e,h),_!=null&&(a=c.valueToHex(_,f))}else typeof t.prop<"u"&&typeof t.map<"u"?(h=t.prop,_=getAtomProperty(e,h),typeof t.map[_]<"u"&&(a=t.map[_])):typeof r.colorscheme[e.elem]<"u"?a=r.colorscheme[e.elem]:console.warn("Could not interpret colorscheme "+t)}else typeof r.colorfunc<"u"&&(a=r.colorfunc(e));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(a)}function getElement(e){let r=e;return typeof e=="string"?r=document.querySelector("#"+e):typeof e=="object"&&e.get&&(r=e.get(0)),r}function inflateString(e,r=!0){let t;return typeof e=="string"?t=new TextEncoder().encode(e):t=new Uint8Array(e),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(t,{to:r?"string":null})}}),"./node_modules/upng-js/UPNG.js":((e,r,t)=>{(function(){var a={},c;e.exports=a,c=t("./node_modules/upng-js/node_modules/pako/index.js"),(function(h,_){h.toRGBA8=function(f){var g=f.width,b=f.height;if(f.tabs.acTL==null)return[h.toRGBA8.decodeImage(f.data,g,b,f).buffer];var p=[];f.frames[0].data==null&&(f.frames[0].data=f.data);for(var E,M=new Uint8Array(g*b*4),R=0;R<f.frames.length;R++){var z=f.frames[R],l=z.rect.x,s=z.rect.y,v=z.rect.width,w=z.rect.height,S=h.toRGBA8.decodeImage(z.data,v,w,f);if(R==0?E=S:z.blend==0?h._copyTile(S,v,w,E,g,b,l,s,0):z.blend==1&&h._copyTile(S,v,w,E,g,b,l,s,1),p.push(E.buffer),E=E.slice(0),z.dispose!=0){if(z.dispose==1)h._copyTile(M,v,w,E,g,b,l,s,0);else if(z.dispose==2){for(var A=R-1;f.frames[A].dispose==2;)A--;E=new Uint8Array(p[A]).slice(0)}}}return p},h.toRGBA8.decodeImage=function(f,g,b,p){var E=g*b,M=h.decode._getBPP(p),R=Math.ceil(g*M/8),z=new Uint8Array(E*4),l=new Uint32Array(z.buffer),s=p.ctype,v=p.depth,w=h._bin.readUshort;if(s==6){var S=E<<2;if(v==8)for(var A=0;A<S;A++)z[A]=f[A];if(v==16)for(var A=0;A<S;A++)z[A]=f[A<<1]}else if(s==2){var u=p.tabs.tRNS,y=-1,C=-1,k=-1;if(u&&(y=u[0],C=u[1],k=u[2]),v==8)for(var A=0;A<E;A++){var I=A<<2,O=A*3;z[I]=f[O],z[I+1]=f[O+1],z[I+2]=f[O+2],z[I+3]=255,y!=-1&&f[O]==y&&f[O+1]==C&&f[O+2]==k&&(z[I+3]=0)}if(v==16)for(var A=0;A<E;A++){var I=A<<2,O=A*6;z[I]=f[O],z[I+1]=f[O+2],z[I+2]=f[O+4],z[I+3]=255,y!=-1&&w(f,O)==y&&w(f,O+2)==C&&w(f,O+4)==k&&(z[I+3]=0)}}else if(s==3){var D=p.tabs.PLTE,X=p.tabs.tRNS,j=X?X.length:0;if(v==1)for(var B=0;B<b;B++)for(var $=B*R,H=B*g,A=0;A<g;A++){var I=H+A<<2,q=f[$+(A>>3)]>>7-((A&7)<<0)&1,W=3*q;z[I]=D[W],z[I+1]=D[W+1],z[I+2]=D[W+2],z[I+3]=q<j?X[q]:255}if(v==2)for(var B=0;B<b;B++)for(var $=B*R,H=B*g,A=0;A<g;A++){var I=H+A<<2,q=f[$+(A>>2)]>>6-((A&3)<<1)&3,W=3*q;z[I]=D[W],z[I+1]=D[W+1],z[I+2]=D[W+2],z[I+3]=q<j?X[q]:255}if(v==4)for(var B=0;B<b;B++)for(var $=B*R,H=B*g,A=0;A<g;A++){var I=H+A<<2,q=f[$+(A>>1)]>>4-((A&1)<<2)&15,W=3*q;z[I]=D[W],z[I+1]=D[W+1],z[I+2]=D[W+2],z[I+3]=q<j?X[q]:255}if(v==8)for(var A=0;A<E;A++){var I=A<<2,q=f[A],W=3*q;z[I]=D[W],z[I+1]=D[W+1],z[I+2]=D[W+2],z[I+3]=q<j?X[q]:255}}else if(s==4){if(v==8)for(var A=0;A<E;A++){var I=A<<2,Y=A<<1,G=f[Y];z[I]=G,z[I+1]=G,z[I+2]=G,z[I+3]=f[Y+1]}if(v==16)for(var A=0;A<E;A++){var I=A<<2,Y=A<<2,G=f[Y];z[I]=G,z[I+1]=G,z[I+2]=G,z[I+3]=f[Y+2]}}else if(s==0){var y=p.tabs.tRNS?p.tabs.tRNS:-1;if(v==1)for(var A=0;A<E;A++){var G=255*(f[A>>3]>>7-(A&7)&1),V=G==y*255?0:255;l[A]=V<<24|G<<16|G<<8|G}if(v==2)for(var A=0;A<E;A++){var G=85*(f[A>>2]>>6-((A&3)<<1)&3),V=G==y*85?0:255;l[A]=V<<24|G<<16|G<<8|G}if(v==4)for(var A=0;A<E;A++){var G=17*(f[A>>1]>>4-((A&1)<<2)&15),V=G==y*17?0:255;l[A]=V<<24|G<<16|G<<8|G}if(v==8)for(var A=0;A<E;A++){var G=f[A],V=G==y?0:255;l[A]=V<<24|G<<16|G<<8|G}if(v==16)for(var A=0;A<E;A++){var G=f[A<<1],V=w(f,A<<1)==y?0:255;l[A]=V<<24|G<<16|G<<8|G}}return z},h.decode=function(f){for(var g=new Uint8Array(f),b=8,p=h._bin,E=p.readUshort,M=p.readUint,R={tabs:{},frames:[]},z=new Uint8Array(g.length),l=0,s,v=0,w=[137,80,78,71,13,10,26,10],S=0;S<8;S++)if(g[S]!=w[S])throw"The input is not a PNG file!";for(;b<g.length;){var A=p.readUint(g,b);b+=4;var u=p.readASCII(g,b,4);if(b+=4,u=="IHDR")h.decode._IHDR(g,b,R);else if(u=="IDAT"){for(var S=0;S<A;S++)z[l+S]=g[b+S];l+=A}else if(u=="acTL")R.tabs[u]={num_frames:M(g,b),num_plays:M(g,b+4)},s=new Uint8Array(g.length);else if(u=="fcTL"){if(v!=0){var y=R.frames[R.frames.length-1];y.data=h.decode._decompress(R,s.slice(0,v),y.rect.width,y.rect.height),v=0}var C={x:M(g,b+12),y:M(g,b+16),width:M(g,b+4),height:M(g,b+8)},k=E(g,b+22);k=E(g,b+20)/(k==0?100:k);var I={rect:C,delay:Math.round(k*1e3),dispose:g[b+24],blend:g[b+25]};R.frames.push(I)}else if(u=="fdAT"){for(var S=0;S<A-4;S++)s[v+S]=g[b+S+4];v+=A-4}else if(u=="pHYs")R.tabs[u]=[p.readUint(g,b),p.readUint(g,b+4),g[b+8]];else if(u=="cHRM"){R.tabs[u]=[];for(var S=0;S<8;S++)R.tabs[u].push(p.readUint(g,b+S*4))}else if(u=="tEXt"){R.tabs[u]==null&&(R.tabs[u]={});var O=p.nextZero(g,b),D=p.readASCII(g,b,O-b),X=p.readASCII(g,O+1,b+A-O-1);R.tabs[u][D]=X}else if(u=="iTXt"){R.tabs[u]==null&&(R.tabs[u]={});var O=0,j=b;O=p.nextZero(g,j);var D=p.readASCII(g,j,O-j);j=O+1,g[j],g[j+1],j+=2,O=p.nextZero(g,j),p.readASCII(g,j,O-j),j=O+1,O=p.nextZero(g,j),p.readUTF8(g,j,O-j),j=O+1;var X=p.readUTF8(g,j,A-(j-b));R.tabs[u][D]=X}else if(u=="PLTE")R.tabs[u]=p.readBytes(g,b,A);else if(u=="hIST"){var B=R.tabs.PLTE.length/3;R.tabs[u]=[];for(var S=0;S<B;S++)R.tabs[u].push(E(g,b+S*2))}else if(u=="tRNS")R.ctype==3?R.tabs[u]=p.readBytes(g,b,A):R.ctype==0?R.tabs[u]=E(g,b):R.ctype==2&&(R.tabs[u]=[E(g,b),E(g,b+2),E(g,b+4)]);else if(u=="gAMA")R.tabs[u]=p.readUint(g,b)/1e5;else if(u=="sRGB")R.tabs[u]=g[b];else if(u=="bKGD")R.ctype==0||R.ctype==4?R.tabs[u]=[E(g,b)]:R.ctype==2||R.ctype==6?R.tabs[u]=[E(g,b),E(g,b+2),E(g,b+4)]:R.ctype==3&&(R.tabs[u]=g[b]);else if(u=="IEND"){if(v!=0){var y=R.frames[R.frames.length-1];y.data=h.decode._decompress(R,s.slice(0,v),y.rect.width,y.rect.height),v=0}R.data=h.decode._decompress(R,z,R.width,R.height);break}b+=A,p.readUint(g,b),b+=4}return delete R.compress,delete R.interlace,delete R.filter,R},h.decode._decompress=function(f,g,b,p){return f.compress==0&&(g=h.decode._inflate(g)),f.interlace==0?g=h.decode._filterZero(g,f,0,b,p):f.interlace==1&&(g=h.decode._readInterlace(g,f)),g},h.decode._inflate=function(f){return _.inflate(f)},h.decode._readInterlace=function(f,g){for(var b=g.width,p=g.height,E=h.decode._getBPP(g),M=E>>3,R=Math.ceil(b*E/8),z=new Uint8Array(p*R),l=0,s=[0,0,4,0,2,0,1],v=[0,4,0,2,0,1,0],w=[8,8,8,4,4,2,2],S=[8,8,4,4,2,2,1],A=0;A<7;){for(var u=w[A],y=S[A],C=0,k=0,I=s[A];I<p;)I+=u,k++;for(var O=v[A];O<b;)O+=y,C++;var D=Math.ceil(C*E/8);h.decode._filterZero(f,g,l,C,k);for(var X=0,j=s[A];j<p;){for(var B=v[A],$=l+X*D<<3;B<b;){if(E==1){var H=f[$>>3];H=H>>7-($&7)&1,z[j*R+(B>>3)]|=H<<7-((B&3)<<0)}if(E==2){var H=f[$>>3];H=H>>6-($&7)&3,z[j*R+(B>>2)]|=H<<6-((B&3)<<1)}if(E==4){var H=f[$>>3];H=H>>4-($&7)&15,z[j*R+(B>>1)]|=H<<4-((B&1)<<2)}if(E>=8)for(var q=j*R+B*M,W=0;W<M;W++)z[q+W]=f[($>>3)+W];$+=E,B+=y}X++,j+=u}C*k!=0&&(l+=k*(1+D)),A=A+1}return z},h.decode._getBPP=function(f){var g=[1,null,3,1,2,null,4][f.ctype];return g*f.depth},h.decode._filterZero=function(f,g,b,p,E){var M=h.decode._getBPP(g),R=Math.ceil(p*M/8),z=h.decode._paeth;M=Math.ceil(M/8);for(var l=0;l<E;l++){var s=b+l*R,v=s+l+1,w=f[v-1];if(w==0)for(var S=0;S<R;S++)f[s+S]=f[v+S];else if(w==1){for(var S=0;S<M;S++)f[s+S]=f[v+S];for(var S=M;S<R;S++)f[s+S]=f[v+S]+f[s+S-M]&255}else if(l==0){for(var S=0;S<M;S++)f[s+S]=f[v+S];if(w==2)for(var S=M;S<R;S++)f[s+S]=f[v+S]&255;if(w==3)for(var S=M;S<R;S++)f[s+S]=f[v+S]+(f[s+S-M]>>1)&255;if(w==4)for(var S=M;S<R;S++)f[s+S]=f[v+S]+z(f[s+S-M],0,0)&255}else{if(w==2)for(var S=0;S<R;S++)f[s+S]=f[v+S]+f[s+S-R]&255;if(w==3){for(var S=0;S<M;S++)f[s+S]=f[v+S]+(f[s+S-R]>>1)&255;for(var S=M;S<R;S++)f[s+S]=f[v+S]+(f[s+S-R]+f[s+S-M]>>1)&255}if(w==4){for(var S=0;S<M;S++)f[s+S]=f[v+S]+z(0,f[s+S-R],0)&255;for(var S=M;S<R;S++)f[s+S]=f[v+S]+z(f[s+S-M],f[s+S-R],f[s+S-M-R])&255}}}return f},h.decode._paeth=function(f,g,b){var p=f+g-b,E=Math.abs(p-f),M=Math.abs(p-g),R=Math.abs(p-b);return E<=M&&E<=R?f:M<=R?g:b},h.decode._IHDR=function(f,g,b){var p=h._bin;b.width=p.readUint(f,g),g+=4,b.height=p.readUint(f,g),g+=4,b.depth=f[g],g++,b.ctype=f[g],g++,b.compress=f[g],g++,b.filter=f[g],g++,b.interlace=f[g],g++},h._bin={nextZero:function(f,g){for(;f[g]!=0;)g++;return g},readUshort:function(f,g){return f[g]<<8|f[g+1]},writeUshort:function(f,g,b){f[g]=b>>8&255,f[g+1]=b&255},readUint:function(f,g){return f[g]*16777216+(f[g+1]<<16|f[g+2]<<8|f[g+3])},writeUint:function(f,g,b){f[g]=b>>24&255,f[g+1]=b>>16&255,f[g+2]=b>>8&255,f[g+3]=b&255},readASCII:function(f,g,b){for(var p="",E=0;E<b;E++)p+=String.fromCharCode(f[g+E]);return p},writeASCII:function(f,g,b){for(var p=0;p<b.length;p++)f[g+p]=b.charCodeAt(p)},readBytes:function(f,g,b){for(var p=[],E=0;E<b;E++)p.push(f[g+E]);return p},pad:function(f){return f.length<2?"0"+f:f},readUTF8:function(f,g,b){for(var p="",E,M=0;M<b;M++)p+="%"+h._bin.pad(f[g+M].toString(16));try{E=decodeURIComponent(p)}catch{return h._bin.readASCII(f,g,b)}return E}},h._copyTile=function(f,g,b,p,E,M,R,z,l){for(var s=Math.min(g,E),v=Math.min(b,M),w=0,S=0,A=0;A<v;A++)for(var u=0;u<s;u++)if(R>=0&&z>=0?(w=A*g+u<<2,S=(z+A)*E+R+u<<2):(w=(-z+A)*g-R+u<<2,S=A*E+u<<2),l==0)p[S]=f[w],p[S+1]=f[w+1],p[S+2]=f[w+2],p[S+3]=f[w+3];else if(l==1){var y=f[w+3]*.00392156862745098,C=f[w]*y,k=f[w+1]*y,I=f[w+2]*y,O=p[S+3]*(1/255),D=p[S]*O,X=p[S+1]*O,j=p[S+2]*O,B=1-y,$=y+O*B,H=$==0?0:1/$;p[S+3]=255*$,p[S+0]=(C+D*B)*H,p[S+1]=(k+X*B)*H,p[S+2]=(I+j*B)*H}else if(l==2){var y=f[w+3],C=f[w],k=f[w+1],I=f[w+2],O=p[S+3],D=p[S],X=p[S+1],j=p[S+2];y==O&&C==D&&k==X&&I==j?(p[S]=0,p[S+1]=0,p[S+2]=0,p[S+3]=0):(p[S]=C,p[S+1]=k,p[S+2]=I,p[S+3]=y)}else if(l==3){var y=f[w+3],C=f[w],k=f[w+1],I=f[w+2],O=p[S+3],D=p[S],X=p[S+1],j=p[S+2];if(y==O&&C==D&&k==X&&I==j)continue;if(y<220&&O>20)return!1}return!0},h.encode=function(f,g,b,p,E,M){p==null&&(p=0),M==null&&(M=!1);for(var R=new Uint8Array(f[0].byteLength*f.length+100),z=[137,80,78,71,13,10,26,10],l=0;l<8;l++)R[l]=z[l];var s=8,v=h._bin,w=h.crc.crc,S=v.writeUint,A=v.writeUshort,u=v.writeASCII,y=h.encode.compressPNG(f,g,b,p,M);S(R,s,13),s+=4,u(R,s,"IHDR"),s+=4,S(R,s,g),s+=4,S(R,s,b),s+=4,R[s]=y.depth,s++,R[s]=y.ctype,s++,R[s]=0,s++,R[s]=0,s++,R[s]=0,s++,S(R,s,w(R,s-17,17)),s+=4,S(R,s,1),s+=4,u(R,s,"sRGB"),s+=4,R[s]=1,s++,S(R,s,w(R,s-5,5)),s+=4;var C=f.length>1;if(C&&(S(R,s,8),s+=4,u(R,s,"acTL"),s+=4,S(R,s,f.length),s+=4,S(R,s,0),s+=4,S(R,s,w(R,s-12,12)),s+=4),y.ctype==3){var k=y.plte.length;S(R,s,k*3),s+=4,u(R,s,"PLTE"),s+=4;for(var l=0;l<k;l++){var I=l*3,O=y.plte[l],D=O&255,X=O>>8&255,j=O>>16&255;R[s+I+0]=D,R[s+I+1]=X,R[s+I+2]=j}if(s+=k*3,S(R,s,w(R,s-k*3-4,k*3+4)),s+=4,y.gotAlpha){S(R,s,k),s+=4,u(R,s,"tRNS"),s+=4;for(var l=0;l<k;l++)R[s+l]=y.plte[l]>>24&255;s+=k,S(R,s,w(R,s-k-4,k+4)),s+=4}}for(var B=0,$=0;$<y.frames.length;$++){var H=y.frames[$];C&&(S(R,s,26),s+=4,u(R,s,"fcTL"),s+=4,S(R,s,B++),s+=4,S(R,s,H.rect.width),s+=4,S(R,s,H.rect.height),s+=4,S(R,s,H.rect.x),s+=4,S(R,s,H.rect.y),s+=4,A(R,s,E[$]),s+=2,A(R,s,1e3),s+=2,R[s]=H.dispose,s++,R[s]=H.blend,s++,S(R,s,w(R,s-30,30)),s+=4);var q=H.cimg,k=q.length;S(R,s,k+($==0?0:4)),s+=4;var W=s;u(R,s,$==0?"IDAT":"fdAT"),s+=4,$!=0&&(S(R,s,B++),s+=4);for(var l=0;l<k;l++)R[s+l]=q[l];s+=k,S(R,s,w(R,W,s-W)),s+=4}return S(R,s,0),s+=4,u(R,s,"IEND"),s+=4,S(R,s,w(R,s-4,4)),s+=4,R.buffer.slice(0,s)},h.encode.compressPNG=function(f,g,b,p,E){for(var M=h.encode.compress(f,g,b,p,!1,E),R=0;R<f.length;R++){var z=M.frames[R];z.rect.width;var l=z.rect.height,s=z.bpl,v=z.bpp,w=new Uint8Array(l*s+l);z.cimg=h.encode._filterZero(z.img,l,v,s,w)}return M},h.encode.compress=function(f,g,b,p,E,M){M==null&&(M=!1);for(var R=6,z=8,l=4,s=255,v=0;v<f.length;v++)for(var w=new Uint8Array(f[v]),S=w.length,A=0;A<S;A+=4)s&=w[A+3];var u=s!=255,y={},C=[];if(f.length!=0&&(y[0]=0,C.push(0),p!=0&&p--),p!=0){var k=h.quantize(f,p,E);f=k.bufs;for(var A=0;A<k.plte.length;A++){var I=k.plte[A].est.rgba;y[I]==null&&(y[I]=C.length,C.push(I))}}else for(var v=0;v<f.length;v++)for(var O=new Uint32Array(f[v]),S=O.length,A=0;A<S;A++){var I=O[A];if((A<g||I!=O[A-1]&&I!=O[A-g])&&y[I]==null&&(y[I]=C.length,C.push(I),C.length>=300))break}var D=u?E:!1,X=C.length;X<=256&&M==!1&&(X<=2?z=1:X<=4?z=2:X<=16?z=4:z=8,E&&(z=8),u=!0);for(var j=[],v=0;v<f.length;v++){var B=new Uint8Array(f[v]),$=new Uint32Array(B.buffer),H=0,q=0,W=g,Y=b,G=0;if(v!=0&&!D){for(var V=E||v==1||j[j.length-2].dispose==2?1:2,Q=0,xe=1e9,ce=0;ce<V;ce++){for(var mt=new Uint8Array(f[v-1-ce]),Ne=new Uint32Array(f[v-1-ce]),Pe=g,Fe=b,Me=-1,je=-1,ft=0;ft<b;ft++)for(var jt=0;jt<g;jt++){var A=ft*g+jt;$[A]!=Ne[A]&&(jt<Pe&&(Pe=jt),jt>Me&&(Me=jt),ft<Fe&&(Fe=ft),ft>je&&(je=ft))}var Gt=Me==-1?1:(Me-Pe+1)*(je-Fe+1);Gt<xe&&(xe=Gt,Q=ce,Me==-1?(H=q=0,W=Y=1):(H=Pe,q=Fe,W=Me-Pe+1,Y=je-Fe+1))}var mt=new Uint8Array(f[v-1-Q]);Q==1&&(j[j.length-1].dispose=2);var Le=new Uint8Array(W*Y*4);new Uint32Array(Le.buffer),h._copyTile(mt,g,b,Le,W,Y,-H,-q,0),h._copyTile(B,g,b,Le,W,Y,-H,-q,3)?(h._copyTile(B,g,b,Le,W,Y,-H,-q,2),G=1):(h._copyTile(B,g,b,Le,W,Y,-H,-q,0),G=0),B=Le,$=new Uint32Array(B.buffer)}var ht=4*W;if(X<=256&&M==!1){ht=Math.ceil(z*W/8);for(var Le=new Uint8Array(ht*Y),ft=0;ft<Y;ft++){var A=ft*ht,ar=ft*W;if(z==8)for(var jt=0;jt<W;jt++)Le[A+jt]=y[$[ar+jt]];else if(z==4)for(var jt=0;jt<W;jt++)Le[A+(jt>>1)]|=y[$[ar+jt]]<<4-(jt&1)*4;else if(z==2)for(var jt=0;jt<W;jt++)Le[A+(jt>>2)]|=y[$[ar+jt]]<<6-(jt&3)*2;else if(z==1)for(var jt=0;jt<W;jt++)Le[A+(jt>>3)]|=y[$[ar+jt]]<<7-(jt&7)*1}B=Le,R=3,l=1}else if(u==!1&&f.length==1){for(var Le=new Uint8Array(W*Y*3),Jt=W*Y,A=0;A<Jt;A++){var Wt=A*3,Gr=A*4;Le[Wt]=B[Gr],Le[Wt+1]=B[Gr+1],Le[Wt+2]=B[Gr+2]}B=Le,R=2,l=3,ht=3*W}j.push({rect:{x:H,y:q,width:W,height:Y},img:B,bpl:ht,bpp:l,blend:G,dispose:D?1:0})}return{ctype:R,depth:z,plte:C,gotAlpha:u,frames:j}},h.encode._filterZero=function(f,g,b,p,E){for(var M=[],R=0;R<5;R++)if(!(g*p>5e5&&(R==2||R==3||R==4))){for(var z=0;z<g;z++)h.encode._filterLine(E,f,z,p,b,R);if(M.push(_.deflate(E)),b==1)break}for(var l,s=1e9,v=0;v<M.length;v++)M[v].length<s&&(l=v,s=M[v].length);return M[l]},h.encode._filterLine=function(f,g,b,p,E,M){var R=b*p,z=R+b,l=h.decode._paeth;if(f[z]=M,z++,M==0)for(var s=0;s<p;s++)f[z+s]=g[R+s];else if(M==1){for(var s=0;s<E;s++)f[z+s]=g[R+s];for(var s=E;s<p;s++)f[z+s]=g[R+s]-g[R+s-E]+256&255}else if(b==0){for(var s=0;s<E;s++)f[z+s]=g[R+s];if(M==2)for(var s=E;s<p;s++)f[z+s]=g[R+s];if(M==3)for(var s=E;s<p;s++)f[z+s]=g[R+s]-(g[R+s-E]>>1)+256&255;if(M==4)for(var s=E;s<p;s++)f[z+s]=g[R+s]-l(g[R+s-E],0,0)+256&255}else{if(M==2)for(var s=0;s<p;s++)f[z+s]=g[R+s]+256-g[R+s-p]&255;if(M==3){for(var s=0;s<E;s++)f[z+s]=g[R+s]+256-(g[R+s-p]>>1)&255;for(var s=E;s<p;s++)f[z+s]=g[R+s]+256-(g[R+s-p]+g[R+s-E]>>1)&255}if(M==4){for(var s=0;s<E;s++)f[z+s]=g[R+s]+256-l(0,g[R+s-p],0)&255;for(var s=E;s<p;s++)f[z+s]=g[R+s]+256-l(g[R+s-E],g[R+s-p],g[R+s-E-p])&255}}},h.crc={table:(function(){for(var f=new Uint32Array(256),g=0;g<256;g++){for(var b=g,p=0;p<8;p++)b&1?b=3988292384^b>>>1:b=b>>>1;f[g]=b}return f})(),update:function(f,g,b,p){for(var E=0;E<p;E++)f=h.crc.table[(f^g[b+E])&255]^f>>>8;return f},crc:function(f,g,b){return h.crc.update(4294967295,f,g,b)^4294967295}},h.quantize=function(f,g,b){for(var p=[],E=0,M=0;M<f.length;M++)p.push(h.encode.alphaMul(new Uint8Array(f[M]),b)),E+=f[M].byteLength;for(var R=new Uint8Array(E),z=new Uint32Array(R.buffer),l=0,M=0;M<p.length;M++){for(var s=p[M],v=s.length,w=0;w<v;w++)R[l+w]=s[w];l+=v}var S={i0:0,i1:R.length,bst:null,est:null,tdst:0,left:null,right:null};S.bst=h.quantize.stats(R,S.i0,S.i1),S.est=h.quantize.estats(S.bst);for(var A=[S];A.length<g;){for(var u=0,y=0,M=0;M<A.length;M++)A[M].est.L>u&&(u=A[M].est.L,y=M);if(u<.001)break;var C=A[y],k=h.quantize.splitPixels(R,z,C.i0,C.i1,C.est.e,C.est.eMq255),I={i0:C.i0,i1:k,bst:null,est:null,tdst:0,left:null,right:null};I.bst=h.quantize.stats(R,I.i0,I.i1),I.est=h.quantize.estats(I.bst);var O={i0:k,i1:C.i1,bst:null,est:null,tdst:0,left:null,right:null};O.bst={R:[],m:[],N:C.bst.N-I.bst.N};for(var M=0;M<16;M++)O.bst.R[M]=C.bst.R[M]-I.bst.R[M];for(var M=0;M<4;M++)O.bst.m[M]=C.bst.m[M]-I.bst.m[M];O.est=h.quantize.estats(O.bst),C.left=I,C.right=O,A[y]=I,A.push(O)}A.sort(function(V,Q){return Q.bst.N-V.bst.N});for(var D=0;D<p.length;D++){for(var X=h.quantize.planeDst,j=new Uint8Array(p[D].buffer),B=new Uint32Array(p[D].buffer),$=j.length,M=0;M<$;M+=4){for(var H=j[M]*.00392156862745098,q=j[M+1]*.00392156862745098,W=j[M+2]*.00392156862745098,Y=j[M+3]*.00392156862745098,G=S;G.left;)G=X(G.est,H,q,W,Y)<=0?G.left:G.right;B[M>>2]=G.est.rgba}p[D]=B.buffer}return{bufs:p,plte:A}},h.quantize.getNearest=function(f,g,b,p,E){if(f.left==null)return f.tdst=h.quantize.dist(f.est.q,g,b,p,E),f;var M=h.quantize.planeDst(f.est,g,b,p,E),R=f.left,z=f.right;M>0&&(R=f.right,z=f.left);var l=h.quantize.getNearest(R,g,b,p,E);if(l.tdst<=M*M)return l;var s=h.quantize.getNearest(z,g,b,p,E);return s.tdst<l.tdst?s:l},h.quantize.planeDst=function(f,g,b,p,E){var M=f.e;return M[0]*g+M[1]*b+M[2]*p+M[3]*E-f.eMq},h.quantize.dist=function(f,g,b,p,E){var M=g-f[0],R=b-f[1],z=p-f[2],l=E-f[3];return M*M+R*R+z*z+l*l},h.quantize.splitPixels=function(f,g,b,p,E,M){var R=h.quantize.vecDot;for(p-=4;b<p;){for(;R(f,b,E)<=M;)b+=4;for(;R(f,p,E)>M;)p-=4;if(b>=p)break;var z=g[b>>2];g[b>>2]=g[p>>2],g[p>>2]=z,b+=4,p-=4}for(;R(f,b,E)>M;)b-=4;return b+4},h.quantize.vecDot=function(f,g,b){return f[g]*b[0]+f[g+1]*b[1]+f[g+2]*b[2]+f[g+3]*b[3]},h.quantize.stats=function(f,g,b){for(var p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],E=[0,0,0,0],M=b-g>>2,R=g;R<b;R+=4){var z=f[R]*.00392156862745098,l=f[R+1]*(1/255),s=f[R+2]*(1/255),v=f[R+3]*(1/255);E[0]+=z,E[1]+=l,E[2]+=s,E[3]+=v,p[0]+=z*z,p[1]+=z*l,p[2]+=z*s,p[3]+=z*v,p[5]+=l*l,p[6]+=l*s,p[7]+=l*v,p[10]+=s*s,p[11]+=s*v,p[15]+=v*v}return p[4]=p[1],p[8]=p[2],p[12]=p[3],p[9]=p[6],p[13]=p[7],p[14]=p[11],{R:p,m:E,N:M}},h.quantize.estats=function(f){var g=f.R,b=f.m,p=f.N,E=b[0],M=b[1],R=b[2],z=b[3],l=p==0?0:1/p,s=[g[0]-E*E*l,g[1]-E*M*l,g[2]-E*R*l,g[3]-E*z*l,g[4]-M*E*l,g[5]-M*M*l,g[6]-M*R*l,g[7]-M*z*l,g[8]-R*E*l,g[9]-R*M*l,g[10]-R*R*l,g[11]-R*z*l,g[12]-z*E*l,g[13]-z*M*l,g[14]-z*R*l,g[15]-z*z*l],v=s,w=h.M4,S=[.5,.5,.5,.5],A=0,u=0;if(p!=0)for(var y=0;y<10&&(S=w.multVec(v,S),u=Math.sqrt(w.dot(S,S)),S=w.sml(1/u,S),!(Math.abs(u-A)<1e-9));y++)A=u;var C=[E*l,M*l,R*l,z*l],k=w.dot(w.sml(255,C),S),I=C[3]<.001?0:1/C[3];return{Cov:s,q:C,e:S,L:A,eMq255:k,eMq:w.dot(S,C),rgba:(Math.round(255*C[3])<<24|Math.round(255*C[2]*I)<<16|Math.round(255*C[1]*I)<<8|Math.round(255*C[0]*I)<<0)>>>0}},h.M4={multVec:function(f,g){return[f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3],f[4]*g[0]+f[5]*g[1]+f[6]*g[2]+f[7]*g[3],f[8]*g[0]+f[9]*g[1]+f[10]*g[2]+f[11]*g[3],f[12]*g[0]+f[13]*g[1]+f[14]*g[2]+f[15]*g[3]]},dot:function(f,g){return f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3]},sml:function(f,g){return[f*g[0],f*g[1],f*g[2],f*g[3]]}},h.encode.alphaMul=function(f,g){for(var b=new Uint8Array(f.length),p=f.length>>2,E=0;E<p;E++){var M=E<<2,R=f[M+3];g&&(R=R<128?0:255);var z=R*(1/255);b[M+0]=f[M+0]*z,b[M+1]=f[M+1]*z,b[M+2]=f[M+2]*z,b[M+3]=R}return b}})(a,c)})()}),"./node_modules/upng-js/node_modules/pako/index.js":((e,r,t)=>{var a=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js").assign,c=t("./node_modules/upng-js/node_modules/pako/lib/deflate.js"),h=t("./node_modules/upng-js/node_modules/pako/lib/inflate.js"),_=t("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),f={};a(f,c,h,_),e.exports=f}),"./node_modules/upng-js/node_modules/pako/lib/deflate.js":((e,r,t)=>{var a=t("./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),h=t("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),_=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),f=t("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),g=Object.prototype.toString,b=0,p=4,E=0,M=1,R=2,z=-1,l=0,s=8;function v(u){if(!(this instanceof v))return new v(u);this.options=c.assign({level:z,method:s,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},u||{});var y=this.options;y.raw&&y.windowBits>0?y.windowBits=-y.windowBits:y.gzip&&y.windowBits>0&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var C=a.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(C!==E)throw new Error(_[C]);if(y.header&&a.deflateSetHeader(this.strm,y.header),y.dictionary){var k;if(typeof y.dictionary=="string"?k=h.string2buf(y.dictionary):g.call(y.dictionary)==="[object ArrayBuffer]"?k=new Uint8Array(y.dictionary):k=y.dictionary,C=a.deflateSetDictionary(this.strm,k),C!==E)throw new Error(_[C]);this._dict_set=!0}}v.prototype.push=function(u,y){var C=this.strm,k=this.options.chunkSize,I,O;if(this.ended)return!1;O=y===~~y?y:y===!0?p:b,typeof u=="string"?C.input=h.string2buf(u):g.call(u)==="[object ArrayBuffer]"?C.input=new Uint8Array(u):C.input=u,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new c.Buf8(k),C.next_out=0,C.avail_out=k),I=a.deflate(C,O),I!==M&&I!==E)return this.onEnd(I),this.ended=!0,!1;(C.avail_out===0||C.avail_in===0&&(O===p||O===R))&&(this.options.to==="string"?this.onData(h.buf2binstring(c.shrinkBuf(C.output,C.next_out))):this.onData(c.shrinkBuf(C.output,C.next_out)))}while((C.avail_in>0||C.avail_out===0)&&I!==M);return O===p?(I=a.deflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===E):(O===R&&(this.onEnd(E),C.avail_out=0),!0)},v.prototype.onData=function(u){this.chunks.push(u)},v.prototype.onEnd=function(u){u===E&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=u,this.msg=this.strm.msg};function w(u,y){var C=new v(y);if(C.push(u,!0),C.err)throw C.msg||_[C.err];return C.result}function S(u,y){return y=y||{},y.raw=!0,w(u,y)}function A(u,y){return y=y||{},y.gzip=!0,w(u,y)}r.Deflate=v,r.deflate=w,r.deflateRaw=S,r.gzip=A}),"./node_modules/upng-js/node_modules/pako/lib/inflate.js":((e,r,t)=>{var a=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),h=t("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),_=t("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),f=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),g=t("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),b=t("./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js"),p=Object.prototype.toString;function E(z){if(!(this instanceof E))return new E(z);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},z||{});var l=this.options;l.raw&&l.windowBits>=0&&l.windowBits<16&&(l.windowBits=-l.windowBits,l.windowBits===0&&(l.windowBits=-15)),l.windowBits>=0&&l.windowBits<16&&!(z&&z.windowBits)&&(l.windowBits+=32),l.windowBits>15&&l.windowBits<48&&(l.windowBits&15||(l.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var s=a.inflateInit2(this.strm,l.windowBits);if(s!==_.Z_OK)throw new Error(f[s]);if(this.header=new b,a.inflateGetHeader(this.strm,this.header),l.dictionary&&(typeof l.dictionary=="string"?l.dictionary=h.string2buf(l.dictionary):p.call(l.dictionary)==="[object ArrayBuffer]"&&(l.dictionary=new Uint8Array(l.dictionary)),l.raw&&(s=a.inflateSetDictionary(this.strm,l.dictionary),s!==_.Z_OK)))throw new Error(f[s])}E.prototype.push=function(z,l){var s=this.strm,v=this.options.chunkSize,w=this.options.dictionary,S,A,u,y,C,k=!1;if(this.ended)return!1;A=l===~~l?l:l===!0?_.Z_FINISH:_.Z_NO_FLUSH,typeof z=="string"?s.input=h.binstring2buf(z):p.call(z)==="[object ArrayBuffer]"?s.input=new Uint8Array(z):s.input=z,s.next_in=0,s.avail_in=s.input.length;do{if(s.avail_out===0&&(s.output=new c.Buf8(v),s.next_out=0,s.avail_out=v),S=a.inflate(s,_.Z_NO_FLUSH),S===_.Z_NEED_DICT&&w&&(S=a.inflateSetDictionary(this.strm,w)),S===_.Z_BUF_ERROR&&k===!0&&(S=_.Z_OK,k=!1),S!==_.Z_STREAM_END&&S!==_.Z_OK)return this.onEnd(S),this.ended=!0,!1;s.next_out&&(s.avail_out===0||S===_.Z_STREAM_END||s.avail_in===0&&(A===_.Z_FINISH||A===_.Z_SYNC_FLUSH))&&(this.options.to==="string"?(u=h.utf8border(s.output,s.next_out),y=s.next_out-u,C=h.buf2string(s.output,u),s.next_out=y,s.avail_out=v-y,y&&c.arraySet(s.output,s.output,u,y,0),this.onData(C)):this.onData(c.shrinkBuf(s.output,s.next_out))),s.avail_in===0&&s.avail_out===0&&(k=!0)}while((s.avail_in>0||s.avail_out===0)&&S!==_.Z_STREAM_END);return S===_.Z_STREAM_END&&(A=_.Z_FINISH),A===_.Z_FINISH?(S=a.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===_.Z_OK):(A===_.Z_SYNC_FLUSH&&(this.onEnd(_.Z_OK),s.avail_out=0),!0)},E.prototype.onData=function(z){this.chunks.push(z)},E.prototype.onEnd=function(z){z===_.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=z,this.msg=this.strm.msg};function M(z,l){var s=new E(l);if(s.push(z,!0),s.err)throw s.msg||f[s.err];return s.result}function R(z,l){return l=l||{},l.raw=!0,M(z,l)}r.Inflate=E,r.inflate=M,r.inflateRaw=R,r.ungzip=M}),"./node_modules/upng-js/node_modules/pako/lib/utils/common.js":((e,r)=>{var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function a(_,f){return Object.prototype.hasOwnProperty.call(_,f)}r.assign=function(_){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var g=f.shift();if(g){if(typeof g!="object")throw new TypeError(g+"must be non-object");for(var b in g)a(g,b)&&(_[b]=g[b])}}return _},r.shrinkBuf=function(_,f){return _.length===f?_:_.subarray?_.subarray(0,f):(_.length=f,_)};var c={arraySet:function(_,f,g,b,p){if(f.subarray&&_.subarray){_.set(f.subarray(g,g+b),p);return}for(var E=0;E<b;E++)_[p+E]=f[g+E]},flattenChunks:function(_){var f,g,b,p,E,M;for(b=0,f=0,g=_.length;f<g;f++)b+=_[f].length;for(M=new Uint8Array(b),p=0,f=0,g=_.length;f<g;f++)E=_[f],M.set(E,p),p+=E.length;return M}},h={arraySet:function(_,f,g,b,p){for(var E=0;E<b;E++)_[p+E]=f[g+E]},flattenChunks:function(_){return[].concat.apply([],_)}};r.setTyped=function(_){_?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,c)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,h))},r.setTyped(t)}),"./node_modules/upng-js/node_modules/pako/lib/utils/strings.js":((e,r,t)=>{var a=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=!0,h=!0;try{String.fromCharCode.apply(null,[0])}catch{c=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{h=!1}for(var _=new a.Buf8(256),f=0;f<256;f++)_[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;_[254]=_[254]=1,r.string2buf=function(b){var p,E,M,R,z,l=b.length,s=0;for(R=0;R<l;R++)E=b.charCodeAt(R),(E&64512)===55296&&R+1<l&&(M=b.charCodeAt(R+1),(M&64512)===56320&&(E=65536+(E-55296<<10)+(M-56320),R++)),s+=E<128?1:E<2048?2:E<65536?3:4;for(p=new a.Buf8(s),z=0,R=0;z<s;R++)E=b.charCodeAt(R),(E&64512)===55296&&R+1<l&&(M=b.charCodeAt(R+1),(M&64512)===56320&&(E=65536+(E-55296<<10)+(M-56320),R++)),E<128?p[z++]=E:E<2048?(p[z++]=192|E>>>6,p[z++]=128|E&63):E<65536?(p[z++]=224|E>>>12,p[z++]=128|E>>>6&63,p[z++]=128|E&63):(p[z++]=240|E>>>18,p[z++]=128|E>>>12&63,p[z++]=128|E>>>6&63,p[z++]=128|E&63);return p};function g(b,p){if(p<65534&&(b.subarray&&h||!b.subarray&&c))return String.fromCharCode.apply(null,a.shrinkBuf(b,p));for(var E="",M=0;M<p;M++)E+=String.fromCharCode(b[M]);return E}r.buf2binstring=function(b){return g(b,b.length)},r.binstring2buf=function(b){for(var p=new a.Buf8(b.length),E=0,M=p.length;E<M;E++)p[E]=b.charCodeAt(E);return p},r.buf2string=function(b,p){var E,M,R,z,l=p||b.length,s=new Array(l*2);for(M=0,E=0;E<l;){if(R=b[E++],R<128){s[M++]=R;continue}if(z=_[R],z>4){s[M++]=65533,E+=z-1;continue}for(R&=z===2?31:z===3?15:7;z>1&&E<l;)R=R<<6|b[E++]&63,z--;if(z>1){s[M++]=65533;continue}R<65536?s[M++]=R:(R-=65536,s[M++]=55296|R>>10&1023,s[M++]=56320|R&1023)}return g(s,M)},r.utf8border=function(b,p){var E;for(p=p||b.length,p>b.length&&(p=b.length),E=p-1;E>=0&&(b[E]&192)===128;)E--;return E<0||E===0?p:E+_[b[E]]>p?E:p}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js":(e=>{function r(t,a,c,h){for(var _=t&65535|0,f=t>>>16&65535|0,g=0;c!==0;){g=c>2e3?2e3:c,c-=g;do _=_+a[h++]|0,f=f+_|0;while(--g);_%=65521,f%=65521}return _|f<<16|0}e.exports=r}),"./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js":(e=>{e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js":(e=>{function r(){for(var c,h=[],_=0;_<256;_++){c=_;for(var f=0;f<8;f++)c=c&1?3988292384^c>>>1:c>>>1;h[_]=c}return h}var t=r();function a(c,h,_,f){var g=t,b=f+_;c^=-1;for(var p=f;p<b;p++)c=c>>>8^g[(c^h[p])&255];return c^-1}e.exports=a}),"./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js":((e,r,t)=>{var a=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js"),h=t("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),_=t("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),f=t("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),g=0,b=1,p=3,E=4,M=5,R=0,z=1,l=-2,s=-3,v=-5,w=-1,S=1,A=2,u=3,y=4,C=0,k=2,I=8,O=9,D=15,X=8,j=29,B=256,$=B+1+j,H=30,q=19,W=2*$+1,Y=15,G=3,V=258,Q=V+G+1,xe=32,ce=42,Ne=69,Pe=73,Fe=91,Me=103,je=113,ft=666,jt=1,Gt=2,mt=3,Le=4,ht=3;function ar(Z,ut){return Z.msg=f[ut],ut}function Jt(Z){return(Z<<1)-(Z>4?9:0)}function Wt(Z){for(var ut=Z.length;--ut>=0;)Z[ut]=0}function Gr(Z){var ut=Z.state,at=ut.pending;at>Z.avail_out&&(at=Z.avail_out),at!==0&&(a.arraySet(Z.output,ut.pending_buf,ut.pending_out,at,Z.next_out),Z.next_out+=at,ut.pending_out+=at,Z.total_out+=at,Z.avail_out-=at,ut.pending-=at,ut.pending===0&&(ut.pending_out=0))}function Lr(Z,ut){c._tr_flush_block(Z,Z.block_start>=0?Z.block_start:-1,Z.strstart-Z.block_start,ut),Z.block_start=Z.strstart,Gr(Z.strm)}function zr(Z,ut){Z.pending_buf[Z.pending++]=ut}function Nr(Z,ut){Z.pending_buf[Z.pending++]=ut>>>8&255,Z.pending_buf[Z.pending++]=ut&255}function At(Z,ut,at,me){var Ze=Z.avail_in;return Ze>me&&(Ze=me),Ze===0?0:(Z.avail_in-=Ze,a.arraySet(ut,Z.input,Z.next_in,Ze,at),Z.state.wrap===1?Z.adler=h(Z.adler,ut,Ze,at):Z.state.wrap===2&&(Z.adler=_(Z.adler,ut,Ze,at)),Z.next_in+=Ze,Z.total_in+=Ze,Ze)}function Mt(Z,ut){var at=Z.max_chain_length,me=Z.strstart,Ze,vt,Qr=Z.prev_length,Zr=Z.nice_match,Kr=Z.strstart>Z.w_size-Q?Z.strstart-(Z.w_size-Q):0,bn=Z.window,ls=Z.w_mask,Pn=Z.prev,On=Z.strstart+V,Dn=bn[me+Qr-1],gi=bn[me+Qr];Z.prev_length>=Z.good_match&&(at>>=2),Zr>Z.lookahead&&(Zr=Z.lookahead);do if(Ze=ut,!(bn[Ze+Qr]!==gi||bn[Ze+Qr-1]!==Dn||bn[Ze]!==bn[me]||bn[++Ze]!==bn[me+1])){me+=2,Ze++;do;while(bn[++me]===bn[++Ze]&&bn[++me]===bn[++Ze]&&bn[++me]===bn[++Ze]&&bn[++me]===bn[++Ze]&&bn[++me]===bn[++Ze]&&bn[++me]===bn[++Ze]&&bn[++me]===bn[++Ze]&&bn[++me]===bn[++Ze]&&me<On);if(vt=V-(On-me),me=On-V,vt>Qr){if(Z.match_start=ut,Qr=vt,vt>=Zr)break;Dn=bn[me+Qr-1],gi=bn[me+Qr]}}while((ut=Pn[ut&ls])>Kr&&--at!==0);return Qr<=Z.lookahead?Qr:Z.lookahead}function Jr(Z){var ut=Z.w_size,at,me,Ze,vt,Qr;do{if(vt=Z.window_size-Z.lookahead-Z.strstart,Z.strstart>=ut+(ut-Q)){a.arraySet(Z.window,Z.window,ut,ut,0),Z.match_start-=ut,Z.strstart-=ut,Z.block_start-=ut,me=Z.hash_size,at=me;do Ze=Z.head[--at],Z.head[at]=Ze>=ut?Ze-ut:0;while(--me);me=ut,at=me;do Ze=Z.prev[--at],Z.prev[at]=Ze>=ut?Ze-ut:0;while(--me);vt+=ut}if(Z.strm.avail_in===0)break;if(me=At(Z.strm,Z.window,Z.strstart+Z.lookahead,vt),Z.lookahead+=me,Z.lookahead+Z.insert>=G)for(Qr=Z.strstart-Z.insert,Z.ins_h=Z.window[Qr],Z.ins_h=(Z.ins_h<<Z.hash_shift^Z.window[Qr+1])&Z.hash_mask;Z.insert&&(Z.ins_h=(Z.ins_h<<Z.hash_shift^Z.window[Qr+G-1])&Z.hash_mask,Z.prev[Qr&Z.w_mask]=Z.head[Z.ins_h],Z.head[Z.ins_h]=Qr,Qr++,Z.insert--,!(Z.lookahead+Z.insert<G)););}while(Z.lookahead<Q&&Z.strm.avail_in!==0)}function qr(Z,ut){var at=65535;for(at>Z.pending_buf_size-5&&(at=Z.pending_buf_size-5);;){if(Z.lookahead<=1){if(Jr(Z),Z.lookahead===0&&ut===g)return jt;if(Z.lookahead===0)break}Z.strstart+=Z.lookahead,Z.lookahead=0;var me=Z.block_start+at;if((Z.strstart===0||Z.strstart>=me)&&(Z.lookahead=Z.strstart-me,Z.strstart=me,Lr(Z,!1),Z.strm.avail_out===0)||Z.strstart-Z.block_start>=Z.w_size-Q&&(Lr(Z,!1),Z.strm.avail_out===0))return jt}return Z.insert=0,ut===E?(Lr(Z,!0),Z.strm.avail_out===0?mt:Le):(Z.strstart>Z.block_start&&(Lr(Z,!1),Z.strm.avail_out),jt)}function ie(Z,ut){for(var at,me;;){if(Z.lookahead<Q){if(Jr(Z),Z.lookahead<Q&&ut===g)return jt;if(Z.lookahead===0)break}if(at=0,Z.lookahead>=G&&(Z.ins_h=(Z.ins_h<<Z.hash_shift^Z.window[Z.strstart+G-1])&Z.hash_mask,at=Z.prev[Z.strstart&Z.w_mask]=Z.head[Z.ins_h],Z.head[Z.ins_h]=Z.strstart),at!==0&&Z.strstart-at<=Z.w_size-Q&&(Z.match_length=Mt(Z,at)),Z.match_length>=G)if(me=c._tr_tally(Z,Z.strstart-Z.match_start,Z.match_length-G),Z.lookahead-=Z.match_length,Z.match_length<=Z.max_lazy_match&&Z.lookahead>=G){Z.match_length--;do Z.strstart++,Z.ins_h=(Z.ins_h<<Z.hash_shift^Z.window[Z.strstart+G-1])&Z.hash_mask,at=Z.prev[Z.strstart&Z.w_mask]=Z.head[Z.ins_h],Z.head[Z.ins_h]=Z.strstart;while(--Z.match_length!==0);Z.strstart++}else Z.strstart+=Z.match_length,Z.match_length=0,Z.ins_h=Z.window[Z.strstart],Z.ins_h=(Z.ins_h<<Z.hash_shift^Z.window[Z.strstart+1])&Z.hash_mask;else me=c._tr_tally(Z,0,Z.window[Z.strstart]),Z.lookahead--,Z.strstart++;if(me&&(Lr(Z,!1),Z.strm.avail_out===0))return jt}return Z.insert=Z.strstart<G-1?Z.strstart:G-1,ut===E?(Lr(Z,!0),Z.strm.avail_out===0?mt:Le):Z.last_lit&&(Lr(Z,!1),Z.strm.avail_out===0)?jt:Gt}function ve(Z,ut){for(var at,me,Ze;;){if(Z.lookahead<Q){if(Jr(Z),Z.lookahead<Q&&ut===g)return jt;if(Z.lookahead===0)break}if(at=0,Z.lookahead>=G&&(Z.ins_h=(Z.ins_h<<Z.hash_shift^Z.window[Z.strstart+G-1])&Z.hash_mask,at=Z.prev[Z.strstart&Z.w_mask]=Z.head[Z.ins_h],Z.head[Z.ins_h]=Z.strstart),Z.prev_length=Z.match_length,Z.prev_match=Z.match_start,Z.match_length=G-1,at!==0&&Z.prev_length<Z.max_lazy_match&&Z.strstart-at<=Z.w_size-Q&&(Z.match_length=Mt(Z,at),Z.match_length<=5&&(Z.strategy===S||Z.match_length===G&&Z.strstart-Z.match_start>4096)&&(Z.match_length=G-1)),Z.prev_length>=G&&Z.match_length<=Z.prev_length){Ze=Z.strstart+Z.lookahead-G,me=c._tr_tally(Z,Z.strstart-1-Z.prev_match,Z.prev_length-G),Z.lookahead-=Z.prev_length-1,Z.prev_length-=2;do++Z.strstart<=Ze&&(Z.ins_h=(Z.ins_h<<Z.hash_shift^Z.window[Z.strstart+G-1])&Z.hash_mask,at=Z.prev[Z.strstart&Z.w_mask]=Z.head[Z.ins_h],Z.head[Z.ins_h]=Z.strstart);while(--Z.prev_length!==0);if(Z.match_available=0,Z.match_length=G-1,Z.strstart++,me&&(Lr(Z,!1),Z.strm.avail_out===0))return jt}else if(Z.match_available){if(me=c._tr_tally(Z,0,Z.window[Z.strstart-1]),me&&Lr(Z,!1),Z.strstart++,Z.lookahead--,Z.strm.avail_out===0)return jt}else Z.match_available=1,Z.strstart++,Z.lookahead--}return Z.match_available&&(me=c._tr_tally(Z,0,Z.window[Z.strstart-1]),Z.match_available=0),Z.insert=Z.strstart<G-1?Z.strstart:G-1,ut===E?(Lr(Z,!0),Z.strm.avail_out===0?mt:Le):Z.last_lit&&(Lr(Z,!1),Z.strm.avail_out===0)?jt:Gt}function we(Z,ut){for(var at,me,Ze,vt,Qr=Z.window;;){if(Z.lookahead<=V){if(Jr(Z),Z.lookahead<=V&&ut===g)return jt;if(Z.lookahead===0)break}if(Z.match_length=0,Z.lookahead>=G&&Z.strstart>0&&(Ze=Z.strstart-1,me=Qr[Ze],me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze])){vt=Z.strstart+V;do;while(me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&me===Qr[++Ze]&&Ze<vt);Z.match_length=V-(vt-Ze),Z.match_length>Z.lookahead&&(Z.match_length=Z.lookahead)}if(Z.match_length>=G?(at=c._tr_tally(Z,1,Z.match_length-G),Z.lookahead-=Z.match_length,Z.strstart+=Z.match_length,Z.match_length=0):(at=c._tr_tally(Z,0,Z.window[Z.strstart]),Z.lookahead--,Z.strstart++),at&&(Lr(Z,!1),Z.strm.avail_out===0))return jt}return Z.insert=0,ut===E?(Lr(Z,!0),Z.strm.avail_out===0?mt:Le):Z.last_lit&&(Lr(Z,!1),Z.strm.avail_out===0)?jt:Gt}function it(Z,ut){for(var at;;){if(Z.lookahead===0&&(Jr(Z),Z.lookahead===0)){if(ut===g)return jt;break}if(Z.match_length=0,at=c._tr_tally(Z,0,Z.window[Z.strstart]),Z.lookahead--,Z.strstart++,at&&(Lr(Z,!1),Z.strm.avail_out===0))return jt}return Z.insert=0,ut===E?(Lr(Z,!0),Z.strm.avail_out===0?mt:Le):Z.last_lit&&(Lr(Z,!1),Z.strm.avail_out===0)?jt:Gt}function rt(Z,ut,at,me,Ze){this.good_length=Z,this.max_lazy=ut,this.nice_length=at,this.max_chain=me,this.func=Ze}var Yt;Yt=[new rt(0,0,0,0,qr),new rt(4,4,8,4,ie),new rt(4,5,16,8,ie),new rt(4,6,32,32,ie),new rt(4,4,16,16,ve),new rt(8,16,32,32,ve),new rt(8,16,128,128,ve),new rt(8,32,128,256,ve),new rt(32,128,258,1024,ve),new rt(32,258,258,4096,ve)];function Ot(Z){Z.window_size=2*Z.w_size,Wt(Z.head),Z.max_lazy_match=Yt[Z.level].max_lazy,Z.good_match=Yt[Z.level].good_length,Z.nice_match=Yt[Z.level].nice_length,Z.max_chain_length=Yt[Z.level].max_chain,Z.strstart=0,Z.block_start=0,Z.lookahead=0,Z.insert=0,Z.match_length=Z.prev_length=G-1,Z.match_available=0,Z.ins_h=0}function re(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=I,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(W*2),this.dyn_dtree=new a.Buf16((2*H+1)*2),this.bl_tree=new a.Buf16((2*q+1)*2),Wt(this.dyn_ltree),Wt(this.dyn_dtree),Wt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(Y+1),this.heap=new a.Buf16(2*$+1),Wt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*$+1),Wt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function tt(Z){var ut;return!Z||!Z.state?ar(Z,l):(Z.total_in=Z.total_out=0,Z.data_type=k,ut=Z.state,ut.pending=0,ut.pending_out=0,ut.wrap<0&&(ut.wrap=-ut.wrap),ut.status=ut.wrap?ce:je,Z.adler=ut.wrap===2?0:1,ut.last_flush=g,c._tr_init(ut),R)}function lt(Z){var ut=tt(Z);return ut===R&&Ot(Z.state),ut}function cr(Z,ut){return!Z||!Z.state||Z.state.wrap!==2?l:(Z.state.gzhead=ut,R)}function et(Z,ut,at,me,Ze,vt){if(!Z)return l;var Qr=1;if(ut===w&&(ut=6),me<0?(Qr=0,me=-me):me>15&&(Qr=2,me-=16),Ze<1||Ze>O||at!==I||me<8||me>15||ut<0||ut>9||vt<0||vt>y)return ar(Z,l);me===8&&(me=9);var Zr=new re;return Z.state=Zr,Zr.strm=Z,Zr.wrap=Qr,Zr.gzhead=null,Zr.w_bits=me,Zr.w_size=1<<Zr.w_bits,Zr.w_mask=Zr.w_size-1,Zr.hash_bits=Ze+7,Zr.hash_size=1<<Zr.hash_bits,Zr.hash_mask=Zr.hash_size-1,Zr.hash_shift=~~((Zr.hash_bits+G-1)/G),Zr.window=new a.Buf8(Zr.w_size*2),Zr.head=new a.Buf16(Zr.hash_size),Zr.prev=new a.Buf16(Zr.w_size),Zr.lit_bufsize=1<<Ze+6,Zr.pending_buf_size=Zr.lit_bufsize*4,Zr.pending_buf=new a.Buf8(Zr.pending_buf_size),Zr.d_buf=1*Zr.lit_bufsize,Zr.l_buf=3*Zr.lit_bufsize,Zr.level=ut,Zr.strategy=vt,Zr.method=at,lt(Z)}function Ft(Z,ut){return et(Z,ut,I,D,X,C)}function se(Z,ut){var at,me,Ze,vt;if(!Z||!Z.state||ut>M||ut<0)return Z?ar(Z,l):l;if(me=Z.state,!Z.output||!Z.input&&Z.avail_in!==0||me.status===ft&&ut!==E)return ar(Z,Z.avail_out===0?v:l);if(me.strm=Z,at=me.last_flush,me.last_flush=ut,me.status===ce)if(me.wrap===2)Z.adler=0,zr(me,31),zr(me,139),zr(me,8),me.gzhead?(zr(me,(me.gzhead.text?1:0)+(me.gzhead.hcrc?2:0)+(me.gzhead.extra?4:0)+(me.gzhead.name?8:0)+(me.gzhead.comment?16:0)),zr(me,me.gzhead.time&255),zr(me,me.gzhead.time>>8&255),zr(me,me.gzhead.time>>16&255),zr(me,me.gzhead.time>>24&255),zr(me,me.level===9?2:me.strategy>=A||me.level<2?4:0),zr(me,me.gzhead.os&255),me.gzhead.extra&&me.gzhead.extra.length&&(zr(me,me.gzhead.extra.length&255),zr(me,me.gzhead.extra.length>>8&255)),me.gzhead.hcrc&&(Z.adler=_(Z.adler,me.pending_buf,me.pending,0)),me.gzindex=0,me.status=Ne):(zr(me,0),zr(me,0),zr(me,0),zr(me,0),zr(me,0),zr(me,me.level===9?2:me.strategy>=A||me.level<2?4:0),zr(me,ht),me.status=je);else{var Qr=I+(me.w_bits-8<<4)<<8,Zr=-1;me.strategy>=A||me.level<2?Zr=0:me.level<6?Zr=1:me.level===6?Zr=2:Zr=3,Qr|=Zr<<6,me.strstart!==0&&(Qr|=xe),Qr+=31-Qr%31,me.status=je,Nr(me,Qr),me.strstart!==0&&(Nr(me,Z.adler>>>16),Nr(me,Z.adler&65535)),Z.adler=1}if(me.status===Ne)if(me.gzhead.extra){for(Ze=me.pending;me.gzindex<(me.gzhead.extra.length&65535)&&!(me.pending===me.pending_buf_size&&(me.gzhead.hcrc&&me.pending>Ze&&(Z.adler=_(Z.adler,me.pending_buf,me.pending-Ze,Ze)),Gr(Z),Ze=me.pending,me.pending===me.pending_buf_size));)zr(me,me.gzhead.extra[me.gzindex]&255),me.gzindex++;me.gzhead.hcrc&&me.pending>Ze&&(Z.adler=_(Z.adler,me.pending_buf,me.pending-Ze,Ze)),me.gzindex===me.gzhead.extra.length&&(me.gzindex=0,me.status=Pe)}else me.status=Pe;if(me.status===Pe)if(me.gzhead.name){Ze=me.pending;do{if(me.pending===me.pending_buf_size&&(me.gzhead.hcrc&&me.pending>Ze&&(Z.adler=_(Z.adler,me.pending_buf,me.pending-Ze,Ze)),Gr(Z),Ze=me.pending,me.pending===me.pending_buf_size)){vt=1;break}me.gzindex<me.gzhead.name.length?vt=me.gzhead.name.charCodeAt(me.gzindex++)&255:vt=0,zr(me,vt)}while(vt!==0);me.gzhead.hcrc&&me.pending>Ze&&(Z.adler=_(Z.adler,me.pending_buf,me.pending-Ze,Ze)),vt===0&&(me.gzindex=0,me.status=Fe)}else me.status=Fe;if(me.status===Fe)if(me.gzhead.comment){Ze=me.pending;do{if(me.pending===me.pending_buf_size&&(me.gzhead.hcrc&&me.pending>Ze&&(Z.adler=_(Z.adler,me.pending_buf,me.pending-Ze,Ze)),Gr(Z),Ze=me.pending,me.pending===me.pending_buf_size)){vt=1;break}me.gzindex<me.gzhead.comment.length?vt=me.gzhead.comment.charCodeAt(me.gzindex++)&255:vt=0,zr(me,vt)}while(vt!==0);me.gzhead.hcrc&&me.pending>Ze&&(Z.adler=_(Z.adler,me.pending_buf,me.pending-Ze,Ze)),vt===0&&(me.status=Me)}else me.status=Me;if(me.status===Me&&(me.gzhead.hcrc?(me.pending+2>me.pending_buf_size&&Gr(Z),me.pending+2<=me.pending_buf_size&&(zr(me,Z.adler&255),zr(me,Z.adler>>8&255),Z.adler=0,me.status=je)):me.status=je),me.pending!==0){if(Gr(Z),Z.avail_out===0)return me.last_flush=-1,R}else if(Z.avail_in===0&&Jt(ut)<=Jt(at)&&ut!==E)return ar(Z,v);if(me.status===ft&&Z.avail_in!==0)return ar(Z,v);if(Z.avail_in!==0||me.lookahead!==0||ut!==g&&me.status!==ft){var Kr=me.strategy===A?it(me,ut):me.strategy===u?we(me,ut):Yt[me.level].func(me,ut);if((Kr===mt||Kr===Le)&&(me.status=ft),Kr===jt||Kr===mt)return Z.avail_out===0&&(me.last_flush=-1),R;if(Kr===Gt&&(ut===b?c._tr_align(me):ut!==M&&(c._tr_stored_block(me,0,0,!1),ut===p&&(Wt(me.head),me.lookahead===0&&(me.strstart=0,me.block_start=0,me.insert=0))),Gr(Z),Z.avail_out===0))return me.last_flush=-1,R}return ut!==E?R:me.wrap<=0?z:(me.wrap===2?(zr(me,Z.adler&255),zr(me,Z.adler>>8&255),zr(me,Z.adler>>16&255),zr(me,Z.adler>>24&255),zr(me,Z.total_in&255),zr(me,Z.total_in>>8&255),zr(me,Z.total_in>>16&255),zr(me,Z.total_in>>24&255)):(Nr(me,Z.adler>>>16),Nr(me,Z.adler&65535)),Gr(Z),me.wrap>0&&(me.wrap=-me.wrap),me.pending!==0?R:z)}function _t(Z){var ut;return!Z||!Z.state?l:(ut=Z.state.status,ut!==ce&&ut!==Ne&&ut!==Pe&&ut!==Fe&&ut!==Me&&ut!==je&&ut!==ft?ar(Z,l):(Z.state=null,ut===je?ar(Z,s):R))}function Wr(Z,ut){var at=ut.length,me,Ze,vt,Qr,Zr,Kr,bn,ls;if(!Z||!Z.state||(me=Z.state,Qr=me.wrap,Qr===2||Qr===1&&me.status!==ce||me.lookahead))return l;for(Qr===1&&(Z.adler=h(Z.adler,ut,at,0)),me.wrap=0,at>=me.w_size&&(Qr===0&&(Wt(me.head),me.strstart=0,me.block_start=0,me.insert=0),ls=new a.Buf8(me.w_size),a.arraySet(ls,ut,at-me.w_size,me.w_size,0),ut=ls,at=me.w_size),Zr=Z.avail_in,Kr=Z.next_in,bn=Z.input,Z.avail_in=at,Z.next_in=0,Z.input=ut,Jr(me);me.lookahead>=G;){Ze=me.strstart,vt=me.lookahead-(G-1);do me.ins_h=(me.ins_h<<me.hash_shift^me.window[Ze+G-1])&me.hash_mask,me.prev[Ze&me.w_mask]=me.head[me.ins_h],me.head[me.ins_h]=Ze,Ze++;while(--vt);me.strstart=Ze,me.lookahead=G-1,Jr(me)}return me.strstart+=me.lookahead,me.block_start=me.strstart,me.insert=me.lookahead,me.lookahead=0,me.match_length=me.prev_length=G-1,me.match_available=0,Z.next_in=Kr,Z.input=bn,Z.avail_in=Zr,me.wrap=Qr,R}r.deflateInit=Ft,r.deflateInit2=et,r.deflateReset=lt,r.deflateResetKeep=tt,r.deflateSetHeader=cr,r.deflate=se,r.deflateEnd=_t,r.deflateSetDictionary=Wr,r.deflateInfo="pako deflate (from Nodeca project)"}),"./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js":(e=>{function r(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=r}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js":(e=>{var r=30,t=12;e.exports=function(a,c){var h,_,f,g,b,p,E,M,R,z,l,s,v,w,S,A,u,y,C,k,I,O,D,X,j;h=a.state,_=a.next_in,X=a.input,f=_+(a.avail_in-5),g=a.next_out,j=a.output,b=g-(c-a.avail_out),p=g+(a.avail_out-257),E=h.dmax,M=h.wsize,R=h.whave,z=h.wnext,l=h.window,s=h.hold,v=h.bits,w=h.lencode,S=h.distcode,A=(1<<h.lenbits)-1,u=(1<<h.distbits)-1;e:do{v<15&&(s+=X[_++]<<v,v+=8,s+=X[_++]<<v,v+=8),y=w[s&A];t:for(;;){if(C=y>>>24,s>>>=C,v-=C,C=y>>>16&255,C===0)j[g++]=y&65535;else if(C&16){k=y&65535,C&=15,C&&(v<C&&(s+=X[_++]<<v,v+=8),k+=s&(1<<C)-1,s>>>=C,v-=C),v<15&&(s+=X[_++]<<v,v+=8,s+=X[_++]<<v,v+=8),y=S[s&u];r:for(;;){if(C=y>>>24,s>>>=C,v-=C,C=y>>>16&255,C&16){if(I=y&65535,C&=15,v<C&&(s+=X[_++]<<v,v+=8,v<C&&(s+=X[_++]<<v,v+=8)),I+=s&(1<<C)-1,I>E){a.msg="invalid distance too far back",h.mode=r;break e}if(s>>>=C,v-=C,C=g-b,I>C){if(C=I-C,C>R&&h.sane){a.msg="invalid distance too far back",h.mode=r;break e}if(O=0,D=l,z===0){if(O+=M-C,C<k){k-=C;do j[g++]=l[O++];while(--C);O=g-I,D=j}}else if(z<C){if(O+=M+z-C,C-=z,C<k){k-=C;do j[g++]=l[O++];while(--C);if(O=0,z<k){C=z,k-=C;do j[g++]=l[O++];while(--C);O=g-I,D=j}}}else if(O+=z-C,C<k){k-=C;do j[g++]=l[O++];while(--C);O=g-I,D=j}for(;k>2;)j[g++]=D[O++],j[g++]=D[O++],j[g++]=D[O++],k-=3;k&&(j[g++]=D[O++],k>1&&(j[g++]=D[O++]))}else{O=g-I;do j[g++]=j[O++],j[g++]=j[O++],j[g++]=j[O++],k-=3;while(k>2);k&&(j[g++]=j[O++],k>1&&(j[g++]=j[O++]))}}else if(C&64){a.msg="invalid distance code",h.mode=r;break e}else{y=S[(y&65535)+(s&(1<<C)-1)];continue r}break}}else if(C&64)if(C&32){h.mode=t;break e}else{a.msg="invalid literal/length code",h.mode=r;break e}else{y=w[(y&65535)+(s&(1<<C)-1)];continue t}break}}while(_<f&&g<p);k=v>>3,_-=k,v-=k<<3,s&=(1<<v)-1,a.next_in=_,a.next_out=g,a.avail_in=_<f?5+(f-_):5-(_-f),a.avail_out=g<p?257+(p-g):257-(g-p),h.hold=s,h.bits=v}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js":((e,r,t)=>{var a=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=t("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),h=t("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),_=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js"),f=t("./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js"),g=0,b=1,p=2,E=4,M=5,R=6,z=0,l=1,s=2,v=-2,w=-3,S=-4,A=-5,u=8,y=1,C=2,k=3,I=4,O=5,D=6,X=7,j=8,B=9,$=10,H=11,q=12,W=13,Y=14,G=15,V=16,Q=17,xe=18,ce=19,Ne=20,Pe=21,Fe=22,Me=23,je=24,ft=25,jt=26,Gt=27,mt=28,Le=29,ht=30,ar=31,Jt=32,Wt=852,Gr=592,Lr=15,zr=Lr;function Nr(et){return(et>>>24&255)+(et>>>8&65280)+((et&65280)<<8)+((et&255)<<24)}function At(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Mt(et){var Ft;return!et||!et.state?v:(Ft=et.state,et.total_in=et.total_out=Ft.total=0,et.msg="",Ft.wrap&&(et.adler=Ft.wrap&1),Ft.mode=y,Ft.last=0,Ft.havedict=0,Ft.dmax=32768,Ft.head=null,Ft.hold=0,Ft.bits=0,Ft.lencode=Ft.lendyn=new a.Buf32(Wt),Ft.distcode=Ft.distdyn=new a.Buf32(Gr),Ft.sane=1,Ft.back=-1,z)}function Jr(et){var Ft;return!et||!et.state?v:(Ft=et.state,Ft.wsize=0,Ft.whave=0,Ft.wnext=0,Mt(et))}function qr(et,Ft){var se,_t;return!et||!et.state||(_t=et.state,Ft<0?(se=0,Ft=-Ft):(se=(Ft>>4)+1,Ft<48&&(Ft&=15)),Ft&&(Ft<8||Ft>15))?v:(_t.window!==null&&_t.wbits!==Ft&&(_t.window=null),_t.wrap=se,_t.wbits=Ft,Jr(et))}function ie(et,Ft){var se,_t;return et?(_t=new At,et.state=_t,_t.window=null,se=qr(et,Ft),se!==z&&(et.state=null),se):v}function ve(et){return ie(et,zr)}var we=!0,it,rt;function Yt(et){if(we){var Ft;for(it=new a.Buf32(512),rt=new a.Buf32(32),Ft=0;Ft<144;)et.lens[Ft++]=8;for(;Ft<256;)et.lens[Ft++]=9;for(;Ft<280;)et.lens[Ft++]=7;for(;Ft<288;)et.lens[Ft++]=8;for(f(b,et.lens,0,288,it,0,et.work,{bits:9}),Ft=0;Ft<32;)et.lens[Ft++]=5;f(p,et.lens,0,32,rt,0,et.work,{bits:5}),we=!1}et.lencode=it,et.lenbits=9,et.distcode=rt,et.distbits=5}function Ot(et,Ft,se,_t){var Wr,Z=et.state;return Z.window===null&&(Z.wsize=1<<Z.wbits,Z.wnext=0,Z.whave=0,Z.window=new a.Buf8(Z.wsize)),_t>=Z.wsize?(a.arraySet(Z.window,Ft,se-Z.wsize,Z.wsize,0),Z.wnext=0,Z.whave=Z.wsize):(Wr=Z.wsize-Z.wnext,Wr>_t&&(Wr=_t),a.arraySet(Z.window,Ft,se-_t,Wr,Z.wnext),_t-=Wr,_t?(a.arraySet(Z.window,Ft,se-_t,_t,0),Z.wnext=_t,Z.whave=Z.wsize):(Z.wnext+=Wr,Z.wnext===Z.wsize&&(Z.wnext=0),Z.whave<Z.wsize&&(Z.whave+=Wr))),0}function re(et,Ft){var se,_t,Wr,Z,ut,at,me,Ze,vt,Qr,Zr,Kr,bn,ls,Pn=0,On,Dn,gi,Ei,Aa,Ta,ti,li,ui=new a.Buf8(4),Js,Vs,pa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!et||!et.state||!et.output||!et.input&&et.avail_in!==0)return v;se=et.state,se.mode===q&&(se.mode=W),ut=et.next_out,Wr=et.output,me=et.avail_out,Z=et.next_in,_t=et.input,at=et.avail_in,Ze=se.hold,vt=se.bits,Qr=at,Zr=me,li=z;e:for(;;)switch(se.mode){case y:if(se.wrap===0){se.mode=W;break}for(;vt<16;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}if(se.wrap&2&&Ze===35615){se.check=0,ui[0]=Ze&255,ui[1]=Ze>>>8&255,se.check=h(se.check,ui,2,0),Ze=0,vt=0,se.mode=C;break}if(se.flags=0,se.head&&(se.head.done=!1),!(se.wrap&1)||(((Ze&255)<<8)+(Ze>>8))%31){et.msg="incorrect header check",se.mode=ht;break}if((Ze&15)!==u){et.msg="unknown compression method",se.mode=ht;break}if(Ze>>>=4,vt-=4,ti=(Ze&15)+8,se.wbits===0)se.wbits=ti;else if(ti>se.wbits){et.msg="invalid window size",se.mode=ht;break}se.dmax=1<<ti,et.adler=se.check=1,se.mode=Ze&512?$:q,Ze=0,vt=0;break;case C:for(;vt<16;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}if(se.flags=Ze,(se.flags&255)!==u){et.msg="unknown compression method",se.mode=ht;break}if(se.flags&57344){et.msg="unknown header flags set",se.mode=ht;break}se.head&&(se.head.text=Ze>>8&1),se.flags&512&&(ui[0]=Ze&255,ui[1]=Ze>>>8&255,se.check=h(se.check,ui,2,0)),Ze=0,vt=0,se.mode=k;case k:for(;vt<32;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}se.head&&(se.head.time=Ze),se.flags&512&&(ui[0]=Ze&255,ui[1]=Ze>>>8&255,ui[2]=Ze>>>16&255,ui[3]=Ze>>>24&255,se.check=h(se.check,ui,4,0)),Ze=0,vt=0,se.mode=I;case I:for(;vt<16;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}se.head&&(se.head.xflags=Ze&255,se.head.os=Ze>>8),se.flags&512&&(ui[0]=Ze&255,ui[1]=Ze>>>8&255,se.check=h(se.check,ui,2,0)),Ze=0,vt=0,se.mode=O;case O:if(se.flags&1024){for(;vt<16;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}se.length=Ze,se.head&&(se.head.extra_len=Ze),se.flags&512&&(ui[0]=Ze&255,ui[1]=Ze>>>8&255,se.check=h(se.check,ui,2,0)),Ze=0,vt=0}else se.head&&(se.head.extra=null);se.mode=D;case D:if(se.flags&1024&&(Kr=se.length,Kr>at&&(Kr=at),Kr&&(se.head&&(ti=se.head.extra_len-se.length,se.head.extra||(se.head.extra=new Array(se.head.extra_len)),a.arraySet(se.head.extra,_t,Z,Kr,ti)),se.flags&512&&(se.check=h(se.check,_t,Kr,Z)),at-=Kr,Z+=Kr,se.length-=Kr),se.length))break e;se.length=0,se.mode=X;case X:if(se.flags&2048){if(at===0)break e;Kr=0;do ti=_t[Z+Kr++],se.head&&ti&&se.length<65536&&(se.head.name+=String.fromCharCode(ti));while(ti&&Kr<at);if(se.flags&512&&(se.check=h(se.check,_t,Kr,Z)),at-=Kr,Z+=Kr,ti)break e}else se.head&&(se.head.name=null);se.length=0,se.mode=j;case j:if(se.flags&4096){if(at===0)break e;Kr=0;do ti=_t[Z+Kr++],se.head&&ti&&se.length<65536&&(se.head.comment+=String.fromCharCode(ti));while(ti&&Kr<at);if(se.flags&512&&(se.check=h(se.check,_t,Kr,Z)),at-=Kr,Z+=Kr,ti)break e}else se.head&&(se.head.comment=null);se.mode=B;case B:if(se.flags&512){for(;vt<16;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}if(Ze!==(se.check&65535)){et.msg="header crc mismatch",se.mode=ht;break}Ze=0,vt=0}se.head&&(se.head.hcrc=se.flags>>9&1,se.head.done=!0),et.adler=se.check=0,se.mode=q;break;case $:for(;vt<32;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}et.adler=se.check=Nr(Ze),Ze=0,vt=0,se.mode=H;case H:if(se.havedict===0)return et.next_out=ut,et.avail_out=me,et.next_in=Z,et.avail_in=at,se.hold=Ze,se.bits=vt,s;et.adler=se.check=1,se.mode=q;case q:if(Ft===M||Ft===R)break e;case W:if(se.last){Ze>>>=vt&7,vt-=vt&7,se.mode=Gt;break}for(;vt<3;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}switch(se.last=Ze&1,Ze>>>=1,vt-=1,Ze&3){case 0:se.mode=Y;break;case 1:if(Yt(se),se.mode=Ne,Ft===R){Ze>>>=2,vt-=2;break e}break;case 2:se.mode=Q;break;case 3:et.msg="invalid block type",se.mode=ht}Ze>>>=2,vt-=2;break;case Y:for(Ze>>>=vt&7,vt-=vt&7;vt<32;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}if((Ze&65535)!==(Ze>>>16^65535)){et.msg="invalid stored block lengths",se.mode=ht;break}if(se.length=Ze&65535,Ze=0,vt=0,se.mode=G,Ft===R)break e;case G:se.mode=V;case V:if(Kr=se.length,Kr){if(Kr>at&&(Kr=at),Kr>me&&(Kr=me),Kr===0)break e;a.arraySet(Wr,_t,Z,Kr,ut),at-=Kr,Z+=Kr,me-=Kr,ut+=Kr,se.length-=Kr;break}se.mode=q;break;case Q:for(;vt<14;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}if(se.nlen=(Ze&31)+257,Ze>>>=5,vt-=5,se.ndist=(Ze&31)+1,Ze>>>=5,vt-=5,se.ncode=(Ze&15)+4,Ze>>>=4,vt-=4,se.nlen>286||se.ndist>30){et.msg="too many length or distance symbols",se.mode=ht;break}se.have=0,se.mode=xe;case xe:for(;se.have<se.ncode;){for(;vt<3;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}se.lens[pa[se.have++]]=Ze&7,Ze>>>=3,vt-=3}for(;se.have<19;)se.lens[pa[se.have++]]=0;if(se.lencode=se.lendyn,se.lenbits=7,Js={bits:se.lenbits},li=f(g,se.lens,0,19,se.lencode,0,se.work,Js),se.lenbits=Js.bits,li){et.msg="invalid code lengths set",se.mode=ht;break}se.have=0,se.mode=ce;case ce:for(;se.have<se.nlen+se.ndist;){for(;Pn=se.lencode[Ze&(1<<se.lenbits)-1],On=Pn>>>24,Dn=Pn>>>16&255,gi=Pn&65535,!(On<=vt);){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}if(gi<16)Ze>>>=On,vt-=On,se.lens[se.have++]=gi;else{if(gi===16){for(Vs=On+2;vt<Vs;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}if(Ze>>>=On,vt-=On,se.have===0){et.msg="invalid bit length repeat",se.mode=ht;break}ti=se.lens[se.have-1],Kr=3+(Ze&3),Ze>>>=2,vt-=2}else if(gi===17){for(Vs=On+3;vt<Vs;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}Ze>>>=On,vt-=On,ti=0,Kr=3+(Ze&7),Ze>>>=3,vt-=3}else{for(Vs=On+7;vt<Vs;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}Ze>>>=On,vt-=On,ti=0,Kr=11+(Ze&127),Ze>>>=7,vt-=7}if(se.have+Kr>se.nlen+se.ndist){et.msg="invalid bit length repeat",se.mode=ht;break}for(;Kr--;)se.lens[se.have++]=ti}}if(se.mode===ht)break;if(se.lens[256]===0){et.msg="invalid code -- missing end-of-block",se.mode=ht;break}if(se.lenbits=9,Js={bits:se.lenbits},li=f(b,se.lens,0,se.nlen,se.lencode,0,se.work,Js),se.lenbits=Js.bits,li){et.msg="invalid literal/lengths set",se.mode=ht;break}if(se.distbits=6,se.distcode=se.distdyn,Js={bits:se.distbits},li=f(p,se.lens,se.nlen,se.ndist,se.distcode,0,se.work,Js),se.distbits=Js.bits,li){et.msg="invalid distances set",se.mode=ht;break}if(se.mode=Ne,Ft===R)break e;case Ne:se.mode=Pe;case Pe:if(at>=6&&me>=258){et.next_out=ut,et.avail_out=me,et.next_in=Z,et.avail_in=at,se.hold=Ze,se.bits=vt,_(et,Zr),ut=et.next_out,Wr=et.output,me=et.avail_out,Z=et.next_in,_t=et.input,at=et.avail_in,Ze=se.hold,vt=se.bits,se.mode===q&&(se.back=-1);break}for(se.back=0;Pn=se.lencode[Ze&(1<<se.lenbits)-1],On=Pn>>>24,Dn=Pn>>>16&255,gi=Pn&65535,!(On<=vt);){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}if(Dn&&!(Dn&240)){for(Ei=On,Aa=Dn,Ta=gi;Pn=se.lencode[Ta+((Ze&(1<<Ei+Aa)-1)>>Ei)],On=Pn>>>24,Dn=Pn>>>16&255,gi=Pn&65535,!(Ei+On<=vt);){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}Ze>>>=Ei,vt-=Ei,se.back+=Ei}if(Ze>>>=On,vt-=On,se.back+=On,se.length=gi,Dn===0){se.mode=jt;break}if(Dn&32){se.back=-1,se.mode=q;break}if(Dn&64){et.msg="invalid literal/length code",se.mode=ht;break}se.extra=Dn&15,se.mode=Fe;case Fe:if(se.extra){for(Vs=se.extra;vt<Vs;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}se.length+=Ze&(1<<se.extra)-1,Ze>>>=se.extra,vt-=se.extra,se.back+=se.extra}se.was=se.length,se.mode=Me;case Me:for(;Pn=se.distcode[Ze&(1<<se.distbits)-1],On=Pn>>>24,Dn=Pn>>>16&255,gi=Pn&65535,!(On<=vt);){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}if(!(Dn&240)){for(Ei=On,Aa=Dn,Ta=gi;Pn=se.distcode[Ta+((Ze&(1<<Ei+Aa)-1)>>Ei)],On=Pn>>>24,Dn=Pn>>>16&255,gi=Pn&65535,!(Ei+On<=vt);){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}Ze>>>=Ei,vt-=Ei,se.back+=Ei}if(Ze>>>=On,vt-=On,se.back+=On,Dn&64){et.msg="invalid distance code",se.mode=ht;break}se.offset=gi,se.extra=Dn&15,se.mode=je;case je:if(se.extra){for(Vs=se.extra;vt<Vs;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}se.offset+=Ze&(1<<se.extra)-1,Ze>>>=se.extra,vt-=se.extra,se.back+=se.extra}if(se.offset>se.dmax){et.msg="invalid distance too far back",se.mode=ht;break}se.mode=ft;case ft:if(me===0)break e;if(Kr=Zr-me,se.offset>Kr){if(Kr=se.offset-Kr,Kr>se.whave&&se.sane){et.msg="invalid distance too far back",se.mode=ht;break}Kr>se.wnext?(Kr-=se.wnext,bn=se.wsize-Kr):bn=se.wnext-Kr,Kr>se.length&&(Kr=se.length),ls=se.window}else ls=Wr,bn=ut-se.offset,Kr=se.length;Kr>me&&(Kr=me),me-=Kr,se.length-=Kr;do Wr[ut++]=ls[bn++];while(--Kr);se.length===0&&(se.mode=Pe);break;case jt:if(me===0)break e;Wr[ut++]=se.length,me--,se.mode=Pe;break;case Gt:if(se.wrap){for(;vt<32;){if(at===0)break e;at--,Ze|=_t[Z++]<<vt,vt+=8}if(Zr-=me,et.total_out+=Zr,se.total+=Zr,Zr&&(et.adler=se.check=se.flags?h(se.check,Wr,Zr,ut-Zr):c(se.check,Wr,Zr,ut-Zr)),Zr=me,(se.flags?Ze:Nr(Ze))!==se.check){et.msg="incorrect data check",se.mode=ht;break}Ze=0,vt=0}se.mode=mt;case mt:if(se.wrap&&se.flags){for(;vt<32;){if(at===0)break e;at--,Ze+=_t[Z++]<<vt,vt+=8}if(Ze!==(se.total&4294967295)){et.msg="incorrect length check",se.mode=ht;break}Ze=0,vt=0}se.mode=Le;case Le:li=l;break e;case ht:li=w;break e;case ar:return S;case Jt:default:return v}return et.next_out=ut,et.avail_out=me,et.next_in=Z,et.avail_in=at,se.hold=Ze,se.bits=vt,(se.wsize||Zr!==et.avail_out&&se.mode<ht&&(se.mode<Gt||Ft!==E))&&Ot(et,et.output,et.next_out,Zr-et.avail_out),Qr-=et.avail_in,Zr-=et.avail_out,et.total_in+=Qr,et.total_out+=Zr,se.total+=Zr,se.wrap&&Zr&&(et.adler=se.check=se.flags?h(se.check,Wr,Zr,et.next_out-Zr):c(se.check,Wr,Zr,et.next_out-Zr)),et.data_type=se.bits+(se.last?64:0)+(se.mode===q?128:0)+(se.mode===Ne||se.mode===G?256:0),(Qr===0&&Zr===0||Ft===E)&&li===z&&(li=A),li}function tt(et){if(!et||!et.state)return v;var Ft=et.state;return Ft.window&&(Ft.window=null),et.state=null,z}function lt(et,Ft){var se;return!et||!et.state||(se=et.state,!(se.wrap&2))?v:(se.head=Ft,Ft.done=!1,z)}function cr(et,Ft){var se=Ft.length,_t,Wr,Z;return!et||!et.state||(_t=et.state,_t.wrap!==0&&_t.mode!==H)?v:_t.mode===H&&(Wr=1,Wr=c(Wr,Ft,se,0),Wr!==_t.check)?w:(Z=Ot(et,Ft,se,se),Z?(_t.mode=ar,S):(_t.havedict=1,z))}r.inflateReset=Jr,r.inflateReset2=qr,r.inflateResetKeep=Mt,r.inflateInit=ve,r.inflateInit2=ie,r.inflate=re,r.inflateEnd=tt,r.inflateGetHeader=lt,r.inflateSetDictionary=cr,r.inflateInfo="pako inflate (from Nodeca project)"}),"./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js":((e,r,t)=>{var a=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=15,h=852,_=592,f=0,g=1,b=2,p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],E=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],M=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],R=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(z,l,s,v,w,S,A,u){var y=u.bits,C=0,k=0,I=0,O=0,D=0,X=0,j=0,B=0,$=0,H=0,q,W,Y,G,V,Q=null,xe=0,ce,Ne=new a.Buf16(c+1),Pe=new a.Buf16(c+1),Fe=null,Me=0,je,ft,jt;for(C=0;C<=c;C++)Ne[C]=0;for(k=0;k<v;k++)Ne[l[s+k]]++;for(D=y,O=c;O>=1&&Ne[O]===0;O--);if(D>O&&(D=O),O===0)return w[S++]=20971520,w[S++]=20971520,u.bits=1,0;for(I=1;I<O&&Ne[I]===0;I++);for(D<I&&(D=I),B=1,C=1;C<=c;C++)if(B<<=1,B-=Ne[C],B<0)return-1;if(B>0&&(z===f||O!==1))return-1;for(Pe[1]=0,C=1;C<c;C++)Pe[C+1]=Pe[C]+Ne[C];for(k=0;k<v;k++)l[s+k]!==0&&(A[Pe[l[s+k]]++]=k);if(z===f?(Q=Fe=A,ce=19):z===g?(Q=p,xe-=257,Fe=E,Me-=257,ce=256):(Q=M,Fe=R,ce=-1),H=0,k=0,C=I,V=S,X=D,j=0,Y=-1,$=1<<D,G=$-1,z===g&&$>h||z===b&&$>_)return 1;for(;;){je=C-j,A[k]<ce?(ft=0,jt=A[k]):A[k]>ce?(ft=Fe[Me+A[k]],jt=Q[xe+A[k]]):(ft=96,jt=0),q=1<<C-j,W=1<<X,I=W;do W-=q,w[V+(H>>j)+W]=je<<24|ft<<16|jt|0;while(W!==0);for(q=1<<C-1;H&q;)q>>=1;if(q!==0?(H&=q-1,H+=q):H=0,k++,--Ne[C]===0){if(C===O)break;C=l[s+A[k]]}if(C>D&&(H&G)!==Y){for(j===0&&(j=D),V+=I,X=C-j,B=1<<X;X+j<O&&(B-=Ne[X+j],!(B<=0));)X++,B<<=1;if($+=1<<X,z===g&&$>h||z===b&&$>_)return 1;Y=H&G,w[Y]=D<<24|X<<16|V-S|0}}return H!==0&&(w[V+H]=C-j<<24|4194304|0),u.bits=D,0}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js":(e=>{e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}}),"./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js":((e,r,t)=>{var a=t("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),c=4,h=0,_=1,f=2;function g(re){for(var tt=re.length;--tt>=0;)re[tt]=0}var b=0,p=1,E=2,M=3,R=258,z=29,l=256,s=l+1+z,v=30,w=19,S=2*s+1,A=15,u=16,y=7,C=256,k=16,I=17,O=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],X=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],$=512,H=new Array((s+2)*2);g(H);var q=new Array(v*2);g(q);var W=new Array($);g(W);var Y=new Array(R-M+1);g(Y);var G=new Array(z);g(G);var V=new Array(v);g(V);function Q(re,tt,lt,cr,et){this.static_tree=re,this.extra_bits=tt,this.extra_base=lt,this.elems=cr,this.max_length=et,this.has_stree=re&&re.length}var xe,ce,Ne;function Pe(re,tt){this.dyn_tree=re,this.max_code=0,this.stat_desc=tt}function Fe(re){return re<256?W[re]:W[256+(re>>>7)]}function Me(re,tt){re.pending_buf[re.pending++]=tt&255,re.pending_buf[re.pending++]=tt>>>8&255}function je(re,tt,lt){re.bi_valid>u-lt?(re.bi_buf|=tt<<re.bi_valid&65535,Me(re,re.bi_buf),re.bi_buf=tt>>u-re.bi_valid,re.bi_valid+=lt-u):(re.bi_buf|=tt<<re.bi_valid&65535,re.bi_valid+=lt)}function ft(re,tt,lt){je(re,lt[tt*2],lt[tt*2+1])}function jt(re,tt){var lt=0;do lt|=re&1,re>>>=1,lt<<=1;while(--tt>0);return lt>>>1}function Gt(re){re.bi_valid===16?(Me(re,re.bi_buf),re.bi_buf=0,re.bi_valid=0):re.bi_valid>=8&&(re.pending_buf[re.pending++]=re.bi_buf&255,re.bi_buf>>=8,re.bi_valid-=8)}function mt(re,tt){var lt=tt.dyn_tree,cr=tt.max_code,et=tt.stat_desc.static_tree,Ft=tt.stat_desc.has_stree,se=tt.stat_desc.extra_bits,_t=tt.stat_desc.extra_base,Wr=tt.stat_desc.max_length,Z,ut,at,me,Ze,vt,Qr=0;for(me=0;me<=A;me++)re.bl_count[me]=0;for(lt[re.heap[re.heap_max]*2+1]=0,Z=re.heap_max+1;Z<S;Z++)ut=re.heap[Z],me=lt[lt[ut*2+1]*2+1]+1,me>Wr&&(me=Wr,Qr++),lt[ut*2+1]=me,!(ut>cr)&&(re.bl_count[me]++,Ze=0,ut>=_t&&(Ze=se[ut-_t]),vt=lt[ut*2],re.opt_len+=vt*(me+Ze),Ft&&(re.static_len+=vt*(et[ut*2+1]+Ze)));if(Qr!==0){do{for(me=Wr-1;re.bl_count[me]===0;)me--;re.bl_count[me]--,re.bl_count[me+1]+=2,re.bl_count[Wr]--,Qr-=2}while(Qr>0);for(me=Wr;me!==0;me--)for(ut=re.bl_count[me];ut!==0;)at=re.heap[--Z],!(at>cr)&&(lt[at*2+1]!==me&&(re.opt_len+=(me-lt[at*2+1])*lt[at*2],lt[at*2+1]=me),ut--)}}function Le(re,tt,lt){var cr=new Array(A+1),et=0,Ft,se;for(Ft=1;Ft<=A;Ft++)cr[Ft]=et=et+lt[Ft-1]<<1;for(se=0;se<=tt;se++){var _t=re[se*2+1];_t!==0&&(re[se*2]=jt(cr[_t]++,_t))}}function ht(){var re,tt,lt,cr,et,Ft=new Array(A+1);for(lt=0,cr=0;cr<z-1;cr++)for(G[cr]=lt,re=0;re<1<<D[cr];re++)Y[lt++]=cr;for(Y[lt-1]=cr,et=0,cr=0;cr<16;cr++)for(V[cr]=et,re=0;re<1<<X[cr];re++)W[et++]=cr;for(et>>=7;cr<v;cr++)for(V[cr]=et<<7,re=0;re<1<<X[cr]-7;re++)W[256+et++]=cr;for(tt=0;tt<=A;tt++)Ft[tt]=0;for(re=0;re<=143;)H[re*2+1]=8,re++,Ft[8]++;for(;re<=255;)H[re*2+1]=9,re++,Ft[9]++;for(;re<=279;)H[re*2+1]=7,re++,Ft[7]++;for(;re<=287;)H[re*2+1]=8,re++,Ft[8]++;for(Le(H,s+1,Ft),re=0;re<v;re++)q[re*2+1]=5,q[re*2]=jt(re,5);xe=new Q(H,D,l+1,s,A),ce=new Q(q,X,0,v,A),Ne=new Q(new Array(0),j,0,w,y)}function ar(re){var tt;for(tt=0;tt<s;tt++)re.dyn_ltree[tt*2]=0;for(tt=0;tt<v;tt++)re.dyn_dtree[tt*2]=0;for(tt=0;tt<w;tt++)re.bl_tree[tt*2]=0;re.dyn_ltree[C*2]=1,re.opt_len=re.static_len=0,re.last_lit=re.matches=0}function Jt(re){re.bi_valid>8?Me(re,re.bi_buf):re.bi_valid>0&&(re.pending_buf[re.pending++]=re.bi_buf),re.bi_buf=0,re.bi_valid=0}function Wt(re,tt,lt,cr){Jt(re),Me(re,lt),Me(re,~lt),a.arraySet(re.pending_buf,re.window,tt,lt,re.pending),re.pending+=lt}function Gr(re,tt,lt,cr){var et=tt*2,Ft=lt*2;return re[et]<re[Ft]||re[et]===re[Ft]&&cr[tt]<=cr[lt]}function Lr(re,tt,lt){for(var cr=re.heap[lt],et=lt<<1;et<=re.heap_len&&(et<re.heap_len&&Gr(tt,re.heap[et+1],re.heap[et],re.depth)&&et++,!Gr(tt,cr,re.heap[et],re.depth));)re.heap[lt]=re.heap[et],lt=et,et<<=1;re.heap[lt]=cr}function zr(re,tt,lt){var cr,et,Ft=0,se,_t;if(re.last_lit!==0)do cr=re.pending_buf[re.d_buf+Ft*2]<<8|re.pending_buf[re.d_buf+Ft*2+1],et=re.pending_buf[re.l_buf+Ft],Ft++,cr===0?ft(re,et,tt):(se=Y[et],ft(re,se+l+1,tt),_t=D[se],_t!==0&&(et-=G[se],je(re,et,_t)),cr--,se=Fe(cr),ft(re,se,lt),_t=X[se],_t!==0&&(cr-=V[se],je(re,cr,_t)));while(Ft<re.last_lit);ft(re,C,tt)}function Nr(re,tt){var lt=tt.dyn_tree,cr=tt.stat_desc.static_tree,et=tt.stat_desc.has_stree,Ft=tt.stat_desc.elems,se,_t,Wr=-1,Z;for(re.heap_len=0,re.heap_max=S,se=0;se<Ft;se++)lt[se*2]!==0?(re.heap[++re.heap_len]=Wr=se,re.depth[se]=0):lt[se*2+1]=0;for(;re.heap_len<2;)Z=re.heap[++re.heap_len]=Wr<2?++Wr:0,lt[Z*2]=1,re.depth[Z]=0,re.opt_len--,et&&(re.static_len-=cr[Z*2+1]);for(tt.max_code=Wr,se=re.heap_len>>1;se>=1;se--)Lr(re,lt,se);Z=Ft;do se=re.heap[1],re.heap[1]=re.heap[re.heap_len--],Lr(re,lt,1),_t=re.heap[1],re.heap[--re.heap_max]=se,re.heap[--re.heap_max]=_t,lt[Z*2]=lt[se*2]+lt[_t*2],re.depth[Z]=(re.depth[se]>=re.depth[_t]?re.depth[se]:re.depth[_t])+1,lt[se*2+1]=lt[_t*2+1]=Z,re.heap[1]=Z++,Lr(re,lt,1);while(re.heap_len>=2);re.heap[--re.heap_max]=re.heap[1],mt(re,tt),Le(lt,Wr,re.bl_count)}function At(re,tt,lt){var cr,et=-1,Ft,se=tt[1],_t=0,Wr=7,Z=4;for(se===0&&(Wr=138,Z=3),tt[(lt+1)*2+1]=65535,cr=0;cr<=lt;cr++)Ft=se,se=tt[(cr+1)*2+1],!(++_t<Wr&&Ft===se)&&(_t<Z?re.bl_tree[Ft*2]+=_t:Ft!==0?(Ft!==et&&re.bl_tree[Ft*2]++,re.bl_tree[k*2]++):_t<=10?re.bl_tree[I*2]++:re.bl_tree[O*2]++,_t=0,et=Ft,se===0?(Wr=138,Z=3):Ft===se?(Wr=6,Z=3):(Wr=7,Z=4))}function Mt(re,tt,lt){var cr,et=-1,Ft,se=tt[1],_t=0,Wr=7,Z=4;for(se===0&&(Wr=138,Z=3),cr=0;cr<=lt;cr++)if(Ft=se,se=tt[(cr+1)*2+1],!(++_t<Wr&&Ft===se)){if(_t<Z)do ft(re,Ft,re.bl_tree);while(--_t!==0);else Ft!==0?(Ft!==et&&(ft(re,Ft,re.bl_tree),_t--),ft(re,k,re.bl_tree),je(re,_t-3,2)):_t<=10?(ft(re,I,re.bl_tree),je(re,_t-3,3)):(ft(re,O,re.bl_tree),je(re,_t-11,7));_t=0,et=Ft,se===0?(Wr=138,Z=3):Ft===se?(Wr=6,Z=3):(Wr=7,Z=4)}}function Jr(re){var tt;for(At(re,re.dyn_ltree,re.l_desc.max_code),At(re,re.dyn_dtree,re.d_desc.max_code),Nr(re,re.bl_desc),tt=w-1;tt>=3&&re.bl_tree[B[tt]*2+1]===0;tt--);return re.opt_len+=3*(tt+1)+5+5+4,tt}function qr(re,tt,lt,cr){var et;for(je(re,tt-257,5),je(re,lt-1,5),je(re,cr-4,4),et=0;et<cr;et++)je(re,re.bl_tree[B[et]*2+1],3);Mt(re,re.dyn_ltree,tt-1),Mt(re,re.dyn_dtree,lt-1)}function ie(re){var tt=4093624447,lt;for(lt=0;lt<=31;lt++,tt>>>=1)if(tt&1&&re.dyn_ltree[lt*2]!==0)return h;if(re.dyn_ltree[18]!==0||re.dyn_ltree[20]!==0||re.dyn_ltree[26]!==0)return _;for(lt=32;lt<l;lt++)if(re.dyn_ltree[lt*2]!==0)return _;return h}var ve=!1;function we(re){ve||(ht(),ve=!0),re.l_desc=new Pe(re.dyn_ltree,xe),re.d_desc=new Pe(re.dyn_dtree,ce),re.bl_desc=new Pe(re.bl_tree,Ne),re.bi_buf=0,re.bi_valid=0,ar(re)}function it(re,tt,lt,cr){je(re,(b<<1)+(cr?1:0),3),Wt(re,tt,lt)}function rt(re){je(re,p<<1,3),ft(re,C,H),Gt(re)}function Yt(re,tt,lt,cr){var et,Ft,se=0;re.level>0?(re.strm.data_type===f&&(re.strm.data_type=ie(re)),Nr(re,re.l_desc),Nr(re,re.d_desc),se=Jr(re),et=re.opt_len+3+7>>>3,Ft=re.static_len+3+7>>>3,Ft<=et&&(et=Ft)):et=Ft=lt+5,lt+4<=et&&tt!==-1?it(re,tt,lt,cr):re.strategy===c||Ft===et?(je(re,(p<<1)+(cr?1:0),3),zr(re,H,q)):(je(re,(E<<1)+(cr?1:0),3),qr(re,re.l_desc.max_code+1,re.d_desc.max_code+1,se+1),zr(re,re.dyn_ltree,re.dyn_dtree)),ar(re),cr&&Jt(re)}function Ot(re,tt,lt){return re.pending_buf[re.d_buf+re.last_lit*2]=tt>>>8&255,re.pending_buf[re.d_buf+re.last_lit*2+1]=tt&255,re.pending_buf[re.l_buf+re.last_lit]=lt&255,re.last_lit++,tt===0?re.dyn_ltree[lt*2]++:(re.matches++,tt--,re.dyn_ltree[(Y[lt]+l+1)*2]++,re.dyn_dtree[Fe(tt)*2]++),re.last_lit===re.lit_bufsize-1}r._tr_init=we,r._tr_stored_block=it,r._tr_flush_block=Yt,r._tr_tally=Ot,r._tr_align=rt}),"./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js":(e=>{function r(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=r}),"./src/SurfaceWorker.js":(()=>{$3Dmol.workerString=(function(){self.onmessage=function(e){var r=e.data,t=r.type;if(t<0)self.atomData=r.atoms,self.volume=r.volume,self.ps=new ProteinSurface;else{var a=self.ps;a.initparm(r.expandedExtent,t!=1,self.volume),a.fillvoxels(self.atomData,r.extendedAtoms),a.buildboundary(),(t===4||t===2)&&(a.fastdistancemap(),a.boundingatom(!1),a.fillvoxelswaals(self.atomData,r.extendedAtoms)),a.marchingcube(t);var c=a.getFacesAndVertices(r.atomsToShow);self.postMessage(c)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0}),"./src/exporter.js":(e=>{typeof e.exports=="object"&&(e.exports=window.$3Dmol)}),"./src/vendor/mmtf.js":(function(e,r){(function(t,a){a(r)})(this,function(t){function a(ie,ve,we){for(var it=(ie.byteLength,0),rt=we.length;rt>it;it++){var Yt=we.charCodeAt(it);if(128>Yt)ie.setUint8(ve++,Yt>>>0&127|0);else if(2048>Yt)ie.setUint8(ve++,Yt>>>6&31|192),ie.setUint8(ve++,Yt>>>0&63|128);else if(65536>Yt)ie.setUint8(ve++,Yt>>>12&15|224),ie.setUint8(ve++,Yt>>>6&63|128),ie.setUint8(ve++,Yt>>>0&63|128);else{if(!(1114112>Yt))throw new Error("bad codepoint "+Yt);ie.setUint8(ve++,Yt>>>18&7|240),ie.setUint8(ve++,Yt>>>12&63|128),ie.setUint8(ve++,Yt>>>6&63|128),ie.setUint8(ve++,Yt>>>0&63|128)}}}function c(ie){for(var ve=0,we=0,it=ie.length;it>we;we++){var rt=ie.charCodeAt(we);if(128>rt)ve+=1;else if(2048>rt)ve+=2;else if(65536>rt)ve+=3;else{if(!(1114112>rt))throw new Error("bad codepoint "+rt);ve+=4}}return ve}function h(ie,ve,we){var it=typeof ie;if(it==="string"){var rt=c(ie);if(32>rt)return ve.setUint8(we,160|rt),a(ve,we+1,ie),1+rt;if(256>rt)return ve.setUint8(we,217),ve.setUint8(we+1,rt),a(ve,we+2,ie),2+rt;if(65536>rt)return ve.setUint8(we,218),ve.setUint16(we+1,rt),a(ve,we+3,ie),3+rt;if(4294967296>rt)return ve.setUint8(we,219),ve.setUint32(we+1,rt),a(ve,we+5,ie),5+rt}if(ie instanceof Uint8Array){var rt=ie.byteLength,Yt=new Uint8Array(ve.buffer);if(256>rt)return ve.setUint8(we,196),ve.setUint8(we+1,rt),Yt.set(ie,we+2),2+rt;if(65536>rt)return ve.setUint8(we,197),ve.setUint16(we+1,rt),Yt.set(ie,we+3),3+rt;if(4294967296>rt)return ve.setUint8(we,198),ve.setUint32(we+1,rt),Yt.set(ie,we+5),5+rt}if(it==="number"){if(!isFinite(ie))throw new Error("Number not finite: "+ie);if(Math.floor(ie)!==ie)return ve.setUint8(we,203),ve.setFloat64(we+1,ie),9;if(ie>=0){if(128>ie)return ve.setUint8(we,ie),1;if(256>ie)return ve.setUint8(we,204),ve.setUint8(we+1,ie),2;if(65536>ie)return ve.setUint8(we,205),ve.setUint16(we+1,ie),3;if(4294967296>ie)return ve.setUint8(we,206),ve.setUint32(we+1,ie),5;throw new Error("Number too big 0x"+ie.toString(16))}if(ie>=-32)return ve.setInt8(we,ie),1;if(ie>=-128)return ve.setUint8(we,208),ve.setInt8(we+1,ie),2;if(ie>=-32768)return ve.setUint8(we,209),ve.setInt16(we+1,ie),3;if(ie>=-2147483648)return ve.setUint8(we,210),ve.setInt32(we+1,ie),5;throw new Error("Number too small -0x"+(-ie).toString(16).substr(1))}if(ie===null)return ve.setUint8(we,192),1;if(it==="boolean")return ve.setUint8(we,ie?195:194),1;if(it==="object"){var rt,tt=0,Ot=Array.isArray(ie);if(Ot)rt=ie.length;else{var re=Object.keys(ie);rt=re.length}var tt;if(16>rt?(ve.setUint8(we,rt|(Ot?144:128)),tt=1):65536>rt?(ve.setUint8(we,Ot?220:222),ve.setUint16(we+1,rt),tt=3):4294967296>rt&&(ve.setUint8(we,Ot?221:223),ve.setUint32(we+1,rt),tt=5),Ot)for(var lt=0;rt>lt;lt++)tt+=h(ie[lt],ve,we+tt);else for(var lt=0;rt>lt;lt++){var cr=re[lt];tt+=h(cr,ve,we+tt),tt+=h(ie[cr],ve,we+tt)}return tt}throw new Error("Unknown type "+it)}function _(ie){var ve=typeof ie;if(ve==="string"){var we=c(ie);if(32>we)return 1+we;if(256>we)return 2+we;if(65536>we)return 3+we;if(4294967296>we)return 5+we}if(ie instanceof Uint8Array){var we=ie.byteLength;if(256>we)return 2+we;if(65536>we)return 3+we;if(4294967296>we)return 5+we}if(ve==="number"){if(Math.floor(ie)!==ie)return 9;if(ie>=0){if(128>ie)return 1;if(256>ie)return 2;if(65536>ie)return 3;if(4294967296>ie)return 5;throw new Error("Number too big 0x"+ie.toString(16))}if(ie>=-32)return 1;if(ie>=-128)return 2;if(ie>=-32768)return 3;if(ie>=-2147483648)return 5;throw new Error("Number too small -0x"+ie.toString(16).substr(1))}if(ve==="boolean"||ie===null)return 1;if(ve==="object"){var we,it=0;if(Array.isArray(ie)){we=ie.length;for(var rt=0;we>rt;rt++)it+=_(ie[rt])}else{var Yt=Object.keys(ie);we=Yt.length;for(var rt=0;we>rt;rt++){var Ot=Yt[rt];it+=_(Ot)+_(ie[Ot])}}if(16>we)return 1+it;if(65536>we)return 3+it;if(4294967296>we)return 5+it;throw new Error("Array or object too long 0x"+we.toString(16))}throw new Error("Unknown type "+ve)}function f(ie){var ve=new ArrayBuffer(_(ie)),we=new DataView(ve);return h(ie,we,0),new Uint8Array(ve)}function g(ie,ve,we){return ve?new ie(ve.buffer,ve.byteOffset,ve.byteLength/(we||1)):void 0}function b(ie){return g(DataView,ie)}function p(ie){return g(Uint8Array,ie)}function E(ie){return g(Int8Array,ie)}function M(ie){return g(Int32Array,ie,4)}function R(ie){return g(Float32Array,ie,4)}function z(ie,ve){var we=ie.length/2;ve||(ve=new Int16Array(we));for(var it=0,rt=0;we>it;++it,rt+=2)ve[it]=ie[rt]<<8^ie[rt+1]<<0;return ve}function l(ie,ve){var we=ie.length;ve||(ve=new Uint8Array(2*we));for(var it=b(ve),rt=0;we>rt;++rt)it.setInt16(2*rt,ie[rt]);return p(ve)}function s(ie,ve){var we=ie.length/4;ve||(ve=new Int32Array(we));for(var it=0,rt=0;we>it;++it,rt+=4)ve[it]=ie[rt]<<24^ie[rt+1]<<16^ie[rt+2]<<8^ie[rt+3]<<0;return ve}function v(ie,ve){var we=ie.length;ve||(ve=new Uint8Array(4*we));for(var it=b(ve),rt=0;we>rt;++rt)it.setInt32(4*rt,ie[rt]);return p(ve)}function w(ie,ve){var we=ie.length;ve||(ve=new Float32Array(we/4));for(var it=b(ve),rt=b(ie),Yt=0,Ot=0,re=we/4;re>Yt;++Yt,Ot+=4)it.setFloat32(Ot,rt.getFloat32(Ot),!0);return ve}function S(ie,ve,we){var it=ie.length,rt=1/ve;we||(we=new Float32Array(it));for(var Yt=0;it>Yt;++Yt)we[Yt]=ie[Yt]*rt;return we}function A(ie,ve,we){var it=ie.length;we||(we=new Int32Array(it));for(var rt=0;it>rt;++rt)we[rt]=Math.round(ie[rt]*ve);return we}function u(ie,ve){var we,it;if(!ve){var rt=0;for(we=0,it=ie.length;it>we;we+=2)rt+=ie[we+1];ve=new ie.constructor(rt)}var Yt=0;for(we=0,it=ie.length;it>we;we+=2)for(var Ot=ie[we],re=ie[we+1],tt=0;re>tt;++tt)ve[Yt]=Ot,++Yt;return ve}function y(ie){if(ie.length===0)return new Int32Array;var ve,we,it=2;for(ve=1,we=ie.length;we>ve;++ve)ie[ve-1]!==ie[ve]&&(it+=2);var rt=new Int32Array(it),Yt=0,Ot=1;for(ve=1,we=ie.length;we>ve;++ve)ie[ve-1]!==ie[ve]?(rt[Yt]=ie[ve-1],rt[Yt+1]=Ot,Ot=1,Yt+=2):++Ot;return rt[Yt]=ie[ie.length-1],rt[Yt+1]=Ot,rt}function C(ie,ve){var we=ie.length;ve||(ve=new ie.constructor(we)),we&&(ve[0]=ie[0]);for(var it=1;we>it;++it)ve[it]=ie[it]+ve[it-1];return ve}function k(ie,ve){var we=ie.length;ve||(ve=new ie.constructor(we)),ve[0]=ie[0];for(var it=1;we>it;++it)ve[it]=ie[it]-ie[it-1];return ve}function I(ie,ve){var we,it,rt=ie instanceof Int8Array?127:32767,Yt=-rt-1,Ot=ie.length;if(!ve){var re=0;for(we=0;Ot>we;++we)ie[we]<rt&&ie[we]>Yt&&++re;ve=new Int32Array(re)}for(we=0,it=0;Ot>we;){for(var tt=0;ie[we]===rt||ie[we]===Yt;)tt+=ie[we],++we;tt+=ie[we],++we,ve[it]=tt,++it}return ve}function O(ie,ve){var we,it=32767,rt=-it-1,Yt=ie.length,Ot=0;for(we=0;Yt>we;++we){var re=ie[we];re===0?++Ot:re>0?(Ot+=Math.ceil(re/it),re%it===0&&(Ot+=1)):(Ot+=Math.ceil(re/rt),re%rt===0&&(Ot+=1))}var tt=new Int16Array(Ot),lt=0;for(we=0;Yt>we;++we){var re=ie[we];if(re>=0)for(;re>=it;)tt[lt]=it,++lt,re-=it;else for(;rt>=re;)tt[lt]=rt,++lt,re-=rt;tt[lt]=re,++lt}return tt}function D(ie,ve){return C(u(ie),ve)}function X(ie){return y(k(ie))}function j(ie,ve,we){return S(u(ie,M(we)),ve,we)}function B(ie,ve){return y(A(ie,ve))}function $(ie,ve,we){return S(C(ie,M(we)),ve,we)}function H(ie,ve,we){return k(A(ie,ve),we)}function q(ie,ve,we){return S(I(ie,M(we)),ve,we)}function W(ie,ve,we){var it=I(ie,M(we));return $(it,ve,R(it))}function Y(ie,ve,we){return O(H(ie,ve))}function G(Yt){var ve=b(Yt),we=ve.getInt32(0),it=ve.getInt32(4),rt=Yt.subarray(8,12),Yt=Yt.subarray(12);return[we,Yt,it,rt]}function V(ie,ve,we,it){var rt=new ArrayBuffer(12+it.byteLength),Yt=new Uint8Array(rt),Ot=new DataView(rt);return Ot.setInt32(0,ie),Ot.setInt32(4,ve),we&&Yt.set(we,8),Yt.set(it,12),Yt}function Q(ie){var ve=ie.length,we=p(ie);return V(2,ve,void 0,we)}function xe(ie){var ve=ie.length,we=v(ie);return V(4,ve,void 0,we)}function ce(ie,ve){var we=ie.length/ve,it=v([ve]),rt=p(ie);return V(5,we,it,rt)}function Ne(ie){var ve=ie.length,we=v(y(ie));return V(6,ve,void 0,we)}function Pe(ie){var ve=ie.length,we=v(X(ie));return V(8,ve,void 0,we)}function Fe(ie,ve){var we=ie.length,it=v([ve]),rt=v(B(ie,ve));return V(9,we,it,rt)}function Me(ie,ve){var we=ie.length,it=v([ve]),rt=l(Y(ie,ve));return V(10,we,it,rt)}function je(ie){var ve={};return Lr.forEach(function(we){ie[we]!==void 0&&(ve[we]=ie[we])}),ie.bondAtomList&&(ve.bondAtomList=xe(ie.bondAtomList)),ie.bondOrderList&&(ve.bondOrderList=Q(ie.bondOrderList)),ve.xCoordList=Me(ie.xCoordList,1e3),ve.yCoordList=Me(ie.yCoordList,1e3),ve.zCoordList=Me(ie.zCoordList,1e3),ie.bFactorList&&(ve.bFactorList=Me(ie.bFactorList,100)),ie.atomIdList&&(ve.atomIdList=Pe(ie.atomIdList)),ie.altLocList&&(ve.altLocList=Ne(ie.altLocList)),ie.occupancyList&&(ve.occupancyList=Fe(ie.occupancyList,100)),ve.groupIdList=Pe(ie.groupIdList),ve.groupTypeList=xe(ie.groupTypeList),ie.secStructList&&(ve.secStructList=Q(ie.secStructList)),ie.insCodeList&&(ve.insCodeList=Ne(ie.insCodeList)),ie.sequenceIndexList&&(ve.sequenceIndexList=Pe(ie.sequenceIndexList)),ve.chainIdList=ce(ie.chainIdList,4),ie.chainNameList&&(ve.chainNameList=ce(ie.chainNameList,4)),ve}function ft(ie){function ve(tt){for(var lt={},cr=0;tt>cr;cr++){var et=Yt();lt[et]=Yt()}return lt}function we(tt){var lt=ie.subarray(Ot,Ot+tt);return Ot+=tt,lt}function it(tt){var lt=ie.subarray(Ot,Ot+tt);Ot+=tt;var cr=65535;if(tt>cr){for(var et=[],Ft=0;Ft<lt.length;Ft+=cr)et.push(String.fromCharCode.apply(null,lt.subarray(Ft,Ft+cr)));return et.join("")}return String.fromCharCode.apply(null,lt)}function rt(tt){for(var lt=new Array(tt),cr=0;tt>cr;cr++)lt[cr]=Yt();return lt}function Yt(){var tt,lt,cr=ie[Ot];if(!(128&cr))return Ot++,cr;if((240&cr)===128)return lt=15&cr,Ot++,ve(lt);if((240&cr)===144)return lt=15&cr,Ot++,rt(lt);if((224&cr)===160)return lt=31&cr,Ot++,it(lt);if((224&cr)===224)return tt=re.getInt8(Ot),Ot++,tt;switch(cr){case 192:return Ot++,null;case 194:return Ot++,!1;case 195:return Ot++,!0;case 196:return lt=re.getUint8(Ot+1),Ot+=2,we(lt);case 197:return lt=re.getUint16(Ot+1),Ot+=3,we(lt);case 198:return lt=re.getUint32(Ot+1),Ot+=5,we(lt);case 202:return tt=re.getFloat32(Ot+1),Ot+=5,tt;case 203:return tt=re.getFloat64(Ot+1),Ot+=9,tt;case 204:return tt=ie[Ot+1],Ot+=2,tt;case 205:return tt=re.getUint16(Ot+1),Ot+=3,tt;case 206:return tt=re.getUint32(Ot+1),Ot+=5,tt;case 208:return tt=re.getInt8(Ot+1),Ot+=2,tt;case 209:return tt=re.getInt16(Ot+1),Ot+=3,tt;case 210:return tt=re.getInt32(Ot+1),Ot+=5,tt;case 217:return lt=re.getUint8(Ot+1),Ot+=2,it(lt);case 218:return lt=re.getUint16(Ot+1),Ot+=3,it(lt);case 219:return lt=re.getUint32(Ot+1),Ot+=5,it(lt);case 220:return lt=re.getUint16(Ot+1),Ot+=3,rt(lt);case 221:return lt=re.getUint32(Ot+1),Ot+=5,rt(lt);case 222:return lt=re.getUint16(Ot+1),Ot+=3,ve(lt);case 223:return lt=re.getUint32(Ot+1),Ot+=5,ve(lt)}throw new Error("Unknown type 0x"+cr.toString(16))}var Ot=0,re=new DataView(ie.buffer);return Yt()}function jt(ie,ve,we,it){switch(ie){case 1:return w(ve);case 2:return E(ve);case 3:return z(ve);case 4:return s(ve);case 5:return p(ve);case 6:return u(s(ve),new Uint8Array(we));case 7:return u(s(ve));case 8:return D(s(ve));case 9:return j(s(ve),s(it)[0]);case 10:return W(z(ve),s(it)[0]);case 11:return S(z(ve),s(it)[0]);case 12:return q(z(ve),s(it)[0]);case 13:return q(E(ve),s(it)[0]);case 14:return I(z(ve));case 15:return I(E(ve))}}function Gt(ie,ve){ve=ve||{};var we=ve.ignoreFields,it={};return Nr.forEach(function(rt){var Yt=we?we.indexOf(rt)!==-1:!1,Ot=ie[rt];Yt||Ot===void 0||(Ot instanceof Uint8Array?it[rt]=jt.apply(null,G(Ot)):it[rt]=Ot)}),it}function mt(ie){return String.fromCharCode.apply(null,ie).replace(/\0/g,"")}function Le(ie,ve,we){we=we||{};var it,rt,Yt,Ot,re,tt,lt=we.firstModelOnly,cr=ve.onModel,et=ve.onChain,Ft=ve.onGroup,se=ve.onAtom,_t=ve.onBond,Wr=0,Z=0,ut=0,at=0,me=0,Ze=-1,vt=ie.chainNameList,Qr=ie.secStructList,Zr=ie.insCodeList,Kr=ie.sequenceIndexList,bn=ie.atomIdList,ls=ie.bFactorList,Pn=ie.altLocList,On=ie.occupancyList,Dn=ie.bondAtomList,gi=ie.bondOrderList;for(it=0,rt=ie.chainsPerModel.length;rt>it&&!(lt&&Wr>0);++it){var Ei=ie.chainsPerModel[Wr];for(cr&&cr({chainCount:Ei,modelIndex:Wr}),Yt=0;Ei>Yt;++Yt){var Aa=ie.groupsPerChain[Z];if(et){var Ta=mt(ie.chainIdList.subarray(4*Z,4*Z+4)),ti=null;vt&&(ti=mt(vt.subarray(4*Z,4*Z+4))),et({groupCount:Aa,chainIndex:Z,modelIndex:Wr,chainId:Ta,chainName:ti})}for(Ot=0;Aa>Ot;++Ot){var li=ie.groupList[ie.groupTypeList[ut]],ui=li.atomNameList.length;if(Ft){var Js=null;Qr&&(Js=Qr[ut]);var Vs=null;ie.insCodeList&&(Vs=String.fromCharCode(Zr[ut]));var pa=null;Kr&&(pa=Kr[ut]),Ft({atomCount:ui,groupIndex:ut,chainIndex:Z,modelIndex:Wr,groupId:ie.groupIdList[ut],groupType:ie.groupTypeList[ut],groupName:li.groupName,singleLetterCode:li.singleLetterCode,chemCompType:li.chemCompType,secStruct:Js,insCode:Vs,sequenceIndex:pa})}for(re=0;ui>re;++re){if(se){var cl=null;bn&&(cl=bn[at]);var ul=null;ls&&(ul=ls[at]);var dl=null;Pn&&(dl=String.fromCharCode(Pn[at]));var qa=null;On&&(qa=On[at]),se({atomIndex:at,groupIndex:ut,chainIndex:Z,modelIndex:Wr,atomId:cl,element:li.elementList[re],atomName:li.atomNameList[re],formalCharge:li.formalChargeList[re],xCoord:ie.xCoordList[at],yCoord:ie.yCoordList[at],zCoord:ie.zCoordList[at],bFactor:ul,altLoc:dl,occupancy:qa})}at+=1}if(_t){var fi=li.bondAtomList;for(re=0,tt=li.bondOrderList.length;tt>re;++re)_t({atomIndex1:at-ui+fi[2*re],atomIndex2:at-ui+fi[2*re+1],bondOrder:li.bondOrderList[re]})}ut+=1}Z+=1}if(me=Ze+1,Ze=at-1,_t&&Dn)for(re=0,tt=Dn.length;tt>re;re+=2){var hl=Dn[re],ja=Dn[re+1];(hl>=me&&Ze>=hl||ja>=me&&Ze>=ja)&&_t({atomIndex1:hl,atomIndex2:ja,bondOrder:gi?gi[re/2]:null})}Wr+=1}}function ht(ie){return f(je(ie))}function ar(ie,ve){ie instanceof ArrayBuffer&&(ie=new Uint8Array(ie));var we;return we=ie instanceof Uint8Array?ft(ie):ie,Gt(we,ve)}function Jt(ie,ve,we,it){function rt(){try{var Ot=ar(Yt.response);we(Ot)}catch(re){it(re)}}var Yt=new XMLHttpRequest;Yt.addEventListener("load",rt,!0),Yt.addEventListener("error",it,!0),Yt.responseType="arraybuffer",Yt.open("GET",ve+ie.toUpperCase()),Yt.send()}function Wt(ie,ve,we){Jt(ie,Jr,ve,we)}function Gr(ie,ve,we){Jt(ie,qr,ve,we)}var Lr=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],zr=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],Nr=Lr.concat(zr),At="v1.0.1",Mt="//mmtf.rcsb.org/v1.0/",Jr=Mt+"full/",qr=Mt+"reduced/";t.encode=ht,t.decode=ar,t.traverse=Le,t.fetch=Wt,t.fetchReduced=Gr,t.version=At,t.fetchUrl=Jr,t.fetchReducedUrl=qr,t.encodeMsgpack=f,t.encodeMmtf=je,t.decodeMsgpack=ft,t.decodeMmtf=Gt})}),"./node_modules/pako/dist/pako.esm.mjs":((e,r,t)=>{t.r(r),t.d(r,{Deflate:()=>sl,Inflate:()=>Zu,constants:()=>Oa,default:()=>nu,deflate:()=>Cl,deflateRaw:()=>ia,gzip:()=>_c,inflate:()=>Ju,inflateRaw:()=>xc,ungzip:()=>Qu});/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const a=4,c=0,h=1,_=2;function f(P){let K=P.length;for(;--K>=0;)P[K]=0}const g=0,b=1,p=2,E=3,M=258,R=29,z=256,l=z+1+R,s=30,v=19,w=2*l+1,S=15,A=16,u=7,y=256,C=16,k=17,I=18,O=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),D=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),X=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),j=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),B=512,$=new Array((l+2)*2);f($);const H=new Array(s*2);f(H);const q=new Array(B);f(q);const W=new Array(M-E+1);f(W);const Y=new Array(R);f(Y);const G=new Array(s);f(G);function V(P,K,L,be,Ee){this.static_tree=P,this.extra_bits=K,this.extra_base=L,this.elems=be,this.max_length=Ee,this.has_stree=P&&P.length}let Q,xe,ce;function Ne(P,K){this.dyn_tree=P,this.max_code=0,this.stat_desc=K}const Pe=P=>P<256?q[P]:q[256+(P>>>7)],Fe=(P,K)=>{P.pending_buf[P.pending++]=K&255,P.pending_buf[P.pending++]=K>>>8&255},Me=(P,K,L)=>{P.bi_valid>A-L?(P.bi_buf|=K<<P.bi_valid&65535,Fe(P,P.bi_buf),P.bi_buf=K>>A-P.bi_valid,P.bi_valid+=L-A):(P.bi_buf|=K<<P.bi_valid&65535,P.bi_valid+=L)},je=(P,K,L)=>{Me(P,L[K*2],L[K*2+1])},ft=(P,K)=>{let L=0;do L|=P&1,P>>>=1,L<<=1;while(--K>0);return L>>>1},jt=P=>{P.bi_valid===16?(Fe(P,P.bi_buf),P.bi_buf=0,P.bi_valid=0):P.bi_valid>=8&&(P.pending_buf[P.pending++]=P.bi_buf&255,P.bi_buf>>=8,P.bi_valid-=8)},Gt=(P,K)=>{const L=K.dyn_tree,be=K.max_code,Ee=K.stat_desc.static_tree,De=K.stat_desc.has_stree,Et=K.stat_desc.extra_bits,ct=K.stat_desc.extra_base,sn=K.stat_desc.max_length;let nt,xt,jn,Yr,Br,mi,xi=0;for(Yr=0;Yr<=S;Yr++)P.bl_count[Yr]=0;for(L[P.heap[P.heap_max]*2+1]=0,nt=P.heap_max+1;nt<w;nt++)xt=P.heap[nt],Yr=L[L[xt*2+1]*2+1]+1,Yr>sn&&(Yr=sn,xi++),L[xt*2+1]=Yr,!(xt>be)&&(P.bl_count[Yr]++,Br=0,xt>=ct&&(Br=Et[xt-ct]),mi=L[xt*2],P.opt_len+=mi*(Yr+Br),De&&(P.static_len+=mi*(Ee[xt*2+1]+Br)));if(xi!==0){do{for(Yr=sn-1;P.bl_count[Yr]===0;)Yr--;P.bl_count[Yr]--,P.bl_count[Yr+1]+=2,P.bl_count[sn]--,xi-=2}while(xi>0);for(Yr=sn;Yr!==0;Yr--)for(xt=P.bl_count[Yr];xt!==0;)jn=P.heap[--nt],!(jn>be)&&(L[jn*2+1]!==Yr&&(P.opt_len+=(Yr-L[jn*2+1])*L[jn*2],L[jn*2+1]=Yr),xt--)}},mt=(P,K,L)=>{const be=new Array(S+1);let Ee=0,De,Et;for(De=1;De<=S;De++)Ee=Ee+L[De-1]<<1,be[De]=Ee;for(Et=0;Et<=K;Et++){let ct=P[Et*2+1];ct!==0&&(P[Et*2]=ft(be[ct]++,ct))}},Le=()=>{let P,K,L,be,Ee;const De=new Array(S+1);for(L=0,be=0;be<R-1;be++)for(Y[be]=L,P=0;P<1<<O[be];P++)W[L++]=be;for(W[L-1]=be,Ee=0,be=0;be<16;be++)for(G[be]=Ee,P=0;P<1<<D[be];P++)q[Ee++]=be;for(Ee>>=7;be<s;be++)for(G[be]=Ee<<7,P=0;P<1<<D[be]-7;P++)q[256+Ee++]=be;for(K=0;K<=S;K++)De[K]=0;for(P=0;P<=143;)$[P*2+1]=8,P++,De[8]++;for(;P<=255;)$[P*2+1]=9,P++,De[9]++;for(;P<=279;)$[P*2+1]=7,P++,De[7]++;for(;P<=287;)$[P*2+1]=8,P++,De[8]++;for(mt($,l+1,De),P=0;P<s;P++)H[P*2+1]=5,H[P*2]=ft(P,5);Q=new V($,O,z+1,l,S),xe=new V(H,D,0,s,S),ce=new V(new Array(0),X,0,v,u)},ht=P=>{let K;for(K=0;K<l;K++)P.dyn_ltree[K*2]=0;for(K=0;K<s;K++)P.dyn_dtree[K*2]=0;for(K=0;K<v;K++)P.bl_tree[K*2]=0;P.dyn_ltree[y*2]=1,P.opt_len=P.static_len=0,P.sym_next=P.matches=0},ar=P=>{P.bi_valid>8?Fe(P,P.bi_buf):P.bi_valid>0&&(P.pending_buf[P.pending++]=P.bi_buf),P.bi_buf=0,P.bi_valid=0},Jt=(P,K,L,be)=>{const Ee=K*2,De=L*2;return P[Ee]<P[De]||P[Ee]===P[De]&&be[K]<=be[L]},Wt=(P,K,L)=>{const be=P.heap[L];let Ee=L<<1;for(;Ee<=P.heap_len&&(Ee<P.heap_len&&Jt(K,P.heap[Ee+1],P.heap[Ee],P.depth)&&Ee++,!Jt(K,be,P.heap[Ee],P.depth));)P.heap[L]=P.heap[Ee],L=Ee,Ee<<=1;P.heap[L]=be},Gr=(P,K,L)=>{let be,Ee,De=0,Et,ct;if(P.sym_next!==0)do be=P.pending_buf[P.sym_buf+De++]&255,be+=(P.pending_buf[P.sym_buf+De++]&255)<<8,Ee=P.pending_buf[P.sym_buf+De++],be===0?je(P,Ee,K):(Et=W[Ee],je(P,Et+z+1,K),ct=O[Et],ct!==0&&(Ee-=Y[Et],Me(P,Ee,ct)),be--,Et=Pe(be),je(P,Et,L),ct=D[Et],ct!==0&&(be-=G[Et],Me(P,be,ct)));while(De<P.sym_next);je(P,y,K)},Lr=(P,K)=>{const L=K.dyn_tree,be=K.stat_desc.static_tree,Ee=K.stat_desc.has_stree,De=K.stat_desc.elems;let Et,ct,sn=-1,nt;for(P.heap_len=0,P.heap_max=w,Et=0;Et<De;Et++)L[Et*2]!==0?(P.heap[++P.heap_len]=sn=Et,P.depth[Et]=0):L[Et*2+1]=0;for(;P.heap_len<2;)nt=P.heap[++P.heap_len]=sn<2?++sn:0,L[nt*2]=1,P.depth[nt]=0,P.opt_len--,Ee&&(P.static_len-=be[nt*2+1]);for(K.max_code=sn,Et=P.heap_len>>1;Et>=1;Et--)Wt(P,L,Et);nt=De;do Et=P.heap[1],P.heap[1]=P.heap[P.heap_len--],Wt(P,L,1),ct=P.heap[1],P.heap[--P.heap_max]=Et,P.heap[--P.heap_max]=ct,L[nt*2]=L[Et*2]+L[ct*2],P.depth[nt]=(P.depth[Et]>=P.depth[ct]?P.depth[Et]:P.depth[ct])+1,L[Et*2+1]=L[ct*2+1]=nt,P.heap[1]=nt++,Wt(P,L,1);while(P.heap_len>=2);P.heap[--P.heap_max]=P.heap[1],Gt(P,K),mt(L,sn,P.bl_count)},zr=(P,K,L)=>{let be,Ee=-1,De,Et=K[1],ct=0,sn=7,nt=4;for(Et===0&&(sn=138,nt=3),K[(L+1)*2+1]=65535,be=0;be<=L;be++)De=Et,Et=K[(be+1)*2+1],!(++ct<sn&&De===Et)&&(ct<nt?P.bl_tree[De*2]+=ct:De!==0?(De!==Ee&&P.bl_tree[De*2]++,P.bl_tree[C*2]++):ct<=10?P.bl_tree[k*2]++:P.bl_tree[I*2]++,ct=0,Ee=De,Et===0?(sn=138,nt=3):De===Et?(sn=6,nt=3):(sn=7,nt=4))},Nr=(P,K,L)=>{let be,Ee=-1,De,Et=K[1],ct=0,sn=7,nt=4;for(Et===0&&(sn=138,nt=3),be=0;be<=L;be++)if(De=Et,Et=K[(be+1)*2+1],!(++ct<sn&&De===Et)){if(ct<nt)do je(P,De,P.bl_tree);while(--ct!==0);else De!==0?(De!==Ee&&(je(P,De,P.bl_tree),ct--),je(P,C,P.bl_tree),Me(P,ct-3,2)):ct<=10?(je(P,k,P.bl_tree),Me(P,ct-3,3)):(je(P,I,P.bl_tree),Me(P,ct-11,7));ct=0,Ee=De,Et===0?(sn=138,nt=3):De===Et?(sn=6,nt=3):(sn=7,nt=4)}},At=P=>{let K;for(zr(P,P.dyn_ltree,P.l_desc.max_code),zr(P,P.dyn_dtree,P.d_desc.max_code),Lr(P,P.bl_desc),K=v-1;K>=3&&P.bl_tree[j[K]*2+1]===0;K--);return P.opt_len+=3*(K+1)+5+5+4,K},Mt=(P,K,L,be)=>{let Ee;for(Me(P,K-257,5),Me(P,L-1,5),Me(P,be-4,4),Ee=0;Ee<be;Ee++)Me(P,P.bl_tree[j[Ee]*2+1],3);Nr(P,P.dyn_ltree,K-1),Nr(P,P.dyn_dtree,L-1)},Jr=P=>{let K=4093624447,L;for(L=0;L<=31;L++,K>>>=1)if(K&1&&P.dyn_ltree[L*2]!==0)return c;if(P.dyn_ltree[18]!==0||P.dyn_ltree[20]!==0||P.dyn_ltree[26]!==0)return h;for(L=32;L<z;L++)if(P.dyn_ltree[L*2]!==0)return h;return c};let qr=!1;const ie=P=>{qr||(Le(),qr=!0),P.l_desc=new Ne(P.dyn_ltree,Q),P.d_desc=new Ne(P.dyn_dtree,xe),P.bl_desc=new Ne(P.bl_tree,ce),P.bi_buf=0,P.bi_valid=0,ht(P)},ve=(P,K,L,be)=>{Me(P,(g<<1)+(be?1:0),3),ar(P),Fe(P,L),Fe(P,~L),L&&P.pending_buf.set(P.window.subarray(K,K+L),P.pending),P.pending+=L},we=P=>{Me(P,b<<1,3),je(P,y,$),jt(P)},it=(P,K,L,be)=>{let Ee,De,Et=0;P.level>0?(P.strm.data_type===_&&(P.strm.data_type=Jr(P)),Lr(P,P.l_desc),Lr(P,P.d_desc),Et=At(P),Ee=P.opt_len+3+7>>>3,De=P.static_len+3+7>>>3,De<=Ee&&(Ee=De)):Ee=De=L+5,L+4<=Ee&&K!==-1?ve(P,K,L,be):P.strategy===a||De===Ee?(Me(P,(b<<1)+(be?1:0),3),Gr(P,$,H)):(Me(P,(p<<1)+(be?1:0),3),Mt(P,P.l_desc.max_code+1,P.d_desc.max_code+1,Et+1),Gr(P,P.dyn_ltree,P.dyn_dtree)),ht(P),be&&ar(P)},rt=(P,K,L)=>(P.pending_buf[P.sym_buf+P.sym_next++]=K,P.pending_buf[P.sym_buf+P.sym_next++]=K>>8,P.pending_buf[P.sym_buf+P.sym_next++]=L,K===0?P.dyn_ltree[L*2]++:(P.matches++,K--,P.dyn_ltree[(W[L]+z+1)*2]++,P.dyn_dtree[Pe(K)*2]++),P.sym_next===P.sym_end);var Yt=ie,Ot=ve,re=it,tt=rt,lt=we,cr={_tr_init:Yt,_tr_stored_block:Ot,_tr_flush_block:re,_tr_tally:tt,_tr_align:lt},et=(P,K,L,be)=>{let Ee=P&65535|0,De=P>>>16&65535|0,Et=0;for(;L!==0;){Et=L>2e3?2e3:L,L-=Et;do Ee=Ee+K[be++]|0,De=De+Ee|0;while(--Et);Ee%=65521,De%=65521}return Ee|De<<16|0};const Ft=()=>{let P,K=[];for(var L=0;L<256;L++){P=L;for(var be=0;be<8;be++)P=P&1?3988292384^P>>>1:P>>>1;K[L]=P}return K},se=new Uint32Array(Ft());var _t=(P,K,L,be)=>{const Ee=se,De=be+L;P^=-1;for(let Et=be;Et<De;Et++)P=P>>>8^Ee[(P^K[Et])&255];return P^-1},Wr={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Z={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ut,_tr_stored_block:at,_tr_flush_block:me,_tr_tally:Ze,_tr_align:vt}=cr,{Z_NO_FLUSH:Qr,Z_PARTIAL_FLUSH:Zr,Z_FULL_FLUSH:Kr,Z_FINISH:bn,Z_BLOCK:ls,Z_OK:Pn,Z_STREAM_END:On,Z_STREAM_ERROR:Dn,Z_DATA_ERROR:gi,Z_BUF_ERROR:Ei,Z_DEFAULT_COMPRESSION:Aa,Z_FILTERED:Ta,Z_HUFFMAN_ONLY:ti,Z_RLE:li,Z_FIXED:ui,Z_DEFAULT_STRATEGY:Js,Z_UNKNOWN:Vs,Z_DEFLATED:pa}=Z,cl=9,ul=15,dl=8,qa=286,fi=30,hl=19,ja=2*qa+1,kc=15,Bn=3,Ra=258,ma=Ra+Bn+1,Ml=32,Hs=42,fl=57,ga=69,mu=73,gu=91,vu=103,Na=113,Xa=666,Ls=1,Ga=2,pl=3,zl=4,yu=3,Za=(P,K)=>(P.msg=Wr[K],K),Mc=P=>P*2-(P>4?9:0),ba=P=>{let K=P.length;for(;--K>=0;)P[K]=0},wh=P=>{let K,L,be,Ee=P.w_size;K=P.hash_size,be=K;do L=P.head[--be],P.head[be]=L>=Ee?L-Ee:0;while(--K);K=Ee,be=K;do L=P.prev[--be],P.prev[be]=L>=Ee?L-Ee:0;while(--K)};let Pa=(P,K,L)=>(K<<P.hash_shift^L)&P.hash_mask;const Fn=P=>{const K=P.state;let L=K.pending;L>P.avail_out&&(L=P.avail_out),L!==0&&(P.output.set(K.pending_buf.subarray(K.pending_out,K.pending_out+L),P.next_out),P.next_out+=L,K.pending_out+=L,P.total_out+=L,P.avail_out-=L,K.pending-=L,K.pending===0&&(K.pending_out=0))},aa=(P,K)=>{me(P,P.block_start>=0?P.block_start:-1,P.strstart-P.block_start,K),P.block_start=P.strstart,Fn(P.strm)},si=(P,K)=>{P.pending_buf[P.pending++]=K},ml=(P,K)=>{P.pending_buf[P.pending++]=K>>>8&255,P.pending_buf[P.pending++]=K&255},zc=(P,K,L,be)=>{let Ee=P.avail_in;return Ee>be&&(Ee=be),Ee===0?0:(P.avail_in-=Ee,K.set(P.input.subarray(P.next_in,P.next_in+Ee),L),P.state.wrap===1?P.adler=et(P.adler,K,Ee,L):P.state.wrap===2&&(P.adler=_t(P.adler,K,Ee,L)),P.next_in+=Ee,P.total_in+=Ee,Ee)},_u=(P,K)=>{let L=P.max_chain_length,be=P.strstart,Ee,De,Et=P.prev_length,ct=P.nice_match;const sn=P.strstart>P.w_size-ma?P.strstart-(P.w_size-ma):0,nt=P.window,xt=P.w_mask,jn=P.prev,Yr=P.strstart+Ra;let Br=nt[be+Et-1],mi=nt[be+Et];P.prev_length>=P.good_match&&(L>>=2),ct>P.lookahead&&(ct=P.lookahead);do if(Ee=K,!(nt[Ee+Et]!==mi||nt[Ee+Et-1]!==Br||nt[Ee]!==nt[be]||nt[++Ee]!==nt[be+1])){be+=2,Ee++;do;while(nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&nt[++be]===nt[++Ee]&&be<Yr);if(De=Ra-(Yr-be),be=Yr-Ra,De>Et){if(P.match_start=K,Et=De,De>=ct)break;Br=nt[be+Et-1],mi=nt[be+Et]}}while((K=jn[K&xt])>sn&&--L!==0);return Et<=P.lookahead?Et:P.lookahead},gl=P=>{const K=P.w_size;let L,be,Ee;do{if(be=P.window_size-P.lookahead-P.strstart,P.strstart>=K+(K-ma)&&(P.window.set(P.window.subarray(K,K+K-be),0),P.match_start-=K,P.strstart-=K,P.block_start-=K,P.insert>P.strstart&&(P.insert=P.strstart),wh(P),be+=K),P.strm.avail_in===0)break;if(L=zc(P.strm,P.window,P.strstart+P.lookahead,be),P.lookahead+=L,P.lookahead+P.insert>=Bn)for(Ee=P.strstart-P.insert,P.ins_h=P.window[Ee],P.ins_h=Pa(P,P.ins_h,P.window[Ee+1]);P.insert&&(P.ins_h=Pa(P,P.ins_h,P.window[Ee+Bn-1]),P.prev[Ee&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=Ee,Ee++,P.insert--,!(P.lookahead+P.insert<Bn)););}while(P.lookahead<ma&&P.strm.avail_in!==0)},Nc=(P,K)=>{let L=P.pending_buf_size-5>P.w_size?P.w_size:P.pending_buf_size-5,be,Ee,De,Et=0,ct=P.strm.avail_in;do{if(be=65535,De=P.bi_valid+42>>3,P.strm.avail_out<De||(De=P.strm.avail_out-De,Ee=P.strstart-P.block_start,be>Ee+P.strm.avail_in&&(be=Ee+P.strm.avail_in),be>De&&(be=De),be<L&&(be===0&&K!==bn||K===Qr||be!==Ee+P.strm.avail_in)))break;Et=K===bn&&be===Ee+P.strm.avail_in?1:0,at(P,0,0,Et),P.pending_buf[P.pending-4]=be,P.pending_buf[P.pending-3]=be>>8,P.pending_buf[P.pending-2]=~be,P.pending_buf[P.pending-1]=~be>>8,Fn(P.strm),Ee&&(Ee>be&&(Ee=be),P.strm.output.set(P.window.subarray(P.block_start,P.block_start+Ee),P.strm.next_out),P.strm.next_out+=Ee,P.strm.avail_out-=Ee,P.strm.total_out+=Ee,P.block_start+=Ee,be-=Ee),be&&(zc(P.strm,P.strm.output,P.strm.next_out,be),P.strm.next_out+=be,P.strm.avail_out-=be,P.strm.total_out+=be)}while(Et===0);return ct-=P.strm.avail_in,ct&&(ct>=P.w_size?(P.matches=2,P.window.set(P.strm.input.subarray(P.strm.next_in-P.w_size,P.strm.next_in),0),P.strstart=P.w_size,P.insert=P.strstart):(P.window_size-P.strstart<=ct&&(P.strstart-=P.w_size,P.window.set(P.window.subarray(P.w_size,P.w_size+P.strstart),0),P.matches<2&&P.matches++,P.insert>P.strstart&&(P.insert=P.strstart)),P.window.set(P.strm.input.subarray(P.strm.next_in-ct,P.strm.next_in),P.strstart),P.strstart+=ct,P.insert+=ct>P.w_size-P.insert?P.w_size-P.insert:ct),P.block_start=P.strstart),P.high_water<P.strstart&&(P.high_water=P.strstart),Et?zl:K!==Qr&&K!==bn&&P.strm.avail_in===0&&P.strstart===P.block_start?Ga:(De=P.window_size-P.strstart,P.strm.avail_in>De&&P.block_start>=P.w_size&&(P.block_start-=P.w_size,P.strstart-=P.w_size,P.window.set(P.window.subarray(P.w_size,P.w_size+P.strstart),0),P.matches<2&&P.matches++,De+=P.w_size,P.insert>P.strstart&&(P.insert=P.strstart)),De>P.strm.avail_in&&(De=P.strm.avail_in),De&&(zc(P.strm,P.window,P.strstart,De),P.strstart+=De,P.insert+=De>P.w_size-P.insert?P.w_size-P.insert:De),P.high_water<P.strstart&&(P.high_water=P.strstart),De=P.bi_valid+42>>3,De=P.pending_buf_size-De>65535?65535:P.pending_buf_size-De,L=De>P.w_size?P.w_size:De,Ee=P.strstart-P.block_start,(Ee>=L||(Ee||K===bn)&&K!==Qr&&P.strm.avail_in===0&&Ee<=De)&&(be=Ee>De?De:Ee,Et=K===bn&&P.strm.avail_in===0&&be===Ee?1:0,at(P,P.block_start,be,Et),P.block_start+=be,Fn(P.strm)),Et?pl:Ls)},Nl=(P,K)=>{let L,be;for(;;){if(P.lookahead<ma){if(gl(P),P.lookahead<ma&&K===Qr)return Ls;if(P.lookahead===0)break}if(L=0,P.lookahead>=Bn&&(P.ins_h=Pa(P,P.ins_h,P.window[P.strstart+Bn-1]),L=P.prev[P.strstart&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=P.strstart),L!==0&&P.strstart-L<=P.w_size-ma&&(P.match_length=_u(P,L)),P.match_length>=Bn)if(be=Ze(P,P.strstart-P.match_start,P.match_length-Bn),P.lookahead-=P.match_length,P.match_length<=P.max_lazy_match&&P.lookahead>=Bn){P.match_length--;do P.strstart++,P.ins_h=Pa(P,P.ins_h,P.window[P.strstart+Bn-1]),L=P.prev[P.strstart&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=P.strstart;while(--P.match_length!==0);P.strstart++}else P.strstart+=P.match_length,P.match_length=0,P.ins_h=P.window[P.strstart],P.ins_h=Pa(P,P.ins_h,P.window[P.strstart+1]);else be=Ze(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++;if(be&&(aa(P,!1),P.strm.avail_out===0))return Ls}return P.insert=P.strstart<Bn-1?P.strstart:Bn-1,K===bn?(aa(P,!0),P.strm.avail_out===0?pl:zl):P.sym_next&&(aa(P,!1),P.strm.avail_out===0)?Ls:Ga},va=(P,K)=>{let L,be,Ee;for(;;){if(P.lookahead<ma){if(gl(P),P.lookahead<ma&&K===Qr)return Ls;if(P.lookahead===0)break}if(L=0,P.lookahead>=Bn&&(P.ins_h=Pa(P,P.ins_h,P.window[P.strstart+Bn-1]),L=P.prev[P.strstart&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=P.strstart),P.prev_length=P.match_length,P.prev_match=P.match_start,P.match_length=Bn-1,L!==0&&P.prev_length<P.max_lazy_match&&P.strstart-L<=P.w_size-ma&&(P.match_length=_u(P,L),P.match_length<=5&&(P.strategy===Ta||P.match_length===Bn&&P.strstart-P.match_start>4096)&&(P.match_length=Bn-1)),P.prev_length>=Bn&&P.match_length<=P.prev_length){Ee=P.strstart+P.lookahead-Bn,be=Ze(P,P.strstart-1-P.prev_match,P.prev_length-Bn),P.lookahead-=P.prev_length-1,P.prev_length-=2;do++P.strstart<=Ee&&(P.ins_h=Pa(P,P.ins_h,P.window[P.strstart+Bn-1]),L=P.prev[P.strstart&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=P.strstart);while(--P.prev_length!==0);if(P.match_available=0,P.match_length=Bn-1,P.strstart++,be&&(aa(P,!1),P.strm.avail_out===0))return Ls}else if(P.match_available){if(be=Ze(P,0,P.window[P.strstart-1]),be&&aa(P,!1),P.strstart++,P.lookahead--,P.strm.avail_out===0)return Ls}else P.match_available=1,P.strstart++,P.lookahead--}return P.match_available&&(be=Ze(P,0,P.window[P.strstart-1]),P.match_available=0),P.insert=P.strstart<Bn-1?P.strstart:Bn-1,K===bn?(aa(P,!0),P.strm.avail_out===0?pl:zl):P.sym_next&&(aa(P,!1),P.strm.avail_out===0)?Ls:Ga},Ja=(P,K)=>{let L,be,Ee,De;const Et=P.window;for(;;){if(P.lookahead<=Ra){if(gl(P),P.lookahead<=Ra&&K===Qr)return Ls;if(P.lookahead===0)break}if(P.match_length=0,P.lookahead>=Bn&&P.strstart>0&&(Ee=P.strstart-1,be=Et[Ee],be===Et[++Ee]&&be===Et[++Ee]&&be===Et[++Ee])){De=P.strstart+Ra;do;while(be===Et[++Ee]&&be===Et[++Ee]&&be===Et[++Ee]&&be===Et[++Ee]&&be===Et[++Ee]&&be===Et[++Ee]&&be===Et[++Ee]&&be===Et[++Ee]&&Ee<De);P.match_length=Ra-(De-Ee),P.match_length>P.lookahead&&(P.match_length=P.lookahead)}if(P.match_length>=Bn?(L=Ze(P,1,P.match_length-Bn),P.lookahead-=P.match_length,P.strstart+=P.match_length,P.match_length=0):(L=Ze(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++),L&&(aa(P,!1),P.strm.avail_out===0))return Ls}return P.insert=0,K===bn?(aa(P,!0),P.strm.avail_out===0?pl:zl):P.sym_next&&(aa(P,!1),P.strm.avail_out===0)?Ls:Ga},Qa=(P,K)=>{let L;for(;;){if(P.lookahead===0&&(gl(P),P.lookahead===0)){if(K===Qr)return Ls;break}if(P.match_length=0,L=Ze(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++,L&&(aa(P,!1),P.strm.avail_out===0))return Ls}return P.insert=0,K===bn?(aa(P,!0),P.strm.avail_out===0?pl:zl):P.sym_next&&(aa(P,!1),P.strm.avail_out===0)?Ls:Ga};function la(P,K,L,be,Ee){this.good_length=P,this.max_lazy=K,this.nice_length=L,this.max_chain=be,this.func=Ee}const Ua=[new la(0,0,0,0,Nc),new la(4,4,8,4,Nl),new la(4,5,16,8,Nl),new la(4,6,32,32,Nl),new la(4,4,16,16,va),new la(8,16,32,32,va),new la(8,16,128,128,va),new la(8,32,128,256,va),new la(32,128,258,1024,va),new la(32,258,258,4096,va)],Ka=P=>{P.window_size=2*P.w_size,ba(P.head),P.max_lazy_match=Ua[P.level].max_lazy,P.good_match=Ua[P.level].good_length,P.nice_match=Ua[P.level].nice_length,P.max_chain_length=Ua[P.level].max_chain,P.strstart=0,P.block_start=0,P.lookahead=0,P.insert=0,P.match_length=P.prev_length=Bn-1,P.match_available=0,P.ins_h=0};function Sh(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=pa,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(ja*2),this.dyn_dtree=new Uint16Array((2*fi+1)*2),this.bl_tree=new Uint16Array((2*hl+1)*2),ba(this.dyn_ltree),ba(this.dyn_dtree),ba(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(kc+1),this.heap=new Uint16Array(2*qa+1),ba(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*qa+1),ba(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Pl=P=>{if(!P)return 1;const K=P.state;return!K||K.strm!==P||K.status!==Hs&&K.status!==fl&&K.status!==ga&&K.status!==mu&&K.status!==gu&&K.status!==vu&&K.status!==Na&&K.status!==Xa?1:0},Il=P=>{if(Pl(P))return Za(P,Dn);P.total_in=P.total_out=0,P.data_type=Vs;const K=P.state;return K.pending=0,K.pending_out=0,K.wrap<0&&(K.wrap=-K.wrap),K.status=K.wrap===2?fl:K.wrap?Hs:Na,P.adler=K.wrap===2?0:1,K.last_flush=-2,ut(K),Pn},pd=P=>{const K=Il(P);return K===Pn&&Ka(P.state),K},md=(P,K)=>Pl(P)||P.state.wrap!==2?Dn:(P.state.gzhead=K,Pn),nc=(P,K,L,be,Ee,De)=>{if(!P)return Dn;let Et=1;if(K===Aa&&(K=6),be<0?(Et=0,be=-be):be>15&&(Et=2,be-=16),Ee<1||Ee>cl||L!==pa||be<8||be>15||K<0||K>9||De<0||De>ui||be===8&&Et!==1)return Za(P,Dn);be===8&&(be=9);const ct=new Sh;return P.state=ct,ct.strm=P,ct.status=Hs,ct.wrap=Et,ct.gzhead=null,ct.w_bits=be,ct.w_size=1<<ct.w_bits,ct.w_mask=ct.w_size-1,ct.hash_bits=Ee+7,ct.hash_size=1<<ct.hash_bits,ct.hash_mask=ct.hash_size-1,ct.hash_shift=~~((ct.hash_bits+Bn-1)/Bn),ct.window=new Uint8Array(ct.w_size*2),ct.head=new Uint16Array(ct.hash_size),ct.prev=new Uint16Array(ct.w_size),ct.lit_bufsize=1<<Ee+6,ct.pending_buf_size=ct.lit_bufsize*4,ct.pending_buf=new Uint8Array(ct.pending_buf_size),ct.sym_buf=ct.lit_bufsize,ct.sym_end=(ct.lit_bufsize-1)*3,ct.level=K,ct.strategy=De,ct.method=L,pd(P)},gd=(P,K)=>nc(P,K,pa,ul,dl,Js),Eh=(P,K)=>{if(Pl(P)||K>ls||K<0)return P?Za(P,Dn):Dn;const L=P.state;if(!P.output||P.avail_in!==0&&!P.input||L.status===Xa&&K!==bn)return Za(P,P.avail_out===0?Ei:Dn);const be=L.last_flush;if(L.last_flush=K,L.pending!==0){if(Fn(P),P.avail_out===0)return L.last_flush=-1,Pn}else if(P.avail_in===0&&Mc(K)<=Mc(be)&&K!==bn)return Za(P,Ei);if(L.status===Xa&&P.avail_in!==0)return Za(P,Ei);if(L.status===Hs&&L.wrap===0&&(L.status=Na),L.status===Hs){let Ee=pa+(L.w_bits-8<<4)<<8,De=-1;if(L.strategy>=ti||L.level<2?De=0:L.level<6?De=1:L.level===6?De=2:De=3,Ee|=De<<6,L.strstart!==0&&(Ee|=Ml),Ee+=31-Ee%31,ml(L,Ee),L.strstart!==0&&(ml(L,P.adler>>>16),ml(L,P.adler&65535)),P.adler=1,L.status=Na,Fn(P),L.pending!==0)return L.last_flush=-1,Pn}if(L.status===fl){if(P.adler=0,si(L,31),si(L,139),si(L,8),L.gzhead)si(L,(L.gzhead.text?1:0)+(L.gzhead.hcrc?2:0)+(L.gzhead.extra?4:0)+(L.gzhead.name?8:0)+(L.gzhead.comment?16:0)),si(L,L.gzhead.time&255),si(L,L.gzhead.time>>8&255),si(L,L.gzhead.time>>16&255),si(L,L.gzhead.time>>24&255),si(L,L.level===9?2:L.strategy>=ti||L.level<2?4:0),si(L,L.gzhead.os&255),L.gzhead.extra&&L.gzhead.extra.length&&(si(L,L.gzhead.extra.length&255),si(L,L.gzhead.extra.length>>8&255)),L.gzhead.hcrc&&(P.adler=_t(P.adler,L.pending_buf,L.pending,0)),L.gzindex=0,L.status=ga;else if(si(L,0),si(L,0),si(L,0),si(L,0),si(L,0),si(L,L.level===9?2:L.strategy>=ti||L.level<2?4:0),si(L,yu),L.status=Na,Fn(P),L.pending!==0)return L.last_flush=-1,Pn}if(L.status===ga){if(L.gzhead.extra){let Ee=L.pending,De=(L.gzhead.extra.length&65535)-L.gzindex;for(;L.pending+De>L.pending_buf_size;){let ct=L.pending_buf_size-L.pending;if(L.pending_buf.set(L.gzhead.extra.subarray(L.gzindex,L.gzindex+ct),L.pending),L.pending=L.pending_buf_size,L.gzhead.hcrc&&L.pending>Ee&&(P.adler=_t(P.adler,L.pending_buf,L.pending-Ee,Ee)),L.gzindex+=ct,Fn(P),L.pending!==0)return L.last_flush=-1,Pn;Ee=0,De-=ct}let Et=new Uint8Array(L.gzhead.extra);L.pending_buf.set(Et.subarray(L.gzindex,L.gzindex+De),L.pending),L.pending+=De,L.gzhead.hcrc&&L.pending>Ee&&(P.adler=_t(P.adler,L.pending_buf,L.pending-Ee,Ee)),L.gzindex=0}L.status=mu}if(L.status===mu){if(L.gzhead.name){let Ee=L.pending,De;do{if(L.pending===L.pending_buf_size){if(L.gzhead.hcrc&&L.pending>Ee&&(P.adler=_t(P.adler,L.pending_buf,L.pending-Ee,Ee)),Fn(P),L.pending!==0)return L.last_flush=-1,Pn;Ee=0}L.gzindex<L.gzhead.name.length?De=L.gzhead.name.charCodeAt(L.gzindex++)&255:De=0,si(L,De)}while(De!==0);L.gzhead.hcrc&&L.pending>Ee&&(P.adler=_t(P.adler,L.pending_buf,L.pending-Ee,Ee)),L.gzindex=0}L.status=gu}if(L.status===gu){if(L.gzhead.comment){let Ee=L.pending,De;do{if(L.pending===L.pending_buf_size){if(L.gzhead.hcrc&&L.pending>Ee&&(P.adler=_t(P.adler,L.pending_buf,L.pending-Ee,Ee)),Fn(P),L.pending!==0)return L.last_flush=-1,Pn;Ee=0}L.gzindex<L.gzhead.comment.length?De=L.gzhead.comment.charCodeAt(L.gzindex++)&255:De=0,si(L,De)}while(De!==0);L.gzhead.hcrc&&L.pending>Ee&&(P.adler=_t(P.adler,L.pending_buf,L.pending-Ee,Ee))}L.status=vu}if(L.status===vu){if(L.gzhead.hcrc){if(L.pending+2>L.pending_buf_size&&(Fn(P),L.pending!==0))return L.last_flush=-1,Pn;si(L,P.adler&255),si(L,P.adler>>8&255),P.adler=0}if(L.status=Na,Fn(P),L.pending!==0)return L.last_flush=-1,Pn}if(P.avail_in!==0||L.lookahead!==0||K!==Qr&&L.status!==Xa){let Ee=L.level===0?Nc(L,K):L.strategy===ti?Qa(L,K):L.strategy===li?Ja(L,K):Ua[L.level].func(L,K);if((Ee===pl||Ee===zl)&&(L.status=Xa),Ee===Ls||Ee===pl)return P.avail_out===0&&(L.last_flush=-1),Pn;if(Ee===Ga&&(K===Zr?vt(L):K!==ls&&(at(L,0,0,!1),K===Kr&&(ba(L.head),L.lookahead===0&&(L.strstart=0,L.block_start=0,L.insert=0))),Fn(P),P.avail_out===0))return L.last_flush=-1,Pn}return K!==bn?Pn:L.wrap<=0?On:(L.wrap===2?(si(L,P.adler&255),si(L,P.adler>>8&255),si(L,P.adler>>16&255),si(L,P.adler>>24&255),si(L,P.total_in&255),si(L,P.total_in>>8&255),si(L,P.total_in>>16&255),si(L,P.total_in>>24&255)):(ml(L,P.adler>>>16),ml(L,P.adler&65535)),Fn(P),L.wrap>0&&(L.wrap=-L.wrap),L.pending!==0?Pn:On)},ic=P=>{if(Pl(P))return Dn;const K=P.state.status;return P.state=null,K===Na?Za(P,gi):Pn},sc=(P,K)=>{let L=K.length;if(Pl(P))return Dn;const be=P.state,Ee=be.wrap;if(Ee===2||Ee===1&&be.status!==Hs||be.lookahead)return Dn;if(Ee===1&&(P.adler=et(P.adler,K,L,0)),be.wrap=0,L>=be.w_size){Ee===0&&(ba(be.head),be.strstart=0,be.block_start=0,be.insert=0);let sn=new Uint8Array(be.w_size);sn.set(K.subarray(L-be.w_size,L),0),K=sn,L=be.w_size}const De=P.avail_in,Et=P.next_in,ct=P.input;for(P.avail_in=L,P.next_in=0,P.input=K,gl(be);be.lookahead>=Bn;){let sn=be.strstart,nt=be.lookahead-(Bn-1);do be.ins_h=Pa(be,be.ins_h,be.window[sn+Bn-1]),be.prev[sn&be.w_mask]=be.head[be.ins_h],be.head[be.ins_h]=sn,sn++;while(--nt);be.strstart=sn,be.lookahead=Bn-1,gl(be)}return be.strstart+=be.lookahead,be.block_start=be.strstart,be.insert=be.lookahead,be.lookahead=0,be.match_length=be.prev_length=Bn-1,be.match_available=0,P.next_in=Et,P.input=ct,P.avail_in=De,be.wrap=Ee,Pn};var Ol=gd,Pc=nc,Ch=pd,Ah=Il,xu=md,Ic=Eh,bu=ic,vd=sc,el="pako deflate (from Nodeca project)",vl={deflateInit:Ol,deflateInit2:Pc,deflateReset:Ch,deflateResetKeep:Ah,deflateSetHeader:xu,deflate:Ic,deflateEnd:bu,deflateSetDictionary:vd,deflateInfo:el};const Oc=(P,K)=>Object.prototype.hasOwnProperty.call(P,K);var yd=function(P){const K=Array.prototype.slice.call(arguments,1);for(;K.length;){const L=K.shift();if(L){if(typeof L!="object")throw new TypeError(L+"must be non-object");for(const be in L)Oc(L,be)&&(P[be]=L[be])}}return P},Fc=P=>{let K=0;for(let be=0,Ee=P.length;be<Ee;be++)K+=P[be].length;const L=new Uint8Array(K);for(let be=0,Ee=0,De=P.length;be<De;be++){let Et=P[be];L.set(Et,Ee),Ee+=Et.length}return L},yl={assign:yd,flattenChunks:Fc};let wu=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{wu=!1}const $s=new Uint8Array(256);for(let P=0;P<256;P++)$s[P]=P>=252?6:P>=248?5:P>=240?4:P>=224?3:P>=192?2:1;$s[254]=$s[254]=1;var Fl=P=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(P);let K,L,be,Ee,De,Et=P.length,ct=0;for(Ee=0;Ee<Et;Ee++)L=P.charCodeAt(Ee),(L&64512)===55296&&Ee+1<Et&&(be=P.charCodeAt(Ee+1),(be&64512)===56320&&(L=65536+(L-55296<<10)+(be-56320),Ee++)),ct+=L<128?1:L<2048?2:L<65536?3:4;for(K=new Uint8Array(ct),De=0,Ee=0;De<ct;Ee++)L=P.charCodeAt(Ee),(L&64512)===55296&&Ee+1<Et&&(be=P.charCodeAt(Ee+1),(be&64512)===56320&&(L=65536+(L-55296<<10)+(be-56320),Ee++)),L<128?K[De++]=L:L<2048?(K[De++]=192|L>>>6,K[De++]=128|L&63):L<65536?(K[De++]=224|L>>>12,K[De++]=128|L>>>6&63,K[De++]=128|L&63):(K[De++]=240|L>>>18,K[De++]=128|L>>>12&63,K[De++]=128|L>>>6&63,K[De++]=128|L&63);return K};const Su=(P,K)=>{if(K<65534&&P.subarray&&wu)return String.fromCharCode.apply(null,P.length===K?P:P.subarray(0,K));let L="";for(let be=0;be<K;be++)L+=String.fromCharCode(P[be]);return L};var oc=(P,K)=>{const L=K||P.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(P.subarray(0,K));let be,Ee;const De=new Array(L*2);for(Ee=0,be=0;be<L;){let Et=P[be++];if(Et<128){De[Ee++]=Et;continue}let ct=$s[Et];if(ct>4){De[Ee++]=65533,be+=ct-1;continue}for(Et&=ct===2?31:ct===3?15:7;ct>1&&be<L;)Et=Et<<6|P[be++]&63,ct--;if(ct>1){De[Ee++]=65533;continue}Et<65536?De[Ee++]=Et:(Et-=65536,De[Ee++]=55296|Et>>10&1023,De[Ee++]=56320|Et&1023)}return Su(De,Ee)},Th=(P,K)=>{K=K||P.length,K>P.length&&(K=P.length);let L=K-1;for(;L>=0&&(P[L]&192)===128;)L--;return L<0||L===0?K:L+$s[P[L]]>K?L:K},_l={string2buf:Fl,buf2string:oc,utf8border:Th};function Eu(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Ll=Eu;const ac=Object.prototype.toString,{Z_NO_FLUSH:_d,Z_SYNC_FLUSH:Rh,Z_FULL_FLUSH:kh,Z_FINISH:Mh,Z_OK:Dl,Z_STREAM_END:zh,Z_DEFAULT_COMPRESSION:Nh,Z_DEFAULT_STRATEGY:Ph,Z_DEFLATED:Ih}=Z;function lc(P){this.options=yl.assign({level:Nh,method:Ih,chunkSize:16384,windowBits:15,memLevel:8,strategy:Ph},P||{});let K=this.options;K.raw&&K.windowBits>0?K.windowBits=-K.windowBits:K.gzip&&K.windowBits>0&&K.windowBits<16&&(K.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ll,this.strm.avail_out=0;let L=vl.deflateInit2(this.strm,K.level,K.method,K.windowBits,K.memLevel,K.strategy);if(L!==Dl)throw new Error(Wr[L]);if(K.header&&vl.deflateSetHeader(this.strm,K.header),K.dictionary){let be;if(typeof K.dictionary=="string"?be=_l.string2buf(K.dictionary):ac.call(K.dictionary)==="[object ArrayBuffer]"?be=new Uint8Array(K.dictionary):be=K.dictionary,L=vl.deflateSetDictionary(this.strm,be),L!==Dl)throw new Error(Wr[L]);this._dict_set=!0}}lc.prototype.push=function(P,K){const L=this.strm,be=this.options.chunkSize;let Ee,De;if(this.ended)return!1;for(K===~~K?De=K:De=K===!0?Mh:_d,typeof P=="string"?L.input=_l.string2buf(P):ac.call(P)==="[object ArrayBuffer]"?L.input=new Uint8Array(P):L.input=P,L.next_in=0,L.avail_in=L.input.length;;){if(L.avail_out===0&&(L.output=new Uint8Array(be),L.next_out=0,L.avail_out=be),(De===Rh||De===kh)&&L.avail_out<=6){this.onData(L.output.subarray(0,L.next_out)),L.avail_out=0;continue}if(Ee=vl.deflate(L,De),Ee===zh)return L.next_out>0&&this.onData(L.output.subarray(0,L.next_out)),Ee=vl.deflateEnd(this.strm),this.onEnd(Ee),this.ended=!0,Ee===Dl;if(L.avail_out===0){this.onData(L.output);continue}if(De>0&&L.next_out>0){this.onData(L.output.subarray(0,L.next_out)),L.avail_out=0;continue}if(L.avail_in===0)break}return!0},lc.prototype.onData=function(P){this.chunks.push(P)},lc.prototype.onEnd=function(P){P===Dl&&(this.result=yl.flattenChunks(this.chunks)),this.chunks=[],this.err=P,this.msg=this.strm.msg};function Lc(P,K){const L=new lc(K);if(L.push(P,!0),L.err)throw L.msg||Wr[L.err];return L.result}function Oh(P,K){return K=K||{},K.raw=!0,Lc(P,K)}function Fh(P,K){return K=K||{},K.gzip=!0,Lc(P,K)}var Lh=lc,Dh=Lc,Cu=Oh,Bh=Fh,jh={Deflate:Lh,deflate:Dh,deflateRaw:Cu,gzip:Bh};const Dc=16209,xd=16191;var Gh=function(P,K){let L,be,Ee,De,Et,ct,sn,nt,xt,jn,Yr,Br,mi,xi,ni,An,Cn,Hr,Tn,ks,ii,ei,ci,Rn;const Ln=P.state;L=P.next_in,ci=P.input,be=L+(P.avail_in-5),Ee=P.next_out,Rn=P.output,De=Ee-(K-P.avail_out),Et=Ee+(P.avail_out-257),ct=Ln.dmax,sn=Ln.wsize,nt=Ln.whave,xt=Ln.wnext,jn=Ln.window,Yr=Ln.hold,Br=Ln.bits,mi=Ln.lencode,xi=Ln.distcode,ni=(1<<Ln.lenbits)-1,An=(1<<Ln.distbits)-1;e:do{Br<15&&(Yr+=ci[L++]<<Br,Br+=8,Yr+=ci[L++]<<Br,Br+=8),Cn=mi[Yr&ni];t:for(;;){if(Hr=Cn>>>24,Yr>>>=Hr,Br-=Hr,Hr=Cn>>>16&255,Hr===0)Rn[Ee++]=Cn&65535;else if(Hr&16){Tn=Cn&65535,Hr&=15,Hr&&(Br<Hr&&(Yr+=ci[L++]<<Br,Br+=8),Tn+=Yr&(1<<Hr)-1,Yr>>>=Hr,Br-=Hr),Br<15&&(Yr+=ci[L++]<<Br,Br+=8,Yr+=ci[L++]<<Br,Br+=8),Cn=xi[Yr&An];r:for(;;){if(Hr=Cn>>>24,Yr>>>=Hr,Br-=Hr,Hr=Cn>>>16&255,Hr&16){if(ks=Cn&65535,Hr&=15,Br<Hr&&(Yr+=ci[L++]<<Br,Br+=8,Br<Hr&&(Yr+=ci[L++]<<Br,Br+=8)),ks+=Yr&(1<<Hr)-1,ks>ct){P.msg="invalid distance too far back",Ln.mode=Dc;break e}if(Yr>>>=Hr,Br-=Hr,Hr=Ee-De,ks>Hr){if(Hr=ks-Hr,Hr>nt&&Ln.sane){P.msg="invalid distance too far back",Ln.mode=Dc;break e}if(ii=0,ei=jn,xt===0){if(ii+=sn-Hr,Hr<Tn){Tn-=Hr;do Rn[Ee++]=jn[ii++];while(--Hr);ii=Ee-ks,ei=Rn}}else if(xt<Hr){if(ii+=sn+xt-Hr,Hr-=xt,Hr<Tn){Tn-=Hr;do Rn[Ee++]=jn[ii++];while(--Hr);if(ii=0,xt<Tn){Hr=xt,Tn-=Hr;do Rn[Ee++]=jn[ii++];while(--Hr);ii=Ee-ks,ei=Rn}}}else if(ii+=xt-Hr,Hr<Tn){Tn-=Hr;do Rn[Ee++]=jn[ii++];while(--Hr);ii=Ee-ks,ei=Rn}for(;Tn>2;)Rn[Ee++]=ei[ii++],Rn[Ee++]=ei[ii++],Rn[Ee++]=ei[ii++],Tn-=3;Tn&&(Rn[Ee++]=ei[ii++],Tn>1&&(Rn[Ee++]=ei[ii++]))}else{ii=Ee-ks;do Rn[Ee++]=Rn[ii++],Rn[Ee++]=Rn[ii++],Rn[Ee++]=Rn[ii++],Tn-=3;while(Tn>2);Tn&&(Rn[Ee++]=Rn[ii++],Tn>1&&(Rn[Ee++]=Rn[ii++]))}}else if(Hr&64){P.msg="invalid distance code",Ln.mode=Dc;break e}else{Cn=xi[(Cn&65535)+(Yr&(1<<Hr)-1)];continue r}break}}else if(Hr&64)if(Hr&32){Ln.mode=xd;break e}else{P.msg="invalid literal/length code",Ln.mode=Dc;break e}else{Cn=mi[(Cn&65535)+(Yr&(1<<Hr)-1)];continue t}break}}while(L<be&&Ee<Et);Tn=Br>>3,L-=Tn,Br-=Tn<<3,Yr&=(1<<Br)-1,P.next_in=L,P.next_out=Ee,P.avail_in=L<be?5+(be-L):5-(L-be),P.avail_out=Ee<Et?257+(Et-Ee):257-(Ee-Et),Ln.hold=Yr,Ln.bits=Br};const Bl=15,bd=852,wd=592,Sd=0,Tu=1,Ed=2,Ru=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),uc=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Uh=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Cd=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var jl=(P,K,L,be,Ee,De,Et,ct)=>{const sn=ct.bits;let nt=0,xt=0,jn=0,Yr=0,Br=0,mi=0,xi=0,ni=0,An=0,Cn=0,Hr,Tn,ks,ii,ei,ci=null,Rn;const Ln=new Uint16Array(Bl+1),Ks=new Uint16Array(Bl+1);let wa=null,iu,su,ua;for(nt=0;nt<=Bl;nt++)Ln[nt]=0;for(xt=0;xt<be;xt++)Ln[K[L+xt]]++;for(Br=sn,Yr=Bl;Yr>=1&&Ln[Yr]===0;Yr--);if(Br>Yr&&(Br=Yr),Yr===0)return Ee[De++]=1<<24|64<<16|0,Ee[De++]=1<<24|64<<16|0,ct.bits=1,0;for(jn=1;jn<Yr&&Ln[jn]===0;jn++);for(Br<jn&&(Br=jn),ni=1,nt=1;nt<=Bl;nt++)if(ni<<=1,ni-=Ln[nt],ni<0)return-1;if(ni>0&&(P===Sd||Yr!==1))return-1;for(Ks[1]=0,nt=1;nt<Bl;nt++)Ks[nt+1]=Ks[nt]+Ln[nt];for(xt=0;xt<be;xt++)K[L+xt]!==0&&(Et[Ks[K[L+xt]]++]=xt);if(P===Sd?(ci=wa=Et,Rn=20):P===Tu?(ci=Ru,wa=uc,Rn=257):(ci=Uh,wa=Cd,Rn=0),Cn=0,xt=0,nt=jn,ei=De,mi=Br,xi=0,ks=-1,An=1<<Br,ii=An-1,P===Tu&&An>bd||P===Ed&&An>wd)return 1;for(;;){iu=nt-xi,Et[xt]+1<Rn?(su=0,ua=Et[xt]):Et[xt]>=Rn?(su=wa[Et[xt]-Rn],ua=ci[Et[xt]-Rn]):(su=96,ua=0),Hr=1<<nt-xi,Tn=1<<mi,jn=Tn;do Tn-=Hr,Ee[ei+(Cn>>xi)+Tn]=iu<<24|su<<16|ua|0;while(Tn!==0);for(Hr=1<<nt-1;Cn&Hr;)Hr>>=1;if(Hr!==0?(Cn&=Hr-1,Cn+=Hr):Cn=0,xt++,--Ln[nt]===0){if(nt===Yr)break;nt=K[L+Et[xt]]}if(nt>Br&&(Cn&ii)!==ks){for(xi===0&&(xi=Br),ei+=jn,mi=nt-xi,ni=1<<mi;mi+xi<Yr&&(ni-=Ln[mi+xi],!(ni<=0));)mi++,ni<<=1;if(An+=1<<mi,P===Tu&&An>bd||P===Ed&&An>wd)return 1;ks=Cn&ii,Ee[ks]=Br<<24|mi<<16|ei-De|0}}return Cn!==0&&(Ee[ei+Cn]=nt-xi<<24|64<<16|0),ct.bits=Br,0};const Ad=0,ku=1,Mu=2,{Z_FINISH:xl,Z_BLOCK:Vh,Z_TREES:Bc,Z_OK:bl,Z_STREAM_END:Td,Z_NEED_DICT:Rd,Z_STREAM_ERROR:na,Z_DATA_ERROR:Gl,Z_MEM_ERROR:kd,Z_BUF_ERROR:jc,Z_DEFLATED:Md}=Z,dc=16180,Gc=16181,Uc=16182,zu=16183,Nu=16184,Pu=16185,zd=16186,Nd=16187,Pd=16188,Id=16189,Vc=16190,Gs=16191,wl=16192,Iu=16193,Wc=16194,Ou=16195,Fu=16196,Hc=16197,Od=16198,$c=16199,Va=16200,Yc=16201,Ul=16202,qc=16203,Lu=16204,hc=16205,tl=16206,Xc=16207,Du=16208,di=16209,Bu=16210,ju=16211,Fd=852,Ld=592,Dd=15,Gu=P=>(P>>>24&255)+(P>>>8&65280)+((P&65280)<<8)+((P&255)<<24);function rl(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Wa=P=>{if(!P)return 1;const K=P.state;return!K||K.strm!==P||K.mode<dc||K.mode>ju?1:0},Zc=P=>{if(Wa(P))return na;const K=P.state;return P.total_in=P.total_out=K.total=0,P.msg="",K.wrap&&(P.adler=K.wrap&1),K.mode=dc,K.last=0,K.havedict=0,K.flags=-1,K.dmax=32768,K.head=null,K.hold=0,K.bits=0,K.lencode=K.lendyn=new Int32Array(Fd),K.distcode=K.distdyn=new Int32Array(Ld),K.sane=1,K.back=-1,bl},Bd=P=>{if(Wa(P))return na;const K=P.state;return K.wsize=0,K.whave=0,K.wnext=0,Zc(P)},jd=(P,K)=>{let L;if(Wa(P))return na;const be=P.state;return K<0?(L=0,K=-K):(L=(K>>4)+5,K<48&&(K&=15)),K&&(K<8||K>15)?na:(be.window!==null&&be.wbits!==K&&(be.window=null),be.wrap=L,be.wbits=K,Bd(P))},Vl=(P,K)=>{if(!P)return na;const L=new rl;P.state=L,L.strm=P,L.window=null,L.mode=dc;const be=jd(P,K);return be!==bl&&(P.state=null),be},Wh=P=>Vl(P,Dd);let Uu=!0,Jc,hi;const Vu=P=>{if(Uu){Jc=new Int32Array(512),hi=new Int32Array(32);let K=0;for(;K<144;)P.lens[K++]=8;for(;K<256;)P.lens[K++]=9;for(;K<280;)P.lens[K++]=7;for(;K<288;)P.lens[K++]=8;for(jl(ku,P.lens,0,288,Jc,0,P.work,{bits:9}),K=0;K<32;)P.lens[K++]=5;jl(Mu,P.lens,0,32,hi,0,P.work,{bits:5}),Uu=!1}P.lencode=Jc,P.lenbits=9,P.distcode=hi,P.distbits=5},fc=(P,K,L,be)=>{let Ee;const De=P.state;return De.window===null&&(De.wsize=1<<De.wbits,De.wnext=0,De.whave=0,De.window=new Uint8Array(De.wsize)),be>=De.wsize?(De.window.set(K.subarray(L-De.wsize,L),0),De.wnext=0,De.whave=De.wsize):(Ee=De.wsize-De.wnext,Ee>be&&(Ee=be),De.window.set(K.subarray(L-be,L-be+Ee),De.wnext),be-=Ee,be?(De.window.set(K.subarray(L-be,L),0),De.wnext=be,De.whave=De.wsize):(De.wnext+=Ee,De.wnext===De.wsize&&(De.wnext=0),De.whave<De.wsize&&(De.whave+=Ee))),0},pc=(P,K)=>{let L,be,Ee,De,Et,ct,sn,nt,xt,jn,Yr,Br,mi,xi,ni=0,An,Cn,Hr,Tn,ks,ii,ei,ci;const Rn=new Uint8Array(4);let Ln,Ks;const wa=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Wa(P)||!P.output||!P.input&&P.avail_in!==0)return na;L=P.state,L.mode===Gs&&(L.mode=wl),Et=P.next_out,Ee=P.output,sn=P.avail_out,De=P.next_in,be=P.input,ct=P.avail_in,nt=L.hold,xt=L.bits,jn=ct,Yr=sn,ci=bl;e:for(;;)switch(L.mode){case dc:if(L.wrap===0){L.mode=wl;break}for(;xt<16;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}if(L.wrap&2&&nt===35615){L.wbits===0&&(L.wbits=15),L.check=0,Rn[0]=nt&255,Rn[1]=nt>>>8&255,L.check=_t(L.check,Rn,2,0),nt=0,xt=0,L.mode=Gc;break}if(L.head&&(L.head.done=!1),!(L.wrap&1)||(((nt&255)<<8)+(nt>>8))%31){P.msg="incorrect header check",L.mode=di;break}if((nt&15)!==Md){P.msg="unknown compression method",L.mode=di;break}if(nt>>>=4,xt-=4,ei=(nt&15)+8,L.wbits===0&&(L.wbits=ei),ei>15||ei>L.wbits){P.msg="invalid window size",L.mode=di;break}L.dmax=1<<L.wbits,L.flags=0,P.adler=L.check=1,L.mode=nt&512?Id:Gs,nt=0,xt=0;break;case Gc:for(;xt<16;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}if(L.flags=nt,(L.flags&255)!==Md){P.msg="unknown compression method",L.mode=di;break}if(L.flags&57344){P.msg="unknown header flags set",L.mode=di;break}L.head&&(L.head.text=nt>>8&1),L.flags&512&&L.wrap&4&&(Rn[0]=nt&255,Rn[1]=nt>>>8&255,L.check=_t(L.check,Rn,2,0)),nt=0,xt=0,L.mode=Uc;case Uc:for(;xt<32;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}L.head&&(L.head.time=nt),L.flags&512&&L.wrap&4&&(Rn[0]=nt&255,Rn[1]=nt>>>8&255,Rn[2]=nt>>>16&255,Rn[3]=nt>>>24&255,L.check=_t(L.check,Rn,4,0)),nt=0,xt=0,L.mode=zu;case zu:for(;xt<16;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}L.head&&(L.head.xflags=nt&255,L.head.os=nt>>8),L.flags&512&&L.wrap&4&&(Rn[0]=nt&255,Rn[1]=nt>>>8&255,L.check=_t(L.check,Rn,2,0)),nt=0,xt=0,L.mode=Nu;case Nu:if(L.flags&1024){for(;xt<16;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}L.length=nt,L.head&&(L.head.extra_len=nt),L.flags&512&&L.wrap&4&&(Rn[0]=nt&255,Rn[1]=nt>>>8&255,L.check=_t(L.check,Rn,2,0)),nt=0,xt=0}else L.head&&(L.head.extra=null);L.mode=Pu;case Pu:if(L.flags&1024&&(Br=L.length,Br>ct&&(Br=ct),Br&&(L.head&&(ei=L.head.extra_len-L.length,L.head.extra||(L.head.extra=new Uint8Array(L.head.extra_len)),L.head.extra.set(be.subarray(De,De+Br),ei)),L.flags&512&&L.wrap&4&&(L.check=_t(L.check,be,Br,De)),ct-=Br,De+=Br,L.length-=Br),L.length))break e;L.length=0,L.mode=zd;case zd:if(L.flags&2048){if(ct===0)break e;Br=0;do ei=be[De+Br++],L.head&&ei&&L.length<65536&&(L.head.name+=String.fromCharCode(ei));while(ei&&Br<ct);if(L.flags&512&&L.wrap&4&&(L.check=_t(L.check,be,Br,De)),ct-=Br,De+=Br,ei)break e}else L.head&&(L.head.name=null);L.length=0,L.mode=Nd;case Nd:if(L.flags&4096){if(ct===0)break e;Br=0;do ei=be[De+Br++],L.head&&ei&&L.length<65536&&(L.head.comment+=String.fromCharCode(ei));while(ei&&Br<ct);if(L.flags&512&&L.wrap&4&&(L.check=_t(L.check,be,Br,De)),ct-=Br,De+=Br,ei)break e}else L.head&&(L.head.comment=null);L.mode=Pd;case Pd:if(L.flags&512){for(;xt<16;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}if(L.wrap&4&&nt!==(L.check&65535)){P.msg="header crc mismatch",L.mode=di;break}nt=0,xt=0}L.head&&(L.head.hcrc=L.flags>>9&1,L.head.done=!0),P.adler=L.check=0,L.mode=Gs;break;case Id:for(;xt<32;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}P.adler=L.check=Gu(nt),nt=0,xt=0,L.mode=Vc;case Vc:if(L.havedict===0)return P.next_out=Et,P.avail_out=sn,P.next_in=De,P.avail_in=ct,L.hold=nt,L.bits=xt,Rd;P.adler=L.check=1,L.mode=Gs;case Gs:if(K===Vh||K===Bc)break e;case wl:if(L.last){nt>>>=xt&7,xt-=xt&7,L.mode=tl;break}for(;xt<3;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}switch(L.last=nt&1,nt>>>=1,xt-=1,nt&3){case 0:L.mode=Iu;break;case 1:if(Vu(L),L.mode=$c,K===Bc){nt>>>=2,xt-=2;break e}break;case 2:L.mode=Fu;break;case 3:P.msg="invalid block type",L.mode=di}nt>>>=2,xt-=2;break;case Iu:for(nt>>>=xt&7,xt-=xt&7;xt<32;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}if((nt&65535)!==(nt>>>16^65535)){P.msg="invalid stored block lengths",L.mode=di;break}if(L.length=nt&65535,nt=0,xt=0,L.mode=Wc,K===Bc)break e;case Wc:L.mode=Ou;case Ou:if(Br=L.length,Br){if(Br>ct&&(Br=ct),Br>sn&&(Br=sn),Br===0)break e;Ee.set(be.subarray(De,De+Br),Et),ct-=Br,De+=Br,sn-=Br,Et+=Br,L.length-=Br;break}L.mode=Gs;break;case Fu:for(;xt<14;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}if(L.nlen=(nt&31)+257,nt>>>=5,xt-=5,L.ndist=(nt&31)+1,nt>>>=5,xt-=5,L.ncode=(nt&15)+4,nt>>>=4,xt-=4,L.nlen>286||L.ndist>30){P.msg="too many length or distance symbols",L.mode=di;break}L.have=0,L.mode=Hc;case Hc:for(;L.have<L.ncode;){for(;xt<3;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}L.lens[wa[L.have++]]=nt&7,nt>>>=3,xt-=3}for(;L.have<19;)L.lens[wa[L.have++]]=0;if(L.lencode=L.lendyn,L.lenbits=7,Ln={bits:L.lenbits},ci=jl(Ad,L.lens,0,19,L.lencode,0,L.work,Ln),L.lenbits=Ln.bits,ci){P.msg="invalid code lengths set",L.mode=di;break}L.have=0,L.mode=Od;case Od:for(;L.have<L.nlen+L.ndist;){for(;ni=L.lencode[nt&(1<<L.lenbits)-1],An=ni>>>24,Cn=ni>>>16&255,Hr=ni&65535,!(An<=xt);){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}if(Hr<16)nt>>>=An,xt-=An,L.lens[L.have++]=Hr;else{if(Hr===16){for(Ks=An+2;xt<Ks;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}if(nt>>>=An,xt-=An,L.have===0){P.msg="invalid bit length repeat",L.mode=di;break}ei=L.lens[L.have-1],Br=3+(nt&3),nt>>>=2,xt-=2}else if(Hr===17){for(Ks=An+3;xt<Ks;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}nt>>>=An,xt-=An,ei=0,Br=3+(nt&7),nt>>>=3,xt-=3}else{for(Ks=An+7;xt<Ks;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}nt>>>=An,xt-=An,ei=0,Br=11+(nt&127),nt>>>=7,xt-=7}if(L.have+Br>L.nlen+L.ndist){P.msg="invalid bit length repeat",L.mode=di;break}for(;Br--;)L.lens[L.have++]=ei}}if(L.mode===di)break;if(L.lens[256]===0){P.msg="invalid code -- missing end-of-block",L.mode=di;break}if(L.lenbits=9,Ln={bits:L.lenbits},ci=jl(ku,L.lens,0,L.nlen,L.lencode,0,L.work,Ln),L.lenbits=Ln.bits,ci){P.msg="invalid literal/lengths set",L.mode=di;break}if(L.distbits=6,L.distcode=L.distdyn,Ln={bits:L.distbits},ci=jl(Mu,L.lens,L.nlen,L.ndist,L.distcode,0,L.work,Ln),L.distbits=Ln.bits,ci){P.msg="invalid distances set",L.mode=di;break}if(L.mode=$c,K===Bc)break e;case $c:L.mode=Va;case Va:if(ct>=6&&sn>=258){P.next_out=Et,P.avail_out=sn,P.next_in=De,P.avail_in=ct,L.hold=nt,L.bits=xt,Gh(P,Yr),Et=P.next_out,Ee=P.output,sn=P.avail_out,De=P.next_in,be=P.input,ct=P.avail_in,nt=L.hold,xt=L.bits,L.mode===Gs&&(L.back=-1);break}for(L.back=0;ni=L.lencode[nt&(1<<L.lenbits)-1],An=ni>>>24,Cn=ni>>>16&255,Hr=ni&65535,!(An<=xt);){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}if(Cn&&!(Cn&240)){for(Tn=An,ks=Cn,ii=Hr;ni=L.lencode[ii+((nt&(1<<Tn+ks)-1)>>Tn)],An=ni>>>24,Cn=ni>>>16&255,Hr=ni&65535,!(Tn+An<=xt);){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}nt>>>=Tn,xt-=Tn,L.back+=Tn}if(nt>>>=An,xt-=An,L.back+=An,L.length=Hr,Cn===0){L.mode=hc;break}if(Cn&32){L.back=-1,L.mode=Gs;break}if(Cn&64){P.msg="invalid literal/length code",L.mode=di;break}L.extra=Cn&15,L.mode=Yc;case Yc:if(L.extra){for(Ks=L.extra;xt<Ks;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}L.length+=nt&(1<<L.extra)-1,nt>>>=L.extra,xt-=L.extra,L.back+=L.extra}L.was=L.length,L.mode=Ul;case Ul:for(;ni=L.distcode[nt&(1<<L.distbits)-1],An=ni>>>24,Cn=ni>>>16&255,Hr=ni&65535,!(An<=xt);){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}if(!(Cn&240)){for(Tn=An,ks=Cn,ii=Hr;ni=L.distcode[ii+((nt&(1<<Tn+ks)-1)>>Tn)],An=ni>>>24,Cn=ni>>>16&255,Hr=ni&65535,!(Tn+An<=xt);){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}nt>>>=Tn,xt-=Tn,L.back+=Tn}if(nt>>>=An,xt-=An,L.back+=An,Cn&64){P.msg="invalid distance code",L.mode=di;break}L.offset=Hr,L.extra=Cn&15,L.mode=qc;case qc:if(L.extra){for(Ks=L.extra;xt<Ks;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}L.offset+=nt&(1<<L.extra)-1,nt>>>=L.extra,xt-=L.extra,L.back+=L.extra}if(L.offset>L.dmax){P.msg="invalid distance too far back",L.mode=di;break}L.mode=Lu;case Lu:if(sn===0)break e;if(Br=Yr-sn,L.offset>Br){if(Br=L.offset-Br,Br>L.whave&&L.sane){P.msg="invalid distance too far back",L.mode=di;break}Br>L.wnext?(Br-=L.wnext,mi=L.wsize-Br):mi=L.wnext-Br,Br>L.length&&(Br=L.length),xi=L.window}else xi=Ee,mi=Et-L.offset,Br=L.length;Br>sn&&(Br=sn),sn-=Br,L.length-=Br;do Ee[Et++]=xi[mi++];while(--Br);L.length===0&&(L.mode=Va);break;case hc:if(sn===0)break e;Ee[Et++]=L.length,sn--,L.mode=Va;break;case tl:if(L.wrap){for(;xt<32;){if(ct===0)break e;ct--,nt|=be[De++]<<xt,xt+=8}if(Yr-=sn,P.total_out+=Yr,L.total+=Yr,L.wrap&4&&Yr&&(P.adler=L.check=L.flags?_t(L.check,Ee,Yr,Et-Yr):et(L.check,Ee,Yr,Et-Yr)),Yr=sn,L.wrap&4&&(L.flags?nt:Gu(nt))!==L.check){P.msg="incorrect data check",L.mode=di;break}nt=0,xt=0}L.mode=Xc;case Xc:if(L.wrap&&L.flags){for(;xt<32;){if(ct===0)break e;ct--,nt+=be[De++]<<xt,xt+=8}if(L.wrap&4&&nt!==(L.total&4294967295)){P.msg="incorrect length check",L.mode=di;break}nt=0,xt=0}L.mode=Du;case Du:ci=Td;break e;case di:ci=Gl;break e;case Bu:return kd;case ju:default:return na}return P.next_out=Et,P.avail_out=sn,P.next_in=De,P.avail_in=ct,L.hold=nt,L.bits=xt,(L.wsize||Yr!==P.avail_out&&L.mode<di&&(L.mode<tl||K!==xl))&&fc(P,P.output,P.next_out,Yr-P.avail_out),jn-=P.avail_in,Yr-=P.avail_out,P.total_in+=jn,P.total_out+=Yr,L.total+=Yr,L.wrap&4&&Yr&&(P.adler=L.check=L.flags?_t(L.check,Ee,Yr,P.next_out-Yr):et(L.check,Ee,Yr,P.next_out-Yr)),P.data_type=L.bits+(L.last?64:0)+(L.mode===Gs?128:0)+(L.mode===$c||L.mode===Wc?256:0),(jn===0&&Yr===0||K===xl)&&ci===bl&&(ci=jc),ci},Gd=P=>{if(Wa(P))return na;let K=P.state;return K.window&&(K.window=null),P.state=null,bl},Wu=(P,K)=>{if(Wa(P))return na;const L=P.state;return L.wrap&2?(L.head=K,K.done=!1,bl):na},mc=(P,K)=>{const L=K.length;let be,Ee,De;return Wa(P)||(be=P.state,be.wrap!==0&&be.mode!==Vc)?na:be.mode===Vc&&(Ee=1,Ee=et(Ee,K,L,0),Ee!==be.check)?Gl:(De=fc(P,K,L,L),De?(be.mode=Bu,kd):(be.havedict=1,bl))};var Qc=Bd,Wl=jd,Ud=Zc,Hh=Wh,$h=Vl,Vd=pc,Kc=Gd,eu=Wu,Hu=mc,$u="pako inflate (from Nodeca project)",ka={inflateReset:Qc,inflateReset2:Wl,inflateResetKeep:Ud,inflateInit:Hh,inflateInit2:$h,inflate:Vd,inflateEnd:Kc,inflateGetHeader:eu,inflateSetDictionary:Hu,inflateInfo:$u};function Yu(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Yh=Yu;const qu=Object.prototype.toString,{Z_NO_FLUSH:qh,Z_FINISH:Xh,Z_OK:Sl,Z_STREAM_END:Ia,Z_NEED_DICT:tu,Z_STREAM_ERROR:Hl,Z_DATA_ERROR:Ma,Z_MEM_ERROR:gc}=Z;function ya(P){this.options=yl.assign({chunkSize:65536,windowBits:15,to:""},P||{});const K=this.options;K.raw&&K.windowBits>=0&&K.windowBits<16&&(K.windowBits=-K.windowBits,K.windowBits===0&&(K.windowBits=-15)),K.windowBits>=0&&K.windowBits<16&&!(P&&P.windowBits)&&(K.windowBits+=32),K.windowBits>15&&K.windowBits<48&&(K.windowBits&15||(K.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ll,this.strm.avail_out=0;let L=ka.inflateInit2(this.strm,K.windowBits);if(L!==Sl)throw new Error(Wr[L]);if(this.header=new Yh,ka.inflateGetHeader(this.strm,this.header),K.dictionary&&(typeof K.dictionary=="string"?K.dictionary=_l.string2buf(K.dictionary):qu.call(K.dictionary)==="[object ArrayBuffer]"&&(K.dictionary=new Uint8Array(K.dictionary)),K.raw&&(L=ka.inflateSetDictionary(this.strm,K.dictionary),L!==Sl)))throw new Error(Wr[L])}ya.prototype.push=function(P,K){const L=this.strm,be=this.options.chunkSize,Ee=this.options.dictionary;let De,Et,ct;if(this.ended)return!1;for(K===~~K?Et=K:Et=K===!0?Xh:qh,qu.call(P)==="[object ArrayBuffer]"?L.input=new Uint8Array(P):L.input=P,L.next_in=0,L.avail_in=L.input.length;;){for(L.avail_out===0&&(L.output=new Uint8Array(be),L.next_out=0,L.avail_out=be),De=ka.inflate(L,Et),De===tu&&Ee&&(De=ka.inflateSetDictionary(L,Ee),De===Sl?De=ka.inflate(L,Et):De===Ma&&(De=tu));L.avail_in>0&&De===Ia&&L.state.wrap>0&&P[L.next_in]!==0;)ka.inflateReset(L),De=ka.inflate(L,Et);switch(De){case Hl:case Ma:case tu:case gc:return this.onEnd(De),this.ended=!0,!1}if(ct=L.avail_out,L.next_out&&(L.avail_out===0||De===Ia))if(this.options.to==="string"){let sn=_l.utf8border(L.output,L.next_out),nt=L.next_out-sn,xt=_l.buf2string(L.output,sn);L.next_out=nt,L.avail_out=be-nt,nt&&L.output.set(L.output.subarray(sn,sn+nt),0),this.onData(xt)}else this.onData(L.output.length===L.next_out?L.output:L.output.subarray(0,L.next_out));if(!(De===Sl&&ct===0)){if(De===Ia)return De=ka.inflateEnd(this.strm),this.onEnd(De),this.ended=!0,!0;if(L.avail_in===0)break}}return!0},ya.prototype.onData=function(P){this.chunks.push(P)},ya.prototype.onEnd=function(P){P===Sl&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=yl.flattenChunks(this.chunks)),this.chunks=[],this.err=P,this.msg=this.strm.msg};function vc(P,K){const L=new ya(K);if(L.push(P),L.err)throw L.msg||Wr[L.err];return L.result}function Zh(P,K){return K=K||{},K.raw=!0,vc(P,K)}var Jh=ya,El=vc,yc=Zh,$l=vc,ru={Inflate:Jh,inflate:El,inflateRaw:yc,ungzip:$l};const{Deflate:Xu,deflate:Yl,deflateRaw:nl,gzip:vi}=jh,{Inflate:pi,inflate:il,inflateRaw:Qs,ungzip:ca}=ru;var sl=Xu,Cl=Yl,ia=nl,_c=vi,Zu=pi,Ju=il,xc=Qs,Qu=ca,Oa=Z,nu={Deflate:sl,deflate:Cl,deflateRaw:ia,gzip:_c,Inflate:Zu,inflate:Ju,inflateRaw:xc,ungzip:Qu,constants:Oa}})},__webpack_module_cache__={};function __webpack_require__(e){var r=__webpack_module_cache__[e];if(r!==void 0)return r.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(t.exports,t,t.exports,__webpack_require__),t.exports}__webpack_require__.n=e=>{var r=e&&e.__esModule?(()=>e.default):(()=>e);return __webpack_require__.d(r,{a:r}),r},__webpack_require__.d=(e,r)=>{for(var t in r)__webpack_require__.o(r,t)&&!__webpack_require__.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},__webpack_require__.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),__webpack_require__.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__("./src/index.ts"),__webpack_require__("./src/SurfaceWorker.js");var __webpack_exports__=__webpack_require__("./src/exporter.js");return __webpack_exports__})())})(_3Dmol);var _3DmolExports=_3Dmol.exports;const covalentRadii={H:.31,He:.28,Li:1.28,Be:.96,B:.84,C:.76,N:.71,O:.66,F:.57,Ne:.58,Na:1.66,Mg:1.41,Al:1.21,Si:1.11,P:1.07,S:1.05,Cl:1.02,Ar:1.06,K:2.03,Ca:1.76,Sc:1.7,Ti:1.6,V:1.53,Cr:1.39,Mn:1.61,Fe:1.52,Co:1.5,Ni:1.24,Cu:1.32,Zn:1.22,Ga:1.22,Ge:1.2,As:1.19,Se:1.2,Br:1.2,Kr:1.16,Rb:2.2,Sr:1.95,Y:1.9,Zr:1.75,Nb:1.64,Mo:1.54,Tc:1.47,Ru:1.46,Rh:1.42,Pd:1.39,Ag:1.45,Cd:1.44,In:1.42,Sn:1.39,Sb:1.39,Te:1.38,I:1.39,Xe:1.4,Cs:2.44,Ba:2.15,La:2.07,Ce:2.04,Pr:2.03,Nd:2.01,Pm:1.99,Sm:1.98,Eu:1.98,Gd:1.96,Tb:1.94,Dy:1.92,Ho:1.92,Er:1.89,Tm:1.9,Yb:1.87,Lu:1.75,Hf:1.87,Ta:1.7,W:1.62,Re:1.51,Os:1.44,Ir:1.41,Pt:1.36,Au:1.36,Hg:1.32,Tl:1.45,Pb:1.46,Bi:1.48,Po:1.4,At:1.5,Rn:1.5,Fr:2.6,Ra:2.21,Ac:2.15,Th:2.06,Pa:2,U:1.96,Np:1.9,Pu:1.87,Am:1.8,Cm:1.69};function mod(e,r){return(e%r+r)%r}function setCustomBondLengths(){function e(r,t){_3DmolExports.setBondLength(r,t)}Object.keys(covalentRadii).forEach(r=>{e(r,1.05*covalentRadii[r])})}class Visualizer3dmol extends React.Component{constructor(r){super(r),setCustomBondLengths(),this.viewer=null,this.model=null,this.divId="gldiv-"+(Math.random()+1).toString(36).substring(7)}componentDidMount(){let r={backgroundColor:"white",orthographic:!0};this.viewer=_3DmolExports.createViewer(this.divId,r),this.updateView()}componentDidUpdate(r){(r.viewerParams!=this.props.viewerParams||r.cifText!=this.props.cifText)&&this.updateView()}custom3dmolSetup(){if(this.model=this.viewer.addModel(),this.props.cifText){let r=_3DmolExports.Parsers.CIF(this.props.cifText),t=r[0],a=r.modelData[0].cryst;this.model.setCrystData(a.a,a.b,a.c,a.alpha,a.beta,a.gamma);let c=this.model.modelData.cryst.matrix,h=new _3DmolExports.Matrix3().getInverse3(c),_=[],f=[];t.forEach(p=>{let E=new _3DmolExports.Vector3(p.x,p.y,p.z);if(this.props.viewerParams.packedCell){let M=E.clone().applyMatrix3(h);E=new _3DmolExports.Vector3(mod(M.x,1),mod(M.y,1),mod(M.z,1)).applyMatrix3(c)}f.push({elem:p.elem,x:E.x,y:E.y,z:E.z})});let g=.03,b=this.props.viewerParams.supercell;for(let p=-1;p<b[0]+1;p++)for(let E=-1;E<b[1]+1;E++)for(let M=-1;M<b[2]+1;M++){let R=new _3DmolExports.Vector3(p,E,M);if(R.applyMatrix3(c),p==-1||p==b[0]||E==-1||E==b[1]||M==-1||M==b[2])if(this.props.viewerParams.packedCell)f.forEach(z=>{let l=new _3DmolExports.Vector3(z.x,z.y,z.z);l.add(R);let s=l.clone().applyMatrix3(h);s.x>-g&&s.x<b[0]+g&&s.y>-g&&s.y<b[1]+g&&s.z>-g&&s.z<b[2]+g&&_.push({elem:z.elem,x:l.x,y:l.y,z:l.z})});else continue;else f.forEach(z=>{_.push({elem:z.elem,x:z.x+R.x,y:z.y+R.y,z:z.z+R.z})})}this.model.addAtoms(_)}}updateView(){this.viewer.removeAllModels(),this.custom3dmolSetup();let r={sphere:{scale:.3,colorscheme:"Jmol"}};this.props.viewerParams.vdwRadius&&(r.sphere.scale=1),this.props.viewerParams.bonds&&(r.stick={radius:.15,colorscheme:"Jmol"}),this.viewer.setStyle(r),this.viewer.addUnitCell(this.model),this.model.assignBonds(),this.viewer.removeAllLabels(),this.props.viewerParams.atomLabels&&this.model.atoms.forEach(t=>{this.viewer.addLabel(t.elem,{position:{x:t.x,y:t.y,z:t.z},fontColor:"black",bold:!0,fontSize:18,showBackground:!1,backgroundOpacity:1,inFront:!0},null,!0)}),this.viewer.zoomTo(),this.viewer.zoom(1.4),this.viewer.render()}handleEvent(r,t){r=="camera"&&(t=="x"&&this.viewer.setView([0,0,0,0,-.5,-.5,-.5,.5]),t=="y"&&this.viewer.setView([0,0,0,0,.5,.5,.5,.5]),t=="z"&&this.viewer.setView([0,0,0,0,0,0,0,1]),this.viewer.zoomTo(),this.viewer.zoom(1.4))}render(){return jsxRuntimeExports.jsx("div",{id:this.divId,className:"gldiv",children:"No data!"})}}class StructureWindow extends React.Component{constructor(r){super(r)}render(){let r="structure-window";this.props.mouseEnabled||(r+=" disable-mouse");let t="Click to interact",a="mouse-disabled-note";return this.props.mouseEnabled&&(a="mouse-disabled-note on"),jsxRuntimeExports.jsxs("div",{className:"structure-window-outer",children:[jsxRuntimeExports.jsx("div",{className:"structure-window-click-handler",onClick:()=>this.props.setMouseEnabledState(!0),children:jsxRuntimeExports.jsx("div",{className:r,children:jsxRuntimeExports.jsx(Visualizer3dmol,{ref:this.props.visualizerRef,viewerParams:this.props.viewerParams,cifText:this.props.cifText})})}),jsxRuntimeExports.jsx("div",{className:a,onClick:()=>this.props.setMouseEnabledState(!this.props.mouseEnabled),children:t})]})}}const StructureVisualizer=e=>{const[r,t]=reactExports.useState({supercell:e.initSupercell||[2,2,2],bonds:!0,packedCell:!0,atomLabels:!1,vdwRadius:!1}),[a,c]=reactExports.useState(!1),h=reactExports.useRef(null),_=reactExports.useRef(null);reactExports.useEffect(()=>{const p=E=>{_&&!_.current.contains(E.target)&&c(!1)};return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)}},[]);const f=p=>{c(p)},g=(p,E)=>{t(M=>({...M,[p]:E}))},b=(p,E)=>{h.current.handleEvent(p,E)};return jsxRuntimeExports.jsxs("div",{ref:_,className:"structure-visualizer",children:[jsxRuntimeExports.jsx(StructureWindow,{visualizerRef:h,viewerParams:r,cifText:e.cifText,mouseEnabled:a,setMouseEnabledState:f}),jsxRuntimeExports.jsx(ControlBox,{viewerParams:r,onViewerParamChange:g,onViewerEvent:b})]})};function cn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ve={exports:{}},ae={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sn;function ri(){if(Sn)return ae;Sn=1;var e=React,r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h={key:!0,ref:!0,__self:!0,__source:!0};function _(f,g,b){var p,E={},M=null,R=null;b!==void 0&&(M=""+b),g.key!==void 0&&(M=""+g.key),g.ref!==void 0&&(R=g.ref);for(p in g)a.call(g,p)&&!h.hasOwnProperty(p)&&(E[p]=g[p]);if(f&&f.defaultProps)for(p in g=f.defaultProps,g)E[p]===void 0&&(E[p]=g[p]);return{$$typeof:r,type:f,key:M,ref:R,props:E,_owner:c.current}}return ae.Fragment=t,ae.jsx=_,ae.jsxs=_,ae}Ve.exports=ri();var T=Ve.exports;function We(e,r){if(e.contains)return e.contains(r);if(e.compareDocumentPosition)return e===r||!!(e.compareDocumentPosition(r)&16)}var Je={exports:{}},ze,Mn;function un(){if(Mn)return ze;Mn=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ze=e,ze}var He,Nn;function _i(){if(Nn)return He;Nn=1;var e=un();function r(){}function t(){}return t.resetWarningCache=r,He=function(){function a(_,f,g,b,p,E){if(E!==e){var M=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw M.name="Invariant Violation",M}}a.isRequired=a;function c(){return a}var h={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:c,element:a,elementType:a,instanceOf:c,node:a,objectOf:c,oneOf:c,oneOfType:c,shape:c,exact:c,checkPropTypes:t,resetWarningCache:r};return h.PropTypes=h,h},He}Je.exports=_i()();var yi=Je.exports;const N=cn(yi);function ur(){const e=reactExports.useRef(!0),r=reactExports.useRef(()=>e.current);return reactExports.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),r.current}function bi(e){const r=reactExports.useRef(e);return r.current=e,r}function Pi(e){const r=bi(e);reactExports.useEffect(()=>()=>r.current(),[])}const Ge=2**31-1;function lr(e,r,t){const a=t-Date.now();e.current=a<=Ge?setTimeout(r,a):setTimeout(()=>lr(e,r,t),Ge)}function wi(){const e=ur(),r=reactExports.useRef();return Pi(()=>clearTimeout(r.current)),reactExports.useMemo(()=>{const t=()=>clearTimeout(r.current);function a(c,h=0){e()&&(t(),h<=Ge?r.current=setTimeout(c,h):lr(r,c,Date.now()+h))}return{set:a,clear:t,handleRef:r}},[])}var fr=function(){},Ai=fr;const dr=cn(Ai);function Oi(e,r){if(e==null)return{};var t={},a=Object.keys(e),c,h;for(h=0;h<a.length;h++)c=a[h],!(r.indexOf(c)>=0)&&(t[c]=e[c]);return t}function Ri(e,r,t){var a=reactExports.useRef(e!==void 0),c=reactExports.useState(r),h=c[0],_=c[1],f=e!==void 0,g=a.current;return a.current=f,!f&&g&&h!==r&&_(r),[f?e:h,reactExports.useCallback(function(b){for(var p=arguments.length,E=new Array(p>1?p-1:0),M=1;M<p;M++)E[M-1]=arguments[M];t&&t.apply(void 0,[b].concat(E)),_(b)},[t])]}function qe(e,r){return qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,a){return t.__proto__=a,t},qe(e,r)}function Ci(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,qe(e,r)}const Zn=e=>!e||typeof e=="function"?e:r=>{e.current=r};function Ti(e,r){const t=Zn(e),a=Zn(r);return c=>{t&&t(c),a&&a(c)}}function ne(e,r){return reactExports.useMemo(()=>Ti(e,r),[e,r])}var pr={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var r={}.hasOwnProperty;function t(){for(var h="",_=0;_<arguments.length;_++){var f=arguments[_];f&&(h=c(h,a(f)))}return h}function a(h){if(typeof h=="string"||typeof h=="number")return h;if(typeof h!="object")return"";if(Array.isArray(h))return t.apply(null,h);if(h.toString!==Object.prototype.toString&&!h.toString.toString().includes("[native code]"))return h.toString();var _="";for(var f in h)r.call(h,f)&&h[f]&&(_=c(_,f));return _}function c(h,_){return _?h?h+" "+_:h+_:h}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(pr);var Si=pr.exports;const Ut=cn(Si);function Hn(){return reactExports.useState(null)}var Un=Object.prototype.hasOwnProperty;function Yn(e,r,t){for(t of e.keys())if(fe(t,r))return t}function fe(e,r){var t,a,c;if(e===r)return!0;if(e&&r&&(t=e.constructor)===r.constructor){if(t===Date)return e.getTime()===r.getTime();if(t===RegExp)return e.toString()===r.toString();if(t===Array){if((a=e.length)===r.length)for(;a--&&fe(e[a],r[a]););return a===-1}if(t===Set){if(e.size!==r.size)return!1;for(a of e)if(c=a,c&&typeof c=="object"&&(c=Yn(r,c),!c)||!r.has(c))return!1;return!0}if(t===Map){if(e.size!==r.size)return!1;for(a of e)if(c=a[0],c&&typeof c=="object"&&(c=Yn(r,c),!c)||!fe(a[1],r.get(c)))return!1;return!0}if(t===ArrayBuffer)e=new Uint8Array(e),r=new Uint8Array(r);else if(t===DataView){if((a=e.byteLength)===r.byteLength)for(;a--&&e.getInt8(a)===r.getInt8(a););return a===-1}if(ArrayBuffer.isView(e)){if((a=e.byteLength)===r.byteLength)for(;a--&&e[a]===r[a];);return a===-1}if(!t||typeof e=="object"){a=0;for(t in e)if(Un.call(e,t)&&++a&&!Un.call(r,t)||!(t in r)||!fe(e[t],r[t]))return!1;return Object.keys(r).length===a}}return e!==e&&r!==r}function ki(e){const r=ur();return[e[0],reactExports.useCallback(t=>{if(r())return e[1](t)},[r,e[1]])]}var dt="top",yt="bottom",bt="right",pt="left",ln="auto",he=[dt,yt,bt,pt],$t="start",ge="end",Ii="clippingParents",mr="viewport",ue="popper",ji="reference",Vn=he.reduce(function(e,r){return e.concat([r+"-"+$t,r+"-"+ge])},[]),gr=[].concat(he,[ln]).reduce(function(e,r){return e.concat([r,r+"-"+$t,r+"-"+ge])},[]),Di="beforeRead",Fi="read",Mi="afterRead",Bi="beforeMain",zi="main",Li="afterMain",Ni="beforeWrite",Zi="write",Hi="afterWrite",Ui=[Di,Fi,Mi,Bi,zi,Li,Ni,Zi,Hi];function Pt(e){return e.split("-")[0]}function gt(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var r=e.ownerDocument;return r&&r.defaultView||window}return e}function Zt(e){var r=gt(e).Element;return e instanceof r||e instanceof Element}function wt(e){var r=gt(e).HTMLElement;return e instanceof r||e instanceof HTMLElement}function fn(e){if(typeof ShadowRoot>"u")return!1;var r=gt(e).ShadowRoot;return e instanceof r||e instanceof ShadowRoot}var Nt=Math.max,Te=Math.min,Qt=Math.round;function Ke(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(r){return r.brand+"/"+r.version}).join(" "):navigator.userAgent}function _r(){return!/^((?!chrome|android).)*safari/i.test(Ke())}function Xt(e,r,t){r===void 0&&(r=!1),t===void 0&&(t=!1);var a=e.getBoundingClientRect(),c=1,h=1;r&&wt(e)&&(c=e.offsetWidth>0&&Qt(a.width)/e.offsetWidth||1,h=e.offsetHeight>0&&Qt(a.height)/e.offsetHeight||1);var _=Zt(e)?gt(e):window,f=_.visualViewport,g=!_r()&&t,b=(a.left+(g&&f?f.offsetLeft:0))/c,p=(a.top+(g&&f?f.offsetTop:0))/h,E=a.width/c,M=a.height/h;return{width:E,height:M,top:p,right:b+E,bottom:p+M,left:b,x:b,y:p}}function dn(e){var r=Xt(e),t=e.offsetWidth,a=e.offsetHeight;return Math.abs(r.width-t)<=1&&(t=r.width),Math.abs(r.height-a)<=1&&(a=r.height),{x:e.offsetLeft,y:e.offsetTop,width:t,height:a}}function vr(e,r){var t=r.getRootNode&&r.getRootNode();if(e.contains(r))return!0;if(t&&fn(t)){var a=r;do{if(a&&e.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function It(e){return e?(e.nodeName||"").toLowerCase():null}function Rt(e){return gt(e).getComputedStyle(e)}function Yi(e){return["table","td","th"].indexOf(It(e))>=0}function Dt(e){return((Zt(e)?e.ownerDocument:e.document)||window.document).documentElement}function ke(e){return It(e)==="html"?e:e.assignedSlot||e.parentNode||(fn(e)?e.host:null)||Dt(e)}function Wn(e){return!wt(e)||Rt(e).position==="fixed"?null:e.offsetParent}function Vi(e){var r=/firefox/i.test(Ke()),t=/Trident/i.test(Ke());if(t&&wt(e)){var a=Rt(e);if(a.position==="fixed")return null}var c=ke(e);for(fn(c)&&(c=c.host);wt(c)&&["html","body"].indexOf(It(c))<0;){var h=Rt(c);if(h.transform!=="none"||h.perspective!=="none"||h.contain==="paint"||["transform","perspective"].indexOf(h.willChange)!==-1||r&&h.willChange==="filter"||r&&h.filter&&h.filter!=="none")return c;c=c.parentNode}return null}function ye(e){for(var r=gt(e),t=Wn(e);t&&Yi(t)&&Rt(t).position==="static";)t=Wn(t);return t&&(It(t)==="html"||It(t)==="body"&&Rt(t).position==="static")?r:t||Vi(e)||r}function pn(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function de(e,r,t){return Nt(e,Te(r,t))}function Wi(e,r,t){var a=de(e,r,t);return a>t?t:a}function hr(){return{top:0,right:0,bottom:0,left:0}}function yr(e){return Object.assign({},hr(),e)}function br(e,r){return r.reduce(function(t,a){return t[a]=e,t},{})}var Ji=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,yr(typeof e!="number"?e:br(e,he))};function Gi(e){var r,t=e.state,a=e.name,c=e.options,h=t.elements.arrow,_=t.modifiersData.popperOffsets,f=Pt(t.placement),g=pn(f),b=[pt,bt].indexOf(f)>=0,p=b?"height":"width";if(!(!h||!_)){var E=Ji(c.padding,t),M=dn(h),R=g==="y"?dt:pt,z=g==="y"?yt:bt,l=t.rects.reference[p]+t.rects.reference[g]-_[g]-t.rects.popper[p],s=_[g]-t.rects.reference[g],v=ye(h),w=v?g==="y"?v.clientHeight||0:v.clientWidth||0:0,S=l/2-s/2,A=E[R],u=w-M[p]-E[z],y=w/2-M[p]/2+S,C=de(A,y,u),k=g;t.modifiersData[a]=(r={},r[k]=C,r.centerOffset=C-y,r)}}function qi(e){var r=e.state,t=e.options,a=t.element,c=a===void 0?"[data-popper-arrow]":a;c!=null&&(typeof c=="string"&&(c=r.elements.popper.querySelector(c),!c)||vr(r.elements.popper,c)&&(r.elements.arrow=c))}const Ki={name:"arrow",enabled:!0,phase:"main",fn:Gi,effect:qi,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function te(e){return e.split("-")[1]}var $i={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Qi(e,r){var t=e.x,a=e.y,c=r.devicePixelRatio||1;return{x:Qt(t*c)/c||0,y:Qt(a*c)/c||0}}function Jn(e){var r,t=e.popper,a=e.popperRect,c=e.placement,h=e.variation,_=e.offsets,f=e.position,g=e.gpuAcceleration,b=e.adaptive,p=e.roundOffsets,E=e.isFixed,M=_.x,R=M===void 0?0:M,z=_.y,l=z===void 0?0:z,s=typeof p=="function"?p({x:R,y:l}):{x:R,y:l};R=s.x,l=s.y;var v=_.hasOwnProperty("x"),w=_.hasOwnProperty("y"),S=pt,A=dt,u=window;if(b){var y=ye(t),C="clientHeight",k="clientWidth";if(y===gt(t)&&(y=Dt(t),Rt(y).position!=="static"&&f==="absolute"&&(C="scrollHeight",k="scrollWidth")),y=y,c===dt||(c===pt||c===bt)&&h===ge){A=yt;var I=E&&y===u&&u.visualViewport?u.visualViewport.height:y[C];l-=I-a.height,l*=g?1:-1}if(c===pt||(c===dt||c===yt)&&h===ge){S=bt;var O=E&&y===u&&u.visualViewport?u.visualViewport.width:y[k];R-=O-a.width,R*=g?1:-1}}var D=Object.assign({position:f},b&&$i),X=p===!0?Qi({x:R,y:l},gt(t)):{x:R,y:l};if(R=X.x,l=X.y,g){var j;return Object.assign({},D,(j={},j[A]=w?"0":"",j[S]=v?"0":"",j.transform=(u.devicePixelRatio||1)<=1?"translate("+R+"px, "+l+"px)":"translate3d("+R+"px, "+l+"px, 0)",j))}return Object.assign({},D,(r={},r[A]=w?l+"px":"",r[S]=v?R+"px":"",r.transform="",r))}function Xi(e){var r=e.state,t=e.options,a=t.gpuAcceleration,c=a===void 0?!0:a,h=t.adaptive,_=h===void 0?!0:h,f=t.roundOffsets,g=f===void 0?!0:f,b={placement:Pt(r.placement),variation:te(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:c,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,Jn(Object.assign({},b,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:_,roundOffsets:g})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,Jn(Object.assign({},b,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:g})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}const to={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Xi,data:{}};var Ae={passive:!0};function eo(e){var r=e.state,t=e.instance,a=e.options,c=a.scroll,h=c===void 0?!0:c,_=a.resize,f=_===void 0?!0:_,g=gt(r.elements.popper),b=[].concat(r.scrollParents.reference,r.scrollParents.popper);return h&&b.forEach(function(p){p.addEventListener("scroll",t.update,Ae)}),f&&g.addEventListener("resize",t.update,Ae),function(){h&&b.forEach(function(p){p.removeEventListener("scroll",t.update,Ae)}),f&&g.removeEventListener("resize",t.update,Ae)}}const no={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:eo,data:{}};var ro={left:"right",right:"left",bottom:"top",top:"bottom"};function Re(e){return e.replace(/left|right|bottom|top/g,function(r){return ro[r]})}var io={start:"end",end:"start"};function Gn(e){return e.replace(/start|end/g,function(r){return io[r]})}function mn(e){var r=gt(e),t=r.pageXOffset,a=r.pageYOffset;return{scrollLeft:t,scrollTop:a}}function gn(e){return Xt(Dt(e)).left+mn(e).scrollLeft}function oo(e,r){var t=gt(e),a=Dt(e),c=t.visualViewport,h=a.clientWidth,_=a.clientHeight,f=0,g=0;if(c){h=c.width,_=c.height;var b=_r();(b||!b&&r==="fixed")&&(f=c.offsetLeft,g=c.offsetTop)}return{width:h,height:_,x:f+gn(e),y:g}}function so(e){var r,t=Dt(e),a=mn(e),c=(r=e.ownerDocument)==null?void 0:r.body,h=Nt(t.scrollWidth,t.clientWidth,c?c.scrollWidth:0,c?c.clientWidth:0),_=Nt(t.scrollHeight,t.clientHeight,c?c.scrollHeight:0,c?c.clientHeight:0),f=-a.scrollLeft+gn(e),g=-a.scrollTop;return Rt(c||t).direction==="rtl"&&(f+=Nt(t.clientWidth,c?c.clientWidth:0)-h),{width:h,height:_,x:f,y:g}}function _n(e){var r=Rt(e),t=r.overflow,a=r.overflowX,c=r.overflowY;return/auto|scroll|overlay|hidden/.test(t+c+a)}function Pr(e){return["html","body","#document"].indexOf(It(e))>=0?e.ownerDocument.body:wt(e)&&_n(e)?e:Pr(ke(e))}function pe(e,r){var t;r===void 0&&(r=[]);var a=Pr(e),c=a===((t=e.ownerDocument)==null?void 0:t.body),h=gt(a),_=c?[h].concat(h.visualViewport||[],_n(a)?a:[]):a,f=r.concat(_);return c?f:f.concat(pe(ke(_)))}function $e(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function ao(e,r){var t=Xt(e,!1,r==="fixed");return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function qn(e,r,t){return r===mr?$e(oo(e,t)):Zt(r)?ao(r,t):$e(so(Dt(e)))}function co(e){var r=pe(ke(e)),t=["absolute","fixed"].indexOf(Rt(e).position)>=0,a=t&&wt(e)?ye(e):e;return Zt(a)?r.filter(function(c){return Zt(c)&&vr(c,a)&&It(c)!=="body"}):[]}function uo(e,r,t,a){var c=r==="clippingParents"?co(e):[].concat(r),h=[].concat(c,[t]),_=h[0],f=h.reduce(function(g,b){var p=qn(e,b,a);return g.top=Nt(p.top,g.top),g.right=Te(p.right,g.right),g.bottom=Te(p.bottom,g.bottom),g.left=Nt(p.left,g.left),g},qn(e,_,a));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function wr(e){var r=e.reference,t=e.element,a=e.placement,c=a?Pt(a):null,h=a?te(a):null,_=r.x+r.width/2-t.width/2,f=r.y+r.height/2-t.height/2,g;switch(c){case dt:g={x:_,y:r.y-t.height};break;case yt:g={x:_,y:r.y+r.height};break;case bt:g={x:r.x+r.width,y:f};break;case pt:g={x:r.x-t.width,y:f};break;default:g={x:r.x,y:r.y}}var b=c?pn(c):null;if(b!=null){var p=b==="y"?"height":"width";switch(h){case $t:g[b]=g[b]-(r[p]/2-t[p]/2);break;case ge:g[b]=g[b]+(r[p]/2-t[p]/2);break}}return g}function _e(e,r){r===void 0&&(r={});var t=r,a=t.placement,c=a===void 0?e.placement:a,h=t.strategy,_=h===void 0?e.strategy:h,f=t.boundary,g=f===void 0?Ii:f,b=t.rootBoundary,p=b===void 0?mr:b,E=t.elementContext,M=E===void 0?ue:E,R=t.altBoundary,z=R===void 0?!1:R,l=t.padding,s=l===void 0?0:l,v=yr(typeof s!="number"?s:br(s,he)),w=M===ue?ji:ue,S=e.rects.popper,A=e.elements[z?w:M],u=uo(Zt(A)?A:A.contextElement||Dt(e.elements.popper),g,p,_),y=Xt(e.elements.reference),C=wr({reference:y,element:S,placement:c}),k=$e(Object.assign({},S,C)),I=M===ue?k:y,O={top:u.top-I.top+v.top,bottom:I.bottom-u.bottom+v.bottom,left:u.left-I.left+v.left,right:I.right-u.right+v.right},D=e.modifiersData.offset;if(M===ue&&D){var X=D[c];Object.keys(O).forEach(function(j){var B=[bt,yt].indexOf(j)>=0?1:-1,$=[dt,yt].indexOf(j)>=0?"y":"x";O[j]+=X[$]*B})}return O}function lo(e,r){r===void 0&&(r={});var t=r,a=t.placement,c=t.boundary,h=t.rootBoundary,_=t.padding,f=t.flipVariations,g=t.allowedAutoPlacements,b=g===void 0?gr:g,p=te(a),E=p?f?Vn:Vn.filter(function(z){return te(z)===p}):he,M=E.filter(function(z){return b.indexOf(z)>=0});M.length===0&&(M=E);var R=M.reduce(function(z,l){return z[l]=_e(e,{placement:l,boundary:c,rootBoundary:h,padding:_})[Pt(l)],z},{});return Object.keys(R).sort(function(z,l){return R[z]-R[l]})}function fo(e){if(Pt(e)===ln)return[];var r=Re(e);return[Gn(e),r,Gn(r)]}function po(e){var r=e.state,t=e.options,a=e.name;if(!r.modifiersData[a]._skip){for(var c=t.mainAxis,h=c===void 0?!0:c,_=t.altAxis,f=_===void 0?!0:_,g=t.fallbackPlacements,b=t.padding,p=t.boundary,E=t.rootBoundary,M=t.altBoundary,R=t.flipVariations,z=R===void 0?!0:R,l=t.allowedAutoPlacements,s=r.options.placement,v=Pt(s),w=v===s,S=g||(w||!z?[Re(s)]:fo(s)),A=[s].concat(S).reduce(function(ce,Ne){return ce.concat(Pt(Ne)===ln?lo(r,{placement:Ne,boundary:p,rootBoundary:E,padding:b,flipVariations:z,allowedAutoPlacements:l}):Ne)},[]),u=r.rects.reference,y=r.rects.popper,C=new Map,k=!0,I=A[0],O=0;O<A.length;O++){var D=A[O],X=Pt(D),j=te(D)===$t,B=[dt,yt].indexOf(X)>=0,$=B?"width":"height",H=_e(r,{placement:D,boundary:p,rootBoundary:E,altBoundary:M,padding:b}),q=B?j?bt:pt:j?yt:dt;u[$]>y[$]&&(q=Re(q));var W=Re(q),Y=[];if(h&&Y.push(H[X]<=0),f&&Y.push(H[q]<=0,H[W]<=0),Y.every(function(ce){return ce})){I=D,k=!1;break}C.set(D,Y)}if(k)for(var G=z?3:1,V=function(ce){var Ne=A.find(function(Pe){var Fe=C.get(Pe);if(Fe)return Fe.slice(0,ce).every(function(Me){return Me})});if(Ne)return I=Ne,"break"},Q=G;Q>0;Q--){var xe=V(Q);if(xe==="break")break}r.placement!==I&&(r.modifiersData[a]._skip=!0,r.placement=I,r.reset=!0)}}const mo={name:"flip",enabled:!0,phase:"main",fn:po,requiresIfExists:["offset"],data:{_skip:!1}};function Kn(e,r,t){return t===void 0&&(t={x:0,y:0}),{top:e.top-r.height-t.y,right:e.right-r.width+t.x,bottom:e.bottom-r.height+t.y,left:e.left-r.width-t.x}}function $n(e){return[dt,bt,yt,pt].some(function(r){return e[r]>=0})}function go(e){var r=e.state,t=e.name,a=r.rects.reference,c=r.rects.popper,h=r.modifiersData.preventOverflow,_=_e(r,{elementContext:"reference"}),f=_e(r,{altBoundary:!0}),g=Kn(_,a),b=Kn(f,c,h),p=$n(g),E=$n(b);r.modifiersData[t]={referenceClippingOffsets:g,popperEscapeOffsets:b,isReferenceHidden:p,hasPopperEscaped:E},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":p,"data-popper-escaped":E})}const _o={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:go};function vo(e,r,t){var a=Pt(e),c=[pt,dt].indexOf(a)>=0?-1:1,h=typeof t=="function"?t(Object.assign({},r,{placement:e})):t,_=h[0],f=h[1];return _=_||0,f=(f||0)*c,[pt,bt].indexOf(a)>=0?{x:f,y:_}:{x:_,y:f}}function ho(e){var r=e.state,t=e.options,a=e.name,c=t.offset,h=c===void 0?[0,0]:c,_=gr.reduce(function(p,E){return p[E]=vo(E,r.rects,h),p},{}),f=_[r.placement],g=f.x,b=f.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=g,r.modifiersData.popperOffsets.y+=b),r.modifiersData[a]=_}const yo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:ho};function bo(e){var r=e.state,t=e.name;r.modifiersData[t]=wr({reference:r.rects.reference,element:r.rects.popper,placement:r.placement})}const Po={name:"popperOffsets",enabled:!0,phase:"read",fn:bo,data:{}};function wo(e){return e==="x"?"y":"x"}function Eo(e){var r=e.state,t=e.options,a=e.name,c=t.mainAxis,h=c===void 0?!0:c,_=t.altAxis,f=_===void 0?!1:_,g=t.boundary,b=t.rootBoundary,p=t.altBoundary,E=t.padding,M=t.tether,R=M===void 0?!0:M,z=t.tetherOffset,l=z===void 0?0:z,s=_e(r,{boundary:g,rootBoundary:b,padding:E,altBoundary:p}),v=Pt(r.placement),w=te(r.placement),S=!w,A=pn(v),u=wo(A),y=r.modifiersData.popperOffsets,C=r.rects.reference,k=r.rects.popper,I=typeof l=="function"?l(Object.assign({},r.rects,{placement:r.placement})):l,O=typeof I=="number"?{mainAxis:I,altAxis:I}:Object.assign({mainAxis:0,altAxis:0},I),D=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,X={x:0,y:0};if(y){if(h){var j,B=A==="y"?dt:pt,$=A==="y"?yt:bt,H=A==="y"?"height":"width",q=y[A],W=q+s[B],Y=q-s[$],G=R?-k[H]/2:0,V=w===$t?C[H]:k[H],Q=w===$t?-k[H]:-C[H],xe=r.elements.arrow,ce=R&&xe?dn(xe):{width:0,height:0},Ne=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:hr(),Pe=Ne[B],Fe=Ne[$],Me=de(0,C[H],ce[H]),je=S?C[H]/2-G-Me-Pe-O.mainAxis:V-Me-Pe-O.mainAxis,ft=S?-C[H]/2+G+Me+Fe+O.mainAxis:Q+Me+Fe+O.mainAxis,jt=r.elements.arrow&&ye(r.elements.arrow),Gt=jt?A==="y"?jt.clientTop||0:jt.clientLeft||0:0,mt=(j=D?.[A])!=null?j:0,Le=q+je-mt-Gt,ht=q+ft-mt,ar=de(R?Te(W,Le):W,q,R?Nt(Y,ht):Y);y[A]=ar,X[A]=ar-q}if(f){var Jt,Wt=A==="x"?dt:pt,Gr=A==="x"?yt:bt,Lr=y[u],zr=u==="y"?"height":"width",Nr=Lr+s[Wt],At=Lr-s[Gr],Mt=[dt,pt].indexOf(v)!==-1,Jr=(Jt=D?.[u])!=null?Jt:0,qr=Mt?Nr:Lr-C[zr]-k[zr]-Jr+O.altAxis,ie=Mt?Lr+C[zr]+k[zr]-Jr-O.altAxis:At,ve=R&&Mt?Wi(qr,Lr,ie):de(R?qr:Nr,Lr,R?ie:At);y[u]=ve,X[u]=ve-Lr}r.modifiersData[a]=X}}const xo={name:"preventOverflow",enabled:!0,phase:"main",fn:Eo,requiresIfExists:["offset"]};function Ao(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function Oo(e){return e===gt(e)||!wt(e)?mn(e):Ao(e)}function Ro(e){var r=e.getBoundingClientRect(),t=Qt(r.width)/e.offsetWidth||1,a=Qt(r.height)/e.offsetHeight||1;return t!==1||a!==1}function Co(e,r,t){t===void 0&&(t=!1);var a=wt(r),c=wt(r)&&Ro(r),h=Dt(r),_=Xt(e,c,t),f={scrollLeft:0,scrollTop:0},g={x:0,y:0};return(a||!a&&!t)&&((It(r)!=="body"||_n(h))&&(f=Oo(r)),wt(r)?(g=Xt(r,!0),g.x+=r.clientLeft,g.y+=r.clientTop):h&&(g.x=gn(h))),{x:_.left+f.scrollLeft-g.x,y:_.top+f.scrollTop-g.y,width:_.width,height:_.height}}function To(e){var r=new Map,t=new Set,a=[];e.forEach(function(h){r.set(h.name,h)});function c(h){t.add(h.name);var _=[].concat(h.requires||[],h.requiresIfExists||[]);_.forEach(function(f){if(!t.has(f)){var g=r.get(f);g&&c(g)}}),a.push(h)}return e.forEach(function(h){t.has(h.name)||c(h)}),a}function So(e){var r=To(e);return Ui.reduce(function(t,a){return t.concat(r.filter(function(c){return c.phase===a}))},[])}function ko(e){var r;return function(){return r||(r=new Promise(function(t){Promise.resolve().then(function(){r=void 0,t(e())})})),r}}function Io(e){var r=e.reduce(function(t,a){var c=t[a.name];return t[a.name]=c?Object.assign({},c,a,{options:Object.assign({},c.options,a.options),data:Object.assign({},c.data,a.data)}):a,t},{});return Object.keys(r).map(function(t){return r[t]})}var Qn={placement:"bottom",modifiers:[],strategy:"absolute"};function Xn(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return!r.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function jo(e){e===void 0&&(e={});var r=e,t=r.defaultModifiers,a=t===void 0?[]:t,c=r.defaultOptions,h=c===void 0?Qn:c;return function(_,f,g){g===void 0&&(g=h);var b={placement:"bottom",orderedModifiers:[],options:Object.assign({},Qn,h),modifiersData:{},elements:{reference:_,popper:f},attributes:{},styles:{}},p=[],E=!1,M={state:b,setOptions:function(l){var s=typeof l=="function"?l(b.options):l;z(),b.options=Object.assign({},h,b.options,s),b.scrollParents={reference:Zt(_)?pe(_):_.contextElement?pe(_.contextElement):[],popper:pe(f)};var v=So(Io([].concat(a,b.options.modifiers)));return b.orderedModifiers=v.filter(function(w){return w.enabled}),R(),M.update()},forceUpdate:function(){if(!E){var l=b.elements,s=l.reference,v=l.popper;if(Xn(s,v)){b.rects={reference:Co(s,ye(v),b.options.strategy==="fixed"),popper:dn(v)},b.reset=!1,b.placement=b.options.placement,b.orderedModifiers.forEach(function(k){return b.modifiersData[k.name]=Object.assign({},k.data)});for(var w=0;w<b.orderedModifiers.length;w++){if(b.reset===!0){b.reset=!1,w=-1;continue}var S=b.orderedModifiers[w],A=S.fn,u=S.options,y=u===void 0?{}:u,C=S.name;typeof A=="function"&&(b=A({state:b,options:y,name:C,instance:M})||b)}}}},update:ko(function(){return new Promise(function(l){M.forceUpdate(),l(b)})}),destroy:function(){z(),E=!0}};if(!Xn(_,f))return M;M.setOptions(g).then(function(l){!E&&g.onFirstUpdate&&g.onFirstUpdate(l)});function R(){b.orderedModifiers.forEach(function(l){var s=l.name,v=l.options,w=v===void 0?{}:v,S=l.effect;if(typeof S=="function"){var A=S({state:b,name:s,instance:M,options:w}),u=function(){};p.push(A||u)}})}function z(){p.forEach(function(l){return l()}),p=[]}return M}}const Do=jo({defaultModifiers:[_o,Po,to,no,yo,mo,xo,Ki]}),Fo=["enabled","placement","strategy","modifiers"];function Mo(e,r){if(e==null)return{};var t={},a=Object.keys(e),c,h;for(h=0;h<a.length;h++)c=a[h],!(r.indexOf(c)>=0)&&(t[c]=e[c]);return t}const Bo={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},zo={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:e})=>()=>{const{reference:r,popper:t}=e.elements;if("removeAttribute"in r){const a=(r.getAttribute("aria-describedby")||"").split(",").filter(c=>c.trim()!==t.id);a.length?r.setAttribute("aria-describedby",a.join(",")):r.removeAttribute("aria-describedby")}},fn:({state:e})=>{var r;const{popper:t,reference:a}=e.elements,c=(r=t.getAttribute("role"))==null?void 0:r.toLowerCase();if(t.id&&c==="tooltip"&&"setAttribute"in a){const h=a.getAttribute("aria-describedby");if(h&&h.split(",").indexOf(t.id)!==-1)return;a.setAttribute("aria-describedby",h?`${h},${t.id}`:t.id)}}},Lo=[];function No(e,r,t={}){let{enabled:a=!0,placement:c="bottom",strategy:h="absolute",modifiers:_=Lo}=t,f=Mo(t,Fo);const g=reactExports.useRef(_),b=reactExports.useRef(),p=reactExports.useCallback(()=>{var s;(s=b.current)==null||s.update()},[]),E=reactExports.useCallback(()=>{var s;(s=b.current)==null||s.forceUpdate()},[]),[M,R]=ki(reactExports.useState({placement:c,update:p,forceUpdate:E,attributes:{},styles:{popper:{},arrow:{}}})),z=reactExports.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:s})=>{const v={},w={};Object.keys(s.elements).forEach(S=>{v[S]=s.styles[S],w[S]=s.attributes[S]}),R({state:s,styles:v,attributes:w,update:p,forceUpdate:E,placement:s.placement})}}),[p,E,R]),l=reactExports.useMemo(()=>(fe(g.current,_)||(g.current=_),g.current),[_]);return reactExports.useEffect(()=>{!b.current||!a||b.current.setOptions({placement:c,strategy:h,modifiers:[...l,z,Bo]})},[h,c,z,a,l]),reactExports.useEffect(()=>{if(!(!a||e==null||r==null))return b.current=Do(e,r,Object.assign({},f,{placement:c,strategy:h,modifiers:[...l,zo,z]})),()=>{b.current!=null&&(b.current.destroy(),b.current=void 0,R(s=>Object.assign({},s,{attributes:{},styles:{popper:{}}})))}},[a,e,r]),M}const vn=!!(typeof window<"u"&&window.document&&window.document.createElement);var Qe=!1,Xe=!1;try{var Ue={get passive(){return Qe=!0},get once(){return Xe=Qe=!0}};vn&&(window.addEventListener("test",Ue,Ue),window.removeEventListener("test",Ue,!0))}catch{}function Zo(e,r,t,a){if(a&&typeof a!="boolean"&&!Xe){var c=a.once,h=a.capture,_=t;!Xe&&c&&(_=t.__once||function f(g){this.removeEventListener(r,f,h),t.call(this,g)},t.__once=_),e.addEventListener(r,_,Qe?a:h)}e.addEventListener(r,t,a)}function Ho(e,r,t,a){var c=a&&typeof a!="boolean"?a.capture:a;e.removeEventListener(r,t,c),t.__once&&e.removeEventListener(r,t.__once,c)}function Lt(e,r,t,a){return Zo(e,r,t,a),function(){Ho(e,r,t,a)}}function Ie(e){return e&&e.ownerDocument||document}function Uo(e){const r=reactExports.useRef(e);return reactExports.useEffect(()=>{r.current=e},[e]),r}function ee(e){const r=Uo(e);return reactExports.useCallback(function(...t){return r.current&&r.current(...t)},[r])}const tr=()=>{};function Yo(e){return e.button===0}function Vo(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}const Ce=e=>e&&("current"in e?e.current:e),er={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function Wo(e,r=tr,{disabled:t,clickTrigger:a="click"}={}){const c=reactExports.useRef(!1),h=reactExports.useRef(!1),_=reactExports.useCallback(b=>{const p=Ce(e);dr(!!p,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),c.current=!p||Vo(b)||!Yo(b)||!!We(p,b.target)||h.current,h.current=!1},[e]),f=ee(b=>{const p=Ce(e);p&&We(p,b.target)&&(h.current=!0)}),g=ee(b=>{c.current||r(b)});reactExports.useEffect(()=>{var b,p;if(t||e==null)return;const E=Ie(Ce(e)),M=E.defaultView||window;let R=(b=M.event)!=null?b:(p=M.parent)==null?void 0:p.event,z=null;er[a]&&(z=Lt(E,er[a],f,!0));const l=Lt(E,a,_,!0),s=Lt(E,a,w=>{if(w===R){R=void 0;return}g(w)});let v=[];return"ontouchstart"in E.documentElement&&(v=[].slice.call(E.body.children).map(w=>Lt(w,"mousemove",tr))),()=>{z?.(),l(),s(),v.forEach(w=>w())}},[e,t,a,_,f,g])}function Jo(e){return e.code==="Escape"||e.keyCode===27}const Go=()=>{};function qo(e,r,{disabled:t,clickTrigger:a}={}){const c=r||Go;Wo(e,c,{disabled:t,clickTrigger:a});const h=ee(_=>{Jo(_)&&c(_)});reactExports.useEffect(()=>{if(t||e==null)return;const _=Ie(Ce(e));let f=(_.defaultView||window).event;const g=Lt(_,"keyup",b=>{if(b===f){f=void 0;return}h(b)});return()=>{g()}},[e,t,h])}const Er=reactExports.createContext(vn?window:void 0);Er.Provider;function Ko(){return reactExports.useContext(Er)}const Ye=(e,r)=>vn?e==null?(r||Ie()).body:(typeof e=="function"&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null;function nr(e,r){const t=Ko(),[a,c]=reactExports.useState(()=>Ye(e,t?.document));if(!a){const h=Ye(e);h&&c(h)}return reactExports.useEffect(()=>{},[r,a]),reactExports.useEffect(()=>{const h=Ye(e);h!==a&&c(h)},[e,a]),a}function $o(e){const r={};return Array.isArray(e)?(e?.forEach(t=>{r[t.name]=t}),r):e||r}function Qo(e={}){return Array.isArray(e)?e:Object.keys(e).map(r=>(e[r].name=r,e[r]))}function Xo({enabled:e,enableEvents:r,placement:t,flip:a,offset:c,fixed:h,containerPadding:_,arrowElement:f,popperConfig:g={}}){var b,p,E,M;const R=$o(g.modifiers);return Object.assign({},g,{placement:t,enabled:e,strategy:h?"fixed":g.strategy,modifiers:Qo(Object.assign({},R,{eventListeners:{enabled:r,options:(b=R.eventListeners)==null?void 0:b.options},preventOverflow:Object.assign({},R.preventOverflow,{options:Object.assign({padding:_},(p=R.preventOverflow)==null?void 0:p.options)}),offset:{options:Object.assign({offset:c},(E=R.offset)==null?void 0:E.options)},arrow:Object.assign({},R.arrow,{enabled:!!f,options:Object.assign({},(M=R.arrow)==null?void 0:M.options,{element:f})}),flip:Object.assign({enabled:!!a},R.flip)}))})}const ts=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",es=typeof document<"u",tn=es||ts?reactExports.useLayoutEffect:reactExports.useEffect;function ns({children:e,in:r,onExited:t,mountOnEnter:a,unmountOnExit:c}){const h=reactExports.useRef(null),_=reactExports.useRef(r),f=ee(t);reactExports.useEffect(()=>{r?_.current=!0:f(h.current)},[r,f]);const g=ne(h,e.ref),b=reactExports.cloneElement(e,{ref:g});return r?b:c||!_.current&&a?null:b}function rs({in:e,onTransition:r}){const t=reactExports.useRef(null),a=reactExports.useRef(!0),c=ee(r);return tn(()=>{if(!t.current)return;let h=!1;return c({in:e,element:t.current,initial:a.current,isStale:()=>h}),()=>{h=!0}},[e,c]),tn(()=>(a.current=!1,()=>{a.current=!0}),[]),t}function is({children:e,in:r,onExited:t,onEntered:a,transition:c}){const[h,_]=reactExports.useState(!r);r&&h&&_(!1);const f=rs({in:!!r,onTransition:b=>{const p=()=>{b.isStale()||(b.in?a?.(b.element,b.initial):(_(!0),t?.(b.element)))};Promise.resolve(c(b)).then(p,E=>{throw b.in||_(!0),E})}}),g=ne(f,e.ref);return h&&!r?null:reactExports.cloneElement(e,{ref:g})}function os(e,r,t){return e?T.jsx(e,Object.assign({},t)):r?T.jsx(is,Object.assign({},t,{transition:r})):T.jsx(ns,Object.assign({},t))}const xr=reactExports.forwardRef((e,r)=>{const{flip:t,offset:a,placement:c,containerPadding:h,popperConfig:_={},transition:f,runTransition:g}=e,[b,p]=Hn(),[E,M]=Hn(),R=ne(p,r),z=nr(e.container),l=nr(e.target),[s,v]=reactExports.useState(!e.show),w=No(l,b,Xo({placement:c,enableEvents:!!e.show,containerPadding:h||5,flip:t,offset:a,arrowElement:E,popperConfig:_}));e.show&&s&&v(!1);const S=(...D)=>{v(!0),e.onExited&&e.onExited(...D)},A=e.show||!s;if(qo(b,e.onHide,{disabled:!e.rootClose||e.rootCloseDisabled,clickTrigger:e.rootCloseEvent}),!A)return null;const{onExit:u,onExiting:y,onEnter:C,onEntering:k,onEntered:I}=e;let O=e.children(Object.assign({},w.attributes.popper,{style:w.styles.popper,ref:R}),{popper:w,placement:c,show:!!e.show,arrowProps:Object.assign({},w.attributes.arrow,{style:w.styles.arrow,ref:M})});return O=os(f,g,{in:!!e.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:O,onExit:u,onExiting:y,onExited:S,onEnter:C,onEntering:k,onEntered:I}),z?Kt.createPortal(O,z):null});xr.displayName="Overlay";function rr(e,r){return e.classList?!!r&&e.classList.contains(r):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+r+" ")!==-1}const ss=["xxl","xl","lg","md","sm","xs"],as="xs",Ar=reactExports.createContext({prefixes:{},breakpoints:ss,minBreakpoint:as});function Ht(e,r){const{prefixes:t}=reactExports.useContext(Ar);return e||t[r]||r}function Or(){const{dir:e}=reactExports.useContext(Ar);return e==="rtl"}const Rr=reactExports.forwardRef(({className:e,bsPrefix:r,as:t="div",...a},c)=>(r=Ht(r,"popover-header"),T.jsx(t,{ref:c,className:Ut(e,r),...a})));Rr.displayName="PopoverHeader";const hn=reactExports.forwardRef(({className:e,bsPrefix:r,as:t="div",...a},c)=>(r=Ht(r,"popover-body"),T.jsx(t,{ref:c,className:Ut(e,r),...a})));hn.displayName="PopoverBody";function Cr(e,r){let t=e;return e==="left"?t=r?"end":"start":e==="right"&&(t=r?"start":"end"),t}function Tr(e="absolute"){return{position:e,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const cs=reactExports.forwardRef(({bsPrefix:e,placement:r="right",className:t,style:a,children:c,body:h,arrowProps:_,hasDoneInitialMeasure:f,popper:g,show:b,...p},E)=>{const M=Ht(e,"popover"),R=Or(),[z]=r?.split("-")||[],l=Cr(z,R);let s=a;return b&&!f&&(s={...a,...Tr(g?.strategy)}),T.jsxs("div",{ref:E,role:"tooltip",style:s,"x-placement":z,className:Ut(t,M,z&&`bs-popover-${l}`),...p,children:[T.jsx("div",{className:"popover-arrow",..._}),h?T.jsx(hn,{children:c}):c]})}),en=Object.assign(cs,{Header:Rr,Body:hn,POPPER_OFFSET:[0,8]}),Sr=reactExports.forwardRef(({bsPrefix:e,placement:r="right",className:t,style:a,children:c,arrowProps:h,hasDoneInitialMeasure:_,popper:f,show:g,...b},p)=>{e=Ht(e,"tooltip");const E=Or(),[M]=r?.split("-")||[],R=Cr(M,E);let z=a;return g&&!_&&(z={...a,...Tr(f?.strategy)}),T.jsxs("div",{ref:p,style:z,role:"tooltip","x-placement":M,className:Ut(t,e,`bs-tooltip-${R}`),...b,children:[T.jsx("div",{className:"tooltip-arrow",...h}),T.jsx("div",{className:`${e}-inner`,children:c})]})});Sr.displayName="Tooltip";const kr=Object.assign(Sr,{TOOLTIP_OFFSET:[0,6]});function us(e){const r=reactExports.useRef(null),t=Ht(void 0,"popover"),a=Ht(void 0,"tooltip"),c=reactExports.useMemo(()=>({name:"offset",options:{offset:()=>{if(e)return e;if(r.current){if(rr(r.current,t))return en.POPPER_OFFSET;if(rr(r.current,a))return kr.TOOLTIP_OFFSET}return[0,0]}}}),[e,t,a]);return[r,[c]]}const ir={disabled:!1},Ir=React.createContext(null);var fs=function(e){return e.scrollTop},le="unmounted",Bt="exited",kt="entering",zt="entered",nn="exiting",Ct=(function(e){Ci(r,e);function r(a,c){var h;h=e.call(this,a,c)||this;var _=c,f=_&&!_.isMounting?a.enter:a.appear,g;return h.appearStatus=null,a.in?f?(g=Bt,h.appearStatus=kt):g=zt:a.unmountOnExit||a.mountOnEnter?g=le:g=Bt,h.state={status:g},h.nextCallback=null,h}r.getDerivedStateFromProps=function(a,c){var h=a.in;return h&&c.status===le?{status:Bt}:null};var t=r.prototype;return t.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},t.componentDidUpdate=function(a){var c=null;if(a!==this.props){var h=this.state.status;this.props.in?h!==kt&&h!==zt&&(c=kt):(h===kt||h===zt)&&(c=nn)}this.updateStatus(!1,c)},t.componentWillUnmount=function(){this.cancelNextCallback()},t.getTimeouts=function(){var a=this.props.timeout,c,h,_;return c=h=_=a,a!=null&&typeof a!="number"&&(c=a.exit,h=a.enter,_=a.appear!==void 0?a.appear:h),{exit:c,enter:h,appear:_}},t.updateStatus=function(a,c){if(a===void 0&&(a=!1),c!==null)if(this.cancelNextCallback(),c===kt){if(this.props.unmountOnExit||this.props.mountOnEnter){var h=this.props.nodeRef?this.props.nodeRef.current:Kt.findDOMNode(this);h&&fs(h)}this.performEnter(a)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Bt&&this.setState({status:le})},t.performEnter=function(a){var c=this,h=this.props.enter,_=this.context?this.context.isMounting:a,f=this.props.nodeRef?[_]:[Kt.findDOMNode(this),_],g=f[0],b=f[1],p=this.getTimeouts(),E=_?p.appear:p.enter;if(!a&&!h||ir.disabled){this.safeSetState({status:zt},function(){c.props.onEntered(g)});return}this.props.onEnter(g,b),this.safeSetState({status:kt},function(){c.props.onEntering(g,b),c.onTransitionEnd(E,function(){c.safeSetState({status:zt},function(){c.props.onEntered(g,b)})})})},t.performExit=function(){var a=this,c=this.props.exit,h=this.getTimeouts(),_=this.props.nodeRef?void 0:Kt.findDOMNode(this);if(!c||ir.disabled){this.safeSetState({status:Bt},function(){a.props.onExited(_)});return}this.props.onExit(_),this.safeSetState({status:nn},function(){a.props.onExiting(_),a.onTransitionEnd(h.exit,function(){a.safeSetState({status:Bt},function(){a.props.onExited(_)})})})},t.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},t.safeSetState=function(a,c){c=this.setNextCallback(c),this.setState(a,c)},t.setNextCallback=function(a){var c=this,h=!0;return this.nextCallback=function(_){h&&(h=!1,c.nextCallback=null,a(_))},this.nextCallback.cancel=function(){h=!1},this.nextCallback},t.onTransitionEnd=function(a,c){this.setNextCallback(c);var h=this.props.nodeRef?this.props.nodeRef.current:Kt.findDOMNode(this),_=a==null&&!this.props.addEndListener;if(!h||_){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var f=this.props.nodeRef?[this.nextCallback]:[h,this.nextCallback],g=f[0],b=f[1];this.props.addEndListener(g,b)}a!=null&&setTimeout(this.nextCallback,a)},t.render=function(){var a=this.state.status;if(a===le)return null;var c=this.props,h=c.children;c.in,c.mountOnEnter,c.unmountOnExit,c.appear,c.enter,c.exit,c.timeout,c.addEndListener,c.onEnter,c.onEntering,c.onEntered,c.onExit,c.onExiting,c.onExited,c.nodeRef;var _=Oi(c,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return React.createElement(Ir.Provider,{value:null},typeof h=="function"?h(a,_):React.cloneElement(React.Children.only(h),_))},r})(React.Component);Ct.contextType=Ir;Ct.propTypes={};function qt(){}Ct.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:qt,onEntering:qt,onEntered:qt,onExit:qt,onExiting:qt,onExited:qt};Ct.UNMOUNTED=le;Ct.EXITED=Bt;Ct.ENTERING=kt;Ct.ENTERED=zt;Ct.EXITING=nn;function ds(e){var r=Ie(e);return r&&r.defaultView||window}function ps(e,r){return ds(e).getComputedStyle(e,r)}var ms=/([A-Z])/g;function gs(e){return e.replace(ms,"-$1").toLowerCase()}var _s=/^ms-/;function Oe(e){return gs(e).replace(_s,"-ms-")}var vs=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function hs(e){return!!(e&&vs.test(e))}function jr(e,r){var t="",a="";if(typeof r=="string")return e.style.getPropertyValue(Oe(r))||ps(e).getPropertyValue(Oe(r));Object.keys(r).forEach(function(c){var h=r[c];!h&&h!==0?e.style.removeProperty(Oe(c)):hs(c)?a+=c+"("+h+") ":t+=Oe(c)+": "+h+";"}),a&&(t+="transform: "+a+";"),e.style.cssText+=";"+t}function ys(e,r,t,a){if(a===void 0&&(a=!0),e){var c=document.createEvent("HTMLEvents");c.initEvent(r,t,a),e.dispatchEvent(c)}}function bs(e){var r=jr(e,"transitionDuration")||"",t=r.indexOf("ms")===-1?1e3:1;return parseFloat(r)*t}function Ps(e,r,t){t===void 0&&(t=5);var a=!1,c=setTimeout(function(){a||ys(e,"transitionend",!0)},r+t),h=Lt(e,"transitionend",function(){a=!0},{once:!0});return function(){clearTimeout(c),h()}}function ws(e,r,t,a){t==null&&(t=bs(e)||0);var c=Ps(e,t,a),h=Lt(e,"transitionend",r);return function(){c(),h()}}function or(e,r){const t=jr(e,r)||"",a=t.indexOf("ms")===-1?1e3:1;return parseFloat(t)*a}function Es(e,r){const t=or(e,"transitionDuration"),a=or(e,"transitionDelay"),c=ws(e,h=>{h.target===e&&(c(),r(h))},t+a)}function xs(e){e.offsetHeight}function Se(e){return e&&"setState"in e?Kt.findDOMNode(e):e??null}const As=React.forwardRef(({onEnter:e,onEntering:r,onEntered:t,onExit:a,onExiting:c,onExited:h,addEndListener:_,children:f,childRef:g,...b},p)=>{const E=reactExports.useRef(null),M=ne(E,g),R=y=>{M(Se(y))},z=y=>C=>{y&&E.current&&y(E.current,C)},l=reactExports.useCallback(z(e),[e]),s=reactExports.useCallback(z(r),[r]),v=reactExports.useCallback(z(t),[t]),w=reactExports.useCallback(z(a),[a]),S=reactExports.useCallback(z(c),[c]),A=reactExports.useCallback(z(h),[h]),u=reactExports.useCallback(z(_),[_]);return T.jsx(Ct,{ref:p,...b,onEnter:l,onEntered:v,onEntering:s,onExit:w,onExited:A,onExiting:S,addEndListener:u,nodeRef:E,children:typeof f=="function"?(y,C)=>f(y,{...C,ref:R}):React.cloneElement(f,{ref:R})})}),Os={[kt]:"show",[zt]:"show"},rn=reactExports.forwardRef(({className:e,children:r,transitionClasses:t={},onEnter:a,...c},h)=>{const _={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...c},f=reactExports.useCallback((g,b)=>{xs(g),a?.(g,b)},[a]);return T.jsx(As,{ref:h,addEndListener:Es,..._,onEnter:f,childRef:r.ref,children:(g,b)=>reactExports.cloneElement(r,{...b,className:Ut("fade",e,r.props.className,Os[g],t[g])})})});rn.displayName="Fade";function Rs(e,r){const{ref:t}=e,{ref:a}=r;e.ref=t.__wrapped||(t.__wrapped=c=>t(Se(c))),r.ref=a.__wrapped||(a.__wrapped=c=>a(Se(c)))}const Dr=reactExports.forwardRef(({children:e,transition:r=rn,popperConfig:t={},rootClose:a=!1,placement:c="top",show:h=!1,..._},f)=>{const g=reactExports.useRef({}),[b,p]=reactExports.useState(null),[E,M]=us(_.offset),R=ne(f,E),z=r===!0?rn:r||void 0,l=ee(s=>{p(s),t==null||t.onFirstUpdate==null||t.onFirstUpdate(s)});return tn(()=>{b&&_.target&&(g.current.scheduleUpdate==null||g.current.scheduleUpdate())},[b,_.target]),reactExports.useEffect(()=>{h||p(null)},[h]),T.jsx(xr,{..._,ref:R,popperConfig:{...t,modifiers:M.concat(t.modifiers||[]),onFirstUpdate:l},transition:z,rootClose:a,placement:c,show:h,children:(s,{arrowProps:v,popper:w,show:S})=>{var A,u;Rs(s,v);const y=w?.placement,C=Object.assign(g.current,{state:w?.state,scheduleUpdate:w?.update,placement:y,outOfBoundaries:(w==null||(A=w.state)==null||(u=A.modifiersData.hide)==null?void 0:u.isReferenceHidden)||!1,strategy:t.strategy}),k=!!b;return typeof e=="function"?e({...s,placement:y,show:S,...!r&&S&&{className:"show"},popper:C,arrowProps:v,hasDoneInitialMeasure:k}):reactExports.cloneElement(e,{...s,placement:y,arrowProps:v,popper:C,hasDoneInitialMeasure:k,className:Ut(e.props.className,!r&&S&&"show"),style:{...e.props.style,...s.style}})}})});Dr.displayName="Overlay";function Cs(e){return e&&typeof e=="object"?e:{show:e,hide:e}}function sr(e,r,t){const[a]=r,c=a.currentTarget,h=a.relatedTarget||a.nativeEvent[t];(!h||h!==c)&&!We(c,h)&&e(...r)}N.oneOf(["click","hover","focus"]);const yn=({trigger:e=["hover","focus"],overlay:r,children:t,popperConfig:a={},show:c,defaultShow:h=!1,onToggle:_,delay:f,placement:g,flip:b=g&&g.indexOf("auto")!==-1,...p})=>{const E=reactExports.useRef(null),M=ne(E,t.ref),R=wi(),z=reactExports.useRef(""),[l,s]=Ri(c,h,_),v=Cs(f),{onFocus:w,onBlur:S,onClick:A}=typeof t!="function"?reactExports.Children.only(t).props:{},u=$=>{M(Se($))},y=reactExports.useCallback(()=>{if(R.clear(),z.current="show",!v.show){s(!0);return}R.set(()=>{z.current==="show"&&s(!0)},v.show)},[v.show,s,R]),C=reactExports.useCallback(()=>{if(R.clear(),z.current="hide",!v.hide){s(!1);return}R.set(()=>{z.current==="hide"&&s(!1)},v.hide)},[v.hide,s,R]),k=reactExports.useCallback((...$)=>{y(),w?.(...$)},[y,w]),I=reactExports.useCallback((...$)=>{C(),S?.(...$)},[C,S]),O=reactExports.useCallback((...$)=>{s(!l),A?.(...$)},[A,s,l]),D=reactExports.useCallback((...$)=>{sr(y,$,"fromElement")},[y]),X=reactExports.useCallback((...$)=>{sr(C,$,"toElement")},[C]),j=e==null?[]:[].concat(e),B={ref:u};return j.indexOf("click")!==-1&&(B.onClick=O),j.indexOf("focus")!==-1&&(B.onFocus=k,B.onBlur=I),j.indexOf("hover")!==-1&&(B.onMouseOver=D,B.onMouseOut=X),T.jsxs(T.Fragment,{children:[typeof t=="function"?t(B):reactExports.cloneElement(t,B),T.jsx(Dr,{...p,show:l,onHide:C,flip:b,placement:g,popperConfig:a,target:E.current,children:r})]})},Is=["as","disabled"];function js(e,r){if(e==null)return{};var t={},a=Object.keys(e),c,h;for(h=0;h<a.length;h++)c=a[h],!(r.indexOf(c)>=0)&&(t[c]=e[c]);return t}function Ds(e){return!e||e.trim()==="#"}function Fr({tagName:e,disabled:r,href:t,target:a,rel:c,role:h,onClick:_,tabIndex:f=0,type:g}){e||(t!=null||a!=null||c!=null?e="a":e="button");const b={tagName:e};if(e==="button")return[{type:g||"button",disabled:r},b];const p=M=>{if((r||e==="a"&&Ds(t))&&M.preventDefault(),r){M.stopPropagation();return}_?.(M)},E=M=>{M.key===" "&&(M.preventDefault(),p(M))};return e==="a"&&(t||(t="#"),r&&(t=void 0)),[{role:h??"button",disabled:void 0,tabIndex:r?void 0:f,href:t,target:e==="a"?a:void 0,"aria-disabled":r||void 0,rel:e==="a"?c:void 0,onClick:p,onKeyDown:E},b]}const Fs=reactExports.forwardRef((e,r)=>{let{as:t,disabled:a}=e,c=js(e,Is);const[h,{tagName:_}]=Fr(Object.assign({tagName:t,disabled:a},c));return T.jsx(_,Object.assign({},c,h,{ref:r}))});Fs.displayName="Button";const Mr=reactExports.forwardRef(({as:e,bsPrefix:r,variant:t="primary",size:a,active:c=!1,disabled:h=!1,className:_,...f},g)=>{const b=Ht(r,"btn"),[p,{tagName:E}]=Fr({tagName:e,disabled:h,...f}),M=E;return T.jsx(M,{...p,...f,ref:g,disabled:h,className:Ut(_,b,c&&"active",t&&`${b}-${t}`,a&&`${b}-${a}`,f.href&&h&&"disabled")})});Mr.displayName="Button";const Ms="_download_dropdown_menu_23m9j_1",Bs={download_dropdown_menu:Ms},zs=[{format:"cif",label:"CIF"},{format:"xsf",label:"XSF"},{format:"xyz",label:"XYZ"}];function Au(e){const r=`${e.aiida_rest_url}/nodes/${e.uuid}/download`,t=e.download_formats||zs,a=T.jsx(en,{children:T.jsx(en.Body,{style:{padding:"5px 0px"},children:T.jsx("ul",{className:Bs.download_dropdown_menu,children:t.map(({format:c,label:h})=>T.jsx("li",{children:T.jsx("a",{href:`${r}?download_format=${c}`,children:h})},c))})})});return T.jsx(yn,{trigger:"click",rootClose:!0,placement:"bottom",overlay:a,children:T.jsx(Mr,{size:"sm",style:{margin:"4px",padding:"2px 7px"},title:"Download",children:T.jsx("span",{className:"bi bi-download"})})})}function DataTable({title:e,columns:r,data:t,maxHeight:a="300px"}){return!t||t.length<1?null:jsxRuntimeExports$1.jsxs("div",{className:"p-2",children:[jsxRuntimeExports$1.jsx("h2",{className:"text-xl font-semibold mb-2",children:e}),jsxRuntimeExports$1.jsx("div",{className:"overflow-x-auto shadow bg-white",style:{maxHeight:a,overflowY:"auto"},children:jsxRuntimeExports$1.jsxs("table",{className:"min-w-full text-sm text-left",children:[jsxRuntimeExports$1.jsx("thead",{className:"bg-gray-100 text-gray-700",children:jsxRuntimeExports$1.jsx("tr",{children:r.map(c=>jsxRuntimeExports$1.jsx("th",{className:"px-4 py-2 font-medium",children:c},c))})}),jsxRuntimeExports$1.jsx("tbody",{children:t.map((c,h)=>jsxRuntimeExports$1.jsx("tr",{className:h%2===0?"bg-white":"bg-gray-50",children:r.map(_=>jsxRuntimeExports$1.jsx("td",{className:"px-4 py-2 text-gray-800",children:c[_]},_))},h))})]})})]})}function KpointsDataVisualiser({attributes:e,derivedProperties:r}){if(!e)return jsxRuntimeExports$1.jsx("div",{children:"No attributes available"});const t=["x","y","z"],a=(e.cell||[]).map(M=>({x:M[0],y:M[1],z:M[2]})),c=["dimension","value"],h=(e.mesh||[]).map((M,R)=>({dimension:R+1,value:M})),_=["i","x","y","z"],f=(e.offset||[]).map((M,R)=>({i:R+1,x:M[0]??M,y:M[1]??0,z:M[2]??0})),g=["axis","periodic"],b=[{axis:"pbc1",periodic:e.pbc1?"True":"False"},{axis:"pbc2",periodic:e.pbc2?"True":"False"},{axis:"pbc3",periodic:e.pbc3?"True":"False"}],p=["K-point number","x","y","z"],E=r.explicit_kpoints_abs.map((M,R)=>({"K-point number":R+1,x:M[0],y:M[1],z:M[2]}));return jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4 space-y-6 overflow-y-auto",children:[jsxRuntimeExports$1.jsx(DataTable,{title:"Cell",columns:t,data:a}),jsxRuntimeExports$1.jsx(DataTable,{title:"Mesh",columns:c,data:h}),jsxRuntimeExports$1.jsx(DataTable,{title:"Offset",columns:_,data:f}),jsxRuntimeExports$1.jsx(DataTable,{title:"PBC Flags",columns:g,data:b}),jsxRuntimeExports$1.jsx(DataTable,{title:"Explicit K-points (Absolute)",columns:p,data:E},"explicit_kpoints_abs")]})}const BASE_URL$1="https://aiida.materialscloud.org/mc2d/api/v4";function VisualiserPane({selectedNode:e}){if(!e)return jsxRuntimeExports$1.jsx("div",{className:"w-full h-full p-4",children:"No node selected"});if(["StructureData","CifData"].includes(e.data.label)){const r=e.data.download.cifText;let t=[{format:"cif",label:"CIF"},{format:"xsf",label:"XSF"},{format:"xyz",label:"XYZ"}];return e.data.label==="CifData"&&(t=[{format:"cif",label:"CIF"}]),jsxRuntimeExports$1.jsxs("div",{className:"w-full h-full p-4 relative",children:[jsxRuntimeExports$1.jsx("div",{className:"absolute top-8 right-8 z-50",children:jsxRuntimeExports$1.jsx(Au,{aiida_rest_url:BASE_URL$1,uuid:e.data.aiida.uuid,download_formats:t})}),jsxRuntimeExports$1.jsx("div",{className:"w-full h-full",children:jsxRuntimeExports$1.jsx(StructureVisualizer,{cifText:r,initSupercell:[2,2,2]})})]})}return e.data.label==="KpointsData"?jsxRuntimeExports$1.jsx(KpointsDataVisualiser,{attributes:e.data.attributes,derivedProperties:e.data.derived_properties}):jsxRuntimeExports$1.jsx("div",{className:"w-full h-full p-4",children:jsxRuntimeExports$1.jsx("pre",{children:JSON.stringify(e.data.download||{},null,2)})})}function Breadcrumbs({trail:e,onClick:r,maxItems:t=10}){const a=e.slice(-t);return jsxRuntimeExports$1.jsx("div",{className:"w-full border-t border-gray-300 p-2 flex gap-2 flex-wrap overflow-x-auto",children:a.map((c,h)=>jsxRuntimeExports$1.jsxs(React.Fragment,{children:[jsxRuntimeExports$1.jsx("button",{className:"bg-gray-200 hover:bg-gray-300 text-sm px-2 py-1 rounded",onClick:()=>r(c,h),children:c.data.label}),h<a.length-1&&jsxRuntimeExports$1.jsx("span",{className:"mx-1",children:""})]},`${c.id}-${h}`))})}function layoutGraphWithEdges(e,r,t,a={}){const c=a.spacingX||200,h=a.spacingY||80,_=a.centerX||window.innerWidth/2,f=a.centerY||window.innerHeight/2,g=[],b=[];return g.push({...e,position:{x:_,y:f}}),r.sort((p,E)=>Number(p.id)-Number(E.id)),t.sort((p,E)=>Number(p.id)-Number(E.id)),r.forEach((p,E)=>{const M=(E-(r.length-1)/2)*h;g.push({...p,position:{x:_-c,y:f+M}}),b.push({id:`e-${p.id}-${e.id}`,source:p.id,target:e.id,sourcePosition:Position.Right,targetPosition:Position.Left,type:"smoothstep",style:{stroke:"green",strokeWidth:2},markerEnd:{type:"arrow",color:"green",width:20,height:15}})}),t.forEach((p,E)=>{const M=(E-(t.length-1)/2)*h;g.push({...p,position:{x:_+c,y:f+M}}),b.push({id:`e-${e.id}-${p.id}`,source:e.id,sourcePosition:Position.Right,target:p.id,type:"smoothstep",style:{stroke:"orange",strokeWidth:2},markerEnd:{type:"arrow",color:"orange",width:20,height:15}})}),{nodes:g,edges:b}}const BASE_URL="https://aiida.materialscloud.org/mc2d/api/v4";async function fetchNodeById(e){if(!e)return null;try{const r=await fetch(`${BASE_URL}/nodes/${encodeURIComponent(e)}`);return r.ok?r.json():null}catch(r){return console.error("Error fetching node:",r),null}}async function fetchNodeContents(e){if(!e)return null;const r=["attributes","comments","extras","derived_properties"];try{const t=await Promise.all(r.map(async f=>{const g=await fetch(`${BASE_URL}/nodes/${encodeURIComponent(e)}/contents/${f}`);return g.ok?g.json():null})),[a,c,h,_]=t;return{attributes:a?.data?.attributes??a??{},comments:c?.data?.comments??c??{},extras:h?.data?.extras??h??{},derived_properties:_?.data?.derived_properties??{}}}catch(t){return console.error("Error fetching node contents:",t),null}}async function fetchJson(e){if(!e)return{incoming:[],outgoing:[]};try{const r=await fetch(`${BASE_URL}/nodes/${encodeURIComponent(e)}/download?download_format=json`);return r.ok?r.json():null}catch(r){return console.error("Error fetching node:",r),null}}async function fetchCif(e){if(!e)return{cifText:null};try{const r=await fetch(`${BASE_URL}/nodes/${encodeURIComponent(e)}/download?download_format=cif&download=false`);return r.ok?{cifText:(await r.json()).data.download.data||null}:{cifText:null}}catch(r){return console.error("Error fetching node:",r),{cifText:null}}}async function fetchLinks(e){if(!e)return{incoming:[],outgoing:[]};try{const[r,t]=await Promise.all([fetch(`${BASE_URL}/nodes/${encodeURIComponent(e)}/links/incoming`),fetch(`${BASE_URL}/nodes/${encodeURIComponent(e)}/links/outgoing`)]),a=r.ok?await r.json():[],c=t.ok?await t.json():[];return{incoming:a,outgoing:c}}catch(r){return console.error("Error fetching links:",r),{incoming:[],outgoing:[]}}}async function fetchGraphByNodeId(e){const t=(await fetchNodeById(e)).data.nodes[0];if(!t)return{nodes:[],edges:[]};const{incoming:a,outgoing:c}=await fetchLinks(e),h=a?.data?.incoming||[],_=c?.data?.outgoing||[];console.log("RN",t);const f=[{id:t.uuid,data:{label:t.node_type.split(".").filter(Boolean).pop(),node_type:t.node_type,pos:"center",aiida:t}},...h.map(p=>({id:p.uuid,data:{label:p.node_type.split(".").filter(Boolean).pop(),node_type:p.node_type,pos:"input",aiida:p}})),..._.map(p=>({id:p.uuid,data:{label:p.node_type.split(".").filter(Boolean).pop(),node_type:p.node_type,pos:"output",aiida:p}}))],{nodes:g,edges:b}=layoutGraphWithEdges(f.find(p=>p.data.pos==="center"),f.filter(p=>p.data.pos==="input"),f.filter(p=>p.data.pos==="output"));return{nodes:g,edges:b}}function Explorer(){const[e,r]=reactExports.useState([]),[t,a]=reactExports.useState([]),[c,h]=reactExports.useState([]),_=20,[f,g]=useSearchParams(),b=f.get("rootNode")||"030bf271-2c94-4d93-8314-7f82f271bd44",[p,E]=reactExports.useState(b),[M,R]=reactExports.useState(null),[z,l]=reactExports.useState({}),[s,v]=reactExports.useState(null);reactExports.useEffect(()=>{let y=!0;async function C(){const k=performance.now(),{nodes:I,edges:O}=await fetchGraphByNodeId(p);if(!y)return;const D=I.map(X=>({...X,data:{...X.data,...z[X.id]||{}}}));if(r(D),a(O),M){const X=D.find(j=>j.id===M.id);R(X||null)}v(performance.now()-k)}return C(),()=>{y=!1}},[p]);const w=async y=>{let C={...y.data};if(z[y.id])C={...C,...z[y.id]};else{const k=await fetchNodeContents(y.id);l(I=>({...I,[y.id]:k})),C={...C,...k}}if(!C.download){let k;y.data.label==="StructureData"?k=await fetchCif(y.id):y.data.label==="CifData"?k=await fetchCif(y.id):k=await fetchJson(y.id),C={...C,download:k},l(I=>({...I,[y.id]:{...I[y.id]||{},download:k}}))}return{...y,data:C}},S=async y=>{const C=await w(y);R(C)},A=async y=>{c[c.length-1]?.id!==y.id&&h(k=>[...k,y].slice(-_)),E(y.id),g({rootNode:y.id});const C=await w(y);R(C)},u=async(y,C)=>{h(I=>I.slice(0,C+1)),E(y.id),g({rootNode:y.id});const k=await w(y);R(k)};return jsxRuntimeExports$1.jsxs("div",{className:"flex flex-col h-screen",children:[jsxRuntimeExports$1.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[jsxRuntimeExports$1.jsx("div",{className:"flex-1 border-r border-gray-300 h-full min-w-0",children:jsxRuntimeExports$1.jsx(FlowChart,{nodes:e,edges:t,setNodes:r,setEdges:a,selectedNode:M,onNodeSelect:S,onNodeDoubleSelect:A})}),jsxRuntimeExports$1.jsxs("div",{className:"w-[900px] flex flex-col h-full",children:[jsxRuntimeExports$1.jsx("div",{className:"flex-none h-1/4 border-b border-gray-300 overflow-y-auto",children:jsxRuntimeExports$1.jsx(SidePane,{selectedNode:M,timeTaken:s})}),jsxRuntimeExports$1.jsx("div",{className:"flex-1 overflow-y-auto",children:jsxRuntimeExports$1.jsx(VisualiserPane,{selectedNode:M})})]})]}),jsxRuntimeExports$1.jsx("div",{className:"flex-none h-12 border-t border-gray-300",children:jsxRuntimeExports$1.jsx(Breadcrumbs,{trail:c,onClick:u,maxItems:_})})]})}function App(){return jsxRuntimeExports$1.jsx(Explorer,{})}ReactDOM.createRoot(document.getElementById("root")).render(jsxRuntimeExports$1.jsx(React.StrictMode,{children:jsxRuntimeExports$1.jsx(BrowserRouter,{children:jsxRuntimeExports$1.jsx(App,{})})}));
